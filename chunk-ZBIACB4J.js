import{a as we,b as ve,c as Se,d as De,e as Me,f as Ae}from"./chunk-Z3LQ4TTY.js";import{a as $t}from"./chunk-ZDUQ6FEO.js";import{a as Ot,b as xi,c as He,d as Zt}from"./chunk-AO6VYA3B.js";import{a as $e}from"./chunk-HZFMELAP.js";import{a as zt}from"./chunk-KIVWZUI7.js";import{a as Jt}from"./chunk-4WMZK6JU.js";import{b as Ue,c as je}from"./chunk-43IYJRR7.js";import{a as Ge,b as Ie,c as Te,d as ke,e as Ne,f as Ve,g as Le,h as Pe,i as Re,j as Be}from"./chunk-342L5HW6.js";import{a as Fe,b as Ee}from"./chunk-GYBCTTXN.js";import{a as Kt}from"./chunk-DQDCUJLC.js";import{a as ye,c as ge,f as xe,h as be}from"./chunk-CEP7KUOG.js";import{a as mt,c as Ht,d as pt,e as ut,f as dt,g as qt}from"./chunk-RDGKLBOP.js";import{Aa as J,Ca as Z,Ha as tt,Ia as rt,Ja as wt,L as ct,Na as z,Q as xt,R as Y,S as bt,ka as it,ma as L,oa as X,pa as W,ra as D,sa as _e,ta as Q,ua as Ce,wa as nt,xa as ot,ya as at,za as Mt}from"./chunk-VHEGYB6A.js";import{h as fe}from"./chunk-QJ2HU2ZW.js";import{A as Ut,Aa as E,Ba as G,Bb as g,Hb as M,Ia as et,Ib as P,Jb as T,Kb as k,L as ie,Lb as r,Mb as s,Nb as U,Ob as Tt,Pb as kt,Rb as R,Ub as v,Wb as y,Zb as jt,_b as ae,ac as re,ba as ne,bb as Qt,bc as se,ca as oe,cc as le,cd as he,e as gi,f as It,fb as p,fc as gt,gb as A,gc as m,hc as N,ic as q,kc as ce,lc as me,mc as pe,oc as $,sa as H,sc as ue,tc as de,w as Bt,xb as F}from"./chunk-TUTLJQZA.js";var wi=(e,n)=>n.id;function vi(e,n){if(e&1){let t=R();r(0,"mat-list-option",1),v("click",function(){let o=E(t).$implicit,a=y(2);return G(a.selectAnalysisGroup(o))}),r(1,"b"),m(2),s(),r(3,"span",2),m(4),s()(),U(5,"mat-divider")}if(e&2){let t=n.$implicit,i=y(2);g("value",t),p(2),N(t.name),p(2),q(" ",i.dataService.getAnalysisGroupTypeLabel(t.analysis_group_type)," ")}}function Si(e,n){if(e&1&&(r(0,"mat-selection-list",0),T(1,vi,6,3,null,null,wi),s()),e&2){let t=y();g("multiple",!1),p(),k(t.analysisGroupQuery.results)}}var Go=(()=>{class e{constructor(t){this.dataService=t,this.selectedAnalysisGroup=new et}selectAnalysisGroup(t){this.selectedAnalysisGroup.emit(t)}static{this.\u0275fac=function(i){return new(i||e)(A($t))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-list"]],inputs:{analysisGroupQuery:"analysisGroupQuery"},outputs:{selectedAnalysisGroup:"selectedAnalysisGroup"},standalone:!0,features:[$],decls:1,vars:1,consts:[[3,"multiple"],[3,"click","value"],["matListItemLine",""]],template:function(i,o){i&1&&F(0,Si,3,1,"mat-selection-list",0),i&2&&M(o.analysisGroupQuery?0:-1)},dependencies:[ye,xe,be,ge]})}}return e})();var ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ei="ARRAYBUFFER not supported by this environment",ii="UINT8ARRAY not supported by this environment";function Ke(e,n,t,i){let o,a,c,h=n||[0],u=(t=t||0)>>>3,f=i===-1?3:0;for(o=0;o<e.length;o+=1)c=o+u,a=c>>>2,h.length<=a&&h.push(0),h[a]|=e[o]<<8*(f+i*(c%4));return{value:h,binLen:8*e.length+t}}function Et(e,n,t){switch(n){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(i,o,a){return function(c,h,u,f){let _,d,C,w;if(c.length%2!=0)throw new Error("String of HEX type must be in byte increments");let S=h||[0],I=(u=u||0)>>>3,V=f===-1?3:0;for(_=0;_<c.length;_+=2){if(d=parseInt(c.substr(_,2),16),isNaN(d))throw new Error("String of HEX type contains invalid characters");for(w=(_>>>1)+I,C=w>>>2;S.length<=C;)S.push(0);S[C]|=d<<8*(V+f*(w%4))}return{value:S,binLen:4*c.length+u}}(i,o,a,t)};case"TEXT":return function(i,o,a){return function(c,h,u,f,_){let d,C,w,S,I,V,x,j,B=0,K=u||[0],st=(f=f||0)>>>3;if(h==="UTF8")for(x=_===-1?3:0,w=0;w<c.length;w+=1)for(d=c.charCodeAt(w),C=[],128>d?C.push(d):2048>d?(C.push(192|d>>>6),C.push(128|63&d)):55296>d||57344<=d?C.push(224|d>>>12,128|d>>>6&63,128|63&d):(w+=1,d=65536+((1023&d)<<10|1023&c.charCodeAt(w)),C.push(240|d>>>18,128|d>>>12&63,128|d>>>6&63,128|63&d)),S=0;S<C.length;S+=1){for(V=B+st,I=V>>>2;K.length<=I;)K.push(0);K[I]|=C[S]<<8*(x+_*(V%4)),B+=1}else for(x=_===-1?2:0,j=h==="UTF16LE"&&_!==1||h!=="UTF16LE"&&_===1,w=0;w<c.length;w+=1){for(d=c.charCodeAt(w),j===!0&&(S=255&d,d=S<<8|d>>>8),V=B+st,I=V>>>2;K.length<=I;)K.push(0);K[I]|=d<<8*(x+_*(V%4)),B+=2}return{value:K,binLen:8*B+f}}(i,n,o,a,t)};case"B64":return function(i,o,a){return function(c,h,u,f){let _,d,C,w,S,I,V,x=0,j=h||[0],B=(u=u||0)>>>3,K=f===-1?3:0,st=c.indexOf("=");if(c.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(c=c.replace(/=/g,""),st!==-1&&st<c.length)throw new Error("Invalid '=' found in base-64 string");for(d=0;d<c.length;d+=4){for(S=c.substr(d,4),w=0,C=0;C<S.length;C+=1)_=ti.indexOf(S.charAt(C)),w|=_<<18-6*C;for(C=0;C<S.length-1;C+=1){for(V=x+B,I=V>>>2;j.length<=I;)j.push(0);j[I]|=(w>>>16-8*C&255)<<8*(K+f*(V%4)),x+=1}}return{value:j,binLen:8*x+u}}(i,o,a,t)};case"BYTES":return function(i,o,a){return function(c,h,u,f){let _,d,C,w,S=h||[0],I=(u=u||0)>>>3,V=f===-1?3:0;for(d=0;d<c.length;d+=1)_=c.charCodeAt(d),w=d+I,C=w>>>2,S.length<=C&&S.push(0),S[C]|=_<<8*(V+f*(w%4));return{value:S,binLen:8*c.length+u}}(i,o,a,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ei)}return function(i,o,a){return function(c,h,u,f){return Ke(new Uint8Array(c),h,u,f)}(i,o,a,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ii)}return function(i,o,a){return Ke(i,o,a,t)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function qe(e,n,t,i){switch(e){case"HEX":return function(o){return function(a,c,h,u){let f="0123456789abcdef",_,d,C="",w=c/8,S=h===-1?3:0;for(_=0;_<w;_+=1)d=a[_>>>2]>>>8*(S+h*(_%4)),C+=f.charAt(d>>>4&15)+f.charAt(15&d);return u.outputUpper?C.toUpperCase():C}(o,n,t,i)};case"B64":return function(o){return function(a,c,h,u){let f,_,d,C,w,S="",I=c/8,V=h===-1?3:0;for(f=0;f<I;f+=3)for(C=f+1<I?a[f+1>>>2]:0,w=f+2<I?a[f+2>>>2]:0,d=(a[f>>>2]>>>8*(V+h*(f%4))&255)<<16|(C>>>8*(V+h*((f+1)%4))&255)<<8|w>>>8*(V+h*((f+2)%4))&255,_=0;_<4;_+=1)S+=8*f+6*_<=c?ti.charAt(d>>>6*(3-_)&63):u.b64Pad;return S}(o,n,t,i)};case"BYTES":return function(o){return function(a,c,h){let u,f,_="",d=c/8,C=h===-1?3:0;for(u=0;u<d;u+=1)f=a[u>>>2]>>>8*(C+h*(u%4))&255,_+=String.fromCharCode(f);return _}(o,n,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ei)}return function(o){return function(a,c,h){let u,f=c/8,_=new ArrayBuffer(f),d=new Uint8Array(_),C=h===-1?3:0;for(u=0;u<f;u+=1)d[u]=a[u>>>2]>>>8*(C+h*(u%4))&255;return _}(o,n,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ii)}return function(o){return function(a,c,h){let u,f=c/8,_=h===-1?3:0,d=new Uint8Array(f);for(u=0;u<f;u+=1)d[u]=a[u>>>2]>>>8*(_+h*(u%4))&255;return d}(o,n,t)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var Lt=4294967296,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ct=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],yt=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Pt="Chosen SHA variant is not supported",ni="Cannot set numRounds with MAC";function Xt(e,n){let t,i,o=e.binLen>>>3,a=n.binLen>>>3,c=o<<3,h=4-o<<3;if(o%4!=0){for(t=0;t<a;t+=4)i=o+t>>>2,e.value[i]|=n.value[t>>>2]<<c,e.value.push(0),e.value[i+1]|=n.value[t>>>2]>>>h;return(e.value.length<<2)-4>=a+o&&e.value.pop(),{value:e.value,binLen:e.binLen+n.binLen}}return{value:e.value.concat(n.value),binLen:e.binLen+n.binLen}}function ze(e){let n={outputUpper:!1,b64Pad:"=",outputLen:-1},t=e||{},i="Output length must be a multiple of 8";if(n.outputUpper=t.outputUpper||!1,t.b64Pad&&(n.b64Pad=t.b64Pad),t.outputLen){if(t.outputLen%8!=0)throw new Error(i);n.outputLen=t.outputLen}else if(t.shakeLen){if(t.shakeLen%8!=0)throw new Error(i);n.outputLen=t.shakeLen}if(typeof n.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof n.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return n}function vt(e,n,t,i){let o=e+" must include a value and format";if(!n){if(!i)throw new Error(o);return i}if(n.value===void 0||!n.format)throw new Error(o);return Et(n.format,n.encoding||"UTF8",t)(n.value)}var Ft=class{constructor(n,t,i){let o=i||{};if(this.t=t,this.i=o.encoding||"UTF8",this.numRounds=o.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=n,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(n){let t,i=0,o=this.m>>>5,a=this.C(n,this.h,this.u),c=a.binLen,h=a.value,u=c>>>5;for(t=0;t<u;t+=o)i+this.m<=c&&(this.U=this.v(h.slice(t,t+o),this.U),i+=this.m);return this.A+=i,this.h=h.slice(i>>>5),this.u=c%this.m,this.l=!0,this}getHash(n,t){let i,o,a=this.R,c=ze(t);if(this.K){if(c.outputLen===-1)throw new Error("Output length must be specified in options");a=c.outputLen}let h=qe(n,a,this.T,c);if(this.H&&this.g)return h(this.g(c));for(o=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),i=1;i<this.numRounds;i+=1)this.K&&a%32!=0&&(o[o.length-1]&=16777215>>>24-a%32),o=this.F(o,a,0,this.B(this.o),a);return h(o)}setHMACKey(n,t,i){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");let o=Et(t,(i||{}).encoding||"UTF8",this.T);this.k(o(n))}k(n){let t=this.m>>>3,i=t/4-1,o;if(this.numRounds!==1)throw new Error(ni);if(this.H)throw new Error("MAC key already set");for(t<n.binLen/8&&(n.value=this.F(n.value,n.binLen,0,this.B(this.o),this.R));n.value.length<=i;)n.value.push(0);for(o=0;o<=i;o+=1)this.S[o]=909522486^n.value[o],this.p[o]=1549556828^n.value[o];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(n,t){let i=ze(t);return qe(n,this.R,this.T,i)(this.Y())}Y(){let n;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");let t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return n=this.v(this.p,this.B(this.o)),n=this.F(t,this.R,this.m,n,this.R),n}};function At(e,n){return e<<n|e>>>32-n}function ht(e,n){return e>>>n|e<<32-n}function oi(e,n){return e>>>n}function Oe(e,n,t){return e^n^t}function ai(e,n,t){return e&n^~e&t}function ri(e,n,t){return e&n^e&t^n&t}function Di(e){return ht(e,2)^ht(e,13)^ht(e,22)}function O(e,n){let t=(65535&e)+(65535&n);return(65535&(e>>>16)+(n>>>16)+(t>>>16))<<16|65535&t}function Mi(e,n,t,i){let o=(65535&e)+(65535&n)+(65535&t)+(65535&i);return(65535&(e>>>16)+(n>>>16)+(t>>>16)+(i>>>16)+(o>>>16))<<16|65535&o}function Vt(e,n,t,i,o){let a=(65535&e)+(65535&n)+(65535&t)+(65535&i)+(65535&o);return(65535&(e>>>16)+(n>>>16)+(t>>>16)+(i>>>16)+(o>>>16)+(a>>>16))<<16|65535&a}function Ai(e){return ht(e,7)^ht(e,18)^oi(e,3)}function Fi(e){return ht(e,6)^ht(e,11)^ht(e,25)}function Ei(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function si(e,n){let t,i,o,a,c,h,u,f=[];for(t=n[0],i=n[1],o=n[2],a=n[3],c=n[4],u=0;u<80;u+=1)f[u]=u<16?e[u]:At(f[u-3]^f[u-8]^f[u-14]^f[u-16],1),h=u<20?Vt(At(t,5),ai(i,o,a),c,1518500249,f[u]):u<40?Vt(At(t,5),Oe(i,o,a),c,1859775393,f[u]):u<60?Vt(At(t,5),ri(i,o,a),c,2400959708,f[u]):Vt(At(t,5),Oe(i,o,a),c,3395469782,f[u]),c=a,a=o,o=At(i,30),i=t,t=h;return n[0]=O(t,n[0]),n[1]=O(i,n[1]),n[2]=O(o,n[2]),n[3]=O(a,n[3]),n[4]=O(c,n[4]),n}function Gi(e,n,t,i){let o,a=15+(n+65>>>9<<4),c=n+t;for(;e.length<=a;)e.push(0);for(e[n>>>5]|=128<<24-n%32,e[a]=4294967295&c,e[a-1]=c/Lt|0,o=0;o<e.length;o+=16)i=si(e.slice(o,o+16),i);return i}var Ii=class extends Ft{constructor(e,n,t){if(e!=="SHA-1")throw new Error(Pt);super(e,n,t);let i=t||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=Et(this.t,this.i,this.T),this.v=si,this.L=function(o){return o.slice()},this.B=Ei,this.F=Gi,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,i.hmacKey&&this.k(vt("hmacKey",i.hmacKey,this.T))}};function Ye(e){let n;return n=e=="SHA-224"?Ct.slice():yt.slice(),n}function Xe(e,n){let t,i,o,a,c,h,u,f,_,d,C,w=[];for(t=n[0],i=n[1],o=n[2],a=n[3],c=n[4],h=n[5],u=n[6],f=n[7],C=0;C<64;C+=1)w[C]=C<16?e[C]:Mi(ht(S=w[C-2],17)^ht(S,19)^oi(S,10),w[C-7],Ai(w[C-15]),w[C-16]),_=Vt(f,Fi(c),ai(c,h,u),b[C],w[C]),d=O(Di(t),ri(t,i,o)),f=u,u=h,h=c,c=O(a,_),a=o,o=i,i=t,t=O(_,d);var S;return n[0]=O(t,n[0]),n[1]=O(i,n[1]),n[2]=O(o,n[2]),n[3]=O(a,n[3]),n[4]=O(c,n[4]),n[5]=O(h,n[5]),n[6]=O(u,n[6]),n[7]=O(f,n[7]),n}var Ti=class extends Ft{constructor(e,n,t){if(e!=="SHA-224"&&e!=="SHA-256")throw new Error(Pt);super(e,n,t);let i=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Et(this.t,this.i,this.T),this.v=Xe,this.L=function(o){return o.slice()},this.B=Ye,this.F=function(o,a,c,h){return function(u,f,_,d,C){let w,S,I=15+(f+65>>>9<<4),V=f+_;for(;u.length<=I;)u.push(0);for(u[f>>>5]|=128<<24-f%32,u[I]=4294967295&V,u[I-1]=V/Lt|0,w=0;w<u.length;w+=16)d=Xe(u.slice(w,w+16),d);return S=C==="SHA-224"?[d[0],d[1],d[2],d[3],d[4],d[5],d[6]]:d,S}(o,a,c,h,e)},this.U=Ye(e),this.m=512,this.R=e==="SHA-224"?224:256,this.K=!1,i.hmacKey&&this.k(vt("hmacKey",i.hmacKey,this.T))}},l=class{constructor(n,t){this.N=n,this.I=t}};function We(e,n){let t;return n>32?(t=64-n,new l(e.I<<n|e.N>>>t,e.N<<n|e.I>>>t)):n!==0?(t=32-n,new l(e.N<<n|e.I>>>t,e.I<<n|e.N>>>t)):e}function ft(e,n){let t;return n<32?(t=32-n,new l(e.N>>>n|e.I<<t,e.I>>>n|e.N<<t)):(t=64-n,new l(e.I>>>n|e.N<<t,e.N>>>n|e.I<<t))}function li(e,n){return new l(e.N>>>n,e.I>>>n|e.N<<32-n)}function ki(e,n,t){return new l(e.N&n.N^e.N&t.N^n.N&t.N,e.I&n.I^e.I&t.I^n.I&t.I)}function Ni(e){let n=ft(e,28),t=ft(e,34),i=ft(e,39);return new l(n.N^t.N^i.N,n.I^t.I^i.I)}function lt(e,n){let t,i;t=(65535&e.I)+(65535&n.I),i=(e.I>>>16)+(n.I>>>16)+(t>>>16);let o=(65535&i)<<16|65535&t;return t=(65535&e.N)+(65535&n.N)+(i>>>16),i=(e.N>>>16)+(n.N>>>16)+(t>>>16),new l((65535&i)<<16|65535&t,o)}function Vi(e,n,t,i){let o,a;o=(65535&e.I)+(65535&n.I)+(65535&t.I)+(65535&i.I),a=(e.I>>>16)+(n.I>>>16)+(t.I>>>16)+(i.I>>>16)+(o>>>16);let c=(65535&a)<<16|65535&o;return o=(65535&e.N)+(65535&n.N)+(65535&t.N)+(65535&i.N)+(a>>>16),a=(e.N>>>16)+(n.N>>>16)+(t.N>>>16)+(i.N>>>16)+(o>>>16),new l((65535&a)<<16|65535&o,c)}function Li(e,n,t,i,o){let a,c;a=(65535&e.I)+(65535&n.I)+(65535&t.I)+(65535&i.I)+(65535&o.I),c=(e.I>>>16)+(n.I>>>16)+(t.I>>>16)+(i.I>>>16)+(o.I>>>16)+(a>>>16);let h=(65535&c)<<16|65535&a;return a=(65535&e.N)+(65535&n.N)+(65535&t.N)+(65535&i.N)+(65535&o.N)+(c>>>16),c=(e.N>>>16)+(n.N>>>16)+(t.N>>>16)+(i.N>>>16)+(o.N>>>16)+(a>>>16),new l((65535&c)<<16|65535&a,h)}function Nt(e,n){return new l(e.N^n.N,e.I^n.I)}function Pi(e){let n=ft(e,19),t=ft(e,61),i=li(e,6);return new l(n.N^t.N^i.N,n.I^t.I^i.I)}function Ri(e){let n=ft(e,1),t=ft(e,8),i=li(e,7);return new l(n.N^t.N^i.N,n.I^t.I^i.I)}function Bi(e){let n=ft(e,14),t=ft(e,18),i=ft(e,41);return new l(n.N^t.N^i.N,n.I^t.I^i.I)}var Ui=[new l(b[0],3609767458),new l(b[1],602891725),new l(b[2],3964484399),new l(b[3],2173295548),new l(b[4],4081628472),new l(b[5],3053834265),new l(b[6],2937671579),new l(b[7],3664609560),new l(b[8],2734883394),new l(b[9],1164996542),new l(b[10],1323610764),new l(b[11],3590304994),new l(b[12],4068182383),new l(b[13],991336113),new l(b[14],633803317),new l(b[15],3479774868),new l(b[16],2666613458),new l(b[17],944711139),new l(b[18],2341262773),new l(b[19],2007800933),new l(b[20],1495990901),new l(b[21],1856431235),new l(b[22],3175218132),new l(b[23],2198950837),new l(b[24],3999719339),new l(b[25],766784016),new l(b[26],2566594879),new l(b[27],3203337956),new l(b[28],1034457026),new l(b[29],2466948901),new l(b[30],3758326383),new l(b[31],168717936),new l(b[32],1188179964),new l(b[33],1546045734),new l(b[34],1522805485),new l(b[35],2643833823),new l(b[36],2343527390),new l(b[37],1014477480),new l(b[38],1206759142),new l(b[39],344077627),new l(b[40],1290863460),new l(b[41],3158454273),new l(b[42],3505952657),new l(b[43],106217008),new l(b[44],3606008344),new l(b[45],1432725776),new l(b[46],1467031594),new l(b[47],851169720),new l(b[48],3100823752),new l(b[49],1363258195),new l(b[50],3750685593),new l(b[51],3785050280),new l(b[52],3318307427),new l(b[53],3812723403),new l(b[54],2003034995),new l(b[55],3602036899),new l(b[56],1575990012),new l(b[57],1125592928),new l(b[58],2716904306),new l(b[59],442776044),new l(b[60],593698344),new l(b[61],3733110249),new l(b[62],2999351573),new l(b[63],3815920427),new l(3391569614,3928383900),new l(3515267271,566280711),new l(3940187606,3454069534),new l(4118630271,4000239992),new l(116418474,1914138554),new l(174292421,2731055270),new l(289380356,3203993006),new l(460393269,320620315),new l(685471733,587496836),new l(852142971,1086792851),new l(1017036298,365543100),new l(1126000580,2618297676),new l(1288033470,3409855158),new l(1501505948,4234509866),new l(1607167915,987167468),new l(1816402316,1246189591)];function Qe(e){return e==="SHA-384"?[new l(3418070365,Ct[0]),new l(1654270250,Ct[1]),new l(2438529370,Ct[2]),new l(355462360,Ct[3]),new l(1731405415,Ct[4]),new l(41048885895,Ct[5]),new l(3675008525,Ct[6]),new l(1203062813,Ct[7])]:[new l(yt[0],4089235720),new l(yt[1],2227873595),new l(yt[2],4271175723),new l(yt[3],1595750129),new l(yt[4],2917565137),new l(yt[5],725511199),new l(yt[6],4215389547),new l(yt[7],327033209)]}function Je(e,n){let t,i,o,a,c,h,u,f,_,d,C,w,S=[];for(t=n[0],i=n[1],o=n[2],a=n[3],c=n[4],h=n[5],u=n[6],f=n[7],C=0;C<80;C+=1)C<16?(w=2*C,S[C]=new l(e[w],e[w+1])):S[C]=Vi(Pi(S[C-2]),S[C-7],Ri(S[C-15]),S[C-16]),_=Li(f,Bi(c),(V=h,x=u,new l((I=c).N&V.N^~I.N&x.N,I.I&V.I^~I.I&x.I)),Ui[C],S[C]),d=lt(Ni(t),ki(t,i,o)),f=u,u=h,h=c,c=lt(a,_),a=o,o=i,i=t,t=lt(_,d);var I,V,x;return n[0]=lt(t,n[0]),n[1]=lt(i,n[1]),n[2]=lt(o,n[2]),n[3]=lt(a,n[3]),n[4]=lt(c,n[4]),n[5]=lt(h,n[5]),n[6]=lt(u,n[6]),n[7]=lt(f,n[7]),n}var ji=class extends Ft{constructor(e,n,t){if(e!=="SHA-384"&&e!=="SHA-512")throw new Error(Pt);super(e,n,t);let i=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Et(this.t,this.i,this.T),this.v=Je,this.L=function(o){return o.slice()},this.B=Qe,this.F=function(o,a,c,h){return function(u,f,_,d,C){let w,S,I=31+(f+129>>>10<<5),V=f+_;for(;u.length<=I;)u.push(0);for(u[f>>>5]|=128<<24-f%32,u[I]=4294967295&V,u[I-1]=V/Lt|0,w=0;w<u.length;w+=32)d=Je(u.slice(w,w+32),d);return S=C==="SHA-384"?[d[0].N,d[0].I,d[1].N,d[1].I,d[2].N,d[2].I,d[3].N,d[3].I,d[4].N,d[4].I,d[5].N,d[5].I]:[d[0].N,d[0].I,d[1].N,d[1].I,d[2].N,d[2].I,d[3].N,d[3].I,d[4].N,d[4].I,d[5].N,d[5].I,d[6].N,d[6].I,d[7].N,d[7].I],S}(o,a,c,h,e)},this.U=Qe(e),this.m=1024,this.R=e==="SHA-384"?384:512,this.K=!1,i.hmacKey&&this.k(vt("hmacKey",i.hmacKey,this.T))}},Hi=[new l(0,1),new l(0,32898),new l(2147483648,32906),new l(2147483648,2147516416),new l(0,32907),new l(0,2147483649),new l(2147483648,2147516545),new l(2147483648,32777),new l(0,138),new l(0,136),new l(0,2147516425),new l(0,2147483658),new l(0,2147516555),new l(2147483648,139),new l(2147483648,32905),new l(2147483648,32771),new l(2147483648,32770),new l(2147483648,128),new l(0,32778),new l(2147483648,2147483658),new l(2147483648,2147516545),new l(2147483648,32896),new l(0,2147483649),new l(2147483648,2147516424)],$i=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function ee(e){let n,t=[];for(n=0;n<5;n+=1)t[n]=[new l(0,0),new l(0,0),new l(0,0),new l(0,0),new l(0,0)];return t}function Ki(e){let n,t=[];for(n=0;n<5;n+=1)t[n]=e[n].slice();return t}function Yt(e,n){let t,i,o,a,c=[],h=[];if(e!==null)for(i=0;i<e.length;i+=2)n[(i>>>1)%5][(i>>>1)/5|0]=Nt(n[(i>>>1)%5][(i>>>1)/5|0],new l(e[i+1],e[i]));for(t=0;t<24;t+=1){for(a=ee(),i=0;i<5;i+=1)c[i]=(u=n[i][0],f=n[i][1],_=n[i][2],d=n[i][3],C=n[i][4],new l(u.N^f.N^_.N^d.N^C.N,u.I^f.I^_.I^d.I^C.I));for(i=0;i<5;i+=1)h[i]=Nt(c[(i+4)%5],We(c[(i+1)%5],1));for(i=0;i<5;i+=1)for(o=0;o<5;o+=1)n[i][o]=Nt(n[i][o],h[i]);for(i=0;i<5;i+=1)for(o=0;o<5;o+=1)a[o][(2*i+3*o)%5]=We(n[i][o],$i[i][o]);for(i=0;i<5;i+=1)for(o=0;o<5;o+=1)n[i][o]=Nt(a[i][o],new l(~a[(i+1)%5][o].N&a[(i+2)%5][o].N,~a[(i+1)%5][o].I&a[(i+2)%5][o].I));n[0][0]=Nt(n[0][0],Hi[t])}var u,f,_,d,C;return n}function ci(e){let n,t,i=0,o=[0,0],a=[4294967295&e,e/Lt&2097151];for(n=6;n>=0;n--)t=a[n>>2]>>>8*n&255,t===0&&i===0||(o[i+1>>2]|=t<<8*(i+1),i+=1);return i=i!==0?i:1,o[0]|=i,{value:i+1>4?o:[o[0]],binLen:8+8*i}}function te(e){return Xt(ci(e.binLen),e)}function Ze(e,n){let t,i=ci(n);i=Xt(i,e);let o=n>>>2,a=(o-i.value.length%o)%o;for(t=0;t<a;t++)i.value.push(0);return i.value}var qi=class extends Ft{constructor(e,n,t){let i=6,o=0;super(e,n,t);let a=t||{};if(this.numRounds!==1){if(a.kmacKey||a.hmacKey)throw new Error(ni);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=Et(this.t,this.i,this.T),this.v=Yt,this.L=Ki,this.B=ee,this.U=ee(),this.K=!1,e){case"SHA3-224":this.m=o=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=o=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=o=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=o=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":i=31,this.m=o=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":i=31,this.m=o=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":i=4,this.m=o=1344,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":i=4,this.m=o=1088,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=o=1344,i=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=o=1088,i=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(Pt)}this.F=function(c,h,u,f,_){return function(d,C,w,S,I,V,x){let j,B,K=0,st=[],Rt=I>>>5,yi=C>>>5;for(j=0;j<yi&&C>=I;j+=Rt)S=Yt(d.slice(j,j+Rt),S),C-=I;for(d=d.slice(j),C%=I;d.length<Rt;)d.push(0);for(j=C>>>3,d[j>>2]^=V<<j%4*8,d[Rt-1]^=2147483648,S=Yt(d,S);32*st.length<x&&(B=S[K%5][K/5|0],st.push(B.I),!(32*st.length>=x));)st.push(B.N),K+=1,64*K%I==0&&(Yt(null,S),K=0);return st}(c,h,0,f,o,i,_)},a.hmacKey&&this.k(vt("hmacKey",a.hmacKey,this.T))}O(e,n){let t=function(o){let a=o||{};return{funcName:vt("funcName",a.funcName,1,{value:[],binLen:0}),customization:vt("Customization",a.customization,1,{value:[],binLen:0})}}(e||{});n&&(t.funcName=n);let i=Xt(te(t.funcName),te(t.customization));if(t.customization.binLen!==0||t.funcName.binLen!==0){let o=Ze(i,this.m>>>3);for(let a=0;a<o.length;a+=this.m>>>5)this.U=this.v(o.slice(a,a+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(e){let n=function(i){let o=i||{};return{kmacKey:vt("kmacKey",o.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:vt("Customization",o.customization,1,{value:[],binLen:0})}}(e||{});this.O(e,n.funcName);let t=Ze(te(n.kmacKey),this.m>>>3);for(let i=0;i<t.length;i+=this.m>>>5)this.U=this.v(t.slice(i,i+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(e){let n=Xt({value:this.h.slice(),binLen:this.u},function(t){let i,o,a=0,c=[0,0],h=[4294967295&t,t/Lt&2097151];for(i=6;i>=0;i--)o=h[i>>2]>>>8*i&255,o===0&&a===0||(c[a>>2]|=o<<8*a,a+=1);return a=a!==0?a:1,c[a>>2]|=a<<8*a,{value:a+1>4?c:[c[0]],binLen:8+8*a}}(e.outputLen));return this.F(n.value,n.binLen,this.A,this.L(this.U),e.outputLen)}},Wt=class{constructor(n,t,i){if(n=="SHA-1")this.P=new Ii(n,t,i);else if(n=="SHA-224"||n=="SHA-256")this.P=new Ti(n,t,i);else if(n=="SHA-384"||n=="SHA-512")this.P=new ji(n,t,i);else{if(n!="SHA3-224"&&n!="SHA3-256"&&n!="SHA3-384"&&n!="SHA3-512"&&n!="SHAKE128"&&n!="SHAKE256"&&n!="CSHAKE128"&&n!="CSHAKE256"&&n!="KMAC128"&&n!="KMAC256")throw new Error(Pt);this.P=new qi(n,t,i)}}update(n){return this.P.update(n),this}getHash(n,t){return this.P.getHash(n,t)}setHMACKey(n,t,i){this.P.setHMACKey(n,t,i)}getHMAC(n,t){return this.P.getHMAC(n,t)}};var zi=(e,n)=>n.name;function Oi(e,n){if(e&1&&U(0,"mat-progress-bar",3),e&2){let t=n.$implicit,i=y();g("value",i.fileProgressMap[t.name].progress/i.fileProgressMap[t.name].total*100)("mode","determinate")}}var mi=(()=>{class e{constructor(t){this.web=t,this.fileProgressMap={},this.fileList=[],this.fileType="",this.fileCategory="",this.analysisGroupId=0,this.fileUploaded=new et,this.allowFileType=["csv","tsv","txt"]}uploadData(t){return It(this,null,function*(){let i=t.target.files;if(i){this.fileList=[];for(let o=0;o<i.length;o++)this.fileList.push(i[o]),this.fileProgressMap[i[o].name]={progress:0,total:i[o].size};for(let o=0;o<i.length;o++)yield this.uploadFile(i[o])}})}getFileExntension(t){let i=t.name.split(".");return i.length>1?i[i.length-1]:""}uploadFile(t){return It(this,null,function*(){let o=t.size,a=new Wt("SHA-256","ARRAYBUFFER");if(this.fileType=this.getFileExntension(t),this.allowFileType.indexOf(this.fileType)!==-1)if(1048576>o){let c=yield t.arrayBuffer();a.update(c);let h=a.getHash("HEX"),u=yield this.web.uploadDataChunkComplete("",h,t,t.name).toPromise();this.fileProgressMap[t.name].progress=o,u?.completed_at&&this.web.bindUploadedFile(this.analysisGroupId,this.fileType,this.fileCategory,t.name,u?.id).subscribe(f=>{this.fileUploaded.emit(f)})}else{let c="",h=0;for(;o>h;){let u=h+1048576;u>=o&&(u=o);let f=yield t.slice(h,u).arrayBuffer();a.update(f);let _=new File([f],t.name,{type:t.type});console.log(_.size);let d=`bytes ${h}-${u-1}/${o}`;console.log(d);let C=yield this.web.uploadDataChunk(c,_,t.name,d).toPromise();C&&(c=C.url,h=C.offset,this.fileProgressMap[t.name].progress=h)}if(c!==""){let u=a.getHash("HEX"),f=yield this.web.uploadDataChunkComplete(c,u).toPromise();f?.completed_at&&this.web.bindUploadedFile(this.analysisGroupId,this.fileType,this.fileCategory,t.name,f?.id).subscribe(_=>{this.fileProgressMap[t.name].progress=o,this.fileUploaded.emit(_)})}}})}static{this.\u0275fac=function(i){return new(i||e)(A(z))}}static{this.\u0275cmp=H({type:e,selectors:[["app-upload-file"]],inputs:{fileType:"fileType",fileCategory:"fileCategory",analysisGroupId:"analysisGroupId"},outputs:{fileUploaded:"fileUploaded"},standalone:!0,features:[$],decls:8,vars:0,consts:[["file",""],["mat-icon-button","","type","button",3,"click"],["type","file","hidden","",3,"change"],[3,"value","mode"]],template:function(i,o){if(i&1){let a=R();r(0,"form")(1,"button",1),v("click",function(){E(a);let h=gt(5);return G(h.click())}),r(2,"mat-icon"),m(3,"upload"),s()(),r(4,"input",2,0),v("change",function(h){return E(a),G(o.uploadData(h))}),s()(),T(6,Oi,1,2,"mat-progress-bar",3,zi)}i&2&&(p(6),k(o.fileList))},dependencies:[bt,xt,Ot,J,Q,W]})}}return e})();var Yi=["table"];function Xi(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Wi(e,n){e&1&&(r(0,"th",16),m(1," Sample "),s())}function Qi(e,n){if(e&1&&(r(0,"td",17),m(1),s()),e&2){let t=n.$implicit;p(),q(" ",t.value.Sample," ")}}function Ji(e,n){e&1&&(r(0,"th",16),m(1," Condition "),s())}function Zi(e,n){if(e&1){let t=R();r(0,"td",17)(1,"form",4)(2,"mat-form-field")(3,"input",18,1),v("change",function(o){E(t);let a=gt(4),c=y(2);return G(c.handleAutoCompleteChange(o,a.value))}),s(),r(5,"mat-label"),m(6),s()()()()}if(e&2){let t=n.$implicit;p(),g("formGroup",t),p(2),jt("placeholder",t.value.Sample),p(3),N(t.value.Sample)}}function tn(e,n){e&1&&U(0,"tr",19)}function en(e,n){e&1&&U(0,"tr",20)}function nn(e,n){if(e&1&&(r(0,"table",8,0),Tt(2,10),F(3,Wi,2,0,"th",11)(4,Qi,2,1,"td",12),kt(),Tt(5,13),F(6,Ji,2,0,"th",11)(7,Zi,7,3,"td",12),kt(),F(8,tn,1,0,"tr",14)(9,en,1,0,"tr",15),s()),e&2){let t=y();g("dataSource",t.annotationData),p(8),g("matHeaderRowDef",t.displayedColumns),p(),g("matRowDefColumns",t.displayedColumns)}}var pi=(()=>{class e{set annotation(t){t&&(this._annotation=t,this.annotationData=t.annotations.map(i=>this.fb.group({Sample:new D(i.Sample,L.required),Condition:new D(i.Condition,L.required)})),this.form.patchValue({columns:this.annotationData.map(i=>i.value.Sample)}))}get annotation(){return this._annotation}set projectFile(t){this._projectFile=t,this.web.getProjectFileColumns(t.id).subscribe(i=>{let o=[];i.forEach(a=>{o.includes(a)||o.push(a)}),this.columns=o})}get projectFile(){return this._projectFile}onSelectionChange(t){let i=t.source,o=-1,a=i.selected,c;for(let u=0;u<a.length;u++)if(!this.lastSelection.find(f=>f===a[u].value)){c=a[u];break}let h=i.options.toArray();o=h.indexOf(c),this.shiftPressed&&this.lastSelectedIndex>-1&&h.forEach((u,f)=>{this.isBetween(f,this.lastSelectedIndex,o)&&(console.log(u),u.select())}),this.lastSelection=this.form.value.columns?.slice(),this.lastSelectedIndex=o,this.table?.renderRows()}constructor(t,i,o){this.fb=t,this.web=i,this.dialogRef=o,this.columns=[],this.shiftPressed=!1,this.displayedColumns=["Sample","Condition"],this.form=this.fb.group({columns:new D([])}),this.annotationData=[],this.lastSelectedIndex=-1,this.lastSelection=[],window.addEventListener("keydown",a=>{a.key==="Shift"&&(this.shiftPressed=!0)}),window.addEventListener("keyup",a=>{a.key==="Shift"&&(this.shiftPressed=!1)}),this.form.controls.columns.valueChanges.subscribe(a=>{if(a){let c=a.map(h=>{let u=h.split(/\./g);return console.log(u),u.length>2?{Sample:h,Condition:u.slice(0,u.length-1).join(".")}:u.length===2?{Sample:h,Condition:u[0]}:{Sample:h,Condition:""}});for(let h=0;h<c.length;h++)this.annotationData.find(u=>u.value.Sample===c[h].Sample)||this.annotationData.push(this.fb.group({Sample:new D(c[h].Sample,L.required),Condition:new D(c[h].Condition,L.required)}));for(let h=0;h<this.annotationData.length;h++)this.annotationData[h].value.Sample&&(a.includes(this.annotationData[h].value.Sample)||this.annotationData.splice(h,1))}})}cancel(){this.dialogRef.close()}save(){let t=!0,i=this.annotationData.map(o=>(o.valid||(t=!1),o.value));t&&this.dialogRef.close(i)}handleAutoCompleteChange(t,i){console.log(t,i)}isBetween(t,i,o){return i<o?t>=i&&t<=o:t>=o&&t<=i}static{this.\u0275fac=function(i){return new(i||e)(A(at),A(z),A(mt))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-sample-annotation-modal"]],viewQuery:function(i,o){if(i&1&&re(Yi,5),i&2){let a;se(a=le())&&(o.table=a.first)}},inputs:{annotation:"annotation",projectFile:"projectFile"},standalone:!0,features:[$],decls:16,vars:3,consts:[["table",""],["optionCondition",""],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[2,"width","300px"],["formControlName","columns",3,"selectionChange","multiple"],[3,"value"],["mat-table","",3,"dataSource"],["mat-button","",3,"click"],["matColumnDef","Sample"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Condition"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["matInput","","formControlName","Condition",2,"border-radius","0",3,"change","placeholder"],["mat-header-row",""],["mat-row",""]],template:function(i,o){i&1&&(r(0,"h2",2),m(1,"Sample Annotation"),s(),r(2,"div",3)(3,"form",4)(4,"mat-form-field",5)(5,"mat-select",6),v("selectionChange",function(c){return o.onSelectionChange(c)}),T(6,Xi,2,2,"mat-option",7,P),s(),r(8,"mat-label"),m(9,"Columns"),s()()(),F(10,nn,10,3,"table",8),s(),r(11,"mat-dialog-actions")(12,"button",9),v("click",function(){return o.save()}),m(13,"Submit"),s(),r(14,"button",9),v("click",function(){return o.cancel()}),m(15,"Close"),s()()),i&2&&(p(3),g("formGroup",o.form),p(2),g("multiple",!0),p(),k(o.columns),p(4),M(o.annotationData.length>0?10:-1))},dependencies:[pt,ut,J,Q,it,X,W,nt,ot,tt,wt,ct,Z,rt,Mt,dt,Y,Ge,ke,Ne,Ve,Re,Be,Pe,Le,Ie,Te]})}}return e})();function on(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function an(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function rn(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function sn(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function ln(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function cn(e,n){if(e&1&&(r(0,"mat-option",7),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function mn(e,n){if(e&1&&(r(0,"mat-form-field")(1,"mat-select",14),T(2,cn,2,2,"mat-option",7,P),s(),r(4,"mat-label"),m(5,"Comparison Label"),s()()),e&2){let t=y(2).$implicit,i=y(2);p(2),k(i.comparison_labels_map[t.value.comparison_col])}}function pn(e,n){e&1&&(r(0,"mat-form-field"),U(1,"input",15),r(2,"mat-label"),m(3,"Comparison Label"),s()())}function un(e,n){if(e&1){let t=R();r(0,"mat-tab",4),Tt(1),r(2,"div")(3,"form",5)(4,"div")(5,"mat-form-field")(6,"mat-select",6),T(7,on,2,2,"mat-option",7,P),s(),r(9,"mat-label"),m(10,"Condition A"),s()()(),r(11,"div")(12,"mat-form-field")(13,"mat-select",8),T(14,an,2,2,"mat-option",7,P),s(),r(16,"mat-label"),m(17,"Condition B"),s()()(),r(18,"div")(19,"mat-form-field")(20,"mat-select",9),T(21,rn,2,2,"mat-option",7,P),s(),r(23,"mat-label"),m(24,"Fold Change Column"),s()()(),r(25,"div")(26,"mat-form-field")(27,"mat-select",10),T(28,sn,2,2,"mat-option",7,P),s(),r(30,"mat-label"),m(31,"P-Value Column"),s()()(),r(32,"div")(33,"mat-form-field")(34,"mat-select",11),T(35,ln,2,2,"mat-option",7,P),s(),r(37,"mat-label"),m(38,"Comparison Column"),s()()(),m(39," If the comparison column has been selected, please select the comparison label column below. If not, please write the comparison label in the text box below. "),r(40,"div"),F(41,mn,6,0,"mat-form-field")(42,pn,4,0,"mat-form-field"),s()()(),r(43,"div",12)(44,"button",13),v("click",function(){E(t);let o=y().$implicit,a=y(2);return G(a.copyComparison(o))}),r(45,"mat-icon"),m(46,"content_copy"),s()(),r(47,"button",13),v("click",function(){E(t);let o=y().$index,a=y(2);return G(a.removeComparison(o))}),r(48,"mat-icon"),m(49,"remove"),s()()(),kt(),s()}if(e&2){let t=y().$implicit,i=y(2);g("label",t.value.comparison_label),p(3),g("formGroup",t),p(4),k(i.conditions),p(7),k(i.conditions),p(7),k(i.columns),p(7),k(i.columns),p(7),k(i.columns),p(6),M(t.value.comparison_col?41:42)}}function dn(e,n){if(e&1&&F(0,un,50,3,"mat-tab",4),e&2){let t=n.$implicit;M(t.value.comparison_label?0:-1)}}function hn(e,n){if(e&1&&(r(0,"mat-tab-group",2),T(1,dn,1,1,null,null,P),s()),e&2){let t=y();p(),k(t.form)}}var ui=(()=>{class e{set comparisonMatrix(t){this._comparisonMatrix=t,this.form=t.matrix.map(i=>this.fb.group({condition_A:new D(i.condition_A,L.required),condition_B:new D(i.condition_B,L.required),fold_change_col:new D(i.fold_change_col,L.required),p_value_col:new D(i.p_value_col,L.required),comparison_label:new D(i.comparison_label,L.required),comparison_col:new D(i.comparison_col)}));for(let i of this.form)i.controls.comparison_col.value&&this.web.getUniqueComparisonLabel(t.file,i.controls.comparison_col.value).subscribe(o=>{this.comparison_labels_map[i.controls.comparison_col.value]=o}),i.controls.comparison_col.valueChanges.subscribe(o=>{o&&this.web.getUniqueComparisonLabel(t.file,o).subscribe(a=>{this.comparison_labels_map[o]=a})}),i.controls.comparison_label.valueChanges.subscribe(o=>{o||i.controls.comparison_label.setValue("temp_title")})}set projectFile(t){this._projectFile=t,this.web.getProjectFileColumns(t.id).subscribe(i=>{let o=[];i.forEach(a=>{o.includes(a)||o.push(a)}),this.columns=o})}get projectFile(){return this._projectFile}set sampleAnnotations(t){this._sampleAnnotations=t,t&&(this.conditions=[],t.annotations.forEach(i=>{console.log(i.Condition),this.conditions.includes(i.Condition)||this.conditions.push(i.Condition)}))}get sampleAnnotations(){return this._sampleAnnotations}constructor(t,i,o){this.web=t,this.fb=i,this.dialogRef=o,this.comparison_labels=[],this.comparison_labels_map={},this.columns=[],this.conditions=[],this.form=[]}addComparison(){let t=this.fb.group({condition_A:new D(null,L.required),condition_B:new D(null,L.required),fold_change_col:new D(null,L.required),p_value_col:new D(null,L.required),comparison_label:new D(`comparison_${this.form.length+1}`,L.required),comparison_col:new D(null)});this.form.push(t),t.controls.comparison_col.valueChanges.subscribe(i=>{i&&this.web.getUniqueComparisonLabel(this.comparisonMatrix.file,i).subscribe(o=>{this.comparison_labels=o})}),t.controls.comparison_label.valueChanges.subscribe(i=>{i||t.controls.comparison_label.setValue("temp_title")})}removeComparison(t){this.form.splice(t,1)}copyComparison(t){let i=this.fb.group({condition_A:new D(t.value.condition_A,L.required),condition_B:new D(t.value.condition_B,L.required),fold_change_col:new D(t.value.fold_change_col,L.required),p_value_col:new D(t.value.p_value_col,L.required),comparison_label:new D(`comparison_${this.form.length+1}`,L.required),comparison_col:new D(t.value.comparison_col)});this.form.push(i),i.controls.comparison_col.valueChanges.subscribe(o=>{o&&this.web.getUniqueComparisonLabel(this.comparisonMatrix.file,o).subscribe(a=>{this.comparison_labels=a})}),i.controls.comparison_label.valueChanges.subscribe(o=>{o||i.controls.comparison_label.setValue("temp_title")})}save(){let t=!0;this.form.forEach(i=>{i.valid||(t=!1)}),t&&this.dialogRef.close(this.form.map(i=>i.value))}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||e)(A(z),A(at),A(mt))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-comparison-matrix-modal"]],inputs:{comparisonMatrix:"comparisonMatrix",projectFile:"projectFile",sampleAnnotations:"sampleAnnotations"},standalone:!0,features:[$],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-stretch-tabs","false"],["mat-button","",3,"click"],[3,"label"],[2,"display","flex","flex-direction","column","gap","10px","overflow-y","hidden",3,"formGroup"],["formControlName","condition_A"],[3,"value"],["formControlName","condition_B"],["formControlName","fold_change_col"],["formControlName","p_value_col"],["formControlName","comparison_col"],[2,"display","flex","flex-direction","row","gap","10px"],["mat-icon-button","","color","warn",3,"click"],["formControlName","comparison_label"],["matInput","","type","text","formControlName","comparison_label"]],template:function(i,o){i&1&&(r(0,"h2",0),m(1,"Analysis Group Comparison Matrix"),s(),r(2,"div",1),F(3,hn,3,0,"mat-tab-group",2),s(),r(4,"mat-dialog-actions")(5,"button",3),v("click",function(){return o.addComparison()}),m(6," Add Comparison "),s(),r(7,"button",3),v("click",function(){return o.save()}),m(8," Submit "),s(),r(9,"button",3),v("click",function(){return o.cancel()}),m(10," Close "),s()()),i&2&&(p(3),M(o.form.length>0?3:-1))},dependencies:[pt,ut,bt,xt,J,Q,it,X,W,nt,ot,tt,wt,ct,Z,rt,je,Ue,dt,Y],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]})}}return e})();var di=(()=>{class e{constructor(t,i,o,a,c){this.fb=t,this.dialogRef=i,this.web=o,this.ws=a,this.sb=c,this.analysisGroupIDs=[],this.form=this.fb.group({search:new D("",L.required),searchMode:new D("full",L.required),foldChange:new D(.6,L.required),pValue:new D(1.31,L.required)}),this.selectedProjects=[],this.ws.searchWSConnection?.subscribe(h=>{if(h&&h.type==="search_status")switch(h.status){case"complete":this.sb.open(`${location.host}/#/search-session/${h.id}`,"Dismiss",{duration:1e4}),this.dialogRef.close(h.id);break}})}search(){this.form.invalid||(this.selectedProjects.length===0?this.form.value.search&&this.form.value.foldChange&&this.form.value.pValue&&this.form.value.searchMode&&this.web.createSearch(this.analysisGroupIDs,this.form.value.search,this.web.searchSessionID,this.form.value.foldChange,this.form.value.pValue,this.form.value.searchMode).subscribe(t=>{this.sb.open("Search queued","Dismiss",{duration:2e3})}):this.web.getAnalysisGroupsFromProjects(this.selectedProjects).subscribe(t=>{t&&this.form.value.search&&this.form.value.foldChange&&this.form.value.pValue&&this.form.value.searchMode&&this.web.createSearch(t.map(i=>i.id),this.form.value.search,this.web.searchSessionID,this.form.value.foldChange,this.form.value.pValue,this.form.value.searchMode).subscribe(i=>{this.sb.open("Search queued","Dismiss",{duration:2e3})})}))}cancel(){this.dialogRef.close()}handleMultipleProjectSelection(t){this.selectedProjects=t}static{this.\u0275fac=function(i){return new(i||e)(A(at),A(mt),A(z),A(zt),A(Kt))}}static{this.\u0275cmp=H({type:e,selectors:[["app-search-modal"]],inputs:{analysisGroupIDs:"analysisGroupIDs"},standalone:!0,features:[$],decls:56,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","1px",3,"formGroup"],["matInput","","formControlName","search","id","search","type","text","placeholder","Search Term"],["formControlName","searchMode"],["value","gene"],["value","uniprot"],["value","pi"],["value","full"],["matInput","","type","number","formControlName","foldChange","placeholder","Log2 Fold Change"],["matInput","","type","number","formControlName","pValue","placeholder","P-Value"],[3,"selectedProjects","multipleSelection"],["mat-button","",3,"click"]],template:function(i,o){i&1&&(r(0,"h2",0),m(1,"Data Search"),s(),r(2,"div",1)(3,"form",2)(4,"mat-form-field"),U(5,"input",3),r(6,"mat-label"),m(7,"Search Term"),s()(),r(8,"p")(9,"b"),m(10,"Search Multiple Terms"),s(),U(11,"br"),m(12," In order to search with multiple terms, enclose each term in single quotes and separate them with "),r(13,"b"),m(14,"OR"),s(),m(15,". "),s(),r(16,"mat-form-field")(17,"mat-select",4)(18,"mat-option",5),m(19,"Gene Name"),s(),r(20,"mat-option",6),m(21,"UniProt Accession ID"),s(),r(22,"mat-option",7),m(23,"Primary IDs"),s(),r(24,"mat-option",8),m(25,"Full Text"),s()(),r(26,"mat-label"),m(27,"Search Mode"),s()(),r(28,"mat-form-field"),U(29,"input",9),r(30,"mat-label"),m(31,"Log2 Fold Change"),s()(),r(32,"mat-form-field"),U(33,"input",10),r(34,"mat-label"),m(35,"-Log10(P-Value)"),s()()(),U(36,"hr"),r(37,"p")(38,"b"),m(39,"Search by currently selected analysis groups or by selected projects below"),s(),U(40,"br"),m(41," By selecting the one or more projects below, the currently selected analysis groups will be ignored. "),s(),r(42,"mat-accordion")(43,"mat-expansion-panel")(44,"mat-expansion-panel-header")(45,"mat-panel-title"),m(46," Filter by Project "),s(),r(47,"mat-panel-description"),m(48," Optional "),s()(),r(49,"app-project-search",11),v("selectedProjects",function(c){return o.handleMultipleProjectSelection(c)}),s()()(),U(50,"hr"),s(),r(51,"mat-dialog-actions")(52,"button",12),v("click",function(){return o.search()}),m(53,"Search"),s(),r(54,"button",12),v("click",function(){return o.cancel()}),m(55,"Close"),s()()),i&2&&(p(3),g("formGroup",o.form),p(46),g("multipleSelection",!0))},dependencies:[pt,ut,Z,rt,tt,J,Q,it,Ce,X,W,nt,ot,dt,Y,wt,ct,Ae,ve,De,Se,Me,we]})}}return e})();function Cn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function yn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function gn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function xn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function bn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function wn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function vn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Sn(e,n){if(e&1&&(r(0,"mat-form-field")(1,"mat-select",8),T(2,xn,2,2,"mat-option",5,P),s(),r(4,"mat-label"),m(5,"Mod Position in Peptide Column"),s()(),r(6,"mat-form-field")(7,"mat-select",9),T(8,bn,2,2,"mat-option",5,P),s(),r(10,"mat-label"),m(11,"Mod Position in Protein Column"),s()(),r(12,"mat-form-field")(13,"mat-select",10),T(14,wn,2,2,"mat-option",5,P),s(),r(16,"mat-label"),m(17,"Localization Probability Column"),s()(),r(18,"mat-form-field")(19,"mat-select",11),T(20,vn,2,2,"mat-option",5,P),s(),r(22,"mat-label"),m(23,"Peptide Sequence Column"),s()()),e&2){let t=y(3);p(2),k(t.columns),p(6),k(t.columns),p(6),k(t.columns),p(6),k(t.columns)}}function Dn(e,n){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),T(3,Cn,2,2,"mat-option",5,P),s(),r(5,"mat-label"),m(6,"Primary ID Column"),s()(),r(7,"mat-form-field")(8,"mat-select",6),T(9,yn,2,2,"mat-option",5,P),s(),r(11,"mat-label"),m(12,"Gene Name Column"),s()(),r(13,"mat-form-field")(14,"mat-select",7),T(15,gn,2,2,"mat-option",5,P),s(),r(17,"mat-label"),m(18,"UniProt Accession ID Column"),s()(),F(19,Sn,24,0),s()),e&2){let t=y(2);g("formGroup",t.formDFColumn),p(3),k(t.columns),p(6),k(t.columns),p(6),k(t.columns),p(4),M(t.analysisGroupType&&t.analysisGroupType==="ptm"?19:-1)}}function Mn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function An(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Fn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function En(e,n){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),T(3,Mn,2,2,"mat-option",5,P),s(),r(5,"mat-label"),m(6,"Primary ID Column"),s()(),r(7,"mat-form-field")(8,"mat-select",6),T(9,An,2,2,"mat-option",5,P),s(),r(11,"mat-label"),m(12,"Gene Name Column"),s()(),r(13,"mat-form-field")(14,"mat-select",7),T(15,Fn,2,2,"mat-option",5,P),s(),r(17,"mat-label"),m(18,"UniProt Accession ID Column"),s()()()),e&2){let t=y(2);g("formGroup",t.formSearchedColumn),p(3),k(t.columns),p(6),k(t.columns),p(6),k(t.columns)}}function Gn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function In(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Tn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function kn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Nn(e,n){if(e&1&&(r(0,"mat-option",5),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),N(t)}}function Vn(e,n){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),T(3,Gn,2,2,"mat-option",5,P),s(),r(5,"mat-label"),m(6,"Primary ID Column"),s()(),r(7,"mat-form-field")(8,"mat-select",6),T(9,In,2,2,"mat-option",5,P),s(),r(11,"mat-label"),m(12,"Gene Name Column"),s()(),r(13,"mat-form-field")(14,"mat-select",7),T(15,Tn,2,2,"mat-option",5,P),s(),r(17,"mat-label"),m(18,"UniProt Accession ID Column"),s()(),r(19,"mat-form-field")(20,"mat-select",12),T(21,kn,2,2,"mat-option",5,P),s(),r(23,"mat-label"),m(24,"Copy Number Rank Column"),s()(),r(25,"mat-form-field")(26,"mat-select",13),T(27,Nn,2,2,"mat-option",5,P),s(),r(29,"mat-label"),m(30,"Copy Number Column"),s()()()),e&2){let t=y(2);g("formGroup",t.formSearchedColumn),p(3),k(t.columns),p(6),k(t.columns),p(6),k(t.columns),p(6),k(t.columns),p(6),k(t.columns)}}function Ln(e,n){if(e&1&&F(0,Dn,20,2,"form",3)(1,En,19,1,"form",3)(2,Vn,31,1,"form",3),e&2){let t=y();M(t.file.file_category==="df"?0:t.file.file_category==="searched"?1:t.file.file_category==="copy_number"?2:-1)}}var hi=(()=>{class e{set file(t){this._file=t,t.extra_data&&(t.file_category==="df"?(this.formDFColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formDFColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formDFColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col),this.formDFColumn.controls.peptide_seq_col.setValue(t.extra_data.peptide_seq_col),this.formDFColumn.controls.modification_position_in_peptide_col.setValue(t.extra_data.modification_position_in_peptide_col),this.formDFColumn.controls.modification_position_in_protein_col.setValue(t.extra_data.modification_position_in_protein_col),this.formDFColumn.controls.localization_prob_col.setValue(t.extra_data.localization_prob_col)):t.file_category==="searched"?(this.formSearchedColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formSearchedColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formSearchedColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col)):t.file_category==="copy_number"&&(this.formCopyNumberColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formCopyNumberColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formCopyNumberColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col),this.formCopyNumberColumn.controls.rank_col.setValue(t.extra_data.rank_col),this.formCopyNumberColumn.controls.copy_number_col.setValue(t.extra_data.copy_number_col))),this.web.getProjectFileColumns(t.id).subscribe(i=>{this.columns=i})}get file(){return this._file}constructor(t,i,o){this.fb=t,this.matDialogRef=i,this.web=o,this._file=void 0,this.analysisGroupType=void 0,this.formDFColumn=this.fb.group({primary_id_col:new D("",L.required),gene_name_col:new D(""),uniprot_id_col:new D(""),peptide_seq_col:new D(""),modification_position_in_peptide_col:new D(""),modification_position_in_protein_col:new D(""),localization_prob_col:new D("")}),this.formSearchedColumn=this.fb.group({primary_id_col:new D("",L.required),gene_name_col:new D(""),uniprot_id_col:new D("")}),this.formCopyNumberColumn=this.fb.group({primary_id_col:new D("",L.required),gene_name_col:new D(""),uniprot_id_col:new D(""),rank_col:new D(""),copy_number_col:new D("")}),this.columns=[]}save(){let t={file_category:this.file.file_category,extra_data:{}};this.file.file_category==="df"?(this.formDFColumn.controls.uniprot_id_col.value&&(t.extra_data.uniprot_id_col=this.formDFColumn.controls.uniprot_id_col.value),this.formDFColumn.controls.primary_id_col.value&&(t.extra_data.primary_id_col=this.formDFColumn.controls.primary_id_col.value),this.formDFColumn.controls.gene_name_col.value&&(t.extra_data.gene_name_col=this.formDFColumn.controls.gene_name_col.value),this.formDFColumn.controls.modification_position_in_peptide_col.value&&(t.extra_data.modification_position_in_peptide_col=this.formDFColumn.controls.modification_position_in_peptide_col.value),this.formDFColumn.controls.modification_position_in_protein_col.value&&(t.extra_data.modification_position_in_protein_col=this.formDFColumn.controls.modification_position_in_protein_col.value),this.formDFColumn.controls.localization_prob_col.value&&(t.extra_data.localization_prob_col=this.formDFColumn.controls.localization_prob_col.value),this.formDFColumn.controls.peptide_seq_col.value&&(t.extra_data.peptide_seq_col=this.formDFColumn.controls.peptide_seq_col.value)):this.file.file_category==="searched"&&(this.formSearchedColumn.controls.uniprot_id_col.value&&(t.extra_data.uniprot_id_col=this.formSearchedColumn.controls.uniprot_id_col.value),this.formSearchedColumn.controls.primary_id_col.value&&(t.extra_data.primary_id_col=this.formSearchedColumn.controls.primary_id_col.value),this.formSearchedColumn.controls.gene_name_col.value&&(t.extra_data.gene_name_col=this.formSearchedColumn.controls.gene_name_col.value)),this.matDialogRef.close(t)}cancel(){this.matDialogRef.close()}static{this.\u0275fac=function(i){return new(i||e)(A(at),A(mt),A(z))}}static{this.\u0275cmp=H({type:e,selectors:[["app-file-extra-data-modal"]],inputs:{analysisGroupType:"analysisGroupType",file:"file"},standalone:!0,features:[$],decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-button","",3,"click"],[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["formControlName","primary_id_col"],[3,"value"],["formControlName","gene_name_col"],["formControlName","uniprot_id_col"],["formControlName","modification_position_in_peptide_col"],["formControlName","modification_position_in_protein_col"],["formControlName","localization_prob_col"],["formControlName","peptide_seq_col"],["formControlName","rank_col"],["formControlName","copy_number_col"]],template:function(i,o){i&1&&(r(0,"h2",0),m(1,"File Extra Data"),s(),r(2,"div",1),F(3,Ln,3,1),s(),r(4,"mat-dialog-actions")(5,"button",2),v("click",function(){return o.save()}),m(6,"Submit"),s(),r(7,"button",2),v("click",function(){return o.cancel()}),m(8,"Close"),s()()),i&2&&(p(3),M(o.file?3:-1))},dependencies:[pt,ut,J,Q,X,W,nt,ot,Z,ct,wt,tt,dt,Y]})}}return e})();var Rn=gi(xi());Zt.plotlyjs=Rn;var fi=(()=>{class e{set curtainData(t){this._curtainData=t,this.drawVolcanoPlot()}get curtainData(){return this._curtainData}constructor(t,i){this.accounts=t,this.graph=i,this.selected=new et,this._curtainData=void 0,this.graphData=[],this.graphLayout={height:700,width:700,margin:{r:null,l:null,b:null,t:null},xaxis:{title:"<b>Log2FC</b>",tickmode:"linear",ticklen:5,showgrid:!1,visible:!0,tickfont:{size:14,color:"black"}},yaxis:{title:"<b>-log10(p-value)</b>",tickmode:"linear",ticklen:5,showgrid:!1,visible:!0,showticklabels:!0,zeroline:!0,tickfont:{size:14,color:"black"}},annotations:[],showlegend:!0,legend:{orientation:"h"},title:{text:"",font:{size:24,family:"Arial, sans-serif",color:"black"}}},this.revision=0,this.config={toImageButtonOptions:{format:"svg",filename:this.graphLayout.title.text,height:this.graphLayout.height,width:this.graphLayout.width,scale:1}},this.colorMap={},this.graph.redrawTrigger.subscribe(()=>{this.drawVolcanoPlot()})}drawVolcanoPlot(){if(!this.curtainData&&!this.curtainData.settings)return;console.log(this.curtainData),this.graphLayout.title.text=this.curtainData.settings.title,this.colorMap=this.curtainData.settings.colorMap;let t=Object.keys(this.colorMap),i=this.curtainData.data.filter(x=>x["Fold Change"]!==null&&x["Fold Change"]!==void 0&&!isNaN(x["Fold Change"])),o=this.curtainData.data.filter(x=>x["P-value"]!==null&&x["P-value"]!==void 0&&!isNaN(x["P-value"])),a=Math.min(...i.map(x=>x["Fold Change"])),c=Math.max(...i.map(x=>x["Fold Change"])),h=0,u=Math.max(...o.map(x=>x["P-value"]));this.graphLayout.xaxis.range=[a-.5,c+.5],this.graphLayout.yaxis.range=[h,u-h*.5];let f=this.curtainData.settings.volcanoAxis;f.minX&&(this.graphLayout.xaxis.range[0]=f.minX),f.maxX&&(this.graphLayout.xaxis.range[1]=f.maxX),f.minY&&(this.graphLayout.yaxis.range[0]=f.minY),f.maxY&&(this.graphLayout.yaxis.range[1]=f.maxY),f.x&&(this.graphLayout.xaxis.title=`<b>${f.x}</b>`),f.y&&(this.graphLayout.yaxis.title=`<b>${f.y}</b>`);let _={};_.Background={x:[],y:[],mode:"markers",type:"scatter",name:"Background",text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:"#a4a2a2",opacity:.3}};for(let x of this.curtainData.selections)_[x]={x:[],y:[],mode:"markers",type:"scattergl",name:x,text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:this.curtainData.settings.colorMap[x]}};this.curtainData.data.forEach(x=>{if(x["Primary ID"]in this.curtainData.selection_map){let j=this.curtainData.selection_map[x["Primary ID"]];for(let B of this.curtainData.selections)j[B]&&(_[B].x.push(x["Fold Change"]),_[B].y.push(x["P-value"]),_[B].text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),_[B].data.push(x))}else if(this.curtainData.settings.backGroundColorGrey)_.Background.x.push(x["Fold Change"]),_.Background.y.push(x["P-value"]),_.Background.text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),_.Background.data.push(x);else{let j=this.significantGroup(x["Fold Change"],x["P-value"]),B=t.find(K=>K.startsWith(`${j[0]} (${x.Comparison})`));B&&(_[B]||(_[B]={x:[],y:[],mode:"markers",type:"scatter",name:B,text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:this.curtainData.settings.colorMap[B]}}),_[B].x.push(x["Fold Change"]),_[B].y.push(x["P-value"]),_[B].text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),_[B].data.push(x))}}),this.graphData=[];for(let x in _)this.graphData.push(_[x]);this.graphData=this.graphData.reverse();let d=[];d.push({type:"line",x0:-this.curtainData.settings.log2FCCutoff,y0:0,x1:-this.curtainData.settings.log2FCCutoff,y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),d.push({type:"line",x0:this.curtainData.settings.log2FCCutoff,x1:this.curtainData.settings.log2FCCutoff,y0:0,y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1,dash:"dot"}});let C=this.graphLayout.xaxis.range[0]-1;this.curtainData.settings.volcanoAxis.minX&&(C=this.curtainData.settings.volcanoAxis.minX-1);let w=this.graphLayout.xaxis.range[1]+1;if(this.curtainData.settings.volcanoAxis.maxX&&(w=this.curtainData.settings.volcanoAxis.maxX+1),d.push({type:"line",x0:C,x1:w,y0:-Math.log10(this.curtainData.settings.pCutoff),y1:-Math.log10(this.curtainData.settings.pCutoff),line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),this.graphLayout.shapes=d,this.curtainData.settings.volcanoPlotGrid&&(this.graphLayout.yaxis.showgrid=this.curtainData.settings.volcanoPlotGrid.y,this.graphLayout.xaxis.showgrid=this.curtainData.settings.volcanoPlotGrid.x),this.curtainData.settings.volcanoPlotDimension&&(this.curtainData.settings.volcanoPlotDimension.height&&(this.graphLayout.height=this.curtainData.settings.volcanoPlotDimension.height),this.curtainData.settings.volcanoPlotDimension.width&&(this.graphLayout.width=this.curtainData.settings.volcanoPlotDimension.width),this.curtainData.settings.volcanoPlotDimension.margin))for(let x in this.curtainData.settings.volcanoPlotDimension.margin)this.curtainData.settings.volcanoPlotDimension.margin[x]&&(this.graphLayout.margin[x]=this.curtainData.settings.volcanoPlotDimension.margin[x]);if(this.curtainData.settings.volcanoPlotYaxisPosition&&(this.curtainData.settings.volcanoPlotYaxisPosition.includes("left")&&this.graphLayout.shapes.push({type:"line",x0:this.graphLayout.xaxis.range[0],x1:this.graphLayout.xaxis.range[0],y0:this.graphLayout.yaxis.range[0],y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1}}),this.curtainData.settings.volcanoPlotYaxisPosition.includes("middle")?this.graphLayout.xaxis.zerolinecolor="#000000":this.graphLayout.xaxis.zerolinecolor="#ffffff"),this.graphLayout.annotations=[],this.curtainData.settings.textAnnotation)for(let x in this.curtainData.settings.textAnnotation)this.curtainData.settings.textAnnotation[x].data.showannotation===!0&&this.graphLayout.annotations.push(this.curtainData.settings.textAnnotation[x].data);this.config={toImageButtonOptions:{format:"svg",filename:this.graphLayout.title.text,height:this.graphLayout.height,width:this.graphLayout.width,scale:1,margin:this.graphLayout.margin}};let S=document.getElementsByTagName("body")[0],V=window.getComputedStyle(S).backgroundColor;if(this.accounts.userAccount.darkMode){this.graphLayout.plot_bgcolor=V,this.graphLayout.paper_bgcolor=V,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white";for(let x of this.graphLayout.shapes)x.line.color="white";this.graphLayout.yaxis.showgrid&&(this.graphLayout.yaxis.gridcolor="white"),this.graphLayout.xaxis.showgrid&&(this.graphLayout.xaxis.gridcolor="white");for(let x of this.graphLayout.annotations)x.font.color="white",x.arrowcolor="white"}else this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14};if(this.curtainData.settings.volcanoAdditionalShapes)for(let x of this.curtainData.settings.volcanoAdditionalShapes)this.graphLayout.shapes.push(x);this.revision+=1,console.log("cutoff",d),console.log(this.graphData)}significantGroup(t,i){let o=-Math.log10(this.curtainData.settings.pCutoff),a=[],c="";return o>i?(a.push("P-value > "+this.curtainData.settings.pCutoff),c="P-value > "):(a.push("P-value <= "+this.curtainData.settings.pCutoff),c="P-value <= "),Math.abs(t)>this.curtainData.settings.log2FCCutoff?(a.push("FC > "+this.curtainData.settings.log2FCCutoff),c+="FC > "):(a.push("FC <= "+this.curtainData.settings.log2FCCutoff),c+="FC <= "),[a.join(";"),c]}selectData(t){if("points"in t){let i=[];for(let o of t.points)i.push(o.data.data[o.pointIndex]);this.selected.emit(i)}}static{this.\u0275fac=function(i){return new(i||e)(A(qt),A($e))}}static{this.\u0275cmp=H({type:e,selectors:[["app-volcano-plot"]],inputs:{curtainData:"curtainData"},outputs:{selected:"selected"},standalone:!0,features:[$],decls:1,vars:5,consts:[[3,"selected","plotlyClick","data","config","layout","revision","updateOnlyWithRevision"]],template:function(i,o){i&1&&(r(0,"plotly-plot",0),v("selected",function(c){return o.selectData(c)})("plotlyClick",function(c){return o.selectData(c)}),s()),i&2&&g("data",o.graphData)("config",o.config)("layout",o.graphLayout)("revision",o.revision)("updateOnlyWithRevision",!0)},dependencies:[Zt,He]})}}return e})();function Bn(e,n){if(e&1&&(r(0,"mat-form-field"),U(1,"input",12),r(2,"mat-label"),m(3,"Metadata Value"),s()()),e&2){y(2);let t=gt(23);p(),g("matAutocomplete",t)}}function Un(e,n){e&1&&(r(0,"mat-form-field"),U(1,"textarea",13),r(2,"mat-label"),m(3,"Metadata Value"),s()())}function jn(e,n){if(e&1&&F(0,Bn,4,1,"mat-form-field")(1,Un,4,0,"mat-form-field"),e&2){let t=y();M(t.metadataNameAutocomplete.includes(t.form.value.metadataName)?0:1)}}function Hn(e,n){if(e&1&&(r(0,"mat-option",8),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),q(" ",t," ")}}function $n(e,n){if(e&1&&(r(0,"mat-option",8),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),q(" ",t," ")}}function Kn(e,n){if(e&1&&T(0,$n,2,2,"mat-option",8,P),e&2){let t=y();k(t.metadataCharacteristics)}}function qn(e,n){if(e&1&&(r(0,"mat-option",8),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),q(" ",t," ")}}function zn(e,n){if(e&1&&T(0,qn,2,2,"mat-option",8,P),e&2){let t=y();k(t.metadataComment)}}function On(e,n){if(e&1&&(r(0,"mat-option",8),m(1),s()),e&2){let t=n.$implicit;g("value",t),p(),q(" ",t," ")}}function Yn(e,n){if(e&1&&T(0,On,2,2,"mat-option",8,P),e&2){let t=y();k(t.metadataNameAutocomplete)}}function Xn(e,n){if(e&1&&(r(0,"mat-option",8),m(1),s()),e&2){let t=n.$implicit,i=y();g("value",i.displayData(t)),p(),q(" ",i.displayData(t)," ")}}var _i=(()=>{class e{constructor(t,i,o){this.dialog=t,this.fb=i,this.web=o,this.metadataTypeAutocomplete=["Characteristic","Comment","Factor value","Material type","Assay name","Technology type"],this.metadataNameAutocomplete=["Disease","Tissue","Subcellular location"],this.metadataCharacteristics=["Disease","Tissue","Subcellular location","Cell type","Cell line","Developmental stage","Ancestry category","Sex","Age","Biological replicate"],this.metadataComment=["Data file","File uri","Technical replicate","Fraction identifier","Label","Cleavage agent details","Instrument","Modification parameters","Dissociation method","Precursor mass tolerance","Fragment mass tolerance",""],this.form=this.fb.group({metadataType:"Characteristic",metadataName:"Tissue",metadataValue:""}),this.filteredResults=Bt([])}ngOnInit(){this.filteredResults=this.form.controls.metadataValue.valueChanges.pipe(ne(""),ie(t=>t?t.length>=2:!1),oe(t=>t?this.form.controls.metadataName.value==="Subcellular Location"?this.web.getSubcellularLocations(void 0,5,0,t).pipe(Ut(i=>i.results)):this.form.controls.metadataName.value==="Disease"?this.web.getHumandDiseases(void 0,5,0,t).pipe(Ut(i=>i.results)):this.form.controls.metadataName.value==="Tissue"?this.web.getTissues(void 0,5,0,t).pipe(Ut(i=>i.results)):Bt([]):Bt([])))}close(){this.dialog.close()}submit(){this.dialog.close(this.form.value)}displayData(t){return t?"identifier"in t?t.identifier:t.location_identifier:""}static{this.\u0275fac=function(i){return new(i||e)(A(mt),A(at),A(z))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-metadata-creation-dialog"]],standalone:!0,features:[$],decls:32,vars:8,consts:[["autoMetadataType","matAutocomplete"],["autoMetadataName","matAutocomplete"],["autoMetadataValue","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","formControlName","metadataName",3,"matAutocomplete"],["matInput","","formControlName","metadataType",3,"matAutocomplete"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"],["matInput","","formControlName","metadataValue",3,"matAutocomplete"],["matInput","","formControlName","metadataValue"]],template:function(i,o){if(i&1){let a=R();r(0,"h1",3),m(1,"Adding New Metadata"),s(),r(2,"div",4)(3,"form",5)(4,"mat-form-field"),U(5,"input",6),r(6,"mat-label"),m(7,"Metadata Name"),s()(),r(8,"mat-form-field"),U(9,"input",7),r(10,"mat-label"),m(11,"Metadata Type"),s()(),F(12,jn,2,1),r(13,"mat-autocomplete",null,0),T(15,Hn,2,2,"mat-option",8,P),s(),r(17,"mat-autocomplete",null,1),F(19,Kn,2,0)(20,zn,2,0)(21,Yn,2,0),s(),r(22,"mat-autocomplete",null,2),T(24,Xn,2,2,"mat-option",8,P),ue(26,"async"),s()()(),r(27,"div",9)(28,"button",10),v("click",function(){return E(a),G(o.close())}),m(29,"Cancel"),s(),r(30,"button",11),v("click",function(){return E(a),G(o.submit())}),m(31,"Submit"),s()()}if(i&2){let a=gt(14),c=gt(18);p(3),g("formGroup",o.form),p(2),g("matAutocomplete",c),p(4),g("matAutocomplete",a),p(3),M(o.form.value.metadataName?12:-1),p(3),k(o.metadataTypeAutocomplete),p(4),M(o.form.value.metadataType==="Characteristic"?19:o.form.value.metadataType==="Comment"?20:21),p(5),k(de(26,6,o.filteredResults)),p(6),g("disabled",!o.form.valid)}},dependencies:[pt,ut,J,Q,it,X,W,nt,ot,he,Fe,ct,tt,rt,Ee,Y,dt,Z]})}}return e})();var Wn=(e,n)=>n.id;function Qn(e,n){if(e&1){let t=R();r(0,"button",6),v("click",function(){E(t);let o=y().$implicit,a=y();return a.metadataDeleted.emit(o),G(a.markedForDeletion.push(o))}),r(1,"mat-icon"),m(2,"delete"),s()()}}function Jn(e,n){if(e&1){let t=R();r(0,"button",6),v("click",function(){E(t);let o=y().$implicit,a=y();return G(a.undoDeletion(o))}),r(1,"mat-icon"),m(2,"undo"),s()()}}function Zn(e,n){if(e&1){let t=R();r(0,"div",1)(1,"mat-form-field",3)(2,"textarea",4),pe("ngModelChange",function(o){let a=E(t).$implicit;return me(a.value,o)||(a.value=o),G(o)}),s(),r(3,"mat-label"),m(4),s()(),F(5,Qn,3,0,"button",5)(6,Jn,3,0,"button",5),s()}if(e&2){let t=n.$implicit,i=y();p(2),ce("ngModel",t.value),g("disabled",i.markedForDeletion.includes(t)),p(2),N(t.name),p(),M(i.markedForDeletion.includes(t)?6:5)}}var Ci=(()=>{class e{set metadata(t){this._metadata=t.filter(i=>!i.source_file)}get metadata(){return this._metadata}constructor(t,i){this.web=t,this.dialog=i,this.displayedColumns=["metadataType","metadataName","metadataValue"],this.analysis_group_id=0,this._metadata=[],this.metadataChange=new et,this.metadataDeleted=new et,this.markedForDeletion=[]}ngOnInit(){}createMetadata(){this.dialog.open(_i).afterClosed().subscribe(i=>{i&&this.web.createMetaDataColumn(this.analysis_group_id,i).subscribe(o=>{this.metadata.push(...o),this.metadataChange.emit(this.metadata)})})}undoDeletion(t){this.markedForDeletion=this.markedForDeletion.filter(i=>i!==t),this.metadataDeleted.emit(t)}static{this.\u0275fac=function(i){return new(i||e)(A(z),A(Ht))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-general-metadata"]],inputs:{analysis_group_id:"analysis_group_id",metadata:"metadata"},outputs:{metadataChange:"metadataChange",metadataDeleted:"metadataDeleted"},standalone:!0,features:[$],decls:5,vars:0,consts:[[2,"display","flex","flex-direction","column","gap","20px"],[2,"display","flex","gap","20px"],["mat-flat-button","","type","button","color","primary",3,"click"],[2,"flex-grow","1"],["matInput","",3,"ngModelChange","ngModel","disabled"],["mat-icon-button","","type","button"],["mat-icon-button","","type","button",3,"click"]],template:function(i,o){i&1&&(r(0,"div",0),T(1,Zn,7,4,"div",1,Wn),s(),r(3,"button",2),v("click",function(){return o.createMetadata()}),m(4,"Add Metadata"),s()),i&2&&(p(),k(o.metadata))},dependencies:[Y,xt,bt,Mt,it,X,_e,rt,tt,Z]})}}return e})();function to(e,n){if(e&1){let t=R();r(0,"div",0)(1,"app-volcano-plot",3),v("selected",function(o){E(t);let a=y();return G(a.handleVolcanoSelection(o))}),s()()}if(e&2){let t=y();p(),g("curtainData",t.curtainData)}}function eo(e,n){if(e&1&&(r(0,"p")(1,"b"),m(2,"Associated Project: "),s(),r(3,"a",19),m(4),s()()),e&2){let t=y(2);p(3),ae("href","/#/project/",t.analysisGroup.project,"",Qt),p(),N(t.associatedProject.name)}}function io(e,n){if(e&1&&(r(0,"p")(1,"b"),m(2,"Curtain Link: "),s(),r(3,"a",19),m(4),s()()),e&2){let t=y(2);p(3),jt("href",t.analysisGroup.curtain_link,Qt),p(),N(t.analysisGroup.curtain_link)}}function no(e,n){if(e&1){let t=R();r(0,"app-analysis-group-general-metadata",20),v("metadataDeleted",function(o){E(t);let a=y(2);return G(a.updateDeletionList(o))}),s()}if(e&2){let t=y(2);g("analysis_group_id",t.analysisGroup.id)("metadata",t.analysisGroup.metadata_columns)}}function oo(e,n){if(e&1&&(r(0,"p"),m(1),s(),U(2,"mat-progress-bar",21)),e&2){let t=y(2);p(),N(t.composingCurtainProgress.message),p(),g("value",t.composingCurtainProgress.progress)("mode","determinate")("color","primary")}}function ao(e,n){if(e&1){let t=R();r(0,"button",22),v("click",function(){E(t);let o=y(2);return G(o.composeDataFromCurtain())}),m(1,"Use Curtain Link For Data"),s()}if(e&2){let t=y(2);g("disabled",!t.canEdit)}}function ro(e,n){if(e&1&&m(0),e&2){let t=y(2);q(": ",t.analysisGroupDF.name,"")}}function so(e,n){if(e&1){let t=R();r(0,"app-upload-file",23),v("fileUploaded",function(o){E(t);let a=y(2);return G(a.handleFileUploaded(o,"df"))}),s()}if(e&2){let t=y(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","df")}}function lo(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(3);return G(o.deleteFile(o.analysisGroupDF))}),r(1,"mat-icon"),m(2,"delete"),s()(),r(3,"button",25),v("click",function(){E(t);let o=y(3);return G(o.openExtraDataModal(o.analysisGroupDF))}),m(4,"Extra Data"),s()}if(e&2){let t=y(3);p(3),g("disabled",!t.accounts.loggedIn)}}function co(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(2);return G(o.downloadFile(o.analysisGroupDF))}),r(1,"mat-icon"),m(2,"download"),s()(),F(3,lo,5,1)}if(e&2){let t=y(2);p(3),M(t.canEdit?3:-1)}}function mo(e,n){if(e&1&&m(0),e&2){let t=y(2);q(": ",t.analysisGroupSearched.name,"")}}function po(e,n){if(e&1){let t=R();r(0,"app-upload-file",23),v("fileUploaded",function(o){E(t);let a=y(2);return G(a.handleFileUploaded(o,"searched"))}),s()}if(e&2){let t=y(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","searched")}}function uo(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(3);return G(o.deleteFile(o.analysisGroupSearched))}),r(1,"mat-icon"),m(2,"delete"),s()(),r(3,"button",25),v("click",function(){E(t);let o=y(3);return G(o.openExtraDataModal(o.analysisGroupSearched))}),m(4,"Extra Data"),s()}if(e&2){let t=y(3);p(3),g("disabled",!t.accounts.loggedIn)}}function ho(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(2);return G(o.downloadFile(o.analysisGroupSearched))}),r(1,"mat-icon"),m(2,"download"),s()(),F(3,uo,5,1)}if(e&2){let t=y(2);p(3),M(t.canEdit?3:-1)}}function fo(e,n){if(e&1&&m(0),e&2){let t=y(2);q(": ",t.analysisGroupCopyNumber.name,"")}}function _o(e,n){if(e&1){let t=R();r(0,"app-upload-file",23),v("fileUploaded",function(o){E(t);let a=y(2);return G(a.handleFileUploaded(o,"copy_number"))}),s()}if(e&2){let t=y(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","copy_number")}}function Co(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(3);return G(o.deleteFile(o.analysisGroupCopyNumber))}),r(1,"mat-icon"),m(2,"delete"),s()(),r(3,"button",25),v("click",function(){E(t);let o=y(3);return G(o.openExtraDataModal(o.analysisGroupCopyNumber))}),m(4,"Extra Data"),s()}if(e&2){let t=y(3);p(3),g("disabled",!t.canEdit)}}function yo(e,n){if(e&1){let t=R();r(0,"button",24),v("click",function(){E(t);let o=y(2);return G(o.downloadFile(o.analysisGroupCopyNumber))}),r(1,"mat-icon"),m(2,"download"),s()(),F(3,Co,5,1)}if(e&2){let t=y(2);p(3),M(t.canEdit?3:-1)}}function go(e,n){if(e&1&&m(0),e&2){let t=y(3);q("(",t.sampleAnnotations.annotations.length,")")}}function xo(e,n){if(e&1){let t=R();r(0,"button",25),v("click",function(){E(t);let o=y(2);return G(o.setAnnotationModal(o.analysisGroupSearched))}),m(1,"Sample Annotation "),F(2,go,1,1),s()}if(e&2){let t=y(2);g("disabled",!t.canEdit),p(2),M(t.sampleAnnotations?2:-1)}}function bo(e,n){if(e&1&&m(0),e&2){let t=y(3);q("(",t.comparisonMatrix.matrix.length,")")}}function wo(e,n){if(e&1){let t=R();r(0,"button",25),v("click",function(){E(t);let o=y(2);return G(o.setComparisonMatrixModal(o.sampleAnnotations,o.analysisGroupSearched,o.analysisGroupDF))}),m(1,"Comparison Matrix "),F(2,bo,1,1),s()}if(e&2){let t=y(2);g("disabled",!t.canEdit),p(2),M(t.comparisonMatrix?2:-1)}}function vo(e,n){if(e&1){let t=R();F(0,eo,5,3,"p")(1,io,5,2,"p"),r(2,"form",4),v("ngSubmit",function(){E(t);let o=y();return G(o.updateAnalysisGroup())}),r(3,"mat-form-field",2),U(4,"input",5),r(5,"mat-label"),m(6,"Analysis Group Name"),s()(),r(7,"mat-form-field",2),U(8,"textarea",6),r(9,"mat-label"),m(10,"Analysis Group Description"),s()(),F(11,no,1,2,"app-analysis-group-general-metadata",7),r(12,"div",8)(13,"mat-form-field",2),U(14,"input",9),r(15,"mat-label"),m(16,"Curtain Link"),s()(),r(17,"button",10),v("click",function(){E(t);let o=y();return G(o.refreshCurtainLink())}),r(18,"mat-icon"),m(19,"refresh"),s()()(),F(20,oo,3,4),r(21,"div",8)(22,"button",11),m(23,"Update Analysis Group"),s(),F(24,ao,2,1,"button",12),s()(),r(25,"div",13)(26,"div")(27,"p"),m(28,"Differential Analysis File "),F(29,ro,1,1),s()(),F(30,so,1,2,"app-upload-file",14)(31,co,4,1),s(),r(32,"div",13)(33,"div")(34,"p"),m(35,"Searched File "),F(36,mo,1,1),s()(),F(37,po,1,2,"app-upload-file",14)(38,ho,4,1),s(),r(39,"div",13)(40,"div")(41,"p"),m(42,"Copy Number File "),F(43,fo,1,1),s()(),F(44,_o,1,2,"app-upload-file",14)(45,yo,4,1),s(),r(46,"div",15),F(47,xo,3,2,"button",16)(48,wo,3,2,"button",16),r(49,"button",17),v("click",function(){E(t);let o=y();return G(o.openSearchModal())}),r(50,"mat-icon"),m(51,"search"),s()(),r(52,"button",18),v("click",function(){E(t);let o=y();return G(o.deleteAnalysisGroup())}),r(53,"mat-icon"),m(54,"delete"),s()()()}if(e&2){let t=y();M(t.associatedProject?0:-1),p(),M(t.analysisGroup.curtain_link?1:-1),p(),g("formGroup",t.form),p(9),M(t.analysisGroup?11:-1),p(6),g("disabled",!t.canEdit),p(3),M(t.composingCurtainProgress.started?20:-1),p(2),g("disabled",!t.canEdit),p(2),M(t.analysisGroup.curtain_link?24:-1),p(5),M(t.analysisGroupDF?29:-1),p(),M(t.canEdit?30:-1),p(),M(t.analysisGroupDF?31:-1),p(5),M(t.analysisGroupSearched?36:-1),p(),M(t.canEdit?37:-1),p(),M(t.analysisGroupSearched?38:-1),p(5),M(t.analysisGroupCopyNumber?43:-1),p(),M(t.canEdit?44:-1),p(),M(t.analysisGroupCopyNumber?45:-1),p(2),M(t.analysisGroupSearched?47:-1),p(),M(t.sampleAnnotations&&t.analysisGroupSearched&&t.analysisGroupDF?48:-1),p(4),g("disabled",!t.canEdit)}}var xr=(()=>{class e{set analysisGroup(t){this._analysisGroup=t,t&&this.accounts.getAnalysisGroupPermissions(t.id).subscribe(i=>{this.canEdit=i.edit}),this.curtainData=void 0,t&&(t.curtain_link&&this.getCurtainData(),this.dataService.analysisGroupChoices.forEach(i=>{i.value===t.analysis_group_type&&(this.analysisType=i.label)}),this.titleService.setTitle(`AG - ${t.name}`),this.web.getProject(t.project).subscribe(i=>{this.associatedProject=i}),this.form.controls.name.setValue(t.name),this.form.controls.description.setValue(t.description),this.form.controls.curtain_link.setValue(t.curtain_link),this.getFiles(t))}getFiles(t){this.web.getAnalysisGroupFiles(t.id).subscribe(i=>{this.analysisGroupDF=i.find(o=>o.file_category==="df"),this.analysisGroupSearched=i.find(o=>o.file_category==="searched"),this.analysisGroupSearched&&this.web.getProjectFileSampleAnnotations(this.analysisGroupSearched.id).subscribe(o=>{this.sampleAnnotations=o}),this.analysisGroupDF&&this.web.getProjectFileComparisonMatrix(this.analysisGroupDF.id).subscribe(o=>{this.comparisonMatrix=o})})}get analysisGroup(){return this._analysisGroup}constructor(t,i,o,a,c,h,u,f){this.sb=t,this.dataService=i,this.titleService=o,this.fb=a,this.web=c,this.matDialog=h,this.accounts=u,this.ws=f,this.analysisType="proteomics",this.canEdit=!1,this.composingCurtainProgress={progress:0,message:"",completed:!1,error:!1,started:!1},this.deleted=new et,this.updated=new et,this.form=this.fb.group({name:new D({value:"",disabled:!this.accounts.loggedIn},{validators:[L.required]}),description:new D({value:"",disabled:!this.accounts.loggedIn},{validators:[L.required]}),curtain_link:new D({value:"",disabled:!this.accounts.loggedIn})}),this.metadataDeletionList=[],this.ws.curtainWSConnection?.subscribe(_=>{if(_.analysis_group_id===this.analysisGroup?.id){if(_.type==="curtain_status")switch(_.status){case"started":this.sb.open("Curtain link retrieval started","Dismiss",{duration:5e3});break;case"complete":this.sb.open("Curtain link retrieval complete","Dismiss",{duration:5e3}),this.getCurtainData();break}else if(_.type==="curtain_compose_status")switch(_.status){case"started":this.sb.open("Composing data from Curtain started","Dismiss",{duration:5e3}),this.composingCurtainProgress.progress=30,this.composingCurtainProgress.message="Removed analysis group associated data if exist";break;case"complete":this.sb.open("Composing data from Curtain completed. Please manually set Condition A and Condition B in Comparison Matrix.","Dismiss"),this.composingCurtainProgress.progress=100,this.composingCurtainProgress.message="Composing data from Curtain completed. Please manually set Condition A and Condition B in Comparison Matrix.",this.composingCurtainProgress.completed=!0,this.web.getAnalysisGroup(this.analysisGroup.id).subscribe(d=>{this.analysisGroup=d});break;case"error":this.sb.open("Error composing data from Curtain","Dismiss",{duration:5e3}),this.composingCurtainProgress.error=!0;break}}})}updateAnalysisGroup(){return It(this,null,function*(){if(this.form.invalid)return;if(this.metadataDeletionList.length>0)for(let i of this.metadataDeletionList)yield this.web.deleteMetaDataColumn(i.id).toPromise();let t=yield this.web.updateAnalysisGroup(this.analysisGroup.id,this.form.value.name,this.form.value.description,this.form.value.curtain_link,this.web.searchSessionID).toPromise();this.metadataDeletionList=[],this.updated.emit(t)})}getCurtainData(){this.analysisGroup&&(this.sb.open("Retrieving curtain visualization","Dismiss",{duration:5e3}),this.web.getCurtainLinkData(this.analysisGroup.id).subscribe(t=>{this.curtainData=t,this.sb.open("Curtain visualization retrieved","Dismiss",{duration:5e3})},t=>{this.sb.open("Error retrieving curtain visualization","Dismiss",{duration:5e3}),this.curtainData=void 0}))}handleFileUploaded(t,i){i==="searched"?(this.analysisGroupSearched=t,this.web.getProjectFileSampleAnnotations(t.id).subscribe(o=>{this.sampleAnnotations=o}),this.sb.open("Searched File uploaded","Dismiss",{duration:5e3})):i==="df"?(this.analysisGroupDF=t,this.web.getProjectFileComparisonMatrix(this.analysisGroupDF.id).subscribe(o=>{this.comparisonMatrix=o}),this.sb.open("Differential Analysis File uploaded","Dismiss",{duration:5e3})):i==="copy_number"&&(this.analysisGroupCopyNumber=t,this.sb.open("Copy Number Analysis File uploaded","Dismiss",{duration:5e3}))}setAnnotationModal(t){let i=this.matDialog.open(pi);i.componentInstance.projectFile=t,this.sampleAnnotations&&(i.componentInstance.annotation=this.sampleAnnotations),i.afterClosed().subscribe(o=>{o&&(console.log(this.sampleAnnotations),this.sampleAnnotations?this.web.updateSampleAnnotation(this.sampleAnnotations.id,this.sampleAnnotations.name,o).subscribe(a=>{this.sampleAnnotations=a,this.sb.open("Sample annotation updated","Dismiss",{duration:5e3})}):this.web.createSampleAnnotation(this.analysisGroup.id,this.analysisGroup?.name+" sample annotation",o,this.analysisGroupSearched.id).subscribe(a=>{this.sampleAnnotations=a,this.sb.open("Sample annotation created","Dismiss",{duration:5e3})}))})}setComparisonMatrixModal(t,i,o){let a=this.matDialog.open(ui);a.componentInstance.sampleAnnotations=t,a.componentInstance.projectFile=o,this.comparisonMatrix&&(a.componentInstance.comparisonMatrix=this.comparisonMatrix),a.afterClosed().subscribe(c=>{c&&(this.comparisonMatrix?this.web.updateComparisonMatrix(this.comparisonMatrix.id,this.comparisonMatrix.name,c).subscribe(h=>{this.comparisonMatrix=h,this.sb.open("Comparison matrix updated","Dismiss",{duration:5e3})}):this.web.createComparisonMatrix(this.analysisGroup.id,this.analysisGroup?.name+" comparison matrix",c,o.id).subscribe(h=>{this.comparisonMatrix=h,this.sb.open("Comparison matrix created","Dismiss",{duration:5e3})}))})}deleteAnalysisGroup(){this.matDialog.open(Jt).afterClosed().subscribe(t=>{t&&this.web.deleteAnalysisGroup(this.analysisGroup.id).subscribe(()=>{this.deleted.emit(!0),this.sb.open("Analysis Group deleted","Dismiss",{duration:5e3})})})}openSearchModal(){let t=this.matDialog.open(di);t.componentInstance.analysisGroupIDs=[this.analysisGroup.id],t.afterClosed().subscribe(i=>{i&&window.open(`/#/search-session/${i}`,"_blank")})}openExtraDataModal(t){let i=this.matDialog.open(hi);i.componentInstance.analysisGroupType=this.analysisGroup?.analysis_group_type,i.componentInstance.file=t,i.afterClosed().subscribe(o=>{o&&this.web.updateProjectFileExtraData(t.id,o.extra_data).subscribe(a=>{t.file_category==="df"?(this.analysisGroupDF=a,this.sb.open("Differential Analysis extra data updated","Dismiss",{duration:5e3})):t.file_category==="searched"?(this.analysisGroupSearched=a,this.sb.open("Searched extra data updated","Dismiss",{duration:5e3})):t.file_category==="copy_number"&&(this.analysisGroupCopyNumber=a,this.sb.open("Copy Number extra data updated","Dismiss",{duration:5e3}))})})}refreshCurtainLink(){this.analysisGroup&&this.web.searchSessionID&&this.web.refreshCurtainLink(this.analysisGroup.id,this.web.searchSessionID).subscribe(t=>{this.analysisGroup=t,this.sb.open("Curtain data content refreshed","Dismiss",{duration:5e3})})}handleVolcanoSelection(t){console.log(t)}composeDataFromCurtain(){this.composingCurtainProgress={progress:0,message:"",completed:!1,error:!1},this.analysisGroup&&this.web.searchSessionID&&(this.composingCurtainProgress.started=!0,this.web.composeAnalysisGroupFilesFromCurtainData(this.analysisGroup.id,this.web.searchSessionID).subscribe(t=>{this.composingCurtainProgress.progress=10,this.composingCurtainProgress.message="Data composition started",this.sb.open("Data composition started","Dismiss",{duration:5e3})}))}deleteFile(t){this.matDialog.open(Jt).afterClosed().subscribe(i=>{i&&this.web.deleteProjectFile(t.id).subscribe(()=>{t.file_category==="df"?(this.analysisGroupDF=void 0,this.sb.open("Differential Analysis File deleted","Dismiss",{duration:5e3})):t.file_category==="searched"?(this.analysisGroupSearched=void 0,this.sb.open("Searched File deleted","Dismiss",{duration:5e3})):t.file_category==="copy_number"&&(this.analysisGroupCopyNumber=void 0,this.sb.open("Copy Number Analysis File deleted","Dismiss",{duration:5e3}))})})}downloadFile(t){this.web.getFileDownloadToken(t.id).subscribe(i=>{window.open(`${this.web.baseURL}/api/project_files/download/?token=${i.token}`)})}updateDeletionList(t){this.metadataDeletionList.includes(t)?this.metadataDeletionList=this.metadataDeletionList.filter(i=>i!==t):this.metadataDeletionList.push(t)}static{this.\u0275fac=function(i){return new(i||e)(A(Kt),A($t),A(fe),A(at),A(z),A(Ht),A(qt),A(zt))}}static{this.\u0275cmp=H({type:e,selectors:[["app-analysis-group-view"]],inputs:{analysisGroup:"analysisGroup"},outputs:{deleted:"deleted",updated:"updated"},standalone:!0,features:[$],decls:4,vars:2,consts:[[2,"display","flex","flex-direction","row","justify-content","center","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","justify-content","center","padding","50px"],[2,"width","100%"],[3,"selected","curtainData"],[2,"display","flex","flex-direction","column","gap","20px","padding","20px",3,"ngSubmit","formGroup"],["matInput","","formControlName","name","type","text","placeholder","Analysis Group Name"],["matInput","","formControlName","description","placeholder","Analysis Group Description"],[3,"analysis_group_id","metadata"],[2,"display","flex","flex-direction","row","gap","10px"],["matInput","","formControlName","curtain_link","type","text","placeholder","Curtain Link"],["mat-icon-button","","type","button",3,"click","disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["mat-flat-button","","color","primary","type","button",3,"disabled"],[2,"display","flex","flex-direction","row","gap","20px","align-items","center"],[3,"analysisGroupId","fileCategory"],[2,"display","flex","flex-direction","row","gap","20px","padding","20px"],["mat-flat-button","","color","primary",3,"disabled"],["mat-icon-button","","color","accent",3,"click"],["mat-icon-button","",3,"click","disabled"],["target","_blank",3,"href"],[3,"metadataDeleted","analysis_group_id","metadata"],[3,"value","mode","color"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],[3,"fileUploaded","analysisGroupId","fileCategory"],["mat-icon-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"]],template:function(i,o){i&1&&(F(0,to,2,1,"div",0),r(1,"div",1)(2,"div",2),F(3,vo,55,20),s()()),i&2&&(M(o.curtainData?0:-1),p(3),M(o.analysisGroup?3:-1))},dependencies:[Mt,Q,it,X,W,Y,tt,xt,rt,Z,J,nt,ot,mi,bt,fi,Ot,Ci]})}}return e})();export{Go as a,xr as b};
