import{a as td}from"./chunk-5FZDEB73.js";import{a as Zc}from"./chunk-LT5OS7KN.js";import{a as Qc,b as Tp,c as ed,d as Bl,e as Kn,f as as,g as Dn,h as An,i as Ri}from"./chunk-4PVRXQAO.js";import{a as is,b as Di,c as Ai,d as Pi}from"./chunk-YE4PZOJH.js";import{a as Ho}from"./chunk-I7KSBDRZ.js";import{a as Uo,b as $o}from"./chunk-ON4LJNYO.js";import{a as qr}from"./chunk-GBHZXXOL.js";import{a as Jc,b as rs,c as ns}from"./chunk-JZVXNH5J.js";import{a as Wo,b as Yo,c as Xo,d as qo,e as Ko,f as Zo,g as Qo,h as Jo,i as es,j as ts}from"./chunk-LE3F4ORG.js";import{a as _i,b as kc,c as Si,d as Fc,e as Bc,f as Vc,g as Go,h as jo}from"./chunk-YYO262FZ.js";import{a as Bo,b as Vo,c as Xc,d as zo,e as qc,f as Kc}from"./chunk-GH6BASN2.js";import{a as Fr}from"./chunk-DZJ2KETN.js";import{a as Lo,c as Uc,d as $c,e as Wc,f as Io,g as Yc,h as No}from"./chunk-25CFQFJY.js";import{a as Ot,c as _n,d as Lt,e as It,f as Nt,g as Kr}from"./chunk-NPOKFU2J.js";import{Aa as Hc,Ba as gr,Ca as mr,Da as Ut,Ea as Mn,Fa as rr,Ha as yr,Ma as $t,Na as nr,Oa as ko,Pa as Mi,Q as Tn,Qa as Fo,Sa as Cr,V as Qt,W as xt,X as Xr,oa as Gc,pa as Jt,ra as Nr,ta as St,ua as er,va as jc,wa as kr,xa as Sn,ya as tr,za as Oo}from"./chunk-G4XN575R.js";import{c as zc,d as Il,g as un,i as Nl,j as kl,l as va,m as Fl}from"./chunk-3CIC7QKD.js";import{h as Ic,l as Ti,p as Nc}from"./chunk-OTVSX5VU.js";import{Aa as bt,Cb as Sc,Cc as En,D as yc,Db as Mc,Ea as Al,Eb as De,Fb as xn,Gb as To,H as mo,Hb as Dc,Kb as $e,Lb as Ir,Mb as ot,Nb as st,Ob as X,Pb as J,Qb as Be,Rb as jt,Sb as Ht,Ub as We,Xb as ye,Xc as Rc,Yc as Oc,Z as yo,Zb as ce,Zc as Ll,_ as Co,_c as Ao,a as Pt,ac as _o,ad as Po,b as Yr,bb as Ec,bc as Ol,c as Ml,cb as Tc,cd as Ro,d as fa,da as Cc,db as Pl,e as po,ea as Dl,eb as ae,ec as bi,f as Et,fa as wo,fb as Le,fc as xi,gc as Ei,id as Lc,ja as bo,jb as _c,jc as fr,kc as se,lc as pt,mc as it,nc as Ac,oc as hr,pa as wc,pc as vr,qa as Ae,qc as pr,ra as Pe,rb as qe,rc as Pc,sa as xo,sb as Eo,sc as So,ta as bc,tb as Rl,tc as ha,va as xc,vc as Mo,wc as Do,x as go,xb as Fe}from"./chunk-ZY3XLMOC.js";var ld=fa((pa,zl)=>{"use strict";(function(r,e){typeof pa=="object"&&typeof zl=="object"?zl.exports=e():typeof define=="function"&&define.amd?define([],e):typeof pa=="object"?pa.QRCodeStyling=e():r.QRCodeStyling=e()})(pa,()=>(()=>{var r={873:(i,a)=>{var o,s,u=function(){var l=function(w,T){var E=w,b=p[T],C=null,_=0,M=null,A=[],F={},N=function(k,G){C=function($){for(var te=new Array($),q=0;q<$;q+=1){te[q]=new Array($);for(var ge=0;ge<$;ge+=1)te[q][ge]=null}return te}(_=4*E+17),z(0,0),z(_-7,0),z(0,_-7),U(),Y(),Q(k,G),E>=7&&ee(k),M==null&&(M=K(E,b,A)),j(M,G)},z=function(k,G){for(var $=-1;$<=7;$+=1)if(!(k+$<=-1||_<=k+$))for(var te=-1;te<=7;te+=1)G+te<=-1||_<=G+te||(C[k+$][G+te]=0<=$&&$<=6&&(te==0||te==6)||0<=te&&te<=6&&($==0||$==6)||2<=$&&$<=4&&2<=te&&te<=4)},Y=function(){for(var k=8;k<_-8;k+=1)C[k][6]==null&&(C[k][6]=k%2==0);for(var G=8;G<_-8;G+=1)C[6][G]==null&&(C[6][G]=G%2==0)},U=function(){for(var k=m.getPatternPosition(E),G=0;G<k.length;G+=1)for(var $=0;$<k.length;$+=1){var te=k[G],q=k[$];if(C[te][q]==null)for(var ge=-2;ge<=2;ge+=1)for(var Te=-2;Te<=2;Te+=1)C[te+ge][q+Te]=ge==-2||ge==2||Te==-2||Te==2||ge==0&&Te==0}},ee=function(k){for(var G=m.getBCHTypeNumber(E),$=0;$<18;$+=1){var te=!k&&(G>>$&1)==1;C[Math.floor($/3)][$%3+_-8-3]=te}for($=0;$<18;$+=1)te=!k&&(G>>$&1)==1,C[$%3+_-8-3][Math.floor($/3)]=te},Q=function(k,G){for(var $=b<<3|G,te=m.getBCHTypeInfo($),q=0;q<15;q+=1){var ge=!k&&(te>>q&1)==1;q<6?C[q][8]=ge:q<8?C[q+1][8]=ge:C[_-15+q][8]=ge}for(q=0;q<15;q+=1)ge=!k&&(te>>q&1)==1,q<8?C[8][_-q-1]=ge:q<9?C[8][15-q-1+1]=ge:C[8][15-q-1]=ge;C[_-8][8]=!k},j=function(k,G){for(var $=-1,te=_-1,q=7,ge=0,Te=m.getMaskFunction(G),he=_-1;he>0;he-=2)for(he==6&&(he-=1);;){for(var ue=0;ue<2;ue+=1)if(C[te][he-ue]==null){var de=!1;ge<k.length&&(de=(k[ge]>>>q&1)==1),Te(te,he-ue)&&(de=!de),C[te][he-ue]=de,(q-=1)==-1&&(ge+=1,q=7)}if((te+=$)<0||_<=te){te-=$,$=-$;break}}},K=function(k,G,$){for(var te=x.getRSBlocks(k,G),q=S(),ge=0;ge<$.length;ge+=1){var Te=$[ge];q.put(Te.getMode(),4),q.put(Te.getLength(),m.getLengthInBits(Te.getMode(),k)),Te.write(q)}var he=0;for(ge=0;ge<te.length;ge+=1)he+=te[ge].dataCount;if(q.getLengthInBits()>8*he)throw"code length overflow. ("+q.getLengthInBits()+">"+8*he+")";for(q.getLengthInBits()+4<=8*he&&q.put(0,4);q.getLengthInBits()%8!=0;)q.putBit(!1);for(;!(q.getLengthInBits()>=8*he||(q.put(236,8),q.getLengthInBits()>=8*he));)q.put(17,8);return function(ue,de){for(var me=0,_e=0,xe=0,Ce=new Array(de.length),Ee=new Array(de.length),be=0;be<de.length;be+=1){var fe=de[be].dataCount,V=de[be].totalCount-fe;_e=Math.max(_e,fe),xe=Math.max(xe,V),Ce[be]=new Array(fe);for(var re=0;re<Ce[be].length;re+=1)Ce[be][re]=255&ue.getBuffer()[re+me];me+=fe;var le=m.getErrorCorrectPolynomial(V),W=y(Ce[be],le.getLength()-1).mod(le);for(Ee[be]=new Array(le.getLength()-1),re=0;re<Ee[be].length;re+=1){var Z=re+W.getLength()-Ee[be].length;Ee[be][re]=Z>=0?W.getAt(Z):0}}var ie=0;for(re=0;re<de.length;re+=1)ie+=de[re].totalCount;var ne=new Array(ie),oe=0;for(re=0;re<_e;re+=1)for(be=0;be<de.length;be+=1)re<Ce[be].length&&(ne[oe]=Ce[be][re],oe+=1);for(re=0;re<xe;re+=1)for(be=0;be<de.length;be+=1)re<Ee[be].length&&(ne[oe]=Ee[be][re],oe+=1);return ne}(q,te)};F.addData=function(k,G){var $=null;switch(G=G||"Byte"){case"Numeric":$=D(k);break;case"Alphanumeric":$=P(k);break;case"Byte":$=R(k);break;case"Kanji":$=L(k);break;default:throw"mode:"+G}A.push($),M=null},F.isDark=function(k,G){if(k<0||_<=k||G<0||_<=G)throw k+","+G;return C[k][G]},F.getModuleCount=function(){return _},F.make=function(){if(E<1){for(var k=1;k<40;k++){for(var G=x.getRSBlocks(k,b),$=S(),te=0;te<A.length;te++){var q=A[te];$.put(q.getMode(),4),$.put(q.getLength(),m.getLengthInBits(q.getMode(),k)),q.write($)}var ge=0;for(te=0;te<G.length;te++)ge+=G[te].dataCount;if($.getLengthInBits()<=8*ge)break}E=k}N(!1,function(){for(var Te=0,he=0,ue=0;ue<8;ue+=1){N(!0,ue);var de=m.getLostPoint(F);(ue==0||Te>de)&&(Te=de,he=ue)}return he}())},F.createTableTag=function(k,G){k=k||2;var $="";$+='<table style="',$+=" border-width: 0px; border-style: none;",$+=" border-collapse: collapse;",$+=" padding: 0px; margin: "+(G=G===void 0?4*k:G)+"px;",$+='">',$+="<tbody>";for(var te=0;te<F.getModuleCount();te+=1){$+="<tr>";for(var q=0;q<F.getModuleCount();q+=1)$+='<td style="',$+=" border-width: 0px; border-style: none;",$+=" border-collapse: collapse;",$+=" padding: 0px; margin: 0px;",$+=" width: "+k+"px;",$+=" height: "+k+"px;",$+=" background-color: ",$+=F.isDark(te,q)?"#000000":"#ffffff",$+=";",$+='"/>';$+="</tr>"}return($+="</tbody>")+"</table>"},F.createSvgTag=function(k,G,$,te){var q={};typeof arguments[0]=="object"&&(k=(q=arguments[0]).cellSize,G=q.margin,$=q.alt,te=q.title),k=k||2,G=G===void 0?4*k:G,($=typeof $=="string"?{text:$}:$||{}).text=$.text||null,$.id=$.text?$.id||"qrcode-description":null,(te=typeof te=="string"?{text:te}:te||{}).text=te.text||null,te.id=te.text?te.id||"qrcode-title":null;var ge,Te,he,ue,de=F.getModuleCount()*k+2*G,me="";for(ue="l"+k+",0 0,"+k+" -"+k+",0 0,-"+k+"z ",me+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',me+=q.scalable?"":' width="'+de+'px" height="'+de+'px"',me+=' viewBox="0 0 '+de+" "+de+'" ',me+=' preserveAspectRatio="xMinYMin meet"',me+=te.text||$.text?' role="img" aria-labelledby="'+H([te.id,$.id].join(" ").trim())+'"':"",me+=">",me+=te.text?'<title id="'+H(te.id)+'">'+H(te.text)+"</title>":"",me+=$.text?'<description id="'+H($.id)+'">'+H($.text)+"</description>":"",me+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',me+='<path d="',Te=0;Te<F.getModuleCount();Te+=1)for(he=Te*k+G,ge=0;ge<F.getModuleCount();ge+=1)F.isDark(Te,ge)&&(me+="M"+(ge*k+G)+","+he+ue);return(me+='" stroke="transparent" fill="black"/>')+"</svg>"},F.createDataURL=function(k,G){k=k||2,G=G===void 0?4*k:G;var $=F.getModuleCount()*k+2*G,te=G,q=$-G;return B($,$,function(ge,Te){if(te<=ge&&ge<q&&te<=Te&&Te<q){var he=Math.floor((ge-te)/k),ue=Math.floor((Te-te)/k);return F.isDark(ue,he)?0:1}return 1})},F.createImgTag=function(k,G,$){k=k||2,G=G===void 0?4*k:G;var te=F.getModuleCount()*k+2*G,q="";return q+="<img",q+=' src="',q+=F.createDataURL(k,G),q+='"',q+=' width="',q+=te,q+='"',q+=' height="',q+=te,q+='"',$&&(q+=' alt="',q+=H($),q+='"'),q+"/>"};var H=function(k){for(var G="",$=0;$<k.length;$+=1){var te=k.charAt($);switch(te){case"<":G+="&lt;";break;case">":G+="&gt;";break;case"&":G+="&amp;";break;case'"':G+="&quot;";break;default:G+=te}}return G};return F.createASCII=function(k,G){if((k=k||1)<2)return function(Ce){Ce=Ce===void 0?2:Ce;var Ee,be,fe,V,re,le=1*F.getModuleCount()+2*Ce,W=Ce,Z=le-Ce,ie={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},ne={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},oe="";for(Ee=0;Ee<le;Ee+=2){for(fe=Math.floor((Ee-W)/1),V=Math.floor((Ee+1-W)/1),be=0;be<le;be+=1)re="\u2588",W<=be&&be<Z&&W<=Ee&&Ee<Z&&F.isDark(fe,Math.floor((be-W)/1))&&(re=" "),W<=be&&be<Z&&W<=Ee+1&&Ee+1<Z&&F.isDark(V,Math.floor((be-W)/1))?re+=" ":re+="\u2588",oe+=Ce<1&&Ee+1>=Z?ne[re]:ie[re];oe+=`
`}return le%2&&Ce>0?oe.substring(0,oe.length-le-1)+Array(le+1).join("\u2580"):oe.substring(0,oe.length-1)}(G);k-=1,G=G===void 0?2*k:G;var $,te,q,ge,Te=F.getModuleCount()*k+2*G,he=G,ue=Te-G,de=Array(k+1).join("\u2588\u2588"),me=Array(k+1).join("  "),_e="",xe="";for($=0;$<Te;$+=1){for(q=Math.floor(($-he)/k),xe="",te=0;te<Te;te+=1)ge=1,he<=te&&te<ue&&he<=$&&$<ue&&F.isDark(q,Math.floor((te-he)/k))&&(ge=0),xe+=ge?de:me;for(q=0;q<k;q+=1)_e+=xe+`
`}return _e.substring(0,_e.length-1)},F.renderTo2dContext=function(k,G){G=G||2;for(var $=F.getModuleCount(),te=0;te<$;te++)for(var q=0;q<$;q++)k.fillStyle=F.isDark(te,q)?"black":"white",k.fillRect(te*G,q*G,G,G)},F};l.stringToBytes=(l.stringToBytesFuncs={default:function(w){for(var T=[],E=0;E<w.length;E+=1){var b=w.charCodeAt(E);T.push(255&b)}return T}}).default,l.createStringToBytes=function(w,T){var E=function(){for(var C=I(w),_=function(){var Y=C.read();if(Y==-1)throw"eof";return Y},M=0,A={};;){var F=C.read();if(F==-1)break;var N=_(),z=_()<<8|_();A[String.fromCharCode(F<<8|N)]=z,M+=1}if(M!=T)throw M+" != "+T;return A}(),b=63;return function(C){for(var _=[],M=0;M<C.length;M+=1){var A=C.charCodeAt(M);if(A<128)_.push(A);else{var F=E[C.charAt(M)];typeof F=="number"?(255&F)==F?_.push(F):(_.push(F>>>8),_.push(255&F)):_.push(b)}}return _}};var c,d,f,h,v,p={L:1,M:0,Q:3,H:2},m=(c=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d=1335,f=7973,v=function(w){for(var T=0;w!=0;)T+=1,w>>>=1;return T},(h={}).getBCHTypeInfo=function(w){for(var T=w<<10;v(T)-v(d)>=0;)T^=d<<v(T)-v(d);return 21522^(w<<10|T)},h.getBCHTypeNumber=function(w){for(var T=w<<12;v(T)-v(f)>=0;)T^=f<<v(T)-v(f);return w<<12|T},h.getPatternPosition=function(w){return c[w-1]},h.getMaskFunction=function(w){switch(w){case 0:return function(T,E){return(T+E)%2==0};case 1:return function(T,E){return T%2==0};case 2:return function(T,E){return E%3==0};case 3:return function(T,E){return(T+E)%3==0};case 4:return function(T,E){return(Math.floor(T/2)+Math.floor(E/3))%2==0};case 5:return function(T,E){return T*E%2+T*E%3==0};case 6:return function(T,E){return(T*E%2+T*E%3)%2==0};case 7:return function(T,E){return(T*E%3+(T+E)%2)%2==0};default:throw"bad maskPattern:"+w}},h.getErrorCorrectPolynomial=function(w){for(var T=y([1],0),E=0;E<w;E+=1)T=T.multiply(y([1,g.gexp(E)],0));return T},h.getLengthInBits=function(w,T){if(1<=T&&T<10)switch(w){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+w}else if(T<27)switch(w){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+w}else{if(!(T<41))throw"type:"+T;switch(w){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+w}}},h.getLostPoint=function(w){for(var T=w.getModuleCount(),E=0,b=0;b<T;b+=1)for(var C=0;C<T;C+=1){for(var _=0,M=w.isDark(b,C),A=-1;A<=1;A+=1)if(!(b+A<0||T<=b+A))for(var F=-1;F<=1;F+=1)C+F<0||T<=C+F||A==0&&F==0||M==w.isDark(b+A,C+F)&&(_+=1);_>5&&(E+=3+_-5)}for(b=0;b<T-1;b+=1)for(C=0;C<T-1;C+=1){var N=0;w.isDark(b,C)&&(N+=1),w.isDark(b+1,C)&&(N+=1),w.isDark(b,C+1)&&(N+=1),w.isDark(b+1,C+1)&&(N+=1),N!=0&&N!=4||(E+=3)}for(b=0;b<T;b+=1)for(C=0;C<T-6;C+=1)w.isDark(b,C)&&!w.isDark(b,C+1)&&w.isDark(b,C+2)&&w.isDark(b,C+3)&&w.isDark(b,C+4)&&!w.isDark(b,C+5)&&w.isDark(b,C+6)&&(E+=40);for(C=0;C<T;C+=1)for(b=0;b<T-6;b+=1)w.isDark(b,C)&&!w.isDark(b+1,C)&&w.isDark(b+2,C)&&w.isDark(b+3,C)&&w.isDark(b+4,C)&&!w.isDark(b+5,C)&&w.isDark(b+6,C)&&(E+=40);var z=0;for(C=0;C<T;C+=1)for(b=0;b<T;b+=1)w.isDark(b,C)&&(z+=1);return E+Math.abs(100*z/T/T-50)/5*10},h),g=function(){for(var w=new Array(256),T=new Array(256),E=0;E<8;E+=1)w[E]=1<<E;for(E=8;E<256;E+=1)w[E]=w[E-4]^w[E-5]^w[E-6]^w[E-8];for(E=0;E<255;E+=1)T[w[E]]=E;return{glog:function(b){if(b<1)throw"glog("+b+")";return T[b]},gexp:function(b){for(;b<0;)b+=255;for(;b>=256;)b-=255;return w[b]}}}();function y(w,T){if(w.length===void 0)throw w.length+"/"+T;var E=function(){for(var C=0;C<w.length&&w[C]==0;)C+=1;for(var _=new Array(w.length-C+T),M=0;M<w.length-C;M+=1)_[M]=w[M+C];return _}(),b={getAt:function(C){return E[C]},getLength:function(){return E.length},multiply:function(C){for(var _=new Array(b.getLength()+C.getLength()-1),M=0;M<b.getLength();M+=1)for(var A=0;A<C.getLength();A+=1)_[M+A]^=g.gexp(g.glog(b.getAt(M))+g.glog(C.getAt(A)));return y(_,0)},mod:function(C){if(b.getLength()-C.getLength()<0)return b;for(var _=g.glog(b.getAt(0))-g.glog(C.getAt(0)),M=new Array(b.getLength()),A=0;A<b.getLength();A+=1)M[A]=b.getAt(A);for(A=0;A<C.getLength();A+=1)M[A]^=g.gexp(g.glog(C.getAt(A))+_);return y(M,0).mod(C)}};return b}var x=function(){var w=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],T=function(b,C){var _={};return _.totalCount=b,_.dataCount=C,_},E={getRSBlocks:function(b,C){var _=function(ee,Q){switch(Q){case p.L:return w[4*(ee-1)+0];case p.M:return w[4*(ee-1)+1];case p.Q:return w[4*(ee-1)+2];case p.H:return w[4*(ee-1)+3];default:return}}(b,C);if(_===void 0)throw"bad rs block @ typeNumber:"+b+"/errorCorrectionLevel:"+C;for(var M=_.length/3,A=[],F=0;F<M;F+=1)for(var N=_[3*F+0],z=_[3*F+1],Y=_[3*F+2],U=0;U<N;U+=1)A.push(T(z,Y));return A}};return E}(),S=function(){var w=[],T=0,E={getBuffer:function(){return w},getAt:function(b){var C=Math.floor(b/8);return(w[C]>>>7-b%8&1)==1},put:function(b,C){for(var _=0;_<C;_+=1)E.putBit((b>>>C-_-1&1)==1)},getLengthInBits:function(){return T},putBit:function(b){var C=Math.floor(T/8);w.length<=C&&w.push(0),b&&(w[C]|=128>>>T%8),T+=1}};return E},D=function(w){var T=w,E={getMode:function(){return 1},getLength:function(_){return T.length},write:function(_){for(var M=T,A=0;A+2<M.length;)_.put(b(M.substring(A,A+3)),10),A+=3;A<M.length&&(M.length-A==1?_.put(b(M.substring(A,A+1)),4):M.length-A==2&&_.put(b(M.substring(A,A+2)),7))}},b=function(_){for(var M=0,A=0;A<_.length;A+=1)M=10*M+C(_.charAt(A));return M},C=function(_){if("0"<=_&&_<="9")return _.charCodeAt(0)-48;throw"illegal char :"+_};return E},P=function(w){var T=w,E={getMode:function(){return 2},getLength:function(C){return T.length},write:function(C){for(var _=T,M=0;M+1<_.length;)C.put(45*b(_.charAt(M))+b(_.charAt(M+1)),11),M+=2;M<_.length&&C.put(b(_.charAt(M)),6)}},b=function(C){if("0"<=C&&C<="9")return C.charCodeAt(0)-48;if("A"<=C&&C<="Z")return C.charCodeAt(0)-65+10;switch(C){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+C}};return E},R=function(w){var T=l.stringToBytes(w);return{getMode:function(){return 4},getLength:function(E){return T.length},write:function(E){for(var b=0;b<T.length;b+=1)E.put(T[b],8)}}},L=function(w){var T=l.stringToBytesFuncs.SJIS;if(!T)throw"sjis not supported.";(function(){var C=T("\u53CB");if(C.length!=2||(C[0]<<8|C[1])!=38726)throw"sjis not supported."})();var E=T(w),b={getMode:function(){return 8},getLength:function(C){return~~(E.length/2)},write:function(C){for(var _=E,M=0;M+1<_.length;){var A=(255&_[M])<<8|255&_[M+1];if(33088<=A&&A<=40956)A-=33088;else{if(!(57408<=A&&A<=60351))throw"illegal char at "+(M+1)+"/"+A;A-=49472}A=192*(A>>>8&255)+(255&A),C.put(A,13),M+=2}if(M<_.length)throw"illegal char at "+(M+1)}};return b},O=function(){var w=[],T={writeByte:function(E){w.push(255&E)},writeShort:function(E){T.writeByte(E),T.writeByte(E>>>8)},writeBytes:function(E,b,C){b=b||0,C=C||E.length;for(var _=0;_<C;_+=1)T.writeByte(E[_+b])},writeString:function(E){for(var b=0;b<E.length;b+=1)T.writeByte(E.charCodeAt(b))},toByteArray:function(){return w},toString:function(){var E="";E+="[";for(var b=0;b<w.length;b+=1)b>0&&(E+=","),E+=w[b];return E+"]"}};return T},I=function(w){var T=w,E=0,b=0,C=0,_={read:function(){for(;C<8;){if(E>=T.length){if(C==0)return-1;throw"unexpected end of file./"+C}var A=T.charAt(E);if(E+=1,A=="=")return C=0,-1;A.match(/^\s$/)||(b=b<<6|M(A.charCodeAt(0)),C+=6)}var F=b>>>C-8&255;return C-=8,F}},M=function(A){if(65<=A&&A<=90)return A-65;if(97<=A&&A<=122)return A-97+26;if(48<=A&&A<=57)return A-48+52;if(A==43)return 62;if(A==47)return 63;throw"c:"+A};return _},B=function(w,T,E){for(var b=function(z,Y){var U=z,ee=Y,Q=new Array(z*Y),j={setPixel:function(k,G,$){Q[G*U+k]=$},write:function(k){k.writeString("GIF87a"),k.writeShort(U),k.writeShort(ee),k.writeByte(128),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(255),k.writeByte(255),k.writeByte(255),k.writeString(","),k.writeShort(0),k.writeShort(0),k.writeShort(U),k.writeShort(ee),k.writeByte(0);var G=K(2);k.writeByte(2);for(var $=0;G.length-$>255;)k.writeByte(255),k.writeBytes(G,$,255),$+=255;k.writeByte(G.length-$),k.writeBytes(G,$,G.length-$),k.writeByte(0),k.writeString(";")}},K=function(k){for(var G=1<<k,$=1+(1<<k),te=k+1,q=H(),ge=0;ge<G;ge+=1)q.add(String.fromCharCode(ge));q.add(String.fromCharCode(G)),q.add(String.fromCharCode($));var Te,he,ue,de=O(),me=(Te=de,he=0,ue=0,{write:function(Ee,be){if(Ee>>>be)throw"length over";for(;he+be>=8;)Te.writeByte(255&(Ee<<he|ue)),be-=8-he,Ee>>>=8-he,ue=0,he=0;ue|=Ee<<he,he+=be},flush:function(){he>0&&Te.writeByte(ue)}});me.write(G,te);var _e=0,xe=String.fromCharCode(Q[_e]);for(_e+=1;_e<Q.length;){var Ce=String.fromCharCode(Q[_e]);_e+=1,q.contains(xe+Ce)?xe+=Ce:(me.write(q.indexOf(xe),te),q.size()<4095&&(q.size()==1<<te&&(te+=1),q.add(xe+Ce)),xe=Ce)}return me.write(q.indexOf(xe),te),me.write($,te),me.flush(),de.toByteArray()},H=function(){var k={},G=0,$={add:function(te){if($.contains(te))throw"dup key:"+te;k[te]=G,G+=1},size:function(){return G},indexOf:function(te){return k[te]},contains:function(te){return k[te]!==void 0}};return $};return j}(w,T),C=0;C<T;C+=1)for(var _=0;_<w;_+=1)b.setPixel(_,C,E(_,C));var M=O();b.write(M);for(var A=function(){var z=0,Y=0,U=0,ee="",Q={},j=function(H){ee+=String.fromCharCode(K(63&H))},K=function(H){if(!(H<0)){if(H<26)return 65+H;if(H<52)return H-26+97;if(H<62)return H-52+48;if(H==62)return 43;if(H==63)return 47}throw"n:"+H};return Q.writeByte=function(H){for(z=z<<8|255&H,Y+=8,U+=1;Y>=6;)j(z>>>Y-6),Y-=6},Q.flush=function(){if(Y>0&&(j(z<<6-Y),z=0,Y=0),U%3!=0)for(var H=3-U%3,k=0;k<H;k+=1)ee+="="},Q.toString=function(){return ee},Q}(),F=M.toByteArray(),N=0;N<F.length;N+=1)A.writeByte(F[N]);return A.flush(),"data:image/gif;base64,"+A};return l}();u.stringToBytesFuncs["UTF-8"]=function(l){return function(c){for(var d=[],f=0;f<c.length;f++){var h=c.charCodeAt(f);h<128?d.push(h):h<2048?d.push(192|h>>6,128|63&h):h<55296||h>=57344?d.push(224|h>>12,128|h>>6&63,128|63&h):(f++,h=65536+((1023&h)<<10|1023&c.charCodeAt(f)),d.push(240|h>>18,128|h>>12&63,128|h>>6&63,128|63&h))}return d}(l)},(s=typeof(o=function(){return u})=="function"?o.apply(a,[]):o)===void 0||(i.exports=s)}},e={};function t(i){var a=e[i];if(a!==void 0)return a.exports;var o=e[i]={exports:{}};return r[i](o,o.exports,t),o.exports}t.n=i=>{var a=i&&i.__esModule?()=>i.default:()=>i;return t.d(a,{a}),a},t.d=(i,a)=>{for(var o in a)t.o(a,o)&&!t.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:a[o]})},t.o=(i,a)=>Object.prototype.hasOwnProperty.call(i,a);var n={};return(()=>{"use strict";t.d(n,{default:()=>T});let i=E=>!!E&&typeof E=="object"&&!Array.isArray(E);function a(E,...b){if(!b.length)return E;let C=b.shift();return C!==void 0&&i(E)&&i(C)?(E=Object.assign({},E),Object.keys(C).forEach(_=>{let M=E[_],A=C[_];Array.isArray(M)&&Array.isArray(A)?E[_]=A:i(M)&&i(A)?E[_]=a(Object.assign({},M),A):E[_]=A}),a(E,...b)):E}function o(E,b){let C=document.createElement("a");C.download=b,C.href=E,document.body.appendChild(C),C.click(),document.body.removeChild(C)}let s={L:.07,M:.15,Q:.25,H:.3};class u{constructor({svg:b,type:C,window:_}){this._svg=b,this._type=C,this._window=_}draw(b,C,_,M){let A;switch(this._type){case"dots":A=this._drawDot;break;case"classy":A=this._drawClassy;break;case"classy-rounded":A=this._drawClassyRounded;break;case"rounded":A=this._drawRounded;break;case"extra-rounded":A=this._drawExtraRounded;break;default:A=this._drawSquare}A.call(this,{x:b,y:C,size:_,getNeighbor:M})}_rotateFigure({x:b,y:C,size:_,rotation:M=0,draw:A}){var F;let N=b+_/2,z=C+_/2;A(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(_+C/2)),this._element.setAttribute("cy",String(M+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(_)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_basicSideRounded(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${M}v ${C}h `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, 0 ${-C}`)}}))}_basicCornerRounded(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${M}v ${C}h ${C}v `+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_basicCornerExtraRounded(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${M}v ${C}h ${C}a ${C} ${C}, 0, 0, 0, ${-C} ${-C}`)}}))}_basicCornersRounded(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${M}v `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${C/2} ${C/2}h `+C/2+"v "+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_drawDot({x:b,y:C,size:_}){this._basicDot({x:b,y:C,size:_,rotation:0})}_drawSquare({x:b,y:C,size:_}){this._basicSquare({x:b,y:C,size:_,rotation:0})}_drawRounded({x:b,y:C,size:_,getNeighbor:M}){let A=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0,Y=A+F+N+z;if(Y!==0)if(Y>2||A&&F||N&&z)this._basicSquare({x:b,y:C,size:_,rotation:0});else{if(Y===2){let U=0;return A&&N?U=Math.PI/2:N&&F?U=Math.PI:F&&z&&(U=-Math.PI/2),void this._basicCornerRounded({x:b,y:C,size:_,rotation:U})}if(Y===1){let U=0;return N?U=Math.PI/2:F?U=Math.PI:z&&(U=-Math.PI/2),void this._basicSideRounded({x:b,y:C,size:_,rotation:U})}}else this._basicDot({x:b,y:C,size:_,rotation:0})}_drawExtraRounded({x:b,y:C,size:_,getNeighbor:M}){let A=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0,Y=A+F+N+z;if(Y!==0)if(Y>2||A&&F||N&&z)this._basicSquare({x:b,y:C,size:_,rotation:0});else{if(Y===2){let U=0;return A&&N?U=Math.PI/2:N&&F?U=Math.PI:F&&z&&(U=-Math.PI/2),void this._basicCornerExtraRounded({x:b,y:C,size:_,rotation:U})}if(Y===1){let U=0;return N?U=Math.PI/2:F?U=Math.PI:z&&(U=-Math.PI/2),void this._basicSideRounded({x:b,y:C,size:_,rotation:U})}}else this._basicDot({x:b,y:C,size:_,rotation:0})}_drawClassy({x:b,y:C,size:_,getNeighbor:M}){let A=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0;A+F+N+z!==0?A||N?F||z?this._basicSquare({x:b,y:C,size:_,rotation:0}):this._basicCornerRounded({x:b,y:C,size:_,rotation:Math.PI/2}):this._basicCornerRounded({x:b,y:C,size:_,rotation:-Math.PI/2}):this._basicCornersRounded({x:b,y:C,size:_,rotation:Math.PI/2})}_drawClassyRounded({x:b,y:C,size:_,getNeighbor:M}){let A=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0;A+F+N+z!==0?A||N?F||z?this._basicSquare({x:b,y:C,size:_,rotation:0}):this._basicCornerExtraRounded({x:b,y:C,size:_,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:b,y:C,size:_,rotation:-Math.PI/2}):this._basicCornersRounded({x:b,y:C,size:_,rotation:Math.PI/2})}}let l={dot:"dot",square:"square",extraRounded:"extra-rounded"},c=Object.values(l);class d{constructor({svg:b,type:C,window:_}){this._svg=b,this._type=C,this._window=_}draw(b,C,_,M){let A;switch(this._type){case l.square:A=this._drawSquare;break;case l.extraRounded:A=this._drawExtraRounded;break;default:A=this._drawDot}A.call(this,{x:b,y:C,size:_,rotation:M})}_rotateFigure({x:b,y:C,size:_,rotation:M=0,draw:A}){var F;let N=b+_/2,z=C+_/2;A(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(b){let{size:C,x:_,y:M}=b,A=C/7;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_+C/2} ${M}a ${C/2} ${C/2} 0 1 0 0.1 0zm 0 ${A}a ${C/2-A} ${C/2-A} 0 1 1 -0.1 0Z`)}}))}_basicSquare(b){let{size:C,x:_,y:M}=b,A=C/7;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_} ${M}v ${C}h ${C}v `+-C+`zM ${_+A} ${M+A}h `+(C-2*A)+"v "+(C-2*A)+"h "+(2*A-C)+"z")}}))}_basicExtraRounded(b){let{size:C,x:_,y:M}=b,A=C/7;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_} ${M+2.5*A}v `+2*A+`a ${2.5*A} ${2.5*A}, 0, 0, 0, ${2.5*A} ${2.5*A}h `+2*A+`a ${2.5*A} ${2.5*A}, 0, 0, 0, ${2.5*A} ${2.5*-A}v `+-2*A+`a ${2.5*A} ${2.5*A}, 0, 0, 0, ${2.5*-A} ${2.5*-A}h `+-2*A+`a ${2.5*A} ${2.5*A}, 0, 0, 0, ${2.5*-A} ${2.5*A}M ${_+2.5*A} ${M+A}h `+2*A+`a ${1.5*A} ${1.5*A}, 0, 0, 1, ${1.5*A} ${1.5*A}v `+2*A+`a ${1.5*A} ${1.5*A}, 0, 0, 1, ${1.5*-A} ${1.5*A}h `+-2*A+`a ${1.5*A} ${1.5*A}, 0, 0, 1, ${1.5*-A} ${1.5*-A}v `+-2*A+`a ${1.5*A} ${1.5*A}, 0, 0, 1, ${1.5*A} ${1.5*-A}`)}}))}_drawDot({x:b,y:C,size:_,rotation:M}){this._basicDot({x:b,y:C,size:_,rotation:M})}_drawSquare({x:b,y:C,size:_,rotation:M}){this._basicSquare({x:b,y:C,size:_,rotation:M})}_drawExtraRounded({x:b,y:C,size:_,rotation:M}){this._basicExtraRounded({x:b,y:C,size:_,rotation:M})}}let f={dot:"dot",square:"square"},h=Object.values(f);class v{constructor({svg:b,type:C,window:_}){this._svg=b,this._type=C,this._window=_}draw(b,C,_,M){let A;A=this._type===f.square?this._drawSquare:this._drawDot,A.call(this,{x:b,y:C,size:_,rotation:M})}_rotateFigure({x:b,y:C,size:_,rotation:M=0,draw:A}){var F;let N=b+_/2,z=C+_/2;A(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(_+C/2)),this._element.setAttribute("cy",String(M+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(b){let{size:C,x:_,y:M}=b;this._rotateFigure(Object.assign(Object.assign({},b),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(_)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_drawDot({x:b,y:C,size:_,rotation:M}){this._basicDot({x:b,y:C,size:_,rotation:M})}_drawSquare({x:b,y:C,size:_,rotation:M}){this._basicSquare({x:b,y:C,size:_,rotation:M})}}let p="circle",m=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],g=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],x=(()=>{class E{constructor(C,_){this._roundSize=M=>this._options.dotsOptions.roundSize?Math.floor(M):M,this._window=_,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(C.width)),this._element.setAttribute("height",String(C.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),C.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${C.width} ${C.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=C.image,this._instanceId=E.instanceCount++,this._options=C}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}drawQR(C){return Et(this,null,function*(){let _=C.getModuleCount(),M=Math.min(this._options.width,this._options.height)-2*this._options.margin,A=this._options.shape===p?M/Math.sqrt(2):M,F=this._roundSize(A/_),N={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=C,this._options.image){if(yield this.loadImage(),!this._image)return;let{imageOptions:z,qrOptions:Y}=this._options,U=z.imageSize*s[Y.errorCorrectionLevel],ee=Math.floor(U*_*_);N=function({originalHeight:Q,originalWidth:j,maxHiddenDots:K,maxHiddenAxisDots:H,dotSize:k}){let G={x:0,y:0},$={x:0,y:0};if(Q<=0||j<=0||K<=0||k<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};let te=Q/j;return G.x=Math.floor(Math.sqrt(K/te)),G.x<=0&&(G.x=1),H&&H<G.x&&(G.x=H),G.x%2==0&&G.x--,$.x=G.x*k,G.y=1+2*Math.ceil((G.x*te-1)/2),$.y=Math.round($.x*te),(G.y*G.x>K||H&&H<G.y)&&(H&&H<G.y?(G.y=H,G.y%2==0&&G.x--):G.y-=2,$.y=G.y*k,G.x=1+2*Math.ceil((G.y/te-1)/2),$.x=Math.round($.y/te)),{height:$.y,width:$.x,hideYDots:G.y,hideXDots:G.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:ee,maxHiddenAxisDots:_-14,dotSize:F})}this.drawBackground(),this.drawDots((z,Y)=>{var U,ee,Q,j,K,H;return!(this._options.imageOptions.hideBackgroundDots&&z>=(_-N.hideYDots)/2&&z<(_+N.hideYDots)/2&&Y>=(_-N.hideXDots)/2&&Y<(_+N.hideXDots)/2||!((U=m[z])===null||U===void 0)&&U[Y]||!((ee=m[z-_+7])===null||ee===void 0)&&ee[Y]||!((Q=m[z])===null||Q===void 0)&&Q[Y-_+7]||!((j=g[z])===null||j===void 0)&&j[Y]||!((K=g[z-_+7])===null||K===void 0)&&K[Y]||!((H=g[z])===null||H===void 0)&&H[Y-_+7])}),this.drawCorners(),this._options.image&&(yield this.drawImage({width:N.width,height:N.height,count:_,dotSize:F}))})}drawBackground(){var C,_,M;let A=this._element,F=this._options;if(A){let N=(C=F.backgroundOptions)===null||C===void 0?void 0:C.gradient,z=(_=F.backgroundOptions)===null||_===void 0?void 0:_.color,Y=F.height,U=F.width;if(N||z){let ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((M=F.backgroundOptions)===null||M===void 0)&&M.round&&(Y=U=Math.min(F.width,F.height),ee.setAttribute("rx",String(Y/2*F.backgroundOptions.round))),ee.setAttribute("x",String(this._roundSize((F.width-U)/2))),ee.setAttribute("y",String(this._roundSize((F.height-Y)/2))),ee.setAttribute("width",String(U)),ee.setAttribute("height",String(Y)),this._backgroundClipPath.appendChild(ee),this._createColor({options:N,color:z,additionalRotation:0,x:0,y:0,height:F.height,width:F.width,name:`background-color-${this._instanceId}`})}}}drawDots(C){var _,M;if(!this._qr)throw"QR code is not defined";let A=this._options,F=this._qr.getModuleCount();if(F>A.width||F>A.height)throw"The canvas is too small.";let N=Math.min(A.width,A.height)-2*A.margin,z=A.shape===p?N/Math.sqrt(2):N,Y=this._roundSize(z/F),U=this._roundSize((A.width-F*Y)/2),ee=this._roundSize((A.height-F*Y)/2),Q=new u({svg:this._element,type:A.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(_=A.dotsOptions)===null||_===void 0?void 0:_.gradient,color:A.dotsOptions.color,additionalRotation:0,x:0,y:0,height:A.height,width:A.width,name:`dot-color-${this._instanceId}`});for(let j=0;j<F;j++)for(let K=0;K<F;K++)C&&!C(j,K)||!((M=this._qr)===null||M===void 0)&&M.isDark(j,K)&&(Q.draw(U+K*Y,ee+j*Y,Y,(H,k)=>!(K+H<0||j+k<0||K+H>=F||j+k>=F)&&!(C&&!C(j+k,K+H))&&!!this._qr&&this._qr.isDark(j+k,K+H)),Q._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(Q._element));if(A.shape===p){let j=this._roundSize((N/Y-F)/2),K=F+2*j,H=U-j*Y,k=ee-j*Y,G=[],$=this._roundSize(K/2);for(let te=0;te<K;te++){G[te]=[];for(let q=0;q<K;q++)te>=j-1&&te<=K-j&&q>=j-1&&q<=K-j||Math.sqrt((te-$)*(te-$)+(q-$)*(q-$))>$?G[te][q]=0:G[te][q]=this._qr.isDark(q-2*j<0?q:q>=F?q-2*j:q-j,te-2*j<0?te:te>=F?te-2*j:te-j)?1:0}for(let te=0;te<K;te++)for(let q=0;q<K;q++)G[te][q]&&(Q.draw(H+q*Y,k+te*Y,Y,(ge,Te)=>{var he;return!!(!((he=G[te+Te])===null||he===void 0)&&he[q+ge])}),Q._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(Q._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";let C=this._element,_=this._options;if(!C)throw"Element code is not defined";let M=this._qr.getModuleCount(),A=Math.min(_.width,_.height)-2*_.margin,F=_.shape===p?A/Math.sqrt(2):A,N=this._roundSize(F/M),z=7*N,Y=3*N,U=this._roundSize((_.width-M*N)/2),ee=this._roundSize((_.height-M*N)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([Q,j,K])=>{var H,k,G,$,te,q,ge,Te,he,ue,de,me,_e,xe;let Ce=U+Q*N*(M-7),Ee=ee+j*N*(M-7),be=this._dotsClipPath,fe=this._dotsClipPath;if((!((H=_.cornersSquareOptions)===null||H===void 0)&&H.gradient||!((k=_.cornersSquareOptions)===null||k===void 0)&&k.color)&&(be=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),be.setAttribute("id",`clip-path-corners-square-color-${Q}-${j}-${this._instanceId}`),this._defs.appendChild(be),this._cornersSquareClipPath=this._cornersDotClipPath=fe=be,this._createColor({options:(G=_.cornersSquareOptions)===null||G===void 0?void 0:G.gradient,color:($=_.cornersSquareOptions)===null||$===void 0?void 0:$.color,additionalRotation:K,x:Ce,y:Ee,height:z,width:z,name:`corners-square-color-${Q}-${j}-${this._instanceId}`})),((te=_.cornersSquareOptions)===null||te===void 0?void 0:te.type)&&c.includes(_.cornersSquareOptions.type)){let V=new d({svg:this._element,type:_.cornersSquareOptions.type,window:this._window});V.draw(Ce,Ee,z,K),V._element&&be&&be.appendChild(V._element)}else{let V=new u({svg:this._element,type:((q=_.cornersSquareOptions)===null||q===void 0?void 0:q.type)||_.dotsOptions.type,window:this._window});for(let re=0;re<m.length;re++)for(let le=0;le<m[re].length;le++)!((ge=m[re])===null||ge===void 0)&&ge[le]&&(V.draw(Ce+le*N,Ee+re*N,N,(W,Z)=>{var ie;return!!(!((ie=m[re+Z])===null||ie===void 0)&&ie[le+W])}),V._element&&be&&be.appendChild(V._element))}if((!((Te=_.cornersDotOptions)===null||Te===void 0)&&Te.gradient||!((he=_.cornersDotOptions)===null||he===void 0)&&he.color)&&(fe=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),fe.setAttribute("id",`clip-path-corners-dot-color-${Q}-${j}-${this._instanceId}`),this._defs.appendChild(fe),this._cornersDotClipPath=fe,this._createColor({options:(ue=_.cornersDotOptions)===null||ue===void 0?void 0:ue.gradient,color:(de=_.cornersDotOptions)===null||de===void 0?void 0:de.color,additionalRotation:K,x:Ce+2*N,y:Ee+2*N,height:Y,width:Y,name:`corners-dot-color-${Q}-${j}-${this._instanceId}`})),((me=_.cornersDotOptions)===null||me===void 0?void 0:me.type)&&h.includes(_.cornersDotOptions.type)){let V=new v({svg:this._element,type:_.cornersDotOptions.type,window:this._window});V.draw(Ce+2*N,Ee+2*N,Y,K),V._element&&fe&&fe.appendChild(V._element)}else{let V=new u({svg:this._element,type:((_e=_.cornersDotOptions)===null||_e===void 0?void 0:_e.type)||_.dotsOptions.type,window:this._window});for(let re=0;re<g.length;re++)for(let le=0;le<g[re].length;le++)!((xe=g[re])===null||xe===void 0)&&xe[le]&&(V.draw(Ce+le*N,Ee+re*N,N,(W,Z)=>{var ie;return!!(!((ie=g[re+Z])===null||ie===void 0)&&ie[le+W])}),V._element&&fe&&fe.appendChild(V._element))}})}loadImage(){return new Promise((C,_)=>{var M;let A=this._options;if(!A.image)return _("Image is not defined");if(!((M=A.nodeCanvas)===null||M===void 0)&&M.loadImage)A.nodeCanvas.loadImage(A.image).then(F=>{var N,z;if(this._image=F,this._options.imageOptions.saveAsBlob){let Y=(N=A.nodeCanvas)===null||N===void 0?void 0:N.createCanvas(this._image.width,this._image.height);(z=Y?.getContext("2d"))===null||z===void 0||z.drawImage(F,0,0),this._imageUri=Y?.toDataURL()}C()}).catch(_);else{let F=new this._window.Image;typeof A.imageOptions.crossOrigin=="string"&&(F.crossOrigin=A.imageOptions.crossOrigin),this._image=F,F.onload=()=>Et(this,null,function*(){this._options.imageOptions.saveAsBlob&&(this._imageUri=yield function(N,z){return Et(this,null,function*(){return new Promise(Y=>{let U=new z.XMLHttpRequest;U.onload=function(){let ee=new z.FileReader;ee.onloadend=function(){Y(ee.result)},ee.readAsDataURL(U.response)},U.open("GET",N),U.responseType="blob",U.send()})})}(A.image||"",this._window)),C()}),F.src=A.image}})}drawImage(F){return Et(this,arguments,function*({width:C,height:_,count:M,dotSize:A}){let N=this._options,z=this._roundSize((N.width-M*A)/2),Y=this._roundSize((N.height-M*A)/2),U=z+this._roundSize(N.imageOptions.margin+(M*A-C)/2),ee=Y+this._roundSize(N.imageOptions.margin+(M*A-_)/2),Q=C-2*N.imageOptions.margin,j=_-2*N.imageOptions.margin,K=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");K.setAttribute("href",this._imageUri||""),K.setAttribute("x",String(U)),K.setAttribute("y",String(ee)),K.setAttribute("width",`${Q}px`),K.setAttribute("height",`${j}px`),this._element.appendChild(K)})}_createColor({options:C,color:_,additionalRotation:M,x:A,y:F,height:N,width:z,name:Y}){let U=z>N?z:N,ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(ee.setAttribute("x",String(A)),ee.setAttribute("y",String(F)),ee.setAttribute("height",String(N)),ee.setAttribute("width",String(z)),ee.setAttribute("clip-path",`url('#clip-path-${Y}')`),C){let Q;if(C.type==="radial")Q=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),Q.setAttribute("id",Y),Q.setAttribute("gradientUnits","userSpaceOnUse"),Q.setAttribute("fx",String(A+z/2)),Q.setAttribute("fy",String(F+N/2)),Q.setAttribute("cx",String(A+z/2)),Q.setAttribute("cy",String(F+N/2)),Q.setAttribute("r",String(U/2));else{let j=((C.rotation||0)+M)%(2*Math.PI),K=(j+2*Math.PI)%(2*Math.PI),H=A+z/2,k=F+N/2,G=A+z/2,$=F+N/2;K>=0&&K<=.25*Math.PI||K>1.75*Math.PI&&K<=2*Math.PI?(H-=z/2,k-=N/2*Math.tan(j),G+=z/2,$+=N/2*Math.tan(j)):K>.25*Math.PI&&K<=.75*Math.PI?(k-=N/2,H-=z/2/Math.tan(j),$+=N/2,G+=z/2/Math.tan(j)):K>.75*Math.PI&&K<=1.25*Math.PI?(H+=z/2,k+=N/2*Math.tan(j),G-=z/2,$-=N/2*Math.tan(j)):K>1.25*Math.PI&&K<=1.75*Math.PI&&(k+=N/2,H+=z/2/Math.tan(j),$-=N/2,G-=z/2/Math.tan(j)),Q=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),Q.setAttribute("id",Y),Q.setAttribute("gradientUnits","userSpaceOnUse"),Q.setAttribute("x1",String(Math.round(H))),Q.setAttribute("y1",String(Math.round(k))),Q.setAttribute("x2",String(Math.round(G))),Q.setAttribute("y2",String(Math.round($)))}C.colorStops.forEach(({offset:j,color:K})=>{let H=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");H.setAttribute("offset",100*j+"%"),H.setAttribute("stop-color",K),Q.appendChild(H)}),ee.setAttribute("fill",`url('#${Y}')`),this._defs.appendChild(Q)}else _&&ee.setAttribute("fill",_);this._element.appendChild(ee)}}return E.instanceCount=0,E})(),S="canvas",D={};for(let E=0;E<=40;E++)D[E]=E;let P={type:S,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:D[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function R(E){let b=Object.assign({},E);if(!b.colorStops||!b.colorStops.length)throw"Field 'colorStops' is required in gradient";return b.rotation?b.rotation=Number(b.rotation):b.rotation=0,b.colorStops=b.colorStops.map(C=>Object.assign(Object.assign({},C),{offset:Number(C.offset)})),b}function L(E){let b=Object.assign({},E);return b.width=Number(b.width),b.height=Number(b.height),b.margin=Number(b.margin),b.imageOptions=Object.assign(Object.assign({},b.imageOptions),{hideBackgroundDots:!!b.imageOptions.hideBackgroundDots,imageSize:Number(b.imageOptions.imageSize),margin:Number(b.imageOptions.margin)}),b.margin>Math.min(b.width,b.height)&&(b.margin=Math.min(b.width,b.height)),b.dotsOptions=Object.assign({},b.dotsOptions),b.dotsOptions.gradient&&(b.dotsOptions.gradient=R(b.dotsOptions.gradient)),b.cornersSquareOptions&&(b.cornersSquareOptions=Object.assign({},b.cornersSquareOptions),b.cornersSquareOptions.gradient&&(b.cornersSquareOptions.gradient=R(b.cornersSquareOptions.gradient))),b.cornersDotOptions&&(b.cornersDotOptions=Object.assign({},b.cornersDotOptions),b.cornersDotOptions.gradient&&(b.cornersDotOptions.gradient=R(b.cornersDotOptions.gradient))),b.backgroundOptions&&(b.backgroundOptions=Object.assign({},b.backgroundOptions),b.backgroundOptions.gradient&&(b.backgroundOptions.gradient=R(b.backgroundOptions.gradient))),b}var O=t(873),I=t.n(O);function B(E){if(!E)throw new Error("Extension must be defined");E[0]==="."&&(E=E.substring(1));let b={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[E.toLowerCase()];if(!b)throw new Error(`Extension "${E}" is not supported`);return b}class w{constructor(b){b?.jsdom?this._window=new b.jsdom("",{resources:"usable"}).window:this._window=window,this._options=b?L(a(P,b)):P,this.update()}static _clearContainer(b){b&&(b.innerHTML="")}_setupSvg(){if(!this._qr)return;let b=new x(this._options,this._window);this._svg=b.getElement(),this._svgDrawingPromise=b.drawQR(this._qr).then(()=>{var C;this._svg&&((C=this._extension)===null||C===void 0||C.call(this,b.getElement(),this._options))})}_setupCanvas(){var b,C;this._qr&&(!((b=this._options.nodeCanvas)===null||b===void 0)&&b.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(C=this._svgDrawingPromise)===null||C===void 0?void 0:C.then(()=>{var _;if(!this._svg)return;let M=this._svg,A=new this._window.XMLSerializer().serializeToString(M),F=btoa(A),N=`data:${B("svg")};base64,${F}`;if(!((_=this._options.nodeCanvas)===null||_===void 0)&&_.loadImage)return this._options.nodeCanvas.loadImage(N).then(z=>{var Y,U;z.width=this._options.width,z.height=this._options.height,(U=(Y=this._nodeCanvas)===null||Y===void 0?void 0:Y.getContext("2d"))===null||U===void 0||U.drawImage(z,0,0)});{let z=new this._window.Image;return new Promise(Y=>{z.onload=()=>{var U,ee;(ee=(U=this._domCanvas)===null||U===void 0?void 0:U.getContext("2d"))===null||ee===void 0||ee.drawImage(z,0,0),Y()},z.src=N})}}))}_getElement(b="png"){return Et(this,null,function*(){if(!this._qr)throw"QR code is empty";return b.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),yield this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),yield this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)})}update(b){w._clearContainer(this._container),this._options=b?L(a(this._options,b)):this._options,this._options.data&&(this._qr=I()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(C){switch(!0){case/^[0-9]*$/.test(C):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(C):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===S?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(b){if(b){if(typeof b.appendChild!="function")throw"Container should be a single DOM node";this._options.type===S?this._domCanvas&&b.appendChild(this._domCanvas):this._svg&&b.appendChild(this._svg),this._container=b}}applyExtension(b){if(!b)throw"Extension function should be defined.";this._extension=b,this.update()}deleteExtension(){this._extension=void 0,this.update()}getRawData(b="png"){return Et(this,null,function*(){if(!this._qr)throw"QR code is empty";let C=yield this._getElement(b),_=B(b);if(!C)return null;if(b.toLowerCase()==="svg"){let M=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(C)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(M):new Blob([M],{type:_})}return new Promise(M=>{let A=C;if("toBuffer"in A)if(_==="image/png")M(A.toBuffer(_));else if(_==="image/jpeg")M(A.toBuffer(_));else{if(_!=="application/pdf")throw Error("Unsupported extension");M(A.toBuffer(_))}else"toBlob"in A&&A.toBlob(M,_,1)})})}download(b){return Et(this,null,function*(){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let C="png",_="qr";typeof b=="string"?(C=b,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof b=="object"&&b!==null&&(b.name&&(_=b.name),b.extension&&(C=b.extension));let M=yield this._getElement(C);if(M)if(C.toLowerCase()==="svg"){let A=new XMLSerializer().serializeToString(M);A=`<?xml version="1.0" standalone="no"?>\r
`+A,o(`data:${B(C)};charset=utf-8,${encodeURIComponent(A)}`,`${_}.svg`)}else o(M.toDataURL(B(C)),`${_}.${C}`)})}}let T=w})(),n.default})())});var _v=fa((Ja,$u)=>{"use strict";(function(e,t){typeof Ja=="object"&&typeof $u=="object"?$u.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Ja=="object"?Ja.cytoscapePopper=t():e.cytoscapePopper=t()})(Ja,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=7)}([function(r,e,t){"use strict";var n=t(5),i=n.getBoundingBox;function a(o,s){var u={getBoundingClientRect:function(){return i(o,s)}};return u}r.exports={getRef:a}},function(r,e,t){"use strict";r.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return a.forEach(function(s){s!=null&&Object.keys(s).forEach(function(u){return n[u]=s[u]})}),n}},function(r,e,t){"use strict";var n=t(0),i=n.getRef,a=t(6),o=a.getContent;function s(u,l){var c=i(u,l),d=o(u,l.content);return u.popperFactory(c,d,l.popper)}r.exports={getPopper:s}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function u(v){return h(this),a(this[0],c(this[0],v))}function l(v){return h(this),s(this[0],c(this[0],v))}function c(v,p){var m=function(P){return P.isNode()?{w:P.renderedWidth(),h:P.renderedHeight()}:{w:3,h:3}},g=function(P){return P.isNode()?d(P,m):f(P)},y={},x=v.cy(),S={renderedDimensions:m,renderedPosition:g,popper:y,cy:x};return n({},S,p)}function d(v,p){var m=v.renderedPosition(),g=p(v),y=g.w/2,x=g.h/2;return{x:m.x-y,y:m.y-x}}function f(v){var p=v.midpoint(),m=v.cy().pan(),g=v.cy().zoom();return{x:p.x*g+m.x,y:p.y*g+m.y}}function h(v){v.length>1&&(console.warn("Popper.js Extension should only be used on one element."),console.warn("Ignoring all subsequent elements"))}r.exports={popper:u,popperRef:l}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function u(d){return a(this,c(this,d))}function l(d){return s(this,c(this,d))}function c(d,f){var h={boundingBox:{top:0,left:0,right:0,bottom:0,w:3,h:3},renderedDimensions:function(){return{w:3,h:3}},renderedPosition:function(){return{x:0,y:0}},popper:{},cy:d};return n({},h,f)}r.exports={popper:u,popperRef:l}},function(r,e,t){"use strict";function n(i,a){var o=a.renderedPosition,s=a.cy,u=a.renderedDimensions,l=s.container().getBoundingClientRect(),c=u(i),d=o(i);return{top:d.y+l.top,left:d.x+l.left,right:d.x+c.w+l.left,bottom:d.y+c.h+l.top,width:c.w,height:c.h}}r.exports={getBoundingBox:n}},function(r,e,t){"use strict";function n(i,a){var o=null;if(typeof a=="function")o=a(i);else{if(a instanceof HTMLElement)return a;throw new Error("Can not create popper from 'target' with unknown type")}if(o===null)throw new Error("No 'target' specified to create popper");return o}r.exports={getContent:n}},function(r,e,t){"use strict";var n=t(4),i=t(3),a=function(s){if(typeof s!="function")throw new Error("Provide 'popperFactory' before registering the module");return function(l){l&&(l("core","popperFactory",s),l("collection","popperFactory",s),l("core","popper",n.popper),l("collection","popper",i.popper),l("core","popperRef",n.popperRef),l("collection","popperRef",i.popperRef))}};r.exports=a}])})});var uc=fa((uo,lc)=>{"use strict";(function(e,t){typeof uo=="object"&&typeof lc=="object"?lc.exports=t():typeof define=="function"&&define.amd?define([],t):typeof uo=="object"?uo.layoutBase=t():e.layoutBase=t()})(uo,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=28)}([function(r,e,t){"use strict";function n(){}n.QUALITY=1,n.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,n.DEFAULT_INCREMENTAL=!1,n.DEFAULT_ANIMATION_ON_LAYOUT=!0,n.DEFAULT_ANIMATION_DURING_LAYOUT=!1,n.DEFAULT_ANIMATION_PERIOD=50,n.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,n.DEFAULT_GRAPH_MARGIN=15,n.NODE_DIMENSIONS_INCLUDE_LABELS=!1,n.SIMPLE_NODE_SIZE=40,n.SIMPLE_NODE_HALF_SIZE=n.SIMPLE_NODE_SIZE/2,n.EMPTY_COMPOUND_NODE_SIZE=40,n.MIN_EDGE_LENGTH=1,n.WORLD_BOUNDARY=1e6,n.INITIAL_WORLD_BOUNDARY=n.WORLD_BOUNDARY/1e3,n.WORLD_CENTER_X=1200,n.WORLD_CENTER_Y=900,r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(8),a=t(9);function o(u,l,c){n.call(this,c),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=c,this.bendpoints=[],this.source=u,this.target=l}o.prototype=Object.create(n.prototype);for(var s in n)o[s]=n[s];o.prototype.getSource=function(){return this.source},o.prototype.getTarget=function(){return this.target},o.prototype.isInterGraph=function(){return this.isInterGraph},o.prototype.getLength=function(){return this.length},o.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},o.prototype.getBendpoints=function(){return this.bendpoints},o.prototype.getLca=function(){return this.lca},o.prototype.getSourceInLca=function(){return this.sourceInLca},o.prototype.getTargetInLca=function(){return this.targetInLca},o.prototype.getOtherEnd=function(u){if(this.source===u)return this.target;if(this.target===u)return this.source;throw"Node is not incident with this edge"},o.prototype.getOtherEndInGraph=function(u,l){for(var c=this.getOtherEnd(u),d=l.getGraphManager().getRoot();;){if(c.getOwner()==l)return c;if(c.getOwner()==d)break;c=c.getOwner().getParent()}return null},o.prototype.updateLength=function(){var u=new Array(4);this.isOverlapingSourceAndTarget=i.getIntersection(this.target.getRect(),this.source.getRect(),u),this.isOverlapingSourceAndTarget||(this.lengthX=u[0]-u[2],this.lengthY=u[1]-u[3],Math.abs(this.lengthX)<1&&(this.lengthX=a.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=a.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},o.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=a.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=a.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},r.exports=o},function(r,e,t){"use strict";function n(i){this.vGraphObject=i}r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(10),a=t(13),o=t(0),s=t(16),u=t(5);function l(d,f,h,v){h==null&&v==null&&(v=f),n.call(this,v),d.graphManager!=null&&(d=d.graphManager),this.estimatedSize=i.MIN_VALUE,this.inclusionTreeDepth=i.MAX_VALUE,this.vGraphObject=v,this.edges=[],this.graphManager=d,h!=null&&f!=null?this.rect=new a(f.x,f.y,h.width,h.height):this.rect=new a}l.prototype=Object.create(n.prototype);for(var c in n)l[c]=n[c];l.prototype.getEdges=function(){return this.edges},l.prototype.getChild=function(){return this.child},l.prototype.getOwner=function(){return this.owner},l.prototype.getWidth=function(){return this.rect.width},l.prototype.setWidth=function(d){this.rect.width=d},l.prototype.getHeight=function(){return this.rect.height},l.prototype.setHeight=function(d){this.rect.height=d},l.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},l.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},l.prototype.getCenter=function(){return new u(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},l.prototype.getLocation=function(){return new u(this.rect.x,this.rect.y)},l.prototype.getRect=function(){return this.rect},l.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},l.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},l.prototype.setRect=function(d,f){this.rect.x=d.x,this.rect.y=d.y,this.rect.width=f.width,this.rect.height=f.height},l.prototype.setCenter=function(d,f){this.rect.x=d-this.rect.width/2,this.rect.y=f-this.rect.height/2},l.prototype.setLocation=function(d,f){this.rect.x=d,this.rect.y=f},l.prototype.moveBy=function(d,f){this.rect.x+=d,this.rect.y+=f},l.prototype.getEdgeListToNode=function(d){var f=[],h,v=this;return v.edges.forEach(function(p){if(p.target==d){if(p.source!=v)throw"Incorrect edge source!";f.push(p)}}),f},l.prototype.getEdgesBetween=function(d){var f=[],h,v=this;return v.edges.forEach(function(p){if(!(p.source==v||p.target==v))throw"Incorrect edge source and/or target";(p.target==d||p.source==d)&&f.push(p)}),f},l.prototype.getNeighborsList=function(){var d=new Set,f=this;return f.edges.forEach(function(h){if(h.source==f)d.add(h.target);else{if(h.target!=f)throw"Incorrect incidency!";d.add(h.source)}}),d},l.prototype.withChildren=function(){var d=new Set,f,h;if(d.add(this),this.child!=null)for(var v=this.child.getNodes(),p=0;p<v.length;p++)f=v[p],h=f.withChildren(),h.forEach(function(m){d.add(m)});return d},l.prototype.getNoOfChildren=function(){var d=0,f;if(this.child==null)d=1;else for(var h=this.child.getNodes(),v=0;v<h.length;v++)f=h[v],d+=f.getNoOfChildren();return d==0&&(d=1),d},l.prototype.getEstimatedSize=function(){if(this.estimatedSize==i.MIN_VALUE)throw"assert failed";return this.estimatedSize},l.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},l.prototype.scatter=function(){var d,f,h=-o.INITIAL_WORLD_BOUNDARY,v=o.INITIAL_WORLD_BOUNDARY;d=o.WORLD_CENTER_X+s.nextDouble()*(v-h)+h;var p=-o.INITIAL_WORLD_BOUNDARY,m=o.INITIAL_WORLD_BOUNDARY;f=o.WORLD_CENTER_Y+s.nextDouble()*(m-p)+p,this.rect.x=d,this.rect.y=f},l.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var d=this.getChild();if(d.updateBounds(!0),this.rect.x=d.getLeft(),this.rect.y=d.getTop(),this.setWidth(d.getRight()-d.getLeft()),this.setHeight(d.getBottom()-d.getTop()),o.NODE_DIMENSIONS_INCLUDE_LABELS){var f=d.getRight()-d.getLeft(),h=d.getBottom()-d.getTop();this.labelWidth&&(this.labelPosHorizontal=="left"?(this.rect.x-=this.labelWidth,this.setWidth(f+this.labelWidth)):this.labelPosHorizontal=="center"&&this.labelWidth>f?(this.rect.x-=(this.labelWidth-f)/2,this.setWidth(this.labelWidth)):this.labelPosHorizontal=="right"&&this.setWidth(f+this.labelWidth)),this.labelHeight&&(this.labelPosVertical=="top"?(this.rect.y-=this.labelHeight,this.setHeight(h+this.labelHeight)):this.labelPosVertical=="center"&&this.labelHeight>h?(this.rect.y-=(this.labelHeight-h)/2,this.setHeight(this.labelHeight)):this.labelPosVertical=="bottom"&&this.setHeight(h+this.labelHeight))}}},l.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==i.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},l.prototype.transform=function(d){var f=this.rect.x;f>o.WORLD_BOUNDARY?f=o.WORLD_BOUNDARY:f<-o.WORLD_BOUNDARY&&(f=-o.WORLD_BOUNDARY);var h=this.rect.y;h>o.WORLD_BOUNDARY?h=o.WORLD_BOUNDARY:h<-o.WORLD_BOUNDARY&&(h=-o.WORLD_BOUNDARY);var v=new u(f,h),p=d.inverseTransformPoint(v);this.setLocation(p.x,p.y)},l.prototype.getLeft=function(){return this.rect.x},l.prototype.getRight=function(){return this.rect.x+this.rect.width},l.prototype.getTop=function(){return this.rect.y},l.prototype.getBottom=function(){return this.rect.y+this.rect.height},l.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},r.exports=l},function(r,e,t){"use strict";var n=t(0);function i(){}for(var a in n)i[a]=n[a];i.MAX_ITERATIONS=2500,i.DEFAULT_EDGE_LENGTH=50,i.DEFAULT_SPRING_STRENGTH=.45,i.DEFAULT_REPULSION_STRENGTH=4500,i.DEFAULT_GRAVITY_STRENGTH=.4,i.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,i.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,i.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,i.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,i.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,i.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,i.COOLING_ADAPTATION_FACTOR=.33,i.ADAPTATION_LOWER_NODE_LIMIT=1e3,i.ADAPTATION_UPPER_NODE_LIMIT=5e3,i.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,i.MAX_NODE_DISPLACEMENT=i.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,i.MIN_REPULSION_DIST=i.DEFAULT_EDGE_LENGTH/10,i.CONVERGENCE_CHECK_PERIOD=100,i.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,i.MIN_EDGE_LENGTH=1,i.GRID_CALCULATION_CHECK_PERIOD=10,r.exports=i},function(r,e,t){"use strict";function n(i,a){i==null&&a==null?(this.x=0,this.y=0):(this.x=i,this.y=a)}n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.setX=function(i){this.x=i},n.prototype.setY=function(i){this.y=i},n.prototype.getDifference=function(i){return new DimensionD(this.x-i.x,this.y-i.y)},n.prototype.getCopy=function(){return new n(this.x,this.y)},n.prototype.translate=function(i){return this.x+=i.width,this.y+=i.height,this},r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(10),a=t(0),o=t(7),s=t(3),u=t(1),l=t(13),c=t(12),d=t(11);function f(v,p,m){n.call(this,m),this.estimatedSize=i.MIN_VALUE,this.margin=a.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=v,p!=null&&p instanceof o?this.graphManager=p:p!=null&&p instanceof Layout&&(this.graphManager=p.graphManager)}f.prototype=Object.create(n.prototype);for(var h in n)f[h]=n[h];f.prototype.getNodes=function(){return this.nodes},f.prototype.getEdges=function(){return this.edges},f.prototype.getGraphManager=function(){return this.graphManager},f.prototype.getParent=function(){return this.parent},f.prototype.getLeft=function(){return this.left},f.prototype.getRight=function(){return this.right},f.prototype.getTop=function(){return this.top},f.prototype.getBottom=function(){return this.bottom},f.prototype.isConnected=function(){return this.isConnected},f.prototype.add=function(v,p,m){if(p==null&&m==null){var g=v;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(g)>-1)throw"Node already in graph!";return g.owner=this,this.getNodes().push(g),g}else{var y=v;if(!(this.getNodes().indexOf(p)>-1&&this.getNodes().indexOf(m)>-1))throw"Source or target not in graph!";if(!(p.owner==m.owner&&p.owner==this))throw"Both owners must be this graph!";return p.owner!=m.owner?null:(y.source=p,y.target=m,y.isInterGraph=!1,this.getEdges().push(y),p.edges.push(y),m!=p&&m.edges.push(y),y)}},f.prototype.remove=function(v){var p=v;if(v instanceof s){if(p==null)throw"Node is null!";if(!(p.owner!=null&&p.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var m=p.edges.slice(),g,y=m.length,x=0;x<y;x++)g=m[x],g.isInterGraph?this.graphManager.remove(g):g.source.owner.remove(g);var S=this.nodes.indexOf(p);if(S==-1)throw"Node not in owner node list!";this.nodes.splice(S,1)}else if(v instanceof u){var g=v;if(g==null)throw"Edge is null!";if(!(g.source!=null&&g.target!=null))throw"Source and/or target is null!";if(!(g.source.owner!=null&&g.target.owner!=null&&g.source.owner==this&&g.target.owner==this))throw"Source and/or target owner is invalid!";var D=g.source.edges.indexOf(g),P=g.target.edges.indexOf(g);if(!(D>-1&&P>-1))throw"Source and/or target doesn't know this edge!";g.source.edges.splice(D,1),g.target!=g.source&&g.target.edges.splice(P,1);var S=g.source.owner.getEdges().indexOf(g);if(S==-1)throw"Not in owner's edge list!";g.source.owner.getEdges().splice(S,1)}},f.prototype.updateLeftTop=function(){for(var v=i.MAX_VALUE,p=i.MAX_VALUE,m,g,y,x=this.getNodes(),S=x.length,D=0;D<S;D++){var P=x[D];m=P.getTop(),g=P.getLeft(),v>m&&(v=m),p>g&&(p=g)}return v==i.MAX_VALUE?null:(x[0].getParent().paddingLeft!=null?y=x[0].getParent().paddingLeft:y=this.margin,this.left=p-y,this.top=v-y,new c(this.left,this.top))},f.prototype.updateBounds=function(v){for(var p=i.MAX_VALUE,m=-i.MAX_VALUE,g=i.MAX_VALUE,y=-i.MAX_VALUE,x,S,D,P,R,L=this.nodes,O=L.length,I=0;I<O;I++){var B=L[I];v&&B.child!=null&&B.updateBounds(),x=B.getLeft(),S=B.getRight(),D=B.getTop(),P=B.getBottom(),p>x&&(p=x),m<S&&(m=S),g>D&&(g=D),y<P&&(y=P)}var w=new l(p,g,m-p,y-g);p==i.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),L[0].getParent().paddingLeft!=null?R=L[0].getParent().paddingLeft:R=this.margin,this.left=w.x-R,this.right=w.x+w.width+R,this.top=w.y-R,this.bottom=w.y+w.height+R},f.calculateBounds=function(v){for(var p=i.MAX_VALUE,m=-i.MAX_VALUE,g=i.MAX_VALUE,y=-i.MAX_VALUE,x,S,D,P,R=v.length,L=0;L<R;L++){var O=v[L];x=O.getLeft(),S=O.getRight(),D=O.getTop(),P=O.getBottom(),p>x&&(p=x),m<S&&(m=S),g>D&&(g=D),y<P&&(y=P)}var I=new l(p,g,m-p,y-g);return I},f.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},f.prototype.getEstimatedSize=function(){if(this.estimatedSize==i.MIN_VALUE)throw"assert failed";return this.estimatedSize},f.prototype.calcEstimatedSize=function(){for(var v=0,p=this.nodes,m=p.length,g=0;g<m;g++){var y=p[g];v+=y.calcEstimatedSize()}return v==0?this.estimatedSize=a.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=v/Math.sqrt(this.nodes.length),this.estimatedSize},f.prototype.updateConnected=function(){var v=this;if(this.nodes.length==0){this.isConnected=!0;return}var p=new d,m=new Set,g=this.nodes[0],y,x,S=g.withChildren();for(S.forEach(function(I){p.push(I),m.add(I)});p.length!==0;){g=p.shift(),y=g.getEdges();for(var D=y.length,P=0;P<D;P++){var R=y[P];if(x=R.getOtherEndInGraph(g,this),x!=null&&!m.has(x)){var L=x.withChildren();L.forEach(function(I){p.push(I),m.add(I)})}}}if(this.isConnected=!1,m.size>=this.nodes.length){var O=0;m.forEach(function(I){I.owner==v&&O++}),O==this.nodes.length&&(this.isConnected=!0)}},r.exports=f},function(r,e,t){"use strict";var n,i=t(1);function a(o){n=t(6),this.layout=o,this.graphs=[],this.edges=[]}a.prototype.addRoot=function(){var o=this.layout.newGraph(),s=this.layout.newNode(null),u=this.add(o,s);return this.setRootGraph(u),this.rootGraph},a.prototype.add=function(o,s,u,l,c){if(u==null&&l==null&&c==null){if(o==null)throw"Graph is null!";if(s==null)throw"Parent node is null!";if(this.graphs.indexOf(o)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(o),o.parent!=null)throw"Already has a parent!";if(s.child!=null)throw"Already has a child!";return o.parent=s,s.child=o,o}else{c=u,l=s,u=o;var d=l.getOwner(),f=c.getOwner();if(!(d!=null&&d.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(f!=null&&f.getGraphManager()==this))throw"Target not in this graph mgr!";if(d==f)return u.isInterGraph=!1,d.add(u,l,c);if(u.isInterGraph=!0,u.source=l,u.target=c,this.edges.indexOf(u)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(u),!(u.source!=null&&u.target!=null))throw"Edge source and/or target is null!";if(!(u.source.edges.indexOf(u)==-1&&u.target.edges.indexOf(u)==-1))throw"Edge already in source and/or target incidency list!";return u.source.edges.push(u),u.target.edges.push(u),u}},a.prototype.remove=function(o){if(o instanceof n){var s=o;if(s.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(s==this.rootGraph||s.parent!=null&&s.parent.graphManager==this))throw"Invalid parent node!";var u=[];u=u.concat(s.getEdges());for(var l,c=u.length,d=0;d<c;d++)l=u[d],s.remove(l);var f=[];f=f.concat(s.getNodes());var h;c=f.length;for(var d=0;d<c;d++)h=f[d],s.remove(h);s==this.rootGraph&&this.setRootGraph(null);var v=this.graphs.indexOf(s);this.graphs.splice(v,1),s.parent=null}else if(o instanceof i){if(l=o,l==null)throw"Edge is null!";if(!l.isInterGraph)throw"Not an inter-graph edge!";if(!(l.source!=null&&l.target!=null))throw"Source and/or target is null!";if(!(l.source.edges.indexOf(l)!=-1&&l.target.edges.indexOf(l)!=-1))throw"Source and/or target doesn't know this edge!";var v=l.source.edges.indexOf(l);if(l.source.edges.splice(v,1),v=l.target.edges.indexOf(l),l.target.edges.splice(v,1),!(l.source.owner!=null&&l.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(l.source.owner.getGraphManager().edges.indexOf(l)==-1)throw"Not in owner graph manager's edge list!";var v=l.source.owner.getGraphManager().edges.indexOf(l);l.source.owner.getGraphManager().edges.splice(v,1)}},a.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},a.prototype.getGraphs=function(){return this.graphs},a.prototype.getAllNodes=function(){if(this.allNodes==null){for(var o=[],s=this.getGraphs(),u=s.length,l=0;l<u;l++)o=o.concat(s[l].getNodes());this.allNodes=o}return this.allNodes},a.prototype.resetAllNodes=function(){this.allNodes=null},a.prototype.resetAllEdges=function(){this.allEdges=null},a.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},a.prototype.getAllEdges=function(){if(this.allEdges==null){for(var o=[],s=this.getGraphs(),u=s.length,l=0;l<s.length;l++)o=o.concat(s[l].getEdges());o=o.concat(this.edges),this.allEdges=o}return this.allEdges},a.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},a.prototype.setAllNodesToApplyGravitation=function(o){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=o},a.prototype.getRoot=function(){return this.rootGraph},a.prototype.setRootGraph=function(o){if(o.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=o,o.parent==null&&(o.parent=this.layout.newNode("Root node"))},a.prototype.getLayout=function(){return this.layout},a.prototype.isOneAncestorOfOther=function(o,s){if(!(o!=null&&s!=null))throw"assert failed";if(o==s)return!0;var u=o.getOwner(),l;do{if(l=u.getParent(),l==null)break;if(l==s)return!0;if(u=l.getOwner(),u==null)break}while(!0);u=s.getOwner();do{if(l=u.getParent(),l==null)break;if(l==o)return!0;if(u=l.getOwner(),u==null)break}while(!0);return!1},a.prototype.calcLowestCommonAncestors=function(){for(var o,s,u,l,c,d=this.getAllEdges(),f=d.length,h=0;h<f;h++){if(o=d[h],s=o.source,u=o.target,o.lca=null,o.sourceInLca=s,o.targetInLca=u,s==u){o.lca=s.getOwner();continue}for(l=s.getOwner();o.lca==null;){for(o.targetInLca=u,c=u.getOwner();o.lca==null;){if(c==l){o.lca=c;break}if(c==this.rootGraph)break;if(o.lca!=null)throw"assert failed";o.targetInLca=c.getParent(),c=o.targetInLca.getOwner()}if(l==this.rootGraph)break;o.lca==null&&(o.sourceInLca=l.getParent(),l=o.sourceInLca.getOwner())}if(o.lca==null)throw"assert failed"}},a.prototype.calcLowestCommonAncestor=function(o,s){if(o==s)return o.getOwner();var u=o.getOwner();do{if(u==null)break;var l=s.getOwner();do{if(l==null)break;if(l==u)return l;l=l.getParent().getOwner()}while(!0);u=u.getParent().getOwner()}while(!0);return u},a.prototype.calcInclusionTreeDepths=function(o,s){o==null&&s==null&&(o=this.rootGraph,s=1);for(var u,l=o.getNodes(),c=l.length,d=0;d<c;d++)u=l[d],u.inclusionTreeDepth=s,u.child!=null&&this.calcInclusionTreeDepths(u.child,s+1)},a.prototype.includesInvalidEdge=function(){for(var o,s=[],u=this.edges.length,l=0;l<u;l++)o=this.edges[l],this.isOneAncestorOfOther(o.source,o.target)&&s.push(o);for(var l=0;l<s.length;l++)this.remove(s[l]);return!1},r.exports=a},function(r,e,t){"use strict";var n=t(12);function i(){}i.calcSeparationAmount=function(a,o,s,u){if(!a.intersects(o))throw"assert failed";var l=new Array(2);this.decideDirectionsForOverlappingNodes(a,o,l),s[0]=Math.min(a.getRight(),o.getRight())-Math.max(a.x,o.x),s[1]=Math.min(a.getBottom(),o.getBottom())-Math.max(a.y,o.y),a.getX()<=o.getX()&&a.getRight()>=o.getRight()?s[0]+=Math.min(o.getX()-a.getX(),a.getRight()-o.getRight()):o.getX()<=a.getX()&&o.getRight()>=a.getRight()&&(s[0]+=Math.min(a.getX()-o.getX(),o.getRight()-a.getRight())),a.getY()<=o.getY()&&a.getBottom()>=o.getBottom()?s[1]+=Math.min(o.getY()-a.getY(),a.getBottom()-o.getBottom()):o.getY()<=a.getY()&&o.getBottom()>=a.getBottom()&&(s[1]+=Math.min(a.getY()-o.getY(),o.getBottom()-a.getBottom()));var c=Math.abs((o.getCenterY()-a.getCenterY())/(o.getCenterX()-a.getCenterX()));o.getCenterY()===a.getCenterY()&&o.getCenterX()===a.getCenterX()&&(c=1);var d=c*s[0],f=s[1]/c;s[0]<f?f=s[0]:d=s[1],s[0]=-1*l[0]*(f/2+u),s[1]=-1*l[1]*(d/2+u)},i.decideDirectionsForOverlappingNodes=function(a,o,s){a.getCenterX()<o.getCenterX()?s[0]=-1:s[0]=1,a.getCenterY()<o.getCenterY()?s[1]=-1:s[1]=1},i.getIntersection2=function(a,o,s){var u=a.getCenterX(),l=a.getCenterY(),c=o.getCenterX(),d=o.getCenterY();if(a.intersects(o))return s[0]=u,s[1]=l,s[2]=c,s[3]=d,!0;var f=a.getX(),h=a.getY(),v=a.getRight(),p=a.getX(),m=a.getBottom(),g=a.getRight(),y=a.getWidthHalf(),x=a.getHeightHalf(),S=o.getX(),D=o.getY(),P=o.getRight(),R=o.getX(),L=o.getBottom(),O=o.getRight(),I=o.getWidthHalf(),B=o.getHeightHalf(),w=!1,T=!1;if(u===c){if(l>d)return s[0]=u,s[1]=h,s[2]=c,s[3]=L,!1;if(l<d)return s[0]=u,s[1]=m,s[2]=c,s[3]=D,!1}else if(l===d){if(u>c)return s[0]=f,s[1]=l,s[2]=P,s[3]=d,!1;if(u<c)return s[0]=v,s[1]=l,s[2]=S,s[3]=d,!1}else{var E=a.height/a.width,b=o.height/o.width,C=(d-l)/(c-u),_=void 0,M=void 0,A=void 0,F=void 0,N=void 0,z=void 0;if(-E===C?u>c?(s[0]=p,s[1]=m,w=!0):(s[0]=v,s[1]=h,w=!0):E===C&&(u>c?(s[0]=f,s[1]=h,w=!0):(s[0]=g,s[1]=m,w=!0)),-b===C?c>u?(s[2]=R,s[3]=L,T=!0):(s[2]=P,s[3]=D,T=!0):b===C&&(c>u?(s[2]=S,s[3]=D,T=!0):(s[2]=O,s[3]=L,T=!0)),w&&T)return!1;if(u>c?l>d?(_=this.getCardinalDirection(E,C,4),M=this.getCardinalDirection(b,C,2)):(_=this.getCardinalDirection(-E,C,3),M=this.getCardinalDirection(-b,C,1)):l>d?(_=this.getCardinalDirection(-E,C,1),M=this.getCardinalDirection(-b,C,3)):(_=this.getCardinalDirection(E,C,2),M=this.getCardinalDirection(b,C,4)),!w)switch(_){case 1:F=h,A=u+-x/C,s[0]=A,s[1]=F;break;case 2:A=g,F=l+y*C,s[0]=A,s[1]=F;break;case 3:F=m,A=u+x/C,s[0]=A,s[1]=F;break;case 4:A=p,F=l+-y*C,s[0]=A,s[1]=F;break}if(!T)switch(M){case 1:z=D,N=c+-B/C,s[2]=N,s[3]=z;break;case 2:N=O,z=d+I*C,s[2]=N,s[3]=z;break;case 3:z=L,N=c+B/C,s[2]=N,s[3]=z;break;case 4:N=R,z=d+-I*C,s[2]=N,s[3]=z;break}}return!1},i.getCardinalDirection=function(a,o,s){return a>o?s:1+s%4},i.getIntersection=function(a,o,s,u){if(u==null)return this.getIntersection2(a,o,s);var l=a.x,c=a.y,d=o.x,f=o.y,h=s.x,v=s.y,p=u.x,m=u.y,g=void 0,y=void 0,x=void 0,S=void 0,D=void 0,P=void 0,R=void 0,L=void 0,O=void 0;return x=f-c,D=l-d,R=d*c-l*f,S=m-v,P=h-p,L=p*v-h*m,O=x*P-S*D,O===0?null:(g=(D*L-P*R)/O,y=(S*R-x*L)/O,new n(g,y))},i.angleOfVector=function(a,o,s,u){var l=void 0;return a!==s?(l=Math.atan((u-o)/(s-a)),s<a?l+=Math.PI:u<o&&(l+=this.TWO_PI)):u<o?l=this.ONE_AND_HALF_PI:l=this.HALF_PI,l},i.doIntersect=function(a,o,s,u){var l=a.x,c=a.y,d=o.x,f=o.y,h=s.x,v=s.y,p=u.x,m=u.y,g=(d-l)*(m-v)-(p-h)*(f-c);if(g===0)return!1;var y=((m-v)*(p-l)+(h-p)*(m-c))/g,x=((c-f)*(p-l)+(d-l)*(m-c))/g;return 0<y&&y<1&&0<x&&x<1},i.findCircleLineIntersections=function(a,o,s,u,l,c,d){var f=(s-a)*(s-a)+(u-o)*(u-o),h=2*((a-l)*(s-a)+(o-c)*(u-o)),v=(a-l)*(a-l)+(o-c)*(o-c)-d*d,p=h*h-4*f*v;if(p>=0){var m=(-h+Math.sqrt(h*h-4*f*v))/(2*f),g=(-h-Math.sqrt(h*h-4*f*v))/(2*f),y=null;return m>=0&&m<=1?[m]:g>=0&&g<=1?[g]:y}else return null},i.HALF_PI=.5*Math.PI,i.ONE_AND_HALF_PI=1.5*Math.PI,i.TWO_PI=2*Math.PI,i.THREE_PI=3*Math.PI,r.exports=i},function(r,e,t){"use strict";function n(){}n.sign=function(i){return i>0?1:i<0?-1:0},n.floor=function(i){return i<0?Math.ceil(i):Math.floor(i)},n.ceil=function(i){return i<0?Math.floor(i):Math.ceil(i)},r.exports=n},function(r,e,t){"use strict";function n(){}n.MAX_VALUE=2147483647,n.MIN_VALUE=-2147483648,r.exports=n},function(r,e,t){"use strict";var n=function(){function l(c,d){for(var f=0;f<d.length;f++){var h=d[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}return function(c,d,f){return d&&l(c.prototype,d),f&&l(c,f),c}}();function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(c){return{value:c,next:null,prev:null}},o=function(c,d,f,h){return c!==null?c.next=d:h.head=d,f!==null?f.prev=d:h.tail=d,d.prev=c,d.next=f,h.length++,d},s=function(c,d){var f=c.prev,h=c.next;return f!==null?f.next=h:d.head=h,h!==null?h.prev=f:d.tail=f,c.prev=c.next=null,d.length--,c},u=function(){function l(c){var d=this;i(this,l),this.length=0,this.head=null,this.tail=null,c?.forEach(function(f){return d.push(f)})}return n(l,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(d,f){return o(f.prev,a(d),f,this)}},{key:"insertAfter",value:function(d,f){return o(f,a(d),f.next,this)}},{key:"insertNodeBefore",value:function(d,f){return o(f.prev,d,f,this)}},{key:"insertNodeAfter",value:function(d,f){return o(f,d,f.next,this)}},{key:"push",value:function(d){return o(this.tail,a(d),null,this)}},{key:"unshift",value:function(d){return o(null,a(d),this.head,this)}},{key:"remove",value:function(d){return s(d,this)}},{key:"pop",value:function(){return s(this.tail,this).value}},{key:"popNode",value:function(){return s(this.tail,this)}},{key:"shift",value:function(){return s(this.head,this).value}},{key:"shiftNode",value:function(){return s(this.head,this)}},{key:"get_object_at",value:function(d){if(d<=this.length()){for(var f=1,h=this.head;f<d;)h=h.next,f++;return h.value}}},{key:"set_object_at",value:function(d,f){if(d<=this.length()){for(var h=1,v=this.head;h<d;)v=v.next,h++;v.value=f}}}]),l}();r.exports=u},function(r,e,t){"use strict";function n(i,a,o){this.x=null,this.y=null,i==null&&a==null&&o==null?(this.x=0,this.y=0):typeof i=="number"&&typeof a=="number"&&o==null?(this.x=i,this.y=a):i.constructor.name=="Point"&&a==null&&o==null&&(o=i,this.x=o.x,this.y=o.y)}n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.getLocation=function(){return new n(this.x,this.y)},n.prototype.setLocation=function(i,a,o){i.constructor.name=="Point"&&a==null&&o==null?(o=i,this.setLocation(o.x,o.y)):typeof i=="number"&&typeof a=="number"&&o==null&&(parseInt(i)==i&&parseInt(a)==a?this.move(i,a):(this.x=Math.floor(i+.5),this.y=Math.floor(a+.5)))},n.prototype.move=function(i,a){this.x=i,this.y=a},n.prototype.translate=function(i,a){this.x+=i,this.y+=a},n.prototype.equals=function(i){if(i.constructor.name=="Point"){var a=i;return this.x==a.x&&this.y==a.y}return this==i},n.prototype.toString=function(){return new n().constructor.name+"[x="+this.x+",y="+this.y+"]"},r.exports=n},function(r,e,t){"use strict";function n(i,a,o,s){this.x=0,this.y=0,this.width=0,this.height=0,i!=null&&a!=null&&o!=null&&s!=null&&(this.x=i,this.y=a,this.width=o,this.height=s)}n.prototype.getX=function(){return this.x},n.prototype.setX=function(i){this.x=i},n.prototype.getY=function(){return this.y},n.prototype.setY=function(i){this.y=i},n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(i){this.width=i},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(i){this.height=i},n.prototype.getRight=function(){return this.x+this.width},n.prototype.getBottom=function(){return this.y+this.height},n.prototype.intersects=function(i){return!(this.getRight()<i.x||this.getBottom()<i.y||i.getRight()<this.x||i.getBottom()<this.y)},n.prototype.getCenterX=function(){return this.x+this.width/2},n.prototype.getMinX=function(){return this.getX()},n.prototype.getMaxX=function(){return this.getX()+this.width},n.prototype.getCenterY=function(){return this.y+this.height/2},n.prototype.getMinY=function(){return this.getY()},n.prototype.getMaxY=function(){return this.getY()+this.height},n.prototype.getWidthHalf=function(){return this.width/2},n.prototype.getHeightHalf=function(){return this.height/2},r.exports=n},function(r,e,t){"use strict";var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function i(){}i.lastID=0,i.createID=function(a){return i.isPrimitive(a)?a:(a.uniqueID!=null||(a.uniqueID=i.getString(),i.lastID++),a.uniqueID)},i.getString=function(a){return a==null&&(a=i.lastID),"Object#"+a},i.isPrimitive=function(a){var o=typeof a>"u"?"undefined":n(a);return a==null||o!="object"&&o!="function"},r.exports=i},function(r,e,t){"use strict";function n(h){if(Array.isArray(h)){for(var v=0,p=Array(h.length);v<h.length;v++)p[v]=h[v];return p}else return Array.from(h)}var i=t(0),a=t(7),o=t(3),s=t(1),u=t(6),l=t(5),c=t(17),d=t(29);function f(h){d.call(this),this.layoutQuality=i.QUALITY,this.createBendsAsNeeded=i.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=i.DEFAULT_INCREMENTAL,this.animationOnLayout=i.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=i.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=i.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=i.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new a(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,h!=null&&(this.isRemoteUse=h)}f.RANDOM_SEED=1,f.prototype=Object.create(d.prototype),f.prototype.getGraphManager=function(){return this.graphManager},f.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},f.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},f.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},f.prototype.newGraphManager=function(){var h=new a(this);return this.graphManager=h,h},f.prototype.newGraph=function(h){return new u(null,this.graphManager,h)},f.prototype.newNode=function(h){return new o(this.graphManager,h)},f.prototype.newEdge=function(h){return new s(null,null,h)},f.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},f.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var h;return this.checkLayoutSuccess()?h=!1:h=this.layout(),i.ANIMATE==="during"?!1:(h&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,h)},f.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},f.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var h,v=this.graphManager.getAllEdges(),p=0;p<v.length;p++)h=v[p];for(var m,g=this.graphManager.getRoot().getNodes(),p=0;p<g.length;p++)m=g[p];this.update(this.graphManager.getRoot())}},f.prototype.update=function(h){if(h==null)this.update2();else if(h instanceof o){var v=h;if(v.getChild()!=null)for(var p=v.getChild().getNodes(),m=0;m<p.length;m++)update(p[m]);if(v.vGraphObject!=null){var g=v.vGraphObject;g.update(v)}}else if(h instanceof s){var y=h;if(y.vGraphObject!=null){var x=y.vGraphObject;x.update(y)}}else if(h instanceof u){var S=h;if(S.vGraphObject!=null){var D=S.vGraphObject;D.update(S)}}},f.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=i.QUALITY,this.animationDuringLayout=i.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=i.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=i.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=i.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=i.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=i.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},f.prototype.transform=function(h){if(h==null)this.transform(new l(0,0));else{var v=new c,p=this.graphManager.getRoot().updateLeftTop();if(p!=null){v.setWorldOrgX(h.x),v.setWorldOrgY(h.y),v.setDeviceOrgX(p.x),v.setDeviceOrgY(p.y);for(var m=this.getAllNodes(),g,y=0;y<m.length;y++)g=m[y],g.transform(v)}}},f.prototype.positionNodesRandomly=function(h){if(h==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var v,p,m=h.getNodes(),g=0;g<m.length;g++)v=m[g],p=v.getChild(),p==null||p.getNodes().length==0?v.scatter():(this.positionNodesRandomly(p),v.updateBounds())},f.prototype.getFlatForest=function(){for(var h=[],v=!0,p=this.graphManager.getRoot().getNodes(),m=!0,g=0;g<p.length;g++)p[g].getChild()!=null&&(m=!1);if(!m)return h;var y=new Set,x=[],S=new Map,D=[];for(D=D.concat(p);D.length>0&&v;){for(x.push(D[0]);x.length>0&&v;){var P=x[0];x.splice(0,1),y.add(P);for(var R=P.getEdges(),g=0;g<R.length;g++){var L=R[g].getOtherEnd(P);if(S.get(P)!=L)if(!y.has(L))x.push(L),S.set(L,P);else{v=!1;break}}}if(!v)h=[];else{var O=[].concat(n(y));h.push(O);for(var g=0;g<O.length;g++){var I=O[g],B=D.indexOf(I);B>-1&&D.splice(B,1)}y=new Set,S=new Map}}return h},f.prototype.createDummyNodesForBendpoints=function(h){for(var v=[],p=h.source,m=this.graphManager.calcLowestCommonAncestor(h.source,h.target),g=0;g<h.bendpoints.length;g++){var y=this.newNode(null);y.setRect(new Point(0,0),new Dimension(1,1)),m.add(y);var x=this.newEdge(null);this.graphManager.add(x,p,y),v.add(y),p=y}var x=this.newEdge(null);return this.graphManager.add(x,p,h.target),this.edgeToDummyNodes.set(h,v),h.isInterGraph()?this.graphManager.remove(h):m.remove(h),v},f.prototype.createBendpointsFromDummyNodes=function(){var h=[];h=h.concat(this.graphManager.getAllEdges()),h=[].concat(n(this.edgeToDummyNodes.keys())).concat(h);for(var v=0;v<h.length;v++){var p=h[v];if(p.bendpoints.length>0){for(var m=this.edgeToDummyNodes.get(p),g=0;g<m.length;g++){var y=m[g],x=new l(y.getCenterX(),y.getCenterY()),S=p.bendpoints.get(g);S.x=x.x,S.y=x.y,y.getOwner().remove(y)}this.graphManager.add(p,p.source,p.target)}}},f.transform=function(h,v,p,m){if(p!=null&&m!=null){var g=v;if(h<=50){var y=v/p;g-=(v-y)/50*(50-h)}else{var x=v*m;g+=(x-v)/50*(h-50)}return g}else{var S,D;return h<=50?(S=9*v/500,D=v/10):(S=9*v/50,D=-8*v),S*h+D}},f.findCenterOfTree=function(h){var v=[];v=v.concat(h);var p=[],m=new Map,g=!1,y=null;(v.length==1||v.length==2)&&(g=!0,y=v[0]);for(var x=0;x<v.length;x++){var S=v[x],D=S.getNeighborsList().size;m.set(S,S.getNeighborsList().size),D==1&&p.push(S)}var P=[];for(P=P.concat(p);!g;){var R=[];R=R.concat(P),P=[];for(var x=0;x<v.length;x++){var S=v[x],L=v.indexOf(S);L>=0&&v.splice(L,1);var O=S.getNeighborsList();O.forEach(function(w){if(p.indexOf(w)<0){var T=m.get(w),E=T-1;E==1&&P.push(w),m.set(w,E)}})}p=p.concat(P),(v.length==1||v.length==2)&&(g=!0,y=v[0])}return y},f.prototype.setGraphManager=function(h){this.graphManager=h},r.exports=f},function(r,e,t){"use strict";function n(){}n.seed=1,n.x=0,n.nextDouble=function(){return n.x=Math.sin(n.seed++)*1e4,n.x-Math.floor(n.x)},r.exports=n},function(r,e,t){"use strict";var n=t(5);function i(a,o){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}i.prototype.getWorldOrgX=function(){return this.lworldOrgX},i.prototype.setWorldOrgX=function(a){this.lworldOrgX=a},i.prototype.getWorldOrgY=function(){return this.lworldOrgY},i.prototype.setWorldOrgY=function(a){this.lworldOrgY=a},i.prototype.getWorldExtX=function(){return this.lworldExtX},i.prototype.setWorldExtX=function(a){this.lworldExtX=a},i.prototype.getWorldExtY=function(){return this.lworldExtY},i.prototype.setWorldExtY=function(a){this.lworldExtY=a},i.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},i.prototype.setDeviceOrgX=function(a){this.ldeviceOrgX=a},i.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},i.prototype.setDeviceOrgY=function(a){this.ldeviceOrgY=a},i.prototype.getDeviceExtX=function(){return this.ldeviceExtX},i.prototype.setDeviceExtX=function(a){this.ldeviceExtX=a},i.prototype.getDeviceExtY=function(){return this.ldeviceExtY},i.prototype.setDeviceExtY=function(a){this.ldeviceExtY=a},i.prototype.transformX=function(a){var o=0,s=this.lworldExtX;return s!=0&&(o=this.ldeviceOrgX+(a-this.lworldOrgX)*this.ldeviceExtX/s),o},i.prototype.transformY=function(a){var o=0,s=this.lworldExtY;return s!=0&&(o=this.ldeviceOrgY+(a-this.lworldOrgY)*this.ldeviceExtY/s),o},i.prototype.inverseTransformX=function(a){var o=0,s=this.ldeviceExtX;return s!=0&&(o=this.lworldOrgX+(a-this.ldeviceOrgX)*this.lworldExtX/s),o},i.prototype.inverseTransformY=function(a){var o=0,s=this.ldeviceExtY;return s!=0&&(o=this.lworldOrgY+(a-this.ldeviceOrgY)*this.lworldExtY/s),o},i.prototype.inverseTransformPoint=function(a){var o=new n(this.inverseTransformX(a.x),this.inverseTransformY(a.y));return o},r.exports=i},function(r,e,t){"use strict";function n(d){if(Array.isArray(d)){for(var f=0,h=Array(d.length);f<d.length;f++)h[f]=d[f];return h}else return Array.from(d)}var i=t(15),a=t(4),o=t(0),s=t(8),u=t(9);function l(){i.call(this),this.useSmartIdealEdgeLengthCalculation=a.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=a.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=a.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=a.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=a.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*a.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=a.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=a.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=a.MAX_ITERATIONS}l.prototype=Object.create(i.prototype);for(var c in i)l[c]=i[c];l.prototype.initParameters=function(){i.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=a.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},l.prototype.calcIdealEdgeLengths=function(){for(var d,f,h,v,p,m,g,y=this.getGraphManager().getAllEdges(),x=0;x<y.length;x++)d=y[x],f=d.idealLength,d.isInterGraph&&(v=d.getSource(),p=d.getTarget(),m=d.getSourceInLca().getEstimatedSize(),g=d.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(d.idealLength+=m+g-2*o.SIMPLE_NODE_SIZE),h=d.getLca().getInclusionTreeDepth(),d.idealLength+=f*a.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(v.getInclusionTreeDepth()+p.getInclusionTreeDepth()-2*h))},l.prototype.initSpringEmbedder=function(){var d=this.getAllNodes().length;this.incremental?(d>a.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*a.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(d-a.ADAPTATION_LOWER_NODE_LIMIT)/(a.ADAPTATION_UPPER_NODE_LIMIT-a.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-a.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=a.MAX_NODE_DISPLACEMENT_INCREMENTAL):(d>a.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(a.COOLING_ADAPTATION_FACTOR,1-(d-a.ADAPTATION_LOWER_NODE_LIMIT)/(a.ADAPTATION_UPPER_NODE_LIMIT-a.ADAPTATION_LOWER_NODE_LIMIT)*(1-a.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=a.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.displacementThresholdPerNode=3*a.DEFAULT_EDGE_LENGTH/100,this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},l.prototype.calcSpringForces=function(){for(var d=this.getAllEdges(),f,h=0;h<d.length;h++)f=d[h],this.calcSpringForce(f,f.idealLength)},l.prototype.calcRepulsionForces=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,h,v,p,m,g=this.getAllNodes(),y;if(this.useFRGridVariant)for(this.totalIterations%a.GRID_CALCULATION_CHECK_PERIOD==1&&d&&this.updateGrid(),y=new Set,h=0;h<g.length;h++)p=g[h],this.calculateRepulsionForceOfANode(p,y,d,f),y.add(p);else for(h=0;h<g.length;h++)for(p=g[h],v=h+1;v<g.length;v++)m=g[v],p.getOwner()==m.getOwner()&&this.calcRepulsionForce(p,m)},l.prototype.calcGravitationalForces=function(){for(var d,f=this.getAllNodesToApplyGravitation(),h=0;h<f.length;h++)d=f[h],this.calcGravitationalForce(d)},l.prototype.moveNodes=function(){for(var d=this.getAllNodes(),f,h=0;h<d.length;h++)f=d[h],f.move()},l.prototype.calcSpringForce=function(d,f){var h=d.getSource(),v=d.getTarget(),p,m,g,y;if(this.uniformLeafNodeSizes&&h.getChild()==null&&v.getChild()==null)d.updateLengthSimple();else if(d.updateLength(),d.isOverlapingSourceAndTarget)return;p=d.getLength(),p!=0&&(m=d.edgeElasticity*(p-f),g=m*(d.lengthX/p),y=m*(d.lengthY/p),h.springForceX+=g,h.springForceY+=y,v.springForceX-=g,v.springForceY-=y)},l.prototype.calcRepulsionForce=function(d,f){var h=d.getRect(),v=f.getRect(),p=new Array(2),m=new Array(4),g,y,x,S,D,P,R;if(h.intersects(v)){s.calcSeparationAmount(h,v,p,a.DEFAULT_EDGE_LENGTH/2),P=2*p[0],R=2*p[1];var L=d.noOfChildren*f.noOfChildren/(d.noOfChildren+f.noOfChildren);d.repulsionForceX-=L*P,d.repulsionForceY-=L*R,f.repulsionForceX+=L*P,f.repulsionForceY+=L*R}else this.uniformLeafNodeSizes&&d.getChild()==null&&f.getChild()==null?(g=v.getCenterX()-h.getCenterX(),y=v.getCenterY()-h.getCenterY()):(s.getIntersection(h,v,m),g=m[2]-m[0],y=m[3]-m[1]),Math.abs(g)<a.MIN_REPULSION_DIST&&(g=u.sign(g)*a.MIN_REPULSION_DIST),Math.abs(y)<a.MIN_REPULSION_DIST&&(y=u.sign(y)*a.MIN_REPULSION_DIST),x=g*g+y*y,S=Math.sqrt(x),D=(d.nodeRepulsion/2+f.nodeRepulsion/2)*d.noOfChildren*f.noOfChildren/x,P=D*g/S,R=D*y/S,d.repulsionForceX-=P,d.repulsionForceY-=R,f.repulsionForceX+=P,f.repulsionForceY+=R},l.prototype.calcGravitationalForce=function(d){var f,h,v,p,m,g,y,x;f=d.getOwner(),h=(f.getRight()+f.getLeft())/2,v=(f.getTop()+f.getBottom())/2,p=d.getCenterX()-h,m=d.getCenterY()-v,g=Math.abs(p)+d.getWidth()/2,y=Math.abs(m)+d.getHeight()/2,d.getOwner()==this.graphManager.getRoot()?(x=f.getEstimatedSize()*this.gravityRangeFactor,(g>x||y>x)&&(d.gravitationForceX=-this.gravityConstant*p,d.gravitationForceY=-this.gravityConstant*m)):(x=f.getEstimatedSize()*this.compoundGravityRangeFactor,(g>x||y>x)&&(d.gravitationForceX=-this.gravityConstant*p*this.compoundGravityConstant,d.gravitationForceY=-this.gravityConstant*m*this.compoundGravityConstant))},l.prototype.isConverged=function(){var d,f=!1;return this.totalIterations>this.maxIterations/3&&(f=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),d=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,d||f},l.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},l.prototype.calcNoOfChildrenForAllNodes=function(){for(var d,f=this.graphManager.getAllNodes(),h=0;h<f.length;h++)d=f[h],d.noOfChildren=d.getNoOfChildren()},l.prototype.calcGrid=function(d){var f=0,h=0;f=parseInt(Math.ceil((d.getRight()-d.getLeft())/this.repulsionRange)),h=parseInt(Math.ceil((d.getBottom()-d.getTop())/this.repulsionRange));for(var v=new Array(f),p=0;p<f;p++)v[p]=new Array(h);for(var p=0;p<f;p++)for(var m=0;m<h;m++)v[p][m]=new Array;return v},l.prototype.addNodeToGrid=function(d,f,h){var v=0,p=0,m=0,g=0;v=parseInt(Math.floor((d.getRect().x-f)/this.repulsionRange)),p=parseInt(Math.floor((d.getRect().width+d.getRect().x-f)/this.repulsionRange)),m=parseInt(Math.floor((d.getRect().y-h)/this.repulsionRange)),g=parseInt(Math.floor((d.getRect().height+d.getRect().y-h)/this.repulsionRange));for(var y=v;y<=p;y++)for(var x=m;x<=g;x++)this.grid[y][x].push(d),d.setGridCoordinates(v,p,m,g)},l.prototype.updateGrid=function(){var d,f,h=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),d=0;d<h.length;d++)f=h[d],this.addNodeToGrid(f,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},l.prototype.calculateRepulsionForceOfANode=function(d,f,h,v){if(this.totalIterations%a.GRID_CALCULATION_CHECK_PERIOD==1&&h||v){var p=new Set;d.surrounding=new Array;for(var m,g=this.grid,y=d.startX-1;y<d.finishX+2;y++)for(var x=d.startY-1;x<d.finishY+2;x++)if(!(y<0||x<0||y>=g.length||x>=g[0].length)){for(var S=0;S<g[y][x].length;S++)if(m=g[y][x][S],!(d.getOwner()!=m.getOwner()||d==m)&&!f.has(m)&&!p.has(m)){var D=Math.abs(d.getCenterX()-m.getCenterX())-(d.getWidth()/2+m.getWidth()/2),P=Math.abs(d.getCenterY()-m.getCenterY())-(d.getHeight()/2+m.getHeight()/2);D<=this.repulsionRange&&P<=this.repulsionRange&&p.add(m)}}d.surrounding=[].concat(n(p))}for(y=0;y<d.surrounding.length;y++)this.calcRepulsionForce(d,d.surrounding[y])},l.prototype.calcRepulsionRange=function(){return 0},r.exports=l},function(r,e,t){"use strict";var n=t(1),i=t(4);function a(s,u,l){n.call(this,s,u,l),this.idealLength=i.DEFAULT_EDGE_LENGTH,this.edgeElasticity=i.DEFAULT_SPRING_STRENGTH}a.prototype=Object.create(n.prototype);for(var o in n)a[o]=n[o];r.exports=a},function(r,e,t){"use strict";var n=t(3),i=t(4);function a(s,u,l,c){n.call(this,s,u,l,c),this.nodeRepulsion=i.DEFAULT_REPULSION_STRENGTH,this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}a.prototype=Object.create(n.prototype);for(var o in n)a[o]=n[o];a.prototype.setGridCoordinates=function(s,u,l,c){this.startX=s,this.finishX=u,this.startY=l,this.finishY=c},r.exports=a},function(r,e,t){"use strict";function n(i,a){this.width=0,this.height=0,i!==null&&a!==null&&(this.height=a,this.width=i)}n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(i){this.width=i},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(i){this.height=i},r.exports=n},function(r,e,t){"use strict";var n=t(14);function i(){this.map={},this.keys=[]}i.prototype.put=function(a,o){var s=n.createID(a);this.contains(s)||(this.map[s]=o,this.keys.push(a))},i.prototype.contains=function(a){var o=n.createID(a);return this.map[a]!=null},i.prototype.get=function(a){var o=n.createID(a);return this.map[o]},i.prototype.keySet=function(){return this.keys},r.exports=i},function(r,e,t){"use strict";var n=t(14);function i(){this.set={}}i.prototype.add=function(a){var o=n.createID(a);this.contains(o)||(this.set[o]=a)},i.prototype.remove=function(a){delete this.set[n.createID(a)]},i.prototype.clear=function(){this.set={}},i.prototype.contains=function(a){return this.set[n.createID(a)]==a},i.prototype.isEmpty=function(){return this.size()===0},i.prototype.size=function(){return Object.keys(this.set).length},i.prototype.addAllTo=function(a){for(var o=Object.keys(this.set),s=o.length,u=0;u<s;u++)a.push(this.set[o[u]])},i.prototype.size=function(){return Object.keys(this.set).length},i.prototype.addAll=function(a){for(var o=a.length,s=0;s<o;s++){var u=a[s];this.add(u)}},r.exports=i},function(r,e,t){"use strict";function n(){}n.multMat=function(i,a){for(var o=[],s=0;s<i.length;s++){o[s]=[];for(var u=0;u<a[0].length;u++){o[s][u]=0;for(var l=0;l<i[0].length;l++)o[s][u]+=i[s][l]*a[l][u]}}return o},n.transpose=function(i){for(var a=[],o=0;o<i[0].length;o++){a[o]=[];for(var s=0;s<i.length;s++)a[o][s]=i[s][o]}return a},n.multCons=function(i,a){for(var o=[],s=0;s<i.length;s++)o[s]=i[s]*a;return o},n.minusOp=function(i,a){for(var o=[],s=0;s<i.length;s++)o[s]=i[s]-a[s];return o},n.dotProduct=function(i,a){for(var o=0,s=0;s<i.length;s++)o+=i[s]*a[s];return o},n.mag=function(i){return Math.sqrt(this.dotProduct(i,i))},n.normalize=function(i){for(var a=[],o=this.mag(i),s=0;s<i.length;s++)a[s]=i[s]/o;return a},n.multGamma=function(i){for(var a=[],o=0,s=0;s<i.length;s++)o+=i[s];o*=-1/i.length;for(var u=0;u<i.length;u++)a[u]=o+i[u];return a},n.multL=function(i,a,o){for(var s=[],u=[],l=[],c=0;c<a[0].length;c++){for(var d=0,f=0;f<a.length;f++)d+=-.5*a[f][c]*i[f];u[c]=d}for(var h=0;h<o.length;h++){for(var v=0,p=0;p<o.length;p++)v+=o[h][p]*u[p];l[h]=v}for(var m=0;m<a.length;m++){for(var g=0,y=0;y<a[0].length;y++)g+=a[m][y]*l[y];s[m]=g}return s},r.exports=n},function(r,e,t){"use strict";var n=function(){function s(u,l){for(var c=0;c<l.length;c++){var d=l[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}return function(u,l,c){return l&&s(u.prototype,l),c&&s(u,c),u}}();function i(s,u){if(!(s instanceof u))throw new TypeError("Cannot call a class as a function")}var a=t(11),o=function(){function s(u,l){i(this,s),(l!==null||l!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var c=void 0;u instanceof a?c=u.size():c=u.length,this._quicksort(u,0,c-1)}return n(s,[{key:"_quicksort",value:function(l,c,d){if(c<d){var f=this._partition(l,c,d);this._quicksort(l,c,f),this._quicksort(l,f+1,d)}}},{key:"_partition",value:function(l,c,d){for(var f=this._get(l,c),h=c,v=d;;){for(;this.compareFunction(f,this._get(l,v));)v--;for(;this.compareFunction(this._get(l,h),f);)h++;if(h<v)this._swap(l,h,v),h++,v--;else return v}}},{key:"_get",value:function(l,c){return l instanceof a?l.get_object_at(c):l[c]}},{key:"_set",value:function(l,c,d){l instanceof a?l.set_object_at(c,d):l[c]=d}},{key:"_swap",value:function(l,c,d){var f=this._get(l,c);this._set(l,c,this._get(l,d)),this._set(l,d,f)}},{key:"_defaultCompareFunction",value:function(l,c){return c>l}}]),s}();r.exports=o},function(r,e,t){"use strict";function n(){}n.svd=function(i){this.U=null,this.V=null,this.s=null,this.m=0,this.n=0,this.m=i.length,this.n=i[0].length;var a=Math.min(this.m,this.n);this.s=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(Math.min(this.m+1,this.n)),this.U=function(et){var Ze=function At(Je){if(Je.length==0)return 0;for(var at=[],vt=0;vt<Je[0];vt++)at.push(At(Je.slice(1)));return at};return Ze(et)}([this.m,a]),this.V=function(et){var Ze=function At(Je){if(Je.length==0)return 0;for(var at=[],vt=0;vt<Je[0];vt++)at.push(At(Je.slice(1)));return at};return Ze(et)}([this.n,this.n]);for(var o=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(this.n),s=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(this.m),u=!0,l=!0,c=Math.min(this.m-1,this.n),d=Math.max(0,Math.min(this.n-2,this.m)),f=0;f<Math.max(c,d);f++){if(f<c){this.s[f]=0;for(var h=f;h<this.m;h++)this.s[f]=n.hypot(this.s[f],i[h][f]);if(this.s[f]!==0){i[f][f]<0&&(this.s[f]=-this.s[f]);for(var v=f;v<this.m;v++)i[v][f]/=this.s[f];i[f][f]+=1}this.s[f]=-this.s[f]}for(var p=f+1;p<this.n;p++){if(function(et,Ze){return et&&Ze}(f<c,this.s[f]!==0)){for(var m=0,g=f;g<this.m;g++)m+=i[g][f]*i[g][p];m=-m/i[f][f];for(var y=f;y<this.m;y++)i[y][p]+=m*i[y][f]}o[p]=i[f][p]}if(function(et,Ze){return et&&Ze}(u,f<c))for(var x=f;x<this.m;x++)this.U[x][f]=i[x][f];if(f<d){o[f]=0;for(var S=f+1;S<this.n;S++)o[f]=n.hypot(o[f],o[S]);if(o[f]!==0){o[f+1]<0&&(o[f]=-o[f]);for(var D=f+1;D<this.n;D++)o[D]/=o[f];o[f+1]+=1}if(o[f]=-o[f],function(et,Ze){return et&&Ze}(f+1<this.m,o[f]!==0)){for(var P=f+1;P<this.m;P++)s[P]=0;for(var R=f+1;R<this.n;R++)for(var L=f+1;L<this.m;L++)s[L]+=o[R]*i[L][R];for(var O=f+1;O<this.n;O++)for(var I=-o[O]/o[f+1],B=f+1;B<this.m;B++)i[B][O]+=I*s[B]}if(l)for(var w=f+1;w<this.n;w++)this.V[w][f]=o[w]}}var T=Math.min(this.n,this.m+1);if(c<this.n&&(this.s[c]=i[c][c]),this.m<T&&(this.s[T-1]=0),d+1<T&&(o[d]=i[d][T-1]),o[T-1]=0,u){for(var E=c;E<a;E++){for(var b=0;b<this.m;b++)this.U[b][E]=0;this.U[E][E]=1}for(var C=c-1;C>=0;C--)if(this.s[C]!==0){for(var _=C+1;_<a;_++){for(var M=0,A=C;A<this.m;A++)M+=this.U[A][C]*this.U[A][_];M=-M/this.U[C][C];for(var F=C;F<this.m;F++)this.U[F][_]+=M*this.U[F][C]}for(var N=C;N<this.m;N++)this.U[N][C]=-this.U[N][C];this.U[C][C]=1+this.U[C][C];for(var z=0;z<C-1;z++)this.U[z][C]=0}else{for(var Y=0;Y<this.m;Y++)this.U[Y][C]=0;this.U[C][C]=1}}if(l)for(var U=this.n-1;U>=0;U--){if(function(et,Ze){return et&&Ze}(U<d,o[U]!==0))for(var ee=U+1;ee<a;ee++){for(var Q=0,j=U+1;j<this.n;j++)Q+=this.V[j][U]*this.V[j][ee];Q=-Q/this.V[U+1][U];for(var K=U+1;K<this.n;K++)this.V[K][ee]+=Q*this.V[K][U]}for(var H=0;H<this.n;H++)this.V[H][U]=0;this.V[U][U]=1}for(var k=T-1,G=0,$=Math.pow(2,-52),te=Math.pow(2,-966);T>0;){var q=void 0,ge=void 0;for(q=T-2;q>=-1&&q!==-1;q--)if(Math.abs(o[q])<=te+$*(Math.abs(this.s[q])+Math.abs(this.s[q+1]))){o[q]=0;break}if(q===T-2)ge=4;else{var Te=void 0;for(Te=T-1;Te>=q&&Te!==q;Te--){var he=(Te!==T?Math.abs(o[Te]):0)+(Te!==q+1?Math.abs(o[Te-1]):0);if(Math.abs(this.s[Te])<=te+$*he){this.s[Te]=0;break}}Te===q?ge=3:Te===T-1?ge=1:(ge=2,q=Te)}switch(q++,ge){case 1:{var ue=o[T-2];o[T-2]=0;for(var de=T-2;de>=q;de--){var me=n.hypot(this.s[de],ue),_e=this.s[de]/me,xe=ue/me;if(this.s[de]=me,de!==q&&(ue=-xe*o[de-1],o[de-1]=_e*o[de-1]),l)for(var Ce=0;Ce<this.n;Ce++)me=_e*this.V[Ce][de]+xe*this.V[Ce][T-1],this.V[Ce][T-1]=-xe*this.V[Ce][de]+_e*this.V[Ce][T-1],this.V[Ce][de]=me}}break;case 2:{var Ee=o[q-1];o[q-1]=0;for(var be=q;be<T;be++){var fe=n.hypot(this.s[be],Ee),V=this.s[be]/fe,re=Ee/fe;if(this.s[be]=fe,Ee=-re*o[be],o[be]=V*o[be],u)for(var le=0;le<this.m;le++)fe=V*this.U[le][be]+re*this.U[le][q-1],this.U[le][q-1]=-re*this.U[le][be]+V*this.U[le][q-1],this.U[le][be]=fe}}break;case 3:{var W=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[T-1]),Math.abs(this.s[T-2])),Math.abs(o[T-2])),Math.abs(this.s[q])),Math.abs(o[q])),Z=this.s[T-1]/W,ie=this.s[T-2]/W,ne=o[T-2]/W,oe=this.s[q]/W,ve=o[q]/W,Re=((ie+Z)*(ie-Z)+ne*ne)/2,we=Z*ne*(Z*ne),pe=0;(function(et,Ze){return et||Ze})(Re!==0,we!==0)&&(pe=Math.sqrt(Re*Re+we),Re<0&&(pe=-pe),pe=we/(Re+pe));for(var Se=(oe+Z)*(oe-Z)+pe,Me=oe*ve,Oe=q;Oe<T-1;Oe++){var Ve=n.hypot(Se,Me),Ke=Se/Ve,ze=Me/Ve;if(Oe!==q&&(o[Oe-1]=Ve),Se=Ke*this.s[Oe]+ze*o[Oe],o[Oe]=Ke*o[Oe]-ze*this.s[Oe],Me=ze*this.s[Oe+1],this.s[Oe+1]=Ke*this.s[Oe+1],l)for(var Ie=0;Ie<this.n;Ie++)Ve=Ke*this.V[Ie][Oe]+ze*this.V[Ie][Oe+1],this.V[Ie][Oe+1]=-ze*this.V[Ie][Oe]+Ke*this.V[Ie][Oe+1],this.V[Ie][Oe]=Ve;if(Ve=n.hypot(Se,Me),Ke=Se/Ve,ze=Me/Ve,this.s[Oe]=Ve,Se=Ke*o[Oe]+ze*this.s[Oe+1],this.s[Oe+1]=-ze*o[Oe]+Ke*this.s[Oe+1],Me=ze*o[Oe+1],o[Oe+1]=Ke*o[Oe+1],u&&Oe<this.m-1)for(var He=0;He<this.m;He++)Ve=Ke*this.U[He][Oe]+ze*this.U[He][Oe+1],this.U[He][Oe+1]=-ze*this.U[He][Oe]+Ke*this.U[He][Oe+1],this.U[He][Oe]=Ve}o[T-2]=Se,G=G+1}break;case 4:{if(this.s[q]<=0&&(this.s[q]=this.s[q]<0?-this.s[q]:0,l))for(var ke=0;ke<=k;ke++)this.V[ke][q]=-this.V[ke][q];for(;q<k&&!(this.s[q]>=this.s[q+1]);){var Ge=this.s[q];if(this.s[q]=this.s[q+1],this.s[q+1]=Ge,l&&q<this.n-1)for(var rt=0;rt<this.n;rt++)Ge=this.V[rt][q+1],this.V[rt][q+1]=this.V[rt][q],this.V[rt][q]=Ge;if(u&&q<this.m-1)for(var nt=0;nt<this.m;nt++)Ge=this.U[nt][q+1],this.U[nt][q+1]=this.U[nt][q],this.U[nt][q]=Ge;q++}G=0,T--}break}}var mt={U:this.U,V:this.V,S:this.s};return mt},n.hypot=function(i,a){var o=void 0;return Math.abs(i)>Math.abs(a)?(o=a/i,o=Math.abs(i)*Math.sqrt(1+o*o)):a!=0?(o=i/a,o=Math.abs(a)*Math.sqrt(1+o*o)):o=0,o},r.exports=n},function(r,e,t){"use strict";var n=function(){function o(s,u){for(var l=0;l<u.length;l++){var c=u[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(s,c.key,c)}}return function(s,u,l){return u&&o(s.prototype,u),l&&o(s,l),s}}();function i(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}var a=function(){function o(s,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;i(this,o),this.sequence1=s,this.sequence2=u,this.match_score=l,this.mismatch_penalty=c,this.gap_penalty=d,this.iMax=s.length+1,this.jMax=u.length+1,this.grid=new Array(this.iMax);for(var f=0;f<this.iMax;f++){this.grid[f]=new Array(this.jMax);for(var h=0;h<this.jMax;h++)this.grid[f][h]=0}this.tracebackGrid=new Array(this.iMax);for(var v=0;v<this.iMax;v++){this.tracebackGrid[v]=new Array(this.jMax);for(var p=0;p<this.jMax;p++)this.tracebackGrid[v][p]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return n(o,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var u=1;u<this.jMax;u++)this.grid[0][u]=this.grid[0][u-1]+this.gap_penalty,this.tracebackGrid[0][u]=[!1,!1,!0];for(var l=1;l<this.iMax;l++)this.grid[l][0]=this.grid[l-1][0]+this.gap_penalty,this.tracebackGrid[l][0]=[!1,!0,!1];for(var c=1;c<this.iMax;c++)for(var d=1;d<this.jMax;d++){var f=void 0;this.sequence1[c-1]===this.sequence2[d-1]?f=this.grid[c-1][d-1]+this.match_score:f=this.grid[c-1][d-1]+this.mismatch_penalty;var h=this.grid[c-1][d]+this.gap_penalty,v=this.grid[c][d-1]+this.gap_penalty,p=[f,h,v],m=this.arrayAllMaxIndexes(p);this.grid[c][d]=p[m[0]],this.tracebackGrid[c][d]=[m.includes(0),m.includes(1),m.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var u=[];for(u.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});u[0];){var l=u[0],c=this.tracebackGrid[l.pos[0]][l.pos[1]];c[0]&&u.push({pos:[l.pos[0]-1,l.pos[1]-1],seq1:this.sequence1[l.pos[0]-1]+l.seq1,seq2:this.sequence2[l.pos[1]-1]+l.seq2}),c[1]&&u.push({pos:[l.pos[0]-1,l.pos[1]],seq1:this.sequence1[l.pos[0]-1]+l.seq1,seq2:"-"+l.seq2}),c[2]&&u.push({pos:[l.pos[0],l.pos[1]-1],seq1:"-"+l.seq1,seq2:this.sequence2[l.pos[1]-1]+l.seq2}),l.pos[0]===0&&l.pos[1]===0&&this.alignments.push({sequence1:l.seq1,sequence2:l.seq2}),u.shift()}return this.alignments}},{key:"getAllIndexes",value:function(u,l){for(var c=[],d=-1;(d=u.indexOf(l,d+1))!==-1;)c.push(d);return c}},{key:"arrayAllMaxIndexes",value:function(u){return this.getAllIndexes(u,Math.max.apply(null,u))}}]),o}();r.exports=a},function(r,e,t){"use strict";var n=function(){};n.FDLayout=t(18),n.FDLayoutConstants=t(4),n.FDLayoutEdge=t(19),n.FDLayoutNode=t(20),n.DimensionD=t(21),n.HashMap=t(22),n.HashSet=t(23),n.IGeometry=t(8),n.IMath=t(9),n.Integer=t(10),n.Point=t(12),n.PointD=t(5),n.RandomSeed=t(16),n.RectangleD=t(13),n.Transform=t(17),n.UniqueIDGeneretor=t(14),n.Quicksort=t(25),n.LinkedList=t(11),n.LGraphObject=t(2),n.LGraph=t(6),n.LEdge=t(1),n.LGraphManager=t(7),n.LNode=t(3),n.Layout=t(15),n.LayoutConstants=t(0),n.NeedlemanWunsch=t(27),n.Matrix=t(24),n.SVD=t(26),r.exports=n},function(r,e,t){"use strict";function n(){this.listeners=[]}var i=n.prototype;i.addListener=function(a,o){this.listeners.push({event:a,callback:o})},i.removeListener=function(a,o){for(var s=this.listeners.length;s>=0;s--){var u=this.listeners[s];u.event===a&&u.callback===o&&this.listeners.splice(s,1)}},i.emit=function(a,o){for(var s=0;s<this.listeners.length;s++){var u=this.listeners[s];a===u.event&&u.callback(o)}},r.exports=n}])})});var dc=fa((co,cc)=>{"use strict";(function(e,t){typeof co=="object"&&typeof cc=="object"?cc.exports=t(uc()):typeof define=="function"&&define.amd?define(["layout-base"],t):typeof co=="object"?co.coseBase=t(uc()):e.coseBase=t(e.layoutBase)})(co,function(r){return(()=>{"use strict";var e={45:(a,o,s)=>{var u={};u.layoutBase=s(551),u.CoSEConstants=s(806),u.CoSEEdge=s(767),u.CoSEGraph=s(880),u.CoSEGraphManager=s(578),u.CoSELayout=s(765),u.CoSENode=s(991),u.ConstraintHandler=s(902),a.exports=u},806:(a,o,s)=>{var u=s(551).FDLayoutConstants;function l(){}for(var c in u)l[c]=u[c];l.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,l.DEFAULT_RADIAL_SEPARATION=u.DEFAULT_EDGE_LENGTH,l.DEFAULT_COMPONENT_SEPERATION=60,l.TILE=!0,l.TILING_PADDING_VERTICAL=10,l.TILING_PADDING_HORIZONTAL=10,l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,l.ENFORCE_CONSTRAINTS=!0,l.APPLY_LAYOUT=!0,l.RELAX_MOVEMENT_ON_CONSTRAINTS=!0,l.TREE_REDUCTION_ON_INCREMENTAL=!0,l.PURE_INCREMENTAL=l.DEFAULT_INCREMENTAL,a.exports=l},767:(a,o,s)=>{var u=s(551).FDLayoutEdge;function l(d,f,h){u.call(this,d,f,h)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},880:(a,o,s)=>{var u=s(551).LGraph;function l(d,f,h){u.call(this,d,f,h)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},578:(a,o,s)=>{var u=s(551).LGraphManager;function l(d){u.call(this,d)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},765:(a,o,s)=>{var u=s(551).FDLayout,l=s(578),c=s(880),d=s(991),f=s(767),h=s(806),v=s(902),p=s(551).FDLayoutConstants,m=s(551).LayoutConstants,g=s(551).Point,y=s(551).PointD,x=s(551).DimensionD,S=s(551).Layout,D=s(551).Integer,P=s(551).IGeometry,R=s(551).LGraph,L=s(551).Transform,O=s(551).LinkedList;function I(){u.call(this),this.toBeTiled={},this.constraints={}}I.prototype=Object.create(u.prototype);for(var B in u)I[B]=u[B];I.prototype.newGraphManager=function(){var w=new l(this);return this.graphManager=w,w},I.prototype.newGraph=function(w){return new c(null,this.graphManager,w)},I.prototype.newNode=function(w){return new d(this.graphManager,w)},I.prototype.newEdge=function(w){return new f(null,null,w)},I.prototype.initParameters=function(){u.prototype.initParameters.call(this,arguments),this.isSubLayout||(h.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=h.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=h.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=p.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=p.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=p.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=p.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1)},I.prototype.initSpringEmbedder=function(){u.prototype.initSpringEmbedder.call(this),this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/p.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=.04,this.coolingAdjuster=1},I.prototype.layout=function(){var w=m.DEFAULT_CREATE_BENDS_AS_NEEDED;return w&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},I.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(h.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var T=new Set(this.getAllNodes()),E=this.nodesWithGravity.filter(function(_){return T.has(_)});this.graphManager.setAllNodesToApplyGravitation(E)}}else{var w=this.getFlatForest();if(w.length>0)this.positionNodesRadially(w);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var T=new Set(this.getAllNodes()),E=this.nodesWithGravity.filter(function(b){return T.has(b)});this.graphManager.setAllNodesToApplyGravitation(E),this.positionNodesRandomly()}}return Object.keys(this.constraints).length>0&&(v.handleConstraints(this),this.initConstraintVariables()),this.initSpringEmbedder(),h.APPLY_LAYOUT&&this.runSpringEmbedder(),!0},I.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%p.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var w=new Set(this.getAllNodes()),T=this.nodesWithGravity.filter(function(C){return w.has(C)});this.graphManager.setAllNodesToApplyGravitation(T),this.graphManager.updateBounds(),this.updateGrid(),h.PURE_INCREMENTAL?this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL/2:this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),h.PURE_INCREMENTAL?this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL/2*((100-this.afterGrowthIterations)/100):this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var E=!this.isTreeGrowing&&!this.isGrowthFinished,b=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(E,b),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},I.prototype.getPositionsData=function(){for(var w=this.graphManager.getAllNodes(),T={},E=0;E<w.length;E++){var b=w[E].rect,C=w[E].id;T[C]={id:C,x:b.getCenterX(),y:b.getCenterY(),w:b.width,h:b.height}}return T},I.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var w=!1;if(p.ANIMATE==="during")this.emit("layoutstarted");else{for(;!w;)w=this.tick();this.graphManager.updateBounds()}},I.prototype.moveNodes=function(){for(var w=this.getAllNodes(),T,E=0;E<w.length;E++)T=w[E],T.calculateDisplacement();Object.keys(this.constraints).length>0&&this.updateDisplacements();for(var E=0;E<w.length;E++)T=w[E],T.move()},I.prototype.initConstraintVariables=function(){var w=this;this.idToNodeMap=new Map,this.fixedNodeSet=new Set;for(var T=this.graphManager.getAllNodes(),E=0;E<T.length;E++){var b=T[E];this.idToNodeMap.set(b.id,b)}var C=function j(K){for(var H=K.getChild().getNodes(),k,G=0,$=0;$<H.length;$++)k=H[$],k.getChild()==null?w.fixedNodeSet.has(k.id)&&(G+=100):G+=j(k);return G};if(this.constraints.fixedNodeConstraint){this.constraints.fixedNodeConstraint.forEach(function(H){w.fixedNodeSet.add(H.nodeId)});for(var T=this.graphManager.getAllNodes(),b,E=0;E<T.length;E++)if(b=T[E],b.getChild()!=null){var _=C(b);_>0&&(b.fixedNodeWeight=_)}}if(this.constraints.relativePlacementConstraint){var M=new Map,A=new Map;if(this.dummyToNodeForVerticalAlignment=new Map,this.dummyToNodeForHorizontalAlignment=new Map,this.fixedNodesOnHorizontal=new Set,this.fixedNodesOnVertical=new Set,this.fixedNodeSet.forEach(function(j){w.fixedNodesOnHorizontal.add(j),w.fixedNodesOnVertical.add(j)}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var F=this.constraints.alignmentConstraint.vertical,E=0;E<F.length;E++)this.dummyToNodeForVerticalAlignment.set("dummy"+E,[]),F[E].forEach(function(K){M.set(K,"dummy"+E),w.dummyToNodeForVerticalAlignment.get("dummy"+E).push(K),w.fixedNodeSet.has(K)&&w.fixedNodesOnHorizontal.add("dummy"+E)});if(this.constraints.alignmentConstraint.horizontal)for(var N=this.constraints.alignmentConstraint.horizontal,E=0;E<N.length;E++)this.dummyToNodeForHorizontalAlignment.set("dummy"+E,[]),N[E].forEach(function(K){A.set(K,"dummy"+E),w.dummyToNodeForHorizontalAlignment.get("dummy"+E).push(K),w.fixedNodeSet.has(K)&&w.fixedNodesOnVertical.add("dummy"+E)})}if(h.RELAX_MOVEMENT_ON_CONSTRAINTS)this.shuffle=function(j){var K,H,k;for(k=j.length-1;k>=2*j.length/3;k--)K=Math.floor(Math.random()*(k+1)),H=j[k],j[k]=j[K],j[K]=H;return j},this.nodesInRelativeHorizontal=[],this.nodesInRelativeVertical=[],this.nodeToRelativeConstraintMapHorizontal=new Map,this.nodeToRelativeConstraintMapVertical=new Map,this.nodeToTempPositionMapHorizontal=new Map,this.nodeToTempPositionMapVertical=new Map,this.constraints.relativePlacementConstraint.forEach(function(j){if(j.left){var K=M.has(j.left)?M.get(j.left):j.left,H=M.has(j.right)?M.get(j.right):j.right;w.nodesInRelativeHorizontal.includes(K)||(w.nodesInRelativeHorizontal.push(K),w.nodeToRelativeConstraintMapHorizontal.set(K,[]),w.dummyToNodeForVerticalAlignment.has(K)?w.nodeToTempPositionMapHorizontal.set(K,w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(K)[0]).getCenterX()):w.nodeToTempPositionMapHorizontal.set(K,w.idToNodeMap.get(K).getCenterX())),w.nodesInRelativeHorizontal.includes(H)||(w.nodesInRelativeHorizontal.push(H),w.nodeToRelativeConstraintMapHorizontal.set(H,[]),w.dummyToNodeForVerticalAlignment.has(H)?w.nodeToTempPositionMapHorizontal.set(H,w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(H)[0]).getCenterX()):w.nodeToTempPositionMapHorizontal.set(H,w.idToNodeMap.get(H).getCenterX())),w.nodeToRelativeConstraintMapHorizontal.get(K).push({right:H,gap:j.gap}),w.nodeToRelativeConstraintMapHorizontal.get(H).push({left:K,gap:j.gap})}else{var k=A.has(j.top)?A.get(j.top):j.top,G=A.has(j.bottom)?A.get(j.bottom):j.bottom;w.nodesInRelativeVertical.includes(k)||(w.nodesInRelativeVertical.push(k),w.nodeToRelativeConstraintMapVertical.set(k,[]),w.dummyToNodeForHorizontalAlignment.has(k)?w.nodeToTempPositionMapVertical.set(k,w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(k)[0]).getCenterY()):w.nodeToTempPositionMapVertical.set(k,w.idToNodeMap.get(k).getCenterY())),w.nodesInRelativeVertical.includes(G)||(w.nodesInRelativeVertical.push(G),w.nodeToRelativeConstraintMapVertical.set(G,[]),w.dummyToNodeForHorizontalAlignment.has(G)?w.nodeToTempPositionMapVertical.set(G,w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(G)[0]).getCenterY()):w.nodeToTempPositionMapVertical.set(G,w.idToNodeMap.get(G).getCenterY())),w.nodeToRelativeConstraintMapVertical.get(k).push({bottom:G,gap:j.gap}),w.nodeToRelativeConstraintMapVertical.get(G).push({top:k,gap:j.gap})}});else{var z=new Map,Y=new Map;this.constraints.relativePlacementConstraint.forEach(function(j){if(j.left){var K=M.has(j.left)?M.get(j.left):j.left,H=M.has(j.right)?M.get(j.right):j.right;z.has(K)?z.get(K).push(H):z.set(K,[H]),z.has(H)?z.get(H).push(K):z.set(H,[K])}else{var k=A.has(j.top)?A.get(j.top):j.top,G=A.has(j.bottom)?A.get(j.bottom):j.bottom;Y.has(k)?Y.get(k).push(G):Y.set(k,[G]),Y.has(G)?Y.get(G).push(k):Y.set(G,[k])}});var U=function(K,H){var k=[],G=[],$=new O,te=new Set,q=0;return K.forEach(function(ge,Te){if(!te.has(Te)){k[q]=[],G[q]=!1;var he=Te;for($.push(he),te.add(he),k[q].push(he);$.length!=0;){he=$.shift(),H.has(he)&&(G[q]=!0);var ue=K.get(he);ue.forEach(function(de){te.has(de)||($.push(de),te.add(de),k[q].push(de))})}q++}}),{components:k,isFixed:G}},ee=U(z,w.fixedNodesOnHorizontal);this.componentsOnHorizontal=ee.components,this.fixedComponentsOnHorizontal=ee.isFixed;var Q=U(Y,w.fixedNodesOnVertical);this.componentsOnVertical=Q.components,this.fixedComponentsOnVertical=Q.isFixed}}},I.prototype.updateDisplacements=function(){var w=this;if(this.constraints.fixedNodeConstraint&&this.constraints.fixedNodeConstraint.forEach(function(Q){var j=w.idToNodeMap.get(Q.nodeId);j.displacementX=0,j.displacementY=0}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var T=this.constraints.alignmentConstraint.vertical,E=0;E<T.length;E++){for(var b=0,C=0;C<T[E].length;C++){if(this.fixedNodeSet.has(T[E][C])){b=0;break}b+=this.idToNodeMap.get(T[E][C]).displacementX}for(var _=b/T[E].length,C=0;C<T[E].length;C++)this.idToNodeMap.get(T[E][C]).displacementX=_}if(this.constraints.alignmentConstraint.horizontal)for(var M=this.constraints.alignmentConstraint.horizontal,E=0;E<M.length;E++){for(var A=0,C=0;C<M[E].length;C++){if(this.fixedNodeSet.has(M[E][C])){A=0;break}A+=this.idToNodeMap.get(M[E][C]).displacementY}for(var F=A/M[E].length,C=0;C<M[E].length;C++)this.idToNodeMap.get(M[E][C]).displacementY=F}}if(this.constraints.relativePlacementConstraint)if(h.RELAX_MOVEMENT_ON_CONSTRAINTS)this.totalIterations%10==0&&(this.shuffle(this.nodesInRelativeHorizontal),this.shuffle(this.nodesInRelativeVertical)),this.nodesInRelativeHorizontal.forEach(function(Q){if(!w.fixedNodesOnHorizontal.has(Q)){var j=0;w.dummyToNodeForVerticalAlignment.has(Q)?j=w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(Q)[0]).displacementX:j=w.idToNodeMap.get(Q).displacementX,w.nodeToRelativeConstraintMapHorizontal.get(Q).forEach(function(K){if(K.right){var H=w.nodeToTempPositionMapHorizontal.get(K.right)-w.nodeToTempPositionMapHorizontal.get(Q)-j;H<K.gap&&(j-=K.gap-H)}else{var H=w.nodeToTempPositionMapHorizontal.get(Q)-w.nodeToTempPositionMapHorizontal.get(K.left)+j;H<K.gap&&(j+=K.gap-H)}}),w.nodeToTempPositionMapHorizontal.set(Q,w.nodeToTempPositionMapHorizontal.get(Q)+j),w.dummyToNodeForVerticalAlignment.has(Q)?w.dummyToNodeForVerticalAlignment.get(Q).forEach(function(K){w.idToNodeMap.get(K).displacementX=j}):w.idToNodeMap.get(Q).displacementX=j}}),this.nodesInRelativeVertical.forEach(function(Q){if(!w.fixedNodesOnHorizontal.has(Q)){var j=0;w.dummyToNodeForHorizontalAlignment.has(Q)?j=w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(Q)[0]).displacementY:j=w.idToNodeMap.get(Q).displacementY,w.nodeToRelativeConstraintMapVertical.get(Q).forEach(function(K){if(K.bottom){var H=w.nodeToTempPositionMapVertical.get(K.bottom)-w.nodeToTempPositionMapVertical.get(Q)-j;H<K.gap&&(j-=K.gap-H)}else{var H=w.nodeToTempPositionMapVertical.get(Q)-w.nodeToTempPositionMapVertical.get(K.top)+j;H<K.gap&&(j+=K.gap-H)}}),w.nodeToTempPositionMapVertical.set(Q,w.nodeToTempPositionMapVertical.get(Q)+j),w.dummyToNodeForHorizontalAlignment.has(Q)?w.dummyToNodeForHorizontalAlignment.get(Q).forEach(function(K){w.idToNodeMap.get(K).displacementY=j}):w.idToNodeMap.get(Q).displacementY=j}});else{for(var E=0;E<this.componentsOnHorizontal.length;E++){var N=this.componentsOnHorizontal[E];if(this.fixedComponentsOnHorizontal[E])for(var C=0;C<N.length;C++)this.dummyToNodeForVerticalAlignment.has(N[C])?this.dummyToNodeForVerticalAlignment.get(N[C]).forEach(function(K){w.idToNodeMap.get(K).displacementX=0}):this.idToNodeMap.get(N[C]).displacementX=0;else{for(var z=0,Y=0,C=0;C<N.length;C++)if(this.dummyToNodeForVerticalAlignment.has(N[C])){var U=this.dummyToNodeForVerticalAlignment.get(N[C]);z+=U.length*this.idToNodeMap.get(U[0]).displacementX,Y+=U.length}else z+=this.idToNodeMap.get(N[C]).displacementX,Y++;for(var ee=z/Y,C=0;C<N.length;C++)this.dummyToNodeForVerticalAlignment.has(N[C])?this.dummyToNodeForVerticalAlignment.get(N[C]).forEach(function(K){w.idToNodeMap.get(K).displacementX=ee}):this.idToNodeMap.get(N[C]).displacementX=ee}}for(var E=0;E<this.componentsOnVertical.length;E++){var N=this.componentsOnVertical[E];if(this.fixedComponentsOnVertical[E])for(var C=0;C<N.length;C++)this.dummyToNodeForHorizontalAlignment.has(N[C])?this.dummyToNodeForHorizontalAlignment.get(N[C]).forEach(function(H){w.idToNodeMap.get(H).displacementY=0}):this.idToNodeMap.get(N[C]).displacementY=0;else{for(var z=0,Y=0,C=0;C<N.length;C++)if(this.dummyToNodeForHorizontalAlignment.has(N[C])){var U=this.dummyToNodeForHorizontalAlignment.get(N[C]);z+=U.length*this.idToNodeMap.get(U[0]).displacementY,Y+=U.length}else z+=this.idToNodeMap.get(N[C]).displacementY,Y++;for(var ee=z/Y,C=0;C<N.length;C++)this.dummyToNodeForHorizontalAlignment.has(N[C])?this.dummyToNodeForHorizontalAlignment.get(N[C]).forEach(function($){w.idToNodeMap.get($).displacementY=ee}):this.idToNodeMap.get(N[C]).displacementY=ee}}}},I.prototype.calculateNodesToApplyGravitationTo=function(){var w=[],T,E=this.graphManager.getGraphs(),b=E.length,C;for(C=0;C<b;C++)T=E[C],T.updateConnected(),T.isConnected||(w=w.concat(T.getNodes()));return w},I.prototype.createBendpoints=function(){var w=[];w=w.concat(this.graphManager.getAllEdges());var T=new Set,E;for(E=0;E<w.length;E++){var b=w[E];if(!T.has(b)){var C=b.getSource(),_=b.getTarget();if(C==_)b.getBendpoints().push(new y),b.getBendpoints().push(new y),this.createDummyNodesForBendpoints(b),T.add(b);else{var M=[];if(M=M.concat(C.getEdgeListToNode(_)),M=M.concat(_.getEdgeListToNode(C)),!T.has(M[0])){if(M.length>1){var A;for(A=0;A<M.length;A++){var F=M[A];F.getBendpoints().push(new y),this.createDummyNodesForBendpoints(F)}}M.forEach(function(N){T.add(N)})}}}if(T.size==w.length)break}},I.prototype.positionNodesRadially=function(w){for(var T=new g(0,0),E=Math.ceil(Math.sqrt(w.length)),b=0,C=0,_=0,M=new y(0,0),A=0;A<w.length;A++){A%E==0&&(_=0,C=b,A!=0&&(C+=h.DEFAULT_COMPONENT_SEPERATION),b=0);var F=w[A],N=S.findCenterOfTree(F);T.x=_,T.y=C,M=I.radialLayout(F,N,T),M.y>b&&(b=Math.floor(M.y)),_=Math.floor(M.x+h.DEFAULT_COMPONENT_SEPERATION)}this.transform(new y(m.WORLD_CENTER_X-M.x/2,m.WORLD_CENTER_Y-M.y/2))},I.radialLayout=function(w,T,E){var b=Math.max(this.maxDiagonalInTree(w),h.DEFAULT_RADIAL_SEPARATION);I.branchRadialLayout(T,null,0,359,0,b);var C=R.calculateBounds(w),_=new L;_.setDeviceOrgX(C.getMinX()),_.setDeviceOrgY(C.getMinY()),_.setWorldOrgX(E.x),_.setWorldOrgY(E.y);for(var M=0;M<w.length;M++){var A=w[M];A.transform(_)}var F=new y(C.getMaxX(),C.getMaxY());return _.inverseTransformPoint(F)},I.branchRadialLayout=function(w,T,E,b,C,_){var M=(b-E+1)/2;M<0&&(M+=180);var A=(M+E)%360,F=A*P.TWO_PI/360,N=Math.cos(F),z=C*Math.cos(F),Y=C*Math.sin(F);w.setCenter(z,Y);var U=[];U=U.concat(w.getEdges());var ee=U.length;T!=null&&ee--;for(var Q=0,j=U.length,K,H=w.getEdgesBetween(T);H.length>1;){var k=H[0];H.splice(0,1);var G=U.indexOf(k);G>=0&&U.splice(G,1),j--,ee--}T!=null?K=(U.indexOf(H[0])+1)%j:K=0;for(var $=Math.abs(b-E)/ee,te=K;Q!=ee;te=++te%j){var q=U[te].getOtherEnd(w);if(q!=T){var ge=(E+Q*$)%360,Te=(ge+$)%360;I.branchRadialLayout(q,w,ge,Te,C+_,_),Q++}}},I.maxDiagonalInTree=function(w){for(var T=D.MIN_VALUE,E=0;E<w.length;E++){var b=w[E],C=b.getDiagonal();C>T&&(T=C)}return T},I.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},I.prototype.groupZeroDegreeMembers=function(){var w=this,T={};this.memberGroups={},this.idToDummyNode={};for(var E=[],b=this.graphManager.getAllNodes(),C=0;C<b.length;C++){var _=b[C],M=_.getParent();this.getNodeDegreeWithChildren(_)===0&&(M.id==null||!this.getToBeTiled(M))&&E.push(_)}for(var C=0;C<E.length;C++){var _=E[C],A=_.getParent().id;typeof T[A]>"u"&&(T[A]=[]),T[A]=T[A].concat(_)}Object.keys(T).forEach(function(F){if(T[F].length>1){var N="DummyCompound_"+F;w.memberGroups[N]=T[F];var z=T[F][0].getParent(),Y=new d(w.graphManager);Y.id=N,Y.paddingLeft=z.paddingLeft||0,Y.paddingRight=z.paddingRight||0,Y.paddingBottom=z.paddingBottom||0,Y.paddingTop=z.paddingTop||0,w.idToDummyNode[N]=Y;var U=w.getGraphManager().add(w.newGraph(),Y),ee=z.getChild();ee.add(Y);for(var Q=0;Q<T[F].length;Q++){var j=T[F][Q];ee.remove(j),U.add(j)}}})},I.prototype.clearCompounds=function(){var w={},T={};this.performDFSOnCompounds();for(var E=0;E<this.compoundOrder.length;E++)T[this.compoundOrder[E].id]=this.compoundOrder[E],w[this.compoundOrder[E].id]=[].concat(this.compoundOrder[E].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[E].getChild()),this.compoundOrder[E].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(w,T)},I.prototype.clearZeroDegreeMembers=function(){var w=this,T=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(E){var b=w.idToDummyNode[E];if(T[E]=w.tileNodes(w.memberGroups[E],b.paddingLeft+b.paddingRight),b.rect.width=T[E].width,b.rect.height=T[E].height,b.setCenter(T[E].centerX,T[E].centerY),b.labelMarginLeft=0,b.labelMarginTop=0,h.NODE_DIMENSIONS_INCLUDE_LABELS){var C=b.rect.width,_=b.rect.height;b.labelWidth&&(b.labelPosHorizontal=="left"?(b.rect.x-=b.labelWidth,b.setWidth(C+b.labelWidth),b.labelMarginLeft=b.labelWidth):b.labelPosHorizontal=="center"&&b.labelWidth>C?(b.rect.x-=(b.labelWidth-C)/2,b.setWidth(b.labelWidth),b.labelMarginLeft=(b.labelWidth-C)/2):b.labelPosHorizontal=="right"&&b.setWidth(C+b.labelWidth)),b.labelHeight&&(b.labelPosVertical=="top"?(b.rect.y-=b.labelHeight,b.setHeight(_+b.labelHeight),b.labelMarginTop=b.labelHeight):b.labelPosVertical=="center"&&b.labelHeight>_?(b.rect.y-=(b.labelHeight-_)/2,b.setHeight(b.labelHeight),b.labelMarginTop=(b.labelHeight-_)/2):b.labelPosVertical=="bottom"&&b.setHeight(_+b.labelHeight))}})},I.prototype.repopulateCompounds=function(){for(var w=this.compoundOrder.length-1;w>=0;w--){var T=this.compoundOrder[w],E=T.id,b=T.paddingLeft,C=T.paddingTop,_=T.labelMarginLeft,M=T.labelMarginTop;this.adjustLocations(this.tiledMemberPack[E],T.rect.x,T.rect.y,b,C,_,M)}},I.prototype.repopulateZeroDegreeMembers=function(){var w=this,T=this.tiledZeroDegreePack;Object.keys(T).forEach(function(E){var b=w.idToDummyNode[E],C=b.paddingLeft,_=b.paddingTop,M=b.labelMarginLeft,A=b.labelMarginTop;w.adjustLocations(T[E],b.rect.x,b.rect.y,C,_,M,A)})},I.prototype.getToBeTiled=function(w){var T=w.id;if(this.toBeTiled[T]!=null)return this.toBeTiled[T];var E=w.getChild();if(E==null)return this.toBeTiled[T]=!1,!1;for(var b=E.getNodes(),C=0;C<b.length;C++){var _=b[C];if(this.getNodeDegree(_)>0)return this.toBeTiled[T]=!1,!1;if(_.getChild()==null){this.toBeTiled[_.id]=!1;continue}if(!this.getToBeTiled(_))return this.toBeTiled[T]=!1,!1}return this.toBeTiled[T]=!0,!0},I.prototype.getNodeDegree=function(w){for(var T=w.id,E=w.getEdges(),b=0,C=0;C<E.length;C++){var _=E[C];_.getSource().id!==_.getTarget().id&&(b=b+1)}return b},I.prototype.getNodeDegreeWithChildren=function(w){var T=this.getNodeDegree(w);if(w.getChild()==null)return T;for(var E=w.getChild().getNodes(),b=0;b<E.length;b++){var C=E[b];T+=this.getNodeDegreeWithChildren(C)}return T},I.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},I.prototype.fillCompexOrderByDFS=function(w){for(var T=0;T<w.length;T++){var E=w[T];E.getChild()!=null&&this.fillCompexOrderByDFS(E.getChild().getNodes()),this.getToBeTiled(E)&&this.compoundOrder.push(E)}},I.prototype.adjustLocations=function(w,T,E,b,C,_,M){T+=b+_,E+=C+M;for(var A=T,F=0;F<w.rows.length;F++){var N=w.rows[F];T=A;for(var z=0,Y=0;Y<N.length;Y++){var U=N[Y];U.rect.x=T,U.rect.y=E,T+=U.rect.width+w.horizontalPadding,U.rect.height>z&&(z=U.rect.height)}E+=z+w.verticalPadding}},I.prototype.tileCompoundMembers=function(w,T){var E=this;this.tiledMemberPack=[],Object.keys(w).forEach(function(b){var C=T[b];if(E.tiledMemberPack[b]=E.tileNodes(w[b],C.paddingLeft+C.paddingRight),C.rect.width=E.tiledMemberPack[b].width,C.rect.height=E.tiledMemberPack[b].height,C.setCenter(E.tiledMemberPack[b].centerX,E.tiledMemberPack[b].centerY),C.labelMarginLeft=0,C.labelMarginTop=0,h.NODE_DIMENSIONS_INCLUDE_LABELS){var _=C.rect.width,M=C.rect.height;C.labelWidth&&(C.labelPosHorizontal=="left"?(C.rect.x-=C.labelWidth,C.setWidth(_+C.labelWidth),C.labelMarginLeft=C.labelWidth):C.labelPosHorizontal=="center"&&C.labelWidth>_?(C.rect.x-=(C.labelWidth-_)/2,C.setWidth(C.labelWidth),C.labelMarginLeft=(C.labelWidth-_)/2):C.labelPosHorizontal=="right"&&C.setWidth(_+C.labelWidth)),C.labelHeight&&(C.labelPosVertical=="top"?(C.rect.y-=C.labelHeight,C.setHeight(M+C.labelHeight),C.labelMarginTop=C.labelHeight):C.labelPosVertical=="center"&&C.labelHeight>M?(C.rect.y-=(C.labelHeight-M)/2,C.setHeight(C.labelHeight),C.labelMarginTop=(C.labelHeight-M)/2):C.labelPosVertical=="bottom"&&C.setHeight(M+C.labelHeight))}})},I.prototype.tileNodes=function(w,T){var E=this.tileNodesByFavoringDim(w,T,!0),b=this.tileNodesByFavoringDim(w,T,!1),C=this.getOrgRatio(E),_=this.getOrgRatio(b),M;return _<C?M=b:M=E,M},I.prototype.getOrgRatio=function(w){var T=w.width,E=w.height,b=T/E;return b<1&&(b=1/b),b},I.prototype.calcIdealRowWidth=function(w,T){var E=h.TILING_PADDING_VERTICAL,b=h.TILING_PADDING_HORIZONTAL,C=w.length,_=0,M=0,A=0;w.forEach(function(Q){_+=Q.getWidth(),M+=Q.getHeight(),Q.getWidth()>A&&(A=Q.getWidth())});var F=_/C,N=M/C,z=Math.pow(E-b,2)+4*(F+b)*(N+E)*C,Y=(b-E+Math.sqrt(z))/(2*(F+b)),U;T?(U=Math.ceil(Y),U==Y&&U++):U=Math.floor(Y);var ee=U*(F+b)-b;return A>ee&&(ee=A),ee+=b*2,ee},I.prototype.tileNodesByFavoringDim=function(w,T,E){var b=h.TILING_PADDING_VERTICAL,C=h.TILING_PADDING_HORIZONTAL,_=h.TILING_COMPARE_BY,M={rows:[],rowWidth:[],rowHeight:[],width:0,height:T,verticalPadding:b,horizontalPadding:C,centerX:0,centerY:0};_&&(M.idealRowWidth=this.calcIdealRowWidth(w,E));var A=function(j){return j.rect.width*j.rect.height},F=function(j,K){return A(K)-A(j)};w.sort(function(Q,j){var K=F;return M.idealRowWidth?(K=_,K(Q.id,j.id)):K(Q,j)});for(var N=0,z=0,Y=0;Y<w.length;Y++){var U=w[Y];N+=U.getCenterX(),z+=U.getCenterY()}M.centerX=N/w.length,M.centerY=z/w.length;for(var Y=0;Y<w.length;Y++){var U=w[Y];if(M.rows.length==0)this.insertNodeToRow(M,U,0,T);else if(this.canAddHorizontal(M,U.rect.width,U.rect.height)){var ee=M.rows.length-1;M.idealRowWidth||(ee=this.getShortestRowIndex(M)),this.insertNodeToRow(M,U,ee,T)}else this.insertNodeToRow(M,U,M.rows.length,T);this.shiftToLastRow(M)}return M},I.prototype.insertNodeToRow=function(w,T,E,b){var C=b;if(E==w.rows.length){var _=[];w.rows.push(_),w.rowWidth.push(C),w.rowHeight.push(0)}var M=w.rowWidth[E]+T.rect.width;w.rows[E].length>0&&(M+=w.horizontalPadding),w.rowWidth[E]=M,w.width<M&&(w.width=M);var A=T.rect.height;E>0&&(A+=w.verticalPadding);var F=0;A>w.rowHeight[E]&&(F=w.rowHeight[E],w.rowHeight[E]=A,F=w.rowHeight[E]-F),w.height+=F,w.rows[E].push(T)},I.prototype.getShortestRowIndex=function(w){for(var T=-1,E=Number.MAX_VALUE,b=0;b<w.rows.length;b++)w.rowWidth[b]<E&&(T=b,E=w.rowWidth[b]);return T},I.prototype.getLongestRowIndex=function(w){for(var T=-1,E=Number.MIN_VALUE,b=0;b<w.rows.length;b++)w.rowWidth[b]>E&&(T=b,E=w.rowWidth[b]);return T},I.prototype.canAddHorizontal=function(w,T,E){if(w.idealRowWidth){var b=w.rows.length-1,C=w.rowWidth[b];return C+T+w.horizontalPadding<=w.idealRowWidth}var _=this.getShortestRowIndex(w);if(_<0)return!0;var M=w.rowWidth[_];if(M+w.horizontalPadding+T<=w.width)return!0;var A=0;w.rowHeight[_]<E&&_>0&&(A=E+w.verticalPadding-w.rowHeight[_]);var F;w.width-M>=T+w.horizontalPadding?F=(w.height+A)/(M+T+w.horizontalPadding):F=(w.height+A)/w.width,A=E+w.verticalPadding;var N;return w.width<T?N=(w.height+A)/T:N=(w.height+A)/w.width,N<1&&(N=1/N),F<1&&(F=1/F),F<N},I.prototype.shiftToLastRow=function(w){var T=this.getLongestRowIndex(w),E=w.rowWidth.length-1,b=w.rows[T],C=b[b.length-1],_=C.width+w.horizontalPadding;if(w.width-w.rowWidth[E]>_&&T!=E){b.splice(-1,1),w.rows[E].push(C),w.rowWidth[T]=w.rowWidth[T]-_,w.rowWidth[E]=w.rowWidth[E]+_,w.width=w.rowWidth[instance.getLongestRowIndex(w)];for(var M=Number.MIN_VALUE,A=0;A<b.length;A++)b[A].height>M&&(M=b[A].height);T>0&&(M+=w.verticalPadding);var F=w.rowHeight[T]+w.rowHeight[E];w.rowHeight[T]=M,w.rowHeight[E]<C.height+w.verticalPadding&&(w.rowHeight[E]=C.height+w.verticalPadding);var N=w.rowHeight[T]+w.rowHeight[E];w.height+=N-F,this.shiftToLastRow(w)}},I.prototype.tilingPreLayout=function(){h.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},I.prototype.tilingPostLayout=function(){h.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},I.prototype.reduceTrees=function(){for(var w=[],T=!0,E;T;){var b=this.graphManager.getAllNodes(),C=[];T=!1;for(var _=0;_<b.length;_++)if(E=b[_],E.getEdges().length==1&&!E.getEdges()[0].isInterGraph&&E.getChild()==null){if(h.PURE_INCREMENTAL){var M=E.getEdges()[0].getOtherEnd(E),A=new x(E.getCenterX()-M.getCenterX(),E.getCenterY()-M.getCenterY());C.push([E,E.getEdges()[0],E.getOwner(),A])}else C.push([E,E.getEdges()[0],E.getOwner()]);T=!0}if(T==!0){for(var F=[],N=0;N<C.length;N++)C[N][0].getEdges().length==1&&(F.push(C[N]),C[N][0].getOwner().remove(C[N][0]));w.push(F),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=w},I.prototype.growTree=function(w){for(var T=w.length,E=w[T-1],b,C=0;C<E.length;C++)b=E[C],this.findPlaceforPrunedNode(b),b[2].add(b[0]),b[2].add(b[1],b[1].source,b[1].target);w.splice(w.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},I.prototype.findPlaceforPrunedNode=function(w){var T,E,b=w[0];if(b==w[1].source?E=w[1].target:E=w[1].source,h.PURE_INCREMENTAL)b.setCenter(E.getCenterX()+w[3].getWidth(),E.getCenterY()+w[3].getHeight());else{var C=E.startX,_=E.finishX,M=E.startY,A=E.finishY,F=0,N=0,z=0,Y=0,U=[F,z,N,Y];if(M>0)for(var ee=C;ee<=_;ee++)U[0]+=this.grid[ee][M-1].length+this.grid[ee][M].length-1;if(_<this.grid.length-1)for(var ee=M;ee<=A;ee++)U[1]+=this.grid[_+1][ee].length+this.grid[_][ee].length-1;if(A<this.grid[0].length-1)for(var ee=C;ee<=_;ee++)U[2]+=this.grid[ee][A+1].length+this.grid[ee][A].length-1;if(C>0)for(var ee=M;ee<=A;ee++)U[3]+=this.grid[C-1][ee].length+this.grid[C][ee].length-1;for(var Q=D.MAX_VALUE,j,K,H=0;H<U.length;H++)U[H]<Q?(Q=U[H],j=1,K=H):U[H]==Q&&j++;if(j==3&&Q==0)U[0]==0&&U[1]==0&&U[2]==0?T=1:U[0]==0&&U[1]==0&&U[3]==0?T=0:U[0]==0&&U[2]==0&&U[3]==0?T=3:U[1]==0&&U[2]==0&&U[3]==0&&(T=2);else if(j==2&&Q==0){var k=Math.floor(Math.random()*2);U[0]==0&&U[1]==0?k==0?T=0:T=1:U[0]==0&&U[2]==0?k==0?T=0:T=2:U[0]==0&&U[3]==0?k==0?T=0:T=3:U[1]==0&&U[2]==0?k==0?T=1:T=2:U[1]==0&&U[3]==0?k==0?T=1:T=3:k==0?T=2:T=3}else if(j==4&&Q==0){var k=Math.floor(Math.random()*4);T=k}else T=K;T==0?b.setCenter(E.getCenterX(),E.getCenterY()-E.getHeight()/2-p.DEFAULT_EDGE_LENGTH-b.getHeight()/2):T==1?b.setCenter(E.getCenterX()+E.getWidth()/2+p.DEFAULT_EDGE_LENGTH+b.getWidth()/2,E.getCenterY()):T==2?b.setCenter(E.getCenterX(),E.getCenterY()+E.getHeight()/2+p.DEFAULT_EDGE_LENGTH+b.getHeight()/2):b.setCenter(E.getCenterX()-E.getWidth()/2-p.DEFAULT_EDGE_LENGTH-b.getWidth()/2,E.getCenterY())}},a.exports=I},991:(a,o,s)=>{var u=s(551).FDLayoutNode,l=s(551).IMath;function c(f,h,v,p){u.call(this,f,h,v,p)}c.prototype=Object.create(u.prototype);for(var d in u)c[d]=u[d];c.prototype.calculateDisplacement=function(){var f=this.graphManager.getLayout();this.getChild()!=null&&this.fixedNodeWeight?(this.displacementX+=f.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.fixedNodeWeight,this.displacementY+=f.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.fixedNodeWeight):(this.displacementX+=f.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY+=f.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren),Math.abs(this.displacementX)>f.coolingFactor*f.maxNodeDisplacement&&(this.displacementX=f.coolingFactor*f.maxNodeDisplacement*l.sign(this.displacementX)),Math.abs(this.displacementY)>f.coolingFactor*f.maxNodeDisplacement&&(this.displacementY=f.coolingFactor*f.maxNodeDisplacement*l.sign(this.displacementY)),this.child&&this.child.getNodes().length>0&&this.propogateDisplacementToChildren(this.displacementX,this.displacementY)},c.prototype.propogateDisplacementToChildren=function(f,h){for(var v=this.getChild().getNodes(),p,m=0;m<v.length;m++)p=v[m],p.getChild()==null?(p.displacementX+=f,p.displacementY+=h):p.propogateDisplacementToChildren(f,h)},c.prototype.move=function(){var f=this.graphManager.getLayout();(this.child==null||this.child.getNodes().length==0)&&(this.moveBy(this.displacementX,this.displacementY),f.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},c.prototype.setPred1=function(f){this.pred1=f},c.prototype.getPred1=function(){return pred1},c.prototype.getPred2=function(){return pred2},c.prototype.setNext=function(f){this.next=f},c.prototype.getNext=function(){return next},c.prototype.setProcessed=function(f){this.processed=f},c.prototype.isProcessed=function(){return processed},a.exports=c},902:(a,o,s)=>{function u(v){if(Array.isArray(v)){for(var p=0,m=Array(v.length);p<v.length;p++)m[p]=v[p];return m}else return Array.from(v)}var l=s(806),c=s(551).LinkedList,d=s(551).Matrix,f=s(551).SVD;function h(){}h.handleConstraints=function(v){var p={};p.fixedNodeConstraint=v.constraints.fixedNodeConstraint,p.alignmentConstraint=v.constraints.alignmentConstraint,p.relativePlacementConstraint=v.constraints.relativePlacementConstraint;for(var m=new Map,g=new Map,y=[],x=[],S=v.getAllNodes(),D=0,P=0;P<S.length;P++){var R=S[P];R.getChild()==null&&(g.set(R.id,D++),y.push(R.getCenterX()),x.push(R.getCenterY()),m.set(R.id,R))}p.relativePlacementConstraint&&p.relativePlacementConstraint.forEach(function(W){!W.gap&&W.gap!=0&&(W.left?W.gap=l.DEFAULT_EDGE_LENGTH+m.get(W.left).getWidth()/2+m.get(W.right).getWidth()/2:W.gap=l.DEFAULT_EDGE_LENGTH+m.get(W.top).getHeight()/2+m.get(W.bottom).getHeight()/2)});var L=function(Z,ie){return{x:Z.x-ie.x,y:Z.y-ie.y}},O=function(Z){var ie=0,ne=0;return Z.forEach(function(oe){ie+=y[g.get(oe)],ne+=x[g.get(oe)]}),{x:ie/Z.size,y:ne/Z.size}},I=function(Z,ie,ne,oe,ve){function Re(ze,Ie){var He=new Set(ze),ke=!0,Ge=!1,rt=void 0;try{for(var nt=Ie[Symbol.iterator](),mt;!(ke=(mt=nt.next()).done);ke=!0){var et=mt.value;He.add(et)}}catch(Ze){Ge=!0,rt=Ze}finally{try{!ke&&nt.return&&nt.return()}finally{if(Ge)throw rt}}return He}var we=new Map;Z.forEach(function(ze,Ie){we.set(Ie,0)}),Z.forEach(function(ze,Ie){ze.forEach(function(He){we.set(He.id,we.get(He.id)+1)})});var pe=new Map,Se=new Map,Me=new c;we.forEach(function(ze,Ie){ze==0?(Me.push(Ie),ne||(ie=="horizontal"?pe.set(Ie,g.has(Ie)?y[g.get(Ie)]:oe.get(Ie)):pe.set(Ie,g.has(Ie)?x[g.get(Ie)]:oe.get(Ie)))):pe.set(Ie,Number.NEGATIVE_INFINITY),ne&&Se.set(Ie,new Set([Ie]))}),ne&&ve.forEach(function(ze){var Ie=[];if(ze.forEach(function(Ge){ne.has(Ge)&&Ie.push(Ge)}),Ie.length>0){var He=0;Ie.forEach(function(Ge){ie=="horizontal"?(pe.set(Ge,g.has(Ge)?y[g.get(Ge)]:oe.get(Ge)),He+=pe.get(Ge)):(pe.set(Ge,g.has(Ge)?x[g.get(Ge)]:oe.get(Ge)),He+=pe.get(Ge))}),He=He/Ie.length,ze.forEach(function(Ge){ne.has(Ge)||pe.set(Ge,He)})}else{var ke=0;ze.forEach(function(Ge){ie=="horizontal"?ke+=g.has(Ge)?y[g.get(Ge)]:oe.get(Ge):ke+=g.has(Ge)?x[g.get(Ge)]:oe.get(Ge)}),ke=ke/ze.length,ze.forEach(function(Ge){pe.set(Ge,ke)})}});for(var Oe=function(){var Ie=Me.shift(),He=Z.get(Ie);He.forEach(function(ke){if(pe.get(ke.id)<pe.get(Ie)+ke.gap)if(ne&&ne.has(ke.id)){var Ge=void 0;if(ie=="horizontal"?Ge=g.has(ke.id)?y[g.get(ke.id)]:oe.get(ke.id):Ge=g.has(ke.id)?x[g.get(ke.id)]:oe.get(ke.id),pe.set(ke.id,Ge),Ge<pe.get(Ie)+ke.gap){var rt=pe.get(Ie)+ke.gap-Ge;Se.get(Ie).forEach(function(nt){pe.set(nt,pe.get(nt)-rt)})}}else pe.set(ke.id,pe.get(Ie)+ke.gap);we.set(ke.id,we.get(ke.id)-1),we.get(ke.id)==0&&Me.push(ke.id),ne&&Se.set(ke.id,Re(Se.get(Ie),Se.get(ke.id)))})};Me.length!=0;)Oe();if(ne){var Ve=new Set;Z.forEach(function(ze,Ie){ze.length==0&&Ve.add(Ie)});var Ke=[];Se.forEach(function(ze,Ie){if(Ve.has(Ie)){var He=!1,ke=!0,Ge=!1,rt=void 0;try{for(var nt=ze[Symbol.iterator](),mt;!(ke=(mt=nt.next()).done);ke=!0){var et=mt.value;ne.has(et)&&(He=!0)}}catch(Je){Ge=!0,rt=Je}finally{try{!ke&&nt.return&&nt.return()}finally{if(Ge)throw rt}}if(!He){var Ze=!1,At=void 0;Ke.forEach(function(Je,at){Je.has([].concat(u(ze))[0])&&(Ze=!0,At=at)}),Ze?ze.forEach(function(Je){Ke[At].add(Je)}):Ke.push(new Set(ze))}}}),Ke.forEach(function(ze,Ie){var He=Number.POSITIVE_INFINITY,ke=Number.POSITIVE_INFINITY,Ge=Number.NEGATIVE_INFINITY,rt=Number.NEGATIVE_INFINITY,nt=!0,mt=!1,et=void 0;try{for(var Ze=ze[Symbol.iterator](),At;!(nt=(At=Ze.next()).done);nt=!0){var Je=At.value,at=void 0;ie=="horizontal"?at=g.has(Je)?y[g.get(Je)]:oe.get(Je):at=g.has(Je)?x[g.get(Je)]:oe.get(Je);var vt=pe.get(Je);at<He&&(He=at),at>Ge&&(Ge=at),vt<ke&&(ke=vt),vt>rt&&(rt=vt)}}catch(wn){mt=!0,et=wn}finally{try{!nt&&Ze.return&&Ze.return()}finally{if(mt)throw et}}var mn=(He+Ge)/2-(ke+rt)/2,Gt=!0,sn=!1,yn=void 0;try{for(var ln=ze[Symbol.iterator](),mi;!(Gt=(mi=ln.next()).done);Gt=!0){var Cn=mi.value;pe.set(Cn,pe.get(Cn)+mn)}}catch(wn){sn=!0,yn=wn}finally{try{!Gt&&ln.return&&ln.return()}finally{if(sn)throw yn}}})}return pe},B=function(Z){var ie=0,ne=0,oe=0,ve=0;if(Z.forEach(function(Se){Se.left?y[g.get(Se.left)]-y[g.get(Se.right)]>=0?ie++:ne++:x[g.get(Se.top)]-x[g.get(Se.bottom)]>=0?oe++:ve++}),ie>ne&&oe>ve)for(var Re=0;Re<g.size;Re++)y[Re]=-1*y[Re],x[Re]=-1*x[Re];else if(ie>ne)for(var we=0;we<g.size;we++)y[we]=-1*y[we];else if(oe>ve)for(var pe=0;pe<g.size;pe++)x[pe]=-1*x[pe]},w=function(Z){var ie=[],ne=new c,oe=new Set,ve=0;return Z.forEach(function(Re,we){if(!oe.has(we)){ie[ve]=[];var pe=we;for(ne.push(pe),oe.add(pe),ie[ve].push(pe);ne.length!=0;){pe=ne.shift();var Se=Z.get(pe);Se.forEach(function(Me){oe.has(Me.id)||(ne.push(Me.id),oe.add(Me.id),ie[ve].push(Me.id))})}ve++}}),ie},T=function(Z){var ie=new Map;return Z.forEach(function(ne,oe){ie.set(oe,[])}),Z.forEach(function(ne,oe){ne.forEach(function(ve){ie.get(oe).push(ve),ie.get(ve.id).push({id:oe,gap:ve.gap,direction:ve.direction})})}),ie},E=function(Z){var ie=new Map;return Z.forEach(function(ne,oe){ie.set(oe,[])}),Z.forEach(function(ne,oe){ne.forEach(function(ve){ie.get(ve.id).push({id:oe,gap:ve.gap,direction:ve.direction})})}),ie},b=[],C=[],_=!1,M=!1,A=new Set,F=new Map,N=new Map,z=[];if(p.fixedNodeConstraint&&p.fixedNodeConstraint.forEach(function(W){A.add(W.nodeId)}),p.relativePlacementConstraint&&(p.relativePlacementConstraint.forEach(function(W){W.left?(F.has(W.left)?F.get(W.left).push({id:W.right,gap:W.gap,direction:"horizontal"}):F.set(W.left,[{id:W.right,gap:W.gap,direction:"horizontal"}]),F.has(W.right)||F.set(W.right,[])):(F.has(W.top)?F.get(W.top).push({id:W.bottom,gap:W.gap,direction:"vertical"}):F.set(W.top,[{id:W.bottom,gap:W.gap,direction:"vertical"}]),F.has(W.bottom)||F.set(W.bottom,[]))}),N=T(F),z=w(N)),l.TRANSFORM_ON_CONSTRAINT_HANDLING){if(p.fixedNodeConstraint&&p.fixedNodeConstraint.length>1)p.fixedNodeConstraint.forEach(function(W,Z){b[Z]=[W.position.x,W.position.y],C[Z]=[y[g.get(W.nodeId)],x[g.get(W.nodeId)]]}),_=!0;else if(p.alignmentConstraint)(function(){var W=0;if(p.alignmentConstraint.vertical){for(var Z=p.alignmentConstraint.vertical,ie=function(pe){var Se=new Set;Z[pe].forEach(function(Ve){Se.add(Ve)});var Me=new Set([].concat(u(Se)).filter(function(Ve){return A.has(Ve)})),Oe=void 0;Me.size>0?Oe=y[g.get(Me.values().next().value)]:Oe=O(Se).x,Z[pe].forEach(function(Ve){b[W]=[Oe,x[g.get(Ve)]],C[W]=[y[g.get(Ve)],x[g.get(Ve)]],W++})},ne=0;ne<Z.length;ne++)ie(ne);_=!0}if(p.alignmentConstraint.horizontal){for(var oe=p.alignmentConstraint.horizontal,ve=function(pe){var Se=new Set;oe[pe].forEach(function(Ve){Se.add(Ve)});var Me=new Set([].concat(u(Se)).filter(function(Ve){return A.has(Ve)})),Oe=void 0;Me.size>0?Oe=y[g.get(Me.values().next().value)]:Oe=O(Se).y,oe[pe].forEach(function(Ve){b[W]=[y[g.get(Ve)],Oe],C[W]=[y[g.get(Ve)],x[g.get(Ve)]],W++})},Re=0;Re<oe.length;Re++)ve(Re);_=!0}p.relativePlacementConstraint&&(M=!0)})();else if(p.relativePlacementConstraint){for(var Y=0,U=0,ee=0;ee<z.length;ee++)z[ee].length>Y&&(Y=z[ee].length,U=ee);if(Y<N.size/2)B(p.relativePlacementConstraint),_=!1,M=!1;else{var Q=new Map,j=new Map,K=[];z[U].forEach(function(W){F.get(W).forEach(function(Z){Z.direction=="horizontal"?(Q.has(W)?Q.get(W).push(Z):Q.set(W,[Z]),Q.has(Z.id)||Q.set(Z.id,[]),K.push({left:W,right:Z.id})):(j.has(W)?j.get(W).push(Z):j.set(W,[Z]),j.has(Z.id)||j.set(Z.id,[]),K.push({top:W,bottom:Z.id}))})}),B(K),M=!1;var H=I(Q,"horizontal"),k=I(j,"vertical");z[U].forEach(function(W,Z){C[Z]=[y[g.get(W)],x[g.get(W)]],b[Z]=[],H.has(W)?b[Z][0]=H.get(W):b[Z][0]=y[g.get(W)],k.has(W)?b[Z][1]=k.get(W):b[Z][1]=x[g.get(W)]}),_=!0}}if(_){for(var G=void 0,$=d.transpose(b),te=d.transpose(C),q=0;q<$.length;q++)$[q]=d.multGamma($[q]),te[q]=d.multGamma(te[q]);var ge=d.multMat($,d.transpose(te)),Te=f.svd(ge);G=d.multMat(Te.V,d.transpose(Te.U));for(var he=0;he<g.size;he++){var ue=[y[he],x[he]],de=[G[0][0],G[1][0]],me=[G[0][1],G[1][1]];y[he]=d.dotProduct(ue,de),x[he]=d.dotProduct(ue,me)}M&&B(p.relativePlacementConstraint)}}if(l.ENFORCE_CONSTRAINTS){if(p.fixedNodeConstraint&&p.fixedNodeConstraint.length>0){var _e={x:0,y:0};p.fixedNodeConstraint.forEach(function(W,Z){var ie={x:y[g.get(W.nodeId)],y:x[g.get(W.nodeId)]},ne=W.position,oe=L(ne,ie);_e.x+=oe.x,_e.y+=oe.y}),_e.x/=p.fixedNodeConstraint.length,_e.y/=p.fixedNodeConstraint.length,y.forEach(function(W,Z){y[Z]+=_e.x}),x.forEach(function(W,Z){x[Z]+=_e.y}),p.fixedNodeConstraint.forEach(function(W){y[g.get(W.nodeId)]=W.position.x,x[g.get(W.nodeId)]=W.position.y})}if(p.alignmentConstraint){if(p.alignmentConstraint.vertical)for(var xe=p.alignmentConstraint.vertical,Ce=function(Z){var ie=new Set;xe[Z].forEach(function(ve){ie.add(ve)});var ne=new Set([].concat(u(ie)).filter(function(ve){return A.has(ve)})),oe=void 0;ne.size>0?oe=y[g.get(ne.values().next().value)]:oe=O(ie).x,ie.forEach(function(ve){A.has(ve)||(y[g.get(ve)]=oe)})},Ee=0;Ee<xe.length;Ee++)Ce(Ee);if(p.alignmentConstraint.horizontal)for(var be=p.alignmentConstraint.horizontal,fe=function(Z){var ie=new Set;be[Z].forEach(function(ve){ie.add(ve)});var ne=new Set([].concat(u(ie)).filter(function(ve){return A.has(ve)})),oe=void 0;ne.size>0?oe=x[g.get(ne.values().next().value)]:oe=O(ie).y,ie.forEach(function(ve){A.has(ve)||(x[g.get(ve)]=oe)})},V=0;V<be.length;V++)fe(V)}p.relativePlacementConstraint&&function(){var W=new Map,Z=new Map,ie=new Map,ne=new Map,oe=new Map,ve=new Map,Re=new Set,we=new Set;if(A.forEach(function(Rt){Re.add(Rt),we.add(Rt)}),p.alignmentConstraint){if(p.alignmentConstraint.vertical)for(var pe=p.alignmentConstraint.vertical,Se=function(Xe){ie.set("dummy"+Xe,[]),pe[Xe].forEach(function(Qe){W.set(Qe,"dummy"+Xe),ie.get("dummy"+Xe).push(Qe),A.has(Qe)&&Re.add("dummy"+Xe)}),oe.set("dummy"+Xe,y[g.get(pe[Xe][0])])},Me=0;Me<pe.length;Me++)Se(Me);if(p.alignmentConstraint.horizontal)for(var Oe=p.alignmentConstraint.horizontal,Ve=function(Xe){ne.set("dummy"+Xe,[]),Oe[Xe].forEach(function(Qe){Z.set(Qe,"dummy"+Xe),ne.get("dummy"+Xe).push(Qe),A.has(Qe)&&we.add("dummy"+Xe)}),ve.set("dummy"+Xe,x[g.get(Oe[Xe][0])])},Ke=0;Ke<Oe.length;Ke++)Ve(Ke)}var ze=new Map,Ie=new Map,He=function(Xe){F.get(Xe).forEach(function(Qe){var Wr=void 0,Dr=void 0;Qe.direction=="horizontal"?(Wr=W.get(Xe)?W.get(Xe):Xe,W.get(Qe.id)?Dr={id:W.get(Qe.id),gap:Qe.gap,direction:Qe.direction}:Dr=Qe,ze.has(Wr)?ze.get(Wr).push(Dr):ze.set(Wr,[Dr]),ze.has(Dr.id)||ze.set(Dr.id,[])):(Wr=Z.get(Xe)?Z.get(Xe):Xe,Z.get(Qe.id)?Dr={id:Z.get(Qe.id),gap:Qe.gap,direction:Qe.direction}:Dr=Qe,Ie.has(Wr)?Ie.get(Wr).push(Dr):Ie.set(Wr,[Dr]),Ie.has(Dr.id)||Ie.set(Dr.id,[]))})},ke=!0,Ge=!1,rt=void 0;try{for(var nt=F.keys()[Symbol.iterator](),mt;!(ke=(mt=nt.next()).done);ke=!0){var et=mt.value;He(et)}}catch(Rt){Ge=!0,rt=Rt}finally{try{!ke&&nt.return&&nt.return()}finally{if(Ge)throw rt}}var Ze=T(ze),At=T(Ie),Je=w(Ze),at=w(At),vt=E(ze),mn=E(Ie),Gt=[],sn=[];Je.forEach(function(Rt,Xe){Gt[Xe]=[],Rt.forEach(function(Qe){vt.get(Qe).length==0&&Gt[Xe].push(Qe)})}),at.forEach(function(Rt,Xe){sn[Xe]=[],Rt.forEach(function(Qe){mn.get(Qe).length==0&&sn[Xe].push(Qe)})});var yn=I(ze,"horizontal",Re,oe,Gt),ln=I(Ie,"vertical",we,ve,sn),mi=function(Xe){ie.get(Xe)?ie.get(Xe).forEach(function(Qe){y[g.get(Qe)]=yn.get(Xe)}):y[g.get(Xe)]=yn.get(Xe)},Cn=!0,wn=!1,ho=void 0;try{for(var ca=yn.keys()[Symbol.iterator](),bn;!(Cn=(bn=ca.next()).done);Cn=!0){var qn=bn.value;mi(qn)}}catch(Rt){wn=!0,ho=Rt}finally{try{!Cn&&ca.return&&ca.return()}finally{if(wn)throw ho}}var yi=function(Xe){ne.get(Xe)?ne.get(Xe).forEach(function(Qe){x[g.get(Qe)]=ln.get(Xe)}):x[g.get(Xe)]=ln.get(Xe)},Ci=!0,da=!1,vo=void 0;try{for(var ur=ln.keys()[Symbol.iterator](),wi;!(Ci=(wi=ur.next()).done);Ci=!0){var qn=wi.value;yi(qn)}}catch(Rt){da=!0,vo=Rt}finally{try{!Ci&&ur.return&&ur.return()}finally{if(da)throw vo}}}()}for(var re=0;re<S.length;re++){var le=S[re];le.getChild()==null&&le.setCenter(y[g.get(le.id)],x[g.get(le.id)])}},a.exports=h},551:a=>{a.exports=r}},t={};function n(a){var o=t[a];if(o!==void 0)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}var i=n(45);return i})()})});var np=fa((fo,fc)=>{"use strict";(function(e,t){typeof fo=="object"&&typeof fc=="object"?fc.exports=t(dc()):typeof define=="function"&&define.amd?define(["cose-base"],t):typeof fo=="object"?fo.cytoscapeFcose=t(dc()):e.cytoscapeFcose=t(e.coseBase)})(fo,function(r){return(()=>{"use strict";var e={658:a=>{a.exports=Object.assign!=null?Object.assign.bind(Object):function(o){for(var s=arguments.length,u=Array(s>1?s-1:0),l=1;l<s;l++)u[l-1]=arguments[l];return u.forEach(function(c){Object.keys(c).forEach(function(d){return o[d]=c[d]})}),o}},548:(a,o,s)=>{var u=function(){function d(f,h){var v=[],p=!0,m=!1,g=void 0;try{for(var y=f[Symbol.iterator](),x;!(p=(x=y.next()).done)&&(v.push(x.value),!(h&&v.length===h));p=!0);}catch(S){m=!0,g=S}finally{try{!p&&y.return&&y.return()}finally{if(m)throw g}}return v}return function(f,h){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return d(f,h);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=s(140).layoutBase.LinkedList,c={};c.getTopMostNodes=function(d){for(var f={},h=0;h<d.length;h++)f[d[h].id()]=!0;var v=d.filter(function(p,m){typeof p=="number"&&(p=m);for(var g=p.parent()[0];g!=null;){if(f[g.id()])return!1;g=g.parent()[0]}return!0});return v},c.connectComponents=function(d,f,h,v){var p=new l,m=new Set,g=[],y=void 0,x=void 0,S=void 0,D=!1,P=1,R=[],L=[],O=function(){var B=d.collection();L.push(B);var w=h[0],T=d.collection();T.merge(w).merge(w.descendants().intersection(f)),g.push(w),T.forEach(function(C){p.push(C),m.add(C),B.merge(C)});for(var E=function(){w=p.shift();var _=d.collection();w.neighborhood().nodes().forEach(function(N){f.intersection(w.edgesWith(N)).length>0&&_.merge(N)});for(var M=0;M<_.length;M++){var A=_[M];if(y=h.intersection(A.union(A.ancestors())),y!=null&&!m.has(y[0])){var F=y.union(y.descendants());F.forEach(function(N){p.push(N),m.add(N),B.merge(N),h.has(N)&&g.push(N)})}}};p.length!=0;)E();if(B.forEach(function(C){f.intersection(C.connectedEdges()).forEach(function(_){B.has(_.source())&&B.has(_.target())&&B.merge(_)})}),g.length==h.length&&(D=!0),!D||D&&P>1){x=g[0],S=x.connectedEdges().length,g.forEach(function(C){C.connectedEdges().length<S&&(S=C.connectedEdges().length,x=C)}),R.push(x.id());var b=d.collection();b.merge(g[0]),g.forEach(function(C){b.merge(C)}),g=[],h=h.difference(b),P++}};do O();while(!D);return v&&R.length>0&&v.set("dummy"+(v.size+1),R),L},c.relocateComponent=function(d,f,h){if(!h.fixedNodeConstraint){var v=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;if(h.quality=="draft"){var y=!0,x=!1,S=void 0;try{for(var D=f.nodeIndexes[Symbol.iterator](),P;!(y=(P=D.next()).done);y=!0){var R=P.value,L=u(R,2),O=L[0],I=L[1],B=h.cy.getElementById(O);if(B){var w=B.boundingBox(),T=f.xCoords[I]-w.w/2,E=f.xCoords[I]+w.w/2,b=f.yCoords[I]-w.h/2,C=f.yCoords[I]+w.h/2;T<v&&(v=T),E>p&&(p=E),b<m&&(m=b),C>g&&(g=C)}}}catch(N){x=!0,S=N}finally{try{!y&&D.return&&D.return()}finally{if(x)throw S}}var _=d.x-(p+v)/2,M=d.y-(g+m)/2;f.xCoords=f.xCoords.map(function(N){return N+_}),f.yCoords=f.yCoords.map(function(N){return N+M})}else{Object.keys(f).forEach(function(N){var z=f[N],Y=z.getRect().x,U=z.getRect().x+z.getRect().width,ee=z.getRect().y,Q=z.getRect().y+z.getRect().height;Y<v&&(v=Y),U>p&&(p=U),ee<m&&(m=ee),Q>g&&(g=Q)});var A=d.x-(p+v)/2,F=d.y-(g+m)/2;Object.keys(f).forEach(function(N){var z=f[N];z.setCenter(z.getCenterX()+A,z.getCenterY()+F)})}}},c.calcBoundingBox=function(d,f,h,v){for(var p=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER,x=void 0,S=void 0,D=void 0,P=void 0,R=d.descendants().not(":parent"),L=R.length,O=0;O<L;O++){var I=R[O];x=f[v.get(I.id())]-I.width()/2,S=f[v.get(I.id())]+I.width()/2,D=h[v.get(I.id())]-I.height()/2,P=h[v.get(I.id())]+I.height()/2,p>x&&(p=x),m<S&&(m=S),g>D&&(g=D),y<P&&(y=P)}var B={};return B.topLeftX=p,B.topLeftY=g,B.width=m-p,B.height=y-g,B},c.calcParentsWithoutChildren=function(d,f){var h=d.collection();return f.nodes(":parent").forEach(function(v){var p=!1;v.children().forEach(function(m){m.css("display")!="none"&&(p=!0)}),p||h.merge(v)}),h},a.exports=c},816:(a,o,s)=>{var u=s(548),l=s(140).CoSELayout,c=s(140).CoSENode,d=s(140).layoutBase.PointD,f=s(140).layoutBase.DimensionD,h=s(140).layoutBase.LayoutConstants,v=s(140).layoutBase.FDLayoutConstants,p=s(140).CoSEConstants,m=function(y,x){var S=y.cy,D=y.eles,P=D.nodes(),R=D.edges(),L=void 0,O=void 0,I=void 0,B={};y.randomize&&(L=x.nodeIndexes,O=x.xCoords,I=x.yCoords);var w=function(N){return typeof N=="function"},T=function(N,z){return w(N)?N(z):N},E=u.calcParentsWithoutChildren(S,D),b=function F(N,z,Y,U){for(var ee=z.length,Q=0;Q<ee;Q++){var j=z[Q],K=null;j.intersection(E).length==0&&(K=j.children());var H=void 0,k=j.layoutDimensions({nodeDimensionsIncludeLabels:U.nodeDimensionsIncludeLabels});if(j.outerWidth()!=null&&j.outerHeight()!=null)if(U.randomize)if(!j.isParent())H=N.add(new c(Y.graphManager,new d(O[L.get(j.id())]-k.w/2,I[L.get(j.id())]-k.h/2),new f(parseFloat(k.w),parseFloat(k.h))));else{var G=u.calcBoundingBox(j,O,I,L);j.intersection(E).length==0?H=N.add(new c(Y.graphManager,new d(G.topLeftX,G.topLeftY),new f(G.width,G.height))):H=N.add(new c(Y.graphManager,new d(G.topLeftX,G.topLeftY),new f(parseFloat(k.w),parseFloat(k.h))))}else H=N.add(new c(Y.graphManager,new d(j.position("x")-k.w/2,j.position("y")-k.h/2),new f(parseFloat(k.w),parseFloat(k.h))));else H=N.add(new c(this.graphManager));if(H.id=j.data("id"),H.nodeRepulsion=T(U.nodeRepulsion,j),H.paddingLeft=parseInt(j.css("padding")),H.paddingTop=parseInt(j.css("padding")),H.paddingRight=parseInt(j.css("padding")),H.paddingBottom=parseInt(j.css("padding")),U.nodeDimensionsIncludeLabels&&(H.labelWidth=j.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w,H.labelHeight=j.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h,H.labelPosVertical=j.css("text-valign"),H.labelPosHorizontal=j.css("text-halign")),B[j.data("id")]=H,isNaN(H.rect.x)&&(H.rect.x=0),isNaN(H.rect.y)&&(H.rect.y=0),K!=null&&K.length>0){var $=void 0;$=Y.getGraphManager().add(Y.newGraph(),H),F($,K,Y,U)}}},C=function(N,z,Y){for(var U=0,ee=0,Q=0;Q<Y.length;Q++){var j=Y[Q],K=B[j.data("source")],H=B[j.data("target")];if(K&&H&&K!==H&&K.getEdgesBetween(H).length==0){var k=z.add(N.newEdge(),K,H);k.id=j.id(),k.idealLength=T(y.idealEdgeLength,j),k.edgeElasticity=T(y.edgeElasticity,j),U+=k.idealLength,ee++}}y.idealEdgeLength!=null&&(ee>0?p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=U/ee:w(y.idealEdgeLength)?p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=50:p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=y.idealEdgeLength,p.MIN_REPULSION_DIST=v.MIN_REPULSION_DIST=v.DEFAULT_EDGE_LENGTH/10,p.DEFAULT_RADIAL_SEPARATION=v.DEFAULT_EDGE_LENGTH)},_=function(N,z){z.fixedNodeConstraint&&(N.constraints.fixedNodeConstraint=z.fixedNodeConstraint),z.alignmentConstraint&&(N.constraints.alignmentConstraint=z.alignmentConstraint),z.relativePlacementConstraint&&(N.constraints.relativePlacementConstraint=z.relativePlacementConstraint)};y.nestingFactor!=null&&(p.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=v.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=y.nestingFactor),y.gravity!=null&&(p.DEFAULT_GRAVITY_STRENGTH=v.DEFAULT_GRAVITY_STRENGTH=y.gravity),y.numIter!=null&&(p.MAX_ITERATIONS=v.MAX_ITERATIONS=y.numIter),y.gravityRange!=null&&(p.DEFAULT_GRAVITY_RANGE_FACTOR=v.DEFAULT_GRAVITY_RANGE_FACTOR=y.gravityRange),y.gravityCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_STRENGTH=v.DEFAULT_COMPOUND_GRAVITY_STRENGTH=y.gravityCompound),y.gravityRangeCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=v.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=y.gravityRangeCompound),y.initialEnergyOnIncremental!=null&&(p.DEFAULT_COOLING_FACTOR_INCREMENTAL=v.DEFAULT_COOLING_FACTOR_INCREMENTAL=y.initialEnergyOnIncremental),y.tilingCompareBy!=null&&(p.TILING_COMPARE_BY=y.tilingCompareBy),y.quality=="proof"?h.QUALITY=2:h.QUALITY=0,p.NODE_DIMENSIONS_INCLUDE_LABELS=v.NODE_DIMENSIONS_INCLUDE_LABELS=h.NODE_DIMENSIONS_INCLUDE_LABELS=y.nodeDimensionsIncludeLabels,p.DEFAULT_INCREMENTAL=v.DEFAULT_INCREMENTAL=h.DEFAULT_INCREMENTAL=!y.randomize,p.ANIMATE=v.ANIMATE=h.ANIMATE=y.animate,p.TILE=y.tile,p.TILING_PADDING_VERTICAL=typeof y.tilingPaddingVertical=="function"?y.tilingPaddingVertical.call():y.tilingPaddingVertical,p.TILING_PADDING_HORIZONTAL=typeof y.tilingPaddingHorizontal=="function"?y.tilingPaddingHorizontal.call():y.tilingPaddingHorizontal,p.DEFAULT_INCREMENTAL=v.DEFAULT_INCREMENTAL=h.DEFAULT_INCREMENTAL=!0,p.PURE_INCREMENTAL=!y.randomize,h.DEFAULT_UNIFORM_LEAF_NODE_SIZES=y.uniformNodeDimensions,y.step=="transformed"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!1),y.step=="enforced"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!1),y.step=="cose"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!0),y.step=="all"&&(y.randomize?p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0:p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!0),y.fixedNodeConstraint||y.alignmentConstraint||y.relativePlacementConstraint?p.TREE_REDUCTION_ON_INCREMENTAL=!1:p.TREE_REDUCTION_ON_INCREMENTAL=!0;var M=new l,A=M.newGraphManager();return b(A.addRoot(),u.getTopMostNodes(P),M,y),C(M,A,R),_(M,y),M.runLayout(),B};a.exports={coseLayout:m}},212:(a,o,s)=>{var u=function(){function y(x,S){for(var D=0;D<S.length;D++){var P=S[D];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(x,P.key,P)}}return function(x,S,D){return S&&y(x.prototype,S),D&&y(x,D),x}}();function l(y,x){if(!(y instanceof x))throw new TypeError("Cannot call a class as a function")}var c=s(658),d=s(548),f=s(657),h=f.spectralLayout,v=s(816),p=v.coseLayout,m=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:void 0,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1e-7,nodeRepulsion:function(x){return 4500},idealEdgeLength:function(x){return 50},edgeElasticity:function(x){return .45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingCompareBy:void 0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:void 0,alignmentConstraint:void 0,relativePlacementConstraint:void 0,ready:function(){},stop:function(){}}),g=function(){function y(x){l(this,y),this.options=c({},m,x)}return u(y,[{key:"run",value:function(){var S=this,D=this.options,P=D.cy,R=D.eles,L=[],O=void 0,I=void 0,B=[],w=void 0,T=[];D.fixedNodeConstraint&&(!Array.isArray(D.fixedNodeConstraint)||D.fixedNodeConstraint.length==0)&&(D.fixedNodeConstraint=void 0),D.alignmentConstraint&&(D.alignmentConstraint.vertical&&(!Array.isArray(D.alignmentConstraint.vertical)||D.alignmentConstraint.vertical.length==0)&&(D.alignmentConstraint.vertical=void 0),D.alignmentConstraint.horizontal&&(!Array.isArray(D.alignmentConstraint.horizontal)||D.alignmentConstraint.horizontal.length==0)&&(D.alignmentConstraint.horizontal=void 0)),D.relativePlacementConstraint&&(!Array.isArray(D.relativePlacementConstraint)||D.relativePlacementConstraint.length==0)&&(D.relativePlacementConstraint=void 0);var E=D.fixedNodeConstraint||D.alignmentConstraint||D.relativePlacementConstraint;E&&(D.tile=!1,D.packComponents=!1);var b=void 0,C=!1;if(P.layoutUtilities&&D.packComponents&&(b=P.layoutUtilities("get"),b||(b=P.layoutUtilities()),C=!0),R.nodes().length>0)if(C){var A=d.getTopMostNodes(D.eles.nodes());if(w=d.connectComponents(P,D.eles,A),w.forEach(function(he){var ue=he.boundingBox();T.push({x:ue.x1+ue.w/2,y:ue.y1+ue.h/2})}),D.randomize&&w.forEach(function(he){D.eles=he,L.push(h(D))}),D.quality=="default"||D.quality=="proof"){var F=P.collection();if(D.tile){var N=new Map,z=[],Y=[],U=0,ee={nodeIndexes:N,xCoords:z,yCoords:Y},Q=[];if(w.forEach(function(he,ue){he.edges().length==0&&(he.nodes().forEach(function(de,me){F.merge(he.nodes()[me]),de.isParent()||(ee.nodeIndexes.set(he.nodes()[me].id(),U++),ee.xCoords.push(he.nodes()[0].position().x),ee.yCoords.push(he.nodes()[0].position().y))}),Q.push(ue))}),F.length>1){var j=F.boundingBox();T.push({x:j.x1+j.w/2,y:j.y1+j.h/2}),w.push(F),L.push(ee);for(var K=Q.length-1;K>=0;K--)w.splice(Q[K],1),L.splice(Q[K],1),T.splice(Q[K],1)}}w.forEach(function(he,ue){D.eles=he,B.push(p(D,L[ue])),d.relocateComponent(T[ue],B[ue],D)})}else w.forEach(function(he,ue){d.relocateComponent(T[ue],L[ue],D)});var H=new Set;if(w.length>1){var k=[],G=R.filter(function(he){return he.css("display")=="none"});w.forEach(function(he,ue){var de=void 0;if(D.quality=="draft"&&(de=L[ue].nodeIndexes),he.nodes().not(G).length>0){var me={};me.edges=[],me.nodes=[];var _e=void 0;he.nodes().not(G).forEach(function(xe){if(D.quality=="draft")if(!xe.isParent())_e=de.get(xe.id()),me.nodes.push({x:L[ue].xCoords[_e]-xe.boundingbox().w/2,y:L[ue].yCoords[_e]-xe.boundingbox().h/2,width:xe.boundingbox().w,height:xe.boundingbox().h});else{var Ce=d.calcBoundingBox(xe,L[ue].xCoords,L[ue].yCoords,de);me.nodes.push({x:Ce.topLeftX,y:Ce.topLeftY,width:Ce.width,height:Ce.height})}else B[ue][xe.id()]&&me.nodes.push({x:B[ue][xe.id()].getLeft(),y:B[ue][xe.id()].getTop(),width:B[ue][xe.id()].getWidth(),height:B[ue][xe.id()].getHeight()})}),he.edges().forEach(function(xe){var Ce=xe.source(),Ee=xe.target();if(Ce.css("display")!="none"&&Ee.css("display")!="none")if(D.quality=="draft"){var be=de.get(Ce.id()),fe=de.get(Ee.id()),V=[],re=[];if(Ce.isParent()){var le=d.calcBoundingBox(Ce,L[ue].xCoords,L[ue].yCoords,de);V.push(le.topLeftX+le.width/2),V.push(le.topLeftY+le.height/2)}else V.push(L[ue].xCoords[be]),V.push(L[ue].yCoords[be]);if(Ee.isParent()){var W=d.calcBoundingBox(Ee,L[ue].xCoords,L[ue].yCoords,de);re.push(W.topLeftX+W.width/2),re.push(W.topLeftY+W.height/2)}else re.push(L[ue].xCoords[fe]),re.push(L[ue].yCoords[fe]);me.edges.push({startX:V[0],startY:V[1],endX:re[0],endY:re[1]})}else B[ue][Ce.id()]&&B[ue][Ee.id()]&&me.edges.push({startX:B[ue][Ce.id()].getCenterX(),startY:B[ue][Ce.id()].getCenterY(),endX:B[ue][Ee.id()].getCenterX(),endY:B[ue][Ee.id()].getCenterY()})}),me.nodes.length>0&&(k.push(me),H.add(ue))}});var $=b.packComponents(k,D.randomize).shifts;if(D.quality=="draft")L.forEach(function(he,ue){var de=he.xCoords.map(function(_e){return _e+$[ue].dx}),me=he.yCoords.map(function(_e){return _e+$[ue].dy});he.xCoords=de,he.yCoords=me});else{var te=0;H.forEach(function(he){Object.keys(B[he]).forEach(function(ue){var de=B[he][ue];de.setCenter(de.getCenterX()+$[te].dx,de.getCenterY()+$[te].dy)}),te++})}}}else{var _=D.eles.boundingBox();if(T.push({x:_.x1+_.w/2,y:_.y1+_.h/2}),D.randomize){var M=h(D);L.push(M)}D.quality=="default"||D.quality=="proof"?(B.push(p(D,L[0])),d.relocateComponent(T[0],B[0],D)):d.relocateComponent(T[0],L[0],D)}var q=function(ue,de){if(D.quality=="default"||D.quality=="proof"){typeof ue=="number"&&(ue=de);var me=void 0,_e=void 0,xe=ue.data("id");return B.forEach(function(Ee){xe in Ee&&(me={x:Ee[xe].getRect().getCenterX(),y:Ee[xe].getRect().getCenterY()},_e=Ee[xe])}),D.nodeDimensionsIncludeLabels&&(_e.labelWidth&&(_e.labelPosHorizontal=="left"?me.x+=_e.labelWidth/2:_e.labelPosHorizontal=="right"&&(me.x-=_e.labelWidth/2)),_e.labelHeight&&(_e.labelPosVertical=="top"?me.y+=_e.labelHeight/2:_e.labelPosVertical=="bottom"&&(me.y-=_e.labelHeight/2))),me==null&&(me={x:ue.position("x"),y:ue.position("y")}),{x:me.x,y:me.y}}else{var Ce=void 0;return L.forEach(function(Ee){var be=Ee.nodeIndexes.get(ue.id());be!=null&&(Ce={x:Ee.xCoords[be],y:Ee.yCoords[be]})}),Ce==null&&(Ce={x:ue.position("x"),y:ue.position("y")}),{x:Ce.x,y:Ce.y}}};if(D.quality=="default"||D.quality=="proof"||D.randomize){var ge=d.calcParentsWithoutChildren(P,R),Te=R.filter(function(he){return he.css("display")=="none"});D.eles=R.not(Te),R.nodes().not(":parent").not(Te).layoutPositions(S,D,q),ge.length>0&&ge.forEach(function(he){he.position(q(he))})}else console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}]),y}();a.exports=g},657:(a,o,s)=>{var u=s(548),l=s(140).layoutBase.Matrix,c=s(140).layoutBase.SVD,d=function(h){var v=h.cy,p=h.eles,m=p.nodes(),g=p.nodes(":parent"),y=new Map,x=new Map,S=new Map,D=[],P=[],R=[],L=[],O=[],I=[],B=[],w=[],T=void 0,E=void 0,b=1e8,C=1e-9,_=h.piTol,M=h.samplingType,A=h.nodeSeparation,F=void 0,N=function(){for(var ie=0,ne=0,oe=!1;ne<F;){ie=Math.floor(Math.random()*E),oe=!1;for(var ve=0;ve<ne;ve++)if(L[ve]==ie){oe=!0;break}if(!oe)L[ne]=ie,ne++;else continue}},z=function(ie,ne,oe){for(var ve=[],Re=0,we=0,pe=0,Se=void 0,Me=[],Oe=0,Ve=1,Ke=0;Ke<E;Ke++)Me[Ke]=b;for(ve[we]=ie,Me[ie]=0;we>=Re;){pe=ve[Re++];for(var ze=D[pe],Ie=0;Ie<ze.length;Ie++)Se=x.get(ze[Ie]),Me[Se]==b&&(Me[Se]=Me[pe]+1,ve[++we]=Se);I[pe][ne]=Me[pe]*A}if(oe){for(var He=0;He<E;He++)I[He][ne]<O[He]&&(O[He]=I[He][ne]);for(var ke=0;ke<E;ke++)O[ke]>Oe&&(Oe=O[ke],Ve=ke)}return Ve},Y=function(ie){var ne=void 0;if(ie){ne=Math.floor(Math.random()*E),T=ne;for(var ve=0;ve<E;ve++)O[ve]=b;for(var Re=0;Re<F;Re++)L[Re]=ne,ne=z(ne,Re,ie)}else{N();for(var oe=0;oe<F;oe++)z(L[oe],oe,ie,!1)}for(var we=0;we<E;we++)for(var pe=0;pe<F;pe++)I[we][pe]*=I[we][pe];for(var Se=0;Se<F;Se++)B[Se]=[];for(var Me=0;Me<F;Me++)for(var Oe=0;Oe<F;Oe++)B[Me][Oe]=I[L[Oe]][Me]},U=function(){for(var ie=c.svd(B),ne=ie.S,oe=ie.U,ve=ie.V,Re=ne[0]*ne[0]*ne[0],we=[],pe=0;pe<F;pe++){we[pe]=[];for(var Se=0;Se<F;Se++)we[pe][Se]=0,pe==Se&&(we[pe][Se]=ne[pe]/(ne[pe]*ne[pe]+Re/(ne[pe]*ne[pe])))}w=l.multMat(l.multMat(ve,we),l.transpose(oe))},ee=function(){for(var ie=void 0,ne=void 0,oe=[],ve=[],Re=[],we=[],pe=0;pe<E;pe++)oe[pe]=Math.random(),ve[pe]=Math.random();oe=l.normalize(oe),ve=l.normalize(ve);for(var Se=0,Me=C,Oe=C,Ve=void 0;;){Se++;for(var Ke=0;Ke<E;Ke++)Re[Ke]=oe[Ke];if(oe=l.multGamma(l.multL(l.multGamma(Re),I,w)),ie=l.dotProduct(Re,oe),oe=l.normalize(oe),Me=l.dotProduct(Re,oe),Ve=Math.abs(Me/Oe),Ve<=1+_&&Ve>=1)break;Oe=Me}for(var ze=0;ze<E;ze++)Re[ze]=oe[ze];for(Se=0,Oe=C;;){Se++;for(var Ie=0;Ie<E;Ie++)we[Ie]=ve[Ie];if(we=l.minusOp(we,l.multCons(Re,l.dotProduct(Re,we))),ve=l.multGamma(l.multL(l.multGamma(we),I,w)),ne=l.dotProduct(we,ve),ve=l.normalize(ve),Me=l.dotProduct(we,ve),Ve=Math.abs(Me/Oe),Ve<=1+_&&Ve>=1)break;Oe=Me}for(var He=0;He<E;He++)we[He]=ve[He];P=l.multCons(Re,Math.sqrt(Math.abs(ie))),R=l.multCons(we,Math.sqrt(Math.abs(ne)))};u.connectComponents(v,p,u.getTopMostNodes(m),y),g.forEach(function(Z){u.connectComponents(v,p,u.getTopMostNodes(Z.descendants().intersection(p)),y)});for(var Q=0,j=0;j<m.length;j++)m[j].isParent()||x.set(m[j].id(),Q++);var K=!0,H=!1,k=void 0;try{for(var G=y.keys()[Symbol.iterator](),$;!(K=($=G.next()).done);K=!0){var te=$.value;x.set(te,Q++)}}catch(Z){H=!0,k=Z}finally{try{!K&&G.return&&G.return()}finally{if(H)throw k}}for(var q=0;q<x.size;q++)D[q]=[];g.forEach(function(Z){for(var ie=Z.children().intersection(p);ie.nodes(":childless").length==0;)ie=ie.nodes()[0].children().intersection(p);var ne=0,oe=ie.nodes(":childless")[0].connectedEdges().length;ie.nodes(":childless").forEach(function(ve,Re){ve.connectedEdges().length<oe&&(oe=ve.connectedEdges().length,ne=Re)}),S.set(Z.id(),ie.nodes(":childless")[ne].id())}),m.forEach(function(Z){var ie=void 0;Z.isParent()?ie=x.get(S.get(Z.id())):ie=x.get(Z.id()),Z.neighborhood().nodes().forEach(function(ne){p.intersection(Z.edgesWith(ne)).length>0&&(ne.isParent()?D[ie].push(S.get(ne.id())):D[ie].push(ne.id()))})});var ge=function(ie){var ne=x.get(ie),oe=void 0;y.get(ie).forEach(function(ve){v.getElementById(ve).isParent()?oe=S.get(ve):oe=ve,D[ne].push(oe),D[x.get(oe)].push(ie)})},Te=!0,he=!1,ue=void 0;try{for(var de=y.keys()[Symbol.iterator](),me;!(Te=(me=de.next()).done);Te=!0){var _e=me.value;ge(_e)}}catch(Z){he=!0,ue=Z}finally{try{!Te&&de.return&&de.return()}finally{if(he)throw ue}}E=x.size;var xe=void 0;if(E>2){F=E<h.sampleSize?E:h.sampleSize;for(var Ce=0;Ce<E;Ce++)I[Ce]=[];for(var Ee=0;Ee<F;Ee++)w[Ee]=[];return h.quality=="draft"||h.step=="all"?(Y(M),U(),ee(),xe={nodeIndexes:x,xCoords:P,yCoords:R}):(x.forEach(function(Z,ie){P.push(v.getElementById(ie).position("x")),R.push(v.getElementById(ie).position("y"))}),xe={nodeIndexes:x,xCoords:P,yCoords:R}),xe}else{var be=x.keys(),fe=v.getElementById(be.next().value),V=fe.position(),re=fe.outerWidth();if(P.push(V.x),R.push(V.y),E==2){var le=v.getElementById(be.next().value),W=le.outerWidth();P.push(V.x+re/2+W/2+h.idealEdgeLength),R.push(V.y)}return xe={nodeIndexes:x,xCoords:P,yCoords:R},xe}};a.exports={spectralLayout:d}},579:(a,o,s)=>{var u=s(212),l=function(d){d&&d("layout","fcose",u)};typeof cytoscape<"u"&&l(cytoscape),a.exports=l},140:a=>{a.exports=r}},t={};function n(a){var o=t[a];if(o!==void 0)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}var i=n(579);return i})()})});var Vl=(r,e)=>e.id;function _p(r,e){if(r&1){let t=We();X(0,"mat-chip-row",15),ye("removed",function(){let i=Ae(t).$implicit,a=ce();return Pe(a.removeTag(i))}),se(1),X(2,"button",16)(3,"mat-icon"),se(4,"cancel"),J()()()}if(r&2){let t=e.$implicit;De("removable",!0),ae(),it(" ",t.name," "),ae(),Mc("aria-label","remove "+t.name)}}function Sp(r,e){if(r&1&&(X(0,"mat-option",13),se(1),J()),r&2){let t=e.$implicit;De("value",t),ae(),it(" ",t.name," ")}}function Mp(r,e){if(r&1&&(X(0,"mat-list-option",13),se(1),J()),r&2){let t=e.$implicit;De("value",t),ae(),it(" ",t.title," ")}}function Dp(r,e){if(r&1){let t=We();X(0,"mat-selection-list",17),pr("ngModelChange",function(i){Ae(t);let a=ce();return vr(a.selectedCollate,i)||(a.selectedCollate=i),Pe(i)}),ye("selectionChange",function(i){Ae(t);let a=ce();return Pe(a.onCollateSelect(i))}),ot(1,Mp,2,2,"mat-list-option",13,Vl),J(),X(3,"mat-paginator",18),ye("page",function(i){Ae(t);let a=ce();return Pe(a.handlePageEvent(i))}),J()}if(r&2){let t=ce();hr("ngModel",t.selectedCollate),De("multiple",!1),ae(),st(t.collates),ae(2),De("length",t.totalCount)("pageSize",t.limit)}}function Ap(r,e){r&1&&(X(0,"p"),se(1,"No collates could be found."),J())}var nd=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.fb=n,this.router=i,this.collateService=a,this.dialog=o,this.collates=[],this.searchTags=[],this.selectedCollate=null,this.searchTerm="",this.limit=5,this.offset=0,this.totalCount=0,this.separatorKeysCodes=[13,188],this.form=this.fb.group({tag:[""]}),this.loading=!1}ngOnInit(){this.searchCollates(),this.filteredTags=this.form.controls.tag.valueChanges.pipe(yo(""),mo(t=>t?t.length>=2:!1),Co(t=>this.collateService.getCollateTags(t).pipe(go(n=>n.results))))}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,this.searchTerm,this.searchTags.map(t=>t.id)).subscribe({next:t=>{this.collates=t.results,this.totalCount=t.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onCollateSelect(t){this.selectedCollate=t.options[0].value,this.router.navigate([`/collate/view/${t.options[0].value.id}`]).then(n=>console.log(n))}openCreateCollateDialog(){this.dialog.open(Zc).afterClosed().subscribe(n=>{n&&this.collateService.createCollate(n.title,n.greeting).subscribe(i=>{this.router.navigate([`/collate/edit/${i.id}`]).then(a=>console.log(a))})})}handlePageEvent(t){this.limit=t.pageSize,this.offset=t.pageIndex*this.limit,this.searchCollates()}addTag(t){let n=t.option.value;n&&!this.searchTags.find(i=>i.id===n.id)&&this.searchTags.push(n),this.form.controls.tag.setValue(""),this.searchCollates()}removeTag(t){let n=this.searchTags.indexOf(t);n>=0&&this.searchTags.splice(n,1),this.searchCollates()}static{this.\u0275fac=function(n){return new(n||r)(Le(Fr),Le(Ut),Le(Ti),Le(qr),Le(_n))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate"]],decls:33,vars:8,consts:[["chipGrid",""],["auto","matAutocomplete"],[1,"collate-container"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[1,"search-box"],["mat-button","",2,"width","100%",3,"click"],["appearance","outlined",2,"width","500px"],[2,"width","100%"],["matInput","","placeholder","Search Collates",3,"ngModelChange","ngModel"],[3,"removable"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-raised-button","","color","primary",3,"click"],[3,"removed","removable"],["matChipRemove",""],[3,"ngModelChange","selectionChange","ngModel","multiple"],[3,"page","length","pageSize"]],template:function(n,i){if(n&1){let a=We();X(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),se(4,"C|nder Collates"),J(),Be(5,"br"),J()(),X(6,"div",5)(7,"div")(8,"button",6),ye("click",function(){return Ae(a),Pe(i.openCreateCollateDialog())}),X(9,"h3"),se(10,"+ Create Collate From Projects"),J()()(),Be(11,"hr"),X(12,"mat-card",7)(13,"mat-card-content")(14,"mat-form-field",8)(15,"input",9),pr("ngModelChange",function(s){return Ae(a),vr(i.searchTerm,s)||(i.searchTerm=s),Pe(s)}),ye("ngModelChange",function(){return Ae(a),Pe(i.searchCollates())}),J()(),X(16,"mat-form-field",8)(17,"mat-label"),se(18,"Search Tags"),J(),X(19,"mat-chip-grid",null,0),ot(21,_p,5,3,"mat-chip-row",10,Vl),Be(23,"input",11),J(),X(24,"mat-autocomplete",12,1),ye("optionSelected",function(s){return Ae(a),Pe(i.addTag(s))}),ot(26,Sp,2,2,"mat-option",13,Vl),Mo(28,"async"),J()(),X(29,"button",14),ye("click",function(){return Ae(a),Pe(i.searchCollates())}),se(30,"Search"),J(),Fe(31,Dp,4,4)(32,Ap,2,0,"p"),J()()()()}if(n&2){let a=fr(20),o=fr(25);ae(15),hr("ngModel",i.searchTerm),ae(6),st(i.searchTags),ae(2),De("matChipInputFor",a)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("formControl",i.form.controls.tag)("matAutocomplete",o),ae(3),st(Do(28,6,i.filteredTags)),ae(5),$e(i.collates.length>0?31:32)}},dependencies:[$t,Mn,Jt,St,Sn,nr,No,Io,yr,Si,_i,xt,Fo,Qt,Bo,Kc,qc,Xc,Tn,Go,Po,rr,Hc,jo],styles:[".collate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:80vh}.search-box[_ngcontent-%COMP%]{width:500px}"]})}}return r})();var id=(()=>{class r{constructor(){this.collate=null}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-header"]],inputs:{collate:"collate"},decls:7,vars:2,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(n,i){n&1&&(X(0,"div",0)(1,"div",1)(2,"h1"),se(3),J(),Be(4,"br"),X(5,"div",2),se(6),J()()()),n&2&&(ae(3),pt(i.collate==null?null:i.collate.title),ae(3),pt(i.collate==null?null:i.collate.greeting))},styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();function Rp(r,e){if(r&1&&(X(0,"p"),se(1),Be(2,"br"),se(3),J(),Be(4,"mat-progress-bar",8)),r&2){let t=ce();ae(),it("Elapsed Time: ",t.elapsedTime," seconds"),ae(2),it(" ",t.progress," ")}}var ls=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.ws=n,this.fb=i,this.web=a,this.sb=o,this.projects=[],this.loading=!1,this.searchStartTime=null,this.elapsedTime="0.00",this.progress="",this.form=this.fb.group({searchQuery:new kr("",Nr.required),searchMode:new kr("gene",Nr.required)}),this.searchResultID=new bt,this.ws.searchWSConnection?.subscribe(s=>{if(s&&s.type==="search_status")switch(s.status){case"complete":this.loading=!1,clearInterval(this.timerInterval);let u=this.calculateElapsedTime();this.progress="",this.showSnackBar(`Search complete in ${u} seconds`),this.searchResultID.emit(parseInt(s.id));break;case"in_progress":this.progress=`Current progress: ${s.current_progress}/${s.found_files}`;break;case"error":this.loading=!1,this.progress="Search error",this.showSnackBar("Search error");break}})}runSearch(){return Et(this,null,function*(){if(this.form.invalid)return;this.loading=!0,this.progress="Current progress: search initiated",this.searchStartTime=new Date,this.elapsedTime="0.00",this.timerInterval=setInterval(()=>{this.elapsedTime=this.calculateElapsedTime().toFixed(2)},200);let t=[];if(this.projects.length>0){let n=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();if(n)for(let i of n)t.push(i.id)}if(this.form.value.searchQuery&&this.form.value.searchMode){let i=this.form.value.searchQuery.toUpperCase().split("OR").map(a=>`"${a.trim().replace(/'/g,"").replace(/"/g,"")}"`);this.web.createSearch(t,i.join(" OR "),this.web.searchSessionID,1e-9,1e-9,this.form.value.searchMode).subscribe({next:()=>{this.sb.open("Search queued","Dismiss",{duration:2e3})},error:()=>{this.loading=!1,clearInterval(this.timerInterval),this.showSnackBar("Search error")}})}})}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}calculateElapsedTime(){return this.searchStartTime?(new Date().getTime()-this.searchStartTime.getTime())/1e3:0}static{this.\u0275fac=function(n){return new(n||r)(Le(Fr),Le(Ho),Le(Ut),Le(Cr),Le(Fr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-search"]],inputs:{projects:"projects"},outputs:{searchResultID:"searchResultID"},decls:22,vars:2,consts:[["appearance","outlined"],[2,"display","flex","gap","20px","align-items","center",3,"ngSubmit","formGroup"],[2,"width","500px"],["matInput","","placeholder","Search Query","formControlName","searchQuery"],["formControlName","searchMode"],["value","pi"],["value","gene"],["mat-icon-button","","color","primary","type","submit"],["mode","indeterminate"]],template:function(n,i){n&1&&(X(0,"mat-card",0)(1,"mat-card-content")(2,"form",1),ye("ngSubmit",function(){return i.runSearch()}),X(3,"mat-form-field",2),Be(4,"input",3),J(),X(5,"mat-form-field")(6,"mat-label"),se(7,"Search Mode"),J(),X(8,"mat-select",4)(9,"mat-option",5),se(10,"Primary Ids"),J(),X(11,"mat-option",6),se(12,"Gene Names"),J()()(),X(13,"button",7)(14,"mat-icon"),se(15,"search"),J()()(),X(16,"p"),se(17," For multiple search terms separate them with "),X(18,"b"),se(19,"OR"),J(),se(20,". "),J(),Fe(21,Rp,5,2),J()()),n&2&&(ae(2),De("formGroup",i.form),ae(19),$e(i.loading?21:-1))},dependencies:[nr,rr,tr,Jt,St,er,gr,mr,$t,Xr,Qt,Si,_i,Tn,ko,yr,Qc],encapsulation:2})}}return r})();var Lp=po(Tp());Bl.plotlyjs=Lp;var ad=(()=>{class r{set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set renameCondition(t){t?this._renameCondition=t:this._renameCondition={}}get renameCondition(){return this._renameCondition}set data(t){this._data=t,this.graphLayout.title.text=t?.analysis_group?.name||"",this.graphLayout.yaxis.title=this.searchTerm||"",this.conditionA=t?.condition_A||"",this.conditionB=t?.condition_B||"",this.drawGraph()}get data(){return this._data}set expanded(t){this._expanded=t,this.data&&this.drawGraph()}get expanded(){return this._expanded}set colorMap(t){t&&(this._colorMap=t,this.data&&t&&this.drawGraph())}get colorMap(){return this._colorMap}constructor(t,n){this.graph=t,this.accounts=n,this._data=null,this._renameCondition={},this._searchTerm="",this._expanded=!1,this.graphData=[],this.graphLayout={title:{text:"",font:{size:16}},height:400,margin:{l:150,r:100,b:100,t:100},yaxis:{title:this.searchTerm,tickfont:{size:14}}},this.conditionA="",this.conditionB="",this.valueA=[],this.valueB=[],this.barSize=50,this.revision=0,this._colorMap={},this.currentColor=0,this.graph.redrawTrigger.subscribe(()=>{this.drawGraph()})}drawGraph(){this.loadPlotSettings(),this.graph.plotSettings.showTitle||(this.graphLayout.title.text="");let t=this.renameCondition[this.conditionA];t||(t=this.conditionA);let n=this.renameCondition[this.conditionB];n||(n=this.conditionB);let i=document.getElementsByTagName("body")[0],o=window.getComputedStyle(i).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=o,this.graphLayout.paper_bgcolor=o,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let s=0;if(this.data&&this.data.condition_A&&this.data.condition_B&&this.data.searched_data&&!this.expanded){this.conditionA=this.data.condition_A||"",this.conditionB=this.data.condition_B||"",this.valueA=this.data.searched_data.filter(v=>v.Condition===this.conditionA).map(v=>v.Value),this.valueB=this.data.searched_data.filter(v=>v.Condition===this.conditionB).map(v=>v.Value);let u=this.calculateMean(this.valueA),l=this.calculateMean(this.valueB);this.colorMap[this.conditionA]||(this.colorMap[this.conditionA]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let c={x:[t],y:[u],type:"bar",mode:"markers",name:t,error_y:{type:"data",array:[this.calculateWhisker(this.valueA)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionA]},showlegend:!1},d=this.drawTransparentBoxPlot(this.valueA,t);this.colorMap[this.conditionB]||(this.colorMap[this.conditionB]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let f={x:[n],y:[l],type:"bar",mode:"markers",name:n,error_y:{type:"data",array:[this.calculateWhisker(this.valueB)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionB]},showlegend:!1},h=this.drawTransparentBoxPlot(this.valueB,n);s=2,this.graphData=[c,d,f,h]}else if(this.data&&(this.expanded||this.data.condition_A==""||this.data.condition_B=="")){let u=Array.from(new Set(this.data.searched_data.map(h=>h.Condition))),l=u.map(h=>{let v=this.data.searched_data.filter(p=>p.Condition===h).map(p=>p.Value);return this.calculateMean(v)}),c=u.map(h=>{let v=this.data.searched_data.filter(p=>p.Condition===h).map(p=>p.Value);return this.calculateWhisker(v)}),d=u.map((h,v)=>{this.colorMap[h]||(this.colorMap[h]=this.graph.defaultColorList[this.currentColor],this.currentColor++,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0));let p=this.renameCondition[h];return p||(p=h),{x:[p],y:[l[v]],type:"bar",mode:"markers",name:p,error_y:{type:"data",array:[c[v]],visible:!0},line:{color:"black"},marker:{color:this.colorMap[h]},showlegend:!1}}),f=u.map((h,v)=>{let p=this.renameCondition[h];p||(p=h);let m=this.data.searched_data.filter(g=>g.Condition===h).map(g=>g.Value);return this.drawTransparentBoxPlot(m,p)});s=u.length,this.graphData=[...d,...f]}console.log(this.colorMap),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*s,this.revision++,console.log(this.graphData)}calculateMean(t){return t.reduce((i,a)=>i+a,0)/t.length}calculateWhisker(t){let n=this.calculateMean(t),i=t.reduce((a,o)=>a+Math.pow(o-n,2),0)/t.length;return Math.sqrt(i)}drawTransparentBoxPlot(t,n){return{x:n,y:t.filter(i=>!isNaN(i)),type:"box",boxpoints:"all",pointpos:0,jitter:.3,fillcolor:"rgba(255,255,255,0)",line:{color:"rgba(255,255,255,0)"},hoveron:"points",marker:{color:"#654949",opacity:.8},name:n,showlegend:!1}}loadPlotSettings(){this.graphLayout.height=this.graph.plotSettings.height,this.graphLayout.margin.l=this.graph.plotSettings.marginLeft,this.graphLayout.margin.r=this.graph.plotSettings.marginRight,this.graphLayout.margin.b=this.graph.plotSettings.marginBottom,this.graphLayout.margin.t=this.graph.plotSettings.marginTop,this.graphLayout.title.font.size=this.graph.plotSettings.titleTextSize,this.barSize=this.graph.plotSettings.barSize}static{this.\u0275fac=function(n){return new(n||r)(Le(is),Le(Kr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-bar-chart"]],inputs:{searchTerm:"searchTerm",renameCondition:"renameCondition",data:"data",expanded:"expanded",colorMap:"colorMap"},decls:1,vars:4,consts:[[3,"data","layout","revision","updateOnLayoutChange"]],template:function(n,i){n&1&&Be(0,"plotly-plot",0),n&2&&De("data",i.graphData)("layout",i.graphLayout)("revision",i.revision)("updateOnLayoutChange",!0)},dependencies:[Bl,ed],encapsulation:2})}}return r})();var Ip=(r,e)=>e.id;function Np(r,e){if(r&1){let t=We();X(0,"div",3)(1,"mat-slide-toggle",8),ye("change",function(){Ae(t);let i=ce(2);return Pe(i.expanded=!i.expanded)}),se(2," Expand Bar Chart "),J(),X(3,"mat-slide-toggle",8),ye("change",function(){Ae(t);let i=ce(2);return Pe(i.viewDifferentialAnalysis=!i.viewDifferentialAnalysis)}),se(4," View Differential Analysis Stats "),J()()}r&2&&(ae(),De("color","primary"),ae(2),De("color","primary"))}function kp(r,e){if(r&1&&(X(0,"div"),Be(1,"app-bar-chart",11),J()),r&2){let t=ce().$implicit,n=ce(3);ae(),De("searchTerm",t.gene_name)("expanded",n.expanded)("renameCondition",n.renameCondition)("colorMap",n.colorMap)("data",t)}}function Fp(r,e){r&1&&(X(0,"div")(1,"p"),se(2,"No data found for this search"),J()())}function Bp(r,e){if(r&1&&(X(0,"div",9),Fe(1,kp,2,5,"div")(2,Fp,3,0,"div"),X(3,"div")(4,"button",10)(5,"mat-icon"),se(6,"drag_handle"),J()(),X(7,"p"),se(8),J()()()),r&2){let t=e.$implicit;ae(),$e(t.searched_data.length>0?1:2),ae(3),De("matTooltip",t.analysis_group.name),ae(4),it(" ",t.analysis_group.name," ")}}function Vp(r,e){if(r&1&&ot(0,Bp,9,3,"div",9,Ip),r&2){let t=ce(2);st(t.searchResults)}}function zp(r,e){r&1&&(X(0,"p"),se(1,"No search results found in this project"),J())}function Gp(r,e){r&1&&(X(0,"th",24),se(1," Primary ID "),J())}function jp(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.primary_id," ")}}function Hp(r,e){r&1&&(X(0,"th",24),se(1," UniProt ID "),J())}function Up(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.uniprot_id," ")}}function $p(r,e){r&1&&(X(0,"th",24),se(1," Gene Names "),J())}function Wp(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.gene_name," ")}}function Yp(r,e){r&1&&(X(0,"th",24),se(1," log2FC "),J())}function Xp(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.log2_fc," ")}}function qp(r,e){r&1&&(X(0,"th",24),se(1," -log10(p) "),J())}function Kp(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.log10_p," ")}}function Zp(r,e){r&1&&(X(0,"th",24),se(1," Condition A "),J())}function Qp(r,e){if(r&1&&se(0),r&2){let t=ce().$implicit,n=ce(3);it(" ",n.renameCondition[t.condition_A]," ")}}function Jp(r,e){if(r&1&&se(0),r&2){let t=ce().$implicit;it(" ",t.condition_A," ")}}function eg(r,e){if(r&1&&(X(0,"td",25),Fe(1,Qp,1,1)(2,Jp,1,1),J()),r&2){let t=ce(3);ae(),$e(t.renameCondition?1:2)}}function tg(r,e){r&1&&(X(0,"th",24),se(1," Condition B "),J())}function rg(r,e){if(r&1&&se(0),r&2){let t=ce().$implicit,n=ce(3);it(" ",n.renameCondition[t.condition_B]," ")}}function ng(r,e){if(r&1&&se(0),r&2){let t=ce().$implicit;it(" ",t.condition_B," ")}}function ig(r,e){if(r&1&&(X(0,"td",25),Fe(1,rg,1,1)(2,ng,1,1),J()),r&2){let t=ce(3);ae(),$e(t.renameCondition?1:2)}}function ag(r,e){r&1&&(X(0,"th",24),se(1," Comparison "),J())}function og(r,e){if(r&1&&(X(0,"td",25),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.comparison_label," ")}}function sg(r,e){r&1&&Be(0,"tr",26)}function lg(r,e){r&1&&Be(0,"tr",27)}function ug(r,e){if(r&1&&(X(0,"table",5),jt(1,12),Fe(2,Gp,2,0,"th",13)(3,jp,2,1,"td",14),Ht(),jt(4,15),Fe(5,Hp,2,0,"th",13)(6,Up,2,1,"td",14),Ht(),jt(7,16),Fe(8,$p,2,0,"th",13)(9,Wp,2,1,"td",14),Ht(),jt(10,17),Fe(11,Yp,2,0,"th",13)(12,Xp,2,1,"td",14),Ht(),jt(13,18),Fe(14,qp,2,0,"th",13)(15,Kp,2,1,"td",14),Ht(),jt(16,19),Fe(17,Zp,2,0,"th",13)(18,eg,3,1,"td",14),Ht(),jt(19,20),Fe(20,tg,2,0,"th",13)(21,ig,3,1,"td",14),Ht(),jt(22,21),Fe(23,ag,2,0,"th",13)(24,og,2,1,"td",14),Ht(),Fe(25,sg,1,0,"tr",22)(26,lg,1,0,"tr",23),J()),r&2){let t=ce(2);De("dataSource",t.searchResults),ae(25),De("matHeaderRowDef",t.searchResultDisplayColumns),ae(),De("matRowDefColumns",t.searchResultDisplayColumns)}}function cg(r,e){if(r&1){let t=We();X(0,"button",28),ye("click",function(){Ae(t);let i=ce(2);return Pe(i.deleteProject.emit(i.project))}),X(1,"mat-icon"),se(2,"delete"),J()()}if(r&2){let t=ce(2);Ol("matTooltip","Delete Project ",t.project.name," from collate")}}function dg(r,e){if(r&1&&(X(0,"a",7)(1,"mat-icon"),se(2,"link"),J()()),r&2){let t=ce(2);Ol("href","/#/project/",t.project.id,"",Ec)}}function fg(r,e){if(r&1){let t=We();X(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"span",2),se(4),J()(),X(5,"mat-card-subtitle"),se(6),J()(),X(7,"mat-card-content"),Fe(8,Np,5,2,"div",3),X(9,"div",4),ye("cdkDropListDropped",function(i){Ae(t);let a=ce();return Pe(a.drop(i))}),Fe(10,Vp,2,0)(11,zp,2,0,"p"),J(),Fe(12,ug,27,3,"table",5),J(),X(13,"mat-card-actions"),Fe(14,cg,3,2,"button",6)(15,dg,3,2,"a",7),J()()}if(r&2){let t=ce();ae(4),pt(t.project.name),ae(2),pt(t.project.description),ae(2),$e(t.searchResults.length>0?8:-1),ae(2),$e(t.searchResults.length>0?10:11),ae(2),$e(t.searchResults.length>0&&t.viewDifferentialAnalysis?12:-1),ae(2),$e(t.accounts.loggedIn?14:-1),ae(),$e(t.project?15:-1)}}var od=(()=>{class r{set project(t){this._project=t}get project(){return this._project}set searchResults(t){this._searchResults=t,console.log(t)}get searchResults(){return this._searchResults}constructor(t){this.accounts=t,this._project=null,this.searchTerm="",this._searchResults=[],this.colorMap={},this.renameCondition={},this.deleteProject=new bt,this.searchResultsChange=new bt,this.searchResultDisplayColumns=["primary_id","uniprot_id","gene_name","condition_A","condition_B","log2_fc","log10_p","comparison_label"],this.expanded=!1,this.viewDifferentialAnalysis=!1}drop(t){let i=this._searchResults[t.previousIndex].analysis_group.id,a=this._searchResults.filter(o=>o.analysis_group.id===i);this._searchResults=this._searchResults.filter(o=>o.analysis_group.id!==i),this._searchResults.splice(t.currentIndex,0,...a),this.searchResultsChange.emit(this._searchResults)}static{this.\u0275fac=function(n){return new(n||r)(Le(Kr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-card-viewer"]],inputs:{searchTerm:"searchTerm",project:"project",searchResults:"searchResults",colorMap:"colorMap",renameCondition:"renameCondition"},outputs:{deleteProject:"deleteProject",searchResultsChange:"searchResultsChange"},decls:1,vars:1,consts:[["appearance","outlined"],["cdkDragHandle",""],[2,"color","#ba0000"],[2,"display","flex","flex-direction","column","gap","20px"],["cdkDropList","",2,"display","flex","gap","20px","flex-wrap","wrap","justify-content","center",3,"cdkDropListDropped"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-icon-button","","color","primary",3,"matTooltip"],["target","_blank",3,"href"],[3,"change","color"],["cdkDrag",""],["mat-icon-button","","cdkDragHandle","",3,"matTooltip"],[3,"searchTerm","expanded","renameCondition","colorMap","data"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["matColumnDef","log10_p"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","comparison_label"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click","matTooltip"]],template:function(n,i){n&1&&Fe(0,fg,16,7,"mat-card",0),n&2&&$e(i.project?0:-1)},dependencies:[Fc,kc,Vc,_i,Si,as,ad,Bc,Qt,Xr,Dn,An,Zo,Yo,qo,Ko,es,Qo,ts,Jo,Wo,Xo,td,Mi],encapsulation:2})}}return r})();var hg=(r,e)=>e.id,vg=()=>[];function pg(r,e){if(r&1){let t=We();X(0,"app-project-card-viewer",3),ye("deleteProject",function(i){Ae(t);let a=ce(2);return Pe(a.deleteProject.emit(i))}),J()}if(r&2){let t=ce().$implicit,n=ce();De("searchTerm",n.searchTerm)("colorMap",n.projectConditionColorMap==null?null:n.projectConditionColorMap[t.id])("project",t)("searchResults",n.filteredResults[t.id]||So(5,vg))("renameCondition",n.renameCondition==null?null:n.renameCondition[t.id])}}function gg(r,e){if(r&1&&(X(0,"div",1),Fe(1,pg,1,6,"app-project-card-viewer",2),J()),r&2){let t=e.$implicit;ae(),$e(t&&t.id?1:-1)}}var cs=(()=>{class r{constructor(){this._searchTerm="",this.projects=[],this._filteredResults={},this.projectConditionColorMap={},this.renameCondition={},this.projectOrderChanged=new bt,this.deleteProject=new bt}set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set filteredResults(t){console.log(t),t?this._filteredResults=t:this._filteredResults={}}get filteredResults(){return this._filteredResults}drop(t){Kn(this.projects,t.previousIndex,t.currentIndex),this.projectOrderChanged.emit(this.projects)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-list"]],inputs:{searchTerm:"searchTerm",projects:"projects",filteredResults:"filteredResults",projectConditionColorMap:"projectConditionColorMap",renameCondition:"renameCondition"},outputs:{projectOrderChanged:"projectOrderChanged",deleteProject:"deleteProject"},decls:3,vars:0,consts:[["cdkDropList","",1,"project-list",3,"cdkDropListDropped"],[2,"margin","20px"],["cdkDrag","",3,"searchTerm","colorMap","project","searchResults","renameCondition"],["cdkDrag","",3,"deleteProject","searchTerm","colorMap","project","searchResults","renameCondition"]],template:function(n,i){n&1&&(X(0,"div",0),ye("cdkDropListDropped",function(o){return i.drop(o)}),ot(1,gg,2,1,"div",1,hg),J()),n&2&&(ae(),st(i.projects))},dependencies:[An,od,Dn],encapsulation:2})}}return r})();var sd=(r,e)=>e.id;function mg(r,e){if(r&1){let t=We();X(0,"mat-chip",4),ye("removed",function(){let i=Ae(t).$implicit,a=ce(2);return Pe(a.removeTag(i))}),se(1),X(2,"mat-icon",5),se(3,"cancel"),J()()}if(r&2){let t=e.$implicit;ae(),it(" ",t.name," ")}}function yg(r,e){if(r&1){let t=We();X(0,"mat-chip-set",2),ye("cdkDropListDropped",function(i){Ae(t);let a=ce();return Pe(a.drop(i))}),ot(1,mg,4,1,"mat-chip",3,sd),J()}if(r&2){let t=ce();ae(),st(t.collageTags)}}function Cg(r,e){if(r&1&&(X(0,"mat-chip"),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t.name," ")}}function wg(r,e){if(r&1&&(X(0,"mat-chip-set"),ot(1,Cg,2,1,"mat-chip",null,sd),J()),r&2){let t=ce();ae(),st(t.collageTags)}}var ds=(()=>{class r{constructor(t){this.accounts=t,this.collageTags=[],this.collageTagsChange=new bt}removeTag(t){this.collageTags=this.collageTags.filter(n=>n!==t),this.collageTagsChange.emit(this.collageTags)}drop(t){Kn(this.collageTags,t.previousIndex,t.currentIndex),this.collageTagsChange.emit(this.collageTags)}static{this.\u0275fac=function(n){return new(n||r)(Le(Kr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-tags"]],inputs:{collageTags:"collageTags"},outputs:{collageTagsChange:"collageTagsChange"},decls:4,vars:1,consts:[[2,"display","flex","justify-content","center"],["cdkDropList",""],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["cdkDrag","",3,"removed"],["matChipRemove",""]],template:function(n,i){n&1&&(X(0,"div",0),Fe(1,yg,3,0,"mat-chip-set",1)(2,wg,3,0,"mat-chip-set"),J(),Be(3,"div",0)),n&2&&(ae(),$e(i.accounts.loggedIn?1:2))},dependencies:[An,zo,Bo,Qt,Vo,Dn],encapsulation:2})}}return r})();var ud=po(ld());function bg(r,e){r&1&&(X(0,"div",2),Be(1,"div",5),J())}var cd=(()=>{class r{set url(t){this.config.data=t,this._url=t}constructor(t){this.dialogRef=t,this._url="",this.config={width:250,height:250,data:this.url,margin:5,dotsOptions:{color:"#780101",type:"dots"},backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0}}}ngAfterViewInit(){let t=new ud.default(this.config),n=document.getElementById("canvas");n&&t.append(n),this.qrCode=t}close(){this.dialogRef.close()}download(){this.qrCode&&this.qrCode.download({name:"qrcode",extension:"svg"}).then(()=>{})}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-qr-code-dialog"]],inputs:{url:"url"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","justify-content","center","align-items","center"],["mat-dialog-actions",""],["mat-button","",3,"click"],["id","canvas"]],template:function(n,i){n&1&&(X(0,"h1",0),se(1,"Collate QR Code"),J(),X(2,"div",1),Fe(3,bg,2,0,"div",2),J(),X(4,"div",3)(5,"button",4),ye("click",function(){return i.close()}),se(6,"Close"),J(),X(7,"button",4),ye("click",function(){return i.download()}),se(8,"Download"),J()()),n&2&&(ae(3),$e(i.config.data&&i.config.data!==""?3:-1))},dependencies:[Lt,It,Nt,xt],encapsulation:2})}}return r})();var dd=(r,e)=>e.id,xg=()=>({standalone:!0});function Eg(r,e){if(r&1){let t=We();X(0,"mat-checkbox",6),pr("ngModelChange",function(i){let a=Ae(t).$implicit,o=ce(2).$implicit,s=ce();return vr(s.projectAnalysisGroupVisibilityMap[o.id][a.id],i)||(s.projectAnalysisGroupVisibilityMap[o.id][a.id]=i),Pe(i)}),se(1),J()}if(r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();hr("ngModel",i.projectAnalysisGroupVisibilityMap[n.id][t.id]),De("ngModelOptions",So(3,xg)),ae(),it(" ",t.name," ")}}function Tg(r,e){if(r&1&&ot(0,Eg,2,4,"mat-checkbox",5,dd),r&2){let t=ce().$implicit,n=ce();st(n.projectAnalysisGroupMap[t.id])}}function _g(r,e){if(r&1&&(X(0,"h2"),se(1),J(),Fe(2,Tg,2,0)),r&2){let t=e.$implicit,n=ce();ae(),pt(t.name),ae(),$e(n.projectAnalysisGroupMap[t.id]?2:-1)}}var fs=(()=>{class r{set projects(t){this._projects=t}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}set projectAnalysisGroupVisibilityMap(t){this._projectAnalysisGroupVisibilityMap={};for(let n in t){this._projectAnalysisGroupVisibilityMap[n]={};for(let i in t[n])this._projectAnalysisGroupVisibilityMap[n][i]=t[n][i]}}get projectAnalysisGroupVisibilityMap(){return this._projectAnalysisGroupVisibilityMap}constructor(t){this.dialog=t,this._projects=[],this._projectAnalysisGroupMap={},this._projectAnalysisGroupVisibilityMap={}}close(){this.dialog.close()}save(){this.dialog.close(this.projectAnalysisGroupVisibilityMap)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-analysis-group-visibility-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap",projectAnalysisGroupVisibilityMap:"projectAnalysisGroupVisibilityMap"},decls:11,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"]],template:function(n,i){n&1&&(X(0,"h1",0),se(1,"Analysis Group Visibility"),J(),X(2,"div",1)(3,"form",2),ot(4,_g,3,2,null,null,dd),J()(),X(6,"div",3)(7,"button",4),ye("click",function(){return i.close()}),se(8,"Cancel"),J(),X(9,"button",4),ye("click",function(){return i.save()}),se(10,"Submit"),J()()),n&2&&(ae(4),st(i.projects))},dependencies:[Lt,It,Mn,tr,St,er,Sn,jc,Ri,Nt,xt],encapsulation:2})}}return r})();function Vt(r){"@babel/helpers - typeof";return Vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(r)}function jn(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function fd(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Hn(r,e,t){return e&&fd(r.prototype,e),t&&fd(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Of(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kt(r,e){return Mg(r)||Ag(r,e)||wu(r,e)||Rg()}function Lf(r){return Sg(r)||Dg(r)||wu(r)||Pg()}function Sg(r){if(Array.isArray(r))return nu(r)}function Mg(r){if(Array.isArray(r))return r}function Dg(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ag(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],i=!0,a=!1,o,s;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(u){a=!0,s=u}finally{try{!i&&t.return!=null&&t.return()}finally{if(a)throw s}}return n}}function wu(r,e){if(r){if(typeof r=="string")return nu(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nu(r,e)}}function nu(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Pg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sr(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=wu(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return a=u.done,u},e:function(u){o=!0,s=u},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}var Ft=typeof window>"u"?null:window,hd=Ft?Ft.navigator:null;Ft&&Ft.document;var Og=Vt(""),If=Vt({}),Lg=Vt(function(){}),Ig=typeof HTMLElement>"u"?"undefined":Vt(HTMLElement),Ha=function(e){return e&&e.instanceString&&_t(e.instanceString)?e.instanceString():null},Ue=function(e){return e!=null&&Vt(e)==Og},_t=function(e){return e!=null&&Vt(e)===Lg},gt=function(e){return!Mr(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},ut=function(e){return e!=null&&Vt(e)===If&&!gt(e)&&e.constructor===Object},Ng=function(e){return e!=null&&Vt(e)===If},Ne=function(e){return e!=null&&Vt(e)===Vt(1)&&!isNaN(e)},kg=function(e){return Ne(e)&&Math.floor(e)===e},ks=function(e){if(Ig!=="undefined")return e!=null&&e instanceof HTMLElement},Mr=function(e){return Ua(e)||Nf(e)},Ua=function(e){return Ha(e)==="collection"&&e._private.single},Nf=function(e){return Ha(e)==="collection"&&!e._private.single},bu=function(e){return Ha(e)==="core"},kf=function(e){return Ha(e)==="stylesheet"},Fg=function(e){return Ha(e)==="event"},kn=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},Bg=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},Vg=function(e){return ut(e)&&Ne(e.x1)&&Ne(e.x2)&&Ne(e.y1)&&Ne(e.y2)},zg=function(e){return Ng(e)&&_t(e.then)},Gg=function(){return hd&&hd.userAgent.match(/msie|trident|edge/i)},Oa=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);return a.join("$")});var n=function i(){var a=this,o=arguments,s,u=t.apply(a,o),l=i.cache;return(s=l[u])||(s=l[u]=e.apply(a,o)),s};return n.cache={},n},xu=Oa(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Xs=Oa(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),Ff=Oa(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),vd=function(e){return kn(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Bt="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",jg="rgb[a]?\\(("+Bt+"[%]?)\\s*,\\s*("+Bt+"[%]?)\\s*,\\s*("+Bt+"[%]?)(?:\\s*,\\s*("+Bt+"))?\\)",Hg="rgb[a]?\\((?:"+Bt+"[%]?)\\s*,\\s*(?:"+Bt+"[%]?)\\s*,\\s*(?:"+Bt+"[%]?)(?:\\s*,\\s*(?:"+Bt+"))?\\)",Ug="hsl[a]?\\(("+Bt+")\\s*,\\s*("+Bt+"[%])\\s*,\\s*("+Bt+"[%])(?:\\s*,\\s*("+Bt+"))?\\)",$g="hsl[a]?\\((?:"+Bt+")\\s*,\\s*(?:"+Bt+"[%])\\s*,\\s*(?:"+Bt+"[%])(?:\\s*,\\s*(?:"+Bt+"))?\\)",Wg="\\#[0-9a-fA-F]{3}",Yg="\\#[0-9a-fA-F]{6}",Bf=function(e,t){return e<t?-1:e>t?1:0},Xg=function(e,t){return-1*Bf(e,t)},Ye=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var n=e[t];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var o=i[a];r[o]=n[o]}}return r},qg=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,n,i,a,o=16;return t?(n=parseInt(e[1]+e[1],o),i=parseInt(e[2]+e[2],o),a=parseInt(e[3]+e[3],o)):(n=parseInt(e[1]+e[2],o),i=parseInt(e[3]+e[4],o),a=parseInt(e[5]+e[6],o)),[n,i,a]}},Kg=function(e){var t,n,i,a,o,s,u,l;function c(v,p,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?v+(p-v)*6*m:m<1/2?p:m<2/3?v+(p-v)*(2/3-m)*6:v}var d=new RegExp("^"+Ug+"$").exec(e);if(d){if(n=parseInt(d[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(d[2]),i<0||i>100||(i=i/100,a=parseFloat(d[3]),a<0||a>100)||(a=a/100,o=d[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(i===0)s=u=l=Math.round(a*255);else{var f=a<.5?a*(1+i):a+i-a*i,h=2*a-f;s=Math.round(255*c(h,f,n+1/3)),u=Math.round(255*c(h,f,n)),l=Math.round(255*c(h,f,n-1/3))}t=[s,u,l,o]}return t},Zg=function(e){var t,n=new RegExp("^"+jg+"$").exec(e);if(n){t=[];for(var i=[],a=1;a<=3;a++){var o=n[a];if(o[o.length-1]==="%"&&(i[a]=!0),o=parseFloat(o),i[a]&&(o=o/100*255),o<0||o>255)return;t.push(Math.floor(o))}var s=i[1]||i[2]||i[3],u=i[1]&&i[2]&&i[3];if(s&&!u)return;var l=n[4];if(l!==void 0){if(l=parseFloat(l),l<0||l>1)return;t.push(l)}}return t},Qg=function(e){return Jg[e.toLowerCase()]},Vf=function(e){return(gt(e)?e:null)||Qg(e)||qg(e)||Zg(e)||Kg(e)},Jg={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},zf=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(ut(o))throw Error("Tried to set map with object key");a<n.length-1?(t[o]==null&&(t[o]={}),t=t[o]):t[o]=e.value}},Gf=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(ut(o))throw Error("Tried to get map with object key");if(t=t[o],t==null)return t}return t};function em(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var ii=em,Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tm(r,e){return e={exports:{}},r(e,e.exports),e.exports}var rm=typeof Ea=="object"&&Ea&&Ea.Object===Object&&Ea,nm=rm,im=typeof self=="object"&&self&&self.Object===Object&&self,am=nm||im||Function("return this")(),qs=am,om=function(){return qs.Date.now()},Gl=om,sm=/\s/;function lm(r){for(var e=r.length;e--&&sm.test(r.charAt(e)););return e}var um=lm,cm=/^\s+/;function dm(r){return r&&r.slice(0,um(r)+1).replace(cm,"")}var fm=dm,hm=qs.Symbol,$i=hm,jf=Object.prototype,vm=jf.hasOwnProperty,pm=jf.toString,ga=$i?$i.toStringTag:void 0;function gm(r){var e=vm.call(r,ga),t=r[ga];try{r[ga]=void 0;var n=!0}catch{}var i=pm.call(r);return n&&(e?r[ga]=t:delete r[ga]),i}var mm=gm,ym=Object.prototype,Cm=ym.toString;function wm(r){return Cm.call(r)}var bm=wm,xm="[object Null]",Em="[object Undefined]",pd=$i?$i.toStringTag:void 0;function Tm(r){return r==null?r===void 0?Em:xm:pd&&pd in Object(r)?mm(r):bm(r)}var Hf=Tm;function _m(r){return r!=null&&typeof r=="object"}var Sm=_m,Mm="[object Symbol]";function Dm(r){return typeof r=="symbol"||Sm(r)&&Hf(r)==Mm}var $a=Dm,gd=NaN,Am=/^[-+]0x[0-9a-f]+$/i,Pm=/^0b[01]+$/i,Rm=/^0o[0-7]+$/i,Om=parseInt;function Lm(r){if(typeof r=="number")return r;if($a(r))return gd;if(ii(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=ii(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=fm(r);var t=Pm.test(r);return t||Rm.test(r)?Om(r.slice(2),t?2:8):Am.test(r)?gd:+r}var md=Lm,Im="Expected a function",Nm=Math.max,km=Math.min;function Fm(r,e,t){var n,i,a,o,s,u,l=0,c=!1,d=!1,f=!0;if(typeof r!="function")throw new TypeError(Im);e=md(e)||0,ii(t)&&(c=!!t.leading,d="maxWait"in t,a=d?Nm(md(t.maxWait)||0,e):a,f="trailing"in t?!!t.trailing:f);function h(P){var R=n,L=i;return n=i=void 0,l=P,o=r.apply(L,R),o}function v(P){return l=P,s=setTimeout(g,e),c?h(P):o}function p(P){var R=P-u,L=P-l,O=e-R;return d?km(O,a-L):O}function m(P){var R=P-u,L=P-l;return u===void 0||R>=e||R<0||d&&L>=a}function g(){var P=Gl();if(m(P))return y(P);s=setTimeout(g,p(P))}function y(P){return s=void 0,f&&n?h(P):(n=i=void 0,o)}function x(){s!==void 0&&clearTimeout(s),l=0,n=u=i=s=void 0}function S(){return s===void 0?o:y(Gl())}function D(){var P=Gl(),R=m(P);if(n=arguments,i=this,u=P,R){if(s===void 0)return v(u);if(d)return clearTimeout(s),s=setTimeout(g,e),h(u)}return s===void 0&&(s=setTimeout(g,e)),o}return D.cancel=x,D.flush=S,D}var Wa=Fm,jl=Ft?Ft.performance:null,Uf=jl&&jl.now?function(){return jl.now()}:function(){return Date.now()},Bm=function(){if(Ft){if(Ft.requestAnimationFrame)return function(r){Ft.requestAnimationFrame(r)};if(Ft.mozRequestAnimationFrame)return function(r){Ft.mozRequestAnimationFrame(r)};if(Ft.webkitRequestAnimationFrame)return function(r){Ft.webkitRequestAnimationFrame(r)};if(Ft.msRequestAnimationFrame)return function(r){Ft.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(Uf())},1e3/60)}}(),Fs=function(e){return Bm(e)},dn=Uf,Bi=9261,$f=65599,Ta=5381,Wf=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bi,n=t,i;i=e.next(),!i.done;)n=n*$f+i.value|0;return n},La=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bi;return t*$f+e|0},Ia=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ta;return(t<<5)+t+e|0},Vm=function(e,t){return e*2097152+t},Pn=function(e){return e[0]*2097152+e[1]},hs=function(e,t){return[La(e[0],t[0]),Ia(e[1],t[1])]},zm=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return Wf(o,t)},Fn=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return Wf(o,t)},Yf=function(){return Gm(arguments)},Gm=function(e){for(var t,n=0;n<e.length;n++){var i=e[n];n===0?t=Fn(i):t=Fn(i,t)}return t},yd=!0,jm=console.warn!=null,Hm=console.trace!=null,Eu=Number.MAX_SAFE_INTEGER||9007199254740991,Xf=function(){return!0},Bs=function(){return!1},Cd=function(){return 0},Tu=function(){},Tt=function(e){throw new Error(e)},qf=function(e){if(e!==void 0)yd=!!e;else return yd},ft=function(e){qf()&&(jm?console.warn(e):(console.log(e),Hm&&console.trace()))},Um=function(e){return Ye({},e)},Jr=function(e){return e==null?e:gt(e)?e.slice():ut(e)?Um(e):e},$m=function(e){return e.slice()},Kf=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},Wm={},Zf=function(){return Wm},Yt=function(e){var t=Object.keys(e);return function(n){for(var i={},a=0;a<t.length;a++){var o=t[a],s=n?.[o];i[o]=s===void 0?e[o]:s}return i}},Bn=function(e,t,n){for(var i=e.length-1;i>=0&&!(e[i]===t&&(e.splice(i,1),n));i--);},_u=function(e){e.splice(0,e.length)},Ym=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.push(i)}},zr=function(e,t,n){return n&&(t=Ff(n,t)),e[t]},On=function(e,t,n,i){n&&(t=Ff(n,t)),e[t]=i},Xm=function(){function r(){jn(this,r),this._obj={}}return Hn(r,[{key:"set",value:function(t,n){return this._obj[t]=n,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}]),r}(),en=typeof Map<"u"?Map:Xm,qm="undefined",Km=function(){function r(e){if(jn(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var n=0;n<t.length;n++)this.add(t[n])}}return Hn(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var n=this._obj;n[t]!==1&&(n[t]=1,this.size++)}},{key:"delete",value:function(t){var n=this._obj;n[t]===1&&(n[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(n){return t.has(n)})}},{key:"forEach",value:function(t,n){return this.toArray().forEach(t,n)}}]),r}(),qi=(typeof Set>"u"?"undefined":Vt(Set))!==qm?Set:Km,Ks=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!bu(e)){Tt("An element must have a core reference and parameters set");return}var i=t.group;if(i==null&&(t.data&&t.data.source!=null&&t.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){Tt("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?i==="edges":!!t.pannable,active:!1,classes:new qi,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var o=t.renderedPosition,s=e.pan(),u=e.zoom();a.position={x:(o.x-s.x)/u,y:(o.y-s.y)/u}}var l=[];gt(t.classes)?l=t.classes:Ue(t.classes)&&(l=t.classes.split(/\s+/));for(var c=0,d=l.length;c<d;c++){var f=l[c];!f||f===""||a.classes.add(f)}this.createEmitter();var h=t.style||t.css;h&&(ft("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(h)),(n===void 0||n)&&this.restore()},wd=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var o;ut(n)&&!Mr(n)&&(o=n,n=o.roots||o.root,i=o.visit,a=o.directed),a=arguments.length===2&&!_t(i)?i:a,i=_t(i)?i:function(){};for(var s=this._private.cy,u=n=Ue(n)?this.filter(n):n,l=[],c=[],d={},f={},h={},v=0,p,m=this.byGroup(),g=m.nodes,y=m.edges,x=0;x<u.length;x++){var S=u[x],D=S.id();S.isNode()&&(l.unshift(S),e.bfs&&(h[D]=!0,c.push(S)),f[D]=0)}for(var P=function(){var T=e.bfs?l.shift():l.pop(),E=T.id();if(e.dfs){if(h[E])return"continue";h[E]=!0,c.push(T)}var b=f[E],C=d[E],_=C!=null?C.source():null,M=C!=null?C.target():null,A=C==null?void 0:T.same(_)?M[0]:_[0],F=void 0;if(F=i(T,C,A,v++,b),F===!0)return p=T,"break";if(F===!1)return"break";for(var N=T.connectedEdges().filter(function(Q){return(!a||Q.source().same(T))&&y.has(Q)}),z=0;z<N.length;z++){var Y=N[z],U=Y.connectedNodes().filter(function(Q){return!Q.same(T)&&g.has(Q)}),ee=U.id();U.length!==0&&!h[ee]&&(U=U[0],l.push(U),e.bfs&&(h[ee]=!0,c.push(U)),d[ee]=Y,f[ee]=f[E]+1)}};l.length!==0;){var R=P();if(R!=="continue"&&R==="break")break}for(var L=s.collection(),O=0;O<c.length;O++){var I=c[O],B=d[I.id()];B!=null&&L.push(B),L.push(I)}return{path:s.collection(L),found:s.collection(p)}}},Na={breadthFirstSearch:wd({bfs:!0}),depthFirstSearch:wd({dfs:!0})};Na.bfs=Na.breadthFirstSearch;Na.dfs=Na.depthFirstSearch;var Zm=tm(function(r,e){(function(){var t,n,i,a,o,s,u,l,c,d,f,h,v,p,m;i=Math.floor,d=Math.min,n=function(g,y){return g<y?-1:g>y?1:0},c=function(g,y,x,S,D){var P;if(x==null&&(x=0),D==null&&(D=n),x<0)throw new Error("lo must be non-negative");for(S==null&&(S=g.length);x<S;)P=i((x+S)/2),D(y,g[P])<0?S=P:x=P+1;return[].splice.apply(g,[x,x-x].concat(y)),y},s=function(g,y,x){return x==null&&(x=n),g.push(y),p(g,0,g.length-1,x)},o=function(g,y){var x,S;return y==null&&(y=n),x=g.pop(),g.length?(S=g[0],g[0]=x,m(g,0,y)):S=x,S},l=function(g,y,x){var S;return x==null&&(x=n),S=g[0],g[0]=y,m(g,0,x),S},u=function(g,y,x){var S;return x==null&&(x=n),g.length&&x(g[0],y)<0&&(S=[g[0],y],y=S[0],g[0]=S[1],m(g,0,x)),y},a=function(g,y){var x,S,D,P,R,L;for(y==null&&(y=n),P=function(){L=[];for(var O=0,I=i(g.length/2);0<=I?O<I:O>I;0<=I?O++:O--)L.push(O);return L}.apply(this).reverse(),R=[],S=0,D=P.length;S<D;S++)x=P[S],R.push(m(g,x,y));return R},v=function(g,y,x){var S;if(x==null&&(x=n),S=g.indexOf(y),S!==-1)return p(g,0,S,x),m(g,S,x)},f=function(g,y,x){var S,D,P,R,L;if(x==null&&(x=n),D=g.slice(0,y),!D.length)return D;for(a(D,x),L=g.slice(y),P=0,R=L.length;P<R;P++)S=L[P],u(D,S,x);return D.sort(x).reverse()},h=function(g,y,x){var S,D,P,R,L,O,I,B,w;if(x==null&&(x=n),y*10<=g.length){if(P=g.slice(0,y).sort(x),!P.length)return P;for(D=P[P.length-1],I=g.slice(y),R=0,O=I.length;R<O;R++)S=I[R],x(S,D)<0&&(c(P,S,0,null,x),P.pop(),D=P[P.length-1]);return P}for(a(g,x),w=[],L=0,B=d(y,g.length);0<=B?L<B:L>B;0<=B?++L:--L)w.push(o(g,x));return w},p=function(g,y,x,S){var D,P,R;for(S==null&&(S=n),D=g[x];x>y;){if(R=x-1>>1,P=g[R],S(D,P)<0){g[x]=P,x=R;continue}break}return g[x]=D},m=function(g,y,x){var S,D,P,R,L;for(x==null&&(x=n),D=g.length,L=y,P=g[y],S=2*y+1;S<D;)R=S+1,R<D&&!(x(g[S],g[R])<0)&&(S=R),g[y]=g[S],y=S,S=2*y+1;return g[y]=P,p(g,L,y,x)},t=function(){g.push=s,g.pop=o,g.replace=l,g.pushpop=u,g.heapify=a,g.updateItem=v,g.nlargest=f,g.nsmallest=h;function g(y){this.cmp=y??n,this.nodes=[]}return g.prototype.push=function(y){return s(this.nodes,y,this.cmp)},g.prototype.pop=function(){return o(this.nodes,this.cmp)},g.prototype.peek=function(){return this.nodes[0]},g.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},g.prototype.replace=function(y){return l(this.nodes,y,this.cmp)},g.prototype.pushpop=function(y){return u(this.nodes,y,this.cmp)},g.prototype.heapify=function(){return a(this.nodes,this.cmp)},g.prototype.updateItem=function(y){return v(this.nodes,y,this.cmp)},g.prototype.clear=function(){return this.nodes=[]},g.prototype.empty=function(){return this.nodes.length===0},g.prototype.size=function(){return this.nodes.length},g.prototype.clone=function(){var y;return y=new g,y.nodes=this.nodes.slice(0),y},g.prototype.toArray=function(){return this.nodes.slice(0)},g.prototype.insert=g.prototype.push,g.prototype.top=g.prototype.peek,g.prototype.front=g.prototype.peek,g.prototype.has=g.prototype.contains,g.prototype.copy=g.prototype.clone,g}(),function(g,y){return r.exports=y()}(this,function(){return t})}).call(Ea)}),Ya=Zm,Qm=Yt({root:null,weight:function(e){return 1},directed:!1}),Jm={dijkstra:function(e){if(!ut(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=Qm(e),i=n.root,a=n.weight,o=n.directed,s=this,u=a,l=Ue(i)?this.filter(i)[0]:i[0],c={},d={},f={},h=this.byGroup(),v=h.nodes,p=h.edges;p.unmergeBy(function(b){return b.isLoop()});for(var m=function(C){return c[C.id()]},g=function(C,_){c[C.id()]=_,y.updateItem(C)},y=new Ya(function(b,C){return m(b)-m(C)}),x=0;x<v.length;x++){var S=v[x];c[S.id()]=S.same(l)?0:1/0,y.push(S)}for(var D=function(C,_){for(var M=(o?C.edgesTo(_):C.edgesWith(_)).intersect(p),A=1/0,F,N=0;N<M.length;N++){var z=M[N],Y=u(z);(Y<A||!F)&&(A=Y,F=z)}return{edge:F,dist:A}};y.size()>0;){var P=y.pop(),R=m(P),L=P.id();if(f[L]=R,R!==1/0)for(var O=P.neighborhood().intersect(v),I=0;I<O.length;I++){var B=O[I],w=B.id(),T=D(P,B),E=R+T.dist;E<m(B)&&(g(B,E),d[w]={node:P,edge:T.edge})}}return{distanceTo:function(C){var _=Ue(C)?v.filter(C)[0]:C[0];return f[_.id()]},pathTo:function(C){var _=Ue(C)?v.filter(C)[0]:C[0],M=[],A=_,F=A.id();if(_.length>0)for(M.unshift(_);d[F];){var N=d[F];M.unshift(N.edge),M.unshift(N.node),A=N.node,F=A.id()}return s.spawn(M)}}}},e0={kruskal:function(e){e=e||function(x){return 1};for(var t=this.byGroup(),n=t.nodes,i=t.edges,a=n.length,o=new Array(a),s=n,u=function(S){for(var D=0;D<o.length;D++){var P=o[D];if(P.has(S))return D}},l=0;l<a;l++)o[l]=this.spawn(n[l]);for(var c=i.sort(function(x,S){return e(x)-e(S)}),d=0;d<c.length;d++){var f=c[d],h=f.source()[0],v=f.target()[0],p=u(h),m=u(v),g=o[p],y=o[m];p!==m&&(s.merge(f),g.merge(y),o.splice(m,1))}return s}},t0=Yt({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),r0={aStar:function(e){var t=this.cy(),n=t0(e),i=n.root,a=n.goal,o=n.heuristic,s=n.directed,u=n.weight;i=t.collection(i)[0],a=t.collection(a)[0];var l=i.id(),c=a.id(),d={},f={},h={},v=new Ya(function(F,N){return f[F.id()]-f[N.id()]}),p=new qi,m={},g={},y=function(N,z){v.push(N),p.add(z)},x,S,D=function(){x=v.pop(),S=x.id(),p.delete(S)},P=function(N){return p.has(N)};y(i,l),d[l]=0,f[l]=o(i);for(var R=0;v.size()>0;){if(D(),R++,S===c){for(var L=[],O=a,I=c,B=g[I];L.unshift(O),B!=null&&L.unshift(B),O=m[I],O!=null;)I=O.id(),B=g[I];return{found:!0,distance:d[S],path:this.spawn(L),steps:R}}h[S]=!0;for(var w=x._private.edges,T=0;T<w.length;T++){var E=w[T];if(this.hasElementWithId(E.id())&&!(s&&E.data("source")!==S)){var b=E.source(),C=E.target(),_=b.id()!==S?b:C,M=_.id();if(this.hasElementWithId(M)&&!h[M]){var A=d[S]+u(E);if(!P(M)){d[M]=A,f[M]=A+o(_),y(_,M),m[M]=x,g[M]=E;continue}A<d[M]&&(d[M]=A,f[M]=A+o(_),m[M]=x,g[M]=E)}}}}return{found:!1,distance:void 0,path:void 0,steps:R}}},n0=Yt({weight:function(e){return 1},directed:!1}),i0={floydWarshall:function(e){for(var t=this.cy(),n=n0(e),i=n.weight,a=n.directed,o=i,s=this.byGroup(),u=s.nodes,l=s.edges,c=u.length,d=c*c,f=function(Y){return u.indexOf(Y)},h=function(Y){return u[Y]},v=new Array(d),p=0;p<d;p++){var m=p%c,g=(p-m)/c;g===m?v[p]=0:v[p]=1/0}for(var y=new Array(d),x=new Array(d),S=0;S<l.length;S++){var D=l[S],P=D.source()[0],R=D.target()[0];if(P!==R){var L=f(P),O=f(R),I=L*c+O,B=o(D);if(v[I]>B&&(v[I]=B,y[I]=O,x[I]=D),!a){var w=O*c+L;!a&&v[w]>B&&(v[w]=B,y[w]=L,x[w]=D)}}}for(var T=0;T<c;T++)for(var E=0;E<c;E++)for(var b=E*c+T,C=0;C<c;C++){var _=E*c+C,M=T*c+C;v[b]+v[M]<v[_]&&(v[_]=v[b]+v[M],y[_]=y[b])}var A=function(Y){return(Ue(Y)?t.filter(Y):Y)[0]},F=function(Y){return f(A(Y))},N={distance:function(Y,U){var ee=F(Y),Q=F(U);return v[ee*c+Q]},path:function(Y,U){var ee=F(Y),Q=F(U),j=h(ee);if(ee===Q)return j.collection();if(y[ee*c+Q]==null)return t.collection();var K=t.collection(),H=ee,k;for(K.merge(j);ee!==Q;)H=ee,ee=y[ee*c+Q],k=x[H*c+ee],K.merge(k),K.merge(h(ee));return K}};return N}},a0=Yt({weight:function(e){return 1},directed:!1,root:null}),o0={bellmanFord:function(e){var t=this,n=a0(e),i=n.weight,a=n.directed,o=n.root,s=i,u=this,l=this.cy(),c=this.byGroup(),d=c.edges,f=c.nodes,h=f.length,v=new en,p=!1,m=[];o=l.collection(o)[0],d.unmergeBy(function(he){return he.isLoop()});for(var g=d.length,y=function(ue){var de=v.get(ue.id());return de||(de={},v.set(ue.id(),de)),de},x=function(ue){return(Ue(ue)?l.$(ue):ue)[0]},S=function(ue){return y(x(ue)).dist},D=function(ue){for(var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,me=x(ue),_e=[],xe=me;;){if(xe==null)return t.spawn();var Ce=y(xe),Ee=Ce.edge,be=Ce.pred;if(_e.unshift(xe[0]),xe.same(de)&&_e.length>0)break;Ee!=null&&_e.unshift(Ee),xe=be}return u.spawn(_e)},P=0;P<h;P++){var R=f[P],L=y(R);R.same(o)?L.dist=0:L.dist=1/0,L.pred=null,L.edge=null}for(var O=!1,I=function(ue,de,me,_e,xe,Ce){var Ee=_e.dist+Ce;Ee<xe.dist&&!me.same(_e.edge)&&(xe.dist=Ee,xe.pred=ue,xe.edge=me,O=!0)},B=1;B<h;B++){O=!1;for(var w=0;w<g;w++){var T=d[w],E=T.source(),b=T.target(),C=s(T),_=y(E),M=y(b);I(E,b,T,_,M,C),a||I(b,E,T,M,_,C)}if(!O)break}if(O)for(var A=[],F=0;F<g;F++){var N=d[F],z=N.source(),Y=N.target(),U=s(N),ee=y(z).dist,Q=y(Y).dist;if(ee+U<Q||!a&&Q+U<ee)if(p||(ft("Graph contains a negative weight cycle for Bellman-Ford"),p=!0),e.findNegativeWeightCycles!==!1){var j=[];ee+U<Q&&j.push(z),!a&&Q+U<ee&&j.push(Y);for(var K=j.length,H=0;H<K;H++){var k=j[H],G=[k];G.push(y(k).edge);for(var $=y(k).pred;G.indexOf($)===-1;)G.push($),G.push(y($).edge),$=y($).pred;G=G.slice(G.indexOf($));for(var te=G[0].id(),q=0,ge=2;ge<G.length;ge+=2)G[ge].id()<te&&(te=G[ge].id(),q=ge);G=G.slice(q).concat(G.slice(0,q)),G.push(G[0]);var Te=G.map(function(he){return he.id()}).join(",");A.indexOf(Te)===-1&&(m.push(u.spawn(G)),A.push(Te))}}else break}return{distanceTo:S,pathTo:D,hasNegativeWeightCycle:p,negativeWeightCycles:m}}},s0=Math.sqrt(2),l0=function(e,t,n){n.length===0&&Tt("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],o=i[2],s=t[a],u=t[o],l=n,c=l.length-1;c>=0;c--){var d=l[c],f=d[1],h=d[2];(t[f]===s&&t[h]===u||t[f]===u&&t[h]===s)&&l.splice(c,1)}for(var v=0;v<l.length;v++){var p=l[v];p[1]===u?(l[v]=p.slice(),l[v][1]=s):p[2]===u&&(l[v]=p.slice(),l[v][2]=s)}for(var m=0;m<t.length;m++)t[m]===u&&(t[m]=s);return l},Hl=function(e,t,n,i){for(;n>i;){var a=Math.floor(Math.random()*t.length);t=l0(a,e,t),n--}return t},u0={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,i=t.edges;i.unmergeBy(function(M){return M.isLoop()});var a=n.length,o=i.length,s=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),u=Math.floor(a/s0);if(a<2){Tt("At least 2 nodes are required for Karger-Stein algorithm");return}for(var l=[],c=0;c<o;c++){var d=i[c];l.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var f=1/0,h=[],v=new Array(a),p=new Array(a),m=new Array(a),g=function(A,F){for(var N=0;N<a;N++)F[N]=A[N]},y=0;y<=s;y++){for(var x=0;x<a;x++)p[x]=x;var S=Hl(p,l.slice(),a,u),D=S.slice();g(p,m);var P=Hl(p,S,u,2),R=Hl(m,D,u,2);P.length<=R.length&&P.length<f?(f=P.length,h=P,g(p,v)):R.length<=P.length&&R.length<f&&(f=R.length,h=R,g(m,v))}for(var L=this.spawn(h.map(function(M){return i[M[0]]})),O=this.spawn(),I=this.spawn(),B=v[0],w=0;w<v.length;w++){var T=v[w],E=n[w];T===B?O.merge(E):I.merge(E)}var b=function(A){var F=e.spawn();return A.forEach(function(N){F.merge(N),N.connectedEdges().forEach(function(z){e.contains(z)&&!L.contains(z)&&F.merge(z)})}),F},C=[b(O),b(I)],_={cut:L,components:C,partition1:O,partition2:I};return _}},c0=function(e){return{x:e.x,y:e.y}},Zs=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},Qf=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},Vi=function(e){return{x:e[0],y:e[1]}},d0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.min(o,i))}return i},f0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.max(o,i))}return i},h0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,o=t;o<n;o++){var s=e[o];isFinite(s)&&(i+=s,a++)}return i/a},v0=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(t,n):(n<e.length&&e.splice(n,e.length-n),t>0&&e.splice(0,t));for(var s=0,u=e.length-1;u>=0;u--){var l=e[u];o?isFinite(l)||(e[u]=-1/0,s++):e.splice(u,1)}a&&e.sort(function(f,h){return f-h});var c=e.length,d=Math.floor(c/2);return c%2!==0?e[d+1+s]:(e[d-1+s]+e[d+s])/2},p0=function(e){return Math.PI*e/180},vs=function(e,t){return Math.atan2(t,e)-Math.PI/2},Su=Math.log2||function(r){return Math.log(r)/Math.log(2)},Jf=function(e){return e>0?1:e<0?-1:0},ai=function(e,t){return Math.sqrt(Jn(e,t))},Jn=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},g0=function(e){for(var t=e.length,n=0,i=0;i<t;i++)n+=e[i];for(var a=0;a<t;a++)e[a]=e[a]/n;return e},Wt=function(e,t,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*n},Gi=function(e,t,n,i){return{x:Wt(e.x,t.x,n.x,i),y:Wt(e.y,t.y,n.y,i)}},m0=function(e,t,n,i){var a={x:t.x-e.x,y:t.y-e.y},o=ai(e,t),s={x:a.x/o,y:a.y/o};return n=n??0,i=i??n*o,{x:e.x+s.x*i,y:e.y+s.y*i}},ka=function(e,t,n){return Math.max(e,Math.min(n,t))},br=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},y0=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},C0=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},w0=function(e,t,n){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},eh=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},b0=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},Ms=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Ds=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,o;if(t.length===1)n=i=a=o=t[0];else if(t.length===2)n=a=t[0],o=i=t[1];else if(t.length===4){var s=kt(t,4);n=s[0],i=s[1],a=s[2],o=s[3]}return e.x1-=o,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},bd=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},Mu=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},Wi=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},x0=function(e,t){return Wi(e,t.x,t.y)},th=function(e,t){return Wi(e,t.x1,t.y1)&&Wi(e,t.x2,t.y2)},rh=function(e,t,n,i,a,o,s){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",l=u==="auto"?oi(a,o):u,c=a/2,d=o/2;l=Math.min(l,c,d);var f=l!==c,h=l!==d,v;if(f){var p=n-c+l-s,m=i-d-s,g=n+c-l+s,y=m;if(v=Ln(e,t,n,i,p,m,g,y,!1),v.length>0)return v}if(h){var x=n+c+s,S=i-d+l-s,D=x,P=i+d-l+s;if(v=Ln(e,t,n,i,x,S,D,P,!1),v.length>0)return v}if(f){var R=n-c+l-s,L=i+d+s,O=n+c-l+s,I=L;if(v=Ln(e,t,n,i,R,L,O,I,!1),v.length>0)return v}if(h){var B=n-c-s,w=i-d+l-s,T=B,E=i+d-l+s;if(v=Ln(e,t,n,i,B,w,T,E,!1),v.length>0)return v}var b;{var C=n-c+l,_=i-d+l;if(b=_a(e,t,n,i,C,_,l+s),b.length>0&&b[0]<=C&&b[1]<=_)return[b[0],b[1]]}{var M=n+c-l,A=i-d+l;if(b=_a(e,t,n,i,M,A,l+s),b.length>0&&b[0]>=M&&b[1]<=A)return[b[0],b[1]]}{var F=n+c-l,N=i+d-l;if(b=_a(e,t,n,i,F,N,l+s),b.length>0&&b[0]>=F&&b[1]>=N)return[b[0],b[1]]}{var z=n-c+l,Y=i+d-l;if(b=_a(e,t,n,i,z,Y,l+s),b.length>0&&b[0]<=z&&b[1]>=Y)return[b[0],b[1]]}return[]},E0=function(e,t,n,i,a,o,s){var u=s,l=Math.min(n,a),c=Math.max(n,a),d=Math.min(i,o),f=Math.max(i,o);return l-u<=e&&e<=c+u&&d-u<=t&&t<=f+u},T0=function(e,t,n,i,a,o,s,u,l){var c={x1:Math.min(n,s,a)-l,x2:Math.max(n,s,a)+l,y1:Math.min(i,u,o)-l,y2:Math.max(i,u,o)+l};return!(e<c.x1||e>c.x2||t<c.y1||t>c.y2)},_0=function(e,t,n,i){n-=i;var a=t*t-4*e*n;if(a<0)return[];var o=Math.sqrt(a),s=2*e,u=(-t+o)/s,l=(-t-o)/s;return[u,l]},S0=function(e,t,n,i,a){var o=1e-5;e===0&&(e=o),t/=e,n/=e,i/=e;var s,u,l,c,d,f,h,v;if(u=(3*n-t*t)/9,l=-(27*i)+t*(9*n-2*(t*t)),l/=54,s=u*u*u+l*l,a[1]=0,h=t/3,s>0){d=l+Math.sqrt(s),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),f=l-Math.sqrt(s),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),a[0]=-h+d+f,h+=(d+f)/2,a[4]=a[2]=-h,h=Math.sqrt(3)*(-f+d)/2,a[3]=h,a[5]=-h;return}if(a[5]=a[3]=0,s===0){v=l<0?-Math.pow(-l,1/3):Math.pow(l,1/3),a[0]=-h+2*v,a[4]=a[2]=-(v+h);return}u=-u,c=u*u*u,c=Math.acos(l/Math.sqrt(c)),v=2*Math.sqrt(u),a[0]=-h+v*Math.cos(c/3),a[2]=-h+v*Math.cos((c+2*Math.PI)/3),a[4]=-h+v*Math.cos((c+4*Math.PI)/3)},M0=function(e,t,n,i,a,o,s,u){var l=1*n*n-4*n*a+2*n*s+4*a*a-4*a*s+s*s+i*i-4*i*o+2*i*u+4*o*o-4*o*u+u*u,c=1*9*n*a-3*n*n-3*n*s-6*a*a+3*a*s+9*i*o-3*i*i-3*i*u-6*o*o+3*o*u,d=1*3*n*n-6*n*a+n*s-n*e+2*a*a+2*a*e-s*e+3*i*i-6*i*o+i*u-i*t+2*o*o+2*o*t-u*t,f=1*n*a-n*n+n*e-a*e+i*o-i*i+i*t-o*t,h=[];S0(l,c,d,f,h);for(var v=1e-7,p=[],m=0;m<6;m+=2)Math.abs(h[m+1])<v&&h[m]>=0&&h[m]<=1&&p.push(h[m]);p.push(1),p.push(0);for(var g=-1,y,x,S,D=0;D<p.length;D++)y=Math.pow(1-p[D],2)*n+2*(1-p[D])*p[D]*a+p[D]*p[D]*s,x=Math.pow(1-p[D],2)*i+2*(1-p[D])*p[D]*o+p[D]*p[D]*u,S=Math.pow(y-e,2)+Math.pow(x-t,2),g>=0?S<g&&(g=S):g=S;return g},D0=function(e,t,n,i,a,o){var s=[e-n,t-i],u=[a-n,o-i],l=u[0]*u[0]+u[1]*u[1],c=s[0]*s[0]+s[1]*s[1],d=s[0]*u[0]+s[1]*u[1],f=d*d/l;return d<0?c:f>l?(e-a)*(e-a)+(t-o)*(t-o):c-f},wr=function(e,t,n){for(var i,a,o,s,u,l=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(o=n[(c+1)*2],s=n[(c+1)*2+1]):(o=n[(c+1-n.length/2)*2],s=n[(c+1-n.length/2)*2+1]),!(i==e&&o==e))if(i>=e&&e>=o||i<=e&&e<=o)u=(e-i)/(o-i)*(s-a)+a,u>t&&l++;else continue;return l%2!==0},fn=function(e,t,n,i,a,o,s,u,l){var c=new Array(n.length),d;u[0]!=null?(d=Math.atan(u[1]/u[0]),u[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=u;for(var f=Math.cos(-d),h=Math.sin(-d),v=0;v<c.length/2;v++)c[v*2]=o/2*(n[v*2]*f-n[v*2+1]*h),c[v*2+1]=s/2*(n[v*2+1]*f+n[v*2]*h),c[v*2]+=i,c[v*2+1]+=a;var p;if(l>0){var m=zs(c,-l);p=Vs(m)}else p=c;return wr(e,t,p)},A0=function(e,t,n,i,a,o,s,u){for(var l=new Array(n.length*2),c=0;c<u.length;c++){var d=u[c];l[c*4+0]=d.startX,l[c*4+1]=d.startY,l[c*4+2]=d.stopX,l[c*4+3]=d.stopY;var f=Math.pow(d.cx-e,2)+Math.pow(d.cy-t,2);if(f<=Math.pow(d.radius,2))return!0}return wr(e,t,l)},Vs=function(e){for(var t=new Array(e.length/2),n,i,a,o,s,u,l,c,d=0;d<e.length/4;d++){n=e[d*4],i=e[d*4+1],a=e[d*4+2],o=e[d*4+3],d<e.length/4-1?(s=e[(d+1)*4],u=e[(d+1)*4+1],l=e[(d+1)*4+2],c=e[(d+1)*4+3]):(s=e[0],u=e[1],l=e[2],c=e[3]);var f=Ln(n,i,a,o,s,u,l,c,!0);t[d*2]=f[0],t[d*2+1]=f[1]}return t},zs=function(e,t){for(var n=new Array(e.length*2),i,a,o,s,u=0;u<e.length/2;u++){i=e[u*2],a=e[u*2+1],u<e.length/2-1?(o=e[(u+1)*2],s=e[(u+1)*2+1]):(o=e[0],s=e[1]);var l=s-a,c=-(o-i),d=Math.sqrt(l*l+c*c),f=l/d,h=c/d;n[u*4]=i+f*t,n[u*4+1]=a+h*t,n[u*4+2]=o+f*t,n[u*4+3]=s+h*t}return n},P0=function(e,t,n,i,a,o){var s=n-e,u=i-t;s/=a,u/=o;var l=Math.sqrt(s*s+u*u),c=l-1;if(c<0)return[];var d=c/l;return[(n-e)*d+e,(i-t)*d+t]},ni=function(e,t,n,i,a,o,s){return e-=a,t-=o,e/=n/2+s,t/=i/2+s,e*e+t*t<=1},_a=function(e,t,n,i,a,o,s){var u=[n-e,i-t],l=[e-a,t-o],c=u[0]*u[0]+u[1]*u[1],d=2*(l[0]*u[0]+l[1]*u[1]),f=l[0]*l[0]+l[1]*l[1]-s*s,h=d*d-4*c*f;if(h<0)return[];var v=(-d+Math.sqrt(h))/(2*c),p=(-d-Math.sqrt(h))/(2*c),m=Math.min(v,p),g=Math.max(v,p),y=[];if(m>=0&&m<=1&&y.push(m),g>=0&&g<=1&&y.push(g),y.length===0)return[];var x=y[0]*u[0]+e,S=y[0]*u[1]+t;if(y.length>1){if(y[0]==y[1])return[x,S];var D=y[1]*u[0]+e,P=y[1]*u[1]+t;return[x,S,D,P]}else return[x,S]},Ul=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},Ln=function(e,t,n,i,a,o,s,u,l){var c=e-a,d=n-e,f=s-a,h=t-o,v=i-t,p=u-o,m=f*h-p*c,g=d*h-v*c,y=p*d-f*v;if(y!==0){var x=m/y,S=g/y,D=.001,P=0-D,R=1+D;return P<=x&&x<=R&&P<=S&&S<=R?[e+x*d,t+x*v]:l?[e+x*d,t+x*v]:[]}else return m===0||g===0?Ul(e,n,s)===s?[s,u]:Ul(e,n,a)===a?[a,o]:Ul(a,s,n)===n?[n,i]:[]:[]},Fa=function(e,t,n,i,a,o,s,u){var l=[],c,d=new Array(n.length),f=!0;o==null&&(f=!1);var h;if(f){for(var v=0;v<d.length/2;v++)d[v*2]=n[v*2]*o+i,d[v*2+1]=n[v*2+1]*s+a;if(u>0){var p=zs(d,-u);h=Vs(p)}else h=d}else h=n;for(var m,g,y,x,S=0;S<h.length/2;S++)m=h[S*2],g=h[S*2+1],S<h.length/2-1?(y=h[(S+1)*2],x=h[(S+1)*2+1]):(y=h[0],x=h[1]),c=Ln(e,t,i,a,m,g,y,x),c.length!==0&&l.push(c[0],c[1]);return l},R0=function(e,t,n,i,a,o,s,u,l){var c=[],d,f=new Array(n.length*2);l.forEach(function(y,x){x===0?(f[f.length-2]=y.startX,f[f.length-1]=y.startY):(f[x*4-2]=y.startX,f[x*4-1]=y.startY),f[x*4]=y.stopX,f[x*4+1]=y.stopY,d=_a(e,t,i,a,y.cx,y.cy,y.radius),d.length!==0&&c.push(d[0],d[1])});for(var h=0;h<f.length/4;h++)d=Ln(e,t,i,a,f[h*4],f[h*4+1],f[h*4+2],f[h*4+3],!1),d.length!==0&&c.push(d[0],d[1]);if(c.length>2){for(var v=[c[0],c[1]],p=Math.pow(v[0]-e,2)+Math.pow(v[1]-t,2),m=1;m<c.length/2;m++){var g=Math.pow(c[m*2]-e,2)+Math.pow(c[m*2+1]-t,2);g<=p&&(v[0]=c[m*2],v[1]=c[m*2+1],p=g)}return v}return c},ps=function(e,t,n){var i=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),o=(a-n)/a;return o<0&&(o=1e-5),[t[0]+o*i[0],t[1]+o*i[1]]},cr=function(e,t){var n=iu(e,t);return n=nh(n),n},nh=function(e){for(var t,n,i=e.length/2,a=1/0,o=1/0,s=-1/0,u=-1/0,l=0;l<i;l++)t=e[2*l],n=e[2*l+1],a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),u=Math.max(u,n);for(var c=2/(s-a),d=2/(u-o),f=0;f<i;f++)t=e[2*f]=e[2*f]*c,n=e[2*f+1]=e[2*f+1]*d,a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),u=Math.max(u,n);if(o<-1)for(var h=0;h<i;h++)n=e[2*h+1]=e[2*h+1]+(-1-o);return e},iu=function(e,t){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=t;for(var a=new Array(e*2),o,s=0;s<e;s++)o=s*n+i,a[2*s]=Math.cos(o),a[2*s+1]=Math.sin(-o);return a},oi=function(e,t){return Math.min(e/4,t/4,8)},ih=function(e,t){return Math.min(e/10,t/10,8)},Du=function(){return 8},O0=function(e,t,n){return[e-2*t+n,2*(t-e),e]},au=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},L0=Yt({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),I0={pageRank:function(e){for(var t=L0(e),n=t.dampingFactor,i=t.precision,a=t.iterations,o=t.weight,s=this._private.cy,u=this.byGroup(),l=u.nodes,c=u.edges,d=l.length,f=d*d,h=c.length,v=new Array(f),p=new Array(d),m=(1-n)/d,g=0;g<d;g++){for(var y=0;y<d;y++){var x=g*d+y;v[x]=0}p[g]=0}for(var S=0;S<h;S++){var D=c[S],P=D.data("source"),R=D.data("target");if(P!==R){var L=l.indexOfId(P),O=l.indexOfId(R),I=o(D),B=O*d+L;v[B]+=I,p[L]+=I}}for(var w=1/d+m,T=0;T<d;T++)if(p[T]===0)for(var E=0;E<d;E++){var b=E*d+T;v[b]=w}else for(var C=0;C<d;C++){var _=C*d+T;v[_]=v[_]/p[T]+m}for(var M=new Array(d),A=new Array(d),F,N=0;N<d;N++)M[N]=1;for(var z=0;z<a;z++){for(var Y=0;Y<d;Y++)A[Y]=0;for(var U=0;U<d;U++)for(var ee=0;ee<d;ee++){var Q=U*d+ee;A[U]+=v[Q]*M[ee]}g0(A),F=M,M=A,A=F;for(var j=0,K=0;K<d;K++){var H=F[K]-M[K];j+=H*H}if(j<i)break}var k={rank:function($){return $=s.collection($)[0],M[l.indexOf($)]}};return k}},xd=Yt({root:null,weight:function(e){return 1},directed:!1,alpha:0}),ji={degreeCentralityNormalized:function(e){e=xd(e);var t=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},d={},f=0,h=0,v=0;v<i;v++){var p=n[v],m=p.id();e.root=p;var g=this.degreeCentrality(e);f<g.indegree&&(f=g.indegree),h<g.outdegree&&(h=g.outdegree),c[m]=g.indegree,d[m]=g.outdegree}return{indegree:function(x){return f==0?0:(Ue(x)&&(x=t.filter(x)),c[x.id()]/f)},outdegree:function(x){return h===0?0:(Ue(x)&&(x=t.filter(x)),d[x.id()]/h)}}}else{for(var a={},o=0,s=0;s<i;s++){var u=n[s];e.root=u;var l=this.degreeCentrality(e);o<l.degree&&(o=l.degree),a[u.id()]=l.degree}return{degree:function(x){return o===0?0:(Ue(x)&&(x=t.filter(x)),a[x.id()]/o)}}}},degreeCentrality:function(e){e=xd(e);var t=this.cy(),n=this,i=e,a=i.root,o=i.weight,s=i.directed,u=i.alpha;if(a=t.collection(a)[0],s){for(var h=a.connectedEdges(),v=h.filter(function(P){return P.target().same(a)&&n.has(P)}),p=h.filter(function(P){return P.source().same(a)&&n.has(P)}),m=v.length,g=p.length,y=0,x=0,S=0;S<v.length;S++)y+=o(v[S]);for(var D=0;D<p.length;D++)x+=o(p[D]);return{indegree:Math.pow(m,1-u)*Math.pow(y,u),outdegree:Math.pow(g,1-u)*Math.pow(x,u)}}else{for(var l=a.connectedEdges().intersection(n),c=l.length,d=0,f=0;f<l.length;f++)d+=o(l[f]);return{degree:Math.pow(c,1-u)*Math.pow(d,u)}}}};ji.dc=ji.degreeCentrality;ji.dcn=ji.degreeCentralityNormalised=ji.degreeCentralityNormalized;var Ed=Yt({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Hi={closenessCentralityNormalized:function(e){for(var t=Ed(e),n=t.harmonic,i=t.weight,a=t.directed,o=this.cy(),s={},u=0,l=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),d=0;d<l.length;d++){for(var f=0,h=l[d],v=0;v<l.length;v++)if(d!==v){var p=c.distance(h,l[v]);n?f+=1/p:f+=p}n||(f=1/f),u<f&&(u=f),s[h.id()]=f}return{closeness:function(g){return u==0?0:(Ue(g)?g=o.filter(g)[0].id():g=g.id(),s[g]/u)}}},closenessCentrality:function(e){var t=Ed(e),n=t.root,i=t.weight,a=t.directed,o=t.harmonic;n=this.filter(n)[0];for(var s=this.dijkstra({root:n,weight:i,directed:a}),u=0,l=this.nodes(),c=0;c<l.length;c++){var d=l[c];if(!d.same(n)){var f=s.distanceTo(d);o?u+=1/f:u+=f}}return o?u:1/u}};Hi.cc=Hi.closenessCentrality;Hi.ccn=Hi.closenessCentralityNormalised=Hi.closenessCentralityNormalized;var N0=Yt({weight:null,directed:!1}),ou={betweennessCentrality:function(e){for(var t=N0(e),n=t.directed,i=t.weight,a=i!=null,o=this.cy(),s=this.nodes(),u={},l={},c=0,d={set:function(x,S){l[x]=S,S>c&&(c=S)},get:function(x){return l[x]}},f=0;f<s.length;f++){var h=s[f],v=h.id();n?u[v]=h.outgoers().nodes():u[v]=h.openNeighborhood().nodes(),d.set(v,0)}for(var p=function(x){for(var S=s[x].id(),D=[],P={},R={},L={},O=new Ya(function(ee,Q){return L[ee]-L[Q]}),I=0;I<s.length;I++){var B=s[I].id();P[B]=[],R[B]=0,L[B]=1/0}for(R[S]=1,L[S]=0,O.push(S);!O.empty();){var w=O.pop();if(D.push(w),a)for(var T=0;T<u[w].length;T++){var E=u[w][T],b=o.getElementById(w),C=void 0;b.edgesTo(E).length>0?C=b.edgesTo(E)[0]:C=E.edgesTo(b)[0];var _=i(C);E=E.id(),L[E]>L[w]+_&&(L[E]=L[w]+_,O.nodes.indexOf(E)<0?O.push(E):O.updateItem(E),R[E]=0,P[E]=[]),L[E]==L[w]+_&&(R[E]=R[E]+R[w],P[E].push(w))}else for(var M=0;M<u[w].length;M++){var A=u[w][M].id();L[A]==1/0&&(O.push(A),L[A]=L[w]+1),L[A]==L[w]+1&&(R[A]=R[A]+R[w],P[A].push(w))}}for(var F={},N=0;N<s.length;N++)F[s[N].id()]=0;for(;D.length>0;){for(var z=D.pop(),Y=0;Y<P[z].length;Y++){var U=P[z][Y];F[U]=F[U]+R[U]/R[z]*(1+F[z])}z!=s[x].id()&&d.set(z,d.get(z)+F[z])}},m=0;m<s.length;m++)p(m);var g={betweenness:function(x){var S=o.collection(x).id();return d.get(S)},betweennessNormalized:function(x){if(c==0)return 0;var S=o.collection(x).id();return d.get(S)/c}};return g.betweennessNormalised=g.betweennessNormalized,g}};ou.bc=ou.betweennessCentrality;var k0=Yt({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),F0=function(e){return k0(e)},B0=function(e,t){for(var n=0,i=0;i<t.length;i++)n+=t[i](e);return n},V0=function(e,t,n){for(var i=0;i<t;i++)e[i*t+i]=n},ah=function(e,t){for(var n,i=0;i<t;i++){n=0;for(var a=0;a<t;a++)n+=e[a*t+i];for(var o=0;o<t;o++)e[o*t+i]=e[o*t+i]/n}},z0=function(e,t,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var o=0;o<n;o++)i[a*n+o]=0;for(var s=0;s<n;s++)for(var u=0;u<n;u++)i[a*n+u]+=e[a*n+s]*t[s*n+u]}return i},G0=function(e,t,n){for(var i=e.slice(0),a=1;a<n;a++)e=z0(e,i,t);return e},j0=function(e,t,n){for(var i=new Array(t*t),a=0;a<t*t;a++)i[a]=Math.pow(e[a],n);return ah(i,t),i},H0=function(e,t,n,i){for(var a=0;a<n;a++){var o=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),s=Math.round(t[a]*Math.pow(10,i))/Math.pow(10,i);if(o!==s)return!1}return!0},U0=function(e,t,n,i){for(var a=[],o=0;o<t;o++){for(var s=[],u=0;u<t;u++)Math.round(e[o*t+u]*1e3)/1e3>0&&s.push(n[u]);s.length!==0&&a.push(i.collection(s))}return a},$0=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},W0=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&$0(e[t],e[n])&&e.splice(n,1);return e},Td=function(e){for(var t=this.nodes(),n=this.edges(),i=this.cy(),a=F0(e),o={},s=0;s<t.length;s++)o[t[s].id()]=s;for(var u=t.length,l=u*u,c=new Array(l),d,f=0;f<l;f++)c[f]=0;for(var h=0;h<n.length;h++){var v=n[h],p=o[v.source().id()],m=o[v.target().id()],g=B0(v,a.attributes);c[p*u+m]+=g,c[m*u+p]+=g}V0(c,u,a.multFactor),ah(c,u);for(var y=!0,x=0;y&&x<a.maxIterations;)y=!1,d=G0(c,u,a.expandFactor),c=j0(d,u,a.inflateFactor),H0(c,d,l,4)||(y=!0),x++;var S=U0(c,u,t,i);return S=W0(S),S},Y0={markovClustering:Td,mcl:Td},X0=function(e){return e},oh=function(e,t){return Math.abs(t-e)},_d=function(e,t,n){return e+oh(t,n)},Sd=function(e,t,n){return e+Math.pow(n-t,2)},q0=function(e){return Math.sqrt(e)},K0=function(e,t,n){return Math.max(e,oh(t,n))},ma=function(e,t,n,i,a){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:X0,s=i,u,l,c=0;c<e;c++)u=t(c),l=n(c),s=a(s,u,l);return o(s)},Yi={euclidean:function(e,t,n){return e>=2?ma(e,t,n,0,Sd,q0):ma(e,t,n,0,_d)},squaredEuclidean:function(e,t,n){return ma(e,t,n,0,Sd)},manhattan:function(e,t,n){return ma(e,t,n,0,_d)},max:function(e,t,n){return ma(e,t,n,-1/0,K0)}};Yi["squared-euclidean"]=Yi.squaredEuclidean;Yi.squaredeuclidean=Yi.squaredEuclidean;function Qs(r,e,t,n,i,a){var o;return _t(r)?o=r:o=Yi[r]||Yi.euclidean,e===0&&_t(r)?o(i,a):o(e,t,n,i,a)}var Z0=Yt({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Au=function(e){return Z0(e)},Gs=function(e,t,n,i,a){var o=a!=="kMedoids",s=o?function(d){return n[d]}:function(d){return i[d](n)},u=function(f){return i[f](t)},l=n,c=t;return Qs(e,i.length,s,u,l,c)},$l=function(e,t,n){for(var i=n.length,a=new Array(i),o=new Array(i),s=new Array(t),u=null,l=0;l<i;l++)a[l]=e.min(n[l]).value,o[l]=e.max(n[l]).value;for(var c=0;c<t;c++){u=[];for(var d=0;d<i;d++)u[d]=Math.random()*(o[d]-a[d])+a[d];s[c]=u}return s},sh=function(e,t,n,i,a){for(var o=1/0,s=0,u=0;u<t.length;u++){var l=Gs(n,e,t[u],i,a);l<o&&(o=l,s=u)}return s},lh=function(e,t,n){for(var i=[],a=null,o=0;o<t.length;o++)a=t[o],n[a.id()]===e&&i.push(a);return i},Q0=function(e,t,n){return Math.abs(t-e)<=n},J0=function(e,t,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var o=Math.abs(e[i][a]-t[i][a]);if(o>n)return!1}return!0},ey=function(e,t,n){for(var i=0;i<n;i++)if(e===t[i])return!0;return!1},Md=function(e,t){var n=new Array(t);if(e.length<50)for(var i=0;i<t;i++){for(var a=e[Math.floor(Math.random()*e.length)];ey(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var o=0;o<t;o++)n[o]=e[Math.floor(Math.random()*e.length)];return n},Dd=function(e,t,n){for(var i=0,a=0;a<t.length;a++)i+=Gs("manhattan",t[a],e,n,"kMedoids");return i},ty=function(e){var t=this.cy(),n=this.nodes(),i=null,a=Au(e),o=new Array(a.k),s={},u;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,u=$l(n,a.k,a.attributes)):Vt(a.testCentroids)==="object"?u=a.testCentroids:u=$l(n,a.k,a.attributes):u=$l(n,a.k,a.attributes);for(var l=!0,c=0;l&&c<a.maxIterations;){for(var d=0;d<n.length;d++)i=n[d],s[i.id()]=sh(i,u,a.distance,a.attributes,"kMeans");l=!1;for(var f=0;f<a.k;f++){var h=lh(f,n,s);if(h.length!==0){for(var v=a.attributes.length,p=u[f],m=new Array(v),g=new Array(v),y=0;y<v;y++){g[y]=0;for(var x=0;x<h.length;x++)i=h[x],g[y]+=a.attributes[y](i);m[y]=g[y]/h.length,Q0(m[y],p[y],a.sensitivityThreshold)||(l=!0)}u[f]=m,o[f]=t.collection(h)}}c++}return o},ry=function(e){var t=this.cy(),n=this.nodes(),i=null,a=Au(e),o=new Array(a.k),s,u={},l,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Vt(a.testCentroids)==="object"?s=a.testCentroids:s=Md(n,a.k)):s=Md(n,a.k);for(var d=!0,f=0;d&&f<a.maxIterations;){for(var h=0;h<n.length;h++)i=n[h],u[i.id()]=sh(i,s,a.distance,a.attributes,"kMedoids");d=!1;for(var v=0;v<s.length;v++){var p=lh(v,n,u);if(p.length!==0){c[v]=Dd(s[v],p,a.attributes);for(var m=0;m<p.length;m++)l=Dd(p[m],p,a.attributes),l<c[v]&&(c[v]=l,s[v]=p[m],d=!0);o[v]=t.collection(p)}}f++}return o},ny=function(e,t,n,i,a){for(var o,s,u=0;u<t.length;u++)for(var l=0;l<e.length;l++)i[u][l]=Math.pow(n[u][l],a.m);for(var c=0;c<e.length;c++)for(var d=0;d<a.attributes.length;d++){o=0,s=0;for(var f=0;f<t.length;f++)o+=i[f][c]*a.attributes[d](t[f]),s+=i[f][c];e[c][d]=o/s}},iy=function(e,t,n,i,a){for(var o=0;o<e.length;o++)t[o]=e[o].slice();for(var s,u,l,c=2/(a.m-1),d=0;d<n.length;d++)for(var f=0;f<i.length;f++){s=0;for(var h=0;h<n.length;h++)u=Gs(a.distance,i[f],n[d],a.attributes,"cmeans"),l=Gs(a.distance,i[f],n[h],a.attributes,"cmeans"),s+=Math.pow(u/l,c);e[f][d]=1/s}},ay=function(e,t,n,i){for(var a=new Array(n.k),o=0;o<a.length;o++)a[o]=[];for(var s,u,l=0;l<t.length;l++){s=-1/0,u=-1;for(var c=0;c<t[0].length;c++)t[l][c]>s&&(s=t[l][c],u=c);a[u].push(e[l])}for(var d=0;d<a.length;d++)a[d]=i.collection(a[d]);return a},Ad=function(e){var t=this.cy(),n=this.nodes(),i=Au(e),a,o,s,u,l;u=new Array(n.length);for(var c=0;c<n.length;c++)u[c]=new Array(i.k);s=new Array(n.length);for(var d=0;d<n.length;d++)s[d]=new Array(i.k);for(var f=0;f<n.length;f++){for(var h=0,v=0;v<i.k;v++)s[f][v]=Math.random(),h+=s[f][v];for(var p=0;p<i.k;p++)s[f][p]=s[f][p]/h}o=new Array(i.k);for(var m=0;m<i.k;m++)o[m]=new Array(i.attributes.length);l=new Array(n.length);for(var g=0;g<n.length;g++)l[g]=new Array(i.k);for(var y=!0,x=0;y&&x<i.maxIterations;)y=!1,ny(o,n,s,l,i),iy(s,u,o,n,i),J0(s,u,i.sensitivityThreshold)||(y=!0),x++;return a=ay(n,s,i,t),{clusters:a,degreeOfMembership:s}},oy={kMeans:ty,kMedoids:ry,fuzzyCMeans:Ad,fcm:Ad},sy=Yt({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),ly={single:"min",complete:"max"},uy=function(e){var t=sy(e),n=ly[t.linkage];return n!=null&&(t.linkage=n),t},Pd=function(e,t,n,i,a){for(var o=0,s=1/0,u,l=a.attributes,c=function(O,I){return Qs(a.distance,l.length,function(B){return l[B](O)},function(B){return l[B](I)},O,I)},d=0;d<e.length;d++){var f=e[d].key,h=n[f][i[f]];h<s&&(o=f,s=h)}if(a.mode==="threshold"&&s>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=t[o],p=t[i[o]],m;a.mode==="dendrogram"?m={left:v,right:p,key:v.key}:m={value:v.value.concat(p.value),key:v.key},e[v.index]=m,e.splice(p.index,1),t[v.key]=m;for(var g=0;g<e.length;g++){var y=e[g];v.key===y.key?u=1/0:a.linkage==="min"?(u=n[v.key][y.key],n[v.key][y.key]>n[p.key][y.key]&&(u=n[p.key][y.key])):a.linkage==="max"?(u=n[v.key][y.key],n[v.key][y.key]<n[p.key][y.key]&&(u=n[p.key][y.key])):a.linkage==="mean"?u=(n[v.key][y.key]*v.size+n[p.key][y.key]*p.size)/(v.size+p.size):a.mode==="dendrogram"?u=c(y.value,v.value):u=c(y.value[0],v.value[0]),n[v.key][y.key]=n[y.key][v.key]=u}for(var x=0;x<e.length;x++){var S=e[x].key;if(i[S]===v.key||i[S]===p.key){for(var D=S,P=0;P<e.length;P++){var R=e[P].key;n[S][R]<n[S][D]&&(D=R)}i[S]=D}e[x].index=x}return v.key=p.key=v.index=p.index=null,!0},gs=function r(e,t,n){e&&(e.value?t.push(e.value):(e.left&&r(e.left,t),e.right&&r(e.right,t)))},cy=function r(e,t){if(!e)return"";if(e.left&&e.right){var n=r(e.left,t),i=r(e.right,t),a=t.add({group:"nodes",data:{id:n+","+i}});return t.add({group:"edges",data:{source:n,target:a.id()}}),t.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},dy=function r(e,t,n){if(!e)return[];var i=[],a=[],o=[];return t===0?(e.left&&gs(e.left,i),e.right&&gs(e.right,a),o=i.concat(a),[n.collection(o)]):t===1?e.value?[n.collection(e.value)]:(e.left&&gs(e.left,i),e.right&&gs(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=r(e.left,t-1,n)),e.right&&(a=r(e.right,t-1,n)),i.concat(a))},Rd=function(e){for(var t=this.cy(),n=this.nodes(),i=uy(e),a=i.attributes,o=function(x,S){return Qs(i.distance,a.length,function(D){return a[D](x)},function(D){return a[D](S)},x,S)},s=[],u=[],l=[],c=[],d=0;d<n.length;d++){var f={value:i.mode==="dendrogram"?n[d]:[n[d]],key:d,index:d};s[d]=f,c[d]=f,u[d]=[],l[d]=0}for(var h=0;h<s.length;h++)for(var v=0;v<=h;v++){var p=void 0;i.mode==="dendrogram"?p=h===v?1/0:o(s[h].value,s[v].value):p=h===v?1/0:o(s[h].value[0],s[v].value[0]),u[h][v]=p,u[v][h]=p,p<u[h][l[h]]&&(l[h]=v)}for(var m=Pd(s,c,u,l,i);m;)m=Pd(s,c,u,l,i);var g;return i.mode==="dendrogram"?(g=dy(s[0],i.dendrogramDepth,t),i.addDendrogram&&cy(s[0],t)):(g=new Array(s.length),s.forEach(function(y,x){y.key=y.index=null,g[x]=t.collection(y.value)})),g},fy={hierarchicalClustering:Rd,hca:Rd},hy=Yt({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),vy=function(e){var t=e.damping,n=e.preference;.5<=t&&t<1||Tt("Damping must range on [0.5, 1).  Got: ".concat(t));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Ne(n)||Tt("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),hy(e)},py=function(e,t,n,i){var a=function(s,u){return i[u](s)};return-Qs(e,i.length,function(o){return a(t,o)},function(o){return a(n,o)},t,n)},gy=function(e,t){var n=null;return t==="median"?n=v0(e):t==="mean"?n=h0(e):t==="min"?n=d0(e):t==="max"?n=f0(e):n=t,n},my=function(e,t,n){for(var i=[],a=0;a<e;a++)t[a*e+a]+n[a*e+a]>0&&i.push(a);return i},Od=function(e,t,n){for(var i=[],a=0;a<e;a++){for(var o=-1,s=-1/0,u=0;u<n.length;u++){var l=n[u];t[a*e+l]>s&&(o=l,s=t[a*e+l])}o>0&&i.push(o)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},yy=function(e,t,n){for(var i=Od(e,t,n),a=0;a<n.length;a++){for(var o=[],s=0;s<i.length;s++)i[s]===n[a]&&o.push(s);for(var u=-1,l=-1/0,c=0;c<o.length;c++){for(var d=0,f=0;f<o.length;f++)d+=t[o[f]*e+o[c]];d>l&&(u=c,l=d)}n[a]=o[u]}return i=Od(e,t,n),i},Ld=function(e){for(var t=this.cy(),n=this.nodes(),i=vy(e),a={},o=0;o<n.length;o++)a[n[o].id()]=o;var s,u,l,c,d,f;s=n.length,u=s*s,l=new Array(u);for(var h=0;h<u;h++)l[h]=-1/0;for(var v=0;v<s;v++)for(var p=0;p<s;p++)v!==p&&(l[v*s+p]=py(i.distance,n[v],n[p],i.attributes));c=gy(l,i.preference);for(var m=0;m<s;m++)l[m*s+m]=c;d=new Array(u);for(var g=0;g<u;g++)d[g]=0;f=new Array(u);for(var y=0;y<u;y++)f[y]=0;for(var x=new Array(s),S=new Array(s),D=new Array(s),P=0;P<s;P++)x[P]=0,S[P]=0,D[P]=0;for(var R=new Array(s*i.minIterations),L=0;L<R.length;L++)R[L]=0;var O;for(O=0;O<i.maxIterations;O++){for(var I=0;I<s;I++){for(var B=-1/0,w=-1/0,T=-1,E=0,b=0;b<s;b++)x[b]=d[I*s+b],E=f[I*s+b]+l[I*s+b],E>=B?(w=B,B=E,T=b):E>w&&(w=E);for(var C=0;C<s;C++)d[I*s+C]=(1-i.damping)*(l[I*s+C]-B)+i.damping*x[C];d[I*s+T]=(1-i.damping)*(l[I*s+T]-w)+i.damping*x[T]}for(var _=0;_<s;_++){for(var M=0,A=0;A<s;A++)x[A]=f[A*s+_],S[A]=Math.max(0,d[A*s+_]),M+=S[A];M-=S[_],S[_]=d[_*s+_],M+=S[_];for(var F=0;F<s;F++)f[F*s+_]=(1-i.damping)*Math.min(0,M-S[F])+i.damping*x[F];f[_*s+_]=(1-i.damping)*(M-S[_])+i.damping*x[_]}for(var N=0,z=0;z<s;z++){var Y=f[z*s+z]+d[z*s+z]>0?1:0;R[O%i.minIterations*s+z]=Y,N+=Y}if(N>0&&(O>=i.minIterations-1||O==i.maxIterations-1)){for(var U=0,ee=0;ee<s;ee++){D[ee]=0;for(var Q=0;Q<i.minIterations;Q++)D[ee]+=R[Q*s+ee];(D[ee]===0||D[ee]===i.minIterations)&&U++}if(U===s)break}}for(var j=my(s,d,f),K=yy(s,l,j),H={},k=0;k<j.length;k++)H[j[k]]=[];for(var G=0;G<n.length;G++){var $=a[n[G].id()],te=K[$];te!=null&&H[te].push(n[G])}for(var q=new Array(j.length),ge=0;ge<j.length;ge++)q[ge]=t.collection(H[j[ge]]);return q},Cy={affinityPropagation:Ld,ap:Ld},wy=Yt({root:void 0,directed:!1}),by={hierholzer:function(e){if(!ut(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n=wy(e),i=n.root,a=n.directed,o=this,s=!1,u,l,c;i&&(c=Ue(i)?this.filter(i)[0].id():i[0].id());var d={},f={};a?o.forEach(function(y){var x=y.id();if(y.isNode()){var S=y.indegree(!0),D=y.outdegree(!0),P=S-D,R=D-S;P==1?u?s=!0:u=x:R==1?l?s=!0:l=x:(R>1||P>1)&&(s=!0),d[x]=[],y.outgoers().forEach(function(L){L.isEdge()&&d[x].push(L.id())})}else f[x]=[void 0,y.target().id()]}):o.forEach(function(y){var x=y.id();if(y.isNode()){var S=y.degree(!0);S%2&&(u?l?s=!0:l=x:u=x),d[x]=[],y.connectedEdges().forEach(function(D){return d[x].push(D.id())})}else f[x]=[y.source().id(),y.target().id()]});var h={found:!1,trail:void 0};if(s)return h;if(l&&u)if(a){if(c&&l!=c)return h;c=l}else{if(c&&l!=c&&u!=c)return h;c||(c=l)}else c||(c=o[0].id());var v=function(x){for(var S=x,D=[x],P,R,L;d[S].length;)P=d[S].shift(),R=f[P][0],L=f[P][1],S!=L?(d[L]=d[L].filter(function(O){return O!=P}),S=L):!a&&S!=R&&(d[R]=d[R].filter(function(O){return O!=P}),S=R),D.unshift(P),D.unshift(S);return D},p=[],m=[];for(m=v(c);m.length!=1;)d[m[0]].length==0?(p.unshift(o.getElementById(m.shift())),p.unshift(o.getElementById(m.shift()))):m=v(m.shift()).concat(m);p.unshift(o.getElementById(m.shift()));for(var g in d)if(d[g].length)return h;return h.found=!0,h.trail=this.spawn(p,!0),h}},ms=function(){var e=this,t={},n=0,i=0,a=[],o=[],s={},u=function(f,h){for(var v=o.length-1,p=[],m=e.spawn();o[v].x!=f||o[v].y!=h;)p.push(o.pop().edge),v--;p.push(o.pop().edge),p.forEach(function(g){var y=g.connectedNodes().intersection(e);m.merge(g),y.forEach(function(x){var S=x.id(),D=x.connectedEdges().intersection(e);m.merge(x),t[S].cutVertex?m.merge(D.filter(function(P){return P.isLoop()})):m.merge(D)})}),a.push(m)},l=function d(f,h,v){f===v&&(i+=1),t[h]={id:n,low:n++,cutVertex:!1};var p=e.getElementById(h).connectedEdges().intersection(e);if(p.size()===0)a.push(e.spawn(e.getElementById(h)));else{var m,g,y,x;p.forEach(function(S){m=S.source().id(),g=S.target().id(),y=m===h?g:m,y!==v&&(x=S.id(),s[x]||(s[x]=!0,o.push({x:h,y,edge:S})),y in t?t[h].low=Math.min(t[h].low,t[y].id):(d(f,y,h),t[h].low=Math.min(t[h].low,t[y].low),t[h].id<=t[y].low&&(t[h].cutVertex=!0,u(h,y))))})}};e.forEach(function(d){if(d.isNode()){var f=d.id();f in t||(i=0,l(f,f),t[f].cutVertex=i>1)}});var c=Object.keys(t).filter(function(d){return t[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(c),components:a}},xy={hopcroftTarjanBiconnected:ms,htbc:ms,htb:ms,hopcroftTarjanBiconnectedComponents:ms},ys=function(){var e=this,t={},n=0,i=[],a=[],o=e.spawn(e),s=function u(l){a.push(l),t[l]={index:n,low:n++,explored:!1};var c=e.getElementById(l).connectedEdges().intersection(e);if(c.forEach(function(p){var m=p.target().id();m!==l&&(m in t||u(m),t[m].explored||(t[l].low=Math.min(t[l].low,t[m].low)))}),t[l].index===t[l].low){for(var d=e.spawn();;){var f=a.pop();if(d.merge(e.getElementById(f)),t[f].low=t[l].index,t[f].explored=!0,f===l)break}var h=d.edgesWith(d),v=d.merge(h);i.push(v),o=o.difference(v)}};return e.forEach(function(u){if(u.isNode()){var l=u.id();l in t||s(l)}}),{cut:o,components:i}},Ey={tarjanStronglyConnected:ys,tsc:ys,tscc:ys,tarjanStronglyConnectedComponents:ys},uh={};[Na,Jm,e0,r0,i0,o0,u0,I0,ji,Hi,ou,Y0,oy,fy,Cy,by,xy,Ey].forEach(function(r){Ye(uh,r)});var ch=0,dh=1,fh=2,hn=function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.7",this.state=ch,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};hn.prototype={fulfill:function(e){return Id(this,dh,"fulfillValue",e)},reject:function(e){return Id(this,fh,"rejectReason",e)},then:function(e,t){var n=this,i=new hn;return n.onFulfilled.push(kd(e,i,"fulfill")),n.onRejected.push(kd(t,i,"reject")),hh(n),i.proxy}};var Id=function(e,t,n,i){return e.state===ch&&(e.state=t,e[n]=i,hh(e)),e},hh=function(e){e.state===dh?Nd(e,"onFulfilled",e.fulfillValue):e.state===fh&&Nd(e,"onRejected",e.rejectReason)},Nd=function(e,t,n){if(e[t].length!==0){var i=e[t];e[t]=[];var a=function(){for(var s=0;s<i.length;s++)i[s](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},kd=function(e,t,n){return function(i){if(typeof e!="function")t[n].call(t,i);else{var a;try{a=e(i)}catch(o){t.reject(o);return}Ty(t,a)}}},Ty=function r(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Vt(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(t,function(a){i||(i=!0,a===t?e.reject(new TypeError("circular thenable chain")):r(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(t)};hn.all=function(r){return new hn(function(e,t){for(var n=new Array(r.length),i=0,a=function(u,l){n[u]=l,i++,i===r.length&&e(n)},o=0;o<r.length;o++)(function(s){var u=r[s],l=u!=null&&u.then!=null;if(l)u.then(function(d){a(s,d)},function(d){t(d)});else{var c=u;a(s,c)}})(o)})};hn.resolve=function(r){return new hn(function(e,t){e(r)})};hn.reject=function(r){return new hn(function(e,t){t(r)})};var Ki=typeof Promise<"u"?Promise:hn,su=function(e,t,n){var i=bu(e),a=!i,o=this._private=Ye({duration:1e3},t,n);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&_t(o.complete)&&o.completes.push(o.complete),a){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(i){var u=e.pan();o.startPan={x:u.x,y:u.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},si=su.prototype;Ye(si,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,n=e.target._private.animation;e.queue?t=n.queue:t=n.current,t.push(this),Mr(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(l,c){var d=e[l];d!=null&&(e[l]=e[c],e[c]=d)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],o=a.name,s=e.startStyle[o];e.startStyle[o]=a,e.style[i]=s}return t&&this.play(),this},promise:function(e){var t=this._private,n;switch(e){case"frame":n=t.frames;break;default:case"complete":case"completed":n=t.completes}return new Ki(function(i,a){n.push(function(){i()})})}});si.complete=si.completed;si.run=si.play;si.running=si.playing;var _y={animated:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return!1;var o=i[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var o=0;o<i.length;o++){var s=i[o];s._private.animation.queue=[]}return this}},delay:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:t,duration:t,complete:n}):this}},delayAnimation:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:t,duration:t,complete:n}):this}},animation:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this,u=!a,l=!u;if(!s.styleEnabled())return this;var c=s.style();t=Ye({},t,n);var d=Object.keys(t).length===0;if(d)return new su(o[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(l&&(t.style=c.getPropsList(t.style||t.css),t.css=void 0),l&&t.renderedPosition!=null){var f=t.renderedPosition,h=s.pan(),v=s.zoom();t.position=Qf(f,v,h)}if(u&&t.panBy!=null){var p=t.panBy,m=s.pan();t.pan={x:m.x+p.x,y:m.y+p.y}}var g=t.center||t.centre;if(u&&g!=null){var y=s.getCenterPan(g.eles,t.zoom);y!=null&&(t.pan=y)}if(u&&t.fit!=null){var x=t.fit,S=s.getFitViewport(x.eles||x.boundingBox,x.padding);S!=null&&(t.pan=S.pan,t.zoom=S.zoom)}if(u&&ut(t.zoom)){var D=s.getZoomedViewport(t.zoom);D!=null?(D.zoomed&&(t.zoom=D.zoom),D.panned&&(t.pan=D.pan)):t.zoom=null}return new su(o[0],t)}},animate:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;n&&(t=Ye({},t,n));for(var u=0;u<o.length;u++){var l=o[u],c=l.animated()&&(t.queue===void 0||t.queue),d=l.animation(t,c?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var u=0;u<o.length;u++){for(var l=o[u],c=l._private,d=c.animation.current,f=0;f<d.length;f++){var h=d[f],v=h._private;n&&(v.duration=0)}t&&(c.animation.queue=[]),n||(c.animation.current=[])}return s.notify("draw"),this}}},Sy=Array.isArray,Js=Sy,My=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dy=/^\w*$/;function Ay(r,e){if(Js(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||$a(r)?!0:Dy.test(r)||!My.test(r)||e!=null&&r in Object(e)}var Py=Ay,Ry="[object AsyncFunction]",Oy="[object Function]",Ly="[object GeneratorFunction]",Iy="[object Proxy]";function Ny(r){if(!ii(r))return!1;var e=Hf(r);return e==Oy||e==Ly||e==Ry||e==Iy}var ky=Ny,Fy=qs["__core-js_shared__"],Wl=Fy,Fd=function(){var r=/[^.]+$/.exec(Wl&&Wl.keys&&Wl.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function By(r){return!!Fd&&Fd in r}var Vy=By,zy=Function.prototype,Gy=zy.toString;function jy(r){if(r!=null){try{return Gy.call(r)}catch{}try{return r+""}catch{}}return""}var Hy=jy,Uy=/[\\^$.*+?()[\]{}|]/g,$y=/^\[object .+?Constructor\]$/,Wy=Function.prototype,Yy=Object.prototype,Xy=Wy.toString,qy=Yy.hasOwnProperty,Ky=RegExp("^"+Xy.call(qy).replace(Uy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Zy(r){if(!ii(r)||Vy(r))return!1;var e=ky(r)?Ky:$y;return e.test(Hy(r))}var Qy=Zy;function Jy(r,e){return r?.[e]}var e1=Jy;function t1(r,e){var t=e1(r,e);return Qy(t)?t:void 0}var Pu=t1,r1=Pu(Object,"create"),Ba=r1;function n1(){this.__data__=Ba?Ba(null):{},this.size=0}var i1=n1;function a1(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var o1=a1,s1="__lodash_hash_undefined__",l1=Object.prototype,u1=l1.hasOwnProperty;function c1(r){var e=this.__data__;if(Ba){var t=e[r];return t===s1?void 0:t}return u1.call(e,r)?e[r]:void 0}var d1=c1,f1=Object.prototype,h1=f1.hasOwnProperty;function v1(r){var e=this.__data__;return Ba?e[r]!==void 0:h1.call(e,r)}var p1=v1,g1="__lodash_hash_undefined__";function m1(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Ba&&e===void 0?g1:e,this}var y1=m1;function Zi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Zi.prototype.clear=i1;Zi.prototype.delete=o1;Zi.prototype.get=d1;Zi.prototype.has=p1;Zi.prototype.set=y1;var Bd=Zi;function C1(){this.__data__=[],this.size=0}var w1=C1;function b1(r,e){return r===e||r!==r&&e!==e}var vh=b1;function x1(r,e){for(var t=r.length;t--;)if(vh(r[t][0],e))return t;return-1}var el=x1,E1=Array.prototype,T1=E1.splice;function _1(r){var e=this.__data__,t=el(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():T1.call(e,t,1),--this.size,!0}var S1=_1;function M1(r){var e=this.__data__,t=el(e,r);return t<0?void 0:e[t][1]}var D1=M1;function A1(r){return el(this.__data__,r)>-1}var P1=A1;function R1(r,e){var t=this.__data__,n=el(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var O1=R1;function Qi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Qi.prototype.clear=w1;Qi.prototype.delete=S1;Qi.prototype.get=D1;Qi.prototype.has=P1;Qi.prototype.set=O1;var L1=Qi,I1=Pu(qs,"Map"),N1=I1;function k1(){this.size=0,this.__data__={hash:new Bd,map:new(N1||L1),string:new Bd}}var F1=k1;function B1(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var V1=B1;function z1(r,e){var t=r.__data__;return V1(e)?t[typeof e=="string"?"string":"hash"]:t.map}var tl=z1;function G1(r){var e=tl(this,r).delete(r);return this.size-=e?1:0,e}var j1=G1;function H1(r){return tl(this,r).get(r)}var U1=H1;function $1(r){return tl(this,r).has(r)}var W1=$1;function Y1(r,e){var t=tl(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var X1=Y1;function Ji(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Ji.prototype.clear=F1;Ji.prototype.delete=j1;Ji.prototype.get=U1;Ji.prototype.has=W1;Ji.prototype.set=X1;var ph=Ji,q1="Expected a function";function Ru(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(q1);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=r.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(Ru.Cache||ph),t}Ru.Cache=ph;var K1=Ru,Z1=500;function Q1(r){var e=K1(r,function(n){return t.size===Z1&&t.clear(),n}),t=e.cache;return e}var J1=Q1,eC=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tC=/\\(\\)?/g,rC=J1(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(eC,function(t,n,i,a){e.push(i?a.replace(tC,"$1"):n||t)}),e}),gh=rC;function nC(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var mh=nC,iC=1/0,Vd=$i?$i.prototype:void 0,zd=Vd?Vd.toString:void 0;function yh(r){if(typeof r=="string")return r;if(Js(r))return mh(r,yh)+"";if($a(r))return zd?zd.call(r):"";var e=r+"";return e=="0"&&1/r==-iC?"-0":e}var aC=yh;function oC(r){return r==null?"":aC(r)}var Ch=oC;function sC(r,e){return Js(r)?r:Py(r,e)?[r]:gh(Ch(r))}var wh=sC,lC=1/0;function uC(r){if(typeof r=="string"||$a(r))return r;var e=r+"";return e=="0"&&1/r==-lC?"-0":e}var Ou=uC;function cC(r,e){e=wh(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Ou(e[t++])];return t&&t==n?r:void 0}var dC=cC;function fC(r,e,t){var n=r==null?void 0:dC(r,e);return n===void 0?t:n}var hC=fC,vC=function(){try{var r=Pu(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Gd=vC;function pC(r,e,t){e=="__proto__"&&Gd?Gd(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var gC=pC,mC=Object.prototype,yC=mC.hasOwnProperty;function CC(r,e,t){var n=r[e];(!(yC.call(r,e)&&vh(n,t))||t===void 0&&!(e in r))&&gC(r,e,t)}var wC=CC,bC=9007199254740991,xC=/^(?:0|[1-9]\d*)$/;function EC(r,e){var t=typeof r;return e=e??bC,!!e&&(t=="number"||t!="symbol"&&xC.test(r))&&r>-1&&r%1==0&&r<e}var TC=EC;function _C(r,e,t,n){if(!ii(r))return r;e=wh(e,r);for(var i=-1,a=e.length,o=a-1,s=r;s!=null&&++i<a;){var u=Ou(e[i]),l=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(i!=o){var c=s[u];l=n?n(c,u,s):void 0,l===void 0&&(l=ii(c)?c:TC(e[i+1])?[]:{})}wC(s,u,l),s=s[u]}return r}var SC=_C;function MC(r,e,t){return r==null?r:SC(r,e,t)}var DC=MC;function AC(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var PC=AC;function RC(r){return Js(r)?mh(r,Ou):$a(r)?[r]:PC(gh(Ch(r)))}var OC=RC,LC={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Ye({},t,e),function(i,a){var o=e,s=this,u=s.length!==void 0,l=u?s:[s],c=u?s[0]:s;if(Ue(i)){var d=i.indexOf(".")!==-1,f=d&&OC(i);if(o.allowGetting&&a===void 0){var h;return c&&(o.beforeGet(c),f&&c._private[o.field][i]===void 0?h=hC(c._private[o.field],f):h=c._private[o.field][i]),h}else if(o.allowSetting&&a!==void 0){var v=!o.immutableKeys[i];if(v){var p=Of({},i,a);o.beforeSet(s,p);for(var m=0,g=l.length;m<g;m++){var y=l[m];o.canSet(y)&&(f&&c._private[o.field][i]===void 0?DC(y._private[o.field],f,a):y._private[o.field][i]=a)}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&ut(i)){var x=i,S,D,P=Object.keys(x);o.beforeSet(s,x);for(var R=0;R<P.length;R++){S=P[R],D=x[S];var L=!o.immutableKeys[S];if(L)for(var O=0;O<l.length;O++){var I=l[O];o.canSet(I)&&(I._private[o.field][S]=D)}}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&_t(i)){var B=i;s.on(o.bindingEvent,B)}else if(o.allowGetting&&i===void 0){var w;return c&&(o.beforeGet(c),w=c._private[o.field]),w}return s}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ye({},t,e),function(i){var a=e,o=this,s=o.length!==void 0,u=s?o:[o];if(Ue(i)){for(var l=i.split(/\s+/),c=l.length,d=0;d<c;d++){var f=l[d];if(!kn(f)){var h=!a.immutableKeys[f];if(h)for(var v=0,p=u.length;v<p;v++)u[v]._private[a.field][f]=void 0}}a.triggerEvent&&o[a.triggerFnName](a.event)}else if(i===void 0){for(var m=0,g=u.length;m<g;m++)for(var y=u[m]._private[a.field],x=Object.keys(y),S=0;S<x.length;S++){var D=x[S],P=!a.immutableKeys[D];P&&(y[D]=void 0)}a.triggerEvent&&o[a.triggerFnName](a.event)}return o}}},IC={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,i){var a=this,o=Array.prototype.slice.call(arguments,0);return new Ki(function(s,u){var l=function(h){a.off.apply(a,d),s(h)},c=o.concat([l]),d=c.concat([]);a.on.apply(a,c)})}}},dt={};[_y,LC,IC].forEach(function(r){Ye(dt,r)});var NC={animate:dt.animate(),animation:dt.animation(),animated:dt.animated(),clearQueue:dt.clearQueue(),delay:dt.delay(),delayAnimation:dt.delayAnimation(),stop:dt.stop()},As={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(v){return n.push(v)}),n}else gt(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new qi(e),o=0;o<t.length;o++){for(var s=t[o],u=s._private,l=u.classes,c=!1,d=0;d<e.length;d++){var f=e[d],h=l.has(f);if(!h){c=!0;break}}c||(c=l.size!==e.length),c&&(u.classes=a,i.push(s))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){gt(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=t===void 0,a=[],o=0,s=n.length;o<s;o++)for(var u=n[o],l=u._private.classes,c=!1,d=0;d<e.length;d++){var f=e[d],h=l.has(f),v=!1;t||i&&!h?(l.add(f),v=!0):(!t||i&&h)&&(l.delete(f),v=!0),!c&&v&&(a.push(u),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};As.className=As.classNames=As.classes;var lt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Bt,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};lt.variable="(?:[\\w-.]|(?:\\\\"+lt.metaChar+"))+";lt.className="(?:[\\w-]|(?:\\\\"+lt.metaChar+"))+";lt.value=lt.string+"|"+lt.number;lt.id=lt.variable;(function(){var r,e,t;for(r=lt.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],lt.comparatorOp+="|@"+e;for(r=lt.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(lt.comparatorOp+="|\\!"+e)})();var ht=function(){return{checks:[]}},je={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},lu=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return Xg(r.selector,e.selector)}),kC=function(){for(var r={},e,t=0;t<lu.length;t++)e=lu[t],r[e.selector]=e.matches;return r}(),FC=function(e,t){return kC[e](t)},BC="("+lu.map(function(r){return r.selector}).join("|")+")",Li=function(e){return e.replace(new RegExp("\\\\("+lt.metaChar+")","g"),function(t,n){return n})},Rn=function(e,t,n){e[e.length-1]=n},uu=[{name:"group",query:!0,regex:"("+lt.group+")",populate:function(e,t,n){var i=kt(n,1),a=i[0];t.checks.push({type:je.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:BC,populate:function(e,t,n){var i=kt(n,1),a=i[0];t.checks.push({type:je.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+lt.id+")",populate:function(e,t,n){var i=kt(n,1),a=i[0];t.checks.push({type:je.ID,value:Li(a)})}},{name:"className",query:!0,regex:"\\.("+lt.className+")",populate:function(e,t,n){var i=kt(n,1),a=i[0];t.checks.push({type:je.CLASS,value:Li(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+lt.variable+")\\s*\\]",populate:function(e,t,n){var i=kt(n,1),a=i[0];t.checks.push({type:je.DATA_EXIST,field:Li(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+lt.variable+")\\s*("+lt.comparatorOp+")\\s*("+lt.value+")\\s*\\]",populate:function(e,t,n){var i=kt(n,3),a=i[0],o=i[1],s=i[2],u=new RegExp("^"+lt.string+"$").exec(s)!=null;u?s=s.substring(1,s.length-1):s=parseFloat(s),t.checks.push({type:je.DATA_COMPARE,field:Li(a),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+lt.boolOp+")\\s*("+lt.variable+")\\s*\\]",populate:function(e,t,n){var i=kt(n,2),a=i[0],o=i[1];t.checks.push({type:je.DATA_BOOL,field:Li(o),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+lt.meta+")\\s*("+lt.comparatorOp+")\\s*("+lt.number+")\\s*\\]\\]",populate:function(e,t,n){var i=kt(n,3),a=i[0],o=i[1],s=i[2];t.checks.push({type:je.META_COMPARE,field:Li(a),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:lt.separator,populate:function(e,t){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,o=e[e.length-1];n!=null&&(o.subject=n,e.currentSubject=null),o.edgeCount=i,o.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var s=e[e.length++]=ht();return s}},{name:"directedEdge",separator:!0,regex:lt.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n=ht(),i=t,a=ht();return n.checks.push({type:je.DIRECTED_EDGE,source:i,target:a}),Rn(e,t,n),e.edgeCount++,a}else{var o=ht(),s=t,u=ht();return o.checks.push({type:je.NODE_SOURCE,source:s,target:u}),Rn(e,t,o),e.edgeCount++,u}}},{name:"undirectedEdge",separator:!0,regex:lt.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n=ht(),i=t,a=ht();return n.checks.push({type:je.UNDIRECTED_EDGE,nodes:[i,a]}),Rn(e,t,n),e.edgeCount++,a}else{var o=ht(),s=t,u=ht();return o.checks.push({type:je.NODE_NEIGHBOR,node:s,neighbor:u}),Rn(e,t,o),u}}},{name:"child",separator:!0,regex:lt.child,populate:function(e,t){if(e.currentSubject==null){var n=ht(),i=ht(),a=e[e.length-1];return n.checks.push({type:je.CHILD,parent:a,child:i}),Rn(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=ht(),s=e[e.length-1],u=ht(),l=ht(),c=ht(),d=ht();return o.checks.push({type:je.COMPOUND_SPLIT,left:s,right:u,subject:l}),l.checks=t.checks,t.checks=[{type:je.TRUE}],d.checks.push({type:je.TRUE}),u.checks.push({type:je.PARENT,parent:d,child:c}),Rn(e,s,o),e.currentSubject=l,e.compoundCount++,c}else{var f=ht(),h=ht(),v=[{type:je.PARENT,parent:f,child:h}];return f.checks=t.checks,t.checks=v,e.compoundCount++,h}}},{name:"descendant",separator:!0,regex:lt.descendant,populate:function(e,t){if(e.currentSubject==null){var n=ht(),i=ht(),a=e[e.length-1];return n.checks.push({type:je.DESCENDANT,ancestor:a,descendant:i}),Rn(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=ht(),s=e[e.length-1],u=ht(),l=ht(),c=ht(),d=ht();return o.checks.push({type:je.COMPOUND_SPLIT,left:s,right:u,subject:l}),l.checks=t.checks,t.checks=[{type:je.TRUE}],d.checks.push({type:je.TRUE}),u.checks.push({type:je.ANCESTOR,ancestor:d,descendant:c}),Rn(e,s,o),e.currentSubject=l,e.compoundCount++,c}else{var f=ht(),h=ht(),v=[{type:je.ANCESTOR,ancestor:f,descendant:h}];return f.checks=t.checks,t.checks=v,e.compoundCount++,h}}},{name:"subject",modifier:!0,regex:lt.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return ft("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===je.DIRECTED_EDGE?i.type=je.NODE_TARGET:a===je.UNDIRECTED_EDGE&&(i.type=je.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];uu.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var VC=function(e){for(var t,n,i,a=0;a<uu.length;a++){var o=uu[a],s=o.name,u=e.match(o.regexObj);if(u!=null){n=u,t=o,i=s;var l=u[0];e=e.substring(l.length);break}}return{expr:t,match:n,name:i,remaining:e}},zC=function(e){var t=e.match(/^\s+/);if(t){var n=t[0];e=e.substring(n.length)}return e},GC=function(e){var t=this,n=t.inputText=e,i=t[0]=ht();for(t.length=1,n=zC(n);;){var a=VC(n);if(a.expr==null)return ft("The selector `"+e+"`is invalid"),!1;var o=a.match.slice(1),s=a.expr.populate(t,i,o);if(s===!1)return!1;if(s!=null&&(i=s),n=a.remaining,n.match(/^\s*$/))break}var u=t[t.length-1];t.currentSubject!=null&&(u.subject=t.currentSubject),u.edgeCount=t.edgeCount,u.compoundCount=t.compoundCount;for(var l=0;l<t.length;l++){var c=t[l];if(c.compoundCount>0&&c.edgeCount>0)return ft("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return ft("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&ft("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},jC=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},t=function(c){return Ue(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,d){var f=c.type,h=c.value;switch(f){case je.GROUP:{var v=e(h);return v.substring(0,v.length-1)}case je.DATA_COMPARE:{var p=c.field,m=c.operator;return"["+p+n(e(m))+t(h)+"]"}case je.DATA_BOOL:{var g=c.operator,y=c.field;return"["+e(g)+y+"]"}case je.DATA_EXIST:{var x=c.field;return"["+x+"]"}case je.META_COMPARE:{var S=c.operator,D=c.field;return"[["+D+n(e(S))+t(h)+"]]"}case je.STATE:return h;case je.ID:return"#"+h;case je.CLASS:return"."+h;case je.PARENT:case je.CHILD:return a(c.parent,d)+n(">")+a(c.child,d);case je.ANCESTOR:case je.DESCENDANT:return a(c.ancestor,d)+" "+a(c.descendant,d);case je.COMPOUND_SPLIT:{var P=a(c.left,d),R=a(c.subject,d),L=a(c.right,d);return P+(P.length>0?" ":"")+R+L}case je.TRUE:return""}},a=function(c,d){return c.checks.reduce(function(f,h,v){return f+(d===c&&v===0?"$":"")+i(h,d)},"")},o="",s=0;s<this.length;s++){var u=this[s];o+=a(u,u.subject),this.length>1&&s<this.length-1&&(o+=", ")}return this.toStringCache=o,o},HC={parse:GC,toString:jC},bh=function(e,t,n){var i,a=Ue(e),o=Ne(e),s=Ue(n),u,l,c=!1,d=!1,f=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(a||s||c)&&(u=!a&&!o?"":""+e,l=""+n),c&&(e=u=u.toLowerCase(),n=l=l.toLowerCase()),t){case"*=":i=u.indexOf(l)>=0;break;case"$=":i=u.indexOf(l,u.length-l.length)>=0;break;case"^=":i=u.indexOf(l)===0;break;case"=":i=e===n;break;case">":f=!0,i=e>n;break;case">=":f=!0,i=e>=n;break;case"<":f=!0,i=e<n;break;case"<=":f=!0,i=e<=n;break;default:i=!1;break}return d&&(e!=null||!f)&&(i=!i),i},UC=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},$C=function(e){return e!==void 0},Lu=function(e,t){return e.data(t)},WC=function(e,t){return e[t]()},Dt=[],wt=function(e,t){return e.checks.every(function(n){return Dt[n.type](n,t)})};Dt[je.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};Dt[je.STATE]=function(r,e){var t=r.value;return FC(t,e)};Dt[je.ID]=function(r,e){var t=r.value;return e.id()===t};Dt[je.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};Dt[je.META_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return bh(WC(e,t),n,i)};Dt[je.DATA_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return bh(Lu(e,t),n,i)};Dt[je.DATA_BOOL]=function(r,e){var t=r.field,n=r.operator;return UC(Lu(e,t),n)};Dt[je.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,$C(Lu(e,t))};Dt[je.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],n=r.nodes[1],i=e.source(),a=e.target();return wt(t,i)&&wt(n,a)||wt(n,i)&&wt(t,a)};Dt[je.NODE_NEIGHBOR]=function(r,e){return wt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&wt(r.neighbor,t)})};Dt[je.DIRECTED_EDGE]=function(r,e){return wt(r.source,e.source())&&wt(r.target,e.target())};Dt[je.NODE_SOURCE]=function(r,e){return wt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&wt(r.target,t)})};Dt[je.NODE_TARGET]=function(r,e){return wt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&wt(r.source,t)})};Dt[je.CHILD]=function(r,e){return wt(r.child,e)&&wt(r.parent,e.parent())};Dt[je.PARENT]=function(r,e){return wt(r.parent,e)&&e.children().some(function(t){return wt(r.child,t)})};Dt[je.DESCENDANT]=function(r,e){return wt(r.descendant,e)&&e.ancestors().some(function(t){return wt(r.ancestor,t)})};Dt[je.ANCESTOR]=function(r,e){return wt(r.ancestor,e)&&e.descendants().some(function(t){return wt(r.descendant,t)})};Dt[je.COMPOUND_SPLIT]=function(r,e){return wt(r.subject,e)&&wt(r.left,e)&&wt(r.right,e)};Dt[je.TRUE]=function(){return!0};Dt[je.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};Dt[je.FILTER]=function(r,e){var t=r.value;return t(e)};var YC=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===je.ID)return e.getElementById(t[0].checks[0].value).collection();var n=function(a){for(var o=0;o<t.length;o++){var s=t[o];if(wt(s,a))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)},XC=function(e){for(var t=this,n=0;n<t.length;n++){var i=t[n];if(wt(i,e))return!0}return!1},qC={matches:XC,filter:YC},Vn=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Ue(e)&&e.match(/^\s*$/)||(Mr(e)?this.addQuery({checks:[{type:je.COLLECTION,value:e.collection()}]}):_t(e)?this.addQuery({checks:[{type:je.FILTER,value:e}]}):Ue(e)?this.parse(e)||(this.invalid=!0):Tt("A selector must be created from a string; found "))},zn=Vn.prototype;[HC,qC].forEach(function(r){return Ye(zn,r)});zn.text=function(){return this.inputText};zn.size=function(){return this.length};zn.eq=function(r){return this[r]};zn.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};zn.addQuery=function(r){this[this.length++]=r};zn.selector=zn.toString;var In={allAre:function(e){var t=new Vn(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new Vn(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,n=e.length;return t!==n?!1:t===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};In.allAreNeighbours=In.allAreNeighbors;In.has=In.contains;In.equal=In.equals=In.same;var Rr=function(e,t){return function(i,a,o,s){var u=i,l=this,c;if(u==null?c="":Mr(u)&&u.length===1&&(c=u.id()),l.length===1&&c){var d=l[0]._private,f=d.traversalCache=d.traversalCache||{},h=f[t]=f[t]||[],v=Fn(c),p=h[v];return p||(h[v]=e.call(l,i,a,o,s))}else return e.call(l,i,a,o,s)}},Xi={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],o=a._private.parent;o&&t.push(o)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];t.push(a)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var i=this[n],a=i.parents();t=t||a,t=t.intersect(a)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:Rr(function(r){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function n(i){for(var a=0;a<i.length;a++){var o=i[a];t.push(o),o.children().nonempty()&&n(o.children())}}return n(this.children()),this.spawn(t,!0).filter(e)}};function Iu(r,e,t,n){for(var i=[],a=new qi,o=r.cy(),s=o.hasCompoundNodes(),u=0;u<r.length;u++){var l=r[u];t?i.push(l):s&&n(i,a,l)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),s&&n(i,a,c)}return r}function xh(r,e,t){if(t.isParent())for(var n=t._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||r.push(a)}}Xi.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Iu(this,r,e,xh)};function Eh(r,e,t){if(t.isChild()){var n=t._private.parent;e.has(n.id())||r.push(n)}}Xi.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Iu(this,r,e,Eh)};function KC(r,e,t){Eh(r,e,t),xh(r,e,t)}Xi.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Iu(this,r,e,KC)};Xi.ancestors=Xi.parents;var Va,Th;Va=Th={data:dt.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:dt.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:dt.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:dt.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:dt.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:dt.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Va.attr=Va.data;Va.removeAttr=Va.removeData;var ZC=Th,rl={};function Yl(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var n=0,i=t[0],a=i._private.edges,o=0;o<a.length;o++){var s=a[o];!e&&s.isLoop()||(n+=r(i,s))}return n}else return}}Ye(rl,{degree:Yl(function(r,e){return e.source().same(e.target())?2:1}),indegree:Yl(function(r,e){return e.target().same(r)?1:0}),outdegree:Yl(function(r,e){return e.source().same(r)?1:0})});function Ii(r,e){return function(t){for(var n,i=this.nodes(),a=0;a<i.length;a++){var o=i[a],s=o[r](t);s!==void 0&&(n===void 0||e(s,n))&&(n=s)}return n}}Ye(rl,{minDegree:Ii("degree",function(r,e){return r<e}),maxDegree:Ii("degree",function(r,e){return r>e}),minIndegree:Ii("indegree",function(r,e){return r<e}),maxIndegree:Ii("indegree",function(r,e){return r>e}),minOutdegree:Ii("outdegree",function(r,e){return r<e}),maxOutdegree:Ii("outdegree",function(r,e){return r>e})});Ye(rl,{totalDegree:function(e){for(var t=0,n=this.nodes(),i=0;i<n.length;i++)t+=n[i].degree(e);return t}});var Gr,_h,Sh=function(e,t,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var o=a._private.position,s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};a.isParent()&&!(s.x===0&&s.y===0)&&a.children().shift(s,n),a.dirtyBoundingBoxCache()}}},jd={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){Sh(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Gr=_h={position:dt.data(jd),silentPosition:dt.data(Ye({},jd,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){Sh(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(ut(e))t?this.silentPosition(e):this.position(e);else if(_t(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var o=this[a],s=void 0;(s=n(o,a))&&(t?o.silentPosition(s):o.position(s))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var i;if(ut(e)?(i={x:Ne(e.x)?e.x:0,y:Ne(e.y)?e.y:0},n=t):Ue(e)&&Ne(t)&&(i={x:0,y:0},i[e]=t),i!=null){var a=this.cy();a.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(a.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var u=s.position(),l={x:u.x+i.x,y:u.y+i.y};n?s.silentPosition(l):s.position(l)}}a.endBatch()}return this},silentShift:function(e,t){return ut(e)?this.shift(e,!0):Ue(e)&&Ne(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],i=this.cy(),a=i.zoom(),o=i.pan(),s=ut(e)?e:void 0,u=s!==void 0||t!==void 0&&Ue(e);if(n&&n.isNode())if(u)for(var l=0;l<this.length;l++){var c=this[l];t!==void 0?c.position(e,(t-o[e])/a):s!==void 0&&c.position(Qf(s,a,o))}else{var d=n.position();return s=Zs(d,a,o),e===void 0?s:s[e]}else if(!u)return;return this},relativePosition:function(e,t){var n=this[0],i=this.cy(),a=ut(e)?e:void 0,o=a!==void 0||t!==void 0&&Ue(e),s=i.hasCompoundNodes();if(n&&n.isNode())if(o)for(var u=0;u<this.length;u++){var l=this[u],c=s?l.parent():null,d=c&&c.length>0,f=d;d&&(c=c[0]);var h=f?c.position():{x:0,y:0};t!==void 0?l.position(e,t+h[e]):a!==void 0&&l.position({x:a.x+h.x,y:a.y+h.y})}else{var v=n.position(),p=s?n.parent():null,m=p&&p.length>0,g=m;m&&(p=p[0]);var y=g?p.position():{x:0,y:0};return a={x:v.x-y.x,y:v.y-y.y},e===void 0?a:a[e]}else if(!o)return;return this}};Gr.modelPosition=Gr.point=Gr.position;Gr.modelPositions=Gr.points=Gr.positions;Gr.renderedPoint=Gr.renderedPosition;Gr.relativePoint=Gr.relativePosition;var QC=_h,Ui,Un;Ui=Un={};Un.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),n=t.zoom(),i=t.pan(),a=e.x1*n+i.x,o=e.x2*n+i.x,s=e.y1*n+i.y,u=e.y2*n+i.y;return{x1:a,x2:o,y1:s,y2:u,w:o-a,h:u-s}};Un.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var n=t._private;n.compoundBoundsClean=!1,n.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};Un.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(o){if(!o.isParent())return;var s=o._private,u=o.children(),l=o.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=u.boundingBox({includeLabels:l,includeOverlays:!1,useCache:!1}),f=s.position;(d.w===0||d.h===0)&&(d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},d.x1=f.x-d.w/2,d.x2=f.x+d.w/2,d.y1=f.y-d.h/2,d.y2=f.y+d.h/2);function h(O,I,B){var w=0,T=0,E=I+B;return O>0&&E>0&&(w=I/E*O,T=B/E*O),{biasDiff:w,biasComplementDiff:T}}function v(O,I,B,w){if(B.units==="%")switch(w){case"width":return O>0?B.pfValue*O:0;case"height":return I>0?B.pfValue*I:0;case"average":return O>0&&I>0?B.pfValue*(O+I)/2:0;case"min":return O>0&&I>0?O>I?B.pfValue*I:B.pfValue*O:0;case"max":return O>0&&I>0?O>I?B.pfValue*O:B.pfValue*I:0;default:return 0}else return B.units==="px"?B.pfValue:0}var p=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(p=p*100/c.width.val);var m=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var g=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(g=g*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var x=h(c.width.val-d.w,p,m),S=x.biasDiff,D=x.biasComplementDiff,P=h(c.height.val-d.h,g,y),R=P.biasDiff,L=P.biasComplementDiff;s.autoPadding=v(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(d.w,c.width.val),f.x=(-S+d.x1+d.x2+D)/2,s.autoHeight=Math.max(d.h,c.height.val),f.y=(-R+d.y1+d.y2+L)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||r)&&(t(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var Pr=function(e){return e===1/0||e===-1/0?0:e},Vr=function(e,t,n,i,a){i-t===0||a-n===0||t==null||n==null||i==null||a==null||(e.x1=t<e.x1?t:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},ei=function(e,t){return t==null?e:Vr(e,t.x1,t.y1,t.x2,t.y2)},ya=function(e,t,n){return zr(e,t,n)},Cs=function(e,t,n){if(!t.cy().headless()){var i=t._private,a=i.rstyle,o=a.arrowWidth/2,s=t.pstyle(n+"-arrow-shape").value,u,l;if(s!=="none"){n==="source"?(u=a.srcX,l=a.srcY):n==="target"?(u=a.tgtX,l=a.tgtY):(u=a.midX,l=a.midY);var c=i.arrowBounds=i.arrowBounds||{},d=c[n]=c[n]||{};d.x1=u-o,d.y1=l-o,d.x2=u+o,d.y2=l+o,d.w=d.x2-d.x1,d.h=d.y2-d.y1,Ms(d,1),Vr(e,d.x1,d.y1,d.x2,d.y2)}}},Xl=function(e,t,n){if(!t.cy().headless()){var i;n?i=n+"-":i="";var a=t._private,o=a.rstyle,s=t.pstyle(i+"label").strValue;if(s){var u=t.pstyle("text-halign"),l=t.pstyle("text-valign"),c=ya(o,"labelWidth",n),d=ya(o,"labelHeight",n),f=ya(o,"labelX",n),h=ya(o,"labelY",n),v=t.pstyle(i+"text-margin-x").pfValue,p=t.pstyle(i+"text-margin-y").pfValue,m=t.isEdge(),g=t.pstyle(i+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,x=t.pstyle("text-border-width").pfValue,S=x/2,D=t.pstyle("text-background-padding").pfValue,P=2,R=d,L=c,O=L/2,I=R/2,B,w,T,E;if(m)B=f-O,w=f+O,T=h-I,E=h+I;else{switch(u.value){case"left":B=f-L,w=f;break;case"center":B=f-O,w=f+O;break;case"right":B=f,w=f+L;break}switch(l.value){case"top":T=h-R,E=h;break;case"center":T=h-I,E=h+I;break;case"bottom":T=h,E=h+R;break}}var b=v-Math.max(y,S)-D-P,C=v+Math.max(y,S)+D+P,_=p-Math.max(y,S)-D-P,M=p+Math.max(y,S)+D+P;B+=b,w+=C,T+=_,E+=M;var A=n||"main",F=a.labelBounds,N=F[A]=F[A]||{};N.x1=B,N.y1=T,N.x2=w,N.y2=E,N.w=w-B,N.h=E-T,N.leftPad=b,N.rightPad=C,N.topPad=_,N.botPad=M;var z=m&&g.strValue==="autorotate",Y=g.pfValue!=null&&g.pfValue!==0;if(z||Y){var U=z?ya(a.rstyle,"labelAngle",n):g.pfValue,ee=Math.cos(U),Q=Math.sin(U),j=(B+w)/2,K=(T+E)/2;if(!m){switch(u.value){case"left":j=w;break;case"right":j=B;break}switch(l.value){case"top":K=E;break;case"bottom":K=T;break}}var H=function(he,ue){return he=he-j,ue=ue-K,{x:he*ee-ue*Q+j,y:he*Q+ue*ee+K}},k=H(B,T),G=H(B,E),$=H(w,T),te=H(w,E);B=Math.min(k.x,G.x,$.x,te.x),w=Math.max(k.x,G.x,$.x,te.x),T=Math.min(k.y,G.y,$.y,te.y),E=Math.max(k.y,G.y,$.y,te.y)}var q=A+"Rot",ge=F[q]=F[q]||{};ge.x1=B,ge.y1=T,ge.x2=w,ge.y2=E,ge.w=w-B,ge.h=E-T,Vr(e,B,T,w,E),Vr(a.labelBounds.all,B,T,w,E)}return e}},JC=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,i=t.pstyle("outline-width").value;if(n>0&&i>0){var a=t.pstyle("outline-offset").value,o=t.pstyle("shape").value,s=i+a,u=(e.w+s*2)/e.w,l=(e.h+s*2)/e.h,c=0,d=0;["diamond","pentagon","round-triangle"].includes(o)?(u=(e.w+s*2.4)/e.w,d=-s/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(o)?u=(e.w+s*2.4)/e.w:o==="star"?(u=(e.w+s*2.8)/e.w,l=(e.h+s*2.6)/e.h,d=-s/3.8):o==="triangle"?(u=(e.w+s*2.8)/e.w,l=(e.h+s*2.4)/e.h,d=-s/1.4):o==="vee"&&(u=(e.w+s*4.4)/e.w,l=(e.h+s*3.8)/e.h,d=-s*.5);var f=e.h*l-e.h,h=e.w*u-e.w;if(Ds(e,[Math.ceil(f/2),Math.ceil(h/2)]),c!=0||d!==0){var v=w0(e,c,d);eh(e,v)}}}},ew=function(e,t){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),o=br(),s=e._private,u=e.isNode(),l=e.isEdge(),c,d,f,h,v,p,m=s.rstyle,g=u&&i?e.pstyle("bounds-expansion").pfValue:[0],y=function(Te){return Te.pstyle("display").value!=="none"},x=!i||y(e)&&(!l||y(e.source())&&y(e.target()));if(x){var S=0,D=0;i&&t.includeOverlays&&(S=e.pstyle("overlay-opacity").value,S!==0&&(D=e.pstyle("overlay-padding").value));var P=0,R=0;i&&t.includeUnderlays&&(P=e.pstyle("underlay-opacity").value,P!==0&&(R=e.pstyle("underlay-padding").value));var L=Math.max(D,R),O=0,I=0;if(i&&(O=e.pstyle("width").pfValue,I=O/2),u&&t.includeNodes){var B=e.position();v=B.x,p=B.y;var w=e.outerWidth(),T=w/2,E=e.outerHeight(),b=E/2;c=v-T,d=v+T,f=p-b,h=p+b,Vr(o,c,f,d,h),i&&t.includeOutlines&&JC(o,e)}else if(l&&t.includeEdges)if(i&&!a){var C=e.pstyle("curve-style").strValue;if(c=Math.min(m.srcX,m.midX,m.tgtX),d=Math.max(m.srcX,m.midX,m.tgtX),f=Math.min(m.srcY,m.midY,m.tgtY),h=Math.max(m.srcY,m.midY,m.tgtY),c-=I,d+=I,f-=I,h+=I,Vr(o,c,f,d,h),C==="haystack"){var _=m.haystackPts;if(_&&_.length===2){if(c=_[0].x,f=_[0].y,d=_[1].x,h=_[1].y,c>d){var M=c;c=d,d=M}if(f>h){var A=f;f=h,h=A}Vr(o,c-I,f-I,d+I,h+I)}}else if(C==="bezier"||C==="unbundled-bezier"||C.endsWith("segments")||C.endsWith("taxi")){var F;switch(C){case"bezier":case"unbundled-bezier":F=m.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":F=m.linePts;break}if(F!=null)for(var N=0;N<F.length;N++){var z=F[N];c=z.x-I,d=z.x+I,f=z.y-I,h=z.y+I,Vr(o,c,f,d,h)}}}else{var Y=e.source(),U=Y.position(),ee=e.target(),Q=ee.position();if(c=U.x,d=Q.x,f=U.y,h=Q.y,c>d){var j=c;c=d,d=j}if(f>h){var K=f;f=h,h=K}c-=I,d+=I,f-=I,h+=I,Vr(o,c,f,d,h)}if(i&&t.includeEdges&&l&&(Cs(o,e,"mid-source"),Cs(o,e,"mid-target"),Cs(o,e,"source"),Cs(o,e,"target")),i){var H=e.pstyle("ghost").value==="yes";if(H){var k=e.pstyle("ghost-offset-x").pfValue,G=e.pstyle("ghost-offset-y").pfValue;Vr(o,o.x1+k,o.y1+G,o.x2+k,o.y2+G)}}var $=s.bodyBounds=s.bodyBounds||{};bd($,o),Ds($,g),Ms($,1),i&&(c=o.x1,d=o.x2,f=o.y1,h=o.y2,Vr(o,c-L,f-L,d+L,h+L));var te=s.overlayBounds=s.overlayBounds||{};bd(te,o),Ds(te,g),Ms(te,1);var q=s.labelBounds=s.labelBounds||{};q.all!=null?C0(q.all):q.all=br(),i&&t.includeLabels&&(t.includeMainLabels&&Xl(o,e,null),l&&(t.includeSourceLabels&&Xl(o,e,"source"),t.includeTargetLabels&&Xl(o,e,"target")))}return o.x1=Pr(o.x1),o.y1=Pr(o.y1),o.x2=Pr(o.x2),o.y2=Pr(o.y2),o.w=Pr(o.x2-o.x1),o.h=Pr(o.y2-o.y1),o.w>0&&o.h>0&&x&&(Ds(o,g),Ms(o,1)),o},Mh=function(e){var t=0,n=function(o){return(o?1:0)<<t++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},Dh=function(e){if(e.isEdge()){var t=e.source().position(),n=e.target().position(),i=function(o){return Math.round(o)};return zm([i(t.x),i(t.y),i(n.x),i(n.y)])}else return 0},Hd=function(e,t){var n=e._private,i,a=e.isEdge(),o=t==null?Ud:Mh(t),s=o===Ud,u=Dh(e),l=n.bbCachePosKey===u,c=t.useCache&&l,d=function(p){return p._private.bbCache==null||p._private.styleDirty},f=!c||d(e)||a&&(d(e.source())||d(e.target()));if(f?(l||e.recalculateRenderedStyle(c),i=ew(e,za),n.bbCache=i,n.bbCachePosKey=u):i=n.bbCache,!s){var h=e.isNode();i=br(),(t.includeNodes&&h||t.includeEdges&&!h)&&(t.includeOverlays?ei(i,n.overlayBounds):ei(i,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?ei(i,n.labelBounds.all):(t.includeMainLabels&&ei(i,n.labelBounds.mainRot),t.includeSourceLabels&&ei(i,n.labelBounds.sourceRot),t.includeTargetLabels&&ei(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},za={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},Ud=Mh(za),$d=Yt(za);Un.boundingBox=function(r){var e;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(r===void 0||r.useCache===void 0||r.useCache===!0))r===void 0?r=za:r=$d(r),e=Hd(this[0],r);else{e=br(),r=r||za;var t=$d(r),n=this,i=n.cy(),a=i.styleEnabled();if(a)for(var o=0;o<n.length;o++){var s=n[o],u=s._private,l=Dh(s),c=u.bbCachePosKey===l,d=t.useCache&&c&&!u.styleDirty;s.recalculateRenderedStyle(d)}this.updateCompoundBounds(!r.useCache);for(var f=0;f<n.length;f++){var h=n[f];ei(e,Hd(h,t))}}return e.x1=Pr(e.x1),e.y1=Pr(e.y1),e.x2=Pr(e.x2),e.y2=Pr(e.y2),e.w=Pr(e.x2-e.x1),e.h=Pr(e.y2-e.y1),e};Un.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Un.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),n=t.hasCompoundNodes(),i=t.collection();if(n&&(i=e.filter(function(l){return l.isParent()}),e=e.not(i)),ut(r)){var a=r;r=function(){return a}}var o=function(c,d){return c._private.bbAtOldPos=r(c,d)},s=function(c){return c._private.bbAtOldPos};t.startBatch(),e.forEach(o).silentPositions(r),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var u=y0(this.boundingBox({useCache:!1}));return e.silentPositions(s),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),t.endBatch(),u};Ui.boundingbox=Ui.bb=Ui.boundingBox;Ui.renderedBoundingbox=Ui.renderedBoundingBox;var tw=Un,Sa,Xa;Sa=Xa={};var Ah=function(e){e.uppercaseName=vd(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=vd(e.outerName),Sa[e.name]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var s=n.pstyle(e.name);switch(s.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return s.pfValue}}else return 1},Sa["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){var s=n[e.name](),u=n.pstyle("border-width").pfValue,l=2*n.padding();return s+u+l}else return 1},Sa["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},Sa["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};Ah({name:"width"});Ah({name:"height"});Xa.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};Xa.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};Xa.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var rw=Xa,nw=function(e,t){if(e.isEdge())return t(e)},iw=function(e,t){if(e.isEdge()){var n=e.cy();return Zs(t(e),n.zoom(),n.pan())}},aw=function(e,t){if(e.isEdge()){var n=e.cy(),i=n.pan(),a=n.zoom();return t(e).map(function(o){return Zs(o,a,i)})}},ow=function(e){return e.renderer().getControlPoints(e)},sw=function(e){return e.renderer().getSegmentPoints(e)},lw=function(e){return e.renderer().getSourceEndpoint(e)},uw=function(e){return e.renderer().getTargetEndpoint(e)},cw=function(e){return e.renderer().getEdgeMidpoint(e)},Wd={controlPoints:{get:ow,mult:!0},segmentPoints:{get:sw,mult:!0},sourceEndpoint:{get:lw},targetEndpoint:{get:uw},midpoint:{get:cw}},dw=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},fw=Object.keys(Wd).reduce(function(r,e){var t=Wd[e],n=dw(e);return r[e]=function(){return nw(this,t.get)},t.mult?r[n]=function(){return aw(this,t.get)}:r[n]=function(){return iw(this,t.get)},r},{}),hw=Ye({},QC,tw,rw,fw);var Ph=function(e,t){this.recycle(e,t)};function Ca(){return!1}function ws(){return!0}Ph.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ca,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?ws:Ca):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=ws;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=ws;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ws,this.stopPropagation()},isDefaultPrevented:Ca,isPropagationStopped:Ca,isImmediatePropagationStopped:Ca};var Rh=/^([^.]+)(\.(?:[^.]+))?$/,vw=".*",Oh={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Yd=Object.keys(Oh),pw={};function nl(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pw,e=arguments.length>1?arguments[1]:void 0,t=0;t<Yd.length;t++){var n=Yd[t];this[n]=r[n]||Oh[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Gn=nl.prototype,Lh=function(e,t,n,i,a,o,s){_t(i)&&(a=i,i=null),s&&(o==null?o=s:o=Ye({},o,s));for(var u=gt(n)?n:n.split(/\s+/),l=0;l<u.length;l++){var c=u[l];if(!kn(c)){var d=c.match(Rh);if(d){var f=d[1],h=d[2]?d[2]:null,v=t(e,c,f,h,i,a,o);if(v===!1)break}}}},Xd=function(e,t){return e.addEventFields(e.context,t),new Ph(t.type,t)},gw=function(e,t,n){if(Fg(n)){t(e,n);return}else if(ut(n)){t(e,Xd(e,n));return}for(var i=gt(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var o=i[a];if(!kn(o)){var s=o.match(Rh);if(s){var u=s[1],l=s[2]?s[2]:null,c=Xd(e,{type:u,namespace:l,target:e.context});t(e,c)}}}};Gn.on=Gn.addListener=function(r,e,t,n,i){return Lh(this,function(a,o,s,u,l,c,d){_t(c)&&a.listeners.push({event:o,callback:c,type:s,namespace:u,qualifier:l,conf:d})},r,e,t,n,i),this};Gn.one=function(r,e,t,n){return this.on(r,e,t,n,{one:!0})};Gn.removeListener=Gn.off=function(r,e,t,n){var i=this;this.emitting!==0&&(this.listeners=$m(this.listeners));for(var a=this.listeners,o=function(l){var c=a[l];Lh(i,function(d,f,h,v,p,m){if((c.type===h||r==="*")&&(!v&&c.namespace!==".*"||c.namespace===v)&&(!p||d.qualifierCompare(c.qualifier,p))&&(!m||c.callback===m))return a.splice(l,1),!1},r,e,t,n)},s=a.length-1;s>=0;s--)o(s);return this};Gn.removeAllListeners=function(){return this.removeListener("*")};Gn.emit=Gn.trigger=function(r,e,t){var n=this.listeners,i=n.length;return this.emitting++,gt(e)||(e=[e]),gw(this,function(a,o){t!=null&&(n=[{event:o.event,type:o.type,namespace:o.namespace,callback:t}],i=n.length);for(var s=function(c){var d=n[c];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===vw)&&a.eventMatches(a.context,d,o)){var f=[o];e!=null&&Ym(f,e),a.beforeEmit(a.context,d,o),d.conf&&d.conf.one&&(a.listeners=a.listeners.filter(function(p){return p!==d}));var h=a.callbackContext(a.context,d,o),v=d.callback.apply(h,f);a.afterEmit(a.context,d,o),v===!1&&(o.stopPropagation(),o.preventDefault())}},u=0;u<i;u++)s(u);a.bubble(a.context)&&!o.isPropagationStopped()&&a.parent(a.context).emit(o,e)},r),this.emitting--,this};var mw={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&Ua(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},bs=function(e){return Ue(e)?new Vn(e):e},Ih={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new nl(mw,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n)}return this},removeListener:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().one(e,i,n)}return this},once:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,t){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};dt.eventAliasesOn(Ih);var Nh={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):t.push(i)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(Ue(e)||Mr(e))return new Vn(e).filter(this);if(_t(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);s&&n.push(o)}return n}return this.spawn()},not:function(e){if(e){Ue(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||t.push(i)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Ue(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),i=this,a=e,o=this.length<e.length,s=o?i:a,u=o?a:i,l=0;l<s.length;l++){var c=s[l];u.has(c)&&n.push(c)}return n},xor:function(e){var t=this._private.cy;Ue(e)&&(e=t.$(e));var n=this.spawn(),i=this,a=e,o=function(u,l){for(var c=0;c<u.length;c++){var d=u[c],f=d._private.data.id,h=l.hasElementWithId(f);h||n.push(d)}};return o(i,a),o(a,i),n},diff:function(e){var t=this._private.cy;Ue(e)&&(e=t.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),o=this,s=e,u=function(c,d,f){for(var h=0;h<c.length;h++){var v=c[h],p=v._private.data.id,m=d.hasElementWithId(p);m?a.merge(v):f.push(v)}};return u(o,s,n),u(s,o,i),{left:n,right:i,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(Ue(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var o=e[a],s=!this.has(o);s&&i.push(o)}return i},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&Ue(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=t.map,o=0;o<e.length;o++){var s=e[o],u=s._private.data.id,l=!a.has(u);if(l){var c=this.length++;this[c]=s,a.set(u,{ele:s,index:c})}}return this},unmergeAt:function(e){var t=this[e],n=t.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1,u=this[s],l=u._private.data.id;this[s]=void 0,this[e]=u,a.set(l,{ele:u,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,i=t.map,a=i.get(n);if(!a)return this;var o=a.index;return this.unmergeAt(o),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&Ue(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var n=this[t];e(n)&&this.unmergeAt(t)}return this},map:function(e,t){for(var n=[],i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);n.push(s)}return n},reduce:function(e,t){for(var n=t,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,t){for(var n=-1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],u=t?e.apply(t,[s,o,a]):e(s,o,a);u>n&&(n=u,i=s)}return{value:n,ele:i}},min:function(e,t){for(var n=1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],u=t?e.apply(t,[s,o,a]):e(s,o,a);u<n&&(n=u,i=s)}return{value:n,ele:i}}},ct=Nh;ct.u=ct["|"]=ct["+"]=ct.union=ct.or=ct.add;ct["\\"]=ct["!"]=ct["-"]=ct.difference=ct.relativeComplement=ct.subtract=ct.not;ct.n=ct["&"]=ct["."]=ct.and=ct.intersection=ct.intersect;ct["^"]=ct["(+)"]=ct["(-)"]=ct.symmetricDifference=ct.symdiff=ct.xor;ct.fnFilter=ct.filterFn=ct.stdFilter=ct.filter;ct.complement=ct.abscomp=ct.absoluteComplement;var yw={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},kh=function(e,t){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var d=c.pstyle("z-compound-depth");return d.value==="auto"?i?c.zDepth():0:d.value==="bottom"?-1:d.value==="top"?Eu:0}var o=a(e)-a(t);if(o!==0)return o;function s(c){var d=c.pstyle("z-index-compare");return d.value==="auto"&&c.isNode()?1:0}var u=s(e)-s(t);if(u!==0)return u;var l=e.pstyle("z-index").value-t.pstyle("z-index").value;return l!==0?l:e.poolIndex()-t.poolIndex()},js={forEach:function(e,t){if(_t(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],o=t?e.apply(t,[a,i,this]):e(a,i,this);if(o===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],i=this.length;t==null&&(t=i),e==null&&(e=0),e<0&&(e=i+e),t<0&&(t=i+t);for(var a=e;a>=0&&a<t&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!_t(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(kh)},zDepth:function(){var e=this[0];if(e){var t=e._private,n=t.group;if(n==="nodes"){var i=t.data.parent?e.parents().size():0;return e.isParent()?i:Eu-1}else{var a=t.source,o=t.target,s=a.zDepth(),u=o.zDepth();return Math.max(s,u,0)}}}};js.each=js.forEach;var Cw=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":Vt(Symbol))!=e&&Vt(Symbol.iterator)!=e;t&&(js[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,o=this.length;return Of({next:function(){return a<o?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};Cw();var ww=Yt({nodeDimensionsIncludeLabels:!1}),Ps={layoutDimensions:function(e){e=ww(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,n){var i=this.nodes().filter(function(D){return!D.isParent()}),a=this.cy(),o=t.eles,s=function(P){return P.id()},u=Oa(n,s);e.emit({type:"layoutstart",layout:e}),e.animations=[];var l=function(P,R,L){var O={x:R.x1+R.w/2,y:R.y1+R.h/2},I={x:(L.x-O.x)*P,y:(L.y-O.y)*P};return{x:O.x+I.x,y:O.y+I.y}},c=t.spacingFactor&&t.spacingFactor!==1,d=function(){if(!c)return null;for(var P=br(),R=0;R<i.length;R++){var L=i[R],O=u(L,R);b0(P,O.x,O.y)}return P},f=d(),h=Oa(function(D,P){var R=u(D,P);if(c){var L=Math.abs(t.spacingFactor);R=l(L,f,R)}return t.transform!=null&&(R=t.transform(D,R)),R},s);if(t.animate){for(var v=0;v<i.length;v++){var p=i[v],m=h(p,v),g=t.animateFilter==null||t.animateFilter(p,v);if(g){var y=p.animation({position:m,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else p.position(m)}if(t.fit){var x=a.animation({fit:{boundingBox:o.boundingBoxAt(h),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(x)}else if(t.zoom!==void 0&&t.pan!==void 0){var S=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(S)}e.animations.forEach(function(D){return D.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Ki.all(e.animations.map(function(D){return D.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(h),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(Ye({},e,{eles:this}))}};Ps.createLayout=Ps.makeLayout=Ps.layout;function Fh(r,e,t){var n=t._private,i=n.styleCache=n.styleCache||[],a;return(a=i[r])!=null||(a=i[r]=e(t)),a}function il(r,e){return r=Fn(r),function(n){return Fh(r,e,n)}}function al(r,e){r=Fn(r);var t=function(i){return e.call(i)};return function(){var i=this[0];if(i)return Fh(r,t,i)}}var qt={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),i=t.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(t)}else this.forEach(function(i){t(i),i.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var n=t._private.batchStyleEles;return n.merge(this),this}var i=t.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=a;return e?o.emitAndNotify("style"):o.emit("style"),a.forEach(function(s){return s._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(t?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];if(n)return t.style().getRenderedStyle(n,e)},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(ut(e)){var o=e;a.applyBypass(this,o,i),this.emitAndNotify("style")}else if(Ue(e))if(t===void 0){var s=this[0];return s?a.getStylePropertyValue(s,e):void 0}else a.applyBypass(this,e,t,i),this.emitAndNotify("style");else if(e===void 0){var u=this[0];return u?a.getRawStyle(u):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,i=t.style(),a=this;if(e===void 0)for(var o=0;o<a.length;o++){var s=a[o];i.removeAllBypasses(s,n)}else{e=e.split(/\s+/);for(var u=0;u<a.length;u++){var l=a[u];i.removeBypasses(l,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!t)return a;var o=i.data.parent?n.parents():null;if(o)for(var s=0;s<o.length;s++){var u=o[s],l=u.pstyle("opacity").value;a=l*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],n=t.cy().hasCompoundNodes();if(t)return n?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function ql(r,e){var t=r._private,n=t.data.parent?r.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function Nu(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,n=r.parentOk||r.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],o=i.hasCompoundNodes();if(a){var s=a._private;if(!e(a))return!1;if(a.isNode())return!o||ql(a,n);var u=s.source,l=s.target;return t(u)&&(!o||ql(u,t))&&(u===l||t(l)&&(!o||ql(l,t)))}}}var ea=il("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});qt.takesUpSpace=al("takesUpSpace",Nu({ok:ea}));var bw=il("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&ea(r)}),xw=il("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&ea(r)});qt.interactive=al("interactive",Nu({ok:bw,parentOk:xw,edgeOkViaNode:ea}));qt.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var Ew=il("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&ea(r)}),Tw=ea;qt.visible=al("visible",Nu({ok:Ew,edgeOkViaNode:Tw}));qt.hidden=function(){var r=this[0];if(r)return!r.visible()};qt.isBundledBezier=al("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});qt.bypass=qt.css=qt.style;qt.renderedCss=qt.renderedStyle;qt.removeBypass=qt.removeCss=qt.removeStyle;qt.pstyle=qt.parsedStyle;var Nn={};function qd(r){return function(){var e=arguments,t=[];if(e.length===2){var n=e[0],i=e[1];this.on(r.event,n,i)}else if(e.length===1&&_t(e[0])){var a=e[0];this.on(r.event,a)}else if(e.length===0||e.length===1&&gt(e[0])){for(var o=e.length===1?e[0]:null,s=0;s<this.length;s++){var u=this[s],l=!r.ableField||u._private[r.ableField],c=u._private[r.field]!=r.value;if(r.overrideAble){var d=r.overrideAble(u);if(d!==void 0&&(l=d,!d))return this}l&&(u._private[r.field]=r.value,c&&t.push(u))}var f=this.spawn(t);f.updateStyle(),f.emit(r.event),o&&f.emit(o)}return this}}function ta(r){Nn[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},Nn[r.on]=qd({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),Nn[r.off]=qd({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}ta({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});ta({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});ta({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});ta({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Nn.deselect=Nn.unselect;Nn.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};ta({field:"active",on:"activate",off:"unactivate"});ta({field:"pannable",on:"panify",off:"unpanify"});Nn.inactive=function(){var r=this[0];if(r)return!r._private.active};var ar={},Kd=function(e){return function(n){for(var i=this,a=[],o=0;o<i.length;o++){var s=i[o];if(s.isNode()){for(var u=!1,l=s.connectedEdges(),c=0;c<l.length;c++){var d=l[c],f=d.source(),h=d.target();if(e.noIncomingEdges&&h===s&&f!==s||e.noOutgoingEdges&&f===s&&h!==s){u=!0;break}}u||a.push(s)}}return this.spawn(a,!0).filter(n)}},Zd=function(e){return function(t){for(var n=this,i=[],a=0;a<n.length;a++){var o=n[a];if(o.isNode())for(var s=o.connectedEdges(),u=0;u<s.length;u++){var l=s[u],c=l.source(),d=l.target();e.outgoing&&c===o?(i.push(l),i.push(d)):e.incoming&&d===o&&(i.push(l),i.push(c))}}return this.spawn(i,!0).filter(t)}},Qd=function(e){return function(t){for(var n=this,i=[],a={};;){var o=e.outgoing?n.outgoers():n.incomers();if(o.length===0)break;for(var s=!1,u=0;u<o.length;u++){var l=o[u],c=l.id();a[c]||(a[c]=!0,i.push(l),s=!0)}if(!s)break;n=o}return this.spawn(i,!0).filter(t)}};ar.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Ye(ar,{roots:Kd({noIncomingEdges:!0}),leaves:Kd({noOutgoingEdges:!0}),outgoers:Rr(Zd({outgoing:!0}),"outgoers"),successors:Qd({outgoing:!0}),incomers:Rr(Zd({incoming:!0}),"incomers"),predecessors:Qd({incoming:!0})});Ye(ar,{neighborhood:Rr(function(r){for(var e=[],t=this.nodes(),n=0;n<t.length;n++)for(var i=t[n],a=i.connectedEdges(),o=0;o<a.length;o++){var s=a[o],u=s.source(),l=s.target(),c=i===u?l:u;c.length>0&&e.push(c[0]),e.push(s[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});ar.neighbourhood=ar.neighborhood;ar.closedNeighbourhood=ar.closedNeighborhood;ar.openNeighbourhood=ar.openNeighborhood;Ye(ar,{source:Rr(function(e){var t=this[0],n;return t&&(n=t._private.source||t.cy().collection()),n&&e?n.filter(e):n},"source"),target:Rr(function(e){var t=this[0],n;return t&&(n=t._private.target||t.cy().collection()),n&&e?n.filter(e):n},"target"),sources:Jd({attr:"source"}),targets:Jd({attr:"target"})});function Jd(r){return function(t){for(var n=[],i=0;i<this.length;i++){var a=this[i],o=a._private[r.attr];o&&n.push(o)}return this.spawn(n,!0).filter(t)}}Ye(ar,{edgesWith:Rr(ef(),"edgesWith"),edgesTo:Rr(ef({thisIsSrc:!0}),"edgesTo")});function ef(r){return function(t){var n=[],i=this._private.cy,a=r||{};Ue(t)&&(t=i.$(t));for(var o=0;o<t.length;o++)for(var s=t[o]._private.edges,u=0;u<s.length;u++){var l=s[u],c=l._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),f=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target),h=d||f;h&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!d||a.thisIsTgt&&!f)||n.push(l))}return this.spawn(n,!0)}}Ye(ar,{connectedEdges:Rr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];if(i.isNode())for(var a=i._private.edges,o=0;o<a.length;o++){var s=a[o];e.push(s)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:Rr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:Rr(tf(),"parallelEdges"),codirectedEdges:Rr(tf({codirected:!0}),"codirectedEdges")});function tf(r){var e={codirected:!1};return r=Ye({},e,r),function(n){for(var i=[],a=this.edges(),o=r,s=0;s<a.length;s++)for(var u=a[s],l=u._private,c=l.source,d=c._private.data.id,f=l.data.target,h=c._private.edges,v=0;v<h.length;v++){var p=h[v],m=p._private.data,g=m.target,y=m.source,x=g===f&&y===d,S=d===g&&f===y;(o.codirected&&x||!o.codirected&&(x||S))&&i.push(p)}return this.spawn(i,!0).filter(n)}}Ye(ar,{components:function(e){var t=this,n=t.cy(),i=n.collection(),a=e==null?t.nodes():e.nodes(),o=[];e!=null&&a.empty()&&(a=e.sources());var s=function(c,d){i.merge(c),a.unmerge(c),d.merge(c)};if(a.empty())return t.spawn();var u=function(){var c=n.collection();o.push(c);var d=a[0];s(d,c),t.bfs({directed:!1,roots:d,visit:function(h){return s(h,c)}}),c.forEach(function(f){f.connectedEdges().forEach(function(h){t.has(h)&&c.has(h.source())&&c.has(h.target())&&c.merge(h)})})};do u();while(a.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});ar.componentsOf=ar.components;var Kt=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){Tt("A collection must have a reference to the core");return}var a=new en,o=!1;if(!t)t=[];else if(t.length>0&&ut(t[0])&&!Ua(t[0])){o=!0;for(var s=[],u=new qi,l=0,c=t.length;l<c;l++){var d=t[l];d.data==null&&(d.data={});var f=d.data;if(f.id==null)f.id=Kf();else if(e.hasElementWithId(f.id)||u.has(f.id))continue;var h=new Ks(e,d,!1);s.push(h),u.add(f.id)}t=s}this.length=0;for(var v=0,p=t.length;v<p;v++){var m=t[v][0];if(m!=null){var g=m._private.data.id;(!n||!a.has(g))&&(n&&a.set(g,{index:this.length,ele:m}),this[this.length]=m,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var x=this.lazyMap=new en,S=this.eles,D=0;D<S.length;D++){var P=S[D];x.set(P.id(),{index:D,ele:P})}}},n&&(this._private.map=a),o&&!i&&this.restore()},Ct=Ks.prototype=Kt.prototype=Object.create(Array.prototype);Ct.instanceString=function(){return"collection"};Ct.spawn=function(r,e){return new Kt(this.cy(),r,e)};Ct.spawnSelf=function(){return this.spawn(this)};Ct.cy=function(){return this._private.cy};Ct.renderer=function(){return this._private.cy.renderer()};Ct.element=function(){return this[0]};Ct.collection=function(){return Nf(this)?this:new Kt(this._private.cy,[this])};Ct.unique=function(){return new Kt(this._private.cy,this,!0)};Ct.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};Ct.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new Kt(e)};Ct.$id=Ct.getElementById;Ct.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};Ct.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};Ct.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};Ct.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var n=e._private;if(ut(r)){if(t.startBatch(),r.data){e.data(r.data);var i=n.data;if(e.isEdge()){var a=!1,o={},s=r.data.source,u=r.data.target;s!=null&&s!=i.source&&(o.source=""+s,a=!0),u!=null&&u!=i.target&&(o.target=""+u,a=!0),a&&(e=e.move(o))}else{var l="parent"in r.data,c=r.data.parent;l&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}r.position&&e.position(r.position);var d=function(p,m,g){var y=r[p];y!=null&&y!==n[p]&&(y?e[m]():e[g]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var f={data:Jr(n.data),position:Jr(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};f.classes="";var h=0;return n.classes.forEach(function(v){return f.classes+=h++===0?v:" "+v}),f}}};Ct.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],n=t.json();r.push(n)}return r};Ct.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var n=this[t],i=n.json(),a=new Ks(r,i,!1);e.push(a)}return new Kt(r,e)};Ct.copy=Ct.clone;Ct.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=t.cy(),i=n._private,a=[],o=[],s,u=0,l=t.length;u<l;u++){var c=t[u];e&&!c.removed()||(c.isNode()?a.push(c):o.push(c))}s=a.concat(o);var d,f=function(){s.splice(d,1),d--};for(d=0;d<s.length;d++){var h=s[d],v=h._private,p=v.data;if(h.clearTraversalCache(),!(!e&&!v.removed)){if(p.id===void 0)p.id=Kf();else if(Ne(p.id))p.id=""+p.id;else if(kn(p.id)||!Ue(p.id)){Tt("Can not create element with invalid string ID `"+p.id+"`"),f();continue}else if(n.hasElementWithId(p.id)){Tt("Can not create second element with ID `"+p.id+"`"),f();continue}}var m=p.id;if(h.isNode()){var g=v.position;g.x==null&&(g.x=0),g.y==null&&(g.y=0)}if(h.isEdge()){for(var y=h,x=["source","target"],S=x.length,D=!1,P=0;P<S;P++){var R=x[P],L=p[R];Ne(L)&&(L=p[R]=""+p[R]),L==null||L===""?(Tt("Can not create edge `"+m+"` with unspecified "+R),D=!0):n.hasElementWithId(L)||(Tt("Can not create edge `"+m+"` with nonexistant "+R+" `"+L+"`"),D=!0)}if(D){f();continue}var O=n.getElementById(p.source),I=n.getElementById(p.target);O.same(I)?O._private.edges.push(y):(O._private.edges.push(y),I._private.edges.push(y)),y._private.source=O,y._private.target=I}v.map=new en,v.map.set(m,{ele:h,index:0}),v.removed=!1,e&&n.addToPool(h)}for(var B=0;B<a.length;B++){var w=a[B],T=w._private.data;Ne(T.parent)&&(T.parent=""+T.parent);var E=T.parent,b=E!=null;if(b||w._private.parent){var C=w._private.parent?n.collection().merge(w._private.parent):n.getElementById(E);if(C.empty())T.parent=void 0;else if(C[0].removed())ft("Node added with missing parent, reference to parent removed"),T.parent=void 0,w._private.parent=null;else{for(var _=!1,M=C;!M.empty();){if(w.same(M)){_=!0,T.parent=void 0;break}M=M.parent()}_||(C[0]._private.children.push(w),w._private.parent=C[0],i.hasCompoundNodes=!0)}}}if(s.length>0){for(var A=s.length===t.length?t:new Kt(n,s),F=0;F<A.length;F++){var N=A[F];N.isNode()||(N.parallelEdges().clearTraversalCache(),N.source().clearTraversalCache(),N.target().clearTraversalCache())}var z;i.hasCompoundNodes?z=n.collection().merge(A).merge(A.connectedNodes()).merge(A.parent()):z=A,z.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?A.emitAndNotify("add"):e&&A.emit("add")}return t};Ct.removed=function(){var r=this[0];return r&&r._private.removed};Ct.inside=function(){var r=this[0];return r&&!r._private.removed};Ct.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=[],i={},a=t._private.cy;function o(E){for(var b=E._private.edges,C=0;C<b.length;C++)u(b[C])}function s(E){for(var b=E._private.children,C=0;C<b.length;C++)u(b[C])}function u(E){var b=i[E.id()];e&&E.removed()||b||(i[E.id()]=!0,E.isNode()?(n.push(E),o(E),s(E)):n.unshift(E))}for(var l=0,c=t.length;l<c;l++){var d=t[l];u(d)}function f(E,b){var C=E._private.edges;Bn(C,b),E.clearTraversalCache()}function h(E){E.clearTraversalCache()}var v=[];v.ids={};function p(E,b){b=b[0],E=E[0];var C=E._private.children,_=E.id();Bn(C,b),b._private.parent=null,v.ids[_]||(v.ids[_]=!0,v.push(E))}t.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var m=0;m<n.length;m++){var g=n[m];if(g.isEdge()){var y=g.source()[0],x=g.target()[0];f(y,g),f(x,g);for(var S=g.parallelEdges(),D=0;D<S.length;D++){var P=S[D];h(P),P.isBundledBezier()&&P.dirtyBoundingBoxCache()}}else{var R=g.parent();R.length!==0&&p(R,g)}e&&(g._private.removed=!0)}var L=a._private.elements;a._private.hasCompoundNodes=!1;for(var O=0;O<L.length;O++){var I=L[O];if(I.isParent()){a._private.hasCompoundNodes=!0;break}}var B=new Kt(this.cy(),n);B.size()>0&&(r?B.emitAndNotify("remove"):e&&B.emit("remove"));for(var w=0;w<v.length;w++){var T=v[w];(!e||!T.removed())&&T.updateStyle()}return B};Ct.move=function(r){var e=this._private.cy,t=this,n=!1,i=!1,a=function(v){return v==null?v:""+v};if(r.source!==void 0||r.target!==void 0){var o=a(r.source),s=a(r.target),u=o!=null&&e.hasElementWithId(o),l=s!=null&&e.hasElementWithId(s);(u||l)&&(e.batch(function(){t.remove(n,i),t.emitAndNotify("moveout");for(var h=0;h<t.length;h++){var v=t[h],p=v._private.data;v.isEdge()&&(u&&(p.source=o),l&&(p.target=s))}t.restore(n,i)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var c=a(r.parent),d=c===null||e.hasElementWithId(c);if(d){var f=c===null?void 0:c;e.batch(function(){var h=t.remove(n,i);h.emitAndNotify("moveout");for(var v=0;v<t.length;v++){var p=t[v],m=p._private.data;p.isNode()&&(m.parent=f)}h.restore(n,i)}),t.emitAndNotify("move")}}return this};[uh,NC,As,In,Xi,ZC,rl,hw,Ih,Nh,yw,js,Ps,qt,Nn,ar].forEach(function(r){Ye(Ct,r)});var _w={add:function(e){var t,n=this;if(Mr(e)){var i=e;if(i._private.cy===n)t=i.restore();else{for(var a=[],o=0;o<i.length;o++){var s=i[o];a.push(s.json())}t=new Kt(n,a)}}else if(gt(e)){var u=e;t=new Kt(n,u)}else if(ut(e)&&(gt(e.nodes)||gt(e.edges))){for(var l=e,c=[],d=["nodes","edges"],f=0,h=d.length;f<h;f++){var v=d[f],p=l[v];if(gt(p))for(var m=0,g=p.length;m<g;m++){var y=Ye({group:v},p[m]);c.push(y)}}t=new Kt(n,c)}else{var x=e;t=new Ks(n,x).collection()}return t},remove:function(e){if(!Mr(e)){if(Ue(e)){var t=e;e=this.$(t)}}return e.remove()}};function Sw(r,e,t,n){var i=4,a=.001,o=1e-7,s=10,u=11,l=1/(u-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var f=c?new Float32Array(u):new Array(u);function h(I,B){return 1-3*B+3*I}function v(I,B){return 3*B-6*I}function p(I){return 3*I}function m(I,B,w){return((h(B,w)*I+v(B,w))*I+p(B))*I}function g(I,B,w){return 3*h(B,w)*I*I+2*v(B,w)*I+p(B)}function y(I,B){for(var w=0;w<i;++w){var T=g(B,r,t);if(T===0)return B;var E=m(B,r,t)-I;B-=E/T}return B}function x(){for(var I=0;I<u;++I)f[I]=m(I*l,r,t)}function S(I,B,w){var T,E,b=0;do E=B+(w-B)/2,T=m(E,r,t)-I,T>0?w=E:B=E;while(Math.abs(T)>o&&++b<s);return E}function D(I){for(var B=0,w=1,T=u-1;w!==T&&f[w]<=I;++w)B+=l;--w;var E=(I-f[w])/(f[w+1]-f[w]),b=B+E*l,C=g(b,r,t);return C>=a?y(I,b):C===0?b:S(I,B,B+l)}var P=!1;function R(){P=!0,(r!==e||t!==n)&&x()}var L=function(B){return P||R(),r===e&&t===n?B:B===0?0:B===1?1:m(D(B),e,n)};L.getControlPoints=function(){return[{x:r,y:e},{x:t,y:n}]};var O="generateBezier("+[r,e,t,n]+")";return L.toString=function(){return O},L}var Mw=function(){function r(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var o={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:o.v,dv:r(o)}}function t(n,i){var a={dx:n.v,dv:r(n)},o=e(n,i*.5,a),s=e(n,i*.5,o),u=e(n,i,s),l=1/6*(a.dx+2*(o.dx+s.dx)+u.dx),c=1/6*(a.dv+2*(o.dv+s.dv)+u.dv);return n.x=n.x+l*i,n.v=n.v+c*i,n}return function n(i,a,o){var s={x:-1,v:0,tension:null,friction:null},u=[0],l=0,c=1/1e4,d=16/1e3,f,h,v;for(i=parseFloat(i)||500,a=parseFloat(a)||20,o=o||null,s.tension=i,s.friction=a,f=o!==null,f?(l=n(i,a),h=l/o*d):h=d;v=t(v||s,h),u.push(1+v.x),l+=16,Math.abs(v.x)>c&&Math.abs(v.v)>c;);return f?function(p){return u[p*(u.length-1)|0]}:l}}(),yt=function(e,t,n,i){var a=Sw(e,t,n,i);return function(o,s,u){return o+(s-o)*a(u)}},Rs={linear:function(e,t,n){return e+(t-e)*n},ease:yt(.25,.1,.25,1),"ease-in":yt(.42,0,1,1),"ease-out":yt(0,0,.58,1),"ease-in-out":yt(.42,0,.58,1),"ease-in-sine":yt(.47,0,.745,.715),"ease-out-sine":yt(.39,.575,.565,1),"ease-in-out-sine":yt(.445,.05,.55,.95),"ease-in-quad":yt(.55,.085,.68,.53),"ease-out-quad":yt(.25,.46,.45,.94),"ease-in-out-quad":yt(.455,.03,.515,.955),"ease-in-cubic":yt(.55,.055,.675,.19),"ease-out-cubic":yt(.215,.61,.355,1),"ease-in-out-cubic":yt(.645,.045,.355,1),"ease-in-quart":yt(.895,.03,.685,.22),"ease-out-quart":yt(.165,.84,.44,1),"ease-in-out-quart":yt(.77,0,.175,1),"ease-in-quint":yt(.755,.05,.855,.06),"ease-out-quint":yt(.23,1,.32,1),"ease-in-out-quint":yt(.86,0,.07,1),"ease-in-expo":yt(.95,.05,.795,.035),"ease-out-expo":yt(.19,1,.22,1),"ease-in-out-expo":yt(1,0,0,1),"ease-in-circ":yt(.6,.04,.98,.335),"ease-out-circ":yt(.075,.82,.165,1),"ease-in-out-circ":yt(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return Rs.linear;var i=Mw(e,t,n);return function(a,o,s){return a+(o-a)*i(s)}},"cubic-bezier":yt};function rf(r,e,t,n,i){if(n===1||e===t)return t;var a=i(e,t,n);return r==null||((r.roundValue||r.color)&&(a=Math.round(a)),r.min!==void 0&&(a=Math.max(a,r.min)),r.max!==void 0&&(a=Math.min(a,r.max))),a}function nf(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function Ni(r,e,t,n,i){var a=i!=null?i.type:null;t<0?t=0:t>1&&(t=1);var o=nf(r,i),s=nf(e,i);if(Ne(o)&&Ne(s))return rf(a,o,s,t,n);if(gt(o)&&gt(s)){for(var u=[],l=0;l<s.length;l++){var c=o[l],d=s[l];if(c!=null&&d!=null){var f=rf(a,c,d,t,n);u.push(f)}else u.push(d)}return u}}function Dw(r,e,t,n){var i=!n,a=r._private,o=e._private,s=o.easing,u=o.startTime,l=n?r:r.cy(),c=l.style();if(!o.easingImpl)if(s==null)o.easingImpl=Rs.linear;else{var d;if(Ue(s)){var f=c.parse("transition-timing-function",s);d=f.value}else d=s;var h,v;Ue(d)?(h=d,v=[]):(h=d[1],v=d.slice(2).map(function(A){return+A})),v.length>0?(h==="spring"&&v.push(o.duration),o.easingImpl=Rs[h].apply(null,v)):o.easingImpl=Rs[h]}var p=o.easingImpl,m;if(o.duration===0?m=1:m=(t-u)/o.duration,o.applying&&(m=o.progress),m<0?m=0:m>1&&(m=1),o.delay==null){var g=o.startPosition,y=o.position;if(y&&i&&!r.locked()){var x={};wa(g.x,y.x)&&(x.x=Ni(g.x,y.x,m,p)),wa(g.y,y.y)&&(x.y=Ni(g.y,y.y,m,p)),r.position(x)}var S=o.startPan,D=o.pan,P=a.pan,R=D!=null&&n;R&&(wa(S.x,D.x)&&(P.x=Ni(S.x,D.x,m,p)),wa(S.y,D.y)&&(P.y=Ni(S.y,D.y,m,p)),r.emit("pan"));var L=o.startZoom,O=o.zoom,I=O!=null&&n;I&&(wa(L,O)&&(a.zoom=ka(a.minZoom,Ni(L,O,m,p),a.maxZoom)),r.emit("zoom")),(R||I)&&r.emit("viewport");var B=o.style;if(B&&B.length>0&&i){for(var w=0;w<B.length;w++){var T=B[w],E=T.name,b=T,C=o.startStyle[E],_=c.properties[C.name],M=Ni(C,b,m,p,_);c.overrideBypass(r,E,M)}r.emit("style")}}return o.progress=m,m}function wa(r,e){return r==null||e==null?!1:Ne(r)&&Ne(e)?!0:!!(r&&e)}function Aw(r,e,t,n){var i=e._private;i.started=!0,i.startTime=t-i.progress*i.duration}function af(r,e){var t=e._private.aniEles,n=[];function i(c,d){var f=c._private,h=f.animation.current,v=f.animation.queue,p=!1;if(h.length===0){var m=v.shift();m&&h.push(m)}for(var g=function(P){for(var R=P.length-1;R>=0;R--){var L=P[R];L()}P.splice(0,P.length)},y=h.length-1;y>=0;y--){var x=h[y],S=x._private;if(S.stopped){h.splice(y,1),S.hooked=!1,S.playing=!1,S.started=!1,g(S.frames);continue}!S.playing&&!S.applying||(S.playing&&S.applying&&(S.applying=!1),S.started||Aw(c,x,r),Dw(c,x,r,d),S.applying&&(S.applying=!1),g(S.frames),S.step!=null&&S.step(r),x.completed()&&(h.splice(y,1),S.hooked=!1,S.playing=!1,S.started=!1,g(S.completes)),p=!0)}return!d&&h.length===0&&v.length===0&&n.push(c),p}for(var a=!1,o=0;o<t.length;o++){var s=t[o],u=i(s);a=a||u}var l=i(e,!0);(a||l)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(n),e.emit("step")}var Pw={animate:dt.animate(),animation:dt.animation(),animated:dt.animated(),clearQueue:dt.clearQueue(),delay:dt.delay(),delayAnimation:dt.delayAnimation(),stop:dt.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){e._private.animationsRunning&&Fs(function(a){af(a,e),t()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,o){af(o,e)},n.beforeRenderPriorities.animations):t()}},Rw={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&Ua(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},xs=function(e){return Ue(e)?new Vn(e):e},Bh={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new nl(Rw,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,xs(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,xs(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,xs(t),n),this},once:function(e,t,n){return this.emitter().one(e,xs(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};dt.eventAliasesOn(Bh);var cu={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};cu.jpeg=cu.jpg;var Os={layout:function(e){var t=this;if(e==null){Tt("Layout options must be specified to make a layout");return}if(e.name==null){Tt("A `name` must be specified to make a layout");return}var n=e.name,i=t.extension("layout",n);if(i==null){Tt("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Ue(e.eles)?a=t.$(e.eles):a=e.eles!=null?e.eles:t.$();var o=new i(Ye({},e,{cy:t,eles:a}));return o}};Os.createLayout=Os.makeLayout=Os.layout;var Ow={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&i.merge(t);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?t.notify(n):t.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],o=e[a],s=t.getElementById(a);s.data(o)}})}},Lw=Yt({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:12,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),du={renderTo:function(e,t,n,i){var a=this._private.renderer;return a.renderTo(e,t,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n==null){Tt("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&ft("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=Lw(e);i.cy=t,t._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};du.invalidateDimensions=du.resize;var Ls={collection:function(e,t){return Ue(e)?this.$(e):Mr(e)?e.collection():gt(e)?(t||(t={}),new Kt(this,e,t.unique,t.removed)):new Kt(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};Ls.elements=Ls.filter=Ls.$;var sr={},Da="t",Iw="f";sr.apply=function(r){for(var e=this,t=e._private,n=t.cy,i=n.collection(),a=0;a<r.length;a++){var o=r[a],s=e.getContextMeta(o);if(!s.empty){var u=e.getContextStyle(s),l=e.applyContextStyle(s,u,o);o._private.appliedInitStyle?e.updateTransitions(o,l.diffProps):o._private.appliedInitStyle=!0;var c=e.updateStyleHints(o);c&&i.push(o)}}return i};sr.getPropertiesDiff=function(r,e){var t=this,n=t._private.propDiffs=t._private.propDiffs||{},i=r+"-"+e,a=n[i];if(a)return a;for(var o=[],s={},u=0;u<t.length;u++){var l=t[u],c=r[u]===Da,d=e[u]===Da,f=c!==d,h=l.mappedProperties.length>0;if(f||d&&h){var v=void 0;f&&h||f?v=l.properties:h&&(v=l.mappedProperties);for(var p=0;p<v.length;p++){for(var m=v[p],g=m.name,y=!1,x=u+1;x<t.length;x++){var S=t[x],D=e[x]===Da;if(D&&(y=S.properties[m.name]!=null,y))break}!s[g]&&!y&&(s[g]=!0,o.push(g))}}}return n[i]=o,o};sr.getContextMeta=function(r){for(var e=this,t="",n,i=r._private.styleCxtKey||"",a=0;a<e.length;a++){var o=e[a],s=o.selector&&o.selector.matches(r);s?t+=Da:t+=Iw}return n=e.getPropertiesDiff(i,t),r._private.styleCxtKey=t,{key:t,diffPropNames:n,empty:n.length===0}};sr.getContextStyle=function(r){var e=r.key,t=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<t.length;a++){var o=t[a],s=e[a]===Da;if(s)for(var u=0;u<o.properties.length;u++){var l=o.properties[u];i[l.name]=l}}return n[e]=i,i};sr.applyContextStyle=function(r,e,t){for(var n=this,i=r.diffPropNames,a={},o=n.types,s=0;s<i.length;s++){var u=i[s],l=e[u],c=t.pstyle(u);if(!l)if(c)c.bypass?l={name:u,deleteBypassed:!0}:l={name:u,delete:!0};else continue;if(c!==l){if(l.mapped===o.fn&&c!=null&&c.mapping!=null&&c.mapping.value===l.value){var d=c.mapping,f=d.fnValue=l.value(t);if(f===d.prevFnValue)continue}var h=a[u]={prev:c};n.applyParsedProperty(t,l),h.next=t.pstyle(u),h.next&&h.next.bypass&&(h.next=h.next.bypassed)}}return{diffProps:a}};sr.updateStyleHints=function(r){var e=r._private,t=this,n=t.propertyGroupNames,i=t.propertyGroupKeys,a=function(G,$,te){return t.getPropertiesHash(G,$,te)},o=e.styleKey;if(r.removed())return!1;var s=e.group==="nodes",u=r._private.style;n=Object.keys(u);for(var l=0;l<i.length;l++){var c=i[l];e.styleKeys[c]=[Bi,Ta]}for(var d=function(G,$){return e.styleKeys[$][0]=La(G,e.styleKeys[$][0])},f=function(G,$){return e.styleKeys[$][1]=Ia(G,e.styleKeys[$][1])},h=function(G,$){d(G,$),f(G,$)},v=function(G,$){for(var te=0;te<G.length;te++){var q=G.charCodeAt(te);d(q,$),f(q,$)}},p=2e9,m=function(G){return-128<G&&G<128&&Math.floor(G)!==G?p-(G*1024|0):G},g=0;g<n.length;g++){var y=n[g],x=u[y];if(x!=null){var S=this.properties[y],D=S.type,P=S.groupKey,R=void 0;S.hashOverride!=null?R=S.hashOverride(r,x):x.pfValue!=null&&(R=x.pfValue);var L=S.enums==null?x.value:null,O=R!=null,I=L!=null,B=O||I,w=x.units;if(D.number&&B&&!D.multiple){var T=O?R:L;h(m(T),P),!O&&w!=null&&v(w,P)}else v(x.strValue,P)}}for(var E=[Bi,Ta],b=0;b<i.length;b++){var C=i[b],_=e.styleKeys[C];E[0]=La(_[0],E[0]),E[1]=Ia(_[1],E[1])}e.styleKey=Vm(E[0],E[1]);var M=e.styleKeys;e.labelDimsKey=Pn(M.labelDimensions);var A=a(r,["label"],M.labelDimensions);if(e.labelKey=Pn(A),e.labelStyleKey=Pn(hs(M.commonLabel,A)),!s){var F=a(r,["source-label"],M.labelDimensions);e.sourceLabelKey=Pn(F),e.sourceLabelStyleKey=Pn(hs(M.commonLabel,F));var N=a(r,["target-label"],M.labelDimensions);e.targetLabelKey=Pn(N),e.targetLabelStyleKey=Pn(hs(M.commonLabel,N))}if(s){var z=e.styleKeys,Y=z.nodeBody,U=z.nodeBorder,ee=z.nodeOutline,Q=z.backgroundImage,j=z.compound,K=z.pie,H=[Y,U,ee,Q,j,K].filter(function(k){return k!=null}).reduce(hs,[Bi,Ta]);e.nodeKey=Pn(H),e.hasPie=K!=null&&K[0]!==Bi&&K[1]!==Ta}return o!==e.styleKey};sr.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null};sr.applyParsedProperty=function(r,e){var t=this,n=e,i=r._private.style,a,o=t.types,s=t.properties[n.name].type,u=n.bypass,l=i[n.name],c=l&&l.bypass,d=r._private,f="mapping",h=function(Y){return Y==null?null:Y.pfValue!=null?Y.pfValue:Y.value},v=function(){var Y=h(l),U=h(n);t.checkTriggers(r,n.name,Y,U)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(n=e=this.parse(e.name,"bezier",u)),n.delete)return i[n.name]=void 0,v(),!0;if(n.deleteBypassed)return l?l.bypass?(l.bypassed=void 0,v(),!0):!1:(v(),!0);if(n.deleteBypass)return l?l.bypass?(i[n.name]=l.bypassed,v(),!0):!1:(v(),!0);var p=function(){ft("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case o.mapData:{for(var m=n.field.split("."),g=d.data,y=0;y<m.length&&g;y++){var x=m[y];g=g[x]}if(g==null)return p(),!1;var S;if(Ne(g)){var D=n.fieldMax-n.fieldMin;D===0?S=0:S=(g-n.fieldMin)/D}else return ft("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+g+"` for `"+r.id()+"` is non-numeric)"),!1;if(S<0?S=0:S>1&&(S=1),s.color){var P=n.valueMin[0],R=n.valueMax[0],L=n.valueMin[1],O=n.valueMax[1],I=n.valueMin[2],B=n.valueMax[2],w=n.valueMin[3]==null?1:n.valueMin[3],T=n.valueMax[3]==null?1:n.valueMax[3],E=[Math.round(P+(R-P)*S),Math.round(L+(O-L)*S),Math.round(I+(B-I)*S),Math.round(w+(T-w)*S)];a={bypass:n.bypass,name:n.name,value:E,strValue:"rgb("+E[0]+", "+E[1]+", "+E[2]+")"}}else if(s.number){var b=n.valueMin+(n.valueMax-n.valueMin)*S;a=this.parse(n.name,b,n.bypass,f)}else return!1;if(!a)return p(),!1;a.mapping=n,n=a;break}case o.data:{for(var C=n.field.split("."),_=d.data,M=0;M<C.length&&_;M++){var A=C[M];_=_[A]}if(_!=null&&(a=this.parse(n.name,_,n.bypass,f)),!a)return p(),!1;a.mapping=n,n=a;break}case o.fn:{var F=n.value,N=n.fnValue!=null?n.fnValue:F(r);if(n.prevFnValue=N,N==null)return ft("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+r.id()+"` is null)"),!1;if(a=this.parse(n.name,N,n.bypass,f),!a)return ft("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+r.id()+"` is invalid)"),!1;a.mapping=Jr(n),n=a;break}case void 0:break;default:return!1}return u?(c?n.bypassed=l.bypassed:n.bypassed=l,i[n.name]=n):c?l.bypassed=n:i[n.name]=n,v(),!0};sr.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),o=0;o<a.length;o++){var s=a[o],u=i[s];u!=null&&(u.bypass?u.bypassed=null:i[s]=null)}}};sr.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};sr.updateTransitions=function(r,e){var t=this,n=r._private,i=r.pstyle("transition-property").value,a=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var s={},u=!1,l=0;l<i.length;l++){var c=i[l],d=r.pstyle(c),f=e[c];if(f){var h=f.prev,v=h,p=f.next!=null?f.next:d,m=!1,g=void 0,y=1e-6;v&&(Ne(v.pfValue)&&Ne(p.pfValue)?(m=p.pfValue-v.pfValue,g=v.pfValue+y*m):Ne(v.value)&&Ne(p.value)?(m=p.value-v.value,g=v.value+y*m):gt(v.value)&&gt(p.value)&&(m=v.value[0]!==p.value[0]||v.value[1]!==p.value[1]||v.value[2]!==p.value[2],g=v.strValue),m&&(s[c]=p.strValue,this.applyBypass(r,c,g),u=!0))}}if(!u)return;n.transitioning=!0,new Ki(function(x){o>0?r.delayAnimation(o).play().promise().then(x):x()}).then(function(){return r.animation({style:s,duration:a,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1)};sr.checkTrigger=function(r,e,t,n,i,a){var o=this.properties[e],s=i(o);s!=null&&s(t,n)&&a(o)};sr.checkZOrderTrigger=function(r,e,t,n){var i=this;this.checkTrigger(r,e,t,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",r)})};sr.checkBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBounds},function(i){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),i.triggersBoundsOfParallelBeziers&&e==="curve-style"&&(t==="bezier"||n==="bezier")&&r.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()}),i.triggersBoundsOfConnectedEdges&&e==="display"&&(t==="none"||n==="none")&&r.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};sr.checkTriggers=function(r,e,t,n){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,n),this.checkBoundsTrigger(r,e,t,n)};var qa={};qa.applyBypass=function(r,e,t,n){var i=this,a=[],o=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var s=0;s<i.properties.length;s++){var u=i.properties[s],l=u.name,c=this.parse(l,t,!0);c&&a.push(c)}}else if(Ue(e)){var d=this.parse(e,t,!0);d&&a.push(d)}else if(ut(e)){var f=e;n=t;for(var h=Object.keys(f),v=0;v<h.length;v++){var p=h[v],m=f[p];if(m===void 0&&(m=f[Xs(p)]),m!==void 0){var g=this.parse(p,m,!0);g&&a.push(g)}}}else return!1;if(a.length===0)return!1;for(var y=!1,x=0;x<r.length;x++){for(var S=r[x],D={},P=void 0,R=0;R<a.length;R++){var L=a[R];if(n){var O=S.pstyle(L.name);P=D[L.name]={prev:O}}y=this.applyParsedProperty(S,Jr(L))||y,n&&(P.next=S.pstyle(L.name))}y&&this.updateStyleHints(S),n&&this.updateTransitions(S,D,o)}return y};qa.overrideBypass=function(r,e,t){e=xu(e);for(var n=0;n<r.length;n++){var i=r[n],a=i._private.style[e],o=this.properties[e].type,s=o.color,u=o.mutiple,l=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,t):(a.value=t,a.pfValue!=null&&(a.pfValue=t),s?a.strValue="rgb("+t.join(",")+")":u?a.strValue=t.join(" "):a.strValue=""+t,this.updateStyleHints(i)),this.checkTriggers(i,e,l,t)}};qa.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};qa.removeBypasses=function(r,e,t){for(var n=!0,i=0;i<r.length;i++){for(var a=r[i],o={},s=0;s<e.length;s++){var u=e[s],l=this.properties[u],c=a.pstyle(l.name);if(!(!c||!c.bypass)){var d="",f=this.parse(u,d,!0),h=o[l.name]={prev:c};this.applyParsedProperty(a,f),h.next=a.pstyle(l.name)}}this.updateStyleHints(a),t&&this.updateTransitions(a,o,n)}};var ku={};ku.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};ku.containerCss=function(r){var e=this._private.cy,t=e.container(),n=e.window();if(n&&t&&n.getComputedStyle)return n.getComputedStyle(t).getPropertyValue(r)};var tn={};tn.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};tn.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var n={},i=0;i<t.properties.length;i++){var a=t.properties[i],o=t.getStylePropertyValue(r,a.name,e);o!=null&&(n[a.name]=o,n[Xs(a.name)]=o)}return n}};tn.getIndexedStyle=function(r,e,t,n){var i=r.pstyle(e)[t][n];return i??r.cy().style().getDefaultProperty(e)[t][0]};tn.getStylePropertyValue=function(r,e,t){var n=this;if(r=r[0],r){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,o=r.pstyle(i.name);if(o){var s=o.value,u=o.units,l=o.strValue;if(t&&a.number&&s!=null&&Ne(s)){var c=r.cy().zoom(),d=function(m){return m*c},f=function(m,g){return d(m)+g},h=gt(s),v=h?u.every(function(p){return p!=null}):u!=null;return v?h?s.map(function(p,m){return f(p,u[m])}).join(" "):f(s,u):h?s.map(function(p){return Ue(p)?p:""+d(p)}).join(" "):""+d(s)}else if(l!=null)return l}return null}};tn.getAnimationStartStyle=function(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],a=i.name,o=r.pstyle(a);o!==void 0&&(ut(o)?o=this.parse(a,o.strValue):o=this.parse(a,o)),o&&(t[a]=o)}return t};tn.getPropsList=function(r){var e=this,t=[],n=r,i=e.properties;if(n)for(var a=Object.keys(n),o=0;o<a.length;o++){var s=a[o],u=n[s],l=i[s]||i[xu(s)],c=this.parse(l.name,u);c&&t.push(c)}return t};tn.getNonDefaultPropertiesHash=function(r,e,t){var n=t.slice(),i,a,o,s,u,l;for(u=0;u<e.length;u++)if(i=e[u],a=r.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=La(s,n[0]),n[1]=Ia(s,n[1]);else for(o=a.strValue,l=0;l<o.length;l++)s=o.charCodeAt(l),n[0]=La(s,n[0]),n[1]=Ia(s,n[1]);return n};tn.getPropertiesHash=tn.getNonDefaultPropertiesHash;var ol={};ol.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var n=r[t],i=n.selector,a=n.style||n.css,o=Object.keys(a);e.selector(i);for(var s=0;s<o.length;s++){var u=o[s],l=a[u];e.css(u,l)}}return e};ol.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};ol.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],n=t.selector,i=t.properties,a={},o=0;o<i.length;o++){var s=i[o];a[s.name]=s.strValue}r.push({selector:n?n.toString():"core",style:a})}return r};var Fu={};Fu.appendFromString=function(r){var e=this,t=this,n=""+r,i,a,o;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){n.length>i.length?n=n.substr(i.length):n=""}function u(){a.length>o.length?a=a.substr(o.length):a=""}for(;;){var l=n.match(/^\s*$/);if(l)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){ft("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var d=c[1];if(d!=="core"){var f=new Vn(d);if(f.invalid){ft("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),s();continue}}var h=c[2],v=!1;a=h;for(var p=[];;){var m=a.match(/^\s*$/);if(m)break;var g=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!g){ft("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+h),v=!0;break}o=g[0];var y=g[1],x=g[2],S=e.properties[y];if(!S){ft("Skipping property: Invalid property name in: "+o),u();continue}var D=t.parse(y,x);if(!D){ft("Skipping property: Invalid property definition in: "+o),u();continue}p.push({name:y,val:x}),u()}if(v){s();break}t.selector(d);for(var P=0;P<p.length;P++){var R=p[P];t.css(R.name,R.val)}s()}return t};Fu.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var Xt={};(function(){var r=Bt,e=Hg,t=$g,n=Wg,i=Yg,a=function(H){return"^"+H+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(H){var k=r+"|\\w+|"+e+"|"+t+"|"+n+"|"+i;return"^"+H+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+k+")\\s*\\,\\s*("+k+")\\)$"},s=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Xt.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:s,singleRegexMatchValue:!0},urls:{regexes:s,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(H,k){switch(H.length){case 2:return k[0]!=="deg"&&k[0]!=="rad"&&k[1]!=="deg"&&k[1]!=="rad";case 1:return Ue(H[0])||k[0]==="deg"||k[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(H){var k=H.length;return k===1||k===2||k===4}}};var u={zeroNonZero:function(H,k){return(H==null||k==null)&&H!==k||H==0&&k!=0?!0:H!=0&&k==0},any:function(H,k){return H!=k},emptyNonEmpty:function(H,k){var G=kn(H),$=kn(k);return G&&!$||!G&&$}},l=Xt.types,c=[{name:"label",type:l.text,triggersBounds:u.any,triggersZOrder:u.emptyNonEmpty},{name:"text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any}],d=[{name:"source-label",type:l.text,triggersBounds:u.any},{name:"source-text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"source-text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"source-text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"source-text-offset",type:l.size,triggersBounds:u.any}],f=[{name:"target-label",type:l.text,triggersBounds:u.any},{name:"target-text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"target-text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"target-text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"target-text-offset",type:l.size,triggersBounds:u.any}],h=[{name:"font-family",type:l.fontFamily,triggersBounds:u.any},{name:"font-style",type:l.fontStyle,triggersBounds:u.any},{name:"font-weight",type:l.fontWeight,triggersBounds:u.any},{name:"font-size",type:l.size,triggersBounds:u.any},{name:"text-transform",type:l.textTransform,triggersBounds:u.any},{name:"text-wrap",type:l.textWrap,triggersBounds:u.any},{name:"text-overflow-wrap",type:l.textOverflowWrap,triggersBounds:u.any},{name:"text-max-width",type:l.size,triggersBounds:u.any},{name:"text-outline-width",type:l.size,triggersBounds:u.any},{name:"line-height",type:l.positiveNumber,triggersBounds:u.any}],v=[{name:"text-valign",type:l.valign,triggersBounds:u.any},{name:"text-halign",type:l.halign,triggersBounds:u.any},{name:"color",type:l.color},{name:"text-outline-color",type:l.color},{name:"text-outline-opacity",type:l.zeroOneNumber},{name:"text-background-color",type:l.color},{name:"text-background-opacity",type:l.zeroOneNumber},{name:"text-background-padding",type:l.size,triggersBounds:u.any},{name:"text-border-opacity",type:l.zeroOneNumber},{name:"text-border-color",type:l.color},{name:"text-border-width",type:l.size,triggersBounds:u.any},{name:"text-border-style",type:l.borderStyle,triggersBounds:u.any},{name:"text-background-shape",type:l.textBackgroundShape,triggersBounds:u.any},{name:"text-justification",type:l.justification}],p=[{name:"events",type:l.bool,triggersZOrder:u.any},{name:"text-events",type:l.bool,triggersZOrder:u.any}],m=[{name:"display",type:l.display,triggersZOrder:u.any,triggersBounds:u.any,triggersBoundsOfConnectedEdges:!0},{name:"visibility",type:l.visibility,triggersZOrder:u.any},{name:"opacity",type:l.zeroOneNumber,triggersZOrder:u.zeroNonZero},{name:"text-opacity",type:l.zeroOneNumber},{name:"min-zoomed-font-size",type:l.size},{name:"z-compound-depth",type:l.zCompoundDepth,triggersZOrder:u.any},{name:"z-index-compare",type:l.zIndexCompare,triggersZOrder:u.any},{name:"z-index",type:l.number,triggersZOrder:u.any}],g=[{name:"overlay-padding",type:l.size,triggersBounds:u.any},{name:"overlay-color",type:l.color},{name:"overlay-opacity",type:l.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"overlay-shape",type:l.overlayShape,triggersBounds:u.any},{name:"overlay-corner-radius",type:l.cornerRadius}],y=[{name:"underlay-padding",type:l.size,triggersBounds:u.any},{name:"underlay-color",type:l.color},{name:"underlay-opacity",type:l.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"underlay-shape",type:l.overlayShape,triggersBounds:u.any},{name:"underlay-corner-radius",type:l.cornerRadius}],x=[{name:"transition-property",type:l.propList},{name:"transition-duration",type:l.time},{name:"transition-delay",type:l.time},{name:"transition-timing-function",type:l.easing}],S=function(H,k){return k.value==="label"?-H.poolIndex():k.pfValue},D=[{name:"height",type:l.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"width",type:l.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"shape",type:l.nodeShape,triggersBounds:u.any},{name:"shape-polygon-points",type:l.polygonPointList,triggersBounds:u.any},{name:"corner-radius",type:l.cornerRadius},{name:"background-color",type:l.color},{name:"background-fill",type:l.fill},{name:"background-opacity",type:l.zeroOneNumber},{name:"background-blacken",type:l.nOneOneNumber},{name:"background-gradient-stop-colors",type:l.colors},{name:"background-gradient-stop-positions",type:l.percentages},{name:"background-gradient-direction",type:l.gradientDirection},{name:"padding",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"padding-relative-to",type:l.paddingRelativeTo,triggersBounds:u.any},{name:"bounds-expansion",type:l.boundsExpansion,triggersBounds:u.any}],P=[{name:"border-color",type:l.color},{name:"border-opacity",type:l.zeroOneNumber},{name:"border-width",type:l.size,triggersBounds:u.any},{name:"border-style",type:l.borderStyle},{name:"border-cap",type:l.lineCap},{name:"border-join",type:l.lineJoin},{name:"border-dash-pattern",type:l.numbers},{name:"border-dash-offset",type:l.number},{name:"border-position",type:l.linePosition}],R=[{name:"outline-color",type:l.color},{name:"outline-opacity",type:l.zeroOneNumber},{name:"outline-width",type:l.size,triggersBounds:u.any},{name:"outline-style",type:l.borderStyle},{name:"outline-offset",type:l.size,triggersBounds:u.any}],L=[{name:"background-image",type:l.urls},{name:"background-image-crossorigin",type:l.bgCrossOrigin},{name:"background-image-opacity",type:l.zeroOneNumbers},{name:"background-image-containment",type:l.bgContainment},{name:"background-image-smoothing",type:l.bools},{name:"background-position-x",type:l.bgPos},{name:"background-position-y",type:l.bgPos},{name:"background-width-relative-to",type:l.bgRelativeTo},{name:"background-height-relative-to",type:l.bgRelativeTo},{name:"background-repeat",type:l.bgRepeat},{name:"background-fit",type:l.bgFit},{name:"background-clip",type:l.bgClip},{name:"background-width",type:l.bgWH},{name:"background-height",type:l.bgWH},{name:"background-offset-x",type:l.bgPos},{name:"background-offset-y",type:l.bgPos}],O=[{name:"position",type:l.position,triggersBounds:u.any},{name:"compound-sizing-wrt-labels",type:l.compoundIncludeLabels,triggersBounds:u.any},{name:"min-width",type:l.size,triggersBounds:u.any},{name:"min-width-bias-left",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-width-bias-right",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-height",type:l.size,triggersBounds:u.any},{name:"min-height-bias-top",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-height-bias-bottom",type:l.sizeMaybePercent,triggersBounds:u.any}],I=[{name:"line-style",type:l.lineStyle},{name:"line-color",type:l.color},{name:"line-fill",type:l.fill},{name:"line-cap",type:l.lineCap},{name:"line-opacity",type:l.zeroOneNumber},{name:"line-dash-pattern",type:l.numbers},{name:"line-dash-offset",type:l.number},{name:"line-outline-width",type:l.size},{name:"line-outline-color",type:l.color},{name:"line-gradient-stop-colors",type:l.colors},{name:"line-gradient-stop-positions",type:l.percentages},{name:"curve-style",type:l.curveStyle,triggersBounds:u.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:l.zeroOneNumber,triggersBounds:u.any},{name:"source-endpoint",type:l.edgeEndpoint,triggersBounds:u.any},{name:"target-endpoint",type:l.edgeEndpoint,triggersBounds:u.any},{name:"control-point-step-size",type:l.size,triggersBounds:u.any},{name:"control-point-distances",type:l.bidirectionalSizes,triggersBounds:u.any},{name:"control-point-weights",type:l.numbers,triggersBounds:u.any},{name:"segment-distances",type:l.bidirectionalSizes,triggersBounds:u.any},{name:"segment-weights",type:l.numbers,triggersBounds:u.any},{name:"segment-radii",type:l.numbers,triggersBounds:u.any},{name:"radius-type",type:l.radiusType,triggersBounds:u.any},{name:"taxi-turn",type:l.bidirectionalSizeMaybePercent,triggersBounds:u.any},{name:"taxi-turn-min-distance",type:l.size,triggersBounds:u.any},{name:"taxi-direction",type:l.axisDirection,triggersBounds:u.any},{name:"taxi-radius",type:l.number,triggersBounds:u.any},{name:"edge-distances",type:l.edgeDistances,triggersBounds:u.any},{name:"arrow-scale",type:l.positiveNumber,triggersBounds:u.any},{name:"loop-direction",type:l.angle,triggersBounds:u.any},{name:"loop-sweep",type:l.angle,triggersBounds:u.any},{name:"source-distance-from-node",type:l.size,triggersBounds:u.any},{name:"target-distance-from-node",type:l.size,triggersBounds:u.any}],B=[{name:"ghost",type:l.bool,triggersBounds:u.any},{name:"ghost-offset-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"ghost-offset-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"ghost-opacity",type:l.zeroOneNumber}],w=[{name:"selection-box-color",type:l.color},{name:"selection-box-opacity",type:l.zeroOneNumber},{name:"selection-box-border-color",type:l.color},{name:"selection-box-border-width",type:l.size},{name:"active-bg-color",type:l.color},{name:"active-bg-opacity",type:l.zeroOneNumber},{name:"active-bg-size",type:l.size},{name:"outside-texture-bg-color",type:l.color},{name:"outside-texture-bg-opacity",type:l.zeroOneNumber}],T=[];Xt.pieBackgroundN=16,T.push({name:"pie-size",type:l.sizeMaybePercent});for(var E=1;E<=Xt.pieBackgroundN;E++)T.push({name:"pie-"+E+"-background-color",type:l.color}),T.push({name:"pie-"+E+"-background-size",type:l.percent}),T.push({name:"pie-"+E+"-background-opacity",type:l.zeroOneNumber});var b=[],C=Xt.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:l.arrowShape,triggersBounds:u.any},{name:"arrow-color",type:l.color},{name:"arrow-fill",type:l.arrowFill},{name:"arrow-width",type:l.arrowWidth}].forEach(function(K){C.forEach(function(H){var k=H+"-"+K.name,G=K.type,$=K.triggersBounds;b.push({name:k,type:G,triggersBounds:$})})},{});var _=Xt.properties=[].concat(p,x,m,g,y,B,v,h,c,d,f,D,P,R,L,T,O,I,b,w),M=Xt.propertyGroups={behavior:p,transition:x,visibility:m,overlay:g,underlay:y,ghost:B,commonLabel:v,labelDimensions:h,mainLabel:c,sourceLabel:d,targetLabel:f,nodeBody:D,nodeBorder:P,nodeOutline:R,backgroundImage:L,pie:T,compound:O,edgeLine:I,edgeArrow:b,core:w},A=Xt.propertyGroupNames={},F=Xt.propertyGroupKeys=Object.keys(M);F.forEach(function(K){A[K]=M[K].map(function(H){return H.name}),M[K].forEach(function(H){return H.groupKey=K})});var N=Xt.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Xt.propertyNames=_.map(function(K){return K.name});for(var z=0;z<_.length;z++){var Y=_[z];_[Y.name]=Y}for(var U=0;U<N.length;U++){var ee=N[U],Q=_[ee.pointsTo],j={name:ee.name,alias:!0,pointsTo:Q};_.push(j),_[ee.name]=j}})();Xt.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};Xt.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Ye({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(u,l){for(var c=1;c<=Xt.pieBackgroundN;c++){var d=l.name.replace("{{i}}",c),f=l.value;u[d]=f}return u},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(u,l){return Xt.arrowPrefixes.forEach(function(c){var d=c+"-"+l.name,f=l.value;u[d]=f}),u},{})),t={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,o=e[a],s=this.parse(a,o);t[a]=s}}return r.defaultProperties=t,r.defaultProperties};Xt.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var sl={};sl.parse=function(r,e,t,n){var i=this;if(_t(e))return i.parseImplWarn(r,e,t,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,o=t?"t":"f",s=""+e,u=Yf(r,s,o,a),l=i.propCache=i.propCache||[],c;return(c=l[u])||(c=l[u]=i.parseImplWarn(r,e,t,n)),(t||n==="mapping")&&(c=Jr(c),c&&(c.value=Jr(c.value))),c};sl.parseImplWarn=function(r,e,t,n){var i=this.parseImpl(r,e,t,n);return!i&&e!=null&&ft("The style property `".concat(r,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&ft("The style value of `label` is deprecated for `"+i.name+"`"),i};sl.parseImpl=function(r,e,t,n){var i=this;r=xu(r);var a=i.properties[r],o=e,s=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,r=a.name);var u=Ue(e);u&&(e=e.trim());var l=a.type;if(!l)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(_t(e))return{name:r,value:e,strValue:"fn",mapped:s.fn,bypass:t};var c,d;if(!(!u||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(s.data.regex).exec(e))){if(t)return!1;var f=s.data;return{name:r,value:c,strValue:""+e,mapped:f,field:c[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(s.mapData.regex).exec(e))){if(t||l.multiple)return!1;var h=s.mapData;if(!(l.color||l.number))return!1;var v=this.parse(r,d[4]);if(!v||v.mapped)return!1;var p=this.parse(r,d[5]);if(!p||p.mapped)return!1;if(v.pfValue===p.pfValue||v.strValue===p.strValue)return ft("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+v.strValue+"`"),this.parse(r,v.strValue);if(l.color){var m=v.value,g=p.value,y=m[0]===g[0]&&m[1]===g[1]&&m[2]===g[2]&&(m[3]===g[3]||(m[3]==null||m[3]===1)&&(g[3]==null||g[3]===1));if(y)return!1}return{name:r,value:d,strValue:""+e,mapped:h,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:v.value,valueMax:p.value,bypass:t}}}if(l.multiple&&n!=="multiple"){var x;if(u?x=e.split(/\s+/):gt(e)?x=e:x=[e],l.evenMultiple&&x.length%2!==0)return null;for(var S=[],D=[],P=[],R="",L=!1,O=0;O<x.length;O++){var I=i.parse(r,x[O],t,"multiple");L=L||Ue(I.value),S.push(I.value),P.push(I.pfValue!=null?I.pfValue:I.value),D.push(I.units),R+=(O>0?" ":"")+I.strValue}return l.validate&&!l.validate(S,D)?null:l.singleEnum&&L?S.length===1&&Ue(S[0])?{name:r,value:S[0],strValue:S[0],bypass:t}:null:{name:r,value:S,pfValue:P,strValue:R,bypass:t,units:D}}var B=function(){for(var H=0;H<l.enums.length;H++){var k=l.enums[H];if(k===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(l.number){var w,T="px";if(l.units&&(w=l.units),l.implicitUnits&&(T=l.implicitUnits),!l.unitless)if(u){var E="px|em"+(l.allowPercent?"|\\%":"");w&&(E=w);var b=e.match("^("+Bt+")("+E+")?$");b&&(e=b[1],w=b[2]||T)}else(!w||l.implicitUnits)&&(w=T);if(e=parseFloat(e),isNaN(e)&&l.enums===void 0)return null;if(isNaN(e)&&l.enums!==void 0)return e=o,B();if(l.integer&&!kg(e)||l.min!==void 0&&(e<l.min||l.strictMin&&e===l.min)||l.max!==void 0&&(e>l.max||l.strictMax&&e===l.max))return null;var C={name:r,value:e,strValue:""+e+(w||""),units:w,bypass:t};return l.unitless||w!=="px"&&w!=="em"?C.pfValue=e:C.pfValue=w==="px"||!w?e:this.getEmSizeInPixels()*e,(w==="ms"||w==="s")&&(C.pfValue=w==="ms"?e:1e3*e),(w==="deg"||w==="rad")&&(C.pfValue=w==="rad"?e:p0(e)),w==="%"&&(C.pfValue=e/100),C}else if(l.propList){var _=[],M=""+e;if(M!=="none"){for(var A=M.split(/\s*,\s*|\s+/),F=0;F<A.length;F++){var N=A[F].trim();i.properties[N]?_.push(N):ft("`"+N+"` is not a valid property name")}if(_.length===0)return null}return{name:r,value:_,strValue:_.length===0?"none":_.join(" "),bypass:t}}else if(l.color){var z=Vf(e);return z?{name:r,value:z,pfValue:z,strValue:"rgb("+z[0]+","+z[1]+","+z[2]+")",bypass:t}:null}else if(l.regex||l.regexes){if(l.enums){var Y=B();if(Y)return Y}for(var U=l.regexes?l.regexes:[l.regex],ee=0;ee<U.length;ee++){var Q=new RegExp(U[ee]),j=Q.exec(e);if(j)return{name:r,value:l.singleRegexMatchValue?j[1]:j,strValue:""+e,bypass:t}}return null}else return l.string?{name:r,value:""+e,strValue:""+e,bypass:t}:l.enums?B():null};var ir=function r(e){if(!(this instanceof r))return new r(e);if(!bu(e)){Tt("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},or=ir.prototype;or.instanceString=function(){return"style"};or.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};or.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};or.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};or.selector=function(r){var e=r==="core"?null:new Vn(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};or.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],n=0;n<r.properties.length;n++){var i=r.properties[n],a=t[i.name];a===void 0&&(a=t[Xs(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};or.style=or.css;or.cssRule=function(r,e){var t=this.parse(r,e);if(t){var n=this.length-1;this[n].properties.push(t),this[n].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.mapped&&this[n].mappedProperties.push(t);var i=!this[n].selector;i&&(this._private.coreStyle[t.name]=t)}return this};or.append=function(r){return kf(r)?r.appendToStyle(this):gt(r)?this.appendFromJson(r):Ue(r)&&this.appendFromString(r),this};ir.fromJson=function(r,e){var t=new ir(r);return t.fromJson(e),t};ir.fromString=function(r,e){return new ir(r).fromString(e)};[sr,qa,ku,tn,ol,Fu,Xt,sl].forEach(function(r){Ye(or,r)});ir.types=or.types;ir.properties=or.properties;ir.propertyGroups=or.propertyGroups;ir.propertyGroupNames=or.propertyGroupNames;ir.propertyGroupKeys=or.propertyGroupKeys;var Nw={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return kf(e)?t.style=e.generateStyle(this):gt(e)?t.style=ir.fromJson(this,e):Ue(e)?t.style=ir.fromString(this,e):t.style=ir(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},kw="single",li={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=kw),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,n,i,a,o,s;switch(e.length){case 0:return t;case 1:if(Ue(e[0]))return n=e[0],t[n];if(ut(e[0])){if(!this._private.panningEnabled)return this;a=e[0],o=a.x,s=a.y,Ne(o)&&(t.x=o),Ne(s)&&(t.y=s),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Ne(i)&&(t[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var n=arguments,i=this._private.pan,a,o,s,u,l;if(!this._private.panningEnabled)return this;switch(n.length){case 1:ut(e)&&(s=n[0],u=s.x,l=s.y,Ne(u)&&(i.x+=u),Ne(l)&&(i.y+=l),this.emit("pan viewport"));break;case 2:a=e,o=t,(a==="x"||a==="y")&&Ne(o)&&(i[a]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(Ne(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Ue(e)){var i=e;e=this.$(i)}else if(Vg(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Mr(e)||(e=this.mutableElements());if(!(Mr(e)&&e.empty())){n=n||e.boundingBox();var o=this.width(),s=this.height(),u;if(t=Ne(t)?t:0,!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){u=Math.min((o-2*t)/n.w,(s-2*t)/n.h),u=u>this._private.maxZoom?this._private.maxZoom:u,u=u<this._private.minZoom?this._private.minZoom:u;var l={x:(o-u*(n.x1+n.x2))/2,y:(s-u*(n.y1+n.y2))/2};return{zoom:u,pan:l}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var i=e;e=i.min,t=i.max}return Ne(e)&&Ne(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):Ne(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:Ne(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,n=t.pan,i=t.zoom,a,o,s=!1;if(t.zoomingEnabled||(s=!0),Ne(e)?o=e:ut(e)&&(o=e.level,e.position!=null?a=Zs(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!t.panningEnabled&&(s=!0)),o=o>t.maxZoom?t.maxZoom:o,o=o<t.minZoom?t.minZoom:o,s||!Ne(o)||o===i||a!=null&&(!Ne(a.x)||!Ne(a.y)))return null;if(a!=null){var u=n,l=i,c=o,d={x:-c/l*(a.x-u.x)+a.x,y:-c/l*(a.y-u.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:d}}else return{zoomed:!0,panned:!1,zoom:o,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t==null||!t.zoomed?this:(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,n=!0,i=!0,a=[],o=!1,s=!1;if(!e)return this;if(Ne(e.zoom)||(n=!1),ut(e.pan)||(i=!1),!n&&!i)return this;if(n){var u=e.zoom;u<t.minZoom||u>t.maxZoom||!t.zoomingEnabled?o=!0:(t.zoom=u,a.push("zoom"))}if(i&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var l=e.pan;Ne(l.x)&&(t.pan.x=l.x,s=!1),Ne(l.y)&&(t.pan.y=l.y,s=!1),s||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(Ue(e)){var n=e;e=this.mutableElements().filter(n)}else Mr(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(a-t*(i.x1+i.x2))/2,y:(o-t*(i.y1+i.y2))/2};return s}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container,n=this;return e.sizeCache=e.sizeCache||(t?function(){var i=n.window().getComputedStyle(t),a=function(s){return parseFloat(i.getPropertyValue(s))};return{width:t.clientWidth-a("padding-left")-a("padding-right"),height:t.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};li.centre=li.center;li.autolockNodes=li.autolock;li.autoungrabifyNodes=li.autoungrabify;var Ga={data:dt.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:dt.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:dt.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:dt.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Ga.attr=Ga.data;Ga.removeAttr=Ga.removeData;var ja=function(e){var t=this;e=Ye({},e);var n=e.container;n&&!ks(n)&&ks(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=t;var o=Ft!==void 0&&n!==void 0&&!e.headless,s=e;s.layout=Ye({name:o?"grid":"null"},s.layout),s.renderer=Ye({name:o?"canvas":"null"},s.renderer);var u=function(v,p,m){return p!==void 0?p:m!==void 0?m:v},l=this._private={container:n,ready:!1,options:s,elements:new Kt(this),listeners:[],aniEles:new Kt(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,s.zoomingEnabled),userZoomingEnabled:u(!0,s.userZoomingEnabled),panningEnabled:u(!0,s.panningEnabled),userPanningEnabled:u(!0,s.userPanningEnabled),boxSelectionEnabled:u(!0,s.boxSelectionEnabled),autolock:u(!1,s.autolock,s.autolockNodes),autoungrabify:u(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:u(!1,s.autounselectify),styleEnabled:s.styleEnabled===void 0?o:s.styleEnabled,zoom:Ne(s.zoom)?s.zoom:1,pan:{x:ut(s.pan)&&Ne(s.pan.x)?s.pan.x:0,y:ut(s.pan)&&Ne(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:u(250,s.multiClickDebounceTime)};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});var c=function(v,p){var m=v.some(zg);if(m)return Ki.all(v).then(p);p(v)};l.styleEnabled&&t.setStyle([]);var d=Ye({},s,s.renderer);t.initRenderer(d);var f=function(v,p,m){t.notifications(!1);var g=t.mutableElements();g.length>0&&g.remove(),v!=null&&(ut(v)||gt(v))&&t.add(v),t.one("layoutready",function(x){t.notifications(!0),t.emit(x),t.one("load",p),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",m),t.emit("done")});var y=Ye({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};c([s.style,s.elements],function(h){var v=h[0],p=h[1];l.styleEnabled&&t.style().append(v),f(p,function(){t.startAnimationLoop(),l.ready=!0,_t(s.ready)&&t.on("ready",s.ready);for(var m=0;m<a.length;m++){var g=a[m];t.on("ready",g)}i&&(i.readies=[]),t.emit("ready")},s.done)})},Hs=ja.prototype;Ye(Hs,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Ft;var t=this._private.container.ownerDocument;return t===void 0||t==null?Ft:t.defaultView||Ft},mount:function(e){if(e!=null){var t=this,n=t._private,i=n.options;return!ks(e)&&ks(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(Ye({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),t.startAnimationLoop(),t.style(i.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Jr(this._private.options)},json:function(e){var t=this,n=t._private,i=t.mutableElements(),a=function(S){return t.getElementById(S.id())};if(ut(e)){if(t.startBatch(),e.elements){var o={},s=function(S,D){for(var P=[],R=[],L=0;L<S.length;L++){var O=S[L];if(!O.data.id){ft("cy.json() cannot handle elements without an ID attribute");continue}var I=""+O.data.id,B=t.getElementById(I);o[I]=!0,B.length!==0?R.push({ele:B,json:O}):(D&&(O.group=D),P.push(O))}t.add(P);for(var w=0;w<R.length;w++){var T=R[w],E=T.ele,b=T.json;E.json(b)}};if(gt(e.elements))s(e.elements);else for(var u=["nodes","edges"],l=0;l<u.length;l++){var c=u[l],d=e.elements[c];gt(d)&&s(d,c)}var f=t.collection();i.filter(function(x){return!o[x.id()]}).forEach(function(x){x.isParent()?f.merge(x):x.remove()}),f.forEach(function(x){return x.children().move({parent:null})}),f.forEach(function(x){return a(x).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var h=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<h.length;v++){var p=h[v];e[p]!=null&&t[p](e[p])}return t.endBatch(),this}else{var m=!!e,g={};m?g.elements=this.elements().map(function(x){return x.json()}):(g.elements={},i.forEach(function(x){var S=x.group();g.elements[S]||(g.elements[S]=[]),g.elements[S].push(x.json())})),this._private.styleEnabled&&(g.style=t.style().json()),g.data=Jr(t.data());var y=n.options;return g.zoomingEnabled=n.zoomingEnabled,g.userZoomingEnabled=n.userZoomingEnabled,g.zoom=n.zoom,g.minZoom=n.minZoom,g.maxZoom=n.maxZoom,g.panningEnabled=n.panningEnabled,g.userPanningEnabled=n.userPanningEnabled,g.pan=Jr(n.pan),g.boxSelectionEnabled=n.boxSelectionEnabled,g.renderer=Jr(y.renderer),g.hideEdgesOnViewport=y.hideEdgesOnViewport,g.textureOnViewport=y.textureOnViewport,g.wheelSensitivity=y.wheelSensitivity,g.motionBlur=y.motionBlur,g.multiClickDebounceTime=y.multiClickDebounceTime,g}}});Hs.$id=Hs.getElementById;[_w,Pw,Bh,cu,Os,Ow,du,Ls,Nw,li,Ga].forEach(function(r){Ye(Hs,r)});var Fw={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Bw={maximal:!1,acyclic:!1},ki=function(e){return e.scratch("breadthfirst")},of=function(e,t){return e.scratch("breadthfirst",t)};function Vh(r){this.options=Ye({},Fw,Bw,r)}Vh.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=t.nodes().filter(function(ue){return ue.isChildless()}),i=t,a=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,s=!!r.boundingBox,u=e.extent(),l=br(s?r.boundingBox:{x1:u.x1,y1:u.y1,w:u.w,h:u.h}),c;if(Mr(r.roots))c=r.roots;else if(gt(r.roots)){for(var d=[],f=0;f<r.roots.length;f++){var h=r.roots[f],v=e.getElementById(h);d.push(v)}c=e.collection(d)}else if(Ue(r.roots))c=e.$(r.roots);else if(a)c=n.roots();else{var p=t.components();c=e.collection();for(var m=function(de){var me=p[de],_e=me.maxDegree(!1),xe=me.filter(function(Ce){return Ce.degree(!1)===_e});c=c.add(xe)},g=0;g<p.length;g++)m(g)}var y=[],x={},S=function(de,me){y[me]==null&&(y[me]=[]);var _e=y[me].length;y[me].push(de),of(de,{index:_e,depth:me})},D=function(de,me){var _e=ki(de),xe=_e.depth,Ce=_e.index;y[xe][Ce]=null,de.isChildless()&&S(de,me)};i.bfs({roots:c,directed:r.directed,visit:function(de,me,_e,xe,Ce){var Ee=de[0],be=Ee.id();Ee.isChildless()&&S(Ee,Ce),x[be]=!0}});for(var P=[],R=0;R<n.length;R++){var L=n[R];x[L.id()]||P.push(L)}var O=function(de){for(var me=y[de],_e=0;_e<me.length;_e++){var xe=me[_e];if(xe==null){me.splice(_e,1),_e--;continue}of(xe,{depth:de,index:_e})}},I=function(de,me){for(var _e=ki(de),xe=de.incomers().filter(function(le){return le.isNode()&&t.has(le)}),Ce=-1,Ee=de.id(),be=0;be<xe.length;be++){var fe=xe[be],V=ki(fe);Ce=Math.max(Ce,V.depth)}if(_e.depth<=Ce){if(!r.acyclic&&me[Ee])return null;var re=Ce+1;return D(de,re),me[Ee]=re,!0}return!1};if(a&&o){var B=[],w={},T=function(de){return B.push(de)},E=function(){return B.shift()};for(n.forEach(function(ue){return B.push(ue)});B.length>0;){var b=E(),C=I(b,w);if(C)b.outgoers().filter(function(ue){return ue.isNode()&&t.has(ue)}).forEach(T);else if(C===null){ft("Detected double maximal shift for node `"+b.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var _=0;if(r.avoidOverlap)for(var M=0;M<n.length;M++){var A=n[M],F=A.layoutDimensions(r),N=F.w,z=F.h;_=Math.max(_,N,z)}var Y={},U=function(de){if(Y[de.id()])return Y[de.id()];for(var me=ki(de).depth,_e=de.neighborhood(),xe=0,Ce=0,Ee=0;Ee<_e.length;Ee++){var be=_e[Ee];if(!(be.isEdge()||be.isParent()||!n.has(be))){var fe=ki(be);if(fe!=null){var V=fe.index,re=fe.depth;if(!(V==null||re==null)){var le=y[re].length;re<me&&(xe+=V/le,Ce++)}}}}return Ce=Math.max(1,Ce),xe=xe/Ce,Ce===0&&(xe=0),Y[de.id()]=xe,xe},ee=function(de,me){var _e=U(de),xe=U(me),Ce=_e-xe;return Ce===0?Bf(de.id(),me.id()):Ce};r.depthSort!==void 0&&(ee=r.depthSort);for(var Q=y.length,j=0;j<Q;j++)y[j].sort(ee),O(j);for(var K=[],H=0;H<P.length;H++)K.push(P[H]);var k=function(){for(var de=0;de<Q;de++)O(de)};K.length&&(y.unshift(K),Q=y.length,k());for(var G=0,$=0;$<Q;$++)G=Math.max(y[$].length,G);var te={x:l.x1+l.w/2,y:l.y1+l.h/2},q=n.reduce(function(ue,de){return function(me){return{w:ue.w===-1?me.w:(ue.w+me.w)/2,h:ue.h===-1?me.h:(ue.h+me.h)/2}}(de.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),ge=Math.max(Q===1?0:s?(l.h-r.padding*2-q.h)/(Q-1):(l.h-r.padding*2-q.h)/(Q+1),_),Te=y.reduce(function(ue,de){return Math.max(ue,de.length)},0),he=function(de){var me=ki(de),_e=me.depth,xe=me.index;if(r.circle){var Ce=Math.min(l.w/2/Q,l.h/2/Q);Ce=Math.max(Ce,_);var Ee=Ce*_e+Ce-(Q>0&&y[0].length<=3?Ce/2:0),be=2*Math.PI/y[_e].length*xe;return _e===0&&y[0].length===1&&(Ee=1),{x:te.x+Ee*Math.cos(be),y:te.y+Ee*Math.sin(be)}}else{var fe=y[_e].length,V=Math.max(fe===1?0:s?(l.w-r.padding*2-q.w)/((r.grid?Te:fe)-1):(l.w-r.padding*2-q.w)/((r.grid?Te:fe)+1),_),re={x:te.x+(xe+1-(fe+1)/2)*V,y:te.y+(_e+1-(Q+1)/2)*ge};return re}};return t.nodes().layoutPositions(this,r,he),this};var Vw={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function zh(r){this.options=Ye({},Vw,r)}zh.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var o=br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},u=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,l=u/Math.max(1,a.length-1),c,d=0,f=0;f<a.length;f++){var h=a[f],v=h.layoutDimensions(e),p=v.w,m=v.h;d=Math.max(d,p,m)}if(Ne(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(o.h,o.w)/2-d,a.length>1&&e.avoidOverlap){d*=1.75;var g=Math.cos(l)-Math.cos(0),y=Math.sin(l)-Math.sin(0),x=Math.sqrt(d*d/(g*g+y*y));c=Math.max(x,c)}var S=function(P,R){var L=e.startAngle+R*l*(i?1:-1),O=c*Math.cos(L),I=c*Math.sin(L),B={x:s.x+O,y:s.y+I};return B};return n.nodes().layoutPositions(this,e,S),this};var zw={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Gh(r){this.options=Ye({},zw,r)}Gh.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=r.cy,i=e.eles,a=i.nodes().not(":parent"),o=br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},u=[],l=0,c=0;c<a.length;c++){var d=a[c],f=void 0;f=e.concentric(d),u.push({value:f,node:d}),d._private.scratch.concentric=f}a.updateStyle();for(var h=0;h<a.length;h++){var v=a[h],p=v.layoutDimensions(e);l=Math.max(l,p.w,p.h)}u.sort(function(q,ge){return ge.value-q.value});for(var m=e.levelWidth(a),g=[[]],y=g[0],x=0;x<u.length;x++){var S=u[x];if(y.length>0){var D=Math.abs(y[0].value-S.value);D>=m&&(y=[],g.push(y))}y.push(S)}var P=l+e.minNodeSpacing;if(!e.avoidOverlap){var R=g.length>0&&g[0].length>1,L=Math.min(o.w,o.h)/2-P,O=L/(g.length+R?1:0);P=Math.min(P,O)}for(var I=0,B=0;B<g.length;B++){var w=g[B],T=e.sweep===void 0?2*Math.PI-2*Math.PI/w.length:e.sweep,E=w.dTheta=T/Math.max(1,w.length-1);if(w.length>1&&e.avoidOverlap){var b=Math.cos(E)-Math.cos(0),C=Math.sin(E)-Math.sin(0),_=Math.sqrt(P*P/(b*b+C*C));I=Math.max(_,I)}w.r=I,I+=P}if(e.equidistant){for(var M=0,A=0,F=0;F<g.length;F++){var N=g[F],z=N.r-A;M=Math.max(M,z)}A=0;for(var Y=0;Y<g.length;Y++){var U=g[Y];Y===0&&(A=U.r),U.r=A,A+=M}}for(var ee={},Q=0;Q<g.length;Q++)for(var j=g[Q],K=j.dTheta,H=j.r,k=0;k<j.length;k++){var G=j[k],$=e.startAngle+(t?1:-1)*K*k,te={x:s.x+H*Math.cos($),y:s.y+H*Math.sin($)};ee[G.node.id()]=te}return i.nodes().layoutPositions(this,e,function(q){var ge=q.id();return ee[ge]}),this};var Kl,Gw={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function ll(r){this.options=Ye({},Gw,r),this.options.layout=this;var e=this.options.eles.nodes(),t=this.options.eles.edges(),n=t.filter(function(i){var a=i.source().data("id"),o=i.target().data("id"),s=e.some(function(l){return l.data("id")===a}),u=e.some(function(l){return l.data("id")===o});return!s||!u});this.options.eles=this.options.eles.not(n)}ll.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Kl=!0:Kl=!1;var n=jw(e,t,r);Kl&&$w(n),r.randomize&&Ww(n);var i=dn(),a=function(){Yw(n,e,r),r.fit===!0&&e.fit(r.padding)},o=function(f){return!(t.stopped||f>=r.numIter||(Xw(n,r),n.temperature=n.temperature*r.coolingFactor,n.temperature<r.minTemp))},s=function(){if(r.animate===!0||r.animate===!1)a(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var f=r.eles.nodes(),h=jh(n,r,f);f.layoutPositions(t,r,h)}},u=0,l=!0;if(r.animate===!0){var c=function d(){for(var f=0;l&&f<r.refresh;)l=o(u),u++,f++;if(!l)lf(n,r),s();else{var h=dn();h-i>=r.animationThreshold&&a(),Fs(d)}};c()}else{for(;l;)l=o(u),u++;lf(n,r),s()}return this};ll.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};ll.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var jw=function(e,t,n){for(var i=n.eles.edges(),a=n.eles.nodes(),o=br(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},u=n.eles.components(),l={},c=0;c<u.length;c++)for(var d=u[c],f=0;f<d.length;f++){var h=d[f];l[h.id()]=c}for(var c=0;c<s.nodeSize;c++){var v=a[c],p=v.layoutDimensions(n),m={};m.isLocked=v.locked(),m.id=v.data("id"),m.parentId=v.data("parent"),m.cmptId=l[v.id()],m.children=[],m.positionX=v.position("x"),m.positionY=v.position("y"),m.offsetX=0,m.offsetY=0,m.height=p.w,m.width=p.h,m.maxX=m.positionX+m.width/2,m.minX=m.positionX-m.width/2,m.maxY=m.positionY+m.height/2,m.minY=m.positionY-m.height/2,m.padLeft=parseFloat(v.style("padding")),m.padRight=parseFloat(v.style("padding")),m.padTop=parseFloat(v.style("padding")),m.padBottom=parseFloat(v.style("padding")),m.nodeRepulsion=_t(n.nodeRepulsion)?n.nodeRepulsion(v):n.nodeRepulsion,s.layoutNodes.push(m),s.idToIndex[m.id]=c}for(var g=[],y=0,x=-1,S=[],c=0;c<s.nodeSize;c++){var v=s.layoutNodes[c],D=v.parentId;D!=null?s.layoutNodes[s.idToIndex[D]].children.push(v.id):(g[++x]=v.id,S.push(v.id))}for(s.graphSet.push(S);y<=x;){var P=g[y++],R=s.idToIndex[P],h=s.layoutNodes[R],L=h.children;if(L.length>0){s.graphSet.push(L);for(var c=0;c<L.length;c++)g[++x]=L[c]}}for(var c=0;c<s.graphSet.length;c++)for(var O=s.graphSet[c],f=0;f<O.length;f++){var I=s.idToIndex[O[f]];s.indexToGraph[I]=c}for(var c=0;c<s.edgeSize;c++){var B=i[c],w={};w.id=B.data("id"),w.sourceId=B.data("source"),w.targetId=B.data("target");var T=_t(n.idealEdgeLength)?n.idealEdgeLength(B):n.idealEdgeLength,E=_t(n.edgeElasticity)?n.edgeElasticity(B):n.edgeElasticity,b=s.idToIndex[w.sourceId],C=s.idToIndex[w.targetId],_=s.indexToGraph[b],M=s.indexToGraph[C];if(_!=M){for(var A=Hw(w.sourceId,w.targetId,s),F=s.graphSet[A],N=0,m=s.layoutNodes[b];F.indexOf(m.id)===-1;)m=s.layoutNodes[s.idToIndex[m.parentId]],N++;for(m=s.layoutNodes[C];F.indexOf(m.id)===-1;)m=s.layoutNodes[s.idToIndex[m.parentId]],N++;T*=N*n.nestingFactor}w.idealLength=T,w.elasticity=E,s.layoutEdges.push(w)}return s},Hw=function(e,t,n){var i=Uw(e,t,0,n);return 2>i.count?0:i.graph},Uw=function r(e,t,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:n};for(var o=0,s=0;s<a.length;s++){var u=a[s],l=i.idToIndex[u],c=i.layoutNodes[l].children;if(c.length!==0){var d=i.indexToGraph[i.idToIndex[c[0]]],f=r(e,t,d,i);if(f.count!==0)if(f.count===1){if(o++,o===2)break}else return f}}return{count:o,graph:n}},$w,Ww=function(e,t){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var o=e.layoutNodes[a];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*n,o.positionY=Math.random()*i)}},jh=function(e,t,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(o){var s=e.layoutNodes[e.idToIndex[o.data("id")]];a.x1=Math.min(a.x1,s.positionX),a.x2=Math.max(a.x2,s.positionX),a.y1=Math.min(a.y1,s.positionY),a.y2=Math.max(a.y2,s.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(o,s){var u=e.layoutNodes[e.idToIndex[o.data("id")]];if(t.boundingBox){var l=(u.positionX-a.x1)/a.w,c=(u.positionY-a.y1)/a.h;return{x:i.x1+l*i.w,y:i.y1+c*i.h}}else return{x:u.positionX,y:u.positionY}}},Yw=function(e,t,n){var i=n.layout,a=n.eles.nodes(),o=jh(e,n,a);a.positions(o),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},Xw=function(e,t,n){qw(e,t),Qw(e),Jw(e,t),eb(e),tb(e)},qw=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,o=0;o<a;o++)for(var s=e.layoutNodes[e.idToIndex[i[o]]],u=o+1;u<a;u++){var l=e.layoutNodes[e.idToIndex[i[u]]];Kw(s,l,e,t)}},sf=function(e){return-e+2*e*Math.random()},Kw=function(e,t,n,i){var a=e.cmptId,o=t.cmptId;if(!(a!==o&&!n.isCompound)){var s=t.positionX-e.positionX,u=t.positionY-e.positionY,l=1;s===0&&u===0&&(s=sf(l),u=sf(l));var c=Zw(e,t,s,u);if(c>0)var d=i.nodeOverlap*c,f=Math.sqrt(s*s+u*u),h=d*s/f,v=d*u/f;else var p=Us(e,s,u),m=Us(t,-1*s,-1*u),g=m.x-p.x,y=m.y-p.y,x=g*g+y*y,f=Math.sqrt(x),d=(e.nodeRepulsion+t.nodeRepulsion)/x,h=d*g/f,v=d*y/f;e.isLocked||(e.offsetX-=h,e.offsetY-=v),t.isLocked||(t.offsetX+=h,t.offsetY+=v)}},Zw=function(e,t,n,i){if(n>0)var a=e.maxX-t.minX;else var a=t.maxX-e.minX;if(i>0)var o=e.maxY-t.minY;else var o=t.maxY-e.minY;return a>=0&&o>=0?Math.sqrt(a*a+o*o):0},Us=function(e,t,n){var i=e.positionX,a=e.positionY,o=e.height||1,s=e.width||1,u=n/t,l=o/s,c={};return t===0&&0<n||t===0&&0>n?(c.x=i,c.y=a+o/2,c):0<t&&-1*l<=u&&u<=l?(c.x=i+s/2,c.y=a+s*n/2/t,c):0>t&&-1*l<=u&&u<=l?(c.x=i-s/2,c.y=a-s*n/2/t,c):0<n&&(u<=-1*l||u>=l)?(c.x=i+o*t/2/n,c.y=a+o/2,c):(0>n&&(u<=-1*l||u>=l)&&(c.x=i-o*t/2/n,c.y=a-o/2),c)},Qw=function(e,t){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],o=e.layoutNodes[a],s=e.idToIndex[i.targetId],u=e.layoutNodes[s],l=u.positionX-o.positionX,c=u.positionY-o.positionY;if(!(l===0&&c===0)){var d=Us(o,l,c),f=Us(u,-1*l,-1*c),h=f.x-d.x,v=f.y-d.y,p=Math.sqrt(h*h+v*v),m=Math.pow(i.idealLength-p,2)/i.elasticity;if(p!==0)var g=m*h/p,y=m*v/p;else var g=0,y=0;o.isLocked||(o.offsetX+=g,o.offsetY+=y),u.isLocked||(u.offsetX-=g,u.offsetY-=y)}}},Jw=function(e,t){if(t.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],o=a.length;if(i===0)var s=e.clientHeight/2,u=e.clientWidth/2;else var l=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[l.parentId]],s=c.positionX,u=c.positionY;for(var d=0;d<o;d++){var f=e.layoutNodes[e.idToIndex[a[d]]];if(!f.isLocked){var h=s-f.positionX,v=u-f.positionY,p=Math.sqrt(h*h+v*v);if(p>n){var m=t.gravity*h/p,g=t.gravity*v/p;f.offsetX+=m,f.offsetY+=g}}}}},eb=function(e,t){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var o=n[i++],s=e.idToIndex[o],u=e.layoutNodes[s],l=u.children;if(0<l.length&&!u.isLocked){for(var c=u.offsetX,d=u.offsetY,f=0;f<l.length;f++){var h=e.layoutNodes[e.idToIndex[l[f]]];h.offsetX+=c,h.offsetY+=d,n[++a]=l[f]}u.offsetX=0,u.offsetY=0}}},tb=function(e,t){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=rb(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,nb(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},rb=function(e,t,n){var i=Math.sqrt(e*e+t*t);if(i>n)var a={x:n*e/i,y:n*t/i};else var a={x:e,y:t};return a},nb=function r(e,t){var n=e.parentId;if(n!=null){var i=t.layoutNodes[t.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return r(i,t)}},lf=function(e,t){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var o=n[a],s=o.cmptId,u=i[s]=i[s]||[];u.push(o)}for(var l=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var d=0;d<c.length;d++){var f=c[d];c.x1=Math.min(c.x1,f.positionX-f.width/2),c.x2=Math.max(c.x2,f.positionX+f.width/2),c.y1=Math.min(c.y1,f.positionY-f.height/2),c.y2=Math.max(c.y2,f.positionY+f.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,l+=c.w*c.h}}i.sort(function(y,x){return x.w*x.h-y.w*y.h});for(var h=0,v=0,p=0,m=0,g=Math.sqrt(l)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var d=0;d<c.length;d++){var f=c[d];f.isLocked||(f.positionX+=h-c.x1,f.positionY+=v-c.y1)}h+=c.w+t.componentSpacing,p+=c.w+t.componentSpacing,m=Math.max(m,c.h),p>g&&(v+=m+t.componentSpacing,h=0,p=0,m=0)}}},ib={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Hh(r){this.options=Ye({},ib,r)}Hh.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(Y){return{x:a.x1,y:a.y1}});else{var o=i.size(),s=Math.sqrt(o*a.h/a.w),u=Math.round(s),l=Math.round(a.w/a.h*s),c=function(U){if(U==null)return Math.min(u,l);var ee=Math.min(u,l);ee==u?u=U:l=U},d=function(U){if(U==null)return Math.max(u,l);var ee=Math.max(u,l);ee==u?u=U:l=U},f=e.rows,h=e.cols!=null?e.cols:e.columns;if(f!=null&&h!=null)u=f,l=h;else if(f!=null&&h==null)u=f,l=Math.ceil(o/u);else if(f==null&&h!=null)l=h,u=Math.ceil(o/l);else if(l*u>o){var v=c(),p=d();(v-1)*p>=o?c(v-1):(p-1)*v>=o&&d(p-1)}else for(;l*u<o;){var m=c(),g=d();(g+1)*m>=o?d(g+1):c(m+1)}var y=a.w/l,x=a.h/u;if(e.condense&&(y=0,x=0),e.avoidOverlap)for(var S=0;S<i.length;S++){var D=i[S],P=D._private.position;(P.x==null||P.y==null)&&(P.x=0,P.y=0);var R=D.layoutDimensions(e),L=e.avoidOverlapPadding,O=R.w+L,I=R.h+L;y=Math.max(y,O),x=Math.max(x,I)}for(var B={},w=function(U,ee){return!!B["c-"+U+"-"+ee]},T=function(U,ee){B["c-"+U+"-"+ee]=!0},E=0,b=0,C=function(){b++,b>=l&&(b=0,E++)},_={},M=0;M<i.length;M++){var A=i[M],F=e.position(A);if(F&&(F.row!==void 0||F.col!==void 0)){var N={row:F.row,col:F.col};if(N.col===void 0)for(N.col=0;w(N.row,N.col);)N.col++;else if(N.row===void 0)for(N.row=0;w(N.row,N.col);)N.row++;_[A.id()]=N,T(N.row,N.col)}}var z=function(U,ee){var Q,j;if(U.locked()||U.isParent())return!1;var K=_[U.id()];if(K)Q=K.col*y+y/2+a.x1,j=K.row*x+x/2+a.y1;else{for(;w(E,b);)C();Q=b*y+y/2+a.x1,j=E*x+x/2+a.y1,T(E,b),C()}return{x:Q,y:j}};i.layoutPositions(this,e,z)}return this};var ab={ready:function(){},stop:function(){}};function Bu(r){this.options=Ye({},ab,r)}Bu.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};Bu.prototype.stop=function(){return this};var ob={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Uh(r){this.options=Ye({},ob,r)}Uh.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),n=_t(r.positions);function i(a){if(r.positions==null)return c0(a.position());if(n)return r.positions(a);var o=r.positions[a._private.data.id];return o??null}return t.layoutPositions(this,r,function(a,o){var s=i(a);return a.locked()||s==null?!1:s}),this};var sb={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function $h(r){this.options=Ye({},sb,r)}$h.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=br(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(o,s){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return t.nodes().layoutPositions(this,r,i),this};var lb=[{name:"breadthfirst",impl:Vh},{name:"circle",impl:zh},{name:"concentric",impl:Gh},{name:"cose",impl:ll},{name:"grid",impl:Hh},{name:"null",impl:Bu},{name:"preset",impl:Uh},{name:"random",impl:$h}];function Wh(r){this.options=r,this.notifications=0}var uf=function(){},cf=function(){throw new Error("A headless instance can not render images")};Wh.prototype={recalculateRenderedStyle:uf,notify:function(){this.notifications++},init:uf,isHeadless:function(){return!0},png:cf,jpg:cf};var Vu={};Vu.arrowShapeWidth=.3;Vu.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(l,c,d,f,h,v,p){var m=h.x-d/2-p,g=h.x+d/2+p,y=h.y-d/2-p,x=h.y+d/2+p,S=m<=l&&l<=g&&y<=c&&c<=x;return S},n=function(l,c,d,f,h){var v=l*Math.cos(f)-c*Math.sin(f),p=l*Math.sin(f)+c*Math.cos(f),m=v*d,g=p*d,y=m+h.x,x=g+h.y;return{x:y,y:x}},i=function(l,c,d,f){for(var h=[],v=0;v<l.length;v+=2){var p=l[v],m=l[v+1];h.push(n(p,m,c,d,f))}return h},a=function(l){for(var c=[],d=0;d<l.length;d++){var f=l[d];c.push(f.x,f.y)}return c},o=function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").pfValue*2},s=function(l,c){Ue(c)&&(c=r[c]),r[l]=Ye({name:l,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(f,h,v,p,m,g){var y=a(i(this.points,v+2*g,p,m)),x=wr(f,h,y);return x},roughCollide:t,draw:function(f,h,v,p){var m=i(this.points,h,v,p);e.arrowShapeImpl("polygon")(f,m)},spacing:function(f){return 0},gap:o},c)};s("none",{collide:Bs,roughCollide:Bs,draw:Tu,spacing:Cd,gap:Cd}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(l,c,d,f,h){var v=i(this.points,c,d,f),p=this.controlPoint,m=n(p[0],p[1],c,d,f);e.arrowShapeImpl(this.name)(l,v,m)},gap:function(l){return o(l)*.8}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(l,c,d,f,h,v,p){var m=a(i(this.points,d+2*p,f,h)),g=a(i(this.pointsTee,d+2*p,f,h)),y=wr(l,c,m)||wr(l,c,g);return y},draw:function(l,c,d,f,h){var v=i(this.points,c,d,f),p=i(this.pointsTee,c,d,f);e.arrowShapeImpl(this.name)(l,v,p)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(l,c,d,f,h,v,p){var m=h,g=Math.pow(m.x-l,2)+Math.pow(m.y-c,2)<=Math.pow((d+2*p)*this.radius,2),y=a(i(this.points,d+2*p,f,h));return wr(l,c,y)||g},draw:function(l,c,d,f,h){var v=i(this.pointsTr,c,d,f);e.arrowShapeImpl(this.name)(l,v,f.x,f.y,this.radius*c)},spacing:function(l){return e.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(l,c){var d=this.baseCrossLinePts.slice(),f=c/l,h=3,v=5;return d[h]=d[h]-f,d[v]=d[v]-f,d},collide:function(l,c,d,f,h,v,p){var m=a(i(this.points,d+2*p,f,h)),g=a(i(this.crossLinePts(d,v),d+2*p,f,h)),y=wr(l,c,m)||wr(l,c,g);return y},draw:function(l,c,d,f,h){var v=i(this.points,c,d,f),p=i(this.crossLinePts(c,h),c,d,f);e.arrowShapeImpl(this.name)(l,v,p)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(l){return o(l)*.525}}),s("circle",{radius:.15,collide:function(l,c,d,f,h,v,p){var m=h,g=Math.pow(m.x-l,2)+Math.pow(m.y-c,2)<=Math.pow((d+2*p)*this.radius,2);return g},draw:function(l,c,d,f,h){e.arrowShapeImpl(this.name)(l,f.x,f.y,this.radius*c)},spacing:function(l){return e.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(l){return 1},gap:function(l){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(l){return .95*l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}})};var ci={};ci.projectIntoViewport=function(r,e){var t=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],o=n[4],s=t.pan(),u=t.zoom(),l=((r-i)/o-s.x)/u,c=((e-a)/o-s.y)/u;return[l,c]};ci.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=this.cy.window().getComputedStyle(r),n=function(g){return parseFloat(t.getPropertyValue(g))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},o=r.clientWidth,s=r.clientHeight,u=i.left+i.right,l=i.top+i.bottom,c=a.left+a.right,d=e.width/(o+c),f=o-u,h=s-l,v=e.left+i.left+a.left,p=e.top+i.top+a.top;return this.containerBB=[v,p,f,h,d]};ci.invalidateContainerClientCoordsCache=function(){this.containerBB=null};ci.findNearestElement=function(r,e,t,n){return this.findNearestElements(r,e,t,n)[0]};ci.findNearestElements=function(r,e,t,n){var i=this,a=this,o=a.getCachedZSortedEles(),s=[],u=a.cy.zoom(),l=a.cy.hasCompoundNodes(),c=(n?24:8)/u,d=(n?8:2)/u,f=(n?8:2)/u,h=1/0,v,p;t&&(o=o.interactive);function m(R,L){if(R.isNode()){if(p)return;p=R,s.push(R)}if(R.isEdge()&&(L==null||L<h))if(v){if(v.pstyle("z-compound-depth").value===R.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===R.pstyle("z-compound-depth").value){for(var O=0;O<s.length;O++)if(s[O].isEdge()){s[O]=R,v=R,h=L??h;break}}}else s.push(R),v=R,h=L??h}function g(R){var L=R.outerWidth()+2*d,O=R.outerHeight()+2*d,I=L/2,B=O/2,w=R.position(),T=R.pstyle("corner-radius").value==="auto"?"auto":R.pstyle("corner-radius").pfValue,E=R._private.rscratch;if(w.x-I<=r&&r<=w.x+I&&w.y-B<=e&&e<=w.y+B){var b=a.nodeShapes[i.getNodeShape(R)];if(b.checkPoint(r,e,0,L,O,w.x,w.y,T,E))return m(R,0),!0}}function y(R){var L=R._private,O=L.rscratch,I=R.pstyle("width").pfValue,B=R.pstyle("arrow-scale").value,w=I/2+c,T=w*w,E=w*2,M=L.source,A=L.target,b;if(O.edgeType==="segments"||O.edgeType==="straight"||O.edgeType==="haystack"){for(var C=O.allpts,_=0;_+3<C.length;_+=2)if(E0(r,e,C[_],C[_+1],C[_+2],C[_+3],E)&&T>(b=D0(r,e,C[_],C[_+1],C[_+2],C[_+3])))return m(R,b),!0}else if(O.edgeType==="bezier"||O.edgeType==="multibezier"||O.edgeType==="self"||O.edgeType==="compound"){for(var C=O.allpts,_=0;_+5<O.allpts.length;_+=4)if(T0(r,e,C[_],C[_+1],C[_+2],C[_+3],C[_+4],C[_+5],E)&&T>(b=M0(r,e,C[_],C[_+1],C[_+2],C[_+3],C[_+4],C[_+5])))return m(R,b),!0}for(var M=M||L.source,A=A||L.target,F=i.getArrowWidth(I,B),N=[{name:"source",x:O.arrowStartX,y:O.arrowStartY,angle:O.srcArrowAngle},{name:"target",x:O.arrowEndX,y:O.arrowEndY,angle:O.tgtArrowAngle},{name:"mid-source",x:O.midX,y:O.midY,angle:O.midsrcArrowAngle},{name:"mid-target",x:O.midX,y:O.midY,angle:O.midtgtArrowAngle}],_=0;_<N.length;_++){var z=N[_],Y=a.arrowShapes[R.pstyle(z.name+"-arrow-shape").value],U=R.pstyle("width").pfValue;if(Y.roughCollide(r,e,F,z.angle,{x:z.x,y:z.y},U,c)&&Y.collide(r,e,F,z.angle,{x:z.x,y:z.y},U,c))return m(R),!0}l&&s.length>0&&(g(M),g(A))}function x(R,L,O){return zr(R,L,O)}function S(R,L){var O=R._private,I=f,B;L?B=L+"-":B="",R.boundingBox();var w=O.labelBounds[L||"main"],T=R.pstyle(B+"label").value,E=R.pstyle("text-events").strValue==="yes";if(!(!E||!T)){var b=x(O.rscratch,"labelX",L),C=x(O.rscratch,"labelY",L),_=x(O.rscratch,"labelAngle",L),M=R.pstyle(B+"text-margin-x").pfValue,A=R.pstyle(B+"text-margin-y").pfValue,F=w.x1-I-M,N=w.x2+I-M,z=w.y1-I-A,Y=w.y2+I-A;if(_){var U=Math.cos(_),ee=Math.sin(_),Q=function(te,q){return te=te-b,q=q-C,{x:te*U-q*ee+b,y:te*ee+q*U+C}},j=Q(F,z),K=Q(F,Y),H=Q(N,z),k=Q(N,Y),G=[j.x+M,j.y+A,H.x+M,H.y+A,k.x+M,k.y+A,K.x+M,K.y+A];if(wr(r,e,G))return m(R),!0}else if(Wi(w,r,e))return m(R),!0}}for(var D=o.length-1;D>=0;D--){var P=o[D];P.isNode()?g(P)||S(P):y(P)||S(P)||S(P,"source")||S(P,"target")}return s};ci.getAllInBox=function(r,e,t,n){var i=this.getCachedZSortedEles().interactive,a=[],o=Math.min(r,t),s=Math.max(r,t),u=Math.min(e,n),l=Math.max(e,n);r=o,t=s,e=u,n=l;for(var c=br({x1:r,y1:e,x2:t,y2:n}),d=0;d<i.length;d++){var f=i[d];if(f.isNode()){var h=f,v=h.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Mu(c,v)&&!th(v,c)&&a.push(h)}else{var p=f,m=p._private,g=m.rscratch;if(g.startX!=null&&g.startY!=null&&!Wi(c,g.startX,g.startY)||g.endX!=null&&g.endY!=null&&!Wi(c,g.endX,g.endY))continue;if(g.edgeType==="bezier"||g.edgeType==="multibezier"||g.edgeType==="self"||g.edgeType==="compound"||g.edgeType==="segments"||g.edgeType==="haystack"){for(var y=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts,x=!0,S=0;S<y.length;S++)if(!x0(c,y[S])){x=!1;break}x&&a.push(p)}else(g.edgeType==="haystack"||g.edgeType==="straight")&&a.push(p)}}return a};var $s={};$s.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",o=e.edgeType==="compound",s=e.edgeType==="self",u,l,c,d,f,h,g,y;if(t?(c=e.haystackPts[0],d=e.haystackPts[1],f=e.haystackPts[2],h=e.haystackPts[3]):(c=e.arrowStartX,d=e.arrowStartY,f=e.arrowEndX,h=e.arrowEndY),g=e.midX,y=e.midY,a)u=c-e.segpts[0],l=d-e.segpts[1];else if(i||o||s||n){var v=e.allpts,p=Wt(v[0],v[2],v[4],.1),m=Wt(v[1],v[3],v[5],.1);u=c-p,l=d-m}else u=c-g,l=d-y;e.srcArrowAngle=vs(u,l);var g=e.midX,y=e.midY;if(t&&(g=(c+f)/2,y=(d+h)/2),u=f-c,l=h-d,a){var v=e.allpts;if(v.length/2%2===0){var x=v.length/2,S=x-2;u=v[x]-v[S],l=v[x+1]-v[S+1]}else if(e.isRound)u=e.midVector[1],l=-e.midVector[0];else{var x=v.length/2-1,S=x-2;u=v[x]-v[S],l=v[x+1]-v[S+1]}}else if(i||o||s){var v=e.allpts,D=e.ctrlpts,P,R,L,O;if(D.length/2%2===0){var I=v.length/2-1,B=I+2,w=B+2;P=Wt(v[I],v[B],v[w],0),R=Wt(v[I+1],v[B+1],v[w+1],0),L=Wt(v[I],v[B],v[w],1e-4),O=Wt(v[I+1],v[B+1],v[w+1],1e-4)}else{var B=v.length/2-1,I=B-2,w=B+2;P=Wt(v[I],v[B],v[w],.4999),R=Wt(v[I+1],v[B+1],v[w+1],.4999),L=Wt(v[I],v[B],v[w],.5),O=Wt(v[I+1],v[B+1],v[w+1],.5)}u=L-P,l=O-R}if(e.midtgtArrowAngle=vs(u,l),e.midDispX=u,e.midDispY=l,u*=-1,l*=-1,a){var v=e.allpts;if(v.length/2%2!==0){if(!e.isRound){var x=v.length/2-1,T=x+2;u=-(v[T]-v[x]),l=-(v[T+1]-v[x+1])}}}if(e.midsrcArrowAngle=vs(u,l),a)u=f-e.segpts[e.segpts.length-2],l=h-e.segpts[e.segpts.length-1];else if(i||o||s||n){var v=e.allpts,E=v.length,p=Wt(v[E-6],v[E-4],v[E-2],.9),m=Wt(v[E-5],v[E-3],v[E-1],.9);u=f-p,l=h-m}else u=f-g,l=h-y;e.tgtArrowAngle=vs(u,l)};$s.getArrowWidth=$s.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[r+", "+e];return n||(n=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=n,n)};var fu,hu,Qr={},Ar={},df,ff,ri,Is,cn,Zn,ti,Zr,Fi,Es,Yh,Xh,vu,pu,hf,vf=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},ub=function(e,t){t.x=e.x*-1,t.y=e.y*-1,t.nx=e.nx*-1,t.ny=e.ny*-1,t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},cb=function(e,t,n,i,a){if(e!==hf?vf(t,e,Qr):ub(Ar,Qr),vf(t,n,Ar),df=Qr.nx*Ar.ny-Qr.ny*Ar.nx,ff=Qr.nx*Ar.nx-Qr.ny*-Ar.ny,cn=Math.asin(Math.max(-1,Math.min(1,df))),Math.abs(cn)<1e-6){fu=t.x,hu=t.y,ti=Fi=0;return}ri=1,Is=!1,ff<0?cn<0?cn=Math.PI+cn:(cn=Math.PI-cn,ri=-1,Is=!0):cn>0&&(ri=-1,Is=!0),t.radius!==void 0?Fi=t.radius:Fi=i,Zn=cn/2,Es=Math.min(Qr.len/2,Ar.len/2),a?(Zr=Math.abs(Math.cos(Zn)*Fi/Math.sin(Zn)),Zr>Es?(Zr=Es,ti=Math.abs(Zr*Math.sin(Zn)/Math.cos(Zn))):ti=Fi):(Zr=Math.min(Es,Fi),ti=Math.abs(Zr*Math.sin(Zn)/Math.cos(Zn))),vu=t.x+Ar.nx*Zr,pu=t.y+Ar.ny*Zr,fu=vu-Ar.ny*ti*ri,hu=pu+Ar.nx*ti*ri,Yh=t.x+Qr.nx*Zr,Xh=t.y+Qr.ny*Zr,hf=t};function qh(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function zu(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(cb(r,e,t,n,i),{cx:fu,cy:hu,radius:ti,startX:Yh,startY:Xh,stopX:vu,stopY:pu,startAngle:Qr.ang+Math.PI/2*ri,endAngle:Ar.ang-Math.PI/2*ri,counterClockwise:Is})}var lr={};lr.findMidptPtsEtc=function(r,e){var t=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,o=r.pstyle("source-endpoint"),s=r.pstyle("target-endpoint"),u=o.units!=null&&s.units!=null,l=function(D,P,R,L){var O=L-P,I=R-D,B=Math.sqrt(I*I+O*O);return{x:-O/B,y:I/B}},c=r.pstyle("edge-distances").value;switch(c){case"node-position":a=t;break;case"intersection":a=n;break;case"endpoints":{if(u){var d=this.manualEndptToPx(r.source()[0],o),f=kt(d,2),h=f[0],v=f[1],p=this.manualEndptToPx(r.target()[0],s),m=kt(p,2),g=m[0],y=m[1],x={x1:h,y1:v,x2:g,y2:y};i=l(h,v,g,y),a=x}else ft("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};lr.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],n=t._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var o=n.source,s=n.target,u=o.position(),l=s.position(),c=o.width(),d=s.width(),f=o.height(),h=s.height(),v=t.pstyle("haystack-radius").value,p=v/2;i.haystackPts=i.allpts=[i.source.x*c*p+u.x,i.source.y*f*p+u.y,i.target.x*d*p+l.x,i.target.y*h*p+l.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};lr.findSegmentsPoints=function(r,e){var t=r._private.rscratch,n=r.pstyle("segment-weights"),i=r.pstyle("segment-distances"),a=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),s=Math.min(n.pfValue.length,i.pfValue.length),u=a.pfValue[a.pfValue.length-1],l=o.pfValue[o.pfValue.length-1];t.edgeType="segments",t.segpts=[],t.radii=[],t.isArcRadius=[];for(var c=0;c<s;c++){var d=n.pfValue[c],f=i.pfValue[c],h=1-d,v=d,p=this.findMidptPtsEtc(r,e),m=p.midptPts,g=p.vectorNormInverse,y={x:m.x1*h+m.x2*v,y:m.y1*h+m.y2*v};t.segpts.push(y.x+g.x*f,y.y+g.y*f),t.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:u),t.isArcRadius.push((o.pfValue[c]!==void 0?o.pfValue[c]:l)==="arc-radius")}};lr.findLoopPoints=function(r,e,t,n){var i=r._private.rscratch,a=e.dirCounts,o=e.srcPos,s=r.pstyle("control-point-distances"),u=s?s.pfValue[0]:void 0,l=r.pstyle("loop-direction").pfValue,c=r.pstyle("loop-sweep").pfValue,d=r.pstyle("control-point-step-size").pfValue;i.edgeType="self";var f=t,h=d;n&&(f=0,h=u);var v=l-Math.PI/2,p=v-c/2,m=v+c/2,g=l+"_"+c;f=a[g]===void 0?a[g]=0:++a[g],i.ctrlpts=[o.x+Math.cos(p)*1.4*h*(f/3+1),o.y+Math.sin(p)*1.4*h*(f/3+1),o.x+Math.cos(m)*1.4*h*(f/3+1),o.y+Math.sin(m)*1.4*h*(f/3+1)]};lr.findCompoundLoopPoints=function(r,e,t,n){var i=r._private.rscratch;i.edgeType="compound";var a=e.srcPos,o=e.tgtPos,s=e.srcW,u=e.srcH,l=e.tgtW,c=e.tgtH,d=r.pstyle("control-point-step-size").pfValue,f=r.pstyle("control-point-distances"),h=f?f.pfValue[0]:void 0,v=t,p=d;n&&(v=0,p=h);var m=50,g={x:a.x-s/2,y:a.y-u/2},y={x:o.x-l/2,y:o.y-c/2},x={x:Math.min(g.x,y.x),y:Math.min(g.y,y.y)},S=.5,D=Math.max(S,Math.log(s*.01)),P=Math.max(S,Math.log(l*.01));i.ctrlpts=[x.x,x.y-(1+Math.pow(m,1.12)/100)*p*(v/3+1)*D,x.x-(1+Math.pow(m,1.12)/100)*p*(v/3+1)*P,x.y]};lr.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};lr.findBezierPoints=function(r,e,t,n,i){var a=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,s=r.pstyle("control-point-distances"),u=r.pstyle("control-point-weights"),l=s&&u?Math.min(s.value.length,u.value.length):1,c=s?s.pfValue[0]:void 0,d=u.value[0],f=n;a.edgeType=f?"multibezier":"bezier",a.ctrlpts=[];for(var h=0;h<l;h++){var v=(.5-e.eles.length/2+t)*o*(i?-1:1),p=void 0,m=Jf(v);f&&(c=s?s.pfValue[h]:o,d=u.value[h]),n?p=c:p=c!==void 0?m*c:void 0;var g=p!==void 0?p:v,y=1-d,x=d,S=this.findMidptPtsEtc(r,e),D=S.midptPts,P=S.vectorNormInverse,R={x:D.x1*y+D.x2*x,y:D.y1*y+D.y2*x};a.ctrlpts.push(R.x+P.x*g,R.y+P.y*g)}};lr.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var n="vertical",i="horizontal",a="leftward",o="rightward",s="downward",u="upward",l="auto",c=e.posPts,d=e.srcW,f=e.srcH,h=e.tgtW,v=e.tgtH,p=r.pstyle("edge-distances").value,m=p!=="node-position",g=r.pstyle("taxi-direction").value,y=g,x=r.pstyle("taxi-turn"),S=x.units==="%",D=x.pfValue,P=D<0,R=r.pstyle("taxi-turn-min-distance").pfValue,L=m?(d+h)/2:0,O=m?(f+v)/2:0,I=c.x2-c.x1,B=c.y2-c.y1,w=function(ne,oe){return ne>0?Math.max(ne-oe,0):Math.min(ne+oe,0)},T=w(I,L),E=w(B,O),b=!1;y===l?g=Math.abs(T)>Math.abs(E)?i:n:y===u||y===s?(g=n,b=!0):(y===a||y===o)&&(g=i,b=!0);var C=g===n,_=C?E:T,M=C?B:I,A=Jf(M),F=!1;!(b&&(S||P))&&(y===s&&M<0||y===u&&M>0||y===a&&M>0||y===o&&M<0)&&(A*=-1,_=A*Math.abs(_),F=!0);var N;if(S){var z=D<0?1+D:D;N=z*_}else{var Y=D<0?_:0;N=Y+D*A}var U=function(ne){return Math.abs(ne)<R||Math.abs(ne)>=Math.abs(_)},ee=U(N),Q=U(Math.abs(_)-Math.abs(N)),j=ee||Q;if(j&&!F)if(C){var K=Math.abs(M)<=f/2,H=Math.abs(I)<=h/2;if(K){var k=(c.x1+c.x2)/2,G=c.y1,$=c.y2;t.segpts=[k,G,k,$]}else if(H){var te=(c.y1+c.y2)/2,q=c.x1,ge=c.x2;t.segpts=[q,te,ge,te]}else t.segpts=[c.x1,c.y2]}else{var Te=Math.abs(M)<=d/2,he=Math.abs(B)<=v/2;if(Te){var ue=(c.y1+c.y2)/2,de=c.x1,me=c.x2;t.segpts=[de,ue,me,ue]}else if(he){var _e=(c.x1+c.x2)/2,xe=c.y1,Ce=c.y2;t.segpts=[_e,xe,_e,Ce]}else t.segpts=[c.x2,c.y1]}else if(C){var Ee=c.y1+N+(m?f/2*A:0),be=c.x1,fe=c.x2;t.segpts=[be,Ee,fe,Ee]}else{var V=c.x1+N+(m?d/2*A:0),re=c.y1,le=c.y2;t.segpts=[V,re,V,le]}if(t.isRound){var W=r.pstyle("taxi-radius").value,Z=r.pstyle("radius-type").value[0]==="arc-radius";t.radii=new Array(t.segpts.length/2).fill(W),t.isArcRadius=new Array(t.segpts.length/2).fill(Z)}};lr.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,o=e.srcH,s=e.tgtW,u=e.tgtH,l=e.srcShape,c=e.tgtShape,d=e.srcCornerRadius,f=e.tgtCornerRadius,h=e.srcRs,v=e.tgtRs,p=!Ne(t.startX)||!Ne(t.startY),m=!Ne(t.arrowStartX)||!Ne(t.arrowStartY),g=!Ne(t.endX)||!Ne(t.endY),y=!Ne(t.arrowEndX)||!Ne(t.arrowEndY),x=3,S=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,D=x*S,P=ai({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),R=P<D,L=ai({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),O=L<D,I=!1;if(p||m||R){I=!0;var B={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},w=Math.sqrt(B.x*B.x+B.y*B.y),T={x:B.x/w,y:B.y/w},E=Math.max(a,o),b={x:t.ctrlpts[0]+T.x*2*E,y:t.ctrlpts[1]+T.y*2*E},C=l.intersectLine(n.x,n.y,a,o,b.x,b.y,0,d,h);R?(t.ctrlpts[0]=t.ctrlpts[0]+T.x*(D-P),t.ctrlpts[1]=t.ctrlpts[1]+T.y*(D-P)):(t.ctrlpts[0]=C[0]+T.x*D,t.ctrlpts[1]=C[1]+T.y*D)}if(g||y||O){I=!0;var _={x:t.ctrlpts[0]-i.x,y:t.ctrlpts[1]-i.y},M=Math.sqrt(_.x*_.x+_.y*_.y),A={x:_.x/M,y:_.y/M},F=Math.max(a,o),N={x:t.ctrlpts[0]+A.x*2*F,y:t.ctrlpts[1]+A.y*2*F},z=c.intersectLine(i.x,i.y,s,u,N.x,N.y,0,f,v);O?(t.ctrlpts[0]=t.ctrlpts[0]+A.x*(D-L),t.ctrlpts[1]=t.ctrlpts[1]+A.y*(D-L)):(t.ctrlpts[0]=z[0]+A.x*D,t.ctrlpts[1]=z[1]+A.y*D)}I&&this.findEndpoints(r)}};lr.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=Wt(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=Wt(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var o=e.radii[a/2-1],s=e.isArcRadius[a/2-1];e.roundCorners.push(zu({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:o},{x:e.allpts[a+2],y:e.allpts[a+3]},o,s))}}if(e.segpts.length%4===0){var u=e.segpts.length/2,l=u-2;e.midX=(e.segpts[l]+e.segpts[u])/2,e.midY=(e.segpts[l+1]+e.segpts[u+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var d={x:e.segpts[c],y:e.segpts[c+1]},f=e.roundCorners[c/2],h=[d.x-f.cx,d.y-f.cy],v=f.radius/Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2));h=h.map(function(p){return p*v}),e.midX=f.cx+h[0],e.midY=f.cy+h[1],e.midVector=h}}}};lr.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Ne(e.startX)&&Ne(e.startY)&&Ne(e.endX)&&Ne(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,ft("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};lr.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,n=t.cy,i=n.hasCompoundNodes(),a={map:new en,get:function(R){var L=this.map.get(R[0]);return L!=null?L.get(R[1]):null},set:function(R,L){var O=this.map.get(R[0]);O==null&&(O=new en,this.map.set(R[0],O)),O.set(R[1],L)}},o=[],s=[],u=0;u<r.length;u++){var l=r[u],c=l._private,d=l.pstyle("curve-style").value;if(!(l.removed()||!l.takesUpSpace())){if(d==="haystack"){s.push(l);continue}var f=d==="unbundled-bezier"||d.endsWith("segments")||d==="straight"||d==="straight-triangle"||d.endsWith("taxi"),h=d==="unbundled-bezier"||d==="bezier",v=c.source,p=c.target,m=v.poolIndex(),g=p.poolIndex(),y=[m,g].sort(),x=a.get(y);x==null&&(x={eles:[]},a.set(y,x),o.push(y)),x.eles.push(l),f&&(x.hasUnbundled=!0),h&&(x.hasBezier=!0)}}for(var S=function(R){var L=o[R],O=a.get(L),I=void 0;if(!O.hasUnbundled){var B=O.eles[0].parallelEdges().filter(function(V){return V.isBundledBezier()});_u(O.eles),B.forEach(function(V){return O.eles.push(V)}),O.eles.sort(function(V,re){return V.poolIndex()-re.poolIndex()})}var w=O.eles[0],T=w.source(),E=w.target();if(T.poolIndex()>E.poolIndex()){var b=T;T=E,E=b}var C=O.srcPos=T.position(),_=O.tgtPos=E.position(),M=O.srcW=T.outerWidth(),A=O.srcH=T.outerHeight(),F=O.tgtW=E.outerWidth(),N=O.tgtH=E.outerHeight(),z=O.srcShape=t.nodeShapes[e.getNodeShape(T)],Y=O.tgtShape=t.nodeShapes[e.getNodeShape(E)],U=O.srcCornerRadius=T.pstyle("corner-radius").value==="auto"?"auto":T.pstyle("corner-radius").pfValue,ee=O.tgtCornerRadius=E.pstyle("corner-radius").value==="auto"?"auto":E.pstyle("corner-radius").pfValue,Q=O.tgtRs=E._private.rscratch,j=O.srcRs=T._private.rscratch;O.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var K=0;K<O.eles.length;K++){var H=O.eles[K],k=H[0]._private.rscratch,G=H.pstyle("curve-style").value,$=G==="unbundled-bezier"||G.endsWith("segments")||G.endsWith("taxi"),te=!T.same(H.source());if(!O.calculatedIntersection&&T!==E&&(O.hasBezier||O.hasUnbundled)){O.calculatedIntersection=!0;var q=z.intersectLine(C.x,C.y,M,A,_.x,_.y,0,U,j),ge=O.srcIntn=q,Te=Y.intersectLine(_.x,_.y,F,N,C.x,C.y,0,ee,Q),he=O.tgtIntn=Te,ue=O.intersectionPts={x1:q[0],x2:Te[0],y1:q[1],y2:Te[1]},de=O.posPts={x1:C.x,x2:_.x,y1:C.y,y2:_.y},me=Te[1]-q[1],_e=Te[0]-q[0],xe=Math.sqrt(_e*_e+me*me),Ce=O.vector={x:_e,y:me},Ee=O.vectorNorm={x:Ce.x/xe,y:Ce.y/xe},be={x:-Ee.y,y:Ee.x};O.nodesOverlap=!Ne(xe)||Y.checkPoint(q[0],q[1],0,F,N,_.x,_.y,ee,Q)||z.checkPoint(Te[0],Te[1],0,M,A,C.x,C.y,U,j),O.vectorNormInverse=be,I={nodesOverlap:O.nodesOverlap,dirCounts:O.dirCounts,calculatedIntersection:!0,hasBezier:O.hasBezier,hasUnbundled:O.hasUnbundled,eles:O.eles,srcPos:_,srcRs:Q,tgtPos:C,tgtRs:j,srcW:F,srcH:N,tgtW:M,tgtH:A,srcIntn:he,tgtIntn:ge,srcShape:Y,tgtShape:z,posPts:{x1:de.x2,y1:de.y2,x2:de.x1,y2:de.y1},intersectionPts:{x1:ue.x2,y1:ue.y2,x2:ue.x1,y2:ue.y1},vector:{x:-Ce.x,y:-Ce.y},vectorNorm:{x:-Ee.x,y:-Ee.y},vectorNormInverse:{x:-be.x,y:-be.y}}}var fe=te?I:O;k.nodesOverlap=fe.nodesOverlap,k.srcIntn=fe.srcIntn,k.tgtIntn=fe.tgtIntn,k.isRound=G.startsWith("round"),i&&(T.isParent()||T.isChild()||E.isParent()||E.isChild())&&(T.parents().anySame(E)||E.parents().anySame(T)||T.same(E)&&T.isParent())?e.findCompoundLoopPoints(H,fe,K,$):T===E?e.findLoopPoints(H,fe,K,$):G.endsWith("segments")?e.findSegmentsPoints(H,fe):G.endsWith("taxi")?e.findTaxiPoints(H,fe):G==="straight"||!$&&O.eles.length%2===1&&K===Math.floor(O.eles.length/2)?e.findStraightEdgePoints(H):e.findBezierPoints(H,fe,K,$,te),e.findEndpoints(H),e.tryToCorrectInvalidPoints(H,fe),e.checkForInvalidEdgeWarning(H),e.storeAllpts(H),e.storeEdgeProjections(H),e.calculateArrowAngles(H),e.recalculateEdgeLabelProjections(H),e.calculateLabelAngles(H)}},D=0;D<o.length;D++)S(D);this.findHaystackPoints(s)}};function Kh(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var n=r[t],i=r[t+1];e.push({x:n,y:i})}return e}}lr.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="segments")return Kh(e.segpts)};lr.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return Kh(e.ctrlpts)};lr.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var Ka={};Ka.manualEndptToPx=function(r,e){var t=this,n=r.position(),i=r.outerWidth(),a=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var s=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(s[0]=s[0]*i),e.units[1]==="%"&&(s[1]=s[1]*a),s[0]+=n.x,s[1]+=n.y,s}else{var u=e.pfValue[0];u=-Math.PI/2+u;var l=2*Math.max(i,a),c=[n.x+Math.cos(u)*l,n.y+Math.sin(u)*l];return t.nodeShapes[this.getNodeShape(r)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};Ka.findEndpoints=function(r){var e=this,t,n=r.source()[0],i=r.target()[0],a=n.position(),o=i.position(),s=r.pstyle("target-arrow-shape").value,u=r.pstyle("source-arrow-shape").value,l=r.pstyle("target-distance-from-node").pfValue,c=r.pstyle("source-distance-from-node").pfValue,d=n._private.rscratch,f=i._private.rscratch,h=r.pstyle("curve-style").value,v=r._private.rscratch,p=v.edgeType,m=h==="taxi",g=p==="self"||p==="compound",y=p==="bezier"||p==="multibezier"||g,x=p!=="bezier",S=p==="straight"||p==="segments",D=p==="segments",P=y||x||S,R=g||m,L=r.pstyle("source-endpoint"),O=R?"outside-to-node":L.value,I=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,B=r.pstyle("target-endpoint"),w=R?"outside-to-node":B.value,T=i.pstyle("corner-radius").value==="auto"?"auto":i.pstyle("corner-radius").pfValue;v.srcManEndpt=L,v.tgtManEndpt=B;var E,b,C,_;if(y){var M=[v.ctrlpts[0],v.ctrlpts[1]],A=x?[v.ctrlpts[v.ctrlpts.length-2],v.ctrlpts[v.ctrlpts.length-1]]:M;E=A,b=M}else if(S){var F=D?v.segpts.slice(0,2):[o.x,o.y],N=D?v.segpts.slice(v.segpts.length-2):[a.x,a.y];E=N,b=F}if(w==="inside-to-node")t=[o.x,o.y];else if(B.units)t=this.manualEndptToPx(i,B);else if(w==="outside-to-line")t=v.tgtIntn;else if(w==="outside-to-node"||w==="outside-to-node-or-label"?C=E:(w==="outside-to-line"||w==="outside-to-line-or-label")&&(C=[a.x,a.y]),t=e.nodeShapes[this.getNodeShape(i)].intersectLine(o.x,o.y,i.outerWidth(),i.outerHeight(),C[0],C[1],0,T,f),w==="outside-to-node-or-label"||w==="outside-to-line-or-label"){var z=i._private.rscratch,Y=z.labelWidth,U=z.labelHeight,ee=z.labelX,Q=z.labelY,j=Y/2,K=U/2,H=i.pstyle("text-valign").value;H==="top"?Q-=K:H==="bottom"&&(Q+=K);var k=i.pstyle("text-halign").value;k==="left"?ee-=j:k==="right"&&(ee+=j);var G=Fa(C[0],C[1],[ee-j,Q-K,ee+j,Q-K,ee+j,Q+K,ee-j,Q+K],o.x,o.y);if(G.length>0){var $=a,te=Jn($,Vi(t)),q=Jn($,Vi(G)),ge=te;if(q<te&&(t=G,ge=q),G.length>2){var Te=Jn($,{x:G[2],y:G[3]});Te<ge&&(t=[G[2],G[3]])}}}var he=ps(t,E,e.arrowShapes[s].spacing(r)+l),ue=ps(t,E,e.arrowShapes[s].gap(r)+l);if(v.endX=ue[0],v.endY=ue[1],v.arrowEndX=he[0],v.arrowEndY=he[1],O==="inside-to-node")t=[a.x,a.y];else if(L.units)t=this.manualEndptToPx(n,L);else if(O==="outside-to-line")t=v.srcIntn;else if(O==="outside-to-node"||O==="outside-to-node-or-label"?_=b:(O==="outside-to-line"||O==="outside-to-line-or-label")&&(_=[o.x,o.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(a.x,a.y,n.outerWidth(),n.outerHeight(),_[0],_[1],0,I,d),O==="outside-to-node-or-label"||O==="outside-to-line-or-label"){var de=n._private.rscratch,me=de.labelWidth,_e=de.labelHeight,xe=de.labelX,Ce=de.labelY,Ee=me/2,be=_e/2,fe=n.pstyle("text-valign").value;fe==="top"?Ce-=be:fe==="bottom"&&(Ce+=be);var V=n.pstyle("text-halign").value;V==="left"?xe-=Ee:V==="right"&&(xe+=Ee);var re=Fa(_[0],_[1],[xe-Ee,Ce-be,xe+Ee,Ce-be,xe+Ee,Ce+be,xe-Ee,Ce+be],a.x,a.y);if(re.length>0){var le=o,W=Jn(le,Vi(t)),Z=Jn(le,Vi(re)),ie=W;if(Z<W&&(t=[re[0],re[1]],ie=Z),re.length>2){var ne=Jn(le,{x:re[2],y:re[3]});ne<ie&&(t=[re[2],re[3]])}}}var oe=ps(t,b,e.arrowShapes[u].spacing(r)+c),ve=ps(t,b,e.arrowShapes[u].gap(r)+c);v.startX=ve[0],v.startY=ve[1],v.arrowStartX=oe[0],v.arrowStartY=oe[1],P&&(!Ne(v.startX)||!Ne(v.startY)||!Ne(v.endX)||!Ne(v.endY)?v.badLine=!0:v.badLine=!1)};Ka.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};Ka.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var Gu={};function db(r,e,t){for(var n=function(l,c,d,f){return Wt(l,c,d,f)},i=e._private,a=i.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var s=r.bezierProjPcts[o];a.push({x:n(t[0],t[2],t[4],s),y:n(t[1],t[3],t[5],s)})}}Gu.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,n=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<t.allpts.length;i+=4)db(this,r,t.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<t.allpts.length;i+=2)a.push({x:t.allpts[i],y:t.allpts[i+1]});else if(n==="haystack"){var o=t.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};Gu.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var rn={};rn.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!kn(e)){var t,n,i=r._private,a=r.width(),o=r.height(),s=r.padding(),u=r.position(),l=r.pstyle("text-halign").strValue,c=r.pstyle("text-valign").strValue,d=i.rscratch,f=i.rstyle;switch(l){case"left":t=u.x-a/2-s;break;case"right":t=u.x+a/2+s;break;default:t=u.x}switch(c){case"top":n=u.y-o/2-s;break;case"bottom":n=u.y+o/2+s;break;default:n=u.y}d.labelX=t,d.labelY=n,f.labelX=t,f.labelY=n,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var Zh=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n=n*-1),n},Qh=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Zh(n,i)},fb=function(e,t,n,i){var a=ka(0,i-.001,1),o=ka(0,i+.001,1),s=Gi(e,t,n,a),u=Gi(e,t,n,o);return Qh(s,u)};rn.recalculateEdgeLabelProjections=function(r){var e,t=r._private,n=t.rscratch,i=this,a={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var o=function(d,f,h){On(t.rscratch,d,f,h),On(t.rstyle,d,f,h)};o("labelX",null,e.x),o("labelY",null,e.y);var s=Zh(n.midDispX,n.midDispY);o("labelAutoAngle",null,s);var u=function c(){if(c.cache)return c.cache;for(var d=[],f=0;f+5<n.allpts.length;f+=4){var h={x:n.allpts[f],y:n.allpts[f+1]},v={x:n.allpts[f+2],y:n.allpts[f+3]},p={x:n.allpts[f+4],y:n.allpts[f+5]};d.push({p0:h,p1:v,p2:p,startDist:0,length:0,segments:[]})}var m=t.rstyle.bezierPts,g=i.bezierProjPcts.length;function y(R,L,O,I,B){var w=ai(L,O),T=R.segments[R.segments.length-1],E={p0:L,p1:O,t0:I,t1:B,startDist:T?T.startDist+T.length:0,length:w};R.segments.push(E),R.length+=w}for(var x=0;x<d.length;x++){var S=d[x],D=d[x-1];D&&(S.startDist=D.startDist+D.length),y(S,S.p0,m[x*g],0,i.bezierProjPcts[0]);for(var P=0;P<g-1;P++)y(S,m[x*g+P],m[x*g+P+1],i.bezierProjPcts[P],i.bezierProjPcts[P+1]);y(S,m[x*g+g-1],S.p2,i.bezierProjPcts[g-1],1)}return c.cache=d},l=function(d){var f,h=d==="source";if(a[d]){var v=r.pstyle(d+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var p=u(),m,g=0,y=0,x=0;x<p.length;x++){for(var S=p[h?x:p.length-1-x],D=0;D<S.segments.length;D++){var P=S.segments[h?D:S.segments.length-1-D],R=x===p.length-1&&D===S.segments.length-1;if(g=y,y+=P.length,y>=v||R){m={cp:S,segment:P};break}}if(m)break}var L=m.cp,O=m.segment,I=(v-g)/O.length,B=O.t1-O.t0,w=h?O.t0+B*I:O.t1-B*I;w=ka(0,w,1),e=Gi(L.p0,L.p1,L.p2,w),f=fb(L.p0,L.p1,L.p2,w);break}case"straight":case"segments":case"haystack":{for(var T=0,E,b,C,_,M=n.allpts.length,A=0;A+3<M&&(h?(C={x:n.allpts[A],y:n.allpts[A+1]},_={x:n.allpts[A+2],y:n.allpts[A+3]}):(C={x:n.allpts[M-2-A],y:n.allpts[M-1-A]},_={x:n.allpts[M-4-A],y:n.allpts[M-3-A]}),E=ai(C,_),b=T,T+=E,!(T>=v));A+=2);var F=v-b,N=F/E;N=ka(0,N,1),e=m0(C,_,N),f=Qh(C,_);break}}o("labelX",d,e.x),o("labelY",d,e.y),o("labelAutoAngle",d,f)}};l("source"),l("target"),this.applyLabelDimensions(r)}};rn.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};rn.applyPrefixedLabelDimensions=function(r,e){var t=r._private,n=this.getLabelText(r,e),i=this.calculateLabelDimensions(r,n),a=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,s=zr(t.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(s.length,1),l=i.height/u,c=l*a,d=i.width,f=i.height+(u-1)*(a-1)*l;On(t.rstyle,"labelWidth",e,d),On(t.rscratch,"labelWidth",e,d),On(t.rstyle,"labelHeight",e,f),On(t.rscratch,"labelHeight",e,f),On(t.rscratch,"labelLineHeight",e,c)};rn.getLabelText=function(r,e){var t=r._private,n=e?e+"-":"",i=r.pstyle(n+"label").strValue,a=r.pstyle("text-transform").value,o=function(Y,U){return U?(On(t.rscratch,Y,e,U),U):zr(t.rscratch,Y,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var s=r.pstyle("text-wrap").value;if(s==="wrap"){var u=o("labelKey");if(u!=null&&o("labelWrapKey")===u)return o("labelWrapCachedText");for(var l="\u200B",c=i.split(`
`),d=r.pstyle("text-max-width").pfValue,f=r.pstyle("text-overflow-wrap").value,h=f==="anywhere",v=[],p=/[\s\u200b]+|$/g,m=0;m<c.length;m++){var g=c[m],y=this.calculateLabelDimensions(r,g),x=y.width;if(h){var S=g.split("").join(l);g=S}if(x>d){var D=g.matchAll(p),P="",R=0,L=Sr(D),O;try{for(L.s();!(O=L.n()).done;){var I=O.value,B=I[0],w=g.substring(R,I.index);R=I.index+B.length;var T=P.length===0?w:P+w+B,E=this.calculateLabelDimensions(r,T),b=E.width;b<=d?P+=w+B:(P&&v.push(P),P=w+B)}}catch(z){L.e(z)}finally{L.f()}P.match(/^[\s\u200b]+$/)||v.push(P)}else v.push(g)}o("labelWrapCachedLines",v),i=o("labelWrapCachedText",v.join(`
`)),o("labelWrapKey",u)}else if(s==="ellipsis"){var C=r.pstyle("text-max-width").pfValue,_="",M="\u2026",A=!1;if(this.calculateLabelDimensions(r,i).width<C)return i;for(var F=0;F<i.length;F++){var N=this.calculateLabelDimensions(r,_+i[F]+M).width;if(N>C)break;_+=i[F],F===i.length-1&&(A=!0)}return A||(_+=M),_}return i};rn.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};rn.calculateLabelDimensions=function(r,e){var t=this,n=t.cy.window(),i=n.document,a=Fn(e,r._private.labelDimsKey),o=t.labelDimCache||(t.labelDimCache=[]),s=o[a];if(s!=null)return s;var u=0,l=r.pstyle("font-style").strValue,c=r.pstyle("font-size").pfValue,d=r.pstyle("font-family").strValue,f=r.pstyle("font-weight").strValue,h=this.labelCalcCanvas,v=this.labelCalcCanvasContext;if(!h){h=this.labelCalcCanvas=i.createElement("canvas"),v=this.labelCalcCanvasContext=h.getContext("2d");var p=h.style;p.position="absolute",p.left="-9999px",p.top="-9999px",p.zIndex="-1",p.visibility="hidden",p.pointerEvents="none"}v.font="".concat(l," ").concat(f," ").concat(c,"px ").concat(d);for(var m=0,g=0,y=e.split(`
`),x=0;x<y.length;x++){var S=y[x],D=v.measureText(S),P=Math.ceil(D.width),R=c;m=Math.max(P,m),g+=R}return m+=u,g+=u,o[a]={width:m,height:g}};rn.calculateLabelAngle=function(r,e){var t=r._private,n=t.rscratch,i=r.isEdge(),a=e?e+"-":"",o=r.pstyle(a+"text-rotation"),s=o.strValue;return s==="none"?0:i&&s==="autorotate"?n.labelAutoAngle:s==="autorotate"?0:o.pfValue};rn.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),n=r._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(r),t&&(i.sourceLabelAngle=e.calculateLabelAngle(r,"source"),i.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var Jh={},pf=28,gf=!1;Jh.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<pf||r.height()<pf))return gf||(ft("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),gf=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return t};var ul={};ul.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,n=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),s)for(var u=0;u<o.length;u++){var l=o[u],c=l._private,d=c.rstyle;d.clean=!1,d.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(o){var s=o.target;n(s)}).on("style.* background.*",function(o){var s=o.target;n(s,!1)});var i=function(o){if(o){var s=t.onUpdateEleCalcsFns;e.cleanStyle();for(var u=0;u<e.length;u++){var l=e[u],c=l._private.rstyle;l.isNode()&&!c.cleanConnected&&(n(l.connectedEdges()),c.cleanConnected=!0)}if(s)for(var d=0;d<s.length;d++){var f=s[d];f(o,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){i(!0)},t.beforeRender(i,t.beforeRenderPriorities.eleCalcs)};ul.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};ul.recalculateRenderedStyle=function(r,e){var t=function(S){return S._private.rstyle.cleanConnected},n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<r.length;a++){var o=r[a],s=o._private,u=s.rstyle;o.isEdge()&&(!t(o.source())||!t(o.target()))&&(u.clean=!1),!(e&&u.clean||o.removed())&&o.pstyle("display").value!=="none"&&(s.group==="nodes"?i.push(o):n.push(o),u.clean=!0)}for(var l=0;l<i.length;l++){var c=i[l],d=c._private,f=d.rstyle,h=c.position();this.recalculateNodeLabelProjection(c),f.nodeX=h.x,f.nodeY=h.y,f.nodeW=c.pstyle("width").pfValue,f.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var v=0;v<n.length;v++){var p=n[v],m=p._private,g=m.rstyle,y=m.rscratch;g.srcX=y.arrowStartX,g.srcY=y.arrowStartY,g.tgtX=y.arrowEndX,g.tgtY=y.arrowEndY,g.midX=y.midX,g.midY=y.midY,g.labelAngle=y.labelAngle,g.sourceLabelAngle=y.sourceLabelAngle,g.targetLabelAngle=y.targetLabelAngle}}};var cl={};cl.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var n=r[t],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?r.drag.push(n):r.nondrag.push(n)}for(var t=0;t<e.length;t++){var n=e[t];r.drag.push(n)}}};cl.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};cl.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(kh),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var ev={};[ci,$s,lr,Ka,Gu,rn,Jh,ul,cl].forEach(function(r){Ye(ev,r)});var tv={};tv.getCachedImage=function(r,e,t){var n=this,i=n.imageCache=n.imageCache||{},a=i[r];if(a)return a.image.complete||a.image.addEventListener("load",t),a.image;a=i[r]=i[r]||{};var o=a.image=new Image;o.addEventListener("load",t),o.addEventListener("error",function(){o.error=!0});var s="data:",u=r.substring(0,s.length).toLowerCase()===s;return u||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var ra={};ra.registerBinding=function(r,e,t,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var a=[],o=0;o<r.length;o++){var s=r[o];if(s!==void 0){var u=this.binder(s);a.push(u.on.apply(u,i))}}return a}var u=this.binder(r);return u.on.apply(u,i)};ra.binder=function(r){var e=this,t=e.cy.window(),n=r===t||r===t.document||r===t.document.body||Bg(r);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});t.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var o=function(u,l,c){var d=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(d[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:d}),(r.addEventListener||r.on).apply(r,d),this};return{on:o,addEventListener:o,addListener:o,bind:o}};ra.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};ra.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};ra.load=function(){var r=this,e=r.cy.window(),t=function(V){return V.selected()},n=function(V){var re=V.getRootNode();if(re&&re.nodeType===11&&re.host!==void 0)return re},i=function(V,re,le,W){V==null&&(V=r.cy);for(var Z=0;Z<re.length;Z++){var ie=re[Z];V.emit({originalEvent:le,type:ie,position:W})}},a=function(V){return V.shiftKey||V.metaKey||V.ctrlKey},o=function(V,re){var le=!0;if(r.cy.hasCompoundNodes()&&V&&V.pannable())for(var W=0;re&&W<re.length;W++){var V=re[W];if(V.isNode()&&V.isParent()&&!V.pannable()){le=!1;break}}else le=!0;return le},s=function(V){V[0]._private.grabbed=!0},u=function(V){V[0]._private.grabbed=!1},l=function(V){V[0]._private.rscratch.inDragLayer=!0},c=function(V){V[0]._private.rscratch.inDragLayer=!1},d=function(V){V[0]._private.rscratch.isGrabTarget=!0},f=function(V){V[0]._private.rscratch.isGrabTarget=!1},h=function(V,re){var le=re.addToList,W=le.has(V);!W&&V.grabbable()&&!V.locked()&&(le.merge(V),s(V))},v=function(V,re){if(V.cy().hasCompoundNodes()&&!(re.inDragLayer==null&&re.addToList==null)){var le=V.descendants();re.inDragLayer&&(le.forEach(l),le.connectedEdges().forEach(l)),re.addToList&&h(le,re)}},p=function(V,re){re=re||{};var le=V.cy().hasCompoundNodes();re.inDragLayer&&(V.forEach(l),V.neighborhood().stdFilter(function(W){return!le||W.isEdge()}).forEach(l)),re.addToList&&V.forEach(function(W){h(W,re)}),v(V,re),y(V,{inDragLayer:re.inDragLayer}),r.updateCachedGrabbedEles()},m=p,g=function(V){V&&(r.getCachedZSortedEles().forEach(function(re){u(re),c(re),f(re)}),r.updateCachedGrabbedEles())},y=function(V,re){if(!(re.inDragLayer==null&&re.addToList==null)&&V.cy().hasCompoundNodes()){var le=V.ancestors().orphans();if(!le.same(V)){var W=le.descendants().spawnSelf().merge(le).unmerge(V).unmerge(V.descendants()),Z=W.connectedEdges();re.inDragLayer&&(Z.forEach(l),W.forEach(l)),re.addToList&&W.forEach(function(ie){h(ie,re)})}}},x=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},S=typeof MutationObserver<"u",D=typeof ResizeObserver<"u";S?(r.removeObserver=new MutationObserver(function(fe){for(var V=0;V<fe.length;V++){var re=fe[V],le=re.removedNodes;if(le)for(var W=0;W<le.length;W++){var Z=le[W];if(Z===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(fe){r.destroy()});var P=Wa(function(){r.cy.resize()},100);S&&(r.styleObserver=new MutationObserver(P),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",P),D&&(r.resizeObserver=new ResizeObserver(P),r.resizeObserver.observe(r.container));var R=function(V,re){for(;V!=null;)re(V),V=V.parentNode},L=function(){r.invalidateContainerClientCoordsCache()};R(r.container,function(fe){r.registerBinding(fe,"transitionend",L),r.registerBinding(fe,"animationend",L),r.registerBinding(fe,"scroll",L)}),r.registerBinding(r.container,"contextmenu",function(fe){fe.preventDefault()});var O=function(){return r.selection[4]!==0},I=function(V){for(var re=r.findContainerClientCoords(),le=re[0],W=re[1],Z=re[2],ie=re[3],ne=V.touches?V.touches:[V],oe=!1,ve=0;ve<ne.length;ve++){var Re=ne[ve];if(le<=Re.clientX&&Re.clientX<=le+Z&&W<=Re.clientY&&Re.clientY<=W+ie){oe=!0;break}}if(!oe)return!1;for(var we=r.container,pe=V.target,Se=pe.parentNode,Me=!1;Se;){if(Se===we){Me=!0;break}Se=Se.parentNode}return!!Me};r.registerBinding(r.container,"mousedown",function(V){if(I(V)&&!(r.hoverData.which===1&&V.which!==1)){V.preventDefault(),x(),r.hoverData.capture=!0,r.hoverData.which=V.which;var re=r.cy,le=[V.clientX,V.clientY],W=r.projectIntoViewport(le[0],le[1]),Z=r.selection,ie=r.findNearestElements(W[0],W[1],!0,!1),ne=ie[0],oe=r.dragData.possibleDragElements;r.hoverData.mdownPos=W,r.hoverData.mdownGPos=le;var ve=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var Oe=r.hoverData.down;Oe?Oe.emit({originalEvent:V,type:"taphold",position:{x:W[0],y:W[1]}}):re.emit({originalEvent:V,type:"taphold",position:{x:W[0],y:W[1]}})}},r.tapholdDuration)};if(V.which==3){r.hoverData.cxtStarted=!0;var Re={originalEvent:V,type:"cxttapstart",position:{x:W[0],y:W[1]}};ne?(ne.activate(),ne.emit(Re),r.hoverData.down=ne):re.emit(Re),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(V.which==1){ne&&ne.activate();{if(ne!=null&&r.nodeIsGrabbable(ne)){var we=function(Oe){return{originalEvent:V,type:Oe,position:{x:W[0],y:W[1]}}},pe=function(Oe){Oe.emit(we("grab"))};if(d(ne),!ne.selected())oe=r.dragData.possibleDragElements=re.collection(),m(ne,{addToList:oe}),ne.emit(we("grabon")).emit(we("grab"));else{oe=r.dragData.possibleDragElements=re.collection();var Se=re.$(function(Me){return Me.isNode()&&Me.selected()&&r.nodeIsGrabbable(Me)});p(Se,{addToList:oe}),ne.emit(we("grabon")),Se.forEach(pe)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=ne,r.hoverData.downs=ie,r.hoverData.downTime=new Date().getTime()}i(ne,["mousedown","tapstart","vmousedown"],V,{x:W[0],y:W[1]}),ne==null?(Z[4]=1,r.data.bgActivePosistion={x:W[0],y:W[1]},r.redrawHint("select",!0),r.redraw()):ne.pannable()&&(Z[4]=1),ve()}Z[0]=Z[2]=W[0],Z[1]=Z[3]=W[1]}},!1);var B=n(r.container);r.registerBinding([e,B],"mousemove",function(V){var re=r.hoverData.capture;if(!(!re&&!I(V))){var le=!1,W=r.cy,Z=W.zoom(),ie=[V.clientX,V.clientY],ne=r.projectIntoViewport(ie[0],ie[1]),oe=r.hoverData.mdownPos,ve=r.hoverData.mdownGPos,Re=r.selection,we=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(we=r.findNearestElement(ne[0],ne[1],!0,!1));var pe=r.hoverData.last,Se=r.hoverData.down,Me=[ne[0]-Re[2],ne[1]-Re[3]],Oe=r.dragData.possibleDragElements,Ve;if(ve){var Ke=ie[0]-ve[0],ze=Ke*Ke,Ie=ie[1]-ve[1],He=Ie*Ie,ke=ze+He;r.hoverData.isOverThresholdDrag=Ve=ke>=r.desktopTapThreshold2}var Ge=a(V);Ve&&(r.hoverData.tapholdCancelled=!0);var rt=function(){var Gt=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Gt.length===0?(Gt.push(Me[0]),Gt.push(Me[1])):(Gt[0]+=Me[0],Gt[1]+=Me[1])};le=!0,i(we,["mousemove","vmousemove","tapdrag"],V,{x:ne[0],y:ne[1]});var nt=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||W.emit({originalEvent:V,type:"boxstart",position:{x:ne[0],y:ne[1]}}),Re[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(Ve){var mt={originalEvent:V,type:"cxtdrag",position:{x:ne[0],y:ne[1]}};Se?Se.emit(mt):W.emit(mt),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||we!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:V,type:"cxtdragout",position:{x:ne[0],y:ne[1]}}),r.hoverData.cxtOver=we,we&&we.emit({originalEvent:V,type:"cxtdragover",position:{x:ne[0],y:ne[1]}}))}}else if(r.hoverData.dragging){if(le=!0,W.panningEnabled()&&W.userPanningEnabled()){var et;if(r.hoverData.justStartedPan){var Ze=r.hoverData.mdownPos;et={x:(ne[0]-Ze[0])*Z,y:(ne[1]-Ze[1])*Z},r.hoverData.justStartedPan=!1}else et={x:Me[0]*Z,y:Me[1]*Z};W.panBy(et),W.emit("dragpan"),r.hoverData.dragged=!0}ne=r.projectIntoViewport(V.clientX,V.clientY)}else if(Re[4]==1&&(Se==null||Se.pannable())){if(Ve){if(!r.hoverData.dragging&&W.boxSelectionEnabled()&&(Ge||!W.panningEnabled()||!W.userPanningEnabled()))nt();else if(!r.hoverData.selecting&&W.panningEnabled()&&W.userPanningEnabled()){var At=o(Se,r.hoverData.downs);At&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,Re[4]=0,r.data.bgActivePosistion=Vi(oe),r.redrawHint("select",!0),r.redraw())}Se&&Se.pannable()&&Se.active()&&Se.unactivate()}}else{if(Se&&Se.pannable()&&Se.active()&&Se.unactivate(),(!Se||!Se.grabbed())&&we!=pe&&(pe&&i(pe,["mouseout","tapdragout"],V,{x:ne[0],y:ne[1]}),we&&i(we,["mouseover","tapdragover"],V,{x:ne[0],y:ne[1]}),r.hoverData.last=we),Se)if(Ve){if(W.boxSelectionEnabled()&&Ge)Se&&Se.grabbed()&&(g(Oe),Se.emit("freeon"),Oe.emit("free"),r.dragData.didDrag&&(Se.emit("dragfreeon"),Oe.emit("dragfree"))),nt();else if(Se&&Se.grabbed()&&r.nodeIsDraggable(Se)){var Je=!r.dragData.didDrag;Je&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||p(Oe,{inDragLayer:!0});var at={x:0,y:0};if(Ne(Me[0])&&Ne(Me[1])&&(at.x+=Me[0],at.y+=Me[1],Je)){var vt=r.hoverData.dragDelta;vt&&Ne(vt[0])&&Ne(vt[1])&&(at.x+=vt[0],at.y+=vt[1])}r.hoverData.draggingEles=!0,Oe.silentShift(at).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else rt();le=!0}if(Re[2]=ne[0],Re[3]=ne[1],le)return V.stopPropagation&&V.stopPropagation(),V.preventDefault&&V.preventDefault(),!1}},!1);var w,T,E;r.registerBinding(e,"mouseup",function(V){if(!(r.hoverData.which===1&&V.which!==1&&r.hoverData.capture)){var re=r.hoverData.capture;if(re){r.hoverData.capture=!1;var le=r.cy,W=r.projectIntoViewport(V.clientX,V.clientY),Z=r.selection,ie=r.findNearestElement(W[0],W[1],!0,!1),ne=r.dragData.possibleDragElements,oe=r.hoverData.down,ve=a(V);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,oe&&oe.unactivate(),r.hoverData.which===3){var Re={originalEvent:V,type:"cxttapend",position:{x:W[0],y:W[1]}};if(oe?oe.emit(Re):le.emit(Re),!r.hoverData.cxtDragged){var we={originalEvent:V,type:"cxttap",position:{x:W[0],y:W[1]}};oe?oe.emit(we):le.emit(we)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(i(ie,["mouseup","tapend","vmouseup"],V,{x:W[0],y:W[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(i(oe,["click","tap","vclick"],V,{x:W[0],y:W[1]}),T=!1,V.timeStamp-E<=le.multiClickDebounceTime()?(w&&clearTimeout(w),T=!0,E=null,i(oe,["dblclick","dbltap","vdblclick"],V,{x:W[0],y:W[1]})):(w=setTimeout(function(){T||i(oe,["oneclick","onetap","voneclick"],V,{x:W[0],y:W[1]})},le.multiClickDebounceTime()),E=V.timeStamp)),oe==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!a(V)&&(le.$(t).unselect(["tapunselect"]),ne.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=ne=le.collection()),ie==oe&&!r.dragData.didDrag&&!r.hoverData.selecting&&ie!=null&&ie._private.selectable&&(r.hoverData.dragging||(le.selectionType()==="additive"||ve?ie.selected()?ie.unselect(["tapunselect"]):ie.select(["tapselect"]):ve||(le.$(t).unmerge(ie).unselect(["tapunselect"]),ie.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var pe=le.collection(r.getAllInBox(Z[0],Z[1],Z[2],Z[3]));r.redrawHint("select",!0),pe.length>0&&r.redrawHint("eles",!0),le.emit({type:"boxend",originalEvent:V,position:{x:W[0],y:W[1]}});var Se=function(Ve){return Ve.selectable()&&!Ve.selected()};le.selectionType()==="additive"||ve||le.$(t).unmerge(pe).unselect(),pe.emit("box").stdFilter(Se).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!Z[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Me=oe&&oe.grabbed();g(ne),Me&&(oe.emit("freeon"),ne.emit("free"),r.dragData.didDrag&&(oe.emit("dragfreeon"),ne.emit("dragfree")))}}Z[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var b=function(V){if(!r.scrollingPage){var re=r.cy,le=re.zoom(),W=re.pan(),Z=r.projectIntoViewport(V.clientX,V.clientY),ie=[Z[0]*le+W.x,Z[1]*le+W.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||O()){V.preventDefault();return}if(re.panningEnabled()&&re.userPanningEnabled()&&re.zoomingEnabled()&&re.userZoomingEnabled()){V.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var ne;V.deltaY!=null?ne=V.deltaY/-250:V.wheelDeltaY!=null?ne=V.wheelDeltaY/1e3:ne=V.wheelDelta/1e3,ne=ne*r.wheelSensitivity;var oe=V.deltaMode===1;oe&&(ne*=33);var ve=re.zoom()*Math.pow(10,ne);V.type==="gesturechange"&&(ve=r.gestureStartZoom*V.scale),re.zoom({level:ve,renderedPosition:{x:ie[0],y:ie[1]}}),re.emit(V.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",b,!0),r.registerBinding(e,"scroll",function(V){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(V){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||V.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(fe){r.hasTouchStarted||b(fe)},!0),r.registerBinding(r.container,"mouseout",function(V){var re=r.projectIntoViewport(V.clientX,V.clientY);r.cy.emit({originalEvent:V,type:"mouseout",position:{x:re[0],y:re[1]}})},!1),r.registerBinding(r.container,"mouseover",function(V){var re=r.projectIntoViewport(V.clientX,V.clientY);r.cy.emit({originalEvent:V,type:"mouseover",position:{x:re[0],y:re[1]}})},!1);var C,_,M,A,F,N,z,Y,U,ee,Q,j,K,H=function(V,re,le,W){return Math.sqrt((le-V)*(le-V)+(W-re)*(W-re))},k=function(V,re,le,W){return(le-V)*(le-V)+(W-re)*(W-re)},G;r.registerBinding(r.container,"touchstart",G=function(V){if(r.hasTouchStarted=!0,!!I(V)){x(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var re=r.cy,le=r.touchData.now,W=r.touchData.earlier;if(V.touches[0]){var Z=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);le[0]=Z[0],le[1]=Z[1]}if(V.touches[1]){var Z=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);le[2]=Z[0],le[3]=Z[1]}if(V.touches[2]){var Z=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);le[4]=Z[0],le[5]=Z[1]}if(V.touches[1]){r.touchData.singleTouchMoved=!0,g(r.dragData.touchDragEles);var ie=r.findContainerClientCoords();U=ie[0],ee=ie[1],Q=ie[2],j=ie[3],C=V.touches[0].clientX-U,_=V.touches[0].clientY-ee,M=V.touches[1].clientX-U,A=V.touches[1].clientY-ee,K=0<=C&&C<=Q&&0<=M&&M<=Q&&0<=_&&_<=j&&0<=A&&A<=j;var ne=re.pan(),oe=re.zoom();F=H(C,_,M,A),N=k(C,_,M,A),z=[(C+M)/2,(_+A)/2],Y=[(z[0]-ne.x)/oe,(z[1]-ne.y)/oe];var ve=200,Re=ve*ve;if(N<Re&&!V.touches[2]){var we=r.findNearestElement(le[0],le[1],!0,!0),pe=r.findNearestElement(le[2],le[3],!0,!0);we&&we.isNode()?(we.activate().emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start=we):pe&&pe.isNode()?(pe.activate().emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start=pe):re.emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(V.touches[2])re.boxSelectionEnabled()&&V.preventDefault();else if(!V.touches[1]){if(V.touches[0]){var Se=r.findNearestElements(le[0],le[1],!0,!0),Me=Se[0];if(Me!=null&&(Me.activate(),r.touchData.start=Me,r.touchData.starts=Se,r.nodeIsGrabbable(Me))){var Oe=r.dragData.touchDragEles=re.collection(),Ve=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Me.selected()?(Ve=re.$(function(ke){return ke.selected()&&r.nodeIsGrabbable(ke)}),p(Ve,{addToList:Oe})):m(Me,{addToList:Oe}),d(Me);var Ke=function(Ge){return{originalEvent:V,type:Ge,position:{x:le[0],y:le[1]}}};Me.emit(Ke("grabon")),Ve?Ve.forEach(function(ke){ke.emit(Ke("grab"))}):Me.emit(Ke("grab"))}i(Me,["touchstart","tapstart","vmousedown"],V,{x:le[0],y:le[1]}),Me==null&&(r.data.bgActivePosistion={x:Z[0],y:Z[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&i(r.touchData.start,["taphold"],V,{x:le[0],y:le[1]})},r.tapholdDuration)}}if(V.touches.length>=1){for(var ze=r.touchData.startPosition=[null,null,null,null,null,null],Ie=0;Ie<le.length;Ie++)ze[Ie]=W[Ie]=le[Ie];var He=V.touches[0];r.touchData.startGPosition=[He.clientX,He.clientY]}}},!1);var $;r.registerBinding(e,"touchmove",$=function(V){var re=r.touchData.capture;if(!(!re&&!I(V))){var le=r.selection,W=r.cy,Z=r.touchData.now,ie=r.touchData.earlier,ne=W.zoom();if(V.touches[0]){var oe=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Z[0]=oe[0],Z[1]=oe[1]}if(V.touches[1]){var oe=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);Z[2]=oe[0],Z[3]=oe[1]}if(V.touches[2]){var oe=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);Z[4]=oe[0],Z[5]=oe[1]}var ve=r.touchData.startGPosition,Re;if(re&&V.touches[0]&&ve){for(var we=[],pe=0;pe<Z.length;pe++)we[pe]=Z[pe]-ie[pe];var Se=V.touches[0].clientX-ve[0],Me=Se*Se,Oe=V.touches[0].clientY-ve[1],Ve=Oe*Oe,Ke=Me+Ve;Re=Ke>=r.touchTapThreshold2}if(re&&r.touchData.cxt){V.preventDefault();var ze=V.touches[0].clientX-U,Ie=V.touches[0].clientY-ee,He=V.touches[1].clientX-U,ke=V.touches[1].clientY-ee,Ge=k(ze,Ie,He,ke),rt=Ge/N,nt=150,mt=nt*nt,et=1.5,Ze=et*et;if(rt>=Ze||Ge>=mt){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var At={originalEvent:V,type:"cxttapend",position:{x:Z[0],y:Z[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(At),r.touchData.start=null):W.emit(At)}}if(re&&r.touchData.cxt){var At={originalEvent:V,type:"cxtdrag",position:{x:Z[0],y:Z[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(At):W.emit(At),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var Je=r.findNearestElement(Z[0],Z[1],!0,!0);(!r.touchData.cxtOver||Je!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:V,type:"cxtdragout",position:{x:Z[0],y:Z[1]}}),r.touchData.cxtOver=Je,Je&&Je.emit({originalEvent:V,type:"cxtdragover",position:{x:Z[0],y:Z[1]}}))}else if(re&&V.touches[2]&&W.boxSelectionEnabled())V.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||W.emit({originalEvent:V,type:"boxstart",position:{x:Z[0],y:Z[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,le[4]=1,!le||le.length===0||le[0]===void 0?(le[0]=(Z[0]+Z[2]+Z[4])/3,le[1]=(Z[1]+Z[3]+Z[5])/3,le[2]=(Z[0]+Z[2]+Z[4])/3+1,le[3]=(Z[1]+Z[3]+Z[5])/3+1):(le[2]=(Z[0]+Z[2]+Z[4])/3,le[3]=(Z[1]+Z[3]+Z[5])/3),r.redrawHint("select",!0),r.redraw();else if(re&&V.touches[1]&&!r.touchData.didSelect&&W.zoomingEnabled()&&W.panningEnabled()&&W.userZoomingEnabled()&&W.userPanningEnabled()){V.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var at=r.dragData.touchDragEles;if(at){r.redrawHint("drag",!0);for(var vt=0;vt<at.length;vt++){var mn=at[vt]._private;mn.grabbed=!1,mn.rscratch.inDragLayer=!1}}var Gt=r.touchData.start,ze=V.touches[0].clientX-U,Ie=V.touches[0].clientY-ee,He=V.touches[1].clientX-U,ke=V.touches[1].clientY-ee,sn=H(ze,Ie,He,ke),yn=sn/F;if(K){var ln=ze-C,mi=Ie-_,Cn=He-M,wn=ke-A,ho=(ln+Cn)/2,ca=(mi+wn)/2,bn=W.zoom(),qn=bn*yn,yi=W.pan(),Ci=Y[0]*bn+yi.x,da=Y[1]*bn+yi.y,vo={x:-qn/bn*(Ci-yi.x-ho)+Ci,y:-qn/bn*(da-yi.y-ca)+da};if(Gt&&Gt.active()){var at=r.dragData.touchDragEles;g(at),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Gt.unactivate().emit("freeon"),at.emit("free"),r.dragData.didDrag&&(Gt.emit("dragfreeon"),at.emit("dragfree"))}W.viewport({zoom:qn,pan:vo,cancelOnFailedZoom:!0}),W.emit("pinchzoom"),F=sn,C=ze,_=Ie,M=He,A=ke,r.pinching=!0}if(V.touches[0]){var oe=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Z[0]=oe[0],Z[1]=oe[1]}if(V.touches[1]){var oe=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);Z[2]=oe[0],Z[3]=oe[1]}if(V.touches[2]){var oe=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);Z[4]=oe[0],Z[5]=oe[1]}}else if(V.touches[0]&&!r.touchData.didSelect){var ur=r.touchData.start,wi=r.touchData.last,Je;if(!r.hoverData.draggingEles&&!r.swipePanning&&(Je=r.findNearestElement(Z[0],Z[1],!0,!0)),re&&ur!=null&&V.preventDefault(),re&&ur!=null&&r.nodeIsDraggable(ur))if(Re){var at=r.dragData.touchDragEles,Rt=!r.dragData.didDrag;Rt&&p(at,{inDragLayer:!0}),r.dragData.didDrag=!0;var Xe={x:0,y:0};if(Ne(we[0])&&Ne(we[1])&&(Xe.x+=we[0],Xe.y+=we[1],Rt)){r.redrawHint("eles",!0);var Qe=r.touchData.dragDelta;Qe&&Ne(Qe[0])&&Ne(Qe[1])&&(Xe.x+=Qe[0],Xe.y+=Qe[1])}r.hoverData.draggingEles=!0,at.silentShift(Xe).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==ie[0]&&r.touchData.startPosition[1]==ie[1]&&r.redrawHint("eles",!0),r.redraw()}else{var Qe=r.touchData.dragDelta=r.touchData.dragDelta||[];Qe.length===0?(Qe.push(we[0]),Qe.push(we[1])):(Qe[0]+=we[0],Qe[1]+=we[1])}if(i(ur||Je,["touchmove","tapdrag","vmousemove"],V,{x:Z[0],y:Z[1]}),(!ur||!ur.grabbed())&&Je!=wi&&(wi&&wi.emit({originalEvent:V,type:"tapdragout",position:{x:Z[0],y:Z[1]}}),Je&&Je.emit({originalEvent:V,type:"tapdragover",position:{x:Z[0],y:Z[1]}})),r.touchData.last=Je,re)for(var vt=0;vt<Z.length;vt++)Z[vt]&&r.touchData.startPosition[vt]&&Re&&(r.touchData.singleTouchMoved=!0);if(re&&(ur==null||ur.pannable())&&W.panningEnabled()&&W.userPanningEnabled()){var Wr=o(ur,r.touchData.starts);Wr&&(V.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Vi(r.touchData.startPosition)),r.swipePanning?(W.panBy({x:we[0]*ne,y:we[1]*ne}),W.emit("dragpan")):Re&&(r.swipePanning=!0,W.panBy({x:Se*ne,y:Oe*ne}),W.emit("dragpan"),ur&&(ur.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var oe=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Z[0]=oe[0],Z[1]=oe[1]}}for(var pe=0;pe<Z.length;pe++)ie[pe]=Z[pe];re&&V.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var te;r.registerBinding(e,"touchcancel",te=function(V){var re=r.touchData.start;r.touchData.capture=!1,re&&re.unactivate()});var q,ge,Te,he;if(r.registerBinding(e,"touchend",q=function(V){var re=r.touchData.start,le=r.touchData.capture;if(le)V.touches.length===0&&(r.touchData.capture=!1),V.preventDefault();else return;var W=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var Z=r.cy,ie=Z.zoom(),ne=r.touchData.now,oe=r.touchData.earlier;if(V.touches[0]){var ve=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);ne[0]=ve[0],ne[1]=ve[1]}if(V.touches[1]){var ve=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);ne[2]=ve[0],ne[3]=ve[1]}if(V.touches[2]){var ve=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);ne[4]=ve[0],ne[5]=ve[1]}re&&re.unactivate();var Re;if(r.touchData.cxt){if(Re={originalEvent:V,type:"cxttapend",position:{x:ne[0],y:ne[1]}},re?re.emit(Re):Z.emit(Re),!r.touchData.cxtDragged){var we={originalEvent:V,type:"cxttap",position:{x:ne[0],y:ne[1]}};re?re.emit(we):Z.emit(we)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!V.touches[2]&&Z.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var pe=Z.collection(r.getAllInBox(W[0],W[1],W[2],W[3]));W[0]=void 0,W[1]=void 0,W[2]=void 0,W[3]=void 0,W[4]=0,r.redrawHint("select",!0),Z.emit({type:"boxend",originalEvent:V,position:{x:ne[0],y:ne[1]}});var Se=function(mt){return mt.selectable()&&!mt.selected()};pe.emit("box").stdFilter(Se).select().emit("boxselect"),pe.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(re?.unactivate(),V.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!V.touches[1]){if(!V.touches[0]){if(!V.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Me=r.dragData.touchDragEles;if(re!=null){var Oe=re._private.grabbed;g(Me),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Oe&&(re.emit("freeon"),Me.emit("free"),r.dragData.didDrag&&(re.emit("dragfreeon"),Me.emit("dragfree"))),i(re,["touchend","tapend","vmouseup","tapdragout"],V,{x:ne[0],y:ne[1]}),re.unactivate(),r.touchData.start=null}else{var Ve=r.findNearestElement(ne[0],ne[1],!0,!0);i(Ve,["touchend","tapend","vmouseup","tapdragout"],V,{x:ne[0],y:ne[1]})}var Ke=r.touchData.startPosition[0]-ne[0],ze=Ke*Ke,Ie=r.touchData.startPosition[1]-ne[1],He=Ie*Ie,ke=ze+He,Ge=ke*ie*ie;r.touchData.singleTouchMoved||(re||Z.$(":selected").unselect(["tapunselect"]),i(re,["tap","vclick"],V,{x:ne[0],y:ne[1]}),ge=!1,V.timeStamp-he<=Z.multiClickDebounceTime()?(Te&&clearTimeout(Te),ge=!0,he=null,i(re,["dbltap","vdblclick"],V,{x:ne[0],y:ne[1]})):(Te=setTimeout(function(){ge||i(re,["onetap","voneclick"],V,{x:ne[0],y:ne[1]})},Z.multiClickDebounceTime()),he=V.timeStamp)),re!=null&&!r.dragData.didDrag&&re._private.selectable&&Ge<r.touchTapThreshold2&&!r.pinching&&(Z.selectionType()==="single"?(Z.$(t).unmerge(re).unselect(["tapunselect"]),re.select(["tapselect"])):re.selected()?re.unselect(["tapunselect"]):re.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var rt=0;rt<ne.length;rt++)oe[rt]=ne[rt];r.dragData.didDrag=!1,V.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),V.touches.length<2&&(V.touches.length===1&&(r.touchData.startGPosition=[V.touches[0].clientX,V.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var ue=[],de=function(V){return{clientX:V.clientX,clientY:V.clientY,force:1,identifier:V.pointerId,pageX:V.pageX,pageY:V.pageY,radiusX:V.width/2,radiusY:V.height/2,screenX:V.screenX,screenY:V.screenY,target:V.target}},me=function(V){return{event:V,touch:de(V)}},_e=function(V){ue.push(me(V))},xe=function(V){for(var re=0;re<ue.length;re++){var le=ue[re];if(le.event.pointerId===V.pointerId){ue.splice(re,1);return}}},Ce=function(V){var re=ue.filter(function(le){return le.event.pointerId===V.pointerId})[0];re.event=V,re.touch=de(V)},Ee=function(V){V.touches=ue.map(function(re){return re.touch})},be=function(V){return V.pointerType==="mouse"||V.pointerType===4};r.registerBinding(r.container,"pointerdown",function(fe){be(fe)||(fe.preventDefault(),_e(fe),Ee(fe),G(fe))}),r.registerBinding(r.container,"pointerup",function(fe){be(fe)||(xe(fe),Ee(fe),q(fe))}),r.registerBinding(r.container,"pointercancel",function(fe){be(fe)||(xe(fe),Ee(fe),te(fe))}),r.registerBinding(r.container,"pointermove",function(fe){be(fe)||(fe.preventDefault(),Ce(fe),Ee(fe),$(fe))})}};var vn={};vn.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(n,i,a,o,s,u){this.renderer.nodeShapeImpl("polygon",n,i,a,o,s,this.points)},intersectLine:function(n,i,a,o,s,u,l,c){return Fa(s,u,this.points,n,i,a/2,o/2,l)},checkPoint:function(n,i,a,o,s,u,l,c){return fn(n,i,this.points,u,l,o,s,[0,-1],a)}}};vn.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,u){return P0(a,o,e,t,n/2+s,i/2+s)},checkPoint:function(e,t,n,i,a,o,s,u){return ni(e,t,i,a,o,s,n)}}};vn.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(n,i,a,o,s,u,l){if(u[l]!==void 0&&u[l+"-cx"]===n&&u[l+"-cy"]===i)return u[l];u[l]=new Array(e.length/2),u[l+"-cx"]=n,u[l+"-cy"]=i;var c=a/2,d=o/2;s=s==="auto"?ih(a,o):s;for(var f=new Array(e.length/2),h=0;h<e.length/2;h++)f[h]={x:n+c*e[h*2],y:i+d*e[h*2+1]};var v,p,m,g,y=f.length;for(p=f[y-1],v=0;v<y;v++)m=f[v%y],g=f[(v+1)%y],u[l][v]=zu(p,m,g,s),p=m,m=g;return u[l]},draw:function(n,i,a,o,s,u,l){this.renderer.nodeShapeImpl("round-polygon",n,i,a,o,s,this.points,this.getOrCreateCorners(i,a,o,s,u,l,"drawCorners"))},intersectLine:function(n,i,a,o,s,u,l,c,d){return R0(s,u,this.points,n,i,a,o,l,this.getOrCreateCorners(n,i,a,o,c,d,"corners"))},checkPoint:function(n,i,a,o,s,u,l,c,d){return A0(n,i,this.points,u,l,o,s,this.getOrCreateCorners(u,l,o,s,c,d,"corners"))}}};vn.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:cr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,u){return rh(a,o,e,t,n,i,s,u)},checkPoint:function(e,t,n,i,a,o,s,u){var l=i/2,c=a/2;u=u==="auto"?oi(i,a):u,u=Math.min(l,c,u);var d=u*2;return!!(fn(e,t,this.points,o,s,i,a-d,[0,-1],n)||fn(e,t,this.points,o,s,i-d,a,[0,-1],n)||ni(e,t,d,d,o-l+u,s-c+u,n)||ni(e,t,d,d,o+l-u,s-c+u,n)||ni(e,t,d,d,o+l-u,s+c-u,n)||ni(e,t,d,d,o-l+u,s+c-u,n))}}};vn.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:Du(),points:cr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,null,o)},generateCutTrianglePts:function(e,t,n,i,a){var o=a==="auto"?this.cornerLength:a,s=t/2,u=e/2,l=n-u,c=n+u,d=i-s,f=i+s;return{topLeft:[l,d+o,l+o,d,l+o,d+o],topRight:[c-o,d,c,d+o,c-o,d+o],bottomRight:[c,f-o,c-o,f,c-o,f-o],bottomLeft:[l+o,f,l,f-o,l+o,f-o]}},intersectLine:function(e,t,n,i,a,o,s,u){var l=this.generateCutTrianglePts(n+2*s,i+2*s,e,t,u),c=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return Fa(a,o,c,e,t)},checkPoint:function(e,t,n,i,a,o,s,u){var l=u==="auto"?this.cornerLength:u;if(fn(e,t,this.points,o,s,i,a-2*l,[0,-1],n)||fn(e,t,this.points,o,s,i-2*l,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,o,s);return wr(e,t,c.topLeft)||wr(e,t,c.topRight)||wr(e,t,c.bottomRight)||wr(e,t,c.bottomLeft)}}};vn.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:cr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,u){var l=.15,c=.5,d=.85,f=this.generateBarrelBezierPts(n+2*s,i+2*s,e,t),h=function(m){var g=Gi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},l),y=Gi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},c),x=Gi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},d);return[m[0],m[1],g.x,g.y,y.x,y.y,x.x,x.y,m[4],m[5]]},v=[].concat(h(f.topLeft),h(f.topRight),h(f.bottomRight),h(f.bottomLeft));return Fa(a,o,v,e,t)},generateBarrelBezierPts:function(e,t,n,i){var a=t/2,o=e/2,s=n-o,u=n+o,l=i-a,c=i+a,d=au(e,t),f=d.heightOffset,h=d.widthOffset,v=d.ctrlPtOffsetPct*e,p={topLeft:[s,l+f,s+v,l,s+h,l],topRight:[u-h,l,u-v,l,u,l+f],bottomRight:[u,c-f,u-v,c,u-h,c],bottomLeft:[s+h,c,s+v,c,s,c-f]};return p.topLeft.isTop=!0,p.topRight.isTop=!0,p.bottomLeft.isBottom=!0,p.bottomRight.isBottom=!0,p},checkPoint:function(e,t,n,i,a,o,s,u){var l=au(i,a),c=l.heightOffset,d=l.widthOffset;if(fn(e,t,this.points,o,s,i,a-2*c,[0,-1],n)||fn(e,t,this.points,o,s,i-2*d,a,[0,-1],n))return!0;for(var f=this.generateBarrelBezierPts(i,a,o,s),h=function(L,O,I){var B=I[4],w=I[2],T=I[0],E=I[5],b=I[1],C=Math.min(B,T),_=Math.max(B,T),M=Math.min(E,b),A=Math.max(E,b);if(C<=L&&L<=_&&M<=O&&O<=A){var F=O0(B,w,T),N=_0(F[0],F[1],F[2],L),z=N.filter(function(Y){return 0<=Y&&Y<=1});if(z.length>0)return z[0]}return null},v=Object.keys(f),p=0;p<v.length;p++){var m=v[p],g=f[m],y=h(e,t,g);if(y!=null){var x=g[5],S=g[3],D=g[1],P=Wt(x,S,D,y);if(g.isTop&&P<=t||g.isBottom&&t<=P)return!0}}return!1}}};vn.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:cr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,u){var l=e-(n/2+s),c=t-(i/2+s),d=c,f=e+(n/2+s),h=Ln(a,o,e,t,l,c,f,d,!1);return h.length>0?h:rh(a,o,e,t,n,i,s,u)},checkPoint:function(e,t,n,i,a,o,s,u){u=u==="auto"?oi(i,a):u;var l=2*u;if(fn(e,t,this.points,o,s,i,a-l,[0,-1],n)||fn(e,t,this.points,o,s,i-l,a,[0,-1],n))return!0;var c=i/2+2*n,d=a/2+2*n,f=[o-c,s-d,o-c,s,o+c,s,o+c,s-d];return!!(wr(e,t,f)||ni(e,t,l,l,o+i/2-u,s+a/2-u,n)||ni(e,t,l,l,o-i/2+u,s+a/2-u,n))}}};vn.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",cr(3,0)),this.generateRoundPolygon("round-triangle",cr(3,0)),this.generatePolygon("rectangle",cr(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",cr(5,0)),this.generateRoundPolygon("round-pentagon",cr(5,0)),this.generatePolygon("hexagon",cr(6,0)),this.generateRoundPolygon("round-hexagon",cr(6,0)),this.generatePolygon("heptagon",cr(7,0)),this.generateRoundPolygon("round-heptagon",cr(7,0)),this.generatePolygon("octagon",cr(8,0)),this.generateRoundPolygon("round-octagon",cr(8,0));var n=new Array(20);{var i=iu(5,0),a=iu(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<a.length/2;s++)a[s*2]*=o,a[s*2+1]*=o;for(var s=0;s<20/4;s++)n[s*4]=i[s*2],n[s*4+1]=i[s*2+1],n[s*4+2]=a[s*2],n[s*4+3]=a[s*2+1]}n=nh(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u),this.generateRoundPolygon("round-tag",u)}r.makePolygon=function(l){var c=l.join("$"),d="polygon-"+c,f;return(f=this[d])?f:e.generatePolygon(d,l)}};var Za={};Za.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};Za.redraw=function(r){r=r||Zf();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};Za.beforeRender=function(r,e){if(!this.destroyed){e==null&&Tt("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(n,i){return i.priority-n.priority})}};var mf=function(e,t,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(t,n)};Za.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function n(i){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){mf(r,!0,i);var a=dn();r.render(r.renderOptions);var o=r.lastDrawTime=dn();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-a),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var s=o-a;r.redrawTotalTime+=s,r.lastRedrawTime=s,r.averageRedrawTime=r.averageRedrawTime/2+s/2,r.requestedFrame=!1}else mf(r,!1,i);r.skipFrame=!1,Fs(n)}};Fs(t)}};var hb=function(e){this.init(e)},rv=hb,na=rv.prototype;na.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];na.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,o="__________cytoscape_stylesheet",s="__________cytoscape_container",u=i.getElementById(o)!=null;if(t.className.indexOf(s)<0&&(t.className=(t.className||"")+" "+s),!u){var l=i.createElement("style");l.id=o,l.textContent="."+s+" { position: relative; }",a.insertBefore(l,a.children[0])}var c=n.getComputedStyle(t),d=c.getPropertyValue("position");d==="static"&&ft("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Ne(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};na.notify=function(r,e){var t=this,n=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&n.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),r==="gc"&&t.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};na.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],n=t,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};na.isHeadless=function(){return!1};[Vu,ev,tv,ra,vn,Za].forEach(function(r){Ye(na,r)});var Zl=1e3/60,nv={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=Wa(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),o=function(l,c){var d=dn(),f=i.averageRedrawTime,h=i.lastRedrawTime,v=[],p=i.cy.extent(),m=i.getPixelRatio();for(l||i.flushRenderedStyleQueue();;){var g=dn(),y=g-d,x=g-c;if(h<Zl){var S=Zl-(l?f:0);if(x>=e.deqFastCost*S)break}else if(l){if(y>=e.deqCost*h||y>=e.deqAvgCost*f)break}else if(x>=e.deqNoDrawCost*Zl)break;var D=e.deq(n,m,p);if(D.length>0)for(var P=0;P<D.length;P++)v.push(D[P]);else break}v.length>0&&(e.onDeqd(n,v),!l&&e.shouldRedraw(n,v,m,p)&&a())},s=e.priority||Tu;i.beforeRender(o,s(n))}}}},vb=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bs;jn(this,r),this.idsByKey=new en,this.keyForId=new en,this.cachesByLvl=new en,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return Hn(r,[{key:"getIdsFor",value:function(t){t==null&&Tt("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(t);return i||(i=new qi,n.set(t,i)),i}},{key:"addIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).add(n)}},{key:"deleteIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).delete(n)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);return i!==a}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var n=this.cachesByLvl,i=this.lvls,a=n.get(t);return a||(a=new en,n.set(t,a),i.push(t)),a}},{key:"getCache",value:function(t,n){return this.getCachesAt(n).get(t)}},{key:"get",value:function(t,n){var i=this.getKey(t),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(t),a}},{key:"getForCachedKey",value:function(t,n){var i=this.keyForId.get(t.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(t,n){return this.getCachesAt(n).has(t)}},{key:"has",value:function(t,n){var i=this.getKey(t);return this.hasCache(i,n)}},{key:"setCache",value:function(t,n,i){i.key=t,this.getCachesAt(n).set(t,i)}},{key:"set",value:function(t,n,i){var a=this.getKey(t);this.setCache(a,n,i),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,n){this.getCachesAt(n).delete(t)}},{key:"delete",value:function(t,n){var i=this.getKey(t);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(t){var n=this;this.lvls.forEach(function(i){return n.deleteCache(t,i)})}},{key:"invalidate",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(t);var a=this.doesEleInvalidateKey(t);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}]),r}(),yf=25,Ts=50,Ns=-4,gu=3,iv=7.99,pb=8,gb=1024,mb=1024,yb=1024,Cb=.2,wb=.8,bb=10,xb=.15,Eb=.1,Tb=.9,_b=.9,Sb=100,Mb=1,zi={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Db=Yt({getKey:null,doesEleInvalidateKey:Bs,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Xf,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Ma=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var i=Db(t);Ye(n,i),n.lookup=new vb(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},zt=Ma.prototype;zt.reasons=zi;zt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};zt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=t[r]=t[r]||[];return n};zt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new Ya(function(t,n){return n.reqs-t.reqs});return e};zt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};zt.getElement=function(r,e,t,n,i){var a=this,o=this.renderer,s=o.cy.zoom(),u=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!a.allowEdgeTxrCaching&&r.isEdge()||!a.allowParentTxrCaching&&r.isParent())return null;if(n==null&&(n=Math.ceil(Su(s*t))),n<Ns)n=Ns;else if(s>=iv||n>gu)return null;var l=Math.pow(2,n),c=e.h*l,d=e.w*l,f=o.eleTextBiggerThanMin(r,l);if(!this.isVisible(r,f))return null;var h=u.get(r,n);if(h&&h.invalidated&&(h.invalidated=!1,h.texture.invalidatedWidth-=h.width),h)return h;var v;if(c<=yf?v=yf:c<=Ts?v=Ts:v=Math.ceil(c/Ts)*Ts,c>yb||d>mb)return null;var p=a.getTextureQueue(v),m=p[p.length-2],g=function(){return a.recycleTexture(v,d)||a.addTexture(v,d)};m||(m=p[p.length-1]),m||(m=g()),m.width-m.usedWidth<d&&(m=g());for(var y=function(C){return C&&C.scaledLabelShown===f},x=i&&i===zi.dequeue,S=i&&i===zi.highQuality,D=i&&i===zi.downscale,P,R=n+1;R<=gu;R++){var L=u.get(r,R);if(L){P=L;break}}var O=P&&P.level===n+1?P:null,I=function(){m.context.drawImage(O.texture.canvas,O.x,0,O.width,O.height,m.usedWidth,0,d,c)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,d,v),y(O))I();else if(y(P))if(S){for(var B=P.level;B>n;B--)O=a.getElement(r,e,t,B,zi.downscale);I()}else return a.queueElement(r,P.level-1),P;else{var w;if(!x&&!S&&!D)for(var T=n-1;T>=Ns;T--){var E=u.get(r,T);if(E){w=E;break}}if(y(w))return a.queueElement(r,n),w;m.context.translate(m.usedWidth,0),m.context.scale(l,l),this.drawElement(m.context,r,e,f,!1),m.context.scale(1/l,1/l),m.context.translate(-m.usedWidth,0)}return h={x:m.usedWidth,texture:m,level:n,scale:l,width:d,height:c,scaledLabelShown:f},m.usedWidth+=Math.ceil(d+pb),m.eleCaches.push(h),u.set(r,n,h),a.checkTextureFullness(m),h};zt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};zt.invalidateElement=function(r){var e=this,t=e.lookup,n=[],i=t.isInvalid(r);if(i){for(var a=Ns;a<=gu;a++){var o=t.getForCachedKey(r,a);o&&n.push(o)}var s=t.invalidate(r);if(s)for(var u=0;u<n.length;u++){var l=n[u],c=l.texture;c.invalidatedWidth+=l.width,l.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(r)}};zt.checkTextureUtility=function(r){r.invalidatedWidth>=Cb*r.width&&this.retireTexture(r)};zt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>wb&&r.fullnessChecks>=bb?Bn(t,r):r.fullnessChecks++};zt.retireTexture=function(r){var e=this,t=r.height,n=e.getTextureQueue(t),i=this.lookup;Bn(n,r),r.retired=!0;for(var a=r.eleCaches,o=0;o<a.length;o++){var s=a[o];i.deleteCache(s.key,s.level)}_u(a);var u=e.getRetiredTextureQueue(t);u.push(r)};zt.addTexture=function(r,e){var t=this,n=t.getTextureQueue(r),i={};return n.push(i),i.eleCaches=[],i.height=r,i.width=Math.max(gb,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=t.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};zt.recycleTexture=function(r,e){for(var t=this,n=t.getTextureQueue(r),i=t.getRetiredTextureQueue(r),a=0;a<i.length;a++){var o=i[a];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,_u(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),Bn(i,o),n.push(o),o}};zt.queueElement=function(r,e){var t=this,n=t.getElementQueue(),i=t.getElementKeyToQueue(),a=this.getKey(r),o=i[a];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,n.updateItem(o);else{var s={eles:r.spawn().merge(r),level:e,reqs:1,key:a};n.push(s),i[a]=s}};zt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,o=0;o<Mb&&t.size()>0;o++){var s=t.pop(),u=s.key,l=s.eles[0],c=a.hasCache(l,s.level);if(n[u]=null,c)continue;i.push(s);var d=e.getBoundingBox(l);e.getElement(l,d,r,s.level,zi.dequeue)}return i};zt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(r),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=Eu,t.updateItem(a),t.pop(),n[i]=null):a.eles.unmerge(r))};zt.onDequeue=function(r){this.onDequeues.push(r)};zt.offDequeue=function(r){Bn(this.onDequeues,r)};zt.setupDequeueing=nv.setupDequeueing({deqRedrawThreshold:Sb,deqCost:xb,deqAvgCost:Eb,deqNoDrawCost:Tb,deqFastCost:_b,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(t)}},shouldRedraw:function(e,t,n,i){for(var a=0;a<t.length;a++)for(var o=t[a].eles,s=0;s<o.length;s++){var u=o[s].boundingBox();if(Mu(u,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Ab=1,Aa=-4,Ws=2,Pb=3.99,Rb=50,Ob=50,Lb=.15,Ib=.1,Nb=.9,kb=.9,Fb=1,Cf=250,Bb=4e3*4e3,wf=32767,Vb=!0,av=function(e){var t=this,n=t.renderer=e,i=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=dn()-2*Cf,t.skipping=!1,t.eleTxrDeqs=i.collection(),t.scheduleElementRefinement=Wa(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},Ob),n.beforeRender(function(o,s){s-t.lastInvalidationTime<=Cf?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(s,u){return u.reqs-s.reqs};t.layersQueue=new Ya(a),t.setupDequeueing()},Zt=av.prototype,bf=0,zb=Math.pow(2,53)-1;Zt.makeLayer=function(r,e){var t=Math.pow(2,e),n=Math.ceil(r.w*t),i=Math.ceil(r.h*t),a=this.renderer.makeOffscreenCanvas(n,i),o={id:bf=++bf%zb,bb:r,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,u=-o.bb.x1,l=-o.bb.y1;return s.scale(t,t),s.translate(u,l),o};Zt.getLayers=function(r,e,t){var n=this,i=n.renderer,a=i.cy,o=a.zoom(),s=n.firstGet;if(n.firstGet=!1,t==null){if(t=Math.ceil(Su(o*e)),t<Aa)t=Aa;else if(o>=Pb||t>Ws)return null}n.validateLayersElesOrdering(t,r);var u=n.layersByLevel,l=Math.pow(2,t),c=u[t]=u[t]||[],d,f=n.levelIsComplete(t,r),h,v=function(){var I=function(b){if(n.validateLayersElesOrdering(b,r),n.levelIsComplete(b,r))return h=u[b],!0},B=function(b){if(!h)for(var C=t+b;Aa<=C&&C<=Ws&&!I(C);C+=b);};B(1),B(-1);for(var w=c.length-1;w>=0;w--){var T=c[w];T.invalid&&Bn(c,T)}};if(!f)v();else return c;var p=function(){if(!d){d=br();for(var I=0;I<r.length;I++)eh(d,r[I].boundingBox())}return d},m=function(I){I=I||{};var B=I.after;p();var w=Math.ceil(d.w*l),T=Math.ceil(d.h*l);if(w>wf||T>wf)return null;var E=w*T;if(E>Bb)return null;var b=n.makeLayer(d,t);if(B!=null){var C=c.indexOf(B)+1;c.splice(C,0,b)}else(I.insert===void 0||I.insert)&&c.unshift(b);return b};if(n.skipping&&!s)return null;for(var g=null,y=r.length/Ab,x=!s,S=0;S<r.length;S++){var D=r[S],P=D._private.rscratch,R=P.imgLayerCaches=P.imgLayerCaches||{},L=R[t];if(L){g=L;continue}if((!g||g.eles.length>=y||!th(g.bb,D.boundingBox()))&&(g=m({insert:!0,after:g}),!g))return null;h||x?n.queueLayer(g,D):n.drawEleInLayer(g,D,t,e),g.eles.push(D),R[t]=g}return h||(x?null:c)};Zt.getEleLevelForLayerLevel=function(r,e){return r};Zt.drawEleInLayer=function(r,e,t,n){var i=this,a=this.renderer,o=r.context,s=e.boundingBox();s.w===0||s.h===0||!e.visible()||(t=i.getEleLevelForLayerLevel(t,n),a.setImgSmoothing(o,!1),a.drawCachedElement(o,e,null,null,t,Vb),a.setImgSmoothing(o,!0))};Zt.levelIsComplete=function(r,e){var t=this,n=t.layersByLevel[r];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var o=n[a];if(o.reqs>0||o.invalid)return!1;i+=o.eles.length}return i===e.length};Zt.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(t)for(var n=0;n<t.length;n++){for(var i=t[n],a=-1,o=0;o<e.length;o++)if(i.eles[0]===e[o]){a=o;break}if(a<0){this.invalidateLayer(i);continue}for(var s=a,o=0;o<i.eles.length;o++)if(i.eles[o]!==e[s+o]){this.invalidateLayer(i);break}}};Zt.updateElementsInLayers=function(r,e){for(var t=this,n=Ua(r[0]),i=0;i<r.length;i++)for(var a=n?null:r[i],o=n?r[i]:r[i].ele,s=o._private.rscratch,u=s.imgLayerCaches=s.imgLayerCaches||{},l=Aa;l<=Ws;l++){var c=u[l];c&&(a&&t.getEleLevelForLayerLevel(c.level)!==a.level||e(c,o,a))}};Zt.haveLayers=function(){for(var r=this,e=!1,t=Aa;t<=Ws;t++){var n=r.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e};Zt.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=dn(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(n,i,a){e.invalidateLayer(n)}))};Zt.invalidateLayer=function(r){if(this.lastInvalidationTime=dn(),!r.invalid){var e=r.level,t=r.eles,n=this.layersByLevel[e];Bn(n,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var i=0;i<t.length;i++){var a=t[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};Zt.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(n,i,a){var o=n.replacement;if(o||(o=n.replacement=e.makeLayer(n.bb,n.level),o.replaces=n,o.eles=n.eles),!o.reqs)for(var s=0;s<o.eles.length;s++)e.queueLayer(o,o.eles[s])})};Zt.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};Zt.queueLayer=function(r,e){var t=this,n=t.layersQueue,i=r.elesQueue,a=i.hasId=i.hasId||{};if(!r.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}r.reqs?(r.reqs++,n.updateItem(r)):(r.reqs=1,n.push(r))}};Zt.dequeue=function(r){for(var e=this,t=e.layersQueue,n=[],i=0;i<Fb&&t.size()!==0;){var a=t.peek();if(a.replacement){t.pop();continue}if(a.replaces&&a!==a.replaces.replacement){t.pop();continue}if(a.invalid){t.pop();continue}var o=a.elesQueue.shift();o&&(e.drawEleInLayer(a,o,a.level,r),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(t.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};Zt.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],n=r.replaces,i=t.indexOf(n);if(!(i<0||n.invalid)){t[i]=r;for(var a=0;a<r.eles.length;a++){var o=r.eles[a]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[r.level]=r)}e.requestRedraw()}};Zt.requestRedraw=Wa(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);Zt.setupDequeueing=nv.setupDequeueing({deqRedrawThreshold:Rb,deqCost:Lb,deqAvgCost:Ib,deqNoDrawCost:Nb,deqFastCost:kb,deq:function(e,t){return e.dequeue(t)},onDeqd:Tu,shouldRedraw:Xf,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var ov={},xf;function Gb(r,e){for(var t=0;t<e.length;t++){var n=e[t];r.lineTo(n.x,n.y)}}function jb(r,e,t){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),r.lineTo(a.x,a.y)}r.quadraticCurveTo(t.x,t.y,n.x,n.y)}function Ef(r,e,t){r.beginPath&&r.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];r.lineTo(a.x,a.y)}var o=t,s=t[0];r.moveTo(s.x,s.y);for(var i=1;i<o.length;i++){var a=o[i];r.lineTo(a.x,a.y)}r.closePath&&r.closePath()}function Hb(r,e,t,n,i){r.beginPath&&r.beginPath(),r.arc(t,n,i,0,Math.PI*2,!1);var a=e,o=a[0];r.moveTo(o.x,o.y);for(var s=0;s<a.length;s++){var u=a[s];r.lineTo(u.x,u.y)}r.closePath&&r.closePath()}function Ub(r,e,t,n){r.arc(e,t,n,0,Math.PI*2,!1)}ov.arrowShapeImpl=function(r){return(xf||(xf={polygon:Gb,"triangle-backcurve":jb,"triangle-tee":Ef,"circle-triangle":Hb,"triangle-cross":Ef,circle:Ub}))[r]};var nn={};nn.drawElement=function(r,e,t,n,i,a){var o=this;e.isNode()?o.drawNode(r,e,t,n,i,a):o.drawEdge(r,e,t,n,i,a)};nn.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};nn.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};nn.drawCachedElementPortion=function(r,e,t,n,i,a,o,s){var u=this,l=t.getBoundingBox(e);if(!(l.w===0||l.h===0)){var c=t.getElement(e,l,n,i,a);if(c!=null){var d=s(u,e);if(d===0)return;var f=o(u,e),h=l.x1,v=l.y1,p=l.w,m=l.h,g,y,x,S,D;if(f!==0){var P=t.getRotationPoint(e);x=P.x,S=P.y,r.translate(x,S),r.rotate(f),D=u.getImgSmoothing(r),D||u.setImgSmoothing(r,!0);var R=t.getRotationOffset(e);g=R.x,y=R.y}else g=h,y=v;var L;d!==1&&(L=r.globalAlpha,r.globalAlpha=L*d),r.drawImage(c.texture.canvas,c.x,0,c.width,c.height,g,y,p,m),d!==1&&(r.globalAlpha=L),f!==0&&(r.rotate(-f),r.translate(-x,-S),D||u.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var $b=function(){return 0},Wb=function(e,t){return e.getTextAngle(t,null)},Yb=function(e,t){return e.getTextAngle(t,"source")},Xb=function(e,t){return e.getTextAngle(t,"target")},qb=function(e,t){return t.effectiveOpacity()},Ql=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};nn.drawCachedElement=function(r,e,t,n,i,a){var o=this,s=o.data,u=s.eleTxrCache,l=s.lblTxrCache,c=s.slbTxrCache,d=s.tlbTxrCache,f=e.boundingBox(),h=a===!0?u.reasons.highQuality:null;if(!(f.w===0||f.h===0||!e.visible())&&(!n||Mu(f,n))){var v=e.isEdge(),p=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,u,t,i,h,$b,qb),(!v||!p)&&o.drawCachedElementPortion(r,e,l,t,i,h,Wb,Ql),v&&!p&&(o.drawCachedElementPortion(r,e,c,t,i,h,Yb,Ql),o.drawCachedElementPortion(r,e,d,t,i,h,Xb,Ql)),o.drawElementOverlay(r,e)}};nn.drawElements=function(r,e){for(var t=this,n=0;n<e.length;n++){var i=e[n];t.drawElement(r,i)}};nn.drawCachedElements=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];i.drawCachedElement(r,o,t,n)}};nn.drawCachedNodes=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];o.isNode()&&i.drawCachedElement(r,o,t,n)}};nn.drawLayeredElements=function(r,e,t,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,t);if(a)for(var o=0;o<a.length;o++){var s=a[o],u=s.bb;u.w===0||u.h===0||r.drawImage(s.canvas,u.x1,u.y1,u.w,u.h)}else i.drawCachedElements(r,e,t,n)};var pn={};pn.drawEdge=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s=e._private.rscratch;if(!(a&&!e.visible())&&!(s.badLine||s.allpts==null||isNaN(s.allpts[0]))){var u;t&&(u=t,r.translate(-u.x1,-u.y1));var l=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,f=e.pstyle("line-style").value,h=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,p=e.pstyle("line-outline-width").value,m=e.pstyle("line-outline-color").value,g=l*c,y=l*c,x=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;d==="straight-triangle"?(o.eleStrokeStyle(r,e,b),o.drawEdgeTrianglePath(e,r,s.allpts)):(r.lineWidth=h,r.lineCap=v,o.eleStrokeStyle(r,e,b),o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},S=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;if(r.lineWidth=h+p,r.lineCap=v,p>0)o.colorStrokeStyle(r,m[0],m[1],m[2],b);else{r.lineCap="butt";return}d==="straight-triangle"?o.drawEdgeTrianglePath(e,r,s.allpts):(o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},D=function(){i&&o.drawEdgeOverlay(r,e)},P=function(){i&&o.drawEdgeUnderlay(r,e)},R=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;o.drawArrowheads(r,e,b)},L=function(){o.drawElementText(r,e,null,n)};r.lineJoin="round";var O=e.pstyle("ghost").value==="yes";if(O){var I=e.pstyle("ghost-offset-x").pfValue,B=e.pstyle("ghost-offset-y").pfValue,w=e.pstyle("ghost-opacity").value,T=g*w;r.translate(I,B),x(T),R(T),r.translate(-I,-B)}else S();P(),x(),R(),D(),L(),t&&r.translate(u.x1,u.y1)}};var sv=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,o=a.usePaths(),s=n._private.rscratch,u=n.pstyle("".concat(e,"-padding")).pfValue,l=2*u,c=n.pstyle("".concat(e,"-color")).value;t.lineWidth=l,s.edgeType==="self"&&!o?t.lineCap="butt":t.lineCap="round",a.colorStrokeStyle(t,c[0],c[1],c[2],i),a.drawEdgePath(n,t,s.allpts,"solid")}}}};pn.drawEdgeOverlay=sv("overlay");pn.drawEdgeUnderlay=sv("underlay");pn.drawEdgePath=function(r,e,t,n){var i=r._private.rscratch,a=e,o,s=!1,u=this.usePaths(),l=r.pstyle("line-dash-pattern").pfValue,c=r.pstyle("line-dash-offset").pfValue;if(u){var d=t.join("$"),f=i.pathCacheKey&&i.pathCacheKey===d;f?(o=e=i.pathCache,s=!0):(o=e=new Path2D,i.pathCacheKey=d,i.pathCache=o)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(l),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!s&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var h=2;h+3<t.length;h+=4)e.quadraticCurveTo(t[h],t[h+1],t[h+2],t[h+3]);break;case"straight":case"haystack":for(var v=2;v+1<t.length;v+=2)e.lineTo(t[v],t[v+1]);break;case"segments":if(i.isRound){var p=Sr(i.roundCorners),m;try{for(p.s();!(m=p.n()).done;){var g=m.value;qh(e,g)}}catch(x){p.e(x)}finally{p.f()}e.lineTo(t[t.length-2],t[t.length-1])}else for(var y=2;y+1<t.length;y+=2)e.lineTo(t[y],t[y+1]);break}e=a,u?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};pn.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var n=r.pstyle("width").pfValue,i=0;i+1<t.length;i+=2){var a=[t[i+2]-t[i],t[i+3]-t[i+1]],o=Math.sqrt(a[0]*a[0]+a[1]*a[1]),s=[a[1]/o,-a[0]/o],u=[s[0]*n/2,s[1]*n/2];e.beginPath(),e.moveTo(t[i]-u[0],t[i+1]-u[1]),e.lineTo(t[i]+u[0],t[i+1]+u[1]),e.lineTo(t[i+2],t[i+3]),e.closePath(),e.fill()}};pn.drawArrowheads=function(r,e,t){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(r,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,t),i||this.drawArrowhead(r,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,t)};pn.drawArrowhead=function(r,e,t,n,i,a,o){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var s=this,u=e.pstyle(t+"-arrow-shape").value;if(u!=="none"){var l=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(t+"-arrow-fill").value,d=e.pstyle("width").pfValue,f=e.pstyle(t+"-arrow-width"),h=f.value==="match-line"?d:f.pfValue;f.units==="%"&&(h*=d);var v=e.pstyle("opacity").value;o===void 0&&(o=v);var p=r.globalCompositeOperation;(o!==1||c==="hollow")&&(r.globalCompositeOperation="destination-out",s.colorFillStyle(r,255,255,255,1),s.colorStrokeStyle(r,255,255,255,1),s.drawArrowShape(e,r,l,d,u,h,n,i,a),r.globalCompositeOperation=p);var m=e.pstyle(t+"-arrow-color").value;s.colorFillStyle(r,m[0],m[1],m[2],o),s.colorStrokeStyle(r,m[0],m[1],m[2],o),s.drawArrowShape(e,r,c,d,u,h,n,i,a)}}};pn.drawArrowShape=function(r,e,t,n,i,a,o,s,u){var l=this,c=this.usePaths()&&i!=="triangle-cross",d=!1,f,h=e,v={x:o,y:s},p=r.pstyle("arrow-scale").value,m=this.getArrowWidth(n,p),g=l.arrowShapes[i];if(c){var y=l.arrowPathCache=l.arrowPathCache||[],x=Fn(i),S=y[x];S!=null?(f=e=S,d=!0):(f=e=new Path2D,y[x]=f)}d||(e.beginPath&&e.beginPath(),c?g.draw(e,1,0,{x:0,y:0},1):g.draw(e,m,u,v,n),e.closePath&&e.closePath()),e=h,c&&(e.translate(o,s),e.rotate(u),e.scale(m,m)),(t==="filled"||t==="both")&&(c?e.fill(f):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=a/(c?m:1),e.lineJoin="miter",c?e.stroke(f):e.stroke()),c&&(e.scale(1/m,1/m),e.rotate(-u),e.translate(-o,-s))};var ju={};ju.safeDrawImage=function(r,e,t,n,i,a,o,s,u,l){if(!(i<=0||a<=0||u<=0||l<=0))try{r.drawImage(e,t,n,i,a,o,s,u,l)}catch(c){ft(c)}};ju.drawInscribedImage=function(r,e,t,n,i){var a=this,o=t.position(),s=o.x,u=o.y,l=t.cy().style(),c=l.getIndexedStyle.bind(l),d=c(t,"background-fit","value",n),f=c(t,"background-repeat","value",n),h=t.width(),v=t.height(),p=t.padding()*2,m=h+(c(t,"background-width-relative-to","value",n)==="inner"?0:p),g=v+(c(t,"background-height-relative-to","value",n)==="inner"?0:p),y=t._private.rscratch,x=c(t,"background-clip","value",n),S=x==="node",D=c(t,"background-image-opacity","value",n)*i,P=c(t,"background-image-smoothing","value",n),R=t.pstyle("corner-radius").value;R!=="auto"&&(R=t.pstyle("corner-radius").pfValue);var L=e.width||e.cachedW,O=e.height||e.cachedH;(L==null||O==null)&&(document.body.appendChild(e),L=e.cachedW=e.width||e.offsetWidth,O=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var I=L,B=O;if(c(t,"background-width","value",n)!=="auto"&&(c(t,"background-width","units",n)==="%"?I=c(t,"background-width","pfValue",n)*m:I=c(t,"background-width","pfValue",n)),c(t,"background-height","value",n)!=="auto"&&(c(t,"background-height","units",n)==="%"?B=c(t,"background-height","pfValue",n)*g:B=c(t,"background-height","pfValue",n)),!(I===0||B===0)){if(d==="contain"){var w=Math.min(m/I,g/B);I*=w,B*=w}else if(d==="cover"){var w=Math.max(m/I,g/B);I*=w,B*=w}var T=s-m/2,E=c(t,"background-position-x","units",n),b=c(t,"background-position-x","pfValue",n);E==="%"?T+=(m-I)*b:T+=b;var C=c(t,"background-offset-x","units",n),_=c(t,"background-offset-x","pfValue",n);C==="%"?T+=(m-I)*_:T+=_;var M=u-g/2,A=c(t,"background-position-y","units",n),F=c(t,"background-position-y","pfValue",n);A==="%"?M+=(g-B)*F:M+=F;var N=c(t,"background-offset-y","units",n),z=c(t,"background-offset-y","pfValue",n);N==="%"?M+=(g-B)*z:M+=z,y.pathCache&&(T-=s,M-=u,s=0,u=0);var Y=r.globalAlpha;r.globalAlpha=D;var U=a.getImgSmoothing(r),ee=!1;if(P==="no"&&U?(a.setImgSmoothing(r,!1),ee=!0):P==="yes"&&!U&&(a.setImgSmoothing(r,!0),ee=!0),f==="no-repeat")S&&(r.save(),y.pathCache?r.clip(y.pathCache):(a.nodeShapes[a.getNodeShape(t)].draw(r,s,u,m,g,R,y),r.clip())),a.safeDrawImage(r,e,0,0,L,O,T,M,I,B),S&&r.restore();else{var Q=r.createPattern(e,f);r.fillStyle=Q,a.nodeShapes[a.getNodeShape(t)].draw(r,s,u,m,g,R,y),r.translate(T,M),r.fill(),r.translate(-T,-M)}r.globalAlpha=Y,ee&&a.setImgSmoothing(r,U)}};var di={};di.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(Su(t*n));e=Math.pow(2,i)}var a=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(a<o)};di.drawElementText=function(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(n==null){if(a&&!o.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var s=e.pstyle("label");if(!s||!s.value)return;var u=o.getLabelJustification(e);r.textAlign=u,r.textBaseline="bottom"}else{var l=e.element()._private.rscratch.badLine,c=e.pstyle("label"),d=e.pstyle("source-label"),f=e.pstyle("target-label");if(l||(!c||!c.value)&&(!d||!d.value)&&(!f||!f.value))return;r.textAlign="center",r.textBaseline="bottom"}var h=!t,v;t&&(v=t,r.translate(-v.x1,-v.y1)),i==null?(o.drawText(r,e,null,h,a),e.isEdge()&&(o.drawText(r,e,"source",h,a),o.drawText(r,e,"target",h,a))):o.drawText(r,e,i,h,a),t&&r.translate(v.x1,v.y1)};di.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};di.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,u=e.pstyle("text-outline-opacity").value*s,l=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;r.font=n+" "+o+" "+i+" "+a,r.lineJoin="round",this.colorFillStyle(r,l[0],l[1],l[2],s),this.colorStrokeStyle(r,c[0],c[1],c[2],u)};function Jl(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0;r.beginPath(),r.moveTo(e+a,t),r.lineTo(e+n-a,t),r.quadraticCurveTo(e+n,t,e+n,t+a),r.lineTo(e+n,t+i-a),r.quadraticCurveTo(e+n,t+i,e+n-a,t+i),r.lineTo(e+a,t+i),r.quadraticCurveTo(e,t+i,e,t+i-a),r.lineTo(e,t+a),r.quadraticCurveTo(e,t,e+a,t),r.closePath(),o?r.stroke():r.fill()}di.getTextAngle=function(r,e){var t,n=r._private,i=n.rscratch,a=e?e+"-":"",o=r.pstyle(a+"text-rotation");if(o.strValue==="autorotate"){var s=zr(i,"labelAngle",e);t=r.isEdge()?s:0}else o.strValue==="none"?t=0:t=o.pfValue;return t};di.drawText=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,o=a.rscratch,s=i?e.effectiveOpacity():1;if(!(i&&(s===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var u=zr(o,"labelX",t),l=zr(o,"labelY",t),c,d,f=this.getLabelText(e,t);if(f!=null&&f!==""&&!isNaN(u)&&!isNaN(l)){this.setupTextStyle(r,e,i);var h=t?t+"-":"",v=zr(o,"labelWidth",t),p=zr(o,"labelHeight",t),m=e.pstyle(h+"text-margin-x").pfValue,g=e.pstyle(h+"text-margin-y").pfValue,y=e.isEdge(),x=e.pstyle("text-halign").value,S=e.pstyle("text-valign").value;y&&(x="center",S="center"),u+=m,l+=g;var D;switch(n?D=this.getTextAngle(e,t):D=0,D!==0&&(c=u,d=l,r.translate(c,d),r.rotate(D),u=0,l=0),S){case"top":break;case"center":l+=p/2;break;case"bottom":l+=p;break}var P=e.pstyle("text-background-opacity").value,R=e.pstyle("text-border-opacity").value,L=e.pstyle("text-border-width").pfValue,O=e.pstyle("text-background-padding").pfValue,I=e.pstyle("text-background-shape").strValue,B=I.indexOf("round")===0,w=2;if(P>0||L>0&&R>0){var T=u-O;switch(x){case"left":T-=v;break;case"center":T-=v/2;break}var E=l-p-O,b=v+2*O,C=p+2*O;if(P>0){var _=r.fillStyle,M=e.pstyle("text-background-color").value;r.fillStyle="rgba("+M[0]+","+M[1]+","+M[2]+","+P*s+")",B?Jl(r,T,E,b,C,w):r.fillRect(T,E,b,C),r.fillStyle=_}if(L>0&&R>0){var A=r.strokeStyle,F=r.lineWidth,N=e.pstyle("text-border-color").value,z=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+N[0]+","+N[1]+","+N[2]+","+R*s+")",r.lineWidth=L,r.setLineDash)switch(z){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=L/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(B?Jl(r,T,E,b,C,w,"stroke"):r.strokeRect(T,E,b,C),z==="double"){var Y=L/2;B?Jl(r,T+Y,E+Y,b-Y*2,C-Y*2,w,"stroke"):r.strokeRect(T+Y,E+Y,b-Y*2,C-Y*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=F,r.strokeStyle=A}}var U=2*e.pstyle("text-outline-width").pfValue;if(U>0&&(r.lineWidth=U),e.pstyle("text-wrap").value==="wrap"){var ee=zr(o,"labelWrapCachedLines",t),Q=zr(o,"labelLineHeight",t),j=v/2,K=this.getLabelJustification(e);switch(K==="auto"||(x==="left"?K==="left"?u+=-v:K==="center"&&(u+=-j):x==="center"?K==="left"?u+=-j:K==="right"&&(u+=j):x==="right"&&(K==="center"?u+=j:K==="right"&&(u+=v))),S){case"top":l-=(ee.length-1)*Q;break;case"center":case"bottom":l-=(ee.length-1)*Q;break}for(var H=0;H<ee.length;H++)U>0&&r.strokeText(ee[H],u,l),r.fillText(ee[H],u,l),l+=Q}else U>0&&r.strokeText(f,u,l),r.fillText(f,u,l);D!==0&&(r.rotate(-D),r.translate(-c,-d))}}};var ia={};ia.drawNode=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s,u,l=e._private,c=l.rscratch,d=e.position();if(!(!Ne(d.x)||!Ne(d.y))&&!(a&&!e.visible())){var f=a?e.effectiveOpacity():1,h=o.usePaths(),v,p=!1,m=e.padding();s=e.width()+2*m,u=e.height()+2*m;var g;t&&(g=t,r.translate(-g.x1,-g.y1));for(var y=e.pstyle("background-image"),x=y.value,S=new Array(x.length),D=new Array(x.length),P=0,R=0;R<x.length;R++){var L=x[R],O=S[R]=L!=null&&L!=="none";if(O){var I=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",R);P++,D[R]=o.getCachedImage(L,I,function(){l.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var B=e.pstyle("background-blacken").value,w=e.pstyle("border-width").pfValue,T=e.pstyle("background-opacity").value*f,E=e.pstyle("border-color").value,b=e.pstyle("border-style").value,C=e.pstyle("border-join").value,_=e.pstyle("border-cap").value,M=e.pstyle("border-position").value,A=e.pstyle("border-dash-pattern").pfValue,F=e.pstyle("border-dash-offset").pfValue,N=e.pstyle("border-opacity").value*f,z=e.pstyle("outline-width").pfValue,Y=e.pstyle("outline-color").value,U=e.pstyle("outline-style").value,ee=e.pstyle("outline-opacity").value*f,Q=e.pstyle("outline-offset").value,j=e.pstyle("corner-radius").value;j!=="auto"&&(j=e.pstyle("corner-radius").pfValue);var K=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;o.eleFillStyle(r,e,W)},H=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;o.colorStrokeStyle(r,E[0],E[1],E[2],W)},k=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ee;o.colorStrokeStyle(r,Y[0],Y[1],Y[2],W)},G=function(W,Z,ie,ne){var oe=o.nodePathCache=o.nodePathCache||[],ve=Yf(ie==="polygon"?ie+","+ne.join(","):ie,""+Z,""+W,""+j),Re=oe[ve],we,pe=!1;return Re!=null?(we=Re,pe=!0,c.pathCache=we):(we=new Path2D,oe[ve]=c.pathCache=we),{path:we,cacheHit:pe}},$=e.pstyle("shape").strValue,te=e.pstyle("shape-polygon-points").pfValue;if(h){r.translate(d.x,d.y);var q=G(s,u,$,te);v=q.path,p=q.cacheHit}var ge=function(){if(!p){var W=d;h&&(W={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(v||r,W.x,W.y,s,u,j,c)}h?r.fill(v):r.fill()},Te=function(){for(var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ie=l.backgrounding,ne=0,oe=0;oe<D.length;oe++){var ve=e.cy().style().getIndexedStyle(e,"background-image-containment","value",oe);if(Z&&ve==="over"||!Z&&ve==="inside"){ne++;continue}S[oe]&&D[oe].complete&&!D[oe].error&&(ne++,o.drawInscribedImage(r,D[oe],e,oe,W))}l.backgrounding=ne!==P,ie!==l.backgrounding&&e.updateStyle(!1)},he=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;o.hasPie(e)&&(o.drawPie(r,e,Z),W&&(h||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,s,u,j,c)))},ue=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Z=(B>0?B:-B)*W,ie=B>0?0:255;B!==0&&(o.colorFillStyle(r,ie,ie,ie,Z),h?r.fill(v):r.fill())},de=function(){if(w>0){if(r.lineWidth=w,r.lineCap=_,r.lineJoin=C,r.setLineDash)switch(b){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(A),r.lineDashOffset=F;break;case"solid":case"double":r.setLineDash([]);break}if(M!=="center"){if(r.save(),r.lineWidth*=2,M==="inside")h?r.clip(v):r.clip();else{var W=new Path2D;W.rect(-s/2-w,-u/2-w,s+2*w,u+2*w),W.addPath(v),r.clip(W,"evenodd")}h?r.stroke(v):r.stroke(),r.restore()}else h?r.stroke(v):r.stroke();if(b==="double"){r.lineWidth=w/3;var Z=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",h?r.stroke(v):r.stroke(),r.globalCompositeOperation=Z}r.setLineDash&&r.setLineDash([])}},me=function(){if(z>0){if(r.lineWidth=z,r.lineCap="butt",r.setLineDash)switch(U){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var W=d;h&&(W={x:0,y:0});var Z=o.getNodeShape(e),ie=w;M==="inside"&&(ie=0),M==="outside"&&(ie*=2);var ne=(s+ie+(z+Q))/s,oe=(u+ie+(z+Q))/u,ve=s*ne,Re=u*oe,we=o.nodeShapes[Z].points,pe;if(h){var Se=G(ve,Re,Z,we);pe=Se.path}if(Z==="ellipse")o.drawEllipsePath(pe||r,W.x,W.y,ve,Re);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(Z)){var Me=0,Oe=0,Ve=0;Z==="round-diamond"?Me=(ie+Q+z)*1.4:Z==="round-heptagon"?(Me=(ie+Q+z)*1.075,Ve=-(ie/2+Q+z)/35):Z==="round-hexagon"?Me=(ie+Q+z)*1.12:Z==="round-pentagon"?(Me=(ie+Q+z)*1.13,Ve=-(ie/2+Q+z)/15):Z==="round-tag"?(Me=(ie+Q+z)*1.12,Oe=(ie/2+z+Q)*.07):Z==="round-triangle"&&(Me=(ie+Q+z)*(Math.PI/2),Ve=-(ie+Q/2+z)/Math.PI),Me!==0&&(ne=(s+Me)/s,ve=s*ne,["round-hexagon","round-tag"].includes(Z)||(oe=(u+Me)/u,Re=u*oe)),j=j==="auto"?ih(ve,Re):j;for(var Ke=ve/2,ze=Re/2,Ie=j+(ie+z+Q)/2,He=new Array(we.length/2),ke=new Array(we.length/2),Ge=0;Ge<we.length/2;Ge++)He[Ge]={x:W.x+Oe+Ke*we[Ge*2],y:W.y+Ve+ze*we[Ge*2+1]};var rt,nt,mt,et,Ze=He.length;for(nt=He[Ze-1],rt=0;rt<Ze;rt++)mt=He[rt%Ze],et=He[(rt+1)%Ze],ke[rt]=zu(nt,mt,et,Ie),nt=mt,mt=et;o.drawRoundPolygonPath(pe||r,W.x+Oe,W.y+Ve,s*ne,u*oe,we,ke)}else if(["roundrectangle","round-rectangle"].includes(Z))j=j==="auto"?oi(ve,Re):j,o.drawRoundRectanglePath(pe||r,W.x,W.y,ve,Re,j+(ie+z+Q)/2);else if(["cutrectangle","cut-rectangle"].includes(Z))j=j==="auto"?Du():j,o.drawCutRectanglePath(pe||r,W.x,W.y,ve,Re,null,j+(ie+z+Q)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(Z))j=j==="auto"?oi(ve,Re):j,o.drawBottomRoundRectanglePath(pe||r,W.x,W.y,ve,Re,j+(ie+z+Q)/2);else if(Z==="barrel")o.drawBarrelPath(pe||r,W.x,W.y,ve,Re);else if(Z.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(Z)){var At=(ie+z+Q)/s;we=Vs(zs(we,At)),o.drawPolygonPath(pe||r,W.x,W.y,s,u,we)}else{var Je=(ie+z+Q)/s;we=Vs(zs(we,-Je)),o.drawPolygonPath(pe||r,W.x,W.y,s,u,we)}if(h?r.stroke(pe):r.stroke(),U==="double"){r.lineWidth=ie/3;var at=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",h?r.stroke(pe):r.stroke(),r.globalCompositeOperation=at}r.setLineDash&&r.setLineDash([])}},_e=function(){i&&o.drawNodeOverlay(r,e,d,s,u)},xe=function(){i&&o.drawNodeUnderlay(r,e,d,s,u)},Ce=function(){o.drawElementText(r,e,null,n)},Ee=e.pstyle("ghost").value==="yes";if(Ee){var be=e.pstyle("ghost-offset-x").pfValue,fe=e.pstyle("ghost-offset-y").pfValue,V=e.pstyle("ghost-opacity").value,re=V*f;r.translate(be,fe),k(),me(),K(V*T),ge(),Te(re,!0),H(V*N),de(),he(B!==0||w!==0),Te(re,!1),ue(re),r.translate(-be,-fe)}h&&r.translate(-d.x,-d.y),xe(),h&&r.translate(d.x,d.y),k(),me(),K(),ge(),Te(f,!0),H(),de(),he(B!==0||w!==0),Te(f,!1),ue(),h&&r.translate(-d.x,-d.y),Ce(),_e(),t&&r.translate(g.x1,g.y1)}};var lv=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,i,a,o){var s=this;if(n.visible()){var u=n.pstyle("".concat(e,"-padding")).pfValue,l=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,d=n.pstyle("".concat(e,"-shape")).value,f=n.pstyle("".concat(e,"-corner-radius")).value;if(l>0){if(i=i||n.position(),a==null||o==null){var h=n.padding();a=n.width()+2*h,o=n.height()+2*h}s.colorFillStyle(t,c[0],c[1],c[2],l),s.nodeShapes[d].draw(t,i.x,i.y,a+u*2,o+u*2,f),t.fill()}}}};ia.drawNodeOverlay=lv("overlay");ia.drawNodeUnderlay=lv("underlay");ia.hasPie=function(r){return r=r[0],r._private.hasPie};ia.drawPie=function(r,e,t,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),o=n.x,s=n.y,u=e.width(),l=e.height(),c=Math.min(u,l)/2,d=0,f=this.usePaths();f&&(o=0,s=0),a.units==="%"?c=c*a.pfValue:a.pfValue!==void 0&&(c=a.pfValue/2);for(var h=1;h<=i.pieBackgroundN;h++){var v=e.pstyle("pie-"+h+"-background-size").value,p=e.pstyle("pie-"+h+"-background-color").value,m=e.pstyle("pie-"+h+"-background-opacity").value*t,g=v/100;g+d>1&&(g=1-d);var y=1.5*Math.PI+2*Math.PI*d,x=2*Math.PI*g,S=y+x;v===0||d>=1||d+g>1||(r.beginPath(),r.moveTo(o,s),r.arc(o,s,c,y,S),r.closePath(),this.colorFillStyle(r,p[0],p[1],p[2],m),r.fill(),d+=g)}};var dr={},Kb=100;dr.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),t=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/t};dr.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===r){t=!1;break}return t&&(n={context:r},e.push(n)),n};dr.createGradientStyleFor=function(r,e,t,n,i){var a,o=this.usePaths(),s=t.pstyle(e+"-gradient-stop-colors").value,u=t.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(t.isEdge()){var l=t.sourceEndpoint(),c=t.targetEndpoint(),d=t.midpoint(),f=ai(l,d),h=ai(c,d);a=r.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(f,h))}else{var v=o?{x:0,y:0}:t.position(),p=t.paddedWidth(),m=t.paddedHeight();a=r.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(p,m))}else if(t.isEdge()){var g=t.sourceEndpoint(),y=t.targetEndpoint();a=r.createLinearGradient(g.x,g.y,y.x,y.y)}else{var x=o?{x:0,y:0}:t.position(),S=t.paddedWidth(),D=t.paddedHeight(),P=S/2,R=D/2,L=t.pstyle("background-gradient-direction").value;switch(L){case"to-bottom":a=r.createLinearGradient(x.x,x.y-R,x.x,x.y+R);break;case"to-top":a=r.createLinearGradient(x.x,x.y+R,x.x,x.y-R);break;case"to-left":a=r.createLinearGradient(x.x+P,x.y,x.x-P,x.y);break;case"to-right":a=r.createLinearGradient(x.x-P,x.y,x.x+P,x.y);break;case"to-bottom-right":case"to-right-bottom":a=r.createLinearGradient(x.x-P,x.y-R,x.x+P,x.y+R);break;case"to-top-right":case"to-right-top":a=r.createLinearGradient(x.x-P,x.y+R,x.x+P,x.y-R);break;case"to-bottom-left":case"to-left-bottom":a=r.createLinearGradient(x.x+P,x.y-R,x.x-P,x.y+R);break;case"to-top-left":case"to-left-top":a=r.createLinearGradient(x.x+P,x.y+R,x.x-P,x.y-R);break}}if(!a)return null;for(var O=u.length===s.length,I=s.length,B=0;B<I;B++)a.addColorStop(O?u[B]:B/(I-1),"rgba("+s[B][0]+","+s[B][1]+","+s[B][2]+","+i+")");return a};dr.gradientFillStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"background",e,t,n);if(!i)return null;r.fillStyle=i};dr.colorFillStyle=function(r,e,t,n,i){r.fillStyle="rgba("+e+","+t+","+n+","+i+")"};dr.eleFillStyle=function(r,e,t){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(r,e,n,t);else{var i=e.pstyle("background-color").value;this.colorFillStyle(r,i[0],i[1],i[2],t)}};dr.gradientStrokeStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"line",e,t,n);if(!i)return null;r.strokeStyle=i};dr.colorStrokeStyle=function(r,e,t,n,i){r.strokeStyle="rgba("+e+","+t+","+n+","+i+")"};dr.eleStrokeStyle=function(r,e,t){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(r,e,n,t);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(r,i[0],i[1],i[2],t)}};dr.matchCanvasSize=function(r){var e=this,t=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],o=e.getPixelRatio(),s=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var u=i*o,l=a*o,c;if(!(u===e.canvasWidth&&l===e.canvasHeight)){e.fontCaches=null;var d=t.canvasContainer;d.style.width=i+"px",d.style.height=a+"px";for(var f=0;f<e.CANVAS_LAYERS;f++)c=t.canvases[f],c.width=u,c.height=l,c.style.width=i+"px",c.style.height=a+"px";for(var f=0;f<e.BUFFER_COUNT;f++)c=t.bufferCanvases[f],c.width=u,c.height=l,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,o<=1&&(c=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=u*e.textureMult,c.height=l*e.textureMult),e.canvasWidth=u,e.canvasHeight=l,e.pixelRatio=o}};dr.renderTo=function(r,e,t,n){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:n})};dr.clearCanvas=function(){var r=this,e=r.data;function t(n){n.clearRect(0,0,r.canvasWidth,r.canvasHeight)}t(e.contexts[r.NODE]),t(e.contexts[r.DRAG])};dr.render=function(r){var e=this;r=r||Zf();var t=e.cy,n=r.forcedContext,i=r.drawAllLayers,a=r.drawOnlyNodeLayer,o=r.forcedZoom,s=r.forcedPan,u=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,l=e.data,c=l.canvasNeedsRedraw,d=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),f=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,h=e.motionBlurPxRatio,v=t.hasCompoundNodes(),p=e.hoverData.draggingEles,m=!!(e.hoverData.selecting||e.touchData.selecting);f=f&&!n&&e.motionBlurEnabled&&!m;var g=f;n||(e.prevPxRatio!==u&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=u),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),f&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(g=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var y=t.style(),x=t.zoom(),S=o!==void 0?o:x,D=t.pan(),P={x:D.x,y:D.y},R={zoom:x,pan:{x:D.x,y:D.y}},L=e.prevViewport,O=L===void 0||R.zoom!==L.zoom||R.pan.x!==L.pan.x||R.pan.y!==L.pan.y;!O&&!(p&&!v)&&(e.motionBlurPxRatio=1),s&&(P=s),S*=u,P.x*=u,P.y*=u;var I=e.getCachedZSortedEles();function B(H,k,G,$,te){var q=H.globalCompositeOperation;H.globalCompositeOperation="destination-out",e.colorFillStyle(H,255,255,255,e.motionBlurTransparency),H.fillRect(k,G,$,te),H.globalCompositeOperation=q}function w(H,k){var G,$,te,q;!e.clearingMotionBlur&&(H===l.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||H===l.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(G={x:D.x*h,y:D.y*h},$=x*h,te=e.canvasWidth*h,q=e.canvasHeight*h):(G=P,$=S,te=e.canvasWidth,q=e.canvasHeight),H.setTransform(1,0,0,1,0,0),k==="motionBlur"?B(H,0,0,te,q):!n&&(k===void 0||k)&&H.clearRect(0,0,te,q),i||(H.translate(G.x,G.y),H.scale($,$)),s&&H.translate(s.x,s.y),o&&H.scale(o,o)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=t.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var T=e.data.bufferContexts[e.TEXTURE_BUFFER];T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:T,drawOnlyNodeLayer:!0,forcedPxRatio:u*e.textureMult});var R=e.textureCache.viewport={zoom:t.zoom(),pan:t.pan(),width:e.canvasWidth,height:e.canvasHeight};R.mpan={x:(0-R.pan.x)/R.zoom,y:(0-R.pan.y)/R.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var E=l.contexts[e.NODE],b=e.textureCache.texture,R=e.textureCache.viewport;E.setTransform(1,0,0,1,0,0),f?B(E,0,0,R.width,R.height):E.clearRect(0,0,R.width,R.height);var C=y.core("outside-texture-bg-color").value,_=y.core("outside-texture-bg-opacity").value;e.colorFillStyle(E,C[0],C[1],C[2],_),E.fillRect(0,0,R.width,R.height);var x=t.zoom();w(E,!1),E.clearRect(R.mpan.x,R.mpan.y,R.width/R.zoom/u,R.height/R.zoom/u),E.drawImage(b,R.mpan.x,R.mpan.y,R.width/R.zoom/u,R.height/R.zoom/u)}else e.textureOnViewport&&!n&&(e.textureCache=null);var M=t.extent(),A=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),F=e.hideEdgesOnViewport&&A,N=[];if(N[e.NODE]=!c[e.NODE]&&f&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,N[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),N[e.DRAG]=!c[e.DRAG]&&f&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,N[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||N[e.NODE]){var z=f&&!N[e.NODE]&&h!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:l.contexts[e.NODE]),Y=f&&!z?"motionBlur":void 0;w(E,Y),F?e.drawCachedNodes(E,I.nondrag,u,M):e.drawLayeredElements(E,I.nondrag,u,M),e.debug&&e.drawDebugPoints(E,I.nondrag),!i&&!f&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||N[e.DRAG])){var z=f&&!N[e.DRAG]&&h!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:l.contexts[e.DRAG]);w(E,f&&!z?"motionBlur":void 0),F?e.drawCachedNodes(E,I.drag,u,M):e.drawCachedElements(E,I.drag,u,M),e.debug&&e.drawDebugPoints(E,I.drag),!i&&!f&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,w),f&&h!==1){var U=l.contexts[e.NODE],ee=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],Q=l.contexts[e.DRAG],j=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],K=function(k,G,$){k.setTransform(1,0,0,1,0,0),$||!g?k.clearRect(0,0,e.canvasWidth,e.canvasHeight):B(k,0,0,e.canvasWidth,e.canvasHeight);var te=h;k.drawImage(G,0,0,e.canvasWidth*te,e.canvasHeight*te,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||N[e.NODE])&&(K(U,ee,N[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||N[e.DRAG])&&(K(Q,j,N[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=R,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),f&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},Kb)),n||t.emit("render")};var ba;dr.drawSelectionRectangle=function(r,e){var t=this,n=t.cy,i=t.data,a=n.style(),o=r.drawOnlyNodeLayer,s=r.drawAllLayers,u=i.canvasNeedsRedraw,l=r.forcedContext;if(t.showFps||!o&&u[t.SELECT_BOX]&&!s){var c=l||i.contexts[t.SELECT_BOX];if(e(c),t.selection[4]==1&&(t.hoverData.selecting||t.touchData.selecting)){var d=t.cy.zoom(),f=a.core("selection-box-border-width").value/d;c.lineWidth=f,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]),f>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]))}if(i.bgActivePosistion&&!t.hoverData.selecting){var d=t.cy.zoom(),h=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(h.x,h.y,a.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var v=t.lastRedrawTime;if(t.showFps&&v){v=Math.round(v);var p=Math.round(1e3/v),m="1 frame = "+v+" ms = "+p+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!ba){var g=c.measureText(m);ba=g.actualBoundingBoxAscent}c.fillText(m,0,ba);var y=60;c.strokeRect(0,ba+10,250,20),c.fillRect(0,ba+10,250*Math.min(p/y,1),20)}s||(u[t.SELECT_BOX]=!1)}};function Tf(r,e,t){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(n));return n}function Zb(r,e,t){var n=Tf(r,r.VERTEX_SHADER,e),i=Tf(r,r.FRAGMENT_SHADER,t),a=r.createProgram();if(r.attachShader(a,n),r.attachShader(a,i),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function Qb(r,e,t){t===void 0&&(t=e);var n=r.makeOffscreenCanvas(e,t),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function Hu(r){var e=r.pixelRatio,t=r.cy.zoom(),n=r.cy.pan();return{zoom:t*e,pan:{x:n.x*e,y:n.y*e}}}function eu(r,e,t,n,i){var a=n*t+e.x,o=i*t+e.y;return o=Math.round(r.canvasHeight-o),[a,o]}function _s(r,e,t){var n=r[0]/255,i=r[1]/255,a=r[2]/255,o=e,s=t||new Array(4);return s[0]=n*o,s[1]=i*o,s[2]=a*o,s[3]=o,s}function Ss(r,e){var t=e||new Array(4);return t[0]=(r>>0&255)/255,t[1]=(r>>8&255)/255,t[2]=(r>>16&255)/255,t[3]=(r>>24&255)/255,t}function Jb(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function ex(r,e){var t=r.createTexture();return t.buffer=function(n){r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},t.deleteTexture=function(){r.deleteTexture(t)},t}function uv(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function cv(r,e,t){switch(e){case r.FLOAT:return new Float32Array(t);case r.INT:return new Int32Array(t)}}function tx(r,e,t,n,i,a){switch(e){case r.FLOAT:return new Float32Array(t.buffer,a*n,i);case r.INT:return new Int32Array(t.buffer,a*n,i)}}function rx(r,e,t,n){var i=uv(r,e),a=kt(i,2),o=a[0],s=a[1],u=cv(r,s,n),l=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,u,r.STATIC_DRAW),s===r.FLOAT?r.vertexAttribPointer(t,o,s,!1,0,0):s===r.INT&&r.vertexAttribIPointer(t,o,s,0,0),r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,null),l}function _r(r,e,t,n){var i=uv(r,t),a=kt(i,3),o=a[0],s=a[1],u=a[2],l=cv(r,s,e*o),c=o*u,d=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,d),r.bufferData(r.ARRAY_BUFFER,e*c,r.DYNAMIC_DRAW),r.enableVertexAttribArray(n),s===r.FLOAT?r.vertexAttribPointer(n,o,s,!1,c,0):s===r.INT&&r.vertexAttribIPointer(n,o,s,c,0),r.vertexAttribDivisor(n,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var f=new Array(e),h=0;h<e;h++)f[h]=tx(r,s,l,c,o,h);return d.dataArray=l,d.stride=c,d.size=o,d.getView=function(v){return f[v]},d.setPoint=function(v,p,m){var g=f[v];g[0]=p,g[1]=m},d.bufferSubData=function(v){r.bindBuffer(r.ARRAY_BUFFER,d),v?r.bufferSubData(r.ARRAY_BUFFER,0,l,0,v*o):r.bufferSubData(r.ARRAY_BUFFER,0,l)},d}function nx(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,i,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var _f=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function Pa(){var r=new _f(9);return _f!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function dv(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function ix(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],f=t[0],h=t[1],v=t[2],p=t[3],m=t[4],g=t[5],y=t[6],x=t[7],S=t[8];return r[0]=f*n+h*o+v*l,r[1]=f*i+h*s+v*c,r[2]=f*a+h*u+v*d,r[3]=p*n+m*o+g*l,r[4]=p*i+m*s+g*c,r[5]=p*a+m*u+g*d,r[6]=y*n+x*o+S*l,r[7]=y*i+x*s+S*c,r[8]=y*a+x*u+S*d,r}function Ys(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],f=t[0],h=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r[4]=s,r[5]=u,r[6]=f*n+h*o+l,r[7]=f*i+h*s+c,r[8]=f*a+h*u+d,r}function fv(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],f=Math.sin(t),h=Math.cos(t);return r[0]=h*n+f*o,r[1]=h*i+f*s,r[2]=h*a+f*u,r[3]=h*o-f*n,r[4]=h*s-f*i,r[5]=h*u-f*a,r[6]=l,r[7]=c,r[8]=d,r}function Uu(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function ax(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var Ra={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},xa=Yt({getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:null,getPadding:null}),ox=function(){function r(e,t){jn(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.atlasSize=t.webglTexSize,this.rows=t.webglTexRows,this.enableWrapping=t.enableWrapping,this.texHeight=Math.floor(this.atlasSize/this.rows),this.maxTexWidth=this.atlasSize,this.texture=null,this.canvas=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=t.createTextureCanvas(e,this.atlasSize,this.atlasSize),this.scratch=t.createTextureCanvas(e,this.atlasSize,this.texHeight,"scratch")}return Hn(r,[{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(t){var n=t.w,i=t.h,a=this.texHeight,o=this.maxTexWidth,s=a/i,u=n*s,l=i*s;return u>o&&(s=o/n,u=n*s,l=i*s),{scale:s,texW:u,texH:l}}},{key:"draw",value:function(t,n,i){var a=this,o=this.atlasSize,s=this.rows,u=this.texHeight,l=this.getScale(n),c=l.scale,d=l.texW,f=l.texH,h=[null,null],v=function(x,S){if(i&&S){var D=S.context,P=x.x,R=x.row,L=P,O=u*R;D.save(),D.translate(L,O),D.scale(c,c),i(D,n),D.restore()}},p=function(){v(a.freePointer,a.canvas),h[0]={x:a.freePointer.x,y:a.freePointer.row*u,w:d,h:f},h[1]={x:a.freePointer.x+d,y:a.freePointer.row*u,w:0,h:f},a.freePointer.x+=d,a.freePointer.x==o&&(a.freePointer.x=0,a.freePointer.row++)},m=function(){var x=a.scratch,S=a.canvas;x.clear(),v({x:0,row:0},x);var D=o-a.freePointer.x,P=d-D,R=u;{var L=a.freePointer.x,O=a.freePointer.row*u,I=D;S.context.drawImage(x,0,0,I,R,L,O,I,R),h[0]={x:L,y:O,w:I,h:f}}{var B=D,w=(a.freePointer.row+1)*u,T=P;S&&S.context.drawImage(x,B,0,T,R,0,w,T,R),h[1]={x:0,y:w,w:T,h:f}}a.freePointer.x=P,a.freePointer.row++},g=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+d<=o)p();else{if(this.freePointer.row>=s-1)return!1;this.freePointer.x===o?(g(),p()):this.enableWrapping?m():(g(),p())}return this.keyToLocation.set(t,h),this.needsBuffer=!0,h}},{key:"getOffsets",value:function(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(t){var n=this.atlasSize,i=this.rows,a=this.getScale(t),o=a.texW;return this.freePointer.x+o>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(t){this.texture||(this.texture=ex(t,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1)}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null,this.needsBuffer=!0)}}]),r}(),sx=function(){function r(e,t){jn(this,r),this.r=e,this.opts=t,this.keyToIds=new Map,this.idToKey=new Map,this.atlases=[],this.styleKeyToAtlas=new Map,this.styleKeyNeedsRedraw=new Set,this.forceGC=!1}return Hn(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"getIdsFor",value:function(t){var n=this.keyToIds.get(t);return n||(n=new Set,this.keyToIds.set(t,n)),n}},{key:"_createAtlas",value:function(){var t=this.r,n=this.opts;return new ox(t,n)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var t=this.r,n=this.opts,i=n.webglTexSize,a=Math.floor(i/n.webglTexRows);this.scratch=n.createTextureCanvas(t,i,a,"scratch")}return this.scratch}},{key:"draw",value:function(t,n,i,a){if(this.styleKeyNeedsRedraw.has(n)){this.styleKeyNeedsRedraw.delete(n),this.deleteKey(t,n);var o=this.styleKeyToAtlas.get(n);o&&(o.forceGC=!0),this.styleKeyToAtlas.delete(n)}var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s),this.getIdsFor(n).add(t),this.idToKey.set(t,n)),s}},{key:"getAtlas",value:function(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function(t){return this.styleKeyToAtlas.has(t)}},{key:"deleteKey",value:function(t,n){this.idToKey.delete(t),this.getIdsFor(n).delete(t)}},{key:"checkKeyIsInvalid",value:function(t,n){if(!this.idToKey.has(t))return!1;var i=this.idToKey.get(t);return i!=n?(this.deleteKey(t,i),!0):!1}},{key:"_getKeysToCollect",value:function(){var t=new Set,n=Sr(this.styleKeyToAtlas.keys()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;this.getIdsFor(a).size==0&&t.add(a)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"gc",value:function(){var t=this,n=this.atlases.some(function(f){return f.forceGC}),i=this._getKeysToCollect();if(i.size===0&&!n){console.log("nothing to garbage collect");return}var a=[],o=new Map,s=null,u=Sr(this.atlases),l;try{var c=function(){var h=l.value,v=h.getKeys(),p=lx(i,v);if(p.size===0&&!h.forceGC)return a.push(h),v.forEach(function(R){return o.set(R,h)}),"continue";s||(s=t._createAtlas(),a.push(s));var m=Sr(v),g;try{for(m.s();!(g=m.n()).done;){var y=g.value;if(!p.has(y)){var x=h.getOffsets(y),S=kt(x,2),D=S[0],P=S[1];s.canFit({w:D.w+P.w,h:D.h})||(s=t._createAtlas(),a.push(s)),t._copyTextureToNewAtlas(y,h,s),o.set(y,s)}}}catch(R){m.e(R)}finally{m.f()}};for(u.s();!(l=u.n()).done;)var d=c()}catch(f){u.e(f)}finally{u.f()}this.atlases=a,this.styleKeyToAtlas=o}},{key:"_copyTextureToNewAtlas",value:function(t,n,i){var a=n.getOffsets(t),o=kt(a,2),s=o[0],u=o[1];if(u.w===0)i.draw(t,s,function(f){f.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h)});else{var l=this._getScratchCanvas();l.clear(),l.context.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h),l.context.drawImage(n.canvas,u.x,u.y,u.w,u.h,s.w,0,u.w,u.h);var c=s.w+u.w,d=s.h;i.draw(t,{w:c,h:d},function(f){f.drawImage(l,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}]),r}();function lx(r,e){return r.intersection?r.intersection(e):new Set(Lf(r).filter(function(t){return e.has(t)}))}var ux=function(){function r(e,t){jn(this,r),this.r=e;var n=t;this.globalOptions=n,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.renderTypes=new Map,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[],this._cacheScratchCanvas(n)}return Hn(r,[{key:"_cacheScratchCanvas",value:function(t){var n=-1,i=-1,a=null,o=t.createTextureCanvas;t.createTextureCanvas=function(s,u,l,c){return c?((!a||u!=n||l!=i)&&(n=u,i=l,a=o(s,u,l)),a):o(s,u,l)}}},{key:"addRenderType",value:function(t,n){var i=new sx(this.r,this.globalOptions),a=n;this.renderTypes.set(t,Ye({type:t,atlasCollection:i},a))}},{key:"getRenderTypes",value:function(){return Lf(this.renderTypes.values())}},{key:"getRenderTypeOpts",value:function(t){return this.renderTypes.get(t)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.forceRedraw,a=i===void 0?!1:i,o=n.filterEle,s=o===void 0?function(){return!0}:o,u=n.filterType,l=u===void 0?function(){return!0}:u,c=!1,d=Sr(t),f;try{for(d.s();!(f=d.n()).done;){var h=f.value;if(s(h)){var v=h.id(),p=Sr(this.getRenderTypes()),m;try{for(p.s();!(m=p.n()).done;){var g=m.value;if(l(g.type)){var y=g.getKey(h);a?(g.atlasCollection.deleteKey(v,y),g.atlasCollection.styleKeyNeedsRedraw.add(y),c=!0):c|=g.atlasCollection.checkKeyIsInvalid(v,y)}}}catch(x){p.e(x)}finally{p.f()}}}}catch(x){d.e(x)}finally{d.f()}return c}},{key:"gc",value:function(){var t=Sr(this.getRenderTypes()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.atlasCollection.gc()}}catch(a){t.e(a)}finally{t.f()}}},{key:"isRenderable",value:function(t,n){var i=this.getRenderTypeOpts(n);return i&&i.isVisible(t)}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"getOrCreateAtlas",value:function(t,n,i){var a=this.renderTypes.get(i),o=a.getKey(t),s=t.id();return a.atlasCollection.draw(s,o,n,function(u){a.drawElement(u,t,n,!0,!0)})}},{key:"getAtlasIndexForBatch",value:function(t){var n=this.batchAtlases.indexOf(t);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(t),n=this.batchAtlases.length-1}return n}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlases},function(t,n){return n})}},{key:"getAtlasInfo",value:function(t,n){var i=this.renderTypes.get(n),a=i.getBoundingBox(t),o=this.getOrCreateAtlas(t,a,n),s=this.getAtlasIndexForBatch(o);if(s!==void 0){var u=i.getKey(t),l=o.getOffsets(u),c=kt(l,2),d=c[0],f=c[1];return{atlasID:s,tex:d,tex1:d,tex2:f,bb:a,type:n,styleKey:u}}}},{key:"canAddToCurrentBatch",value:function(t,n){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var i=this.renderTypes.get(n),a=i.getKey(t),o=i.atlasCollection.getAtlas(a);return o&&this.batchAtlases.includes(o)}return!0}},{key:"setTransformMatrix",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=n.bb,s=n.type,u=n.tex1,l=n.tex2,c=this.getRenderTypeOpts(s),d=c.getPadding?c.getPadding(i):0,f=u.w/(u.w+l.w);a||(f=1-f);var h=this.getAdjustedBB(o,d,a,f),v,p;dv(t);var m=c.getRotation?c.getRotation(i):0;if(m!==0){var g=c.getRotationPoint(i),y=g.x,x=g.y;Ys(t,t,[y,x]),fv(t,t,m);var S=c.getRotationOffset(i);v=S.x+h.xOffset,p=S.y}else v=h.x1,p=h.y1;Ys(t,t,[v,p]),Uu(t,t,[h.w,h.h])}},{key:"getTransformMatrix",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Pa();return this.setTransformMatrix(a,t,n,i),a}},{key:"getAdjustedBB",value:function(t,n,i,a){var o=t.x1,s=t.y1,u=t.w,l=t.h;n&&(o-=n,s-=n,u+=2*n,l+=2*n);var c=0,d=u*a;return i&&a<1?u=d:!i&&a<1&&(c=u-d,o+=c,u=d),{x1:o,y1:s,w:u,h:l,xOffset:c}}},{key:"getDebugInfo",value:function(){var t=[],n=Sr(this.renderTypes),i;try{for(n.s();!(i=n.n()).done;){var a=kt(i.value,2),o=a[0],s=a[1],u=s.atlasCollection.getCounts(),l=u.keyCount,c=u.atlasCount;t.push({type:o,keyCount:l,atlasCount:c})}}catch(d){n.e(d)}finally{n.f()}return t}}]),r}(),tu=0,Sf=1,Mf=2,ru=3,cx=function(){function r(e,t,n){jn(this,r),this.r=e,this.gl=t,this.maxInstances=n.webglBatchSize,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,n.enableWrapping=!0,n.createTextureCanvas=Qb,this.atlasManager=new ux(e,n),this.program=this.createShaderProgram(Ra.SCREEN),this.pickingProgram=this.createShaderProgram(Ra.PICKING),this.vao=this.createVAO(),this.debugInfo=[]}return Hn(r,[{key:"addTextureRenderType",value:function(t,n){this.atlasManager.addRenderType(t,n)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(t,{filterType:function(s){return s===i},forceRedraw:!0}):a.invalidate(t)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function(t){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; 

      // what are we rendering?
      in int aVertType;

      // for picking
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex1; // x/y/w/h of texture in atlas
      in vec4 aTex2; 

      // for any transforms that are needed
      in vec4 aScaleRotate1;  // vectors use fewer attributes than matrices
      in vec2 aTranslate1;
      in vec4 aScaleRotate2;
      in vec2 aTranslate2;

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in float aLineWidth;
      in vec4 aEdgeColor;

      out vec2 vTexCoord;
      out vec4 vEdgeColor;
      flat out int vAtlasId;
      flat out vec4 vIndex;
      flat out int vVertType;

      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition;

        if(aVertType == `.concat(tu,`) {
          float texX;
          float texY;
          float texW;
          float texH;
          mat3  texMatrix;

          int vid = gl_VertexID;
          if(vid <= 5) {
            texX = aTex1.x;
            texY = aTex1.y;
            texW = aTex1.z;
            texH = aTex1.w;
            texMatrix = mat3(
              vec3(aScaleRotate1.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate1,      1.0)
            );
          } else {
            texX = aTex2.x;
            texY = aTex2.y;
            texW = aTex2.z;
            texH = aTex2.w;
            texMatrix = mat3(
              vec3(aScaleRotate2.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate2,      1.0)
            );
          }

          if(vid == 1 || vid == 2 || vid == 4 || vid == 7 || vid == 8 || vid == 10) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5 || vid == 8 || vid == 10 || vid == 11) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * texMatrix * vec3(position, 1.0), 1.0);
        } 
        else if(aVertType == `).concat(Sf,` && vid < 6) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(Mf,` && vid < 6) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0 = pointA;
          vec2 p1 = pointB;
          vec2 p2 = pointC;
          vec2 pos = position;
          if(position.x == 1.0) {
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth;

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(ru,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2( 0.0,   0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          mat3 transform = mat3(
            vec3(aScaleRotate1.xy, 0.0),
            vec3(aScaleRotate1.zw, 0.0),
            vec3(aTranslate1,      1.0)
          );
          gl_Position = vec4(uPanZoomMatrix * transform * vec3(position, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vIndex = aIndex;
        vVertType = aVertType;
      }
    `),a=this.atlasManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // define texture unit for each node in the batch
      `.concat(a.map(function(l){return"uniform sampler2D uTexture".concat(l,";")}).join(`
	`),`

      uniform vec4 uBGColor;

      in vec2 vTexCoord;
      in vec4 vEdgeColor;
      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;

      out vec4 outColor;

      void main(void) {
        if(vVertType == `).concat(tu,`) {
          `).concat(a.map(function(l){return"if(vAtlasId == ".concat(l,") outColor = texture(uTexture").concat(l,", vTexCoord);")}).join(`
	else `),`
        } else if(vVertType == `).concat(ru,`) {
          // blend arrow color with background (using premultiplied alpha)
          outColor.rgb = vEdgeColor.rgb + (uBGColor.rgb * (1.0 - vEdgeColor.a)); 
          outColor.a = 1.0; // make opaque, masks out line under arrow
        } else {
          outColor = vEdgeColor;
        }

        `).concat(t.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),s=Zb(n,i,o);s.aPosition=n.getAttribLocation(s,"aPosition"),s.aIndex=n.getAttribLocation(s,"aIndex"),s.aVertType=n.getAttribLocation(s,"aVertType"),s.aAtlasId=n.getAttribLocation(s,"aAtlasId"),s.aTex1=n.getAttribLocation(s,"aTex1"),s.aTex2=n.getAttribLocation(s,"aTex2"),s.aScaleRotate1=n.getAttribLocation(s,"aScaleRotate1"),s.aTranslate1=n.getAttribLocation(s,"aTranslate1"),s.aScaleRotate2=n.getAttribLocation(s,"aScaleRotate2"),s.aTranslate2=n.getAttribLocation(s,"aTranslate2"),s.aPointAPointB=n.getAttribLocation(s,"aPointAPointB"),s.aPointCPointD=n.getAttribLocation(s,"aPointCPointD"),s.aLineWidth=n.getAttribLocation(s,"aLineWidth"),s.aEdgeColor=n.getAttribLocation(s,"aEdgeColor"),s.uPanZoomMatrix=n.getUniformLocation(s,"uPanZoomMatrix"),s.uAtlasSize=n.getUniformLocation(s,"uAtlasSize"),s.uBGColor=n.getUniformLocation(s,"uBGColor"),s.uTextures=[];for(var u=0;u<this.atlasManager.maxAtlases;u++)s.uTextures.push(n.getUniformLocation(s,"uTexture".concat(u)));return s}},{key:"createVAO",value:function(){var t=[0,0,1,0,1,1,0,0,1,1,0,1],n=[].concat(t,t);this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,o=this.program,s=a.createVertexArray();return a.bindVertexArray(s),rx(a,"vec2",o.aPosition,n),this.indexBuffer=_r(a,i,"vec4",o.aIndex),this.vertTypeBuffer=_r(a,i,"int",o.aVertType),this.atlasIdBuffer=_r(a,i,"int",o.aAtlasId),this.tex1Buffer=_r(a,i,"vec4",o.aTex1),this.tex2Buffer=_r(a,i,"vec4",o.aTex2),this.scaleRotate1Buffer=_r(a,i,"vec4",o.aScaleRotate1),this.translate1Buffer=_r(a,i,"vec2",o.aTranslate1),this.scaleRotate2Buffer=_r(a,i,"vec4",o.aScaleRotate2),this.translate2Buffer=_r(a,i,"vec2",o.aTranslate2),this.pointAPointBBuffer=_r(a,i,"vec4",o.aPointAPointB),this.pointCPointDBuffer=_r(a,i,"vec4",o.aPointCPointD),this.lineWidthBuffer=_r(a,i,"float",o.aLineWidth),this.edgeColorBuffer=_r(a,i,"vec4",o.aEdgeColor),a.bindVertexArray(null),s}},{key:"buffers",get:function(){var t=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return t[n]})),this._buffers}},{key:"startFrame",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ra.SCREEN;this.panZoomMatrix=t,this.debugInfo=n,this.renderTarget=i,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.atlasManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"getTempMatrix",value:function(){return this.tempMatrix=this.tempMatrix||Pa()}},{key:"drawTexture",value:function(t,n,i){var a=this.atlasManager;if(a.isRenderable(t,i)){a.canAddToCurrentBatch(t,i)||this.endBatch();var o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=tu;var s=this.indexBuffer.getView(o);Ss(n,s);var u=a.getAtlasInfo(t,i,u),l=u.atlasID,c=u.tex1,d=u.tex2,f=this.atlasIdBuffer.getView(o);f[0]=l;var h=this.tex1Buffer.getView(o);h[0]=c.x,h[1]=c.y,h[2]=c.w,h[3]=c.h;var v=this.tex2Buffer.getView(o);v[0]=d.x,v[1]=d.y,v[2]=d.w,v[3]=d.h;for(var p=this.getTempMatrix(),m=0,g=[1,2];m<g.length;m++){var y=g[m];a.setTransformMatrix(p,u,t,y===1);var x=this["scaleRotate".concat(y,"Buffer")].getView(o);x[0]=p[0],x[1]=p[1],x[2]=p[3],x[3]=p[4];var S=this["translate".concat(y,"Buffer")].getView(o);S[0]=p[6],S[1]=p[7]}this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function(t,n,i){var a=t._private.rscratch,o,s,u;if(i==="source"?(o=a.arrowStartX,s=a.arrowStartY,u=a.srcArrowAngle):(o=a.arrowEndX,s=a.arrowEndY,u=a.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(s)||s==null||isNaN(u)||u==null)){var l=t.pstyle(i+"-arrow-shape").value;if(l!=="none"){var c=t.pstyle(i+"-arrow-color").value,d=t.pstyle("opacity").value,f=t.pstyle("line-opacity").value,h=d*f,v=t.pstyle("width").pfValue,p=t.pstyle("arrow-scale").value,m=this.r.getArrowWidth(v,p),g=this.getTempMatrix();dv(g),Ys(g,g,[o,s]),Uu(g,g,[m,m]),fv(g,g,u);var y=this.instanceCount;this.vertTypeBuffer.getView(y)[0]=ru;var x=this.indexBuffer.getView(y);Ss(n,x);var S=this.edgeColorBuffer.getView(y);_s(c,h,S);var D=this.scaleRotate1Buffer.getView(y);D[0]=g[0],D[1]=g[1],D[2]=g[3],D[3]=g[4];var P=this.translate1Buffer.getView(y);P[0]=g[6],P[1]=g[7],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(t,n){var i=t.pstyle("opacity").value,a=t.pstyle("line-opacity").value,o=t.pstyle("width").pfValue,s=t.pstyle("line-color").value,u=i*a,l=this.getEdgePoints(t);if(l.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),l.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=Sf;var d=this.indexBuffer.getView(c);Ss(n,d);var f=this.edgeColorBuffer.getView(c);_s(s,u,f);var h=this.lineWidthBuffer.getView(c);h[0]=o;var v=this.pointAPointBBuffer.getView(c);v[0]=l[0],v[1]=l[1],v[2]=l[2],v[3]=l[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var p=0;p<l.length-2;p+=2){var m=this.instanceCount;this.vertTypeBuffer.getView(m)[0]=Mf;var g=this.indexBuffer.getView(m);Ss(n,g);var y=this.edgeColorBuffer.getView(m);_s(s,u,y);var x=this.lineWidthBuffer.getView(m);x[0]=o;var S=l[p-2],D=l[p-1],P=l[p],R=l[p+1],L=l[p+2],O=l[p+3],I=l[p+4],B=l[p+5];p==0&&(S=2*P-L+.001,D=2*R-O+.001),p==l.length-4&&(I=2*L-P+.001,B=2*O-R+.001);var w=this.pointAPointBBuffer.getView(m);w[0]=S,w[1]=D,w[2]=P,w[3]=R;var T=this.pointCPointDBuffer.getView(m);T[0]=L,T[1]=O,T[2]=I,T[3]=B,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"getEdgePoints",value:function(t){var n=t._private.rscratch,i=n.allpts;if(i.length==4)return i;var a=this.getNumSegments(t);return this.getCurveSegmentPoints(i,a)}},{key:"getNumSegments",value:function(t){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function(t,n){if(t.length==4)return t;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=t[0],i[1]=t[1];else if(a==n)i[a*2]=t[t.length-2],i[a*2+1]=t[t.length-1];else{var o=a/n;this.setCurvePoint(t,o,i,a*2)}return i}},{key:"setCurvePoint",value:function(t,n,i,a){if(t.length<=2)i[a]=t[0],i[a+1]=t[1];else{for(var o=Array(t.length-2),s=0;s<o.length;s+=2){var u=(1-n)*t[s]+n*t[s+2],l=(1-n)*t[s+1]+n*t[s+3];o[s]=u,o[s+1]=l}return this.setCurvePoint(o,n,i,a)}}},{key:"endBatch",value:function(){var t=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(o),t.bindVertexArray(n);var s=Sr(this.buffers),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;l.bufferSubData(a)}}catch(v){s.e(v)}finally{s.f()}for(var c=this.atlasManager.getAtlases(),d=0;d<c.length;d++)c[d].bufferIfNeeded(t);for(var f=0;f<c.length;f++)t.activeTexture(t.TEXTURE0+f),t.bindTexture(t.TEXTURE_2D,c[f].texture),t.uniform1i(o.uTextures[f],f);t.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),t.uniform1i(o.uAtlasSize,this.atlasManager.atlasSize);var h=_s(this.bgColor,1);t.uniform4fv(o.uBGColor,h),t.drawArraysInstanced(t.TRIANGLES,0,i,a),t.bindVertexArray(null),t.bindTexture(t.TEXTURE_2D,null),this.debugInfo&&this.debugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){return this.debugInfo}},{key:"getAtlasDebugInfo",value:function(){return this.atlasManager.getDebugInfo()}}]),r}();function Df(r,e){return"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(e,")")}var dx=function(){function r(e){jn(this,r),this.r=e}return Hn(r,[{key:"getStyleKey",value:function(t,n){var i=this.getStyle(t,n),a=i.shape,o=i.opacity,s=i.color;if(!a)return null;var u=n.width(),l=n.height(),c=Df(s,o);return Fn("".concat(a,"-").concat(u,"-").concat(l,"-").concat(c))}},{key:"isVisible",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value;return i>0}},{key:"getStyle",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value,a=n.pstyle("".concat(t,"-color")).value,o=n.pstyle("".concat(t,"-shape")).value;return{opacity:i,color:a,shape:o}}},{key:"getPadding",value:function(t,n){return n.pstyle("".concat(t,"-padding")).pfValue}},{key:"draw",value:function(t,n,i,a){if(this.isVisible(t,i)){var o=this.r,s=a.w,u=a.h,l=s/2,c=u/2,d=this.getStyle(t,i),f=d.shape,h=d.color,v=d.opacity;n.save(),n.fillStyle=Df(h,v),f==="round-rectangle"||f==="roundrectangle"?o.drawRoundRectanglePath(n,l,c,s,u,"auto"):f==="ellipse"&&o.drawEllipsePath(n,l,c,s,u),n.fill(),n.restore()}}}]),r}();function fx(r){var e=r&&r.style&&r.style.backgroundColor||"white";return Vf(e)}var hv={};hv.initWebgl=function(r,e){var t=this,n=t.data.contexts[t.WEBGL],i=r.cy.container();r.bgColor=fx(i),r.webglTexSize=Math.min(r.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),t.webglDebug=r.webglDebug,t.webglDebugShowAtlases=r.webglDebugShowAtlases,console.log("max texture units",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),console.log("max texture size",n.getParameter(n.MAX_TEXTURE_SIZE)),console.log("webgl options",r),t.pickingFrameBuffer=nx(n),t.pickingFrameBuffer.needsDraw=!0;var a=function(c){return t.getTextAngle(c,null)},o=function(c){var d=c.pstyle("label");return d&&d.value};t.eleDrawing=new cx(t,n,r);var s=new dx(t);t.eleDrawing.addTextureRenderType("node-body",xa({getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement,isVisible:function(c){return c.visible()}})),t.eleDrawing.addTextureRenderType("node-label",xa({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o})),t.eleDrawing.addTextureRenderType("node-overlay",xa({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("overlay",c)},drawElement:function(c,d,f){return s.draw("overlay",c,d,f)},isVisible:function(c){return s.isVisible("overlay",c)},getPadding:function(c){return s.getPadding("overlay",c)}})),t.eleDrawing.addTextureRenderType("node-underlay",xa({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("underlay",c)},drawElement:function(c,d,f){return s.draw("underlay",c,d,f)},isVisible:function(c){return s.isVisible("underlay",c)},getPadding:function(c){return s.getPadding("underlay",c)}})),t.eleDrawing.addTextureRenderType("edge-label",xa({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o}));var u=Wa(function(){console.log("garbage collect flag set"),t.data.gc=!0},1e4);t.onUpdateEleCalcs(function(l,c){var d=!1;c&&c.length>0&&(d|=t.eleDrawing.invalidate(c)),d&&u()}),hx(t)};function hx(r){{var e=r.render;r.render=function(a){a=a||{};var o=r.cy;r.webgl&&(o.zoom()>iv?(vx(r),e.call(r,a)):(px(r),pv(r,a,Ra.SCREEN)))}}{var t=r.matchCanvasSize;r.matchCanvasSize=function(a){t.call(r,a),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(a,o,s,u){return bx(r,a,o)};{var n=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){n.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var i=r.notify;r.notify=function(a,o){i.call(r,a,o),a==="viewport"||a==="bounds"?r.pickingFrameBuffer.needsDraw=!0:a==="background"&&r.eleDrawing.invalidate(o,{type:"node-body"})}}}function vx(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function px(r){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.canvasWidth,r.canvasHeight),n.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function gx(r){var e=r.canvasWidth,t=r.canvasHeight,n=Hu(r),i=n.pan,a=n.zoom,o=Pa();Ys(o,o,[i.x,i.y]),Uu(o,o,[a,a]);var s=Pa();ax(s,e,t);var u=Pa();return ix(u,s,o),u}function vv(r,e){var t=r.canvasWidth,n=r.canvasHeight,i=Hu(r),a=i.pan,o=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.translate(a.x,a.y),e.scale(o,o)}function mx(r,e){r.drawSelectionRectangle(e,function(t){return vv(r,t)})}function yx(r){var e=r.data.contexts[r.NODE];e.save(),vv(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function Cx(r){var e=function(i,a,o){for(var s=i.atlasManager.getRenderTypeOpts(a),u=r.data.contexts[r.NODE],l=.125,c=s.atlasCollection.atlases,d=0;d<c.length;d++){var f=c[d],h=f.canvas,v=h.width,p=h.height,m=v*d,g=h.height*o;u.save(),u.scale(l,l),u.drawImage(h,m,g),u.strokeStyle="black",u.rect(m,g,v,p),u.stroke(),u.restore()}},t=0;e(r.eleDrawing,"node-body",t++),e(r.eleDrawing,"node-label",t++)}function wx(r,e,t,n,i){var a,o,s,u,l=Hu(r),c=l.pan,d=l.zoom;if(n===void 0||i===void 0){var f=eu(r,c,d,e,t),h=kt(f,2),v=h[0],p=h[1],m=6;a=v-m/2,o=p-m/2,s=m,u=m}else{var g=eu(r,c,d,e,t),y=kt(g,2),x=y[0],S=y[1],D=eu(r,c,d,n,i),P=kt(D,2),R=P[0],L=P[1];a=x,o=L,s=Math.abs(R-x),u=Math.abs(L-S)}if(s===0||u===0)return[];var O=r.data.contexts[r.WEBGL];O.bindFramebuffer(O.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(O.viewport(0,0,O.canvas.width,O.canvas.height),pv(r,null,Ra.PICKING),r.pickingFrameBuffer.needsDraw=!1);var I=s*u,B=new Uint8Array(I*4);O.readPixels(a,o,s,u,O.RGBA,O.UNSIGNED_BYTE,B),O.bindFramebuffer(O.FRAMEBUFFER,null);for(var w=new Set,T=0;T<I;T++){var E=B.slice(T*4,T*4+4),b=Jb(E)-1;b>=0&&w.add(b)}return w}function bx(r,e,t){var n=wx(r,e,t),i=r.getCachedZSortedEles(),a,o,s=Sr(n),u;try{for(s.s();!(u=s.n()).done;){var l=u.value,c=i[l];if(!a&&c.isNode()&&(a=c),!o&&c.isEdge()&&(o=c),a&&o)break}}catch(d){s.e(d)}finally{s.f()}return[a,o].filter(Boolean)}function pv(r,e,t){var n,i;r.webglDebug&&(i=[],n=performance.now());var a=r.eleDrawing,o=0;if(t.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&mx(r,e),r.data.canvasNeedsRedraw[r.NODE]||t.picking){var s=function(w,T){T+=1,w.isNode()?(a.drawTexture(w,T,"node-underlay"),a.drawTexture(w,T,"node-body"),a.drawTexture(w,T,"node-label"),a.drawTexture(w,T,"node-overlay")):(a.drawEdgeLine(w,T),a.drawEdgeArrow(w,T,"source"),a.drawEdgeArrow(w,T,"target"),a.drawTexture(w,T,"edge-label"))},u=r.data.contexts[r.WEBGL];t.screen?(u.clearColor(0,0,0,0),u.enable(u.BLEND),u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA)):u.disable(u.BLEND),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),u.viewport(0,0,u.canvas.width,u.canvas.height);var l=gx(r),c=r.getCachedZSortedEles();if(o=c.length,a.startFrame(l,i,t),t.screen){for(var d=0;d<c.nondrag.length;d++)s(c.nondrag[d],d);for(var f=0;f<c.drag.length;f++)s(c.drag[f],-1)}else if(t.picking)for(var h=0;h<c.length;h++)s(c[h],h);a.endFrame(),r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc()),t.screen&&r.webglDebugShowAtlases&&(yx(r),Cx(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),p=!0,m=0,g=0,y=Sr(i),x;try{for(y.s();!(x=y.n()).done;){var S=x.value;m++,g+=S.count}}catch(B){y.e(B)}finally{y.f()}var D=Math.ceil(v-n),P="".concat(o," elements, ").concat(g," rectangles, ").concat(m," batches");if(p)console.log("WebGL (".concat(t.name,") - ").concat(P));else{console.log("WebGL render (".concat(t.name,") - frame time ").concat(D,"ms")),console.log("  ".concat(P)),console.log("Texture Atlases Used:");var R=a.getAtlasDebugInfo(),L=Sr(R),O;try{for(L.s();!(O=L.n()).done;){var I=O.value;console.log("  ".concat(I.type,": ").concat(I.keyCount," keys, ").concat(I.atlasCount," atlases"))}}catch(B){L.e(B)}finally{L.f()}console.log("")}}}var $n={};$n.drawPolygonPath=function(r,e,t,n,i,a){var o=n/2,s=i/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*a[0],t+s*a[1]);for(var u=1;u<a.length/2;u++)r.lineTo(e+o*a[u*2],t+s*a[u*2+1]);r.closePath()};$n.drawRoundPolygonPath=function(r,e,t,n,i,a,o){o.forEach(function(s){return qh(r,s)}),r.closePath()};$n.drawRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,u=a==="auto"?oi(n,i):Math.min(a,s,o);r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.arcTo(e+o,t-s,e+o,t,u),r.arcTo(e+o,t+s,e,t+s,u),r.arcTo(e-o,t+s,e-o,t,u),r.arcTo(e-o,t-s,e,t-s,u),r.lineTo(e,t-s),r.closePath()};$n.drawBottomRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,u=a==="auto"?oi(n,i):a;r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.lineTo(e+o,t-s),r.lineTo(e+o,t),r.arcTo(e+o,t+s,e,t+s,u),r.arcTo(e-o,t+s,e-o,t,u),r.lineTo(e-o,t-s),r.lineTo(e,t-s),r.closePath()};$n.drawCutRectanglePath=function(r,e,t,n,i,a,o){var s=n/2,u=i/2,l=o==="auto"?Du():o;r.beginPath&&r.beginPath(),r.moveTo(e-s+l,t-u),r.lineTo(e+s-l,t-u),r.lineTo(e+s,t-u+l),r.lineTo(e+s,t+u-l),r.lineTo(e+s-l,t+u),r.lineTo(e-s+l,t+u),r.lineTo(e-s,t+u-l),r.lineTo(e-s,t-u+l),r.closePath()};$n.drawBarrelPath=function(r,e,t,n,i){var a=n/2,o=i/2,s=e-a,u=e+a,l=t-o,c=t+o,d=au(n,i),f=d.widthOffset,h=d.heightOffset,v=d.ctrlPtOffsetPct*f;r.beginPath&&r.beginPath(),r.moveTo(s,l+h),r.lineTo(s,c-h),r.quadraticCurveTo(s+v,c,s+f,c),r.lineTo(u-f,c),r.quadraticCurveTo(u-v,c,u,c-h),r.lineTo(u,l+h),r.quadraticCurveTo(u-v,l,u-f,l),r.lineTo(s+f,l),r.quadraticCurveTo(s+v,l,s,l+h),r.closePath()};var Af=Math.sin(0),Pf=Math.cos(0),mu={},yu={},gv=Math.PI/40;for(Qn=0*Math.PI;Qn<2*Math.PI;Qn+=gv)mu[Qn]=Math.sin(Qn),yu[Qn]=Math.cos(Qn);var Qn;$n.drawEllipsePath=function(r,e,t,n,i){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,n/2,i/2,0,0,2*Math.PI);else for(var a,o,s=n/2,u=i/2,l=0*Math.PI;l<2*Math.PI;l+=gv)a=e-s*mu[l]*Af+s*yu[l]*Pf,o=t+u*yu[l]*Af+u*mu[l]*Pf,l===0?r.moveTo(a,o):r.lineTo(a,o);r.closePath()};var Qa={};Qa.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};Qa.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),n=t.boundingBox(),i=this.findContainerClientCoords(),a=r.full?Math.ceil(n.w):i[2],o=r.full?Math.ceil(n.h):i[3],s=Ne(r.maxWidth)||Ne(r.maxHeight),u=this.getPixelRatio(),l=1;if(r.scale!==void 0)a*=r.scale,o*=r.scale,l=r.scale;else if(s){var c=1/0,d=1/0;Ne(r.maxWidth)&&(c=l*r.maxWidth/a),Ne(r.maxHeight)&&(d=l*r.maxHeight/o),l=Math.min(c,d),a*=l,o*=l}s||(a*=u,o*=u,l*=u);var f=document.createElement("canvas");f.width=a,f.height=o,f.style.width=a+"px",f.style.height=o+"px";var h=f.getContext("2d");if(a>0&&o>0){h.clearRect(0,0,a,o),h.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(r.full)h.translate(-n.x1*l,-n.y1*l),h.scale(l,l),this.drawElements(h,v),h.scale(1/l,1/l),h.translate(n.x1*l,n.y1*l);else{var p=e.pan(),m={x:p.x*l,y:p.y*l};l*=e.zoom(),h.translate(m.x,m.y),h.scale(l,l),this.drawElements(h,v),h.scale(1/l,1/l),h.translate(-m.x,-m.y)}r.bg&&(h.globalCompositeOperation="destination-over",h.fillStyle=r.bg,h.rect(0,0,a,o),h.fill())}return f};function xx(r,e){for(var t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function Rf(r){var e=r.indexOf(",");return r.substr(e+1)}function mv(r,e,t){var n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Ki(function(i,a){try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return xx(Rf(n()),t);case"base64":return Rf(n());case"base64uri":default:return n()}}Qa.png=function(r){return mv(r,this.bufferCanvasImage(r),"image/png")};Qa.jpg=function(r){return mv(r,this.bufferCanvasImage(r),"image/jpeg")};var yv={};yv.nodeShapeImpl=function(r,e,t,n,i,a,o,s){switch(r){case"ellipse":return this.drawEllipsePath(e,t,n,i,a);case"polygon":return this.drawPolygonPath(e,t,n,i,a,o);case"round-polygon":return this.drawRoundPolygonPath(e,t,n,i,a,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,n,i,a,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,n,i,a,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,n,i,a,s);case"barrel":return this.drawBarrelPath(e,t,n,i,a)}};var Ex=Cv,tt=Cv.prototype;tt.CANVAS_LAYERS=3;tt.SELECT_BOX=0;tt.DRAG=1;tt.NODE=2;tt.WEBGL=3;tt.CANVAS_TYPES=["2d","2d","2d","webgl2"];tt.BUFFER_COUNT=3;tt.TEXTURE_BUFFER=0;tt.MOTIONBLUR_BUFFER_NODE=1;tt.MOTIONBLUR_BUFFER_DRAG=2;function Cv(r){var e=this,t=e.cy.window(),n=t.document;r.webgl&&(tt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(tt.CANVAS_LAYERS),contexts:new Array(tt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(tt.CANVAS_LAYERS),bufferCanvases:new Array(tt.BUFFER_COUNT),bufferContexts:new Array(tt.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,o.position="relative",o.zIndex="0",o.overflow="hidden";var s=r.cy.container();s.appendChild(e.data.canvasContainer),s.style[i]=a;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};Gg()&&(u["-ms-touch-action"]="none",u["touch-action"]="none");for(var l=0;l<tt.CANVAS_LAYERS;l++){var c=e.data.canvases[l]=n.createElement("canvas"),d=tt.CANVAS_TYPES[l];e.data.contexts[l]=c.getContext(d),e.data.contexts[l]||Tt("Could not create canvas of type "+d),Object.keys(u).forEach(function(H){c.style[H]=u[H]}),c.style.position="absolute",c.setAttribute("data-id","layer"+l),c.style.zIndex=String(tt.CANVAS_LAYERS-l),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[l]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[tt.NODE].setAttribute("data-id","layer"+tt.NODE+"-node"),e.data.canvases[tt.SELECT_BOX].setAttribute("data-id","layer"+tt.SELECT_BOX+"-selectbox"),e.data.canvases[tt.DRAG].setAttribute("data-id","layer"+tt.DRAG+"-drag"),e.data.canvases[tt.WEBGL]&&e.data.canvases[tt.WEBGL].setAttribute("data-id","layer"+tt.WEBGL+"-webgl");for(var l=0;l<tt.BUFFER_COUNT;l++)e.data.bufferCanvases[l]=n.createElement("canvas"),e.data.bufferContexts[l]=e.data.bufferCanvases[l].getContext("2d"),e.data.bufferCanvases[l].style.position="absolute",e.data.bufferCanvases[l].setAttribute("data-id","buffer"+l),e.data.bufferCanvases[l].style.zIndex=String(-l-1),e.data.bufferCanvases[l].style.visibility="hidden";e.pathsEnabled=!0;var f=br(),h=function(k){return{x:(k.x1+k.x2)/2,y:(k.y1+k.y2)/2}},v=function(k){return{x:-k.w/2,y:-k.h/2}},p=function(k){var G=k[0]._private,$=G.oldBackgroundTimestamp===G.backgroundTimestamp;return!$},m=function(k){return k[0]._private.nodeKey},g=function(k){return k[0]._private.labelStyleKey},y=function(k){return k[0]._private.sourceLabelStyleKey},x=function(k){return k[0]._private.targetLabelStyleKey},S=function(k,G,$,te,q){return e.drawElement(k,G,$,!1,!1,q)},D=function(k,G,$,te,q){return e.drawElementText(k,G,$,te,"main",q)},P=function(k,G,$,te,q){return e.drawElementText(k,G,$,te,"source",q)},R=function(k,G,$,te,q){return e.drawElementText(k,G,$,te,"target",q)},L=function(k){return k.boundingBox(),k[0]._private.bodyBounds},O=function(k){return k.boundingBox(),k[0]._private.labelBounds.main||f},I=function(k){return k.boundingBox(),k[0]._private.labelBounds.source||f},B=function(k){return k.boundingBox(),k[0]._private.labelBounds.target||f},w=function(k,G){return G},T=function(k){return h(L(k))},E=function(k,G,$){var te=k?k+"-":"";return{x:G.x+$.pstyle(te+"text-margin-x").pfValue,y:G.y+$.pstyle(te+"text-margin-y").pfValue}},b=function(k,G,$){var te=k[0]._private.rscratch;return{x:te[G],y:te[$]}},C=function(k){return E("",b(k,"labelX","labelY"),k)},_=function(k){return E("source",b(k,"sourceLabelX","sourceLabelY"),k)},M=function(k){return E("target",b(k,"targetLabelX","targetLabelY"),k)},A=function(k){return v(L(k))},F=function(k){return v(I(k))},N=function(k){return v(B(k))},z=function(k){var G=O(k),$=v(O(k));if(k.isNode()){switch(k.pstyle("text-halign").value){case"left":$.x=-G.w-(G.leftPad||0);break;case"right":$.x=-(G.rightPad||0);break}switch(k.pstyle("text-valign").value){case"top":$.y=-G.h-(G.topPad||0);break;case"bottom":$.y=-(G.botPad||0);break}}return $},Y=e.data.eleTxrCache=new Ma(e,{getKey:m,doesEleInvalidateKey:p,drawElement:S,getBoundingBox:L,getRotationPoint:T,getRotationOffset:A,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),U=e.data.lblTxrCache=new Ma(e,{getKey:g,drawElement:D,getBoundingBox:O,getRotationPoint:C,getRotationOffset:z,isVisible:w}),ee=e.data.slbTxrCache=new Ma(e,{getKey:y,drawElement:P,getBoundingBox:I,getRotationPoint:_,getRotationOffset:F,isVisible:w}),Q=e.data.tlbTxrCache=new Ma(e,{getKey:x,drawElement:R,getBoundingBox:B,getRotationPoint:M,getRotationOffset:N,isVisible:w}),j=e.data.lyrTxrCache=new av(e);e.onUpdateEleCalcs(function(k,G){Y.invalidateElements(G),U.invalidateElements(G),ee.invalidateElements(G),Q.invalidateElements(G),j.invalidateElements(G);for(var $=0;$<G.length;$++){var te=G[$]._private;te.oldBackgroundTimestamp=te.backgroundTimestamp}});var K=function(k){for(var G=0;G<k.length;G++)j.enqueueElementRefinement(k[G].ele)};Y.onDequeue(K),U.onDequeue(K),ee.onDequeue(K),Q.onDequeue(K),r.webgl&&e.initWebgl(r,{getStyleKey:m,getLabelKey:g,drawElement:S,drawLabel:D,getElementBox:L,getLabelBox:O,getElementRotationPoint:T,getElementRotationOffset:A,getLabelRotationPoint:C,getLabelRotationOffset:z})}tt.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[tt.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[tt.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[tt.SELECT_BOX]=e;break;case"gc":t.data.gc=!0;break}};var Tx=typeof Path2D<"u";tt.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};tt.usePaths=function(){return Tx&&this.pathsEnabled};tt.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};tt.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};tt.makeOffscreenCanvas=function(r,e){var t;if((typeof OffscreenCanvas>"u"?"undefined":Vt(OffscreenCanvas))!=="undefined")t=new OffscreenCanvas(r,e);else{var n=this.cy.window(),i=n.document;t=i.createElement("canvas"),t.width=r,t.height=e}return t};[ov,nn,pn,ju,di,ia,dr,hv,$n,Qa,yv].forEach(function(r){Ye(tt,r)});var _x=[{name:"null",impl:Wh},{name:"base",impl:rv},{name:"canvas",impl:Ex}],Sx=[{type:"layout",extensions:lb},{type:"renderer",extensions:_x}],wv={},bv={};function xv(r,e,t){var n=t,i=function(L){ft("Can not register `"+e+"` for `"+r+"` since `"+L+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(ja.prototype[e])return i(e);ja.prototype[e]=t}else if(r==="collection"){if(Kt.prototype[e])return i(e);Kt.prototype[e]=t}else if(r==="layout"){for(var a=function(L){this.options=L,t.call(this,L),ut(this._private)||(this._private={}),this._private.cy=L.cy,this._private.listeners=[],this.createEmitter()},o=a.prototype=Object.create(t.prototype),s=[],u=0;u<s.length;u++){var l=s[u];o[l]=o[l]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var c=t.prototype.stop;o.stop=function(){var R=this.options;if(R&&R.animate){var L=this.animations;if(L)for(var O=0;O<L.length;O++)L[O].stop()}return c?c.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(L){return L._private.cy},f={addEventFields:function(L,O){O.layout=L,O.cy=d(L),O.target=L},bubble:function(){return!0},parent:function(L){return d(L)}};Ye(o,{createEmitter:function(){return this._private.emitter=new nl(f,this),this},emitter:function(){return this._private.emitter},on:function(L,O){return this.emitter().on(L,O),this},one:function(L,O){return this.emitter().one(L,O),this},once:function(L,O){return this.emitter().one(L,O),this},removeListener:function(L,O){return this.emitter().removeListener(L,O),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(L,O){return this.emitter().emit(L,O),this}}),dt.eventAliasesOn(o),n=a}else if(r==="renderer"&&e!=="null"&&e!=="base"){var h=Ev("renderer","base"),v=h.prototype,p=t,m=t.prototype,g=function(){h.apply(this,arguments),p.apply(this,arguments)},y=g.prototype;for(var x in v){var S=v[x],D=m[x]!=null;if(D)return i(x);y[x]=S}for(var P in m)y[P]=m[P];v.clientFunctions.forEach(function(R){y[R]=y[R]||function(){Tt("Renderer does not implement `renderer."+R+"()` on its prototype")}}),n=g}else if(r==="__proto__"||r==="constructor"||r==="prototype")return Tt(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return zf({map:wv,keys:[r,e],value:n})}function Ev(r,e){return Gf({map:wv,keys:[r,e]})}function Mx(r,e,t,n,i){return zf({map:bv,keys:[r,e,t,n],value:i})}function Dx(r,e,t,n){return Gf({map:bv,keys:[r,e,t,n]})}var Cu=function(){if(arguments.length===2)return Ev.apply(null,arguments);if(arguments.length===3)return xv.apply(null,arguments);if(arguments.length===4)return Dx.apply(null,arguments);if(arguments.length===5)return Mx.apply(null,arguments);Tt("Invalid extension access syntax")};ja.prototype.extension=Cu;Sx.forEach(function(r){r.extensions.forEach(function(e){xv(r.type,e.name,e.impl)})});var Tv=function r(){if(!(this instanceof r))return new r;this.length=0},ui=Tv.prototype;ui.instanceString=function(){return"stylesheet"};ui.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};ui.css=function(r,e){var t=this.length-1;if(Ue(r))this[t].properties.push({name:r,value:e});else if(ut(r))for(var n=r,i=Object.keys(n),a=0;a<i.length;a++){var o=i[a],s=n[o];if(s!=null){var u=ir.properties[o]||ir.properties[Xs(o)];if(u!=null){var l=u.name,c=s;this[t].properties.push({name:l,value:c})}}}return this};ui.style=ui.css;ui.generateStyle=function(r){var e=new ir(r);return this.appendToStyle(e)};ui.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],n=t.selector,i=t.properties;r.selector(n);for(var a=0;a<i.length;a++){var o=i[a];r.css(o.name,o.value)}}return r};var Ax="3.31.0",jr=function(e){if(e===void 0&&(e={}),ut(e))return new ja(e);if(Ue(e))return Cu.apply(Cu,arguments)};jr.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(jr),r.apply(null,e),this};jr.warnings=function(r){return qf(r)};jr.version=Ax;jr.stylesheet=jr.Stylesheet=Tv;var ap=po(_v());var to=Math.min,Wn=Math.max,ro=Math.round;var Hr=r=>({x:r,y:r}),Px={left:"right",right:"left",bottom:"top",top:"bottom"},Rx={start:"end",end:"start"};function Wu(r,e,t){return Wn(r,to(e,t))}function aa(r,e){return typeof r=="function"?r(e):r}function Yn(r){return r.split("-")[0]}function fl(r){return r.split("-")[1]}function hl(r){return r==="x"?"y":"x"}function Yu(r){return r==="y"?"height":"width"}function fi(r){return["top","bottom"].includes(Yn(r))?"y":"x"}function Xu(r){return hl(fi(r))}function Sv(r,e,t){t===void 0&&(t=!1);let n=fl(r),i=Xu(r),a=Yu(i),o=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=eo(o)),[o,eo(o)]}function Mv(r){let e=eo(r);return[dl(r),e,dl(e)]}function dl(r){return r.replace(/start|end/g,e=>Rx[e])}function Ox(r,e,t){let n=["left","right"],i=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return t?e?i:n:e?n:i;case"left":case"right":return e?a:o;default:return[]}}function Dv(r,e,t,n){let i=fl(r),a=Ox(Yn(r),t==="start",n);return i&&(a=a.map(o=>o+"-"+i),e&&(a=a.concat(a.map(dl)))),a}function eo(r){return r.replace(/left|right|bottom|top/g,e=>Px[e])}function Lx(r){return Pt({top:0,right:0,bottom:0,left:0},r)}function Av(r){return typeof r!="number"?Lx(r):{top:r,right:r,bottom:r,left:r}}function hi(r){let{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function Pv(r,e,t){let{reference:n,floating:i}=r,a=fi(e),o=Xu(e),s=Yu(o),u=Yn(e),l=a==="y",c=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,f=n[s]/2-i[s]/2,h;switch(u){case"top":h={x:c,y:n.y-i.height};break;case"bottom":h={x:c,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-i.width,y:d};break;default:h={x:n.x,y:n.y}}switch(fl(e)){case"start":h[o]-=f*(t&&l?-1:1);break;case"end":h[o]+=f*(t&&l?-1:1);break}return h}var Rv=(r,e,t)=>Et(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:o}=t,s=a.filter(Boolean),u=yield o.isRTL==null?void 0:o.isRTL(e),l=yield o.getElementRects({reference:r,floating:e,strategy:i}),{x:c,y:d}=Pv(l,n,u),f=n,h={},v=0;for(let p=0;p<s.length;p++){let{name:m,fn:g}=s[p],{x:y,y:x,data:S,reset:D}=yield g({x:c,y:d,initialPlacement:n,placement:f,strategy:i,middlewareData:h,rects:l,platform:o,elements:{reference:r,floating:e}});c=y??c,d=x??d,h=Yr(Pt({},h),{[m]:Pt(Pt({},h[m]),S)}),D&&v<=50&&(v++,typeof D=="object"&&(D.placement&&(f=D.placement),D.rects&&(l=D.rects===!0?yield o.getElementRects({reference:r,floating:e,strategy:i}):D.rects),{x:c,y:d}=Pv(l,f,u)),p=-1)}return{x:c,y:d,placement:f,strategy:i,middlewareData:h}});function qu(r,e){return Et(this,null,function*(){var t;e===void 0&&(e={});let{x:n,y:i,platform:a,rects:o,elements:s,strategy:u}=r,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=aa(e,r),v=Av(h),m=s[f?d==="floating"?"reference":"floating":d],g=hi(yield a.getClippingRect({element:(t=yield a.isElement==null?void 0:a.isElement(m))==null||t?m:m.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,x=yield a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating),S=(yield a.isElement==null?void 0:a.isElement(x))?(yield a.getScale==null?void 0:a.getScale(x))||{x:1,y:1}:{x:1,y:1},D=hi(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(g.top-D.top+v.top)/S.y,bottom:(D.bottom-g.bottom+v.bottom)/S.y,left:(g.left-D.left+v.left)/S.x,right:(D.right-g.right+v.right)/S.x}})}var Ov=function(r){return r===void 0&&(r={}),{name:"flip",options:r,fn(t){return Et(this,null,function*(){var n,i;let{placement:a,middlewareData:o,rects:s,initialPlacement:u,platform:l,elements:c}=t,b=aa(r,t),{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0}=b,g=Ml(b,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};let y=Yn(a),x=fi(u),S=Yn(u)===u,D=yield l.isRTL==null?void 0:l.isRTL(c.floating),P=h||(S||!m?[eo(u)]:Mv(u)),R=p!=="none";!h&&R&&P.push(...Dv(u,m,p,D));let L=[u,...P],O=yield qu(t,g),I=[],B=((i=o.flip)==null?void 0:i.overflows)||[];if(d&&I.push(O[y]),f){let C=Sv(a,s,D);I.push(O[C[0]],O[C[1]])}if(B=[...B,{placement:a,overflows:I}],!I.every(C=>C<=0)){var w,T;let C=(((w=o.flip)==null?void 0:w.index)||0)+1,_=L[C];if(_)return{data:{index:C,overflows:B},reset:{placement:_}};let M=(T=B.filter(A=>A.overflows[0]<=0).sort((A,F)=>A.overflows[1]-F.overflows[1])[0])==null?void 0:T.placement;if(!M)switch(v){case"bestFit":{var E;let A=(E=B.filter(F=>{if(R){let N=fi(F.placement);return N===x||N==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(N=>N>0).reduce((N,z)=>N+z,0)]).sort((F,N)=>F[1]-N[1])[0])==null?void 0:E[0];A&&(M=A);break}case"initialPlacement":M=u;break}if(a!==M)return{reset:{placement:M}}}return{}})}}};var Lv=function(r){return r===void 0&&(r={}),{name:"shift",options:r,fn(t){return Et(this,null,function*(){let{x:n,y:i,placement:a}=t,g=aa(r,t),{mainAxis:o=!0,crossAxis:s=!1,limiter:u={fn:y=>{let{x,y:S}=y;return{x,y:S}}}}=g,l=Ml(g,["mainAxis","crossAxis","limiter"]),c={x:n,y:i},d=yield qu(t,l),f=fi(Yn(a)),h=hl(f),v=c[h],p=c[f];if(o){let y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",S=v+d[y],D=v-d[x];v=Wu(S,v,D)}if(s){let y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",S=p+d[y],D=p-d[x];p=Wu(S,p,D)}let m=u.fn(Yr(Pt({},t),{[h]:v,[f]:p}));return Yr(Pt({},m),{data:{x:m.x-n,y:m.y-i,enabled:{[h]:o,[f]:s}}})})}}},Iv=function(r){return r===void 0&&(r={}),{options:r,fn(e){let{x:t,y:n,placement:i,rects:a,middlewareData:o}=e,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=aa(r,e),c={x:t,y:n},d=fi(i),f=hl(d),h=c[f],v=c[d],p=aa(s,e),m=typeof p=="number"?{mainAxis:p,crossAxis:0}:Pt({mainAxis:0,crossAxis:0},p);if(u){let x=f==="y"?"height":"width",S=a.reference[f]-a.floating[x]+m.mainAxis,D=a.reference[f]+a.reference[x]-m.mainAxis;h<S?h=S:h>D&&(h=D)}if(l){var g,y;let x=f==="y"?"width":"height",S=["top","left"].includes(Yn(i)),D=a.reference[d]-a.floating[x]+(S&&((g=o.offset)==null?void 0:g[d])||0)+(S?0:m.crossAxis),P=a.reference[d]+a.reference[x]+(S?0:((y=o.offset)==null?void 0:y[d])||0)-(S?m.crossAxis:0);v<D?v=D:v>P&&(v=P)}return{[f]:h,[d]:v}}}};function pl(){return typeof window<"u"}function vi(r){return kv(r)?(r.nodeName||"").toLowerCase():"#document"}function xr(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function an(r){var e;return(e=(kv(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function kv(r){return pl()?r instanceof Node||r instanceof xr(r).Node:!1}function Or(r){return pl()?r instanceof Element||r instanceof xr(r).Element:!1}function Ur(r){return pl()?r instanceof HTMLElement||r instanceof xr(r).HTMLElement:!1}function Nv(r){return!pl()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof xr(r).ShadowRoot}function oa(r){let{overflow:e,overflowX:t,overflowY:n,display:i}=Lr(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(i)}function Fv(r){return["table","td","th"].includes(vi(r))}function no(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function gl(r){let e=ml(),t=Or(r)?Lr(r):r;return["transform","translate","scale","rotate","perspective"].some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function Bv(r){let e=gn(r);for(;Ur(e)&&!pi(e);){if(gl(e))return e;if(no(e))return null;e=gn(e)}return null}function ml(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pi(r){return["html","body","#document"].includes(vi(r))}function Lr(r){return xr(r).getComputedStyle(r)}function io(r){return Or(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function gn(r){if(vi(r)==="html")return r;let e=r.assignedSlot||r.parentNode||Nv(r)&&r.host||an(r);return Nv(e)?e.host:e}function Vv(r){let e=gn(r);return pi(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ur(e)&&oa(e)?e:Vv(e)}function vl(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);let i=Vv(r),a=i===((n=r.ownerDocument)==null?void 0:n.body),o=xr(i);if(a){let s=yl(o);return e.concat(o,o.visualViewport||[],oa(i)?i:[],s&&t?vl(s):[])}return e.concat(i,vl(i,[],t))}function yl(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function jv(r){let e=Lr(r),t=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=Ur(r),a=i?r.offsetWidth:t,o=i?r.offsetHeight:n,s=ro(t)!==a||ro(n)!==o;return s&&(t=a,n=o),{width:t,height:n,$:s}}function Hv(r){return Or(r)?r:r.contextElement}function sa(r){let e=Hv(r);if(!Ur(e))return Hr(1);let t=e.getBoundingClientRect(),{width:n,height:i,$:a}=jv(e),o=(a?ro(t.width):t.width)/n,s=(a?ro(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!s||!Number.isFinite(s))&&(s=1),{x:o,y:s}}var Ix=Hr(0);function Uv(r){let e=xr(r);return!ml()||!e.visualViewport?Ix:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Nx(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==xr(r)?!1:e}function ao(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);let i=r.getBoundingClientRect(),a=Hv(r),o=Hr(1);e&&(n?Or(n)&&(o=sa(n)):o=sa(r));let s=Nx(a,t,n)?Uv(a):Hr(0),u=(i.left+s.x)/o.x,l=(i.top+s.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(a){let f=xr(a),h=n&&Or(n)?xr(n):n,v=f,p=yl(v);for(;p&&n&&h!==v;){let m=sa(p),g=p.getBoundingClientRect(),y=Lr(p),x=g.left+(p.clientLeft+parseFloat(y.paddingLeft))*m.x,S=g.top+(p.clientTop+parseFloat(y.paddingTop))*m.y;u*=m.x,l*=m.y,c*=m.x,d*=m.y,u+=x,l+=S,v=xr(p),p=yl(v)}}return hi({width:c,height:d,x:u,y:l})}function Zu(r,e){let t=io(r).scrollLeft;return e?e.left+t:ao(an(r)).left+t}function $v(r,e,t){t===void 0&&(t=!1);let n=r.getBoundingClientRect(),i=n.left+e.scrollLeft-(t?0:Zu(r,n)),a=n.top+e.scrollTop;return{x:i,y:a}}function kx(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r,a=i==="fixed",o=an(n),s=e?no(e.floating):!1;if(n===o||s&&a)return t;let u={scrollLeft:0,scrollTop:0},l=Hr(1),c=Hr(0),d=Ur(n);if((d||!d&&!a)&&((vi(n)!=="body"||oa(o))&&(u=io(n)),Ur(n))){let h=ao(n);l=sa(n),c.x=h.x+n.clientLeft,c.y=h.y+n.clientTop}let f=o&&!d&&!a?$v(o,u,!0):Hr(0);return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-u.scrollLeft*l.x+c.x+f.x,y:t.y*l.y-u.scrollTop*l.y+c.y+f.y}}function Fx(r){return Array.from(r.getClientRects())}function Bx(r){let e=an(r),t=io(r),n=r.ownerDocument.body,i=Wn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=Wn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),o=-t.scrollLeft+Zu(r),s=-t.scrollTop;return Lr(n).direction==="rtl"&&(o+=Wn(e.clientWidth,n.clientWidth)-i),{width:i,height:a,x:o,y:s}}function Vx(r,e){let t=xr(r),n=an(r),i=t.visualViewport,a=n.clientWidth,o=n.clientHeight,s=0,u=0;if(i){a=i.width,o=i.height;let l=ml();(!l||l&&e==="fixed")&&(s=i.offsetLeft,u=i.offsetTop)}return{width:a,height:o,x:s,y:u}}function zx(r,e){let t=ao(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,a=Ur(r)?sa(r):Hr(1),o=r.clientWidth*a.x,s=r.clientHeight*a.y,u=i*a.x,l=n*a.y;return{width:o,height:s,x:u,y:l}}function zv(r,e,t){let n;if(e==="viewport")n=Vx(r,t);else if(e==="document")n=Bx(an(r));else if(Or(e))n=zx(e,t);else{let i=Uv(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return hi(n)}function Wv(r,e){let t=gn(r);return t===e||!Or(t)||pi(t)?!1:Lr(t).position==="fixed"||Wv(t,e)}function Gx(r,e){let t=e.get(r);if(t)return t;let n=vl(r,[],!1).filter(s=>Or(s)&&vi(s)!=="body"),i=null,a=Lr(r).position==="fixed",o=a?gn(r):r;for(;Or(o)&&!pi(o);){let s=Lr(o),u=gl(o);!u&&s.position==="fixed"&&(i=null),(a?!u&&!i:!u&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||oa(o)&&!u&&Wv(r,o))?n=n.filter(c=>c!==o):i=s,o=gn(o)}return e.set(r,n),n}function jx(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r,o=[...t==="clippingAncestors"?no(e)?[]:Gx(e,this._c):[].concat(t),n],s=o[0],u=o.reduce((l,c)=>{let d=zv(e,c,i);return l.top=Wn(d.top,l.top),l.right=to(d.right,l.right),l.bottom=to(d.bottom,l.bottom),l.left=Wn(d.left,l.left),l},zv(e,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Hx(r){let{width:e,height:t}=jv(r);return{width:e,height:t}}function Ux(r,e,t){let n=Ur(e),i=an(e),a=t==="fixed",o=ao(r,!0,a,e),s={scrollLeft:0,scrollTop:0},u=Hr(0);if(n||!n&&!a)if((vi(e)!=="body"||oa(i))&&(s=io(e)),n){let f=ao(e,!0,a,e);u.x=f.x+e.clientLeft,u.y=f.y+e.clientTop}else i&&(u.x=Zu(i));let l=i&&!n&&!a?$v(i,s):Hr(0),c=o.left+s.scrollLeft-u.x-l.x,d=o.top+s.scrollTop-u.y-l.y;return{x:c,y:d,width:o.width,height:o.height}}function Ku(r){return Lr(r).position==="static"}function Gv(r,e){if(!Ur(r)||Lr(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return an(r)===t&&(t=t.ownerDocument.body),t}function Yv(r,e){let t=xr(r);if(no(r))return t;if(!Ur(r)){let i=gn(r);for(;i&&!pi(i);){if(Or(i)&&!Ku(i))return i;i=gn(i)}return t}let n=Gv(r,e);for(;n&&Fv(n)&&Ku(n);)n=Gv(n,e);return n&&pi(n)&&Ku(n)&&!gl(n)?t:n||Bv(r)||t}var $x=function(r){return Et(this,null,function*(){let e=this.getOffsetParent||Yv,t=this.getDimensions,n=yield t(r.floating);return{reference:Ux(r.reference,yield e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function Wx(r){return Lr(r).direction==="rtl"}var Yx={convertOffsetParentRelativeRectToViewportRelativeRect:kx,getDocumentElement:an,getClippingRect:jx,getOffsetParent:Yv,getElementRects:$x,getClientRects:Fx,getDimensions:Hx,getScale:sa,isElement:Or,isRTL:Wx};var Xv=Lv,qv=Ov;var Kv=Iv,Zv=(r,e,t)=>{let n=new Map,i=Pt({platform:Yx},t),a=Yr(Pt({},i.platform),{_c:n});return Rv(r,e,Yr(Pt({},i),{platform:a}))};var tp={position:"absolute",left:"0",top:"0",userSelect:"none",outlineStyle:"none",width:"100%",height:"100%"};function Cl(r){r.stopPropagation()}function lo(r){r.addEventListener("click",Cl),r.addEventListener("mousedown",Cl),r.addEventListener("mouseup",Cl),r.addEventListener("mousemove",Cl)}var oo=class{constructor(e){this.adapter=e,this.updateOnRenderEnabled=!1,this.updateOnRenderOnceEnabled=!1,this.updateOnRenderOnce=()=>{this.updateOnRenderOnceEnabled||(this.updateOnRenderOnceEnabled=!0,this.cy.one("render",()=>{this.updateOnRenderOnceEnabled=!1,this.update()}))}}inVisibleBounds(e){return this.adapter.inVisibleBounds(e)}supportsRender(){return!1}renderInto(e){}get updateOnRender(){return this.updateOnRenderEnabled}set updateOnRender(e){this.updateOnRenderEnabled!==e&&(this.updateOnRenderEnabled=e,e?this.cy.on("render",this.update):this.cy.off("render",this.update))}get cy(){return this.adapter.cy}moveUp(){this.adapter.move(this,-1)}moveDown(){this.adapter.move(this,1)}moveBack(){this.adapter.move(this,Number.NEGATIVE_INFINITY)}moveFront(){this.adapter.move(this,Number.POSITIVE_INFINITY)}insertBefore(e,t){return this.adapter.insert("before",this,e,t)}insertAfter(e,t){return this.adapter.insert("after",this,e,t)}},la=class extends oo{constructor(e,t){super(e),this.callbacks=[],this.update=()=>{for(let n of this.callbacks)n(this.node)},this.root=t,Object.assign(this.root.style,tp)}get visible(){return this.root.style.display!=="none"}set visible(e){this.visible!==e&&(this.root.style.display=e?"":"none")}show(){this.visible=!0}hide(){this.visible=!1}callback(e){return this.callbacks.push(e),this.update(),this}resize(){}remove(){this.root.remove()}},so="http://www.w3.org/2000/svg",Qu=class extends la{constructor(e,t,n={}){super(e,t.createElementNS(so,"svg")),this.type="svg",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElementNS(so,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&lo(this.node)}setViewport(e,t,n){this.node.setAttribute("transform",`translate(${e},${t})scale(${n})`),this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},Ju=class extends la{constructor(e,t,n={}){super(e,t.createElementNS(so,"svg")),this.type="svg-static",this.root.__cy_layer=this,this.node=t.createElementNS(so,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&lo(this.node)}setViewport(){}},bl=class extends oo{constructor(e,t,n={}){var i,a;super(e),this.callbacks=[],this.transform={tx:0,ty:0,zoom:1},this.update=()=>this.draw(),this.node=t.createElement("canvas"),Object.assign(this.node.style,tp),n.stopClicks&&lo(this.node),this.pixelRatio=(a=(i=n.pixelRatio)!==null&&i!==void 0?i:(window??{}).devicePixelRatio)!==null&&a!==void 0?a:1,this.ctx=this.node.getContext("2d",n),this.ctx.resetTransform()}get visible(){return this.node.style.display!=="none"}set visible(e){this.node.style.display=e?"":"none"}show(){this.visible=!0}hide(){this.visible=!1}get root(){return this.node}callback(e){return this.callbacks.push(e),this.update(),this}clear(){let e=this.ctx,t=e.getTransform();e.resetTransform(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.setTransform(t)}draw(){this.clear(),this.drawImpl(this.ctx)}drawImpl(e,t=1){e.save(),e.resetTransform(),e.scale(this.pixelRatio,this.pixelRatio),e.translate(this.transform.tx*t,this.transform.ty*t),e.scale(this.transform.zoom*t,this.transform.zoom*t);for(let n of this.callbacks)n(e,{});e.restore()}supportsRender(){return!0}renderInto(e){for(let t of this.callbacks)t(e,{forExport:!0})}resize(e,t){this.node.width=e*this.pixelRatio,this.node.height=t*this.pixelRatio,this.update()}setViewport(e,t,n){}remove(){this.node.remove()}},xl=class extends bl{constructor(e,t,n={}){super(e,t,n),this.type="canvas",this.node.__cy_layer=this}setViewport(e,t,n){this.transform.tx=e,this.transform.ty=t,this.transform.zoom=n,this.update()}},ec=class extends bl{constructor(e,t,n={}){super(e,t,n),this.type="canvas-static",this.node.__cy_layer=this}},tc=class extends la{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElement("div"),this.node.__cy_layer=this,this.node.style.position="absolute",this.node.style.left="0px",this.node.style.top="0px",this.root.appendChild(this.node),n.stopClicks&&lo(this.node)}setViewport(e,t,n){this.node.style.transform=`translate(${e}px,${t}px)scale(${n})`,this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},rc=class extends la{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html-static",this.node.__cy_layer=this,n.stopClicks&&lo(this.node)}get node(){return this.root}setViewport(){}},ua=class extends oo{constructor(e,t){super(e),this.update=()=>{},this.node=t}get root(){return this.node}resize(){}setViewport(){}remove(){}supportsRender(){return!0}},nc=class extends ua{constructor(e,t){super(e,t),this.type="node",this.node.__cy_layer=this}},ic=class extends ua{constructor(e,t){super(e,t),this.type="drag",this.node.__cy_layer=this}},ac=class extends ua{constructor(e,t){super(e,t),this.type="select-box",this.node.__cy_layer=this}};function Qv(r,e,t){let n=Array.from(r.children);if(!t.uniqueElements){e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(t.isVisible(s))if(n.length>0)t.update(n.shift(),o,s);else{let u=t.enter(o,s);r.appendChild(u),t.update(u,o,s)}});for(let o of n)o.remove();return}let i=new Map(n.map(o=>[o.dataset.id,o])),a=-1;e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(!t.isVisible(s))return;a++;let u=o.id(),l=n[a],c=i.get(u),d;if(c){if(t.update(c,o,s),i.delete(u),l===c)return;d=c}else d=t.enter(o,s),d.dataset.id=u,t.update(d,o,s);a===0?r.insertAdjacentElement("afterbegin",d):n[a-1].insertAdjacentElement("afterend",d),n.splice(a,0,d)}),i.forEach(o=>o.remove())}function wl(r,e){return r.callback(e),{remove:()=>{r.callbacks.splice(r.callbacks.indexOf(e),1)}}}function rp(r){return{selector:":visible",updateOn:r!=null&&r.queryEachTime?"render":"position",queryEachTime:!1,checkBounds:!0}}function Xx(r,e,t){let n=Object.assign({checkBoundsPointCount:5,initCollection:()=>{}},rp(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=c=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(c.off(n.updateOn,void 0,r.updateOnRenderOnce),c.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),c.targets().off(n.updateOn,void 0,r.updateOnRenderOnce));let d=r.cy.edges(n.selector);return n.initCollection(d),n.updateOn!=="none"&&n.updateOn!=="render"&&(d.on(n.updateOn,r.updateOnRenderOnce),d.sources().on(n.updateOn,r.updateOnRenderOnce),d.targets().on(n.updateOn,r.updateOnRenderOnce)),r.updateOnRenderOnce(),d};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let l=wl(r,(c,d)=>{n.queryEachTime&&(i=s(i)),i.forEach(f=>{if(f.removed())return;let h=f._private.rscratch,v=h&&h.startX!=null&&h.startY!=null?{x:h.startX,y:h.startY}:f.sourceEndpoint(),p=h&&h.endX!=null&&h.endY!=null?{x:h.endX,y:h.endY}:f.targetEndpoint();if(!d.forExport&&n.checkBounds&&n.checkBoundsPointCount>0&&!qx(r,v,p,n.checkBoundsPointCount))return;if(h&&h.pathCache){e(c,f,h.pathCache,v,p);return}let m=new Path2D;m.moveTo(v.x,v.y),m.lineTo(p.x,p.y),e(c,f,m,v,p)})});return{layer:r,edges:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(i.off(n.updateOn,void 0,r.updateOnRenderOnce),i.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),i.targets().off(n.updateOn,void 0,r.updateOnRenderOnce)),r.cy.off("add remove",n.selector,o),l.remove()}}}function qx(r,e,t,n){let i=o=>({x:e.x*o+t.x*(1-o),y:e.y*o+t.y*(1-o)});if(n===1)return r.inVisibleBounds(i(.5));let a=1/n;for(let o=0;o<=n;o++)if(r.inVisibleBounds(i(o*a)))return!0;return!1}function Kx(r,e,t={}){let n=Object.assign({transform:"",position:"top-left",boundingBox:{includeLabels:!1,includeOverlays:!1},uniqueElements:!1,initCollection:()=>{}},rp(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=h=>{n.updateOn!=="none"&&n.updateOn!=="render"&&h.off(n.updateOn,void 0,r.updateOnRenderOnce);let v=r.cy.nodes(n.selector);return n.initCollection(v),n.updateOn!=="none"&&n.updateOn!=="render"&&v.on(n.updateOn,r.updateOnRenderOnce),r.updateOnRenderOnce(),v};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let u=h=>({layer:r,nodes:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&i.off(n.updateOn,void 0,r.updateOnRenderOnce),r.cy.off("add remove",n.selector,o),h.remove()}});if(r.type==="canvas"){let h=n;return u(wl(r,(p,m)=>{let g=p.getTransform();n.queryEachTime&&(i=s(i)),i.forEach(y=>{if(y.removed())return;let x=y.boundingBox(n.boundingBox);if(!(!m.forExport&&h.checkBounds&&!r.inVisibleBounds(x))){if(h.position==="top-left")p.translate(x.x1,x.y1);else if(h.position==="center"){let S=y.position();p.translate(S.x,S.y)}e(p,y,x),h.position!=="none"&&p.setTransform(g)}})}))}let l=n,c={bb:h=>h.boundingBox(l.boundingBox),isVisible:l.checkBounds?h=>r.inVisibleBounds(h):()=>!0,uniqueElements:l.uniqueElements===!0};if(l.checkBounds&&(r.updateOnTransform=!0),r.type==="html"){let h=Yr(Pt({},c),{enter:(p,m)=>{let g=r.node.ownerDocument.createElement("div");return g.style.position="absolute",l.init&&l.init(g,p,m),g},update:(p,m,g)=>{if(l.position==="top-left")p.style.transform=`${l.transform}translate3d(${g.x1}px,${g.y1}px,0)`;else if(l.position==="center"){let y=m.position();p.style.transform=`${l.transform}translate3d(${y.x}px,${y.y}px,0)`}e(p,m,g)}});return u(wl(r,p=>{n.queryEachTime&&(i=s(i)),Qv(p,i,h)}))}let d=Yr(Pt({},c),{enter:(h,v)=>{let p=r.node.ownerDocument.createElementNS(so,"g");return l.init&&l.init(p,h,v),p},update:(h,v,p)=>{if(l.position==="top-left")h.setAttribute("transform",`${l.transform}translate3d(${p.x1},${p.y1},0)`);else if(l.position==="center"){let m=v.position();h.setAttribute("transform",`${l.transform}translate3d(${m.x},${m.y},0)`)}e(h,v,p)}});return u(wl(r,h=>{n.queryEachTime&&(i=s(i)),Qv(h,i,d)}))}function Zx(r,e){let t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function Jv(r){let e=r.indexOf(",");return r.substring(e+1)}function ep(r,e,t){let n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Promise((i,a)=>{try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return Zx(Jv(n()),t);case"base64":return Jv(n());case"base64uri":default:return n()}}function Qx(r){return r.x!=null}var El=class extends Error{},oc=class{constructor(e){this.bak={},this.resize=()=>{let o=this.cy.width(),s=this.cy.height();this.viewport.width=o,this.viewport.height=s;for(let u of this.layers)u.resize(o,s)},this.destroy=()=>{for(let o of this.layers)o.remove();this.cy.off("destroy",this.destroy),this.cy.off("viewport",this.zoomed),this.cy.off("resize",this.resize),this.cy.scratch("_layers",void 0),this.cy.png=this.bak.png,this.cy.jpg=this.bak.jpg,this.cy.jpeg=this.bak.jpeg,this.bak={}},this.zoomed=()=>{let o=this.cy.pan(),s=this.cy.zoom();this.viewport.tx=o.x,this.viewport.ty=o.y,this.viewport.zoom=s;for(let u of this.layers)u.setViewport(o.x,o.y,s)},this.renderPerEdge=Xx,this.renderPerNode=Kx,this.cy=e,this.adapter={cy:this.cy,insert:(o,s,u)=>this.insert(o,s,u),move:(o,s)=>this.move(o,s),inVisibleBounds:o=>{let s=this.viewport,u=c=>{let d=c*s.zoom+s.tx;return d>=0&&d<=s.width},l=c=>{let d=c*s.zoom+s.ty;return d>=0&&d<=s.height};return Qx(o)?u(o.x)&&l(o.y):u(o.x1)&&l(o.y1)||u(o.x2)&&l(o.y1)||u(o.x2)&&l(o.y2)||u(o.x1)&&l(o.y2)||u((o.x1+o.x2)/2)&&l((o.y1+o.y2)/2)}};let t=e.container(),n=new nc(this.adapter,t.querySelector('[data-id="layer2-node"]'));this.nodeLayer=n;let i=new ic(this.adapter,t.querySelector('[data-id="layer1-drag"]'));this.dragLayer=i;let a=new ac(this.adapter,t.querySelector('[data-id="layer0-selectbox"]'));this.selectBoxLayer=a,n.root.style.zIndex="",i.root.style.zIndex="",a.root.style.zIndex="",n.root.insertAdjacentElement("afterend",i.root),i.root.insertAdjacentElement("afterend",a.root),e.on("viewport",this.zoomed),e.on("resize",this.resize),e.on("destroy",this.destroy),this.bak={png:e.png,jpg:e.jpg,jpeg:e.jpeg},e.png=this.png.bind(this),e.jpg=this.jpg.bind(this),e.jpeg=this.jpeg.bind(this),this.viewport={width:this.cy.width(),height:this.cy.height(),tx:this.cy.pan().x,ty:this.cy.pan().y,zoom:this.cy.zoom()}}move(e,t){let n=this.layers,i=n.indexOf(e),a=Math.max(Math.min(i+t,n.length,0));a!==i&&(i>=n.length-1?this.root.appendChild(e.root):this.root.insertBefore(e.root,n[a].root))}get document(){return this.cy.container().ownerDocument}get root(){return this.nodeLayer.node.parentElement}get layers(){return Array.from(this.root.children).map(e=>e.__cy_layer).filter(e=>e!=null)}getLayers(){return this.layers}init(e){return e.resize(this.viewport.width,this.viewport.height),e.setViewport(this.viewport.tx,this.viewport.ty,this.viewport.zoom),e}update(){this.zoomed();for(let e of this.layers)e instanceof xl&&e.draw()}createLayer(e,t){switch(e){case"svg":return this.init(new Qu(this.adapter,this.document,t));case"html":return this.init(new tc(this.adapter,this.document,t));case"canvas":return this.init(new xl(this.adapter,this.document,t));case"html-static":return this.init(new rc(this.adapter,this.document,t));case"svg-static":return this.init(new Ju(this.adapter,this.document,t));case"canvas-static":return this.init(new ec(this.adapter,this.document,t))}}append(e,t){let n=this.createLayer(e,t);return this.root.appendChild(n.root),n}insert(e,t,n,i){let a=this.createLayer(n,i);return t.root.insertAdjacentElement(e==="before"?"beforebegin":"afterend",a.root),a}getLast(){var e;let t=this.layers;return(e=t[t.length-1])!==null&&e!==void 0?e:null}getFirst(){var e;return(e=this.layers[0])!==null&&e!==void 0?e:null}hasCustomLayer(){return this.layers.some(e=>!(e instanceof ua))}toCanvas(e){let t=this.layers;if(t.some(d=>!d.supportsRender)&&!e.ignoreUnsupportedLayers)throw new El("some layer doesn't support exporting, use {ignoreUnsupportedLayers: true} option to ignore");let n=t.indexOf(this.nodeLayer),i=t.indexOf(this.dragLayer),a=t.indexOf(this.selectBoxLayer);if((n!==i-1||i!==a-1)&&!e.ignoreUnsupportedLayerOrder)throw new El("cytoscape layers are not in order, use {ignoreUnsupportedLayerOrder: true} option to ignore");let o=t.slice(0,n).reverse().filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),s=t.slice(n+1).filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),u=this.cy.renderer(),l=u.drawElements;u.drawElements=function(d,f){for(let h of o)h.renderInto(d);l.call(this,d,f);for(let h of s)h.renderInto(d)};let c=u.bufferCanvasImage(e);return u.drawElements=l,c}png(e){return this.hasCustomLayer()?ep(e??{},this.toCanvas(e??{}),"image/png"):this.bak.png.call(this.cy,e)}jpg(e){if(!this.hasCustomLayer())return this.bak.jpg.call(this.cy,e);let t=Pt({bg:"#fff"},e??{});return ep(t,this.toCanvas(t),"image/png")}jpeg(e){return this.hasCustomLayer()?this.jpg(e):this.bak.jpeg.call(this.cy,e)}};function Jx(r=this){if(!r.container())throw new Error("layers plugin does not work in headless environments");let e=r.scratch("_layers");if(e)return e;let t=new oc(r);return r.scratch("_layers",t),t}function sc(r){r("core","layers",Jx)}typeof window.cytoscape<"u"&&sc(window.cytoscape);var op=po(np());var ip=(()=>{class r{constructor(t,n){this.dialogRef=t,this.fb=n,this.form=this.fb.group({log2fc:[0],pvalue:[0]}),this.filter=mo}close(){this.dialogRef.close()}submit(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot),Le(Ut))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-cytoscape-plot-filter-dialog"]],decls:17,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","type","number","formControlName","log2fc"],["matInput","","type","number","formControlName","pvalue"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(X(0,"h5",0),se(1,"Filter Cytoscape Plot"),J(),X(2,"div",1)(3,"form",2)(4,"mat-form-field"),Be(5,"input",3),X(6,"mat-label"),se(7,"Absolute Log2 Fold Change"),J()(),X(8,"mat-form-field"),Be(9,"input",4),X(10,"mat-label"),se(11,"-log10(P Value)"),J()()()(),X(12,"div",5)(13,"button",6),ye("click",function(){return i.close()}),se(14,"Cancel"),J(),X(15,"button",6),ye("click",function(){return i.submit()}),se(16,"Filter"),J()()),n&2&&(ae(3),De("formGroup",i.form))},dependencies:[Lt,It,rr,tr,Jt,Oo,St,er,gr,mr,$t,nr,Nt,xt,yr],encapsulation:2})}}return r})();var e2=["cy"];function t2(r,e,t){let n=Pt({middleware:[qv(),Xv({limiter:Kv()})]},t);function i(){let a=r.getBoundingClientRect();Zv(r,e,n).then(({x:o,y:s})=>Object.assign(e.style,{left:`${a.left}px`,top:`${s}px`,position:"absolute",transform:"translate(-50%, -50%)","background-color":"#333",color:"#fff",padding:"5px 10px","border-radius":"4px","font-size":"12px","box-shadow":"0 2px 10px rgba(0, 0, 0, 0.2)","pointer-events":"none"}))}return i(),{update:i}}var sp=(()=>{class r{constructor(t,n,i){this.collateService=t,this.cdr=n,this.dialog=i,this.showBarChart=!0,this.showCytoscapePlot=!1,this.projects=[],this.searchResultsMap={},this.renameCondition={},this.currentPopperRef=null,this.currentTooltip=null,this.barChartLayers=new Map,this.projectColorMap={},this.cytoscapeElements=[]}ngAfterViewInit(){jr.use(op.default),jr.use((0,ap.default)(t2)),jr.use(sc),this.initCytoscape(),this.collateService.collateRedrawSubject.subscribe(()=>{this.updateCytoscape()})}updateCytoscape(){this.cdr.detectChanges(),this.cy.destroy(),this.initCytoscape()}initCytoscape(){if(this.cyElement){let t=this.buildGraphElements();this.cytoscapeElements=t,this.cy=jr({container:this.cyElement.nativeElement,elements:t,style:[{selector:"node",style:{label:"data(label)","background-color":"#666",width:"data(size)",height:"data(size)"}},{selector:".protein",style:{"background-color":"#FF5733"}},{selector:".analysis",style:{"background-color":"#ba0000",label:""}},{selector:".comparison",style:{"background-color":"#33A1FF",label:""}},{selector:"edge[color]",style:{width:2,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"triangle","curve-style":"bezier","control-point-step-size":40}}],layout:{name:"fcose",animate:!0,animationDuration:1e3,padding:30,nodeSeparation:200,idealEdgeLength:100,nodeRepulsion:4500,edgeElasticity:.45,gravity:.25,numIter:2500,tile:!0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.5}}),this.cy.nodes(".comparison").forEach(i=>{i.on("mouseover",a=>{let s=a.target.data().label;this.currentPopperRef=a.target.popper({content:()=>{let u=document.createElement("div");return u.classList.add("cy-tooltip"),u.innerHTML=s,document.body.appendChild(u),this.currentTooltip=u,u},popper:{placement:"bottom",removeOnDestroy:!0}})}),i.on("mouseout",()=>{this.currentTooltip&&(document.body.removeChild(this.currentTooltip),this.currentTooltip=null)}),i.on("click",a=>{let o=a.target,s=o.style("label");o.style("label",s?"":o.data("label"))})});let n=this.cy.layers();this.cy.edges().forEach(i=>{i.on("click",s=>{let u=s.target,l=u.data("showBarChart");u.data("showBarChart",!l),this.drawBarChartOnEdges(n),this.cy.batch(()=>{this.cy.nodes().forEach(c=>{c.trigger("position")})})}),i.on("mouseover",s=>{let u=s.target.data(),l=`Comparison: ${u.conditionA} vs ${u.conditionB}<br>Project: ${u.project}<br>Analysis Group: ${u.analysis_group} <br>Log2FC: ${u.fc}<br>-Log10(p): ${u.p_value}<br> Intensity ${u.conditionA}: ${u.intensityA}<br>Intensity ${u.conditionB}: ${u.intensityB}`;this.currentPopperRef=s.target.popper({content:()=>{let c=document.createElement("div");return c.classList.add("cy-tooltip"),c.innerHTML=l,document.body.appendChild(c),this.currentTooltip=c,c},popper:{placement:"bottom",removeOnDestroy:!0}})}),i.on("mouseout",()=>{this.currentTooltip&&(document.body.removeChild(this.currentTooltip),this.currentTooltip=null)});let a=!1,o={x:0,y:0};i.on("mousedown",s=>{a=!0,o=s.position}),this.cy.on("mousemove",s=>{if(a){let u=s.position;i.data("barChartPos",u),this.cy.trigger("render")}}),this.cy.on("mouseup",()=>{a=!1})})}}drawBarChartOnEdges(t){t.renderPerEdge(t.nodeLayer.insertAfter("canvas"),(n,i,a,o,s)=>{!this.showBarChart||!i.data("showBarChart")||this.renderBarChart(i,o,s,n)})}renderBarChart(t,n,i,a){let o=t.data(),s=parseFloat(o.intensityA),u=parseFloat(o.intensityB),l=5,c=25,d=Math.max(s,u),f=s/d*c,h=u/d*c,v=o.barChartPos||{x:(n.x+i.x)/2,y:(n.y+i.y)/2},p=t.source().position(),m=t.target().position(),g=Math.sqrt(Math.pow(m.x-p.x,2)+Math.pow(m.y-p.y,2)),y=((v.x-p.x)*(m.x-p.x)+(v.y-p.y)*(m.y-p.y))/Math.pow(g,2),x=p.x+y*(m.x-p.x)-l,S=p.y+y*(m.y-p.y)+c;a.fillStyle="white",a.fillRect(x-l-2,S-c-3,l*2+6,c+5),a.strokeStyle="black",a.strokeRect(x-l-2,S-c-3,l*2+6,c+5),a.fillStyle="red",a.fillRect(x-l,S-f,l,f),a.fillStyle="blue",a.fillRect(x+2,S-h,l,h)}buildGraphElements(){let t=[],n=new Set,i={};return console.log(this.searchResultsMap),this.projects.forEach(a=>{let o=this.searchResultsMap[a.id]||[];i[a.id]||(i[a.id]=`#${Math.floor(Math.random()*16777215).toString(16)}`);let s=i[a.id];o.forEach(u=>{let l=u.gene_name||u.uniprot_id||u.primary_id;n.has(l)||(t.push({data:{id:l,label:l,size:25},classes:"protein"}),n.add(l));let c=u.condition_A,d=u.condition_B;this.renameCondition[a.id]&&(this.renameCondition[a.id][u.condition_A]&&(c=this.renameCondition[a.id][u.condition_A]),this.renameCondition[a.id][u.condition_B]&&(d=this.renameCondition[a.id][u.condition_B]));let f=`${c} vs ${d}`;n.has(f)||(t.push({data:{id:f,label:`${c} vs ${d}`,size:25},classes:"comparison"}),n.add(f));let h=u.searched_data.filter(g=>g.Condition===u.condition_A&&g.Value),v=u.searched_data.filter(g=>g.Condition===u.condition_B&&g.Value),p=0,m=0;h.length>0&&(p=h.reduce((g,y)=>g+y.Value,0)/h.length),v.length>0&&(m=v.reduce((g,y)=>g+y.Value,0)/v.length),t.push({data:{id:`${l}-${f}-${a.id}-${u.analysis_group.id}`,source:l,target:f,color:s,conditionA:c,conditionB:d,intensityA:p,intensityB:m,analysis_group:u.analysis_group.name,project:a.name,fc:u.log2_fc,p_value:u.log10_p}})})}),this.projectColorMap=i,t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot}toggleBarChart(){this.showBarChart=!this.showBarChart,this.updateCytoscape()}getRandomColor(){return`#${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`}getProjectColor(t){return this.projectColorMap[t]||"#000000"}toggleAllComparisons(t,n){this.cy.nodes(n).forEach(i=>{t?i.style("label",i.data("label")):i.style("label","")})}resetZoomAndCenter(){this.cy.fit(),this.cy.center()}openFilterDialog(){this.dialog.open(ip).afterClosed().subscribe(n=>{n&&this.applyFilter(n.log2fc,n.pvalue)})}applyFilter(t,n){let i=this.cytoscapeElements.filter(c=>{if(c.data.fc!==void 0&&c.data.p_value!==void 0){let d=Math.abs(c.data.fc),f=Math.abs(t);return d>=f&&c.data.p_value>=n}return!0}),a=i.filter(c=>c.data.source!==void 0&&c.data.target!==void 0),o=new Set(a.map(c=>c.data.source).concat(a.map(c=>c.data.target))),s=new Set(a.map(c=>c.data.id)),u=i.filter(c=>o.has(c.data.id)),l=new Set(u.map(c=>c.data.id));this.cy.batch(()=>{let c=[];this.cy.edges().forEach(d=>{let f=d.data();s.has(f.id)?c.push(d):d.remove()}),this.cy.nodes().forEach(d=>{let f=d.data();l.has(f.id)?c.push(d):d.remove()}),this.cy.add(c)}),this.cy.layout({name:"fcose",animate:!0,animationDuration:1e3}).run()}static{this.\u0275fac=function(n){return new(n||r)(Le(qr),Le(En),Le(_n))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-cytoscape-plot"]],viewQuery:function(n,i){if(n&1&&bi(e2,5),n&2){let a;xi(a=Ei())&&(i.cyElement=a.first)}},inputs:{projects:"projects",searchResultsMap:"searchResultsMap",renameCondition:"renameCondition"},decls:25,vars:2,consts:[["labelOn",""],["labelOff",""],["cy",""],[2,"display","flex"],["matTooltip","Toggle on labels","mat-icon-button","",3,"matMenuTriggerFor"],["matTooltip","Toggle off labels","mat-icon-button","",3,"matMenuTriggerFor"],["matTooltip","Reset and center plot","mat-icon-button","",3,"click"],["matTooltip","Filter Cytoscape Plot","mat-icon-button","",3,"click"],["mat-menu-item","",3,"click"],[1,"cy-container"]],template:function(n,i){if(n&1){let a=We();X(0,"div",3)(1,"button",4)(2,"mat-icon"),se(3,"label"),J()(),X(4,"button",5)(5,"mat-icon"),se(6,"label_off"),J()(),X(7,"button",6),ye("click",function(){return Ae(a),Pe(i.resetZoomAndCenter())}),X(8,"mat-icon"),se(9,"center_focus_strong"),J()(),X(10,"button",7),ye("click",function(){return Ae(a),Pe(i.openFilterDialog())}),X(11,"mat-icon"),se(12,"filter_list"),J()()(),X(13,"mat-menu",null,0)(15,"button",8),ye("click",function(){return Ae(a),Pe(i.toggleAllComparisons(!0,".comparison"))}),X(16,"span"),se(17,"Comparison"),J()()(),X(18,"mat-menu",null,1)(20,"button",8),ye("click",function(){return Ae(a),Pe(i.toggleAllComparisons(!1,".comparison"))}),X(21,"span"),se(22,"Comparison"),J()()(),Be(23,"div",9,2)}if(n&2){let a=fr(14),o=fr(19);ae(),De("matMenuTriggerFor",a),ae(3),De("matMenuTriggerFor",o)}},dependencies:[Qt,Xr,Mi,Ai,Di,Pi],styles:[`.cy-container{width:100%;height:600px;border:1px solid #ccc}.edge-hover{transition:stroke-width .3s,stroke .3s;stroke-width:4px!important;stroke:red!important}.legend{position:absolute;bottom:10px;right:10px;background-color:#fffc;padding:10px;border-radius:5px;box-shadow:0 2px 10px #0003}.legend-color{display:inline-block;width:20px;height:20px;margin-right:5px;vertical-align:middle}
`],encapsulation:2})}}return r})();function r2(r,e){if(r&1&&(X(0,"mat-option",4),se(1),J()),r&2){let t=e.$implicit;_o("value",t),ae(),pt(t)}}var lp=(()=>{class r{set selectedSearchTerms(t){this.form.controls.searchTerms.setValue(t)}constructor(t,n){this.fb=t,this.dialogRef=n,this.searchTerms=[],this.form=this.fb.group({searchTerms:this.fb.control([])})}close(){this.dialogRef.close()}submit(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ut),Le(Ot))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-cytoscape-term-result-filter-dialog"]],inputs:{searchTerms:"searchTerms",selectedSearchTerms:"selectedSearchTerms"},decls:15,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["formControlName","searchTerms",3,"multiple"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(X(0,"h5",0),se(1,"Cytoscape Plot Search Term Filter"),J(),X(2,"div",1)(3,"form",2)(4,"mat-form-field")(5,"mat-select",3),ot(6,r2,2,2,"mat-option",4,Ir),J(),X(8,"mat-label"),se(9,"Search Terms"),J()()()(),X(10,"div",5)(11,"button",6),ye("click",function(){return i.close()}),se(12,"Cancel"),J(),X(13,"button",6),ye("click",function(){return i.submit()}),se(14,"Apply"),J()()),n&2&&(ae(3),De("formGroup",i.form),ae(2),De("multiple",!0),ae(),st(i.searchTerms))},dependencies:[Lt,It,rr,tr,St,er,gr,mr,$t,ko,Tn,Nt,xt,yr],encapsulation:2})}}return r})();var n2=r=>({"disabled-icon":r});function i2(r,e){r&1&&(X(0,"button",11),se(1,"No previous searches"),J())}function a2(r,e){if(r&1){let t=We();X(0,"button",13),ye("click",function(){Ae(t);let i=ce().$implicit,a=ce(3);return Pe(a.restoreSearches(i.searchQuery,i.searchID))}),se(1),J()}if(r&2){let t=ce().$implicit;ae(),Ac("",t.searchID,". ",t.termFounds.join(","),"")}}function o2(r,e){if(r&1&&Fe(0,a2,2,2,"button",12),r&2){let t=e.$implicit,n=ce(3);$e(t.collate===n.collate.id?0:-1)}}function s2(r,e){if(r&1&&ot(0,o2,1,1,null,null,Ir),r&2){let t=ce(2);st(t.pastSearches)}}function l2(r,e){if(r&1&&(X(0,"button",10)(1,"mat-icon"),se(2,"history"),J()(),X(3,"mat-menu",null,0),Fe(5,i2,2,0,"button",11)(6,s2,2,0),J()),r&2){let t=fr(4),n=ce();De("matMenuTriggerFor",t),ae(5),$e(n.pastSearches.length===0?5:6)}}function u2(r,e){if(r&1){let t=We();X(0,"button",14),ye("click",function(){Ae(t);let i=ce();return Pe(i.navigateToEdit())}),X(1,"mat-icon"),se(2,"edit"),J()()}}function c2(r,e){if(r&1&&Be(0,"app-collate-header",7),r&2){let t=ce();De("collate",t.collate)}}function d2(r,e){if(r&1&&(X(0,"div",15),Be(1,"app-collate-tags",16),J()),r&2){let t=ce(2);ae(),De("collageTags",t.collate.tags)}}function f2(r,e){if(r&1&&Fe(0,d2,2,1,"div",15),r&2){let t=ce();$e(t.collate.settings.showTags?0:-1)}}function h2(r,e){if(r&1){let t=We();X(0,"button",25),ye("click",function(){Ae(t);let i=ce(2);return Pe(i.filterCytoscapePlot())}),X(1,"mat-icon"),se(2,"filter_list"),J()()}}function v2(r,e){if(r&1&&Be(0,"app-cytoscape-plot",21),r&2){let t=ce(2);De("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("searchResultsMap",t.cytoscapePlotFilteredResults)}}function p2(r,e){if(r&1){let t=We();se(0),X(1,"button",27),ye("click",function(){Ae(t);let i=ce().$implicit,a=ce(2);return Pe(a.exportData(i))}),X(2,"mat-icon"),se(3,"download"),J()()}if(r&2){let t=ce().$implicit,n=ce(2);it(" ",t," "),ae(),De("disabled",n.waitingForDownload)}}function g2(r,e){r&1&&(X(0,"mat-tab"),Fe(1,p2,4,2,"ng-template",26),J())}function m2(r,e){if(r&1&&Be(0,"app-collate-project-list",24),r&2){let t=ce(2);De("searchTerm",t.selectedSearchTerm)("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("filteredResults",t.filteredResults)}}function y2(r,e){if(r&1){let t=We();X(0,"div",17)(1,"button",18),ye("click",function(){Ae(t);let i=ce();return Pe(i.toggleCytoscapePlot())}),X(2,"mat-icon",19),se(3,"account_tree"),J()(),Fe(4,h2,3,0,"button",20),J(),Fe(5,v2,1,3,"app-cytoscape-plot",21),X(6,"div",22)(7,"mat-tab-group",23),ye("selectedTabChange",function(){Ae(t);let i=ce();return Pe(i.filterDataBySearchTerm())}),pr("selectedIndexChange",function(i){Ae(t);let a=ce();return vr(a.selectedIndex,i)||(a.selectedIndex=i),Pe(i)}),ot(8,g2,2,0,"mat-tab",null,Ir),J()(),Fe(10,m2,1,4,"app-collate-project-list",24)}if(r&2){let t=ce();ae(2),De("ngClass",ha(6,n2,!t.showCytoscapePlot)),ae(2),$e(t.showCytoscapePlot?4:-1),ae(),$e(t.collate&&t.showCytoscapePlot&&t.cytoscapePlotFilteredResults?5:-1),ae(2),hr("selectedIndex",t.selectedIndex),De("mat-stretch-tabs",!1),ae(),st(t.searchTerms),ae(2),$e(t.collate?10:-1)}}var Tl=(()=>{class r{set sessionId(t){t&&this.collate&&this.getSearchFromID(t),this._sessionId=t}get sessionId(){return this._sessionId}set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this.collate=n,this.title.setTitle(`${n.title} - C|nder`),this.projects=n.projects,n.settings||(n.settings={projectOrder:[],analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),n.settings.plotSettings||(n.settings.plotSettings={}),n.settings.projectOrder&&(this.projects=n.settings.projectOrder.map(i=>n.projects.find(a=>a.id===i))),!this.collate?.settings.projectAnalysisGroupVisibility){this.collate.settings.projectAnalysisGroupVisibility={};for(let i of this.projects)this.collate.settings.projectAnalysisGroupVisibility[i.id]={}}if(this.collate?.settings.renameSampleCondition)this.sessionId&&this.getSearchFromID(this.sessionId);else{this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)});this.sessionId&&this.getSearchFromID(this.sessionId)}console.log(this.projects)})}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot,console.log(this.cytoscapePlotFilteredResults)}constructor(t,n,i,a,o,s,u,l,c){this.cdr=t,this.title=n,this.ws=i,this.sb=a,this.dialog=o,this.collateService=s,this.web=u,this.accounts=l,this.router=c,this.selectedCytoscapePlotSearchTerm=[],this.showCytoscapePlot=!1,this._sessionId=null,this.collate=null,this.projects=[],this.filteredResults={},this.searchTerms=[],this.selectedIndex=0,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this._selectedSearchTerm="",this.pastSearches=[],this.waitingForDownload=!1,this.cytoscapePlotFilteredResults={};let d=localStorage.getItem("cinderPastSearches");d&&(this.pastSearches=JSON.parse(d)),this.ws.searchWSConnection?.subscribe(f=>{if(f&&f.type==="export_status"&&this.web.cinderInstanceID===f.instance_id&&this.waitingForDownload)switch(f.status){case"error":this.waitingForDownload=!1;break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.waitingForDownload=!1,this.sb.open("Export complete","Dismiss",{duration:2e3});let h=`${this.web.baseURL}/api/search/download_temp_file/?token=${f.file}`;window.open(h,"_blank");break}})}associateAnalysisGroupsWithProjects(){return Et(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return Et(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),console.log(this.searchResults),this.searchTerms.sort((n,i)=>n.localeCompare(i)),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(t){let n={};return console.log(t),Object.keys(this.searchResults).forEach(i=>{n[i]=this.searchResults[i].filter(a=>t.includes(a.search_term)),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let o=parseInt(a),s=this.collate?.settings.analysisGroupOrderMap[o];if(!n[o]||!s)return;let u=n[o].filter(l=>!s.includes(l.analysis_group.id));if(n[o]=n[o].filter(l=>s.includes(l.analysis_group.id)),n[o]=n[o].sort((l,c)=>s.indexOf(l.analysis_group.id)-s.indexOf(c.analysis_group.id)),n[o].concat(u),this.collate?.settings?.projectAnalysisGroupVisibility){let l=this.collate?.settings.projectAnalysisGroupVisibility[o];n[o]=n[o].filter(c=>!l||!(c.analysis_group.id in l)?!0:l[c.analysis_group.id])}})}),console.log(n),n}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults([this.selectedSearchTerm]),Object.keys(this.cytoscapePlotFilteredResults).length===0&&this.filteredResults&&(console.log(this.filteredResults),this.cytoscapePlotFilteredResults=Object.assign({},this.filteredResults))}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{this.searchSession=n}),this.web.getSearchResults(t,99999).subscribe(n=>{if(!this.collate)return;console.log(n.results);let i=Array.from(new Set(n.results.map(o=>o.search_term)));this.pastSearches.find(o=>o.searchID===t)||(this.pastSearches.push({searchQuery:null,termFounds:i,collate:this.collate.id,searchID:t}),this.pastSearches=this.pastSearches.slice(-20),localStorage.setItem("cinderPastSearches",JSON.stringify(this.pastSearches))),this.distributeSearchResults(n.results).then()})}restoreSearches(t,n){this.web.getSearchSession(n).subscribe(i=>{this.searchSession=i}),t?this.distributeSearchResults(t.results).then():this.web.getSearchResults(n,99999).subscribe(i=>{this.distributeSearchResults(i.results).then()})}navigateToEdit(){this.collate&&this.router.navigate([`/collate/edit/${this.collate.id}`])}openQRCodeDialog(){let t=window.location.href,n=this.dialog.open(cd);n.componentInstance.url=t}navigateToHome(){this.router.navigate(["/"])}exportData(t){this.web.exportSearchData(this.searchSession.id,t,1e-8,1e-8,this.web.searchSessionID).subscribe(n=>{this.waitingForDownload=!0})}openVisibilityDialog(){let t=this.dialog.open(fs);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),u=this.collate?.settings.analysisGroupOrderMap[s];if(!u||!i[s])return;let l=i[s].filter(c=>!u.includes(c.id));i[s]=i[s].filter(c=>u.includes(c.id)),i[s]=i[s].sort((c,d)=>u.indexOf(c.id)-u.indexOf(d.id)),i[s]=i[s].concat(l)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults([this.selectedSearchTerm]))})}filterCytoscapePlot(){let t=this.dialog.open(lp);t.componentInstance.searchTerms=this.searchTerms,t.componentInstance.selectedSearchTerms=this.selectedCytoscapePlotSearchTerm,t.afterClosed().subscribe(n=>{if(n){if(console.log(n),n.searchTerms.length>0){let i=this.getFilteredSearchResults(n.searchTerms);this.cytoscapePlotFilteredResults=Pt({},i)}else this.cytoscapePlotFilteredResults={};console.log(this.cytoscapePlotFilteredResults),this.cdr.detectChanges(),this.collateService.collateRedrawSubject.next(!0)}})}static{this.\u0275fac=function(n){return new(n||r)(Le(En),Le(Ic),Le(Ho),Le(Fr),Le(_n),Le(qr),Le(Cr),Le(Kr),Le(Ti))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-view"]],inputs:{sessionId:"sessionId",collateId:"collateId"},decls:18,vars:9,consts:[["previousSearch","matMenu"],["href","/#/home"],[3,"width","height","ngSrc"],[1,"spacer"],["mat-icon-button","","matTooltip","Open QR code dialog",3,"click"],["mat-icon-button","","matTooltip","Change analysis group visibility",3,"click"],["mat-icon-button","","matTooltip","Edit collate"],[3,"collate"],[2,"display","flex","justify-content","center"],[3,"searchResultID","projects"],["mat-icon-button","","matTooltip","View previous searches",3,"matMenuTriggerFor"],["mat-menu-item","","disabled",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Edit collate",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTags"],[2,"display","flex"],["mat-icon-button","","matTooltip","Toggle Cytoscape Plot",3,"click"],[3,"ngClass"],["mat-icon-button","","matTooltip","Filter Cytoscape Plot Search Terms"],[3,"renameCondition","projects","searchResultsMap"],[2,"padding","20px"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"searchTerm","renameCondition","projects","filteredResults"],["mat-icon-button","","matTooltip","Filter Cytoscape Plot Search Terms",3,"click"],["mat-tab-label",""],["mat-icon-button","","matTooltip","Export data",3,"click","disabled"]],template:function(n,i){n&1&&(X(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"a",1),Be(3,"img",2),J(),Be(4,"span",3),Fe(5,l2,7,2),X(6,"button",4),ye("click",function(){return i.openQRCodeDialog()}),X(7,"mat-icon"),se(8,"qr_code"),J()(),X(9,"button",5),ye("click",function(){return i.openVisibilityDialog()}),X(10,"mat-icon"),se(11,"visibility"),J()(),Fe(12,u2,3,0,"button",6),J()(),Fe(13,c2,1,1,"app-collate-header",7)(14,f2,1,1),X(15,"div",8)(16,"app-collate-search",9),ye("searchResultID",function(o){return i._sessionId=o,i.getSearchFromID(o)}),J()(),Fe(17,y2,11,8)),n&2&&(ae(3),De("width",25)("height",25)("ngSrc","/assets/logo.png"),ae(2),$e(i.collate?5:-1),ae(7),$e(i.accounts.loggedIn?12:-1),ae(),$e(i.collate?13:-1),ae(),$e(i.collate&&i.collate.settings?14:-1),ae(2),De("projects",i.projects),ae(),$e(i.searchTerms.length>0?17:-1))},dependencies:[id,ls,rs,ns,cs,Qt,Xr,Uo,$o,ds,Lc,Ai,Di,Pi,Jc,Mi,sp,Rc],styles:[".disabled-icon[_ngcontent-%COMP%]{color:red}"]})}}return r})();var up=(r,e)=>e.id;function C2(r,e){if(r&1){let t=We();X(0,"mat-chip",2),ye("click",function(){let i=Ae(t).$implicit,a=ce(2);return Pe(a.removeProject(i))}),se(1),J()}if(r&2){let t=e.$implicit;ae(),it(" ",t.name," ")}}function w2(r,e){if(r&1&&(X(0,"div"),se(1),X(2,"mat-chip-set"),ot(3,C2,2,1,"mat-chip",null,up),J()()),r&2){let t=ce();ae(),it(" Selected Projects: ",t.selectedMultipleProjects.length," "),ae(2),st(t.selectedMultipleProjects)}}function b2(r,e){if(r&1&&(X(0,"mat-list-option",4),se(1),J()),r&2){let t=e.$implicit;De("value",t),ae(),pt(t.name)}}function x2(r,e){if(r&1){let t=We();X(0,"div")(1,"mat-selection-list",3),ot(2,b2,2,2,"mat-list-option",4,up),J(),X(4,"mat-paginator",5),ye("page",function(i){Ae(t);let a=ce(2);return Pe(a.handleProjectPageEvent(i))}),J()()}if(r&2){let t=ce(2);ae(),De("multiple",!1),ae(),st(t.projectQuery.results),ae(2),De("pageSize",t.projectPageSize)("length",t.projectQuery.count)("pageIndex",t.projectPageIndex)}}function E2(r,e){r&1&&(X(0,"p"),se(1,"No projects found."),J())}function T2(r,e){if(r&1&&Fe(0,x2,5,4,"div")(1,E2,2,0,"p"),r&2){let t=ce();$e(t.projectQuery.count>0?0:1)}}var cp=(()=>{class r{constructor(t,n){this.fb=t,this.web=n,this.multipleSelection=!1,this.selectedProjects=new bt,this.formProjectSearch=this.fb.group({searchTerm:new kr("",Nr.required),selectedProjects:new kr([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(i=>{i&&this.fetchProjects(i,this.projectPageSize,0)}),this.formProjectSearch.controls.selectedProjects.valueChanges.subscribe(i=>{if(i){for(let a of i)this.selectedMultipleProjects.includes(a)||this.selectedMultipleProjects.push(a);this.selectedProjects.emit(this.selectedMultipleProjects)}})}fetchProjects(t,n,i){let a=i*n;this.web.getProjects(void 0,n,a,t,void 0).subscribe(o=>{this.projectQuery=o})}handleProjectPageEvent(t){this.projectPageIndex=t.pageIndex,this.fetchProjects(this.formProjectSearch.controls.searchTerm.value||"",t.pageSize,t.pageIndex)}removeProject(t){this.selectedMultipleProjects=this.selectedMultipleProjects.filter(n=>n!==t),this.selectedProjects.emit(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ut),Le(Cr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-search"]],inputs:{multipleSelection:"multipleSelection"},outputs:{selectedProjects:"selectedProjects"},decls:7,vars:3,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Project Name","type","search"],[3,"click"],["formControlName","selectedProjects",3,"multiple"],[3,"value"],[3,"page","pageSize","length","pageIndex"]],template:function(n,i){n&1&&(X(0,"form",0)(1,"mat-form-field"),Be(2,"input",1),X(3,"mat-label"),se(4,"Search For Specific Projects"),J()(),Fe(5,w2,5,1,"div")(6,T2,2,1),J()),n&2&&(De("formGroup",i.formProjectSearch),ae(5),$e(i.selectedMultipleProjects.length>0?5:-1),ae(),$e(i.projectQuery?6:-1))},dependencies:[rr,tr,Jt,St,er,gr,mr,$t,nr,yr,zo,Vo,No,Io,Fo],encapsulation:2})}}return r})();var dp=(()=>{class r{constructor(t,n,i){this.dialogRef=t,this.fb=n,this.web=i,this.formProjectSearch=this.fb.group({searchTerm:new kr("",Nr.required),selectedProjects:new kr([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.multipleSelection=!0,this.web.getProjects(void 0,this.projectPageSize,0,void 0).subscribe(a=>{this.projectQuery=a}),this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(a=>{a&&this.web.getProjects(void 0,this.projectPageSize,0,a).subscribe(o=>{this.projectQuery=o})})}handleSelectedProjects(t){this.selectedMultipleProjects=t}close(){this.dialogRef.close()}save(){this.dialogRef.close(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot),Le(Ut),Le(Cr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-add-dialog"]],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"selectedProjects"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(X(0,"h2",0),se(1,"Project Add"),J(),X(2,"div",1)(3,"app-project-search",2),ye("selectedProjects",function(o){return i.handleSelectedProjects(o)}),J(),X(4,"small"),se(5),J()(),X(6,"div",3)(7,"button",4),ye("click",function(){return i.save()}),se(8,"Submit"),J(),X(9,"button",4),ye("click",function(){return i.close()}),se(10,"Close"),J()()),n&2&&(ae(5),it("Selected ",i.selectedMultipleProjects.length," Projects."))},dependencies:[cp,Lt,It,Nt,xt],encapsulation:2})}}return r})();var fp=(r,e)=>e.id;function _2(r,e){if(r&1&&(X(0,"mat-list-item",5)(1,"mat-icon",7),se(2,"notes"),J(),X(3,"div",8),se(4),J(),Be(5,"div",9),J()),r&2){let t=e.$implicit;ae(4),pt(t.name)}}function S2(r,e){if(r&1){let t=We();X(0,"div",5)(1,"div",6)(2,"b"),se(3),J()(),X(4,"div",4),ye("cdkDropListDropped",function(i){let a=Ae(t).$implicit,o=ce(2);return Pe(o.drop(i,a.id))}),ot(5,_2,6,1,"mat-list-item",5,fp),J(),Be(7,"mat-divider"),J()}if(r&2){let t=e.$implicit,n=ce(2);ae(3),pt(t.name),ae(2),st(n.projectAnalysisGroupMap[t.id])}}function M2(r,e){if(r&1){let t=We();X(0,"mat-list")(1,"div",4),ye("cdkDropListDropped",function(i){Ae(t);let a=ce();return Pe(a.dropProject(i))}),ot(2,S2,8,1,"div",5,fp),J()()}if(r&2){let t=ce();ae(2),st(t.projects)}}var hp=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}constructor(t){this.dialogRef=t,this._projectAnalysisGroupMap={},this._projects=[]}save(){this.dialogRef.close({projects:this.projects,projectAnalysisGroupMap:this.projectAnalysisGroupMap})}cancel(){this.dialogRef.close()}drop(t,n){Kn(this.projectAnalysisGroupMap[n],t.previousIndex,t.currentIndex)}dropProject(t){Kn(this.projects,t.previousIndex,t.currentIndex)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-analysis-group-reorder-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["mat-subheader","","cdkDragHandle",""],["cdkDragHandle","","matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""]],template:function(n,i){n&1&&(X(0,"h1",0),se(1,"Analysis Group Reorder"),J(),X(2,"div",1),Fe(3,M2,4,0,"mat-list"),J(),X(4,"div",2)(5,"button",3),ye("click",function(){return i.cancel()}),se(6,"Close"),J(),X(7,"button",3),ye("click",function(){return i.save()}),se(8,"Save"),J()()),n&2&&(ae(3),$e(i.projects.length>0?3:-1))},dependencies:[Lt,It,$c,Yc,Wc,Lo,Qt,Uc,as,An,Dn,Nt,xt],encapsulation:2})}}return r})();var D2=["hueSlider"],A2=["alphaSlider"];function P2(r,e){if(r&1){let t=We();X(0,"div",10),ye("newValue",function(i){Ae(t);let a=ce();return Pe(a.onSliderChange("saturation-lightness",i))}),X(1,"div",11),Be(2,"div"),J()()}if(r&2){let t=ce();xn("background-color",t.hueSliderColor),De("rgX",1)("rgY",1),ae(),xn("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function R2(r,e){if(r&1&&(X(0,"div",12),Be(1,"div",13)(2,"div",14),J()),r&2){let t=ce();ae(2),xn("background-color",t.selectedColor)}}function O2(r,e){if(r&1){let t=We();X(0,"div",15,1),ye("newValue",function(i){Ae(t);let a=ce();return Pe(a.onSliderChange("hue",i))}),X(2,"div",16)(3,"div"),Be(4,"div"),J()()()}if(r&2){let t=ce();De("rgX",1),ae(2),xn("left",t.slider==null?null:t.slider.h,"px")}}function L2(r,e){if(r&1){let t=We();X(0,"div",17,2),ye("newValue",function(i){Ae(t);let a=ce();return Pe(a.onSliderChange("alpha",i))}),Be(2,"div",18),X(3,"div",16)(4,"div"),Be(5,"div"),J()()()}if(r&2){let t=ce();De("rgX",1),ae(2),De("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),ae(),xn("left",t.slider==null?null:t.slider.a,"px")}}var I2=["dialog"],gp=r=>({background:r});function N2(r,e){r&1&&Be(0,"div",12)}function k2(r,e){if(r&1){let t=We();jt(0),X(1,"div",9)(2,"div",10),ye("click",function(){let i=Ae(t).$implicit,a=ce(2);return Pe(a.onColorClick(i))}),Fe(3,N2,1,0,"div",11),J()(),Ht()}if(r&2){let t=e.$implicit,n=e.index,i=ce(2);ae(2),To("colornull",!t),De("ngStyle",i.getBackgroundColor(t)),ae(),De("ngIf",n==i.indexSeleccionado)}}function F2(r,e){if(r&1&&Be(0,"div",18),r&2){let t=ce(3);De("ngStyle",t.getBackgroundColor(t.color))}}function B2(r,e){if(r&1){let t=We();X(0,"div",13),ye("click",function(){Ae(t);let i=ce(2);return Pe(i.addColor())}),Fe(1,F2,1,1,"div",14),xo(),X(2,"svg",15),Be(3,"path",16)(4,"path",17),J()()}if(r&2){let t=ce(2);ae(),De("ngIf",t.indexSeleccionado===void 0)}}function V2(r,e){if(r&1){let t=We();X(0,"color-picker",19),ye("colorChange",function(i){Ae(t);let a=ce(2);return Pe(a.onChangeColorPicker(i))})("onAlphaChange",function(i){Ae(t);let a=ce(2);return Pe(a.onAlphaChange(i))}),J()}if(r&2){let t=ce(2);De("controls",t.colorPickerControls)("color",t.hsva)}}function z2(r,e){if(r&1&&(jt(0),X(1,"div",5),Fe(2,k2,4,4,"ng-container",6)(3,B2,5,1,"div",7)(4,V2,1,2,"color-picker",8),J(),Ht()),r&2){let t=ce();ae(),De("@colorsAnimation",t.colorsAnimationEffect),ae(),De("ngForOf",t.palette),ae(),De("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),ae(),De("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function G2(r,e){r&1&&Be(0,"div",12)}function j2(r,e){if(r&1){let t=We();jt(0),X(1,"div",9)(2,"div",25),ye("click",function(){let i=Ae(t).$implicit,a=ce(2);return Pe(a.changeColor(i))}),Fe(3,G2,1,0,"div",11),J()(),Ht()}if(r&2){let t=e.$implicit,n=ce(2);ae(2),To("colornull",!t),De("ngStyle",ha(4,gp,t)),ae(),De("ngIf",n.isSelected(t))}}function H2(r,e){if(r&1){let t=We();jt(0),X(1,"div",5)(2,"div",20)(3,"div",21),ye("click",function(){Ae(t);let i=ce();return Pe(i.onClickBack())}),xo(),X(4,"svg",22),Be(5,"path",23)(6,"path",24),J()()(),Fe(7,j2,4,6,"ng-container",6),J(),Ht()}if(r&2){let t=ce();ae(),De("@colorsAnimation",t.colorsAnimationEffect),ae(6),De("ngForOf",t.variants)}}function U2(r,e){if(r&1){let t=We();jt(0),X(1,"div",26)(2,"div",27),ye("click",function(){Ae(t);let i=ce();return Pe(i.onClickBack())}),xo(),X(3,"svg",22),Be(4,"path",23)(5,"path",24),J()(),bc(),X(6,"button",28),ye("click",function(){Ae(t);let i=ce();return Pe(i.emitClose("cancel"))}),se(7),J(),X(8,"button",28),ye("click",function(){Ae(t);let i=ce();return Pe(i.emitClose("accept"))}),se(9),J()(),X(10,"div",29)(11,"color-picker",30),ye("sliderChange",function(i){Ae(t);let a=ce();return Pe(a.onChangeColorPicker(i))}),J()(),Ht()}if(r&2){let t=ce();ae(7),it(" ",t.cancelLabel," "),ae(2),it(" ",t.acceptLabel," "),ae(2),De("controls",t.colorPickerControls)("color",t.hsva)}}function $2(r,e){if(r&1){let t=We();X(0,"div",31)(1,"p",32),ye("click",function(){Ae(t);let i=ce();return Pe(i.nextFormat())}),se(2),J(),X(3,"div",33)(4,"input",34,1),ye("keyup",function(){Ae(t);let i=fr(5),a=ce();return Pe(a.changeColorManual(i.value))})("keydown.enter",function(){Ae(t);let i=ce();return Pe(i.emitClose("accept"))}),J()()()}if(r&2){let t=ce();ae(2),pt(t.colorFormats[t.format]),ae(2),xn("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),De("placeholder",t.placeholder)("value",t.color)}}var hc=["hex","rgba","hsla","cmyk"],Er=function(r){return r[r.HEX=0]="HEX",r[r.RGBA=1]="RGBA",r[r.HSLA=2]="HSLA",r[r.CMYK=3]="CMYK",r}(Er||{}),vp=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],on=class{constructor(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},$r=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i,this.onChange=new bt(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},gi=class{constructor(e,t,n,i){this.h=e,this.s=t,this.l=n,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Xn=class{constructor(e,t,n,i,a=1){this.c=e,this.m=t,this.y=n,this.k=i,this.a=a}denormalize(){return this.c=Math.round(this.c*100),this.m=Math.round(this.m*100),this.y=Math.round(this.y*100),this.k=Math.round(this.k*100),this}toString(){return this.denormalize(),"cmyk("+this.c+", "+this.m+", "+this.y+", "+this.k+")"}},vc=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},Sl=(()=>{class r{constructor(){}toFormat(t,n){var i="";if(t)switch(n){case Er.HEX:var o=this.hsvaToRgba(t);o.denormalize();var i=this.rgbaToHex(o,!0);break;case Er.HSLA:var a=this.hsva2hsla(t);a.denormalize();var i=a.toString();break;case Er.RGBA:var o=this.hsvaToRgba(t),i=o.toString();break;case Er.CMYK:var s=this.hsvaToCmyk(t),i=s.toString();break}return i}stringToFormat(t,n){var i=this.stringToHsva(t,!0);return this.toFormat(i,n)}hsva2hsla(t){let n=t.h,i=t.s,a=t.v,o=t.a;if(a===0)return new gi(n,0,0,o);if(i===0&&a===1)return new gi(n,1,1,o);{let s=a*(2-i)/2;return new gi(n,a*i/(1-Math.abs(2*s-1)),s,o)}}hsla2hsva(t){let n=Math.min(t.h,1),i=Math.min(t.s,1),a=Math.min(t.l,1),o=Math.min(t.a,1);if(a===0)return new $r(n,0,0,o);{let s=a+i*(1-Math.abs(2*a-1))/2;return new $r(n,2*(s-a)/s,s,o)}}hsvaToRgba(t){let n,i,a,o=t.h,s=t.s,u=t.v,l=t.a,c=Math.floor(o*6),d=o*6-c,f=u*(1-s),h=u*(1-d*s),v=u*(1-(1-d)*s);switch(c%6){case 0:n=u,i=v,a=f;break;case 1:n=h,i=u,a=f;break;case 2:n=f,i=u,a=v;break;case 3:n=f,i=h,a=u;break;case 4:n=v,i=f,a=u;break;case 5:n=u,i=f,a=h;break;default:n=0,i=0,a=0}return new on(n,i,a,l)}cmykToRgb(t){let n=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),a=(1-t.y)*(1-t.k);return new on(n,i,a,t.a)}rgbaToCmyk(t){let n=1-Math.max(t.r,t.g,t.b);if(n===1)return new Xn(0,0,0,1,t.a);{let i=(1-t.r-n)/(1-n),a=(1-t.g-n)/(1-n),o=(1-t.b-n)/(1-n);return new Xn(i,a,o,n,t.a)}}hsvaToCmyk(t){let n=this.hsvaToRgba(t);return this.rgbaToCmyk(n)}rgbaToHsva(t){let n,i,a=Math.min(t.r,1),o=Math.min(t.g,1),s=Math.min(t.b,1),u=Math.min(t.a,1),l=Math.max(a,o,s),c=Math.min(a,o,s),d=l,f=l-c;if(i=l===0?0:f/l,l===c)n=0;else{switch(l){case a:n=(o-s)/f+(o<s?6:0);break;case o:n=(s-a)/f+2;break;case s:n=(a-o)/f+4;break;default:n=0}n/=6}return new $r(n,i,d,u)}rgbaToHex(t,n){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new Xn(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new Xn(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new on(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",n=!0){let i=null;t=(t||"").toLowerCase();let a=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new on(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new gi(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/cmyk?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new Xn(parseInt(o[1],10)/100,parseInt(o[2],10)/100,parseInt(o[3],10)/100,parseInt(o[4],10)/100)}}];n?a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new on(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}):a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new on(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),a.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new on(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(let o in a)if(a.hasOwnProperty(o)){let s=a[o],u=s.re.exec(t),l=u&&s.parse(u);if(l){if(l instanceof on)i=this.rgbaToHsva(l);else if(l instanceof gi)i=this.hsla2hsva(l);else if(l instanceof Xn){let c=this.cmykToRgb(l);i=this.rgbaToHsva(c)}return i}}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let n=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,a=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/,o=/(cmyk\(\d{1,3}(,\s?\d{1,3}){3}\))/;if(n.test(t))return"hex";if(i.test(t))return"rgba";if(a.test(t))return"hsla";if(o.test(t))return"cmyk"}return"hex"}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=Dl({token:r,factory:r.\u0275fac}),r})(),_l=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},pc=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},W2=(()=>{class r{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new bt,this.dragStart=new bt,this.newValue=new bt,this.listenerMove=n=>this.move(n),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-n.left-window.pageXOffset}getY(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-n.top-window.pageYOffset}setCursor(t){let n=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,a=Math.max(0,Math.min(this.getX(t),n)),o=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:a/n,v:1-o/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:o/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:a/n,rgX:this.rgX})}}return r.\u0275fac=function(t){return new(t||r)(Le(Al))},r.\u0275dir=Rl({type:r,selectors:[["","slider",""]],hostBindings:function(t,n){t&1&&ye("mousedown",function(a){return n.mouseDown(a)})("touchstart",function(a){return n.touchStart(a)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"},standalone:!1}),r})(),Y2=(()=>{class r{constructor(t,n){this.service=t,this.cdr=n,this.color=new $r(0,1,1,1),this.controls="default",this.sliderChange=new bt(!1),this.onAlphaChange=new bt(!1),this.hsva=new $r(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new $r(0,1,1,1)),this.slider=new _l(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,n=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new pc(t,220,130,n),this.update()}onSliderChange(t,n){switch(t){case"saturation-lightness":this.hsva.onColorChange(n);break;case"hue":this.hsva.onHueChange(n);break;case"alpha":this.hsva.onAlphaChange(n),this.onAlphaChange.emit(n);break;case"value":this.hsva.onValueChange(n);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),n=this.service.hsvaToRgba(new $r(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+n.r+","+n.g+","+n.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new _l(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return r.\u0275fac=function(t){return new(t||r)(Le(Sl),Le(En))},r.\u0275cmp=qe({type:r,selectors:[["color-picker"]],viewQuery:function(t,n){if(t&1&&(bi(D2,5),bi(A2,5)),t&2){let i;xi(i=Ei())&&(n.hueSlider=i.first),xi(i=Ei())&&(n.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},standalone:!1,features:[wc],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,n){if(t&1){let i=We();X(0,"div",3,0),ye("click",function(o){return Ae(i),Pe(o.stopPropagation())}),Fe(2,P2,3,8,"div",4),X(3,"div",5),Fe(4,R2,3,2,"div",6),X(5,"div",7),Fe(6,O2,5,3,"div",8)(7,L2,6,4,"div",9),J()()()}t&2&&(ae(2),De("ngIf",n.controls!="only-alpha"),ae(2),De("ngIf",n.controls!="only-alpha"),ae(2),De("ngIf",n.controls!="only-alpha"),ae(),De("ngIf",n.controls!="no-alpha"))},dependencies:[Ll,Ao,W2],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),r})(),X2=(()=>{class r{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,n){this.service=t,this.cdr=n,this.color="#000000",this.previewColor="#000000",this.hsva=new $r(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=vp,this.variants=[],this.userFormats=[],this.colorFormats=hc,this.format=Er.HEX,this.formatMap={hex:Er.HEX,rgba:Er.RGBA,hsla:Er.HSLA,cmyk:Er.CMYK},this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let n;if(this.color)for(let i=0;i<t.length;i++){let a=t[i];typeof a=="string"?this.service.stringToFormat(this.color,Er.HEX)==this.service.stringToFormat(a,Er.HEX)&&(n=i):a===void 0?this.color=void 0:this.findIndexSelectedColor(a.variants)!=null&&(n=i)}return n}iniciate(t,n,i,a,o,s,u,l,c,d,f,h,v=[]){if(this.colorPickerControls=f,this.triggerInstance=t,this.TriggerBBox=n,this.color=i,this.hideColorPicker=l,this.hideTextInput=u,this.acceptLabel=c,this.cancelLabel=d,v.length&&v.every(m=>hc.includes(m))&&(this.colorFormats=v),s?this.colorFormats.includes(s)?(this.format=this.colorFormats.indexOf(s.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=s.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=Er.HEX):(this.format=this.colorFormats.indexOf(this.service.getFormatByString(this.color)),this.format<0&&(this.format=0)),this.previewColor=this.color,this.palette=a??vp,this.colorsAnimationEffect=o,h=="top"){let p=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+p.height+"px ))"}}setPosition(){if(this.TriggerBBox){let n=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=n.top+n.height,n.left+250>window.innerWidth?this.left=n.right<250?window.innerWidth/2-250/2:n.right-250:this.left=n.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),n=this.panelRef.nativeElement.getBoundingClientRect(),i=n.height;t.bottom+i>window.innerHeight?this.positionString=t.top<n.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(n=>n.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,n){var i=[];for(let a=0;a<n.length;a++){let o=n[a];if(typeof o=="string"){let s=this.service.stringToHsva(o);s.onAlphaChange(t),i.push(this.service.toFormat(s,this.format))}else{let s=new vc,u=this.service.stringToHsva(o.preview);u.onAlphaChange(t),s.preview=this.service.toFormat(u,this.format),s.variants=this.ChangeAlphaOnPalette(t,o.variants),i.push(s)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.setPreviewColor(this.hsva),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color,this.previewColor)}setColor(t,n=-1){this.hsva=t;let i=this.colorFormats[this.format],a=n;a<0&&(a=this.formatMap[i]),this.color=this.service.toFormat(t,a),this.setPreviewColor(t),this.triggerInstance.setColor(this.color,this.previewColor)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){if(this.canChangeFormat){this.format=(this.format+1)%this.colorFormats.length;let t=this.colorFormats[this.format],n=this.formatMap[t];this.setColor(this.hsva,n),this.placeholder=this.service.toFormat(new $r(0,0,1,1),n)}}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return r.\u0275fac=function(t){return new(t||r)(Le(Sl),Le(En))},r.\u0275cmp=qe({type:r,selectors:[["ngx-colors-panel"]],viewQuery:function(t,n){if(t&1&&bi(I2,5),t&2){let i;xi(i=Ei())&&(n.panelRef=i.first)}},hostVars:4,hostBindings:function(t,n){t&1&&ye("mousedown",function(a){return n.click(a)},!1,Pl)("scroll",function(){return n.onScroll()},!1,Pl)("resize",function(){return n.onResize()},!1,Tc),t&2&&xn("top",n.top,"px")("left",n.left,"px")},standalone:!1,decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[2,"cursor","pointer",3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,n){t&1&&(X(0,"div",2,0),Fe(2,z2,5,4,"ng-container",3)(3,H2,8,2,"ng-container",3)(4,U2,12,4,"ng-container",3)(5,$2,6,7,"div",4),J()),t&2&&(Dc(n.positionString),ae(2),De("ngIf",n.menu==1),ae(),De("ngIf",n.menu==2),ae(),De("ngIf",n.menu==3),ae(),De("ngIf",!n.hideTextInput))},dependencies:[Oc,Ll,Ao,Y2],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[zc("colorsAnimation",[kl("void => slide-in",[va(":enter",un({opacity:0}),{optional:!0}),va(":enter",Fl("10ms",[Il(".3s ease-in",Nl([un({opacity:0,transform:"translatex(-50%)",offset:0}),un({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),un({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),kl("void => popup",[va(":enter",un({opacity:0,transform:"scale(0)"}),{optional:!0}),va(":enter",Fl("10ms",[Il("500ms ease-out",Nl([un({opacity:.5,transform:"scale(.5)",offset:.3}),un({opacity:1,transform:"scale(1.1)",offset:.8}),un({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),r})(),pp={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},mp=(()=>{class r{constructor(t,n,i){this.resolver=t,this.applicationRef=n,this.injector=i}createPanel(t,n){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(X2);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let a=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(n),Object.keys(pp).forEach(o=>{this.overlay.style[o]=pp[o]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(a),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return r.\u0275fac=function(t){return new(t||r)(bo(_c),bo(Sc),bo(xc))},r.\u0275prov=Dl({token:r,factory:r.\u0275fac}),r})(),gc=(()=>{class r{onClick(){this.openPanel()}constructor(t,n,i){this.triggerRef=t,this.panelFactory=n,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new bt,this.input=new bt,this.slider=new bt,this.close=new bt,this.open=new bt,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position,this.formats)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t,n=""){this.writeValue(t,n),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t,n=""){if(t!==this.color){if(this.format){let a=hc.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,a)}this.color=t;let i=!1;t&&t.startsWith("cmyk")&&(i=!0,n||(n=this.service.stringToFormat(t,Er.RGBA))),this.change.emit(i?n:t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return r.\u0275fac=function(t){return new(t||r)(Le(Al),Le(mp),Le(Sl))},r.\u0275dir=Rl({type:r,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,n){t&1&&ye("click",function(){return n.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",formats:"formats",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},standalone:!1,features:[Pc([{provide:Gc,useExisting:Cc(()=>r),multi:!0}])]}),r})(),yp=(()=>{class r{constructor(t,n){this.cdRef=t,this.triggerDirective=n,this.triggerDirectiveColorChangeSubscription=null,this.color=this.triggerDirective.color}ngOnInit(){this.triggerDirectiveColorChangeSubscription=this.triggerDirective.change.subscribe(t=>{this.color=t,this.cdRef.markForCheck()})}ngOnDestroy(){this.triggerDirectiveColorChangeSubscription&&this.triggerDirectiveColorChangeSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(Le(En),Le(gc,1))},r.\u0275cmp=qe({type:r,selectors:[["ngx-colors"]],standalone:!1,decls:4,vars:5,consts:[[1,"app-color-picker"],[1,"preview"],[1,"preview-background"],[1,"circle",3,"ngStyle"]],template:function(t,n){t&1&&(X(0,"div",0)(1,"div",1)(2,"div",2),Be(3,"div",3),J()()()),t&2&&(ae(3),To("colornull",!n.color),De("ngStyle",ha(3,gp,n.color)))},dependencies:[Ao],styles:["[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]{line-height:1px;font-family:sans-serif}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin:2px;display:inline-block;box-sizing:border-box;border-radius:100%;background:white;cursor:pointer;padding:3px;box-shadow:0 1px 1px #0003,0 1px 1px 1px #00000024,0 1px 1px 1px #0000001f}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-background[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px;border-radius:100%}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:20px;width:20px;box-sizing:border-box;border-radius:100%;cursor:pointer}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .noselected[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}"]}),r})(),Cp=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Eo({type:r}),r.\u0275inj=wo({providers:[Sl,mp],imports:[Ro]}),r})();var K2=(r,e)=>e.id;function Z2(r,e){if(r&1){let t=We();X(0,"div",4)(1,"ngx-colors",5),pr("ngModelChange",function(i){let a=Ae(t).$implicit,o=ce(2).$implicit,s=ce();return vr(s.projectConditionColorMap[o.id][a],i)||(s.projectConditionColorMap[o.id][a]=i),Pe(i)}),J(),X(2,"div"),se(3),J()()}if(r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();ae(),hr("ngModel",i.projectConditionColorMap[n.id][t]),ae(2),pt(t)}}function Q2(r,e){if(r&1&&ot(0,Z2,4,2,"div",4,Ir),r&2){let t=ce().$implicit,n=ce();st(n.projectConditionMap[t.id])}}function J2(r,e){if(r&1&&(X(0,"div")(1,"div")(2,"b"),se(3),J()(),Fe(4,Q2,2,0),J()),r&2){let t=e.$implicit,n=ce();ae(3),pt(t.name),ae(),$e(n.projectConditionMap[t.id]?4:-1)}}var wp=(()=>{class r{set projects(t){this._projects=t;for(let n of t)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i)this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.projectConditionColorMap[a.AnalysisGroup.project]||(this.projectConditionColorMap[a.AnalysisGroup.project]={}),this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]||(this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]="")})}get projects(){return this._projects}set projectConditionColorMap(t){if(t==null){this._projectConditionColorMap={};return}this._projectConditionColorMap=Object.assign({},t)}get projectConditionColorMap(){return this._projectConditionColorMap}constructor(t,n){this.dialogRef=t,this.web=n,this._projects=[],this.projectConditionMap={},this._projectConditionColorMap={}}save(){this.dialogRef.close(this.projectConditionColorMap)}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot),Le(Cr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-condition-color-editor-dialog"]],inputs:{projects:"projects",projectConditionColorMap:"projectConditionColorMap"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],[2,"display","flex","gap","5px","align-items","center"],["ngx-colors-trigger","",3,"ngModelChange","ngModel"]],template:function(n,i){n&1&&(X(0,"h1",0),se(1,"Condition Color Editor"),J(),X(2,"div",1),ot(3,J2,5,2,"div",null,K2),J(),X(5,"div",2)(6,"button",3),ye("click",function(){return i.cancel()}),se(7,"Close"),J(),X(8,"button",3),ye("click",function(){return i.save()}),se(9,"Save"),J()()),n&2&&(ae(3),st(i.projects))},dependencies:[Lt,It,Cp,yp,gc,Mn,St,Sn,xt,Nt],encapsulation:2})}}return r})();function eE(r,e){if(r&1&&(X(0,"mat-option",6),se(1),J()),r&2){let t=e.$implicit;De("value",t),ae(),pt(t)}}var bp=(()=>{class r{_filter(t){let n=t.toLowerCase();return this.tags.filter(i=>i.toLowerCase().includes(n))}constructor(t,n,i){this.fb=t,this.dialogRef=n,this.collateService=i,this.form=this.fb.group({name:["",Nr.required],existing:[!1],id:[-1]}),this.tags=[]}ngOnInit(){this.filteredTags=this.form.controls.name.valueChanges.pipe(yo(""),Co(t=>this.collateService.getCollateTags(t).pipe(go(n=>n.results.map(i=>i.name)))))}submit(){let t=this.form.controls.name.value;this.collateService.getCollateTags(t).subscribe(n=>{let i=n.results.find(o=>o.name.toLowerCase()===t.toLowerCase()),a=!!i;this.form.controls.existing.setValue(a),this.form.controls.id.setValue(a?i.id:null),this.dialogRef.close(this.form.value)})}cancel(){this.dialogRef.close()}onTagSelected(t){let n=t.option.value;this.form.controls.name.setValue(n),this.collateService.getCollateTags(n).subscribe(i=>{let a=i.results.find(o=>o.name.toLowerCase()===n.toLowerCase());this.form.controls.existing.setValue(!!a),this.form.controls.id.setValue(a?a.id:null)})}static{this.\u0275fac=function(n){return new(n||r)(Le(Ut),Le(Ot),Le(qr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-tag-create-dialog"]],decls:18,vars:5,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["type","text","matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"]],template:function(n,i){if(n&1){let a=We();X(0,"h1",1),se(1,"Create/Add Tag"),J(),X(2,"div",2)(3,"form",3)(4,"mat-form-field")(5,"mat-label"),se(6,"Tag Name"),J(),Be(7,"input",4),X(8,"mat-autocomplete",5,0),ye("optionSelected",function(s){return Ae(a),Pe(i.onTagSelected(s))}),ot(10,eE,2,2,"mat-option",6,Ir),Mo(12,"async"),J()()()(),X(13,"div",7)(14,"button",8),ye("click",function(){return Ae(a),Pe(i.cancel())}),se(15,"Cancel"),J(),X(16,"button",9),ye("click",function(){return Ae(a),Pe(i.submit())}),se(17,"Submit"),J()()}if(n&2){let a=fr(9);ae(3),De("formGroup",i.form),ae(4),De("matAutocomplete",a),ae(3),st(Do(12,3,i.filteredTags)),ae(6),De("disabled",i.form.invalid)}},dependencies:[Lt,It,rr,tr,Jt,St,er,gr,mr,yr,nr,$t,xt,Nt,Tn,Po,Go,jo],encapsulation:2})}}return r})();var tE=(r,e)=>e.id;function rE(r,e){r&1&&(X(0,"th",11),se(1," Original Title "),J())}function nE(r,e){if(r&1&&(X(0,"td",12),se(1),J()),r&2){let t=e.$implicit;ae(),it(" ",t," ")}}function iE(r,e){r&1&&(X(0,"th",11),se(1," Display Title "),J())}function aE(r,e){if(r&1&&(X(0,"td",12)(1,"form",13)(2,"mat-form-field"),Be(3,"input",14),J()()()),r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();ae(),De("formGroup",i.formMap[n.id][t]),ae(2),_o("formControlName",t)}}function oE(r,e){r&1&&Be(0,"tr",15)}function sE(r,e){r&1&&Be(0,"tr",16)}function lE(r,e){if(r&1&&(X(0,"h5"),se(1),J(),X(2,"table",4),jt(3,5),Fe(4,rE,2,0,"th",6)(5,nE,2,1,"td",7),Ht(),jt(6,8),Fe(7,iE,2,0,"th",6)(8,aE,4,2,"td",7),Ht(),Fe(9,oE,1,0,"tr",9)(10,sE,1,0,"tr",10),J()),r&2){let t=ce().$implicit,n=ce();ae(),pt(t.name),ae(),De("dataSource",n.projectConditionMap[t.id]),ae(7),De("matHeaderRowDef",n.displayedColumns),ae(),De("matRowDefColumns",n.displayedColumns)}}function uE(r,e){if(r&1&&Fe(0,lE,11,4),r&2){let t=e.$implicit,n=ce();$e(n.formMap[t.id]?0:-1)}}var xp=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set renameSampleCondition(t){for(let n of this.projects)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i){if(this.formMap[a.AnalysisGroup.project]||(this.formMap[a.AnalysisGroup.project]={}),!this.formMap[a.AnalysisGroup.project][a.Condition]){let o={};o[a.Condition]=new kr(a.Condition,Nr.required),this.formMap[a.AnalysisGroup.project][a.Condition]=this.fb.group(o)}this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.renameSampleCondition[a.AnalysisGroup.project]||(this.renameSampleCondition[a.AnalysisGroup.project]={}),this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]||(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=a.Condition),t[a.AnalysisGroup.project]&&t[a.AnalysisGroup.project][a.Condition]&&(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=t[a.AnalysisGroup.project][a.Condition],this.formMap[a.AnalysisGroup.project][a.Condition].controls[a.Condition].setValue(t[a.AnalysisGroup.project][a.Condition]))}})}get renameSampleCondition(){return this._renameSampleCondition}constructor(t,n,i,a){this.dialog=t,this.web=n,this.fb=i,this.sb=a,this.displayedColumns=["original","display"],this.projectConditionMap={},this._projects=[],this._renameSampleCondition={},this.formMap={}}close(){this.dialog.close()}submit(){let t={};for(let n in this.formMap){t[n]={};for(let i in this.formMap[n])if(t[n][i]=this.formMap[n][i].value[i],!this.formMap[n][i].valid){this.sb.open(`${i} is invalid`);return}}this.dialog.close(t)}static{this.\u0275fac=function(n){return new(n||r)(Le(Ot),Le(Cr),Le(Ut),Le(Fr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-rename-sample-condition-dialog"]],inputs:{projects:"projects",renameSampleCondition:"renameSampleCondition"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","original"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","display"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"formGroup"],["matInput","",2,"border-radius","0",3,"formControlName"],["mat-header-row",""],["mat-row",""]],template:function(n,i){n&1&&(X(0,"h1",0),se(1,"Rename Conditions"),J(),X(2,"div",1),ot(3,uE,1,1,null,null,tE),J(),X(5,"div",2)(6,"button",3),ye("click",function(){return i.submit()}),se(7,"Submit"),J(),X(8,"button",3),ye("click",function(){return i.close()}),se(9,"Close"),J()()),n&2&&(ae(3),st(i.projects))},dependencies:[Lt,It,rr,tr,Jt,St,er,gr,mr,Zo,Yo,qo,Ko,es,Qo,ts,Jo,Wo,Xo,Nt,xt,$t,nr],encapsulation:2})}}return r})();var Ep=(()=>{class r{set settings(t){for(let n in t)this._settings[n]=t[n];this._settings&&this.form.patchValue(this._settings)}get settings(){return this._settings}constructor(t,n){this.fb=t,this.dialog=n,this._settings={},this.form=this.fb.group({marginLeft:150,marginRight:100,marginTop:100,marginBottom:100,titleTextSize:14,showTitle:!0,height:500,barSize:50})}submit(){this.dialog.close(this.form.value)}close(){this.dialog.close()}static{this.\u0275fac=function(n){return new(n||r)(Le(Ut),Le(Ot))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-plot-settings"]],inputs:{settings:"settings"},decls:46,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],[2,"display","flex","flex-direction","column","gap","5px"],["matInput","","formControlName","height","type","number"],["matInput","","formControlName","barSize","type","number"],["matInput","","formControlName","marginLeft","type","number"],["matInput","","formControlName","marginRight","type","number"],["matInput","","formControlName","marginTop","type","number"],["matInput","","formControlName","marginBottom","type","number"],["formControlName","showTitle"],["matInput","","formControlName","titleTextSize","type","number"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(X(0,"h5",0),se(1,"Plot General Settings"),J(),X(2,"div",1)(3,"form",2)(4,"section",3)(5,"b"),se(6,"Overall Size"),J(),X(7,"mat-form-field"),Be(8,"input",4),X(9,"mat-label"),se(10,"Height"),J()(),X(11,"mat-form-field"),Be(12,"input",5),X(13,"mat-label"),se(14,"Bar size"),J()(),X(15,"mat-form-field"),Be(16,"input",6),X(17,"mat-label"),se(18,"Margin Left"),J()(),X(19,"mat-form-field"),Be(20,"input",7),X(21,"mat-label"),se(22,"Margin Right"),J()(),X(23,"mat-form-field"),Be(24,"input",8),X(25,"mat-label"),se(26,"Margin Top"),J()(),X(27,"mat-form-field"),Be(28,"input",9),X(29,"mat-label"),se(30,"Margin Bottom"),J()()(),Be(31,"mat-divider"),X(32,"section",3)(33,"b"),se(34,"Title"),J(),X(35,"mat-checkbox",10),se(36,"Show Title"),J(),X(37,"mat-form-field"),Be(38,"input",11),X(39,"mat-label"),se(40,"Title Text Size"),J()()()()(),X(41,"div",12)(42,"button",13),ye("click",function(){return i.close()}),se(43,"Cancel"),J(),X(44,"button",13),ye("click",function(){return i.submit()}),se(45,"Save"),J()()),n&2&&(ae(3),De("formGroup",i.form))},dependencies:[Lt,It,rr,tr,Jt,Oo,St,er,gr,mr,$t,nr,yr,Ri,Nt,xt,Lo],encapsulation:2})}}return r})();function cE(r,e){if(r&1){let t=We();X(0,"mat-checkbox",12),pr("ngModelChange",function(i){Ae(t);let a=ce(2);return vr(a.collate.settings.showTags,i)||(a.collate.settings.showTags=i),Pe(i)}),se(1,"Show Tags"),J()}if(r&2){let t=ce(2);hr("ngModel",t.collate.settings.showTags)}}function dE(r,e){if(r&1){let t=We();X(0,"h1",15),ye("click",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditTitle())}),se(1),J(),Be(2,"br")}if(r&2){let t=ce(3);ae(),pt(t.collate.title)}}function fE(r,e){if(r&1){let t=We();X(0,"div")(1,"mat-form-field",16)(2,"input",17),ye("keydown.enter",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditTitle())}),pr("ngModelChange",function(i){Ae(t);let a=ce(3);return vr(a.collate.title,i)||(a.collate.title=i),Pe(i)}),J()(),X(3,"button",18),ye("click",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditTitle())}),X(4,"mat-icon"),se(5,"save"),J()()()}if(r&2){let t=ce(3);ae(2),hr("ngModel",t.collate.title)}}function hE(r,e){if(r&1){let t=We();X(0,"div",19),ye("click",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),se(1),J()}if(r&2){let t=ce(3);ae(),pt(t.collate.greeting)}}function vE(r,e){if(r&1){let t=We();X(0,"div")(1,"mat-form-field",20)(2,"input",17),ye("keydown.enter",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),pr("ngModelChange",function(i){Ae(t);let a=ce(3);return vr(a.collate.greeting,i)||(a.collate.greeting=i),Pe(i)}),J()(),X(3,"button",18),ye("click",function(){Ae(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),X(4,"mat-icon"),se(5,"save"),J()()()}if(r&2){let t=ce(3);ae(2),hr("ngModel",t.collate.greeting)}}function pE(r,e){if(r&1&&(X(0,"div",9)(1,"div",13),Fe(2,dE,3,1)(3,fE,6,1,"div")(4,hE,2,1,"div",14)(5,vE,6,1,"div"),J()()),r&2){let t=ce(2);ae(2),$e(t.editTitle?3:2),ae(2),$e(t.editGreeting?5:4)}}function gE(r,e){if(r&1){let t=We();X(0,"div",1)(1,"button",21),ye("click",function(){Ae(t);let i=ce(2);return Pe(i.openCollateTagCreateDialog())}),se(2,"Add Tag +"),J()(),X(3,"div",22)(4,"app-collate-tags",23),ye("collageTagsChange",function(i){Ae(t);let a=ce(2);return Pe(a.handleCollageTagsChange(i))}),J()()}if(r&2){let t=ce(2);ae(4),De("collageTags",t.collate.tags)}}function mE(r,e){if(r&1&&Be(0,"mat-tab",25),r&2){let t=e.$implicit;De("label",t)}}function yE(r,e){if(r&1){let t=We();X(0,"div",11)(1,"mat-tab-group",24),ye("selectedTabChange",function(){Ae(t);let i=ce(2);return Pe(i.filterDataBySearchTerm())}),pr("selectedIndexChange",function(i){Ae(t);let a=ce(2);return vr(a.selectedIndex,i)||(a.selectedIndex=i),Pe(i)}),ot(2,mE,1,1,"mat-tab",25,Ir),J()()}if(r&2){let t=ce(2);ae(),hr("selectedIndex",t.selectedIndex),De("mat-stretch-tabs",!1),ae(),st(t.searchTerms)}}function CE(r,e){if(r&1){let t=We();X(0,"app-collate-project-list",27),ye("deleteProject",function(i){Ae(t);let a=ce(4);return Pe(a.deleteProject(i))})("projectOrderChanged",function(i){Ae(t);let a=ce(4);return Pe(a.onProjectOrderChanged(i))}),J()}if(r&2){let t=ce(4);De("searchTerm",t.selectedSearchTerm)("projectConditionColorMap",t.collate.settings.projectConditionColorMap)("projects",t.projects)("filteredResults",t.filteredResults)("renameCondition",t.collate.settings.renameSampleCondition)}}function wE(r,e){if(r&1&&Fe(0,CE,1,5,"app-collate-project-list",26),r&2){let t=ce(3);$e(t.collate.settings.projectConditionColorMap&&t.collate.settings.renameSampleCondition?0:-1)}}function bE(r,e){if(r&1&&Fe(0,wE,1,1),r&2){let t=ce(2);$e(t.collate.settings?0:-1)}}function xE(r,e){if(r&1){let t=We();X(0,"mat-toolbar")(1,"mat-toolbar-row"),Be(2,"span",2),Fe(3,cE,2,1,"mat-checkbox",3),X(4,"button",4),ye("click",function(){Ae(t);let i=ce();return Pe(i.goToCollateView())}),X(5,"mat-icon"),se(6,"visibility"),J()(),X(7,"button",5),ye("click",function(){Ae(t);let i=ce();return Pe(i.openProjectAddDialog())}),X(8,"mat-icon"),se(9,"add"),J()(),X(10,"button",6),ye("click",function(){Ae(t);let i=ce();return Pe(i.updateCollate())}),X(11,"mat-icon"),se(12,"save"),J()(),X(13,"button",7)(14,"mat-icon"),se(15,"more_vert"),J()(),X(16,"mat-menu",null,0)(18,"button",8),ye("click",function(){Ae(t);let i=ce();return Pe(i.openReorderDialog())}),se(19,"Reorder Analysis Groups"),J(),X(20,"button",8),ye("click",function(){Ae(t);let i=ce();return Pe(i.openVisibilityDialog())}),se(21,"Change Analysis Group Visibility"),J(),X(22,"button",8),ye("click",function(){Ae(t);let i=ce();return Pe(i.openConditionColorEditorDialog())}),se(23,"Set Condition Colors"),J(),X(24,"button",8),ye("click",function(){Ae(t);let i=ce();return Pe(i.openPlotSettings())}),se(25,"Change Plot General Settings"),J(),X(26,"button",8),ye("click",function(){Ae(t);let i=ce();return Pe(i.openRenameConditionDialog())}),se(27,"Rename Condition"),J()()()(),Fe(28,pE,6,2,"div",9)(29,gE,5,1),X(30,"div",1)(31,"app-collate-search",10),ye("searchResultID",function(i){Ae(t);let a=ce();return Pe(a.getSearchFromID(i))}),J()(),Fe(32,yE,4,2,"div",11)(33,bE,1,1)}if(r&2){let t=fr(17),n=ce();ae(3),$e(n.collate?3:-1),ae(10),De("matMenuTriggerFor",t),ae(15),$e(n.collate?28:-1),ae(),$e(n.collate?29:-1),ae(2),De("projects",n.projects),ae(),$e(n.searchTerms.length>0?32:-1),ae(),$e(n.collate?33:-1)}}function EE(r,e){r&1&&(X(0,"div",1)(1,"p"),se(2," You do not have permission to edit this collate. "),J()())}var mc=(()=>{class r{set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this._collate=n,this.accounts.getCollatePermissions(n.id).subscribe(i=>{this.canEdit=i.edit}),this.projects=n.projects,this._collate.settings||(this._collate.settings={projectOrder:this.projects.map(i=>i.id),analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),this._collate.settings.plotSettings||(this._collate.settings.plotSettings={}),n.settings.projectOrder){let i=this.projects.filter(a=>!n.settings.projectOrder.includes(a.id));this.projects=this.projects.filter(a=>n.settings.projectOrder.includes(a.id)),this.projects=this.projects.concat(i)}if(this.collate&&"showTags"in this.collate.settings&&(this.collate.settings.showTags=!1),this.collate?.settings.projectConditionColorMap)this.graph.projectConditionColorMap=this.collate.settings.projectConditionColorMap;else{this.collate.settings.projectConditionColorMap={};for(let i of this.projects)this.collate.settings.projectConditionColorMap[i.id]={}}if(!this.collate?.settings.renameSampleCondition){this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)})}})}get collate(){return this._collate}set collate(t){this._collate=t}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,n,i,a,o,s,u){this.accounts=t,this.graph=n,this.router=i,this.snackBar=a,this.dialog=o,this.collateService=s,this.web=u,this._collate=null,this.canEdit=!1,this.projects=[],this.selectedIndex=0,this.editTitle=!1,this.editGreeting=!1,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this.searchTerms=[],this._selectedSearchTerm="",this.filteredResults={},this.removedTags=[]}openProjectAddDialog(){this.dialog.open(dp).afterClosed().subscribe(n=>{n&&(this.projects=this.projects.concat(n),this.collate&&(this.collate.projects=this.projects,this.updateProjectOrder()))})}updateProjectOrder(){this._collate&&(this._collate.settings.projectOrder=this.projects.map(t=>t.id)),console.log(this.collate)}updateCollate(){this._collate&&this.collateService.updateCollate(this._collate.id,this._collate).subscribe(()=>{if(this.removedTags.length>0){let t=this.removedTags.map(n=>this.collateService.removeTagFromCollate(this._collate?.id,n.id));yc(t).subscribe(()=>{this.showSnackBar("Collate saved successfully"),this.removedTags=[]})}else this.showSnackBar("Collate saved successfully")})}toggleEditTitle(){this.editTitle=!this.editTitle}toggleEditGreeting(){this.editGreeting=!this.editGreeting}saveTitle(){this.toggleEditTitle(),this.updateCollate()}saveGreeting(){this.toggleEditGreeting(),this.updateCollate()}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{console.log(n)}),this.web.getSearchResults(t,99999).subscribe(n=>{console.log(n.results),this.distributeSearchResults(n.results).then()})}associateAnalysisGroupsWithProjects(){return Et(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return Et(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(i=>i.search_term===this.selectedSearchTerm)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(n=>{let i=parseInt(n),a=this.collate?.settings.analysisGroupOrderMap[i];if(!t[i]||!a)return;let o=t[i].filter(s=>!a.includes(s.analysis_group.id));if(t[i]=t[i].filter(s=>a.includes(s.analysis_group.id)),t[i]=t[i].sort((s,u)=>a.indexOf(s.analysis_group.id)-a.indexOf(u.analysis_group.id)),t[i]=t[i].concat(o),this.collate?.settings?.projectAnalysisGroupVisibility){let s=this.collate?.settings.projectAnalysisGroupVisibility[i];t[i]=t[i].filter(u=>!s||!(u.analysis_group.id in s)?!0:s[u.analysis_group.id])}}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults()}onProjectOrderChanged(t){this.projects=t,this.updateProjectOrder()}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}deleteProject(t){this.projects=this.projects.filter(n=>n.id!==t.id),this.updateProjectOrder()}goToCollateView(){this._collate&&this.router.navigate(["/collate/view",this._collate.id])}onSearchResultsChange(t,n){this.filteredResults[n]=t,this.collate&&(this.collate.settings.analysisGroupOrderMap||(this.collate.settings.analysisGroupOrderMap={}),this.collate.settings.analysisGroupOrderMap[n]=t.map(i=>i.analysis_group.id),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{this.collate.settings.analysisGroupOrderMap[i]=Array.from(new Set(this.collate.settings.analysisGroupOrderMap[i]))}))}openVisibilityDialog(){let t=this.dialog.open(fs);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),u=this.collate?.settings.analysisGroupOrderMap[s];if(!u||!i[s])return;let l=i[s].filter(c=>!u.includes(c.id));i[s]=i[s].filter(c=>u.includes(c.id)),i[s]=i[s].sort((c,d)=>u.indexOf(c.id)-u.indexOf(d.id)),i[s]=i[s].concat(l)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}openReorderDialog(){let t=this.dialog.open(hp);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(a=>{i[a.project]||(i[a.project]=[]),i[a.project].push(a)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let o=parseInt(a),s=this.collate?.settings.analysisGroupOrderMap[o];if(!s||!i[o])return;let u=i[o].filter(l=>!s.includes(l.id));i[o]=i[o].filter(l=>s.includes(l.id)),i[o]=i[o].sort((l,c)=>s.indexOf(l.id)-s.indexOf(c.id)),i[o]=i[o].concat(u)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects}),t.afterClosed().subscribe(n=>{this.projects=n.projects,this.updateProjectOrder(),this.projectAnalysisGroups=n.projectAnalysisGroupMap;let i={};Object.keys(this.projectAnalysisGroups).forEach(a=>{i[a]=this.projectAnalysisGroups[a].map(o=>o.id)}),this.collate&&(this.collate.settings.analysisGroupOrderMap=i,this.filteredResults=this.getFilteredSearchResults())})}openConditionColorEditorDialog(){let t=this.dialog.open(wp);t.componentInstance.projectConditionColorMap=this.collate?.settings?.projectConditionColorMap,t.componentInstance.projects=this.projects,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.projectConditionColorMap=n),this.graph.projectConditionColorMap=Object.assign({},n),this.filteredResults=this.getFilteredSearchResults(),this.graph.redrawTrigger.next(!0)})}openCollateTagCreateDialog(){this.dialog.open(bp).afterClosed().subscribe(n=>{n&&n.name&&(n.existing&&n.id&&n.id!==-1?this.collateService.addTagToCollate(this.collate?.id,n.id).subscribe(i=>{this.collate&&this.collate.tags.push(i)}):this.collateService.createCollateTag(n.name).subscribe(i=>{this.collateService.addTagToCollate(this.collate?.id,i.id).subscribe(a=>{this.collate&&this.collate.tags.push(a)})}))})}handleCollageTagsChange(t){this.collate&&(this.removedTags=this.collate.tags.filter(n=>!t.includes(n)),this.collate.tags=t)}openRenameConditionDialog(){if(this.collate){let t=this.dialog.open(xp);t.componentInstance.projects=this.collate.projects,t.componentInstance.renameSampleCondition=this.collate.settings.renameSampleCondition,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.renameSampleCondition=Object.assign({},n),console.log(this.collate.settings.renameSampleCondition))})}}openPlotSettings(){if(this.collate){let t=this.dialog.open(Ep);t.componentInstance.settings=this.collate.settings.plotSettings,t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.plotSettings=n,this.graph.plotSettings=n,this.graph.redrawTrigger.next(!0))})}}static{this.\u0275fac=function(n){return new(n||r)(Le(Kr),Le(is),Le(Ti),Le(Fr),Le(_n),Le(qr),Le(Cr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-editor"]],inputs:{collateId:"collateId"},decls:2,vars:1,consts:[["extraActionsMenu","matMenu"],[2,"display","flex","justify-content","center"],[1,"spacer"],[3,"ngModel"],["type","button","aria-label","View Collate","mat-icon-button","",3,"click"],["type","button","aria-label","Add Projects","mat-icon-button","",3,"click"],["type","button","aria-label","Update Collate","mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[3,"searchResultID","projects"],[2,"padding","20px"],[3,"ngModelChange","ngModel"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"],[3,"click"],[2,"font-size","2em","text-align","center","font-family","Roboto, Helvetica Neue, sans-serif","padding","5px"],["matInput","",3,"keydown.enter","ngModelChange","ngModel"],["mat-icon-button","",3,"click"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif",3,"click"],[2,"font-size","25px","text-align","center","font-family","'Roboto', 'Arial Narrow', sans-serif","padding","5px"],["mat-button","",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTagsChange","collageTags"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"label"],[3,"searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"],[3,"deleteProject","projectOrderChanged","searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"]],template:function(n,i){n&1&&Fe(0,xE,34,7)(1,EE,3,0,"div",1),n&2&&$e(i.canEdit?0:1)},dependencies:[$o,Xr,Qt,Uo,Mn,Jt,St,Sn,ls,ns,rs,$t,nr,cs,Ai,Di,Pi,xt,ds,Ri],styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();var TE=[{component:nd,path:""},{component:Tl,path:"view"},{component:Tl,path:"view/:collateId"},{component:Tl,path:"view/:collateId/:sessionId"},{component:mc,path:"edit"},{component:mc,path:"edit/:collateId"}],ZM=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=Eo({type:r})}static{this.\u0275inj=wo({imports:[Ro,Nc.forChild(TE)]})}}return r})();export{ZM as CollateModule};
