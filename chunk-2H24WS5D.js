import"./chunk-TXVKS7A4.js";import"./chunk-FZARZO7L.js";import"./chunk-ICJHBBWJ.js";import{b as yt,c as ct,d as re}from"./chunk-7DKFOYW7.js";import{a as dt}from"./chunk-WWTDWMRQ.js";import{a as Ke}from"./chunk-PAQXWSEM.js";import{a as Ze,b as Je}from"./chunk-WY47XU7V.js";import"./chunk-BCJNPHGZ.js";import"./chunk-ODYICLLL.js";import{a as Xe,b as et,c as tt,d as it,e as nt,f as ot,g as rt,h as at,i as st,j as lt}from"./chunk-QJTC7KEB.js";import"./chunk-V74EGD2L.js";import"./chunk-2TENQMCH.js";import{a as qe}from"./chunk-S64EHP4V.js";import{a as $e,f as Ye,h as Ue}from"./chunk-GDFVYAUB.js";import{g as Z}from"./chunk-RXO4XHOA.js";import{A as Ne,Ba as G,Ca as $,Da as F,E as Be,F as ze,Fa as Y,Ha as U,J as He,Ma as W,Na as q,Qa as K,Ra as We,Sa as A,V as Q,W as je,X as N,g as Pe,pa as B,s as Qe,ta as z,ua as H,wa as k,ya as j,za as Ge}from"./chunk-5SPFYWQ6.js";import"./chunk-3CIC7QKD.js";import{h as Ae,l as Oe,p as Ve}from"./chunk-3HIIXXHG.js";import{$b as be,Aa as I,Cc as Te,Db as ne,Ea as _e,Eb as h,G as de,Gb as oe,Gc as O,Ha as fe,Kb as u,Mb as ge,Na as Se,Nb as ve,Ob as o,Pb as r,Qb as _,Rb as x,Sb as w,Ub as M,Xb as f,Xc as Le,Zb as m,_b as ye,bb as V,bc as P,bd as ke,cd as Fe,e as vt,ea as me,eb as l,ec as xe,fa as ee,fc as we,gc as De,ha as he,ka as D,kb as p,kc as s,lc as E,m as X,mc as R,p as ce,pa as pe,qa as v,ra as y,rb as g,sa as ue,sb as te,tb as Ce,tc as Re,uc as Me,vc as Ie,wb as ie,xb as d,xc as Ee}from"./chunk-T5SR6C5N.js";var bt=(t,a)=>a.id;function xt(t,a){if(t&1){let e=M();o(0,"mat-list-option",1),f("click",function(){let n=v(e).$implicit,c=m(2);return y(c.searchSessionSelected.emit(n))}),o(1,"div")(2,"div")(3,"b"),s(4),r()(),o(5,"small"),s(6),Ie(7,"date"),r()()(),_(8,"mat-divider")}if(t&2){let e=a.$implicit;h("value",e)("disabled",e.failed),l(4),E(e.search_term),l(2),E(Ee(7,4,e.created_at,"short"))}}function wt(t,a){if(t&1&&(o(0,"mat-selection-list",0),ge(1,xt,9,7,null,null,bt),r()),t&2){let e=m();h("multiple",!1),l(),ve(e.searchSessionQuery.results)}}var mt=(()=>{class t{set searchSessionQuery(e){this._searchSessionQuery=e}get searchSessionQuery(){return this._searchSessionQuery}constructor(){this._searchSessionQuery=void 0,this.searchSessionSelected=new I}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=g({type:t,selectors:[["app-search-session-list"]],inputs:{searchSessionQuery:"searchSessionQuery"},outputs:{searchSessionSelected:"searchSessionSelected"},decls:1,vars:1,consts:[[3,"multiple"],[3,"click","value","disabled"]],template:function(i,n){i&1&&d(0,wt,3,1,"mat-selection-list",0),i&2&&u(n.searchSessionQuery?0:-1)},dependencies:[$e,Ye,Ue,ke],encapsulation:2})}}return t})();var Dt=["mat-sort-header",""],Rt=["*"];function Mt(t,a){t&1&&(o(0,"div",2),ue(),o(1,"svg",3),_(2,"path",4),r()())}var ht=new he("MAT_SORT_DEFAULT_OPTIONS"),ae=(()=>{class t{_defaultOptions;_initializedStream=new ce(1);sortables=new Map;_stateChanges=new X;active;start="asc";get direction(){return this._direction}set direction(e){this._direction=e}_direction="";disableClear;disabled=!1;sortChange=new I;initialized=this._initializedStream;constructor(e){this._defaultOptions=e}register(e){this.sortables.set(e.id,e)}deregister(e){this.sortables.delete(e.id)}sort(e){this.active!=e.id?(this.active=e.id,this.direction=e.start?e.start:this.start):this.direction=this.getNextSortDirection(e),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(e){if(!e)return"";let i=e?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear,n=It(e.start||this.start,i),c=n.indexOf(this.direction)+1;return c>=n.length&&(c=0),n[c]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}static \u0275fac=function(i){return new(i||t)(p(ht,8))};static \u0275dir=Ce({type:t,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",O],disabled:[2,"matSortDisabled","disabled",O]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[ie,pe]})}return t})();function It(t,a){let e=["asc","desc"];return t=="desc"&&e.reverse(),a||e.push(""),e}var Et=(()=>{class t{changes=new X;static \u0275fac=function(i){return new(i||t)};static \u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var pt=(()=>{class t{_intl=D(Et);_sort=D(ae,{optional:!0});_columnDef=D("MAT_SORT_HEADER_COLUMN_DEF",{optional:!0});_changeDetectorRef=D(Te);_focusMonitor=D(Ne);_elementRef=D(_e);_ariaDescriber=D(Qe,{optional:!0});_renderChanges;_animationModule=D(Se,{optional:!0});_recentlyCleared=fe(null);_sortButton;id;arrowPosition="after";start;disabled=!1;get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(e){this._updateSortActionDescription(e)}_sortActionDescription="Sort";disableClear;constructor(){D(Pe).load(He);let e=D(ht,{optional:!0});this._sort,e?.arrowPosition&&(this.arrowPosition=e?.arrowPosition)}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._sort.register(this),this._renderChanges=de(this._sort._stateChanges,this._sort.sortChange).subscribe(()=>this._changeDetectorRef.markForCheck()),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(()=>this._recentlyCleared.set(null))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._renderChanges?.unsubscribe(),this._sortButton&&this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription)}_toggleOnInteraction(){if(!this._isDisabled()){let e=this._isSorted(),i=this._sort.direction;this._sort.sort(this),this._recentlyCleared.set(e&&!this._isSorted()?i:null)}}_handleKeydown(e){(e.keyCode===32||e.keyCode===13)&&(e.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&(this._sort.direction==="asc"||this._sort.direction==="desc")}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?this._sort.direction=="asc"?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(e){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,e)),this._sortActionDescription=e}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(i,n){i&1&&f("click",function(){return n._toggleOnInteraction()})("keydown",function(C){return n._handleKeydown(C)})("mouseleave",function(){return n._recentlyCleared.set(!1)}),i&2&&(ne("aria-sort",n._getAriaSortAttribute()),oe("mat-sort-header-disabled",n._isDisabled()))},inputs:{id:[0,"mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",disabled:[2,"disabled","disabled",O],sortActionDescription:"sortActionDescription",disableClear:[2,"disableClear","disableClear",O]},exportAs:["matSortHeader"],features:[ie],attrs:Dt,ngContentSelectors:Rt,decls:4,vars:17,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],[1,"mat-sort-header-arrow"],["viewBox","0 -960 960 960","focusable","false","aria-hidden","true"],["d","M440-240v-368L296-464l-56-56 240-240 240 240-56 56-144-144v368h-80Z"]],template:function(i,n){i&1&&(ye(),o(0,"div",0)(1,"div",1),be(2),r(),d(3,Mt,3,0,"div",2),r()),i&2&&(oe("mat-sort-header-sorted",n._isSorted())("mat-sort-header-position-before",n.arrowPosition==="before")("mat-sort-header-descending",n._sort.direction==="desc")("mat-sort-header-ascending",n._sort.direction==="asc")("mat-sort-header-recently-cleared-ascending",n._recentlyCleared()==="asc")("mat-sort-header-recently-cleared-descending",n._recentlyCleared()==="desc")("mat-sort-header-animations-disabled",n._animationModule==="NoopAnimations"),ne("tabindex",n._isDisabled()?null:0)("role",n._isDisabled()?null:"button"),l(3),u(n._renderArrow()?3:-1))},styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-sort-header-content{display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}@keyframes _mat-sort-header-recently-cleared-ascending{from{transform:translateY(0);opacity:1}to{transform:translateY(-25%);opacity:0}}@keyframes _mat-sort-header-recently-cleared-descending{from{transform:translateY(0) rotate(180deg);opacity:1}to{transform:translateY(25%) rotate(180deg);opacity:0}}.mat-sort-header-arrow{height:12px;width:12px;position:relative;transition:transform 225ms cubic-bezier(0.4, 0, 0.2, 1),opacity 225ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;overflow:visible;color:var(--mat-sort-arrow-color, var(--mat-sys-on-surface))}.mat-sort-header.cdk-keyboard-focused .mat-sort-header-arrow,.mat-sort-header.cdk-program-focused .mat-sort-header-arrow,.mat-sort-header:hover .mat-sort-header-arrow{opacity:.54}.mat-sort-header .mat-sort-header-sorted .mat-sort-header-arrow{opacity:1}.mat-sort-header-descending .mat-sort-header-arrow{transform:rotate(180deg)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transform:translateY(-25%)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-ascending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-recently-cleared-descending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-descending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-animations-disabled .mat-sort-header-arrow{transition-duration:0ms;animation-duration:0ms}.mat-sort-header-arrow svg{width:24px;height:24px;fill:currentColor;position:absolute;top:50%;left:50%;margin:-12px 0 0 -12px;transform:translateZ(0)}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}"],encapsulation:2,changeDetection:0})}return t})();var Ui=ze.ENTERING+" "+Be.STANDARD_CURVE;var Tt=["table"],Lt=t=>({"highlighted-row":t});function kt(t,a){t&1&&(o(0,"div",1)(1,"h2"),s(2,"No results found"),r()())}function Ft(t,a){t&1&&(o(0,"th",20),s(1," Primary ID "),r())}function At(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.primary_id," ")}}function Ot(t,a){t&1&&(o(0,"th",20),s(1," UniProt Accession ID "),r())}function Vt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.uniprot_id," ")}}function Pt(t,a){t&1&&(o(0,"th",20),s(1," Gene name "),r())}function Qt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.gene_name," ")}}function Nt(t,a){t&1&&(o(0,"th",22),s(1," Log2 FC "),r())}function Bt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.log2_fc," ")}}function zt(t,a){t&1&&(o(0,"th",22),s(1," -Log10(P-Value) "),r())}function Ht(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.log10_p," ")}}function jt(t,a){t&1&&(o(0,"th",20),s(1," Comparison "),r())}function Gt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.comparison_label," ")}}function $t(t,a){t&1&&(o(0,"th",20),s(1," Search term "),r())}function Yt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.search_term," ")}}function Ut(t,a){t&1&&(o(0,"th",20),s(1," Condition A "),r())}function Wt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.condition_A,"")}}function qt(t,a){t&1&&(o(0,"th",20),s(1," Condition B "),r())}function Kt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.condition_B,"")}}function Zt(t,a){t&1&&(o(0,"th",20),s(1," File "),r())}function Jt(t,a){if(t&1&&(o(0,"td",21),s(1),r()),t&2){let e=a.$implicit;l(),R(" ",e.file.name," ")}}function Xt(t,a){t&1&&(o(0,"th",20),s(1," Analysis Group "),r())}function ei(t,a){if(t&1&&(o(0,"td",21)(1,"a",23),s(2),r()()),t&2){let e=a.$implicit;l(),P("href","/#/analysis-group/",e.analysis_group.id,"",V),l(),E(e.analysis_group.name)}}function ti(t,a){t&1&&_(0,"tr",24)}function ii(t,a){if(t&1){let e=M();o(0,"tr",25),f("click",function(){let n=v(e).$implicit,c=m(3);return y(c.handleSelection(n))}),r()}if(t&2){let e=a.$implicit,i=m(3);h("ngClass",Re(1,Lt,i.selectedRow===e))}}function ni(t,a){if(t&1){let e=M();o(0,"table",3,0),f("matSortChange",function(n){v(e);let c=m(2);return y(c.handleSortChange(n))}),x(2,4),d(3,Ft,2,0,"th",5)(4,At,2,1,"td",6),w(),x(5,7),d(6,Ot,2,0,"th",5)(7,Vt,2,1,"td",6),w(),x(8,8),d(9,Pt,2,0,"th",5)(10,Qt,2,1,"td",6),w(),x(11,9),d(12,Nt,2,0,"th",10)(13,Bt,2,1,"td",6),w(),x(14,11),d(15,zt,2,0,"th",10)(16,Ht,2,1,"td",6),w(),x(17,12),d(18,jt,2,0,"th",5)(19,Gt,2,1,"td",6),w(),x(20,13),d(21,$t,2,0,"th",5)(22,Yt,2,1,"td",6),w(),x(23,14),d(24,Ut,2,0,"th",5)(25,Wt,2,1,"td",6),w(),x(26,15),d(27,qt,2,0,"th",5)(28,Kt,2,1,"td",6),w(),x(29,16),d(30,Zt,2,0,"th",5)(31,Jt,2,1,"td",6),w(),x(32,17),d(33,Xt,2,0,"th",5)(34,ei,3,3,"td",6),w(),d(35,ti,1,0,"tr",18)(36,ii,1,3,"tr",19),r()}if(t&2){let e=m(2);h("dataSource",e.searchResultQuery.results),l(35),h("matHeaderRowDef",e.displayedColumns),l(),h("matRowDefColumns",e.displayedColumns)}}function oi(t,a){if(t&1&&d(0,kt,3,0,"div",1)(1,ni,37,3,"table",2),t&2){let e=m();u(e.searchResultQuery.results.length===0?0:1)}}var ut=(()=>{class t{set searchResultQuery(e){this._searchResultQuery=e,this.table&&this.table.renderRows()}get searchResultQuery(){return this._searchResultQuery}constructor(){this.displayedColumns=["primary_id","gene_name","uniprot_id","search_term","condition_A","condition_B","log2_fc","log10_p","file","comparison_label","analysis_group"],this._searchResultQuery=void 0,this.selectedRow=void 0,this.selected=new I,this.sortChange=new I}handleSelection(e){this.selected.emit(e),this.selectedRow=e}handleSortChange(e){this.sortChange.emit(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=g({type:t,selectors:[["app-search-result-list"]],viewQuery:function(i,n){if(i&1&&xe(Tt,5),i&2){let c;we(c=De())&&(n.table=c.first)}},inputs:{searchResultQuery:"searchResultQuery"},outputs:{selected:"selected",sortChange:"sortChange"},decls:1,vars:1,consts:[["table",""],[1,"no-results"],["mat-table","","matSort","",3,"dataSource"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","log10_p"],["matColumnDef","comparison_label"],["matColumnDef","search_term"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","file"],["matColumnDef","analysis_group"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["target","_blank",3,"href"],["mat-header-row",""],["mat-row","",3,"click","ngClass"]],template:function(i,n){i&1&&d(0,oi,2,1),i&2&&u(n.searchResultQuery?0:-1)},dependencies:[Xe,it,nt,et,ot,tt,st,lt,at,rt,ae,pt,Le],styles:[".mat-mdc-row[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-mdc-row[_ngcontent-%COMP%]:hover   .mat-mdc-cell[_ngcontent-%COMP%]{border-color:currentColor}.highlighted-row[_ngcontent-%COMP%]{background-color:#009dff}"]})}}return t})();var ai=vt(yt());re.plotlyjs=ai;var _t=(()=>{class t{set annotationData(e){console.log(e),this._annotationData=e,this.currentColor=0,this.drawVerticalBarChart()}get annotationData(){return this._annotationData}constructor(e,i){this.graph=e,this.accounts=i,this.showOtherConditions=!1,this.title="",this.comparedConditions=[],this._annotationData=[],this.graphData=[],this.graphLayout={xaxis:{title:"Sample",tickfont:{size:17,color:"black"},tickvals:[],ticktext:[]},yaxis:{title:"Value",tickfont:{size:17,color:"black"}},margin:{r:40,l:100,b:120,t:100},width:1e3},this.barSize=50,this.revision=0,this.currentColor=0,this.colorMap={},this.graph.redrawTrigger.subscribe(()=>{this.drawVerticalBarChart()})}drawVerticalBarChart(){let e=document.getElementsByTagName("body")[0],n=window.getComputedStyle(e).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=n,this.graphLayout.paper_bgcolor=n,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let c=this.annotationData,C={},b=[],L=[];for(let S of c)C[S.Condition]||(this.colorMap[S.Condition]||(this.colorMap[S.Condition]=this.graph.defaultColorList[this.currentColor]),C[S.Condition]={x:[],y:[],type:"bar",marker:{color:this.colorMap[S.Condition]},showlegend:!1,name:S.Condition},this.currentColor+=1,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0)),C[S.Condition].y.push(S.Value),C[S.Condition].x.push(S.Sample);let le=[],J=0;for(let S in C)!this.showOtherConditions&&this.comparedConditions.length>0&&!this.comparedConditions.includes(S)||(J=J+C[S].x.length,L.push(C[S].x[Math.round(C[S].x.length/2)-1]),b.push(S),le.push(C[S]));this.graphData=le,this.graphLayout.xaxis.tickvals=L,this.graphLayout.xaxis.ticktext=b,this.title&&(this.graphLayout.title=this.title),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*J,this.revision+=1}toggleOtherConditions(){this.showOtherConditions=!this.showOtherConditions,this.drawVerticalBarChart()}static{this.\u0275fac=function(i){return new(i||t)(p(dt),p(Z))}}static{this.\u0275cmp=g({type:t,selectors:[["app-vertical-bar-chart"]],inputs:{title:"title",comparedConditions:"comparedConditions",annotationData:"annotationData"},decls:6,vars:4,consts:[[2,"display","flex","flex-direction","column","gap","10px"],["mat-raised-button","",3,"click"],[2,"max-width","calc(100vw - 500px)","overflow","auto"],[3,"data","layout","updateOnlyWithRevision","revision"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div")(2,"button",1),f("click",function(){return n.toggleOtherConditions()}),s(3,"Other Conditions"),r()(),o(4,"div",2),_(5,"plotly-plot",3),r()()),i&2&&(l(5),h("data",n.graphData)("layout",n.graphLayout)("updateOnlyWithRevision",!0)("revision",n.revision))},dependencies:[re,ct,je],encapsulation:2})}}return t})();var si=(t,a)=>[t,a];function li(t,a){if(t&1&&_(0,"app-vertical-bar-chart",1),t&2){let e=m();h("title",e.searchResult.condition_A+"-"+e.searchResult.condition_B+" "+e.searchResult.gene_name+"("+e.searchResult.primary_id+")")("comparedConditions",Me(3,si,e.searchResult.condition_A,e.searchResult.condition_B))("annotationData",e.searchResult.searched_data)}}var Ct=(()=>{class t{set searchResult(e){this._searchResult=e}get searchResult(){return this._searchResult}constructor(e,i){this.web=e,this.fb=i,this._searchResult=void 0,this.relatedResultSearched=void 0,this.relatedResultCopyNumber=void 0,this.analysisGroup=void 0,this.analysisGroupDF=void 0,this.analysisGroupDFColumns=[],this.analysisGroupSearched=void 0,this.analysisGroupSearchedColumns=[],this.sampleAnnotations=void 0,this.comparisonMatrix=void 0}getSAIndex(e){return this.analysisGroupSearchedColumns?this.analysisGroupSearchedColumns.indexOf(e):-1}getCMIndex(e){return this.analysisGroupDFColumns?this.analysisGroupDFColumns.indexOf(e):-1}static{this.\u0275fac=function(i){return new(i||t)(p(A),p(F))}}static{this.\u0275cmp=g({type:t,selectors:[["app-selected-result-view"]],inputs:{searchResult:"searchResult"},decls:2,vars:1,consts:[[2,"display","flex","flex-direction","row","justify-content","center"],[3,"title","comparedConditions","annotationData"]],template:function(i,n){i&1&&(o(0,"div",0),d(1,li,1,6,"app-vertical-bar-chart",1),r()),i&2&&(l(),u(n.searchResult.searched_data?1:-1))},dependencies:[_t],encapsulation:2})}}return t})();function ci(t,a){if(t&1&&(o(0,"div"),_(1,"app-selected-result-view",8),r()),t&2){let e=m();l(),h("searchResult",e.selectedSearchResult)}}function di(t,a){if(t&1){let e=M();o(0,"app-search-result-list",9),f("selected",function(n){v(e);let c=m();return y(c.handleSelectedResult(n))})("sortChange",function(n){v(e);let c=m();return y(c.handleSort(n))}),r(),o(1,"mat-paginator",10,0),f("page",function(n){v(e);let c=m();return y(c.handlePageEvent(n))}),s(3,"> "),r()}if(t&2){let e=m();h("searchResultQuery",e.searchResultQuery),l(),h("length",e.searchResultQuery.count)("pageSize",e.pageSize)("showFirstLastButtons",!0)("hidePageSize",!0)("pageIndex",e.pageIndex)}}var gt=(()=>{class t{set searchSession(e){this._searchSession=e,this.titleService.setTitle(`Search - ${e.search_term}`),this.searchResultQuery=void 0,e&&!e.failed&&this.web.getSearchResults(e.id,this.pageSize,0,"df",this.currentSort?.active,this.currentSort?.direction).subscribe(i=>{this.searchResultQuery=i})}get searchSession(){return this._searchSession}constructor(e,i,n,c,C){this.titleService=e,this.web=i,this.fb=n,this.ws=c,this.sb=C,this.baseUrl=We.baseURL,this._searchSession=void 0,this.searchResultQuery=void 0,this.pageSize=10,this.pageIndex=0,this.selectedSearchResult=void 0,this.form=this.fb.group({searchTerm:new k(""),log2_fc:new k(0),log10_p:new k(0)}),this.currentSort=void 0,this.form.valueChanges.subscribe(b=>{this.searchSession.failed||this.web.getSearchResults(this.searchSession.id,this.pageSize,0,"df",this.currentSort?.active,this.currentSort?.direction,b.searchTerm,b.log2_fc,b.log10_p).subscribe(L=>{this.searchResultQuery=L})}),this.ws.searchWSConnection?.subscribe(b=>{if(b&&b.type==="export_status"&&this.web.cinderInstanceID===b.instance_id)switch(b.status){case"error":break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.sb.open("Export complete","Dismiss",{duration:2e3});let L=`${this.baseUrl}/api/search/download_temp_file/?token=${b.file}`;window.open(L,"_blank");break}})}handlePageEvent(e){let i=e.pageIndex*e.pageSize;this.pageSize=e.pageSize,this.web.getSearchResults(this.searchSession.id,this.pageSize,i,"df",this.currentSort?.active,this.currentSort?.direction,this.form.controls.searchTerm.value,this.form.controls.log2_fc.value,this.form.controls.log10_p.value).subscribe(n=>{this.searchResultQuery=n})}handleSelectedResult(e){e&&(this.selectedSearchResult=e)}handleSort(e){this.currentSort=e,this.searchResultQuery&&this.web.getSearchResults(this.searchSession.id,this.pageSize,0,"df",e.active,e.direction,this.form.controls.searchTerm.value,this.form.controls.log2_fc.value,this.form.controls.log10_p.value).subscribe(i=>{this.searchResultQuery=i})}exportData(){this.web.exportSearchData(this.searchSession.id,this.form.controls.searchTerm.value,this.form.controls.log2_fc.value,this.form.controls.log10_p.value,this.web.searchSessionID).subscribe(e=>{})}static{this.\u0275fac=function(i){return new(i||t)(p(Ae),p(A),p(F),p(Ke),p(qe))}}static{this.\u0275cmp=g({type:t,selectors:[["app-search-session-view"]],inputs:{searchSession:"searchSession"},decls:20,vars:3,consts:[["paginator",""],[2,"display","flex","flex-direction","row","justify-content","center"],[2,"width","100%","padding","50px"],[2,"display","flex","flex-direction","row","gap","10px","flex-wrap","wrap",3,"formGroup"],["matInput","","formControlName","searchTerm","type","search","placeholder","Search Term"],["matInput","","type","number","formControlName","log2_fc"],["matInput","","type","number","formControlName","log10_p"],["mat-icon-button","","type","button",3,"click"],[3,"searchResult"],[3,"selected","sortChange","searchResultQuery"],["aria-label","Select page",3,"page","length","pageSize","showFirstLastButtons","hidePageSize","pageIndex"]],template:function(i,n){i&1&&(o(0,"div",1)(1,"div",2),d(2,ci,2,1,"div"),o(3,"form",3)(4,"mat-form-field"),_(5,"input",4),o(6,"mat-label"),s(7,"Filter Results Term"),r()(),o(8,"mat-form-field"),_(9,"input",5),o(10,"mat-label"),s(11,"Filter By Log2 Fold Change"),r()(),o(12,"mat-form-field"),_(13,"input",6),o(14,"mat-label"),s(15,"Filter By log10(P-Value)"),r()(),o(16,"button",7),f("click",function(){return n.exportData()}),o(17,"mat-icon"),s(18,"download"),r()()(),d(19,di,4,6),r()()),i&2&&(l(2),u(n.selectedSearchResult?2:-1),l(),h("formGroup",n.form),l(16),u(n.searchResultQuery?19:-1))},dependencies:[ut,K,Y,j,B,Ge,z,H,G,$,W,U,Ct,q,N,Q],styles:[".selected-result[_ngcontent-%COMP%]{width:500px;border-left:1px solid #000000;display:flex;flex-direction:column;height:calc(100vh - 148px)}"]})}}return t})();function mi(t,a){if(t&1){let e=M();o(0,"div",14)(1,"app-search-session-list",15),f("searchSessionSelected",function(n){v(e);let c=m(3);return y(c.onSearchSessionSelected(n))}),r()(),o(2,"mat-paginator",16,0),f("page",function(n){v(e);let c=m(3);return y(c.handlePageEvent(n))}),r()}if(t&2){let e=m(3);l(),h("searchSessionQuery",e.searchSessionQuery),l(),h("length",e.searchSessionQuery.count)("pageSize",e.pageSize)("showFirstLastButtons",!0)("hidePageSize",!0)("pageIndex",e.pageIndex)}}function hi(t,a){t&1&&(o(0,"p"),s(1,"No search sessions found."),r())}function pi(t,a){if(t&1&&d(0,mi,4,6)(1,hi,2,0,"p"),t&2){let e=m(2);u(e.searchSessionQuery.count>0?0:1)}}function ui(t,a){if(t&1&&(o(0,"div",2)(1,"mat-toolbar")(2,"mat-toolbar-row")(3,"span"),s(4,"Search Session"),r()()(),o(5,"div",10)(6,"form",11)(7,"mat-form-field",12),_(8,"input",13),o(9,"mat-label"),s(10,"Find Search Sessions"),r()()(),d(11,pi,2,1),r()()),t&2){let e=m();l(6),h("formGroup",e.form),l(5),u(e.searchSessionQuery?11:-1)}}function _i(t,a){if(t&1&&(o(0,"a",5)(1,"span",17)(2,"b"),s(3),r()()()),t&2){let e=m();P("href","/#/search-session/",e.searchSession.id,"",V),l(3),E(e.searchSession.search_term)}}function fi(t,a){t&1&&s(0," Select Search Session ")}function Si(t,a){if(t&1){let e=M();o(0,"button",18),f("click",function(){v(e);let n=m();return y(n.deleteSearchSession(n.searchSession.id))}),o(1,"mat-icon"),s(2,"delete"),r()()}}function Ci(t,a){if(t&1&&_(0,"app-search-session-view",9),t&2){let e=m();h("searchSession",e.searchSession)}}var se=(()=>{class t{set searchID(e){e&&(this._searchID=e,this.web.getSearchSession(e).subscribe(i=>{this._searchSession=i}))}get searchID(){return this._searchID}set searchSession(e){this._searchSession=e}get searchSession(){return this._searchSession}constructor(e,i,n,c){this.router=e,this.web=i,this.fb=n,this.accounts=c,this.sidebarOpen=!0,this._searchSession=void 0,this._searchID=0,this.searchSessionQuery=void 0,this.pageSize=10,this.pageIndex=0,this.form=this.fb.group({search:new k("")}),this.web.getSearchSessions(void 0,this.pageSize,0,void 0,this.accounts.loggedIn,this.web.searchSessionID).subscribe(C=>{this.searchSessionQuery=C})}handlePageEvent(e){this.pageSize=e.pageSize;let i=e.pageIndex*e.pageSize;this.form.controls.search.value?this.web.getSearchSessions(void 0,this.pageSize,i,this.form.controls.search.value,this.accounts.loggedIn,this.web.searchSessionID).subscribe(n=>{this.searchSessionQuery=n}):this.web.getSearchSessions(void 0,this.pageSize,i,void 0,this.accounts.loggedIn,this.web.searchSessionID).subscribe(n=>{this.searchSessionQuery=n})}deleteSearchSession(e){this.web.deleteSearchSession(e).subscribe(i=>{this.searchSession=void 0,this.searchSessionQuery?.results?.splice(this.searchSessionQuery.results.findIndex(n=>n.id===e),1)})}toggleSidePanel(){this.sidebarOpen=!this.sidebarOpen}onSearchSessionSelected(e){this.router.navigate(["/search-session",e.id])}static{this.\u0275fac=function(i){return new(i||t)(p(Oe),p(A),p(F),p(Z))}}static{this.\u0275cmp=g({type:t,selectors:[["app-search-session"]],inputs:{searchID:"searchID"},decls:15,vars:4,consts:[["paginator",""],[2,"display","flex","flex-direction","row"],[1,"search-session-side-nav"],[1,"search-session-main-content"],["mat-icon-button","",3,"click"],[3,"href"],[1,"spacer"],["mat-icon-button","","color","accent"],[2,"height","calc(100vh - 64px*2 - 20px)","overflow","auto"],[3,"searchSession"],[2,"display","flex","flex-direction","column","padding","5px"],[3,"formGroup"],[2,"width","100%"],["matInput","","formControlName","search","type","search","placeholder","Find Search Session"],[2,"height","calc(100vh - 64px*4 - 20px)","overflow","auto"],[3,"searchSessionSelected","searchSessionQuery"],["aria-label","Select page",3,"page","length","pageSize","showFirstLastButtons","hidePageSize","pageIndex"],[2,"color","#ba0000"],["mat-icon-button","","color","accent",3,"click"]],template:function(i,n){i&1&&(o(0,"div",1),d(1,ui,12,2,"div",2),o(2,"div",3)(3,"mat-toolbar")(4,"mat-toolbar-row")(5,"button",4),f("click",function(){return n.toggleSidePanel()}),o(6,"mat-icon"),s(7,"menu"),r()(),o(8,"div"),d(9,_i,4,3,"a",5)(10,fi,1,0),r(),_(11,"div",6),d(12,Si,3,0,"button",7),r()(),o(13,"div",8),d(14,Ci,1,1,"app-search-session-view",9),r()()()),i&2&&(l(),u(n.sidebarOpen?1:-1),l(8),u(n.searchSession?9:10),l(3),u(n.searchSession?12:-1),l(2),u(n.searchSession?14:-1))},dependencies:[W,q,U,Y,j,B,z,H,G,$,Q,N,K,Je,Ze,mt,gt],styles:[".search-session-side-nav[_ngcontent-%COMP%]{width:300px;border-right:1px solid #000000;display:flex;flex-direction:column;height:calc(100vh - 64px)}.search-session-main-content[_ngcontent-%COMP%]{flex:1}"]})}}return t})();var gi=[{path:"",component:se},{path:":searchID",component:se}],Un=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=te({type:t})}static{this.\u0275inj=ee({imports:[Fe,Ve.forChild(gi)]})}}return t})();export{Un as SearchSessionModule};
