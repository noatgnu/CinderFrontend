import{a as Uo}from"./chunk-CTSSTTON.js";import{a as Wo}from"./chunk-KITQQU2T.js";import{a as Qo,b as Sn,c as Yo,d as Zi,e as _e,f as Pi,g as ue,h as ge,i as ke}from"./chunk-6AUECKEJ.js";import{a as Ti,b as ki,c as Di,d as Ei}from"./chunk-K6QCGO6N.js";import{a as hi}from"./chunk-7JHXZ374.js";import{a as mi,b as ui}from"./chunk-IZMQYJPO.js";import{a as me}from"./chunk-PXS4FHQ7.js";import{a as Xo,b as Mi,c as ji}from"./chunk-L56QMOZ3.js";import{a as gi,b as fi,c as _i,d as Ci,e as vi,f as xi,g as wi,h as yi,i as bi,j as Si}from"./chunk-3HWSSDVX.js";import{a as Me,b as Do,c as je,d as Eo,e as Po,f as Ao,g as di,h as pi}from"./chunk-Z42QFXJI.js";import{a as si,b as li,c as No,d as ci,e as Ho,f as qo}from"./chunk-RVAXLEUH.js";import{a as Jt}from"./chunk-VDFQ6YOY.js";import{a as ii,c as Ro,d as Go,e as Lo,f as oi,g as $o,h as ni}from"./chunk-J3R6URAN.js";import{a as kt,c as Te,d as Dt,e as Et,f as Pt,g as oe}from"./chunk-NQ4RZB5W.js";import{Aa as Bo,Ba as te,Ca as ee,Da as Rt,Ea as he,Fa as Qt,Ha as ie,Ma as Gt,Na as Lt,Oa as zo,Pa as ri,Q as Se,Qa as ai,Sa as $t,V as Ot,W as vt,X as de,oa as Fo,pa as Bt,ra as Ut,ta as St,ua as qt,va as Vo,wa as Kt,xa as pe,ya as Wt,za as Oo}from"./chunk-3J3KS5SE.js";import{c as Io,d as Yi,g as se,i as Ui,j as Ki,l as Pe,m as Ji}from"./chunk-3CIC7QKD.js";import{h as To,l as be,p as ko}from"./chunk-RUAHQKY3.js";import{$b as yo,$c as ti,Bb as vo,Bc as Je,Cb as xo,D as co,Da as Ni,Db as E,Eb as ce,Fb as qe,Gb as wo,H as po,Jb as H,Kb as ae,Lb as rt,Mb as at,Nb as c,Ob as p,Pb as R,Qb as yt,Rb as bt,Tb as W,Wb as k,Xc as Mo,Yb as g,Yc as Xi,Z as Ge,Zc as Ze,_ as Le,ab as fo,ac as Wi,bb as _o,bd as ei,cb as Hi,d as bn,da as ho,db as u,dc as We,e as lo,ea as zi,eb as F,ec as Qe,f as Tt,fa as $e,fc as Xe,hd as jo,ib as Co,ic as Yt,ja as ze,jc as C,kc as mt,lc as et,mc as bo,nc as It,oc as Ft,pa as mo,pc as Vt,qa as P,qb as Z,qc as So,ra as A,rb as He,rc as Ye,sa as Ne,sb as qi,sc as Qi,ta as uo,uc as Ue,va as go,vc as Ke,wb as V,x as Re,za as ut}from"./chunk-DIXPDQ2Y.js";var nn=bn((Ae,io)=>{"use strict";(function(o,d){typeof Ae=="object"&&typeof io=="object"?io.exports=d():typeof define=="function"&&define.amd?define([],d):typeof Ae=="object"?Ae.QRCodeStyling=d():o.QRCodeStyling=d()})(Ae,()=>(()=>{var o={873:(i,n)=>{var h,S,O=function(){var q=function(T,j){var v=T,a=ct[j],r=null,s=0,m=null,l=[],w={},M=function(f,x){r=function(_){for(var y=new Array(_),b=0;b<_;b+=1){y[b]=new Array(_);for(var $=0;$<_;$+=1)y[b][$]=null}return y}(s=4*v+17),D(0,0),D(s-7,0),D(0,s-7),B(),I(),N(f,x),v>=7&&X(f),m==null&&(m=z(v,a,l)),L(m,x)},D=function(f,x){for(var _=-1;_<=7;_+=1)if(!(f+_<=-1||s<=f+_))for(var y=-1;y<=7;y+=1)x+y<=-1||s<=x+y||(r[f+_][x+y]=0<=_&&_<=6&&(y==0||y==6)||0<=y&&y<=6&&(_==0||_==6)||2<=_&&_<=4&&2<=y&&y<=4)},I=function(){for(var f=8;f<s-8;f+=1)r[f][6]==null&&(r[f][6]=f%2==0);for(var x=8;x<s-8;x+=1)r[6][x]==null&&(r[6][x]=x%2==0)},B=function(){for(var f=_t.getPatternPosition(v),x=0;x<f.length;x+=1)for(var _=0;_<f.length;_+=1){var y=f[x],b=f[_];if(r[y][b]==null)for(var $=-2;$<=2;$+=1)for(var J=-2;J<=2;J+=1)r[y+$][b+J]=$==-2||$==2||J==-2||J==2||$==0&&J==0}},X=function(f){for(var x=_t.getBCHTypeNumber(v),_=0;_<18;_+=1){var y=!f&&(x>>_&1)==1;r[Math.floor(_/3)][_%3+s-8-3]=y}for(_=0;_<18;_+=1)y=!f&&(x>>_&1)==1,r[_%3+s-8-3][Math.floor(_/3)]=y},N=function(f,x){for(var _=a<<3|x,y=_t.getBCHTypeInfo(_),b=0;b<15;b+=1){var $=!f&&(y>>b&1)==1;b<6?r[b][8]=$:b<8?r[b+1][8]=$:r[s-15+b][8]=$}for(b=0;b<15;b+=1)$=!f&&(y>>b&1)==1,b<8?r[8][s-b-1]=$:b<9?r[8][15-b-1+1]=$:r[8][15-b-1]=$;r[s-8][8]=!f},L=function(f,x){for(var _=-1,y=s-1,b=7,$=0,J=_t.getMaskFunction(x),U=s-1;U>0;U-=2)for(U==6&&(U-=1);;){for(var st=0;st<2;st+=1)if(r[y][U-st]==null){var lt=!1;$<f.length&&(lt=(f[$]>>>b&1)==1),J(y,U-st)&&(lt=!lt),r[y][U-st]=lt,(b-=1)==-1&&($+=1,b=7)}if((y+=_)<0||s<=y){y-=_,_=-_;break}}},z=function(f,x,_){for(var y=Ie.getRSBlocks(f,x),b=xe(),$=0;$<_.length;$+=1){var J=_[$];b.put(J.getMode(),4),b.put(J.getLength(),_t.getLengthInBits(J.getMode(),f)),J.write(b)}var U=0;for($=0;$<y.length;$+=1)U+=y[$].dataCount;if(b.getLengthInBits()>8*U)throw"code length overflow. ("+b.getLengthInBits()+">"+8*U+")";for(b.getLengthInBits()+4<=8*U&&b.put(0,4);b.getLengthInBits()%8!=0;)b.putBit(!1);for(;!(b.getLengthInBits()>=8*U||(b.put(236,8),b.getLengthInBits()>=8*U));)b.put(17,8);return function(st,lt){for(var pt=0,Mt=0,wt=0,ht=new Array(lt.length),dt=new Array(lt.length),Y=0;Y<lt.length;Y+=1){var jt=lt[Y].dataCount,ft=lt[Y].totalCount-jt;Mt=Math.max(Mt,jt),wt=Math.max(wt,ft),ht[Y]=new Array(jt);for(var K=0;K<ht[Y].length;K+=1)ht[Y][K]=255&st.getBuffer()[K+pt];pt+=jt;var gt=_t.getErrorCorrectPolynomial(ft),At=ve(ht[Y],gt.getLength()-1).mod(gt);for(dt[Y]=new Array(gt.getLength()-1),K=0;K<dt[Y].length;K+=1){var Nt=K+At.getLength()-dt[Y].length;dt[Y][K]=Nt>=0?At.getAt(Nt):0}}var Ht=0;for(K=0;K<lt.length;K+=1)Ht+=lt[K].totalCount;var Ee=new Array(Ht),Xt=0;for(K=0;K<Mt;K+=1)for(Y=0;Y<lt.length;Y+=1)K<ht[Y].length&&(Ee[Xt]=ht[Y][K],Xt+=1);for(K=0;K<wt;K+=1)for(Y=0;Y<lt.length;Y+=1)K<dt[Y].length&&(Ee[Xt]=dt[Y][K],Xt+=1);return Ee}(b,y)};w.addData=function(f,x){var _=null;switch(x=x||"Byte"){case"Numeric":_=Fe(f);break;case"Alphanumeric":_=Ve(f);break;case"Byte":_=we(f);break;case"Kanji":_=Oe(f);break;default:throw"mode:"+x}l.push(_),m=null},w.isDark=function(f,x){if(f<0||s<=f||x<0||s<=x)throw f+","+x;return r[f][x]},w.getModuleCount=function(){return s},w.make=function(){if(v<1){for(var f=1;f<40;f++){for(var x=Ie.getRSBlocks(f,a),_=xe(),y=0;y<l.length;y++){var b=l[y];_.put(b.getMode(),4),_.put(b.getLength(),_t.getLengthInBits(b.getMode(),f)),b.write(_)}var $=0;for(y=0;y<x.length;y++)$+=x[y].dataCount;if(_.getLengthInBits()<=8*$)break}v=f}M(!1,function(){for(var J=0,U=0,st=0;st<8;st+=1){M(!0,st);var lt=_t.getLostPoint(w);(st==0||J>lt)&&(J=lt,U=st)}return U}())},w.createTableTag=function(f,x){f=f||2;var _="";_+='<table style="',_+=" border-width: 0px; border-style: none;",_+=" border-collapse: collapse;",_+=" padding: 0px; margin: "+(x=x===void 0?4*f:x)+"px;",_+='">',_+="<tbody>";for(var y=0;y<w.getModuleCount();y+=1){_+="<tr>";for(var b=0;b<w.getModuleCount();b+=1)_+='<td style="',_+=" border-width: 0px; border-style: none;",_+=" border-collapse: collapse;",_+=" padding: 0px; margin: 0px;",_+=" width: "+f+"px;",_+=" height: "+f+"px;",_+=" background-color: ",_+=w.isDark(y,b)?"#000000":"#ffffff",_+=";",_+='"/>';_+="</tr>"}return(_+="</tbody>")+"</table>"},w.createSvgTag=function(f,x,_,y){var b={};typeof arguments[0]=="object"&&(f=(b=arguments[0]).cellSize,x=b.margin,_=b.alt,y=b.title),f=f||2,x=x===void 0?4*f:x,(_=typeof _=="string"?{text:_}:_||{}).text=_.text||null,_.id=_.text?_.id||"qrcode-description":null,(y=typeof y=="string"?{text:y}:y||{}).text=y.text||null,y.id=y.text?y.id||"qrcode-title":null;var $,J,U,st,lt=w.getModuleCount()*f+2*x,pt="";for(st="l"+f+",0 0,"+f+" -"+f+",0 0,-"+f+"z ",pt+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',pt+=b.scalable?"":' width="'+lt+'px" height="'+lt+'px"',pt+=' viewBox="0 0 '+lt+" "+lt+'" ',pt+=' preserveAspectRatio="xMinYMin meet"',pt+=y.text||_.text?' role="img" aria-labelledby="'+G([y.id,_.id].join(" ").trim())+'"':"",pt+=">",pt+=y.text?'<title id="'+G(y.id)+'">'+G(y.text)+"</title>":"",pt+=_.text?'<description id="'+G(_.id)+'">'+G(_.text)+"</description>":"",pt+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',pt+='<path d="',J=0;J<w.getModuleCount();J+=1)for(U=J*f+x,$=0;$<w.getModuleCount();$+=1)w.isDark(J,$)&&(pt+="M"+($*f+x)+","+U+st);return(pt+='" stroke="transparent" fill="black"/>')+"</svg>"},w.createDataURL=function(f,x){f=f||2,x=x===void 0?4*f:x;var _=w.getModuleCount()*f+2*x,y=x,b=_-x;return ye(_,_,function($,J){if(y<=$&&$<b&&y<=J&&J<b){var U=Math.floor(($-y)/f),st=Math.floor((J-y)/f);return w.isDark(st,U)?0:1}return 1})},w.createImgTag=function(f,x,_){f=f||2,x=x===void 0?4*f:x;var y=w.getModuleCount()*f+2*x,b="";return b+="<img",b+=' src="',b+=w.createDataURL(f,x),b+='"',b+=' width="',b+=y,b+='"',b+=' height="',b+=y,b+='"',_&&(b+=' alt="',b+=G(_),b+='"'),b+"/>"};var G=function(f){for(var x="",_=0;_<f.length;_+=1){var y=f.charAt(_);switch(y){case"<":x+="&lt;";break;case">":x+="&gt;";break;case"&":x+="&amp;";break;case'"':x+="&quot;";break;default:x+=y}}return x};return w.createASCII=function(f,x){if((f=f||1)<2)return function(ht){ht=ht===void 0?2:ht;var dt,Y,jt,ft,K,gt=1*w.getModuleCount()+2*ht,At=ht,Nt=gt-ht,Ht={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},Ee={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},Xt="";for(dt=0;dt<gt;dt+=2){for(jt=Math.floor((dt-At)/1),ft=Math.floor((dt+1-At)/1),Y=0;Y<gt;Y+=1)K="\u2588",At<=Y&&Y<Nt&&At<=dt&&dt<Nt&&w.isDark(jt,Math.floor((Y-At)/1))&&(K=" "),At<=Y&&Y<Nt&&At<=dt+1&&dt+1<Nt&&w.isDark(ft,Math.floor((Y-At)/1))?K+=" ":K+="\u2588",Xt+=ht<1&&dt+1>=Nt?Ee[K]:Ht[K];Xt+=`
`}return gt%2&&ht>0?Xt.substring(0,Xt.length-gt-1)+Array(gt+1).join("\u2580"):Xt.substring(0,Xt.length-1)}(x);f-=1,x=x===void 0?2*f:x;var _,y,b,$,J=w.getModuleCount()*f+2*x,U=x,st=J-x,lt=Array(f+1).join("\u2588\u2588"),pt=Array(f+1).join("  "),Mt="",wt="";for(_=0;_<J;_+=1){for(b=Math.floor((_-U)/f),wt="",y=0;y<J;y+=1)$=1,U<=y&&y<st&&U<=_&&_<st&&w.isDark(b,Math.floor((y-U)/f))&&($=0),wt+=$?lt:pt;for(b=0;b<f;b+=1)Mt+=wt+`
`}return Mt.substring(0,Mt.length-1)},w.renderTo2dContext=function(f,x){x=x||2;for(var _=w.getModuleCount(),y=0;y<_;y++)for(var b=0;b<_;b++)f.fillStyle=w.isDark(y,b)?"black":"white",f.fillRect(y*x,b*x,x,x)},w};q.stringToBytes=(q.stringToBytesFuncs={default:function(T){for(var j=[],v=0;v<T.length;v+=1){var a=T.charCodeAt(v);j.push(255&a)}return j}}).default,q.createStringToBytes=function(T,j){var v=function(){for(var r=$i(T),s=function(){var I=r.read();if(I==-1)throw"eof";return I},m=0,l={};;){var w=r.read();if(w==-1)break;var M=s(),D=s()<<8|s();l[String.fromCharCode(w<<8|M)]=D,m+=1}if(m!=j)throw m+" != "+j;return l}(),a=63;return function(r){for(var s=[],m=0;m<r.length;m+=1){var l=r.charCodeAt(m);if(l<128)s.push(l);else{var w=v[r.charAt(m)];typeof w=="number"?(255&w)==w?s.push(w):(s.push(w>>>8),s.push(255&w)):s.push(a)}}return s}};var tt,ot,nt,Q,it,ct={L:1,M:0,Q:3,H:2},_t=(tt=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],ot=1335,nt=7973,it=function(T){for(var j=0;T!=0;)j+=1,T>>>=1;return j},(Q={}).getBCHTypeInfo=function(T){for(var j=T<<10;it(j)-it(ot)>=0;)j^=ot<<it(j)-it(ot);return 21522^(T<<10|j)},Q.getBCHTypeNumber=function(T){for(var j=T<<12;it(j)-it(nt)>=0;)j^=nt<<it(j)-it(nt);return T<<12|j},Q.getPatternPosition=function(T){return tt[T-1]},Q.getMaskFunction=function(T){switch(T){case 0:return function(j,v){return(j+v)%2==0};case 1:return function(j,v){return j%2==0};case 2:return function(j,v){return v%3==0};case 3:return function(j,v){return(j+v)%3==0};case 4:return function(j,v){return(Math.floor(j/2)+Math.floor(v/3))%2==0};case 5:return function(j,v){return j*v%2+j*v%3==0};case 6:return function(j,v){return(j*v%2+j*v%3)%2==0};case 7:return function(j,v){return(j*v%3+(j+v)%2)%2==0};default:throw"bad maskPattern:"+T}},Q.getErrorCorrectPolynomial=function(T){for(var j=ve([1],0),v=0;v<T;v+=1)j=j.multiply(ve([1,Ct.gexp(v)],0));return j},Q.getLengthInBits=function(T,j){if(1<=j&&j<10)switch(T){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+T}else if(j<27)switch(T){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+T}else{if(!(j<41))throw"type:"+j;switch(T){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+T}}},Q.getLostPoint=function(T){for(var j=T.getModuleCount(),v=0,a=0;a<j;a+=1)for(var r=0;r<j;r+=1){for(var s=0,m=T.isDark(a,r),l=-1;l<=1;l+=1)if(!(a+l<0||j<=a+l))for(var w=-1;w<=1;w+=1)r+w<0||j<=r+w||l==0&&w==0||m==T.isDark(a+l,r+w)&&(s+=1);s>5&&(v+=3+s-5)}for(a=0;a<j-1;a+=1)for(r=0;r<j-1;r+=1){var M=0;T.isDark(a,r)&&(M+=1),T.isDark(a+1,r)&&(M+=1),T.isDark(a,r+1)&&(M+=1),T.isDark(a+1,r+1)&&(M+=1),M!=0&&M!=4||(v+=3)}for(a=0;a<j;a+=1)for(r=0;r<j-6;r+=1)T.isDark(a,r)&&!T.isDark(a,r+1)&&T.isDark(a,r+2)&&T.isDark(a,r+3)&&T.isDark(a,r+4)&&!T.isDark(a,r+5)&&T.isDark(a,r+6)&&(v+=40);for(r=0;r<j;r+=1)for(a=0;a<j-6;a+=1)T.isDark(a,r)&&!T.isDark(a+1,r)&&T.isDark(a+2,r)&&T.isDark(a+3,r)&&T.isDark(a+4,r)&&!T.isDark(a+5,r)&&T.isDark(a+6,r)&&(v+=40);var D=0;for(r=0;r<j;r+=1)for(a=0;a<j;a+=1)T.isDark(a,r)&&(D+=1);return v+Math.abs(100*D/j/j-50)/5*10},Q),Ct=function(){for(var T=new Array(256),j=new Array(256),v=0;v<8;v+=1)T[v]=1<<v;for(v=8;v<256;v+=1)T[v]=T[v-4]^T[v-5]^T[v-6]^T[v-8];for(v=0;v<255;v+=1)j[T[v]]=v;return{glog:function(a){if(a<1)throw"glog("+a+")";return j[a]},gexp:function(a){for(;a<0;)a+=255;for(;a>=256;)a-=255;return T[a]}}}();function ve(T,j){if(T.length===void 0)throw T.length+"/"+j;var v=function(){for(var r=0;r<T.length&&T[r]==0;)r+=1;for(var s=new Array(T.length-r+j),m=0;m<T.length-r;m+=1)s[m]=T[m+r];return s}(),a={getAt:function(r){return v[r]},getLength:function(){return v.length},multiply:function(r){for(var s=new Array(a.getLength()+r.getLength()-1),m=0;m<a.getLength();m+=1)for(var l=0;l<r.getLength();l+=1)s[m+l]^=Ct.gexp(Ct.glog(a.getAt(m))+Ct.glog(r.getAt(l)));return ve(s,0)},mod:function(r){if(a.getLength()-r.getLength()<0)return a;for(var s=Ct.glog(a.getAt(0))-Ct.glog(r.getAt(0)),m=new Array(a.getLength()),l=0;l<a.getLength();l+=1)m[l]=a.getAt(l);for(l=0;l<r.getLength();l+=1)m[l]^=Ct.gexp(Ct.glog(r.getAt(l))+s);return ve(m,0).mod(r)}};return a}var Ie=function(){var T=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],j=function(a,r){var s={};return s.totalCount=a,s.dataCount=r,s},v={getRSBlocks:function(a,r){var s=function(X,N){switch(N){case ct.L:return T[4*(X-1)+0];case ct.M:return T[4*(X-1)+1];case ct.Q:return T[4*(X-1)+2];case ct.H:return T[4*(X-1)+3];default:return}}(a,r);if(s===void 0)throw"bad rs block @ typeNumber:"+a+"/errorCorrectionLevel:"+r;for(var m=s.length/3,l=[],w=0;w<m;w+=1)for(var M=s[3*w+0],D=s[3*w+1],I=s[3*w+2],B=0;B<M;B+=1)l.push(j(D,I));return l}};return v}(),xe=function(){var T=[],j=0,v={getBuffer:function(){return T},getAt:function(a){var r=Math.floor(a/8);return(T[r]>>>7-a%8&1)==1},put:function(a,r){for(var s=0;s<r;s+=1)v.putBit((a>>>r-s-1&1)==1)},getLengthInBits:function(){return j},putBit:function(a){var r=Math.floor(j/8);T.length<=r&&T.push(0),a&&(T[r]|=128>>>j%8),j+=1}};return v},Fe=function(T){var j=T,v={getMode:function(){return 1},getLength:function(s){return j.length},write:function(s){for(var m=j,l=0;l+2<m.length;)s.put(a(m.substring(l,l+3)),10),l+=3;l<m.length&&(m.length-l==1?s.put(a(m.substring(l,l+1)),4):m.length-l==2&&s.put(a(m.substring(l,l+2)),7))}},a=function(s){for(var m=0,l=0;l<s.length;l+=1)m=10*m+r(s.charAt(l));return m},r=function(s){if("0"<=s&&s<="9")return s.charCodeAt(0)-48;throw"illegal char :"+s};return v},Ve=function(T){var j=T,v={getMode:function(){return 2},getLength:function(r){return j.length},write:function(r){for(var s=j,m=0;m+1<s.length;)r.put(45*a(s.charAt(m))+a(s.charAt(m+1)),11),m+=2;m<s.length&&r.put(a(s.charAt(m)),6)}},a=function(r){if("0"<=r&&r<="9")return r.charCodeAt(0)-48;if("A"<=r&&r<="Z")return r.charCodeAt(0)-65+10;switch(r){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+r}};return v},we=function(T){var j=q.stringToBytes(T);return{getMode:function(){return 4},getLength:function(v){return j.length},write:function(v){for(var a=0;a<j.length;a+=1)v.put(j[a],8)}}},Oe=function(T){var j=q.stringToBytesFuncs.SJIS;if(!j)throw"sjis not supported.";(function(){var r=j("\u53CB");if(r.length!=2||(r[0]<<8|r[1])!=38726)throw"sjis not supported."})();var v=j(T),a={getMode:function(){return 8},getLength:function(r){return~~(v.length/2)},write:function(r){for(var s=v,m=0;m+1<s.length;){var l=(255&s[m])<<8|255&s[m+1];if(33088<=l&&l<=40956)l-=33088;else{if(!(57408<=l&&l<=60351))throw"illegal char at "+(m+1)+"/"+l;l-=49472}l=192*(l>>>8&255)+(255&l),r.put(l,13),m+=2}if(m<s.length)throw"illegal char at "+(m+1)}};return a},Be=function(){var T=[],j={writeByte:function(v){T.push(255&v)},writeShort:function(v){j.writeByte(v),j.writeByte(v>>>8)},writeBytes:function(v,a,r){a=a||0,r=r||v.length;for(var s=0;s<r;s+=1)j.writeByte(v[s+a])},writeString:function(v){for(var a=0;a<v.length;a+=1)j.writeByte(v.charCodeAt(a))},toByteArray:function(){return T},toString:function(){var v="";v+="[";for(var a=0;a<T.length;a+=1)a>0&&(v+=","),v+=T[a];return v+"]"}};return j},$i=function(T){var j=T,v=0,a=0,r=0,s={read:function(){for(;r<8;){if(v>=j.length){if(r==0)return-1;throw"unexpected end of file./"+r}var l=j.charAt(v);if(v+=1,l=="=")return r=0,-1;l.match(/^\s$/)||(a=a<<6|m(l.charCodeAt(0)),r+=6)}var w=a>>>r-8&255;return r-=8,w}},m=function(l){if(65<=l&&l<=90)return l-65;if(97<=l&&l<=122)return l-97+26;if(48<=l&&l<=57)return l-48+52;if(l==43)return 62;if(l==47)return 63;throw"c:"+l};return s},ye=function(T,j,v){for(var a=function(D,I){var B=D,X=I,N=new Array(D*I),L={setPixel:function(f,x,_){N[x*B+f]=_},write:function(f){f.writeString("GIF87a"),f.writeShort(B),f.writeShort(X),f.writeByte(128),f.writeByte(0),f.writeByte(0),f.writeByte(0),f.writeByte(0),f.writeByte(0),f.writeByte(255),f.writeByte(255),f.writeByte(255),f.writeString(","),f.writeShort(0),f.writeShort(0),f.writeShort(B),f.writeShort(X),f.writeByte(0);var x=z(2);f.writeByte(2);for(var _=0;x.length-_>255;)f.writeByte(255),f.writeBytes(x,_,255),_+=255;f.writeByte(x.length-_),f.writeBytes(x,_,x.length-_),f.writeByte(0),f.writeString(";")}},z=function(f){for(var x=1<<f,_=1+(1<<f),y=f+1,b=G(),$=0;$<x;$+=1)b.add(String.fromCharCode($));b.add(String.fromCharCode(x)),b.add(String.fromCharCode(_));var J,U,st,lt=Be(),pt=(J=lt,U=0,st=0,{write:function(dt,Y){if(dt>>>Y)throw"length over";for(;U+Y>=8;)J.writeByte(255&(dt<<U|st)),Y-=8-U,dt>>>=8-U,st=0,U=0;st|=dt<<U,U+=Y},flush:function(){U>0&&J.writeByte(st)}});pt.write(x,y);var Mt=0,wt=String.fromCharCode(N[Mt]);for(Mt+=1;Mt<N.length;){var ht=String.fromCharCode(N[Mt]);Mt+=1,b.contains(wt+ht)?wt+=ht:(pt.write(b.indexOf(wt),y),b.size()<4095&&(b.size()==1<<y&&(y+=1),b.add(wt+ht)),wt=ht)}return pt.write(b.indexOf(wt),y),pt.write(_,y),pt.flush(),lt.toByteArray()},G=function(){var f={},x=0,_={add:function(y){if(_.contains(y))throw"dup key:"+y;f[y]=x,x+=1},size:function(){return x},indexOf:function(y){return f[y]},contains:function(y){return f[y]!==void 0}};return _};return L}(T,j),r=0;r<j;r+=1)for(var s=0;s<T;s+=1)a.setPixel(s,r,v(s,r));var m=Be();a.write(m);for(var l=function(){var D=0,I=0,B=0,X="",N={},L=function(G){X+=String.fromCharCode(z(63&G))},z=function(G){if(!(G<0)){if(G<26)return 65+G;if(G<52)return G-26+97;if(G<62)return G-52+48;if(G==62)return 43;if(G==63)return 47}throw"n:"+G};return N.writeByte=function(G){for(D=D<<8|255&G,I+=8,B+=1;I>=6;)L(D>>>I-6),I-=6},N.flush=function(){if(I>0&&(L(D<<6-I),D=0,I=0),B%3!=0)for(var G=3-B%3,f=0;f<G;f+=1)X+="="},N.toString=function(){return X},N}(),w=m.toByteArray(),M=0;M<w.length;M+=1)l.writeByte(w[M]);return l.flush(),"data:image/gif;base64,"+l};return q}();O.stringToBytesFuncs["UTF-8"]=function(q){return function(tt){for(var ot=[],nt=0;nt<tt.length;nt++){var Q=tt.charCodeAt(nt);Q<128?ot.push(Q):Q<2048?ot.push(192|Q>>6,128|63&Q):Q<55296||Q>=57344?ot.push(224|Q>>12,128|Q>>6&63,128|63&Q):(nt++,Q=65536+((1023&Q)<<10|1023&tt.charCodeAt(nt)),ot.push(240|Q>>18,128|Q>>12&63,128|Q>>6&63,128|63&Q))}return ot}(q)},(S=typeof(h=function(){return O})=="function"?h.apply(n,[]):h)===void 0||(i.exports=S)}},d={};function t(i){var n=d[i];if(n!==void 0)return n.exports;var h=d[i]={exports:{}};return o[i](h,h.exports,t),h.exports}t.n=i=>{var n=i&&i.__esModule?()=>i.default:()=>i;return t.d(n,{a:n}),n},t.d=(i,n)=>{for(var h in n)t.o(n,h)&&!t.o(i,h)&&Object.defineProperty(i,h,{enumerable:!0,get:n[h]})},t.o=(i,n)=>Object.prototype.hasOwnProperty.call(i,n);var e={};return(()=>{"use strict";t.d(e,{default:()=>j});let i=v=>!!v&&typeof v=="object"&&!Array.isArray(v);function n(v,...a){if(!a.length)return v;let r=a.shift();return r!==void 0&&i(v)&&i(r)?(v=Object.assign({},v),Object.keys(r).forEach(s=>{let m=v[s],l=r[s];Array.isArray(m)&&Array.isArray(l)?v[s]=l:i(m)&&i(l)?v[s]=n(Object.assign({},m),l):v[s]=l}),n(v,...a)):v}function h(v,a){let r=document.createElement("a");r.download=a,r.href=v,document.body.appendChild(r),r.click(),document.body.removeChild(r)}let S={L:.07,M:.15,Q:.25,H:.3};class O{constructor({svg:a,type:r,window:s}){this._svg=a,this._type=r,this._window=s}draw(a,r,s,m){let l;switch(this._type){case"dots":l=this._drawDot;break;case"classy":l=this._drawClassy;break;case"classy-rounded":l=this._drawClassyRounded;break;case"rounded":l=this._drawRounded;break;case"extra-rounded":l=this._drawExtraRounded;break;default:l=this._drawSquare}l.call(this,{x:a,y:r,size:s,getNeighbor:m})}_rotateFigure({x:a,y:r,size:s,rotation:m=0,draw:l}){var w;let M=a+s/2,D=r+s/2;l(),(w=this._element)===null||w===void 0||w.setAttribute("transform",`rotate(${180*m/Math.PI},${M},${D})`)}_basicDot(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(s+r/2)),this._element.setAttribute("cy",String(m+r/2)),this._element.setAttribute("r",String(r/2))}}))}_basicSquare(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(s)),this._element.setAttribute("y",String(m)),this._element.setAttribute("width",String(r)),this._element.setAttribute("height",String(r))}}))}_basicSideRounded(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${s} ${m}v ${r}h `+r/2+`a ${r/2} ${r/2}, 0, 0, 0, 0 ${-r}`)}}))}_basicCornerRounded(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${s} ${m}v ${r}h ${r}v `+-r/2+`a ${r/2} ${r/2}, 0, 0, 0, ${-r/2} ${-r/2}`)}}))}_basicCornerExtraRounded(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${s} ${m}v ${r}h ${r}a ${r} ${r}, 0, 0, 0, ${-r} ${-r}`)}}))}_basicCornersRounded(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${s} ${m}v `+r/2+`a ${r/2} ${r/2}, 0, 0, 0, ${r/2} ${r/2}h `+r/2+"v "+-r/2+`a ${r/2} ${r/2}, 0, 0, 0, ${-r/2} ${-r/2}`)}}))}_drawDot({x:a,y:r,size:s}){this._basicDot({x:a,y:r,size:s,rotation:0})}_drawSquare({x:a,y:r,size:s}){this._basicSquare({x:a,y:r,size:s,rotation:0})}_drawRounded({x:a,y:r,size:s,getNeighbor:m}){let l=m?+m(-1,0):0,w=m?+m(1,0):0,M=m?+m(0,-1):0,D=m?+m(0,1):0,I=l+w+M+D;if(I!==0)if(I>2||l&&w||M&&D)this._basicSquare({x:a,y:r,size:s,rotation:0});else{if(I===2){let B=0;return l&&M?B=Math.PI/2:M&&w?B=Math.PI:w&&D&&(B=-Math.PI/2),void this._basicCornerRounded({x:a,y:r,size:s,rotation:B})}if(I===1){let B=0;return M?B=Math.PI/2:w?B=Math.PI:D&&(B=-Math.PI/2),void this._basicSideRounded({x:a,y:r,size:s,rotation:B})}}else this._basicDot({x:a,y:r,size:s,rotation:0})}_drawExtraRounded({x:a,y:r,size:s,getNeighbor:m}){let l=m?+m(-1,0):0,w=m?+m(1,0):0,M=m?+m(0,-1):0,D=m?+m(0,1):0,I=l+w+M+D;if(I!==0)if(I>2||l&&w||M&&D)this._basicSquare({x:a,y:r,size:s,rotation:0});else{if(I===2){let B=0;return l&&M?B=Math.PI/2:M&&w?B=Math.PI:w&&D&&(B=-Math.PI/2),void this._basicCornerExtraRounded({x:a,y:r,size:s,rotation:B})}if(I===1){let B=0;return M?B=Math.PI/2:w?B=Math.PI:D&&(B=-Math.PI/2),void this._basicSideRounded({x:a,y:r,size:s,rotation:B})}}else this._basicDot({x:a,y:r,size:s,rotation:0})}_drawClassy({x:a,y:r,size:s,getNeighbor:m}){let l=m?+m(-1,0):0,w=m?+m(1,0):0,M=m?+m(0,-1):0,D=m?+m(0,1):0;l+w+M+D!==0?l||M?w||D?this._basicSquare({x:a,y:r,size:s,rotation:0}):this._basicCornerRounded({x:a,y:r,size:s,rotation:Math.PI/2}):this._basicCornerRounded({x:a,y:r,size:s,rotation:-Math.PI/2}):this._basicCornersRounded({x:a,y:r,size:s,rotation:Math.PI/2})}_drawClassyRounded({x:a,y:r,size:s,getNeighbor:m}){let l=m?+m(-1,0):0,w=m?+m(1,0):0,M=m?+m(0,-1):0,D=m?+m(0,1):0;l+w+M+D!==0?l||M?w||D?this._basicSquare({x:a,y:r,size:s,rotation:0}):this._basicCornerExtraRounded({x:a,y:r,size:s,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:a,y:r,size:s,rotation:-Math.PI/2}):this._basicCornersRounded({x:a,y:r,size:s,rotation:Math.PI/2})}}let q={dot:"dot",square:"square",extraRounded:"extra-rounded"},tt=Object.values(q);class ot{constructor({svg:a,type:r,window:s}){this._svg=a,this._type=r,this._window=s}draw(a,r,s,m){let l;switch(this._type){case q.square:l=this._drawSquare;break;case q.extraRounded:l=this._drawExtraRounded;break;default:l=this._drawDot}l.call(this,{x:a,y:r,size:s,rotation:m})}_rotateFigure({x:a,y:r,size:s,rotation:m=0,draw:l}){var w;let M=a+s/2,D=r+s/2;l(),(w=this._element)===null||w===void 0||w.setAttribute("transform",`rotate(${180*m/Math.PI},${M},${D})`)}_basicDot(a){let{size:r,x:s,y:m}=a,l=r/7;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${s+r/2} ${m}a ${r/2} ${r/2} 0 1 0 0.1 0zm 0 ${l}a ${r/2-l} ${r/2-l} 0 1 1 -0.1 0Z`)}}))}_basicSquare(a){let{size:r,x:s,y:m}=a,l=r/7;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${s} ${m}v ${r}h ${r}v `+-r+`zM ${s+l} ${m+l}h `+(r-2*l)+"v "+(r-2*l)+"h "+(2*l-r)+"z")}}))}_basicExtraRounded(a){let{size:r,x:s,y:m}=a,l=r/7;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${s} ${m+2.5*l}v `+2*l+`a ${2.5*l} ${2.5*l}, 0, 0, 0, ${2.5*l} ${2.5*l}h `+2*l+`a ${2.5*l} ${2.5*l}, 0, 0, 0, ${2.5*l} ${2.5*-l}v `+-2*l+`a ${2.5*l} ${2.5*l}, 0, 0, 0, ${2.5*-l} ${2.5*-l}h `+-2*l+`a ${2.5*l} ${2.5*l}, 0, 0, 0, ${2.5*-l} ${2.5*l}M ${s+2.5*l} ${m+l}h `+2*l+`a ${1.5*l} ${1.5*l}, 0, 0, 1, ${1.5*l} ${1.5*l}v `+2*l+`a ${1.5*l} ${1.5*l}, 0, 0, 1, ${1.5*-l} ${1.5*l}h `+-2*l+`a ${1.5*l} ${1.5*l}, 0, 0, 1, ${1.5*-l} ${1.5*-l}v `+-2*l+`a ${1.5*l} ${1.5*l}, 0, 0, 1, ${1.5*l} ${1.5*-l}`)}}))}_drawDot({x:a,y:r,size:s,rotation:m}){this._basicDot({x:a,y:r,size:s,rotation:m})}_drawSquare({x:a,y:r,size:s,rotation:m}){this._basicSquare({x:a,y:r,size:s,rotation:m})}_drawExtraRounded({x:a,y:r,size:s,rotation:m}){this._basicExtraRounded({x:a,y:r,size:s,rotation:m})}}let nt={dot:"dot",square:"square"},Q=Object.values(nt);class it{constructor({svg:a,type:r,window:s}){this._svg=a,this._type=r,this._window=s}draw(a,r,s,m){let l;l=this._type===nt.square?this._drawSquare:this._drawDot,l.call(this,{x:a,y:r,size:s,rotation:m})}_rotateFigure({x:a,y:r,size:s,rotation:m=0,draw:l}){var w;let M=a+s/2,D=r+s/2;l(),(w=this._element)===null||w===void 0||w.setAttribute("transform",`rotate(${180*m/Math.PI},${M},${D})`)}_basicDot(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(s+r/2)),this._element.setAttribute("cy",String(m+r/2)),this._element.setAttribute("r",String(r/2))}}))}_basicSquare(a){let{size:r,x:s,y:m}=a;this._rotateFigure(Object.assign(Object.assign({},a),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(s)),this._element.setAttribute("y",String(m)),this._element.setAttribute("width",String(r)),this._element.setAttribute("height",String(r))}}))}_drawDot({x:a,y:r,size:s,rotation:m}){this._basicDot({x:a,y:r,size:s,rotation:m})}_drawSquare({x:a,y:r,size:s,rotation:m}){this._basicSquare({x:a,y:r,size:s,rotation:m})}}let ct="circle",_t=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],Ct=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],Ie=(()=>{class v{constructor(r,s){this._roundSize=m=>this._options.dotsOptions.roundSize?Math.floor(m):m,this._window=s,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(r.width)),this._element.setAttribute("height",String(r.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),r.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${r.width} ${r.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=r.image,this._instanceId=v.instanceCount++,this._options=r}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}drawQR(r){return Tt(this,null,function*(){let s=r.getModuleCount(),m=Math.min(this._options.width,this._options.height)-2*this._options.margin,l=this._options.shape===ct?m/Math.sqrt(2):m,w=this._roundSize(l/s),M={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=r,this._options.image){if(yield this.loadImage(),!this._image)return;let{imageOptions:D,qrOptions:I}=this._options,B=D.imageSize*S[I.errorCorrectionLevel],X=Math.floor(B*s*s);M=function({originalHeight:N,originalWidth:L,maxHiddenDots:z,maxHiddenAxisDots:G,dotSize:f}){let x={x:0,y:0},_={x:0,y:0};if(N<=0||L<=0||z<=0||f<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};let y=N/L;return x.x=Math.floor(Math.sqrt(z/y)),x.x<=0&&(x.x=1),G&&G<x.x&&(x.x=G),x.x%2==0&&x.x--,_.x=x.x*f,x.y=1+2*Math.ceil((x.x*y-1)/2),_.y=Math.round(_.x*y),(x.y*x.x>z||G&&G<x.y)&&(G&&G<x.y?(x.y=G,x.y%2==0&&x.x--):x.y-=2,_.y=x.y*f,x.x=1+2*Math.ceil((x.y/y-1)/2),_.x=Math.round(_.y/y)),{height:_.y,width:_.x,hideYDots:x.y,hideXDots:x.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:X,maxHiddenAxisDots:s-14,dotSize:w})}this.drawBackground(),this.drawDots((D,I)=>{var B,X,N,L,z,G;return!(this._options.imageOptions.hideBackgroundDots&&D>=(s-M.hideYDots)/2&&D<(s+M.hideYDots)/2&&I>=(s-M.hideXDots)/2&&I<(s+M.hideXDots)/2||!((B=_t[D])===null||B===void 0)&&B[I]||!((X=_t[D-s+7])===null||X===void 0)&&X[I]||!((N=_t[D])===null||N===void 0)&&N[I-s+7]||!((L=Ct[D])===null||L===void 0)&&L[I]||!((z=Ct[D-s+7])===null||z===void 0)&&z[I]||!((G=Ct[D])===null||G===void 0)&&G[I-s+7])}),this.drawCorners(),this._options.image&&(yield this.drawImage({width:M.width,height:M.height,count:s,dotSize:w}))})}drawBackground(){var r,s,m;let l=this._element,w=this._options;if(l){let M=(r=w.backgroundOptions)===null||r===void 0?void 0:r.gradient,D=(s=w.backgroundOptions)===null||s===void 0?void 0:s.color,I=w.height,B=w.width;if(M||D){let X=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((m=w.backgroundOptions)===null||m===void 0)&&m.round&&(I=B=Math.min(w.width,w.height),X.setAttribute("rx",String(I/2*w.backgroundOptions.round))),X.setAttribute("x",String(this._roundSize((w.width-B)/2))),X.setAttribute("y",String(this._roundSize((w.height-I)/2))),X.setAttribute("width",String(B)),X.setAttribute("height",String(I)),this._backgroundClipPath.appendChild(X),this._createColor({options:M,color:D,additionalRotation:0,x:0,y:0,height:w.height,width:w.width,name:`background-color-${this._instanceId}`})}}}drawDots(r){var s,m;if(!this._qr)throw"QR code is not defined";let l=this._options,w=this._qr.getModuleCount();if(w>l.width||w>l.height)throw"The canvas is too small.";let M=Math.min(l.width,l.height)-2*l.margin,D=l.shape===ct?M/Math.sqrt(2):M,I=this._roundSize(D/w),B=this._roundSize((l.width-w*I)/2),X=this._roundSize((l.height-w*I)/2),N=new O({svg:this._element,type:l.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(s=l.dotsOptions)===null||s===void 0?void 0:s.gradient,color:l.dotsOptions.color,additionalRotation:0,x:0,y:0,height:l.height,width:l.width,name:`dot-color-${this._instanceId}`});for(let L=0;L<w;L++)for(let z=0;z<w;z++)r&&!r(L,z)||!((m=this._qr)===null||m===void 0)&&m.isDark(L,z)&&(N.draw(B+z*I,X+L*I,I,(G,f)=>!(z+G<0||L+f<0||z+G>=w||L+f>=w)&&!(r&&!r(L+f,z+G))&&!!this._qr&&this._qr.isDark(L+f,z+G)),N._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(N._element));if(l.shape===ct){let L=this._roundSize((M/I-w)/2),z=w+2*L,G=B-L*I,f=X-L*I,x=[],_=this._roundSize(z/2);for(let y=0;y<z;y++){x[y]=[];for(let b=0;b<z;b++)y>=L-1&&y<=z-L&&b>=L-1&&b<=z-L||Math.sqrt((y-_)*(y-_)+(b-_)*(b-_))>_?x[y][b]=0:x[y][b]=this._qr.isDark(b-2*L<0?b:b>=w?b-2*L:b-L,y-2*L<0?y:y>=w?y-2*L:y-L)?1:0}for(let y=0;y<z;y++)for(let b=0;b<z;b++)x[y][b]&&(N.draw(G+b*I,f+y*I,I,($,J)=>{var U;return!!(!((U=x[y+J])===null||U===void 0)&&U[b+$])}),N._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(N._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";let r=this._element,s=this._options;if(!r)throw"Element code is not defined";let m=this._qr.getModuleCount(),l=Math.min(s.width,s.height)-2*s.margin,w=s.shape===ct?l/Math.sqrt(2):l,M=this._roundSize(w/m),D=7*M,I=3*M,B=this._roundSize((s.width-m*M)/2),X=this._roundSize((s.height-m*M)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([N,L,z])=>{var G,f,x,_,y,b,$,J,U,st,lt,pt,Mt,wt;let ht=B+N*M*(m-7),dt=X+L*M*(m-7),Y=this._dotsClipPath,jt=this._dotsClipPath;if((!((G=s.cornersSquareOptions)===null||G===void 0)&&G.gradient||!((f=s.cornersSquareOptions)===null||f===void 0)&&f.color)&&(Y=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),Y.setAttribute("id",`clip-path-corners-square-color-${N}-${L}-${this._instanceId}`),this._defs.appendChild(Y),this._cornersSquareClipPath=this._cornersDotClipPath=jt=Y,this._createColor({options:(x=s.cornersSquareOptions)===null||x===void 0?void 0:x.gradient,color:(_=s.cornersSquareOptions)===null||_===void 0?void 0:_.color,additionalRotation:z,x:ht,y:dt,height:D,width:D,name:`corners-square-color-${N}-${L}-${this._instanceId}`})),((y=s.cornersSquareOptions)===null||y===void 0?void 0:y.type)&&tt.includes(s.cornersSquareOptions.type)){let ft=new ot({svg:this._element,type:s.cornersSquareOptions.type,window:this._window});ft.draw(ht,dt,D,z),ft._element&&Y&&Y.appendChild(ft._element)}else{let ft=new O({svg:this._element,type:((b=s.cornersSquareOptions)===null||b===void 0?void 0:b.type)||s.dotsOptions.type,window:this._window});for(let K=0;K<_t.length;K++)for(let gt=0;gt<_t[K].length;gt++)!(($=_t[K])===null||$===void 0)&&$[gt]&&(ft.draw(ht+gt*M,dt+K*M,M,(At,Nt)=>{var Ht;return!!(!((Ht=_t[K+Nt])===null||Ht===void 0)&&Ht[gt+At])}),ft._element&&Y&&Y.appendChild(ft._element))}if((!((J=s.cornersDotOptions)===null||J===void 0)&&J.gradient||!((U=s.cornersDotOptions)===null||U===void 0)&&U.color)&&(jt=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),jt.setAttribute("id",`clip-path-corners-dot-color-${N}-${L}-${this._instanceId}`),this._defs.appendChild(jt),this._cornersDotClipPath=jt,this._createColor({options:(st=s.cornersDotOptions)===null||st===void 0?void 0:st.gradient,color:(lt=s.cornersDotOptions)===null||lt===void 0?void 0:lt.color,additionalRotation:z,x:ht+2*M,y:dt+2*M,height:I,width:I,name:`corners-dot-color-${N}-${L}-${this._instanceId}`})),((pt=s.cornersDotOptions)===null||pt===void 0?void 0:pt.type)&&Q.includes(s.cornersDotOptions.type)){let ft=new it({svg:this._element,type:s.cornersDotOptions.type,window:this._window});ft.draw(ht+2*M,dt+2*M,I,z),ft._element&&jt&&jt.appendChild(ft._element)}else{let ft=new O({svg:this._element,type:((Mt=s.cornersDotOptions)===null||Mt===void 0?void 0:Mt.type)||s.dotsOptions.type,window:this._window});for(let K=0;K<Ct.length;K++)for(let gt=0;gt<Ct[K].length;gt++)!((wt=Ct[K])===null||wt===void 0)&&wt[gt]&&(ft.draw(ht+gt*M,dt+K*M,M,(At,Nt)=>{var Ht;return!!(!((Ht=Ct[K+Nt])===null||Ht===void 0)&&Ht[gt+At])}),ft._element&&jt&&jt.appendChild(ft._element))}})}loadImage(){return new Promise((r,s)=>{var m;let l=this._options;if(!l.image)return s("Image is not defined");if(!((m=l.nodeCanvas)===null||m===void 0)&&m.loadImage)l.nodeCanvas.loadImage(l.image).then(w=>{var M,D;if(this._image=w,this._options.imageOptions.saveAsBlob){let I=(M=l.nodeCanvas)===null||M===void 0?void 0:M.createCanvas(this._image.width,this._image.height);(D=I?.getContext("2d"))===null||D===void 0||D.drawImage(w,0,0),this._imageUri=I?.toDataURL()}r()}).catch(s);else{let w=new this._window.Image;typeof l.imageOptions.crossOrigin=="string"&&(w.crossOrigin=l.imageOptions.crossOrigin),this._image=w,w.onload=()=>Tt(this,null,function*(){this._options.imageOptions.saveAsBlob&&(this._imageUri=yield function(M,D){return Tt(this,null,function*(){return new Promise(I=>{let B=new D.XMLHttpRequest;B.onload=function(){let X=new D.FileReader;X.onloadend=function(){I(X.result)},X.readAsDataURL(B.response)},B.open("GET",M),B.responseType="blob",B.send()})})}(l.image||"",this._window)),r()}),w.src=l.image}})}drawImage(w){return Tt(this,arguments,function*({width:r,height:s,count:m,dotSize:l}){let M=this._options,D=this._roundSize((M.width-m*l)/2),I=this._roundSize((M.height-m*l)/2),B=D+this._roundSize(M.imageOptions.margin+(m*l-r)/2),X=I+this._roundSize(M.imageOptions.margin+(m*l-s)/2),N=r-2*M.imageOptions.margin,L=s-2*M.imageOptions.margin,z=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");z.setAttribute("href",this._imageUri||""),z.setAttribute("x",String(B)),z.setAttribute("y",String(X)),z.setAttribute("width",`${N}px`),z.setAttribute("height",`${L}px`),this._element.appendChild(z)})}_createColor({options:r,color:s,additionalRotation:m,x:l,y:w,height:M,width:D,name:I}){let B=D>M?D:M,X=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(X.setAttribute("x",String(l)),X.setAttribute("y",String(w)),X.setAttribute("height",String(M)),X.setAttribute("width",String(D)),X.setAttribute("clip-path",`url('#clip-path-${I}')`),r){let N;if(r.type==="radial")N=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),N.setAttribute("id",I),N.setAttribute("gradientUnits","userSpaceOnUse"),N.setAttribute("fx",String(l+D/2)),N.setAttribute("fy",String(w+M/2)),N.setAttribute("cx",String(l+D/2)),N.setAttribute("cy",String(w+M/2)),N.setAttribute("r",String(B/2));else{let L=((r.rotation||0)+m)%(2*Math.PI),z=(L+2*Math.PI)%(2*Math.PI),G=l+D/2,f=w+M/2,x=l+D/2,_=w+M/2;z>=0&&z<=.25*Math.PI||z>1.75*Math.PI&&z<=2*Math.PI?(G-=D/2,f-=M/2*Math.tan(L),x+=D/2,_+=M/2*Math.tan(L)):z>.25*Math.PI&&z<=.75*Math.PI?(f-=M/2,G-=D/2/Math.tan(L),_+=M/2,x+=D/2/Math.tan(L)):z>.75*Math.PI&&z<=1.25*Math.PI?(G+=D/2,f+=M/2*Math.tan(L),x-=D/2,_-=M/2*Math.tan(L)):z>1.25*Math.PI&&z<=1.75*Math.PI&&(f+=M/2,G+=D/2/Math.tan(L),_-=M/2,x-=D/2/Math.tan(L)),N=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),N.setAttribute("id",I),N.setAttribute("gradientUnits","userSpaceOnUse"),N.setAttribute("x1",String(Math.round(G))),N.setAttribute("y1",String(Math.round(f))),N.setAttribute("x2",String(Math.round(x))),N.setAttribute("y2",String(Math.round(_)))}r.colorStops.forEach(({offset:L,color:z})=>{let G=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");G.setAttribute("offset",100*L+"%"),G.setAttribute("stop-color",z),N.appendChild(G)}),X.setAttribute("fill",`url('#${I}')`),this._defs.appendChild(N)}else s&&X.setAttribute("fill",s);this._element.appendChild(X)}}return v.instanceCount=0,v})(),xe="canvas",Fe={};for(let v=0;v<=40;v++)Fe[v]=v;let Ve={type:xe,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:Fe[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function we(v){let a=Object.assign({},v);if(!a.colorStops||!a.colorStops.length)throw"Field 'colorStops' is required in gradient";return a.rotation?a.rotation=Number(a.rotation):a.rotation=0,a.colorStops=a.colorStops.map(r=>Object.assign(Object.assign({},r),{offset:Number(r.offset)})),a}function Oe(v){let a=Object.assign({},v);return a.width=Number(a.width),a.height=Number(a.height),a.margin=Number(a.margin),a.imageOptions=Object.assign(Object.assign({},a.imageOptions),{hideBackgroundDots:!!a.imageOptions.hideBackgroundDots,imageSize:Number(a.imageOptions.imageSize),margin:Number(a.imageOptions.margin)}),a.margin>Math.min(a.width,a.height)&&(a.margin=Math.min(a.width,a.height)),a.dotsOptions=Object.assign({},a.dotsOptions),a.dotsOptions.gradient&&(a.dotsOptions.gradient=we(a.dotsOptions.gradient)),a.cornersSquareOptions&&(a.cornersSquareOptions=Object.assign({},a.cornersSquareOptions),a.cornersSquareOptions.gradient&&(a.cornersSquareOptions.gradient=we(a.cornersSquareOptions.gradient))),a.cornersDotOptions&&(a.cornersDotOptions=Object.assign({},a.cornersDotOptions),a.cornersDotOptions.gradient&&(a.cornersDotOptions.gradient=we(a.cornersDotOptions.gradient))),a.backgroundOptions&&(a.backgroundOptions=Object.assign({},a.backgroundOptions),a.backgroundOptions.gradient&&(a.backgroundOptions.gradient=we(a.backgroundOptions.gradient))),a}var Be=t(873),$i=t.n(Be);function ye(v){if(!v)throw new Error("Extension must be defined");v[0]==="."&&(v=v.substring(1));let a={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[v.toLowerCase()];if(!a)throw new Error(`Extension "${v}" is not supported`);return a}class T{constructor(a){a?.jsdom?this._window=new a.jsdom("",{resources:"usable"}).window:this._window=window,this._options=a?Oe(n(Ve,a)):Ve,this.update()}static _clearContainer(a){a&&(a.innerHTML="")}_setupSvg(){if(!this._qr)return;let a=new Ie(this._options,this._window);this._svg=a.getElement(),this._svgDrawingPromise=a.drawQR(this._qr).then(()=>{var r;this._svg&&((r=this._extension)===null||r===void 0||r.call(this,a.getElement(),this._options))})}_setupCanvas(){var a,r;this._qr&&(!((a=this._options.nodeCanvas)===null||a===void 0)&&a.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(r=this._svgDrawingPromise)===null||r===void 0?void 0:r.then(()=>{var s;if(!this._svg)return;let m=this._svg,l=new this._window.XMLSerializer().serializeToString(m),w=btoa(l),M=`data:${ye("svg")};base64,${w}`;if(!((s=this._options.nodeCanvas)===null||s===void 0)&&s.loadImage)return this._options.nodeCanvas.loadImage(M).then(D=>{var I,B;D.width=this._options.width,D.height=this._options.height,(B=(I=this._nodeCanvas)===null||I===void 0?void 0:I.getContext("2d"))===null||B===void 0||B.drawImage(D,0,0)});{let D=new this._window.Image;return new Promise(I=>{D.onload=()=>{var B,X;(X=(B=this._domCanvas)===null||B===void 0?void 0:B.getContext("2d"))===null||X===void 0||X.drawImage(D,0,0),I()},D.src=M})}}))}_getElement(a="png"){return Tt(this,null,function*(){if(!this._qr)throw"QR code is empty";return a.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),yield this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),yield this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)})}update(a){T._clearContainer(this._container),this._options=a?Oe(n(this._options,a)):this._options,this._options.data&&(this._qr=$i()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(r){switch(!0){case/^[0-9]*$/.test(r):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(r):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===xe?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(a){if(a){if(typeof a.appendChild!="function")throw"Container should be a single DOM node";this._options.type===xe?this._domCanvas&&a.appendChild(this._domCanvas):this._svg&&a.appendChild(this._svg),this._container=a}}applyExtension(a){if(!a)throw"Extension function should be defined.";this._extension=a,this.update()}deleteExtension(){this._extension=void 0,this.update()}getRawData(a="png"){return Tt(this,null,function*(){if(!this._qr)throw"QR code is empty";let r=yield this._getElement(a),s=ye(a);if(!r)return null;if(a.toLowerCase()==="svg"){let m=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(r)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(m):new Blob([m],{type:s})}return new Promise(m=>{let l=r;if("toBuffer"in l)if(s==="image/png")m(l.toBuffer(s));else if(s==="image/jpeg")m(l.toBuffer(s));else{if(s!=="application/pdf")throw Error("Unsupported extension");m(l.toBuffer(s))}else"toBlob"in l&&l.toBlob(m,s,1)})})}download(a){return Tt(this,null,function*(){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let r="png",s="qr";typeof a=="string"?(r=a,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof a=="object"&&a!==null&&(a.name&&(s=a.name),a.extension&&(r=a.extension));let m=yield this._getElement(r);if(m)if(r.toLowerCase()==="svg"){let l=new XMLSerializer().serializeToString(m);l=`<?xml version="1.0" standalone="no"?>\r
`+l,h(`data:${ye(r)};charset=utf-8,${encodeURIComponent(l)}`,`${s}.svg`)}else h(m.toDataURL(ye(r)),`${s}.${r}`)})}}let j=T})(),e.default})())});var to=(o,d)=>d.id;function Mn(o,d){if(o&1){let t=W();c(0,"mat-chip-row",15),k("removed",function(){let i=P(t).$implicit,n=g();return A(n.removeTag(i))}),C(1),c(2,"button",16)(3,"mat-icon"),C(4,"cancel"),p()()()}if(o&2){let t=d.$implicit;E("removable",!0),u(),et(" ",t.name," "),u(),xo("aria-label","remove "+t.name)}}function jn(o,d){if(o&1&&(c(0,"mat-option",13),C(1),p()),o&2){let t=d.$implicit;E("value",t),u(),et(" ",t.name," ")}}function Tn(o,d){if(o&1&&(c(0,"mat-list-option",13),C(1),p()),o&2){let t=d.$implicit;E("value",t),u(),et(" ",t.title," ")}}function kn(o,d){if(o&1){let t=W();c(0,"mat-selection-list",17),Vt("ngModelChange",function(i){P(t);let n=g();return Ft(n.selectedCollate,i)||(n.selectedCollate=i),A(i)}),k("selectionChange",function(i){P(t);let n=g();return A(n.onCollateSelect(i))}),rt(1,Tn,2,2,"mat-list-option",13,to),p(),c(3,"mat-paginator",18),k("page",function(i){P(t);let n=g();return A(n.handlePageEvent(i))}),p()}if(o&2){let t=g();It("ngModel",t.selectedCollate),E("multiple",!1),u(),at(t.collates),u(2),E("length",t.totalCount)("pageSize",t.limit)}}function Dn(o,d){o&1&&(c(0,"p"),C(1,"No collates could be found."),p())}var Jo=(()=>{class o{constructor(t,e,i,n,h){this.snackBar=t,this.fb=e,this.router=i,this.collateService=n,this.dialog=h,this.collates=[],this.searchTags=[],this.selectedCollate=null,this.searchTerm="",this.limit=5,this.offset=0,this.totalCount=0,this.separatorKeysCodes=[13,188],this.form=this.fb.group({tag:[""]}),this.loading=!1}ngOnInit(){this.searchCollates(),this.filteredTags=this.form.controls.tag.valueChanges.pipe(Ge(""),po(t=>t?t.length>=2:!1),Le(t=>this.collateService.getCollateTags(t).pipe(Re(e=>e.results))))}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,this.searchTerm,this.searchTags.map(t=>t.id)).subscribe({next:t=>{this.collates=t.results,this.totalCount=t.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onCollateSelect(t){this.selectedCollate=t.options[0].value,this.router.navigate([`/collate/view/${t.options[0].value.id}`]).then(e=>console.log(e))}openCreateCollateDialog(){this.dialog.open(Wo).afterClosed().subscribe(e=>{e&&this.collateService.createCollate(e.title,e.greeting).subscribe(i=>{this.router.navigate([`/collate/edit/${i.id}`]).then(n=>console.log(n))})})}handlePageEvent(t){this.limit=t.pageSize,this.offset=t.pageIndex*this.limit,this.searchCollates()}addTag(t){let e=t.option.value;e&&!this.searchTags.find(i=>i.id===e.id)&&this.searchTags.push(e),this.form.controls.tag.setValue(""),this.searchCollates()}removeTag(t){let e=this.searchTags.indexOf(t);e>=0&&this.searchTags.splice(e,1),this.searchCollates()}static{this.\u0275fac=function(e){return new(e||o)(F(Jt),F(Rt),F(be),F(me),F(Te))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate"]],decls:33,vars:8,consts:[["chipGrid",""],["auto","matAutocomplete"],[1,"collate-container"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[1,"search-box"],["mat-button","",2,"width","100%",3,"click"],["appearance","outlined",2,"width","500px"],[2,"width","100%"],["matInput","","placeholder","Search Collates",3,"ngModelChange","ngModel"],[3,"removable"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-raised-button","","color","primary",3,"click"],[3,"removed","removable"],["matChipRemove",""],[3,"ngModelChange","selectionChange","ngModel","multiple"],[3,"page","length","pageSize"]],template:function(e,i){if(e&1){let n=W();c(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),C(4,"C|nder Collates"),p(),R(5,"br"),p()(),c(6,"div",5)(7,"div")(8,"button",6),k("click",function(){return P(n),A(i.openCreateCollateDialog())}),c(9,"h3"),C(10,"+ Create Collate From Projects"),p()()(),R(11,"hr"),c(12,"mat-card",7)(13,"mat-card-content")(14,"mat-form-field",8)(15,"input",9),Vt("ngModelChange",function(S){return P(n),Ft(i.searchTerm,S)||(i.searchTerm=S),A(S)}),k("ngModelChange",function(){return P(n),A(i.searchCollates())}),p()(),c(16,"mat-form-field",8)(17,"mat-label"),C(18,"Search Tags"),p(),c(19,"mat-chip-grid",null,0),rt(21,Mn,5,3,"mat-chip-row",10,to),R(23,"input",11),p(),c(24,"mat-autocomplete",12,1),k("optionSelected",function(S){return P(n),A(i.addTag(S))}),rt(26,jn,2,2,"mat-option",13,to),Ue(28,"async"),p()(),c(29,"button",14),k("click",function(){return P(n),A(i.searchCollates())}),C(30,"Search"),p(),V(31,kn,4,4)(32,Dn,2,0,"p"),p()()()()}if(e&2){let n=Yt(20),h=Yt(25);u(15),It("ngModel",i.searchTerm),u(6),at(i.searchTags),u(2),E("matChipInputFor",n)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("formControl",i.form.controls.tag)("matAutocomplete",h),u(3),at(Ke(28,6,i.filteredTags)),u(5),H(i.collates.length>0?31:32)}},dependencies:[Gt,he,Bt,St,pe,Lt,ni,oi,ie,je,Me,vt,ai,Ot,si,qo,Ho,No,Se,di,ti,Qt,Bo,pi],styles:[".collate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:80vh}.search-box[_ngcontent-%COMP%]{width:500px}"]})}}return o})();var Zo=(()=>{class o{constructor(){this.collate=null}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-header"]],inputs:{collate:"collate"},decls:7,vars:2,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(e,i){e&1&&(c(0,"div",0)(1,"div",1)(2,"h1"),C(3),p(),R(4,"br"),c(5,"div",2),C(6),p()()()),e&2&&(u(3),mt(i.collate==null?null:i.collate.title),u(3),mt(i.collate==null?null:i.collate.greeting))},styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return o})();function Pn(o,d){if(o&1&&(c(0,"p"),C(1),R(2,"br"),C(3),p(),R(4,"mat-progress-bar",8)),o&2){let t=g();u(),et("Elapsed Time: ",t.elapsedTime," seconds"),u(2),et(" ",t.progress," ")}}var Ii=(()=>{class o{constructor(t,e,i,n,h){this.snackBar=t,this.ws=e,this.fb=i,this.web=n,this.sb=h,this.projects=[],this.loading=!1,this.searchStartTime=null,this.elapsedTime="0.00",this.progress="",this.form=this.fb.group({searchQuery:new Kt("",Ut.required),searchMode:new Kt("gene",Ut.required)}),this.searchResultID=new ut,this.ws.searchWSConnection?.subscribe(S=>{if(S&&S.type==="search_status")switch(S.status){case"complete":this.loading=!1,clearInterval(this.timerInterval);let O=this.calculateElapsedTime();this.progress="",this.showSnackBar(`Search complete in ${O} seconds`),this.searchResultID.emit(parseInt(S.id));break;case"in_progress":this.progress=`Current progress: ${S.current_progress}/${S.found_files}`;break;case"error":this.loading=!1,this.progress="Search error",this.showSnackBar("Search error");break}})}runSearch(){return Tt(this,null,function*(){if(this.form.invalid)return;this.loading=!0,this.progress="Current progress: search initiated",this.searchStartTime=new Date,this.elapsedTime="0.00",this.timerInterval=setInterval(()=>{this.elapsedTime=this.calculateElapsedTime().toFixed(2)},200);let t=[];if(this.projects.length>0){let e=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();if(e)for(let i of e)t.push(i.id)}if(this.form.value.searchQuery&&this.form.value.searchMode){let i=this.form.value.searchQuery.toUpperCase().split("OR").map(n=>`"${n.trim().replace(/'/g,"").replace(/"/g,"")}"`);this.web.createSearch(t,i.join(" OR "),this.web.searchSessionID,1e-9,1e-9,this.form.value.searchMode).subscribe({next:()=>{this.sb.open("Search queued","Dismiss",{duration:2e3})},error:()=>{this.loading=!1,clearInterval(this.timerInterval),this.showSnackBar("Search error")}})}})}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}calculateElapsedTime(){return this.searchStartTime?(new Date().getTime()-this.searchStartTime.getTime())/1e3:0}static{this.\u0275fac=function(e){return new(e||o)(F(Jt),F(hi),F(Rt),F($t),F(Jt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-search"]],inputs:{projects:"projects"},outputs:{searchResultID:"searchResultID"},decls:22,vars:2,consts:[["appearance","outlined"],[2,"display","flex","gap","20px","align-items","center",3,"ngSubmit","formGroup"],[2,"width","500px"],["matInput","","placeholder","Search Query","formControlName","searchQuery"],["formControlName","searchMode"],["value","pi"],["value","gene"],["mat-icon-button","","color","primary","type","submit"],["mode","indeterminate"]],template:function(e,i){e&1&&(c(0,"mat-card",0)(1,"mat-card-content")(2,"form",1),k("ngSubmit",function(){return i.runSearch()}),c(3,"mat-form-field",2),R(4,"input",3),p(),c(5,"mat-form-field")(6,"mat-label"),C(7,"Search Mode"),p(),c(8,"mat-select",4)(9,"mat-option",5),C(10,"Primary Ids"),p(),c(11,"mat-option",6),C(12,"Gene Names"),p()()(),c(13,"button",7)(14,"mat-icon"),C(15,"search"),p()()(),c(16,"p"),C(17," For multiple search terms separate them with "),c(18,"b"),C(19,"OR"),p(),C(20,". "),p(),V(21,Pn,5,2),p()()),e&2&&(u(2),E("formGroup",i.form),u(19),H(i.loading?21:-1))},dependencies:[Lt,Qt,Wt,Bt,St,qt,te,ee,Gt,de,Ot,je,Me,Se,zo,ie,Qo],encapsulation:2})}}return o})();var In=lo(Sn());Zi.plotlyjs=In;var tn=(()=>{class o{set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set renameCondition(t){t?this._renameCondition=t:this._renameCondition={}}get renameCondition(){return this._renameCondition}set data(t){this._data=t,this.graphLayout.title.text=t?.analysis_group?.name||"",this.graphLayout.yaxis.title=this.searchTerm||"",this.conditionA=t?.condition_A||"",this.conditionB=t?.condition_B||"",this.drawGraph()}get data(){return this._data}set expanded(t){this._expanded=t,this.data&&this.drawGraph()}get expanded(){return this._expanded}set colorMap(t){t&&(this._colorMap=t,this.data&&t&&this.drawGraph())}get colorMap(){return this._colorMap}constructor(t,e){this.graph=t,this.accounts=e,this._data=null,this._renameCondition={},this._searchTerm="",this._expanded=!1,this.graphData=[],this.graphLayout={title:{text:"",font:{size:16}},height:400,margin:{l:150,r:100,b:100,t:100},yaxis:{title:this.searchTerm,tickfont:{size:14}}},this.conditionA="",this.conditionB="",this.valueA=[],this.valueB=[],this.barSize=50,this.revision=0,this._colorMap={},this.currentColor=0,this.graph.redrawTrigger.subscribe(()=>{this.drawGraph()})}drawGraph(){this.loadPlotSettings(),this.graph.plotSettings.showTitle||(this.graphLayout.title.text="");let t=this.renameCondition[this.conditionA];t||(t=this.conditionA);let e=this.renameCondition[this.conditionB];e||(e=this.conditionB);let i=document.getElementsByTagName("body")[0],h=window.getComputedStyle(i).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=h,this.graphLayout.paper_bgcolor=h,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let S=0;if(this.data&&this.data.condition_A&&this.data.condition_B&&this.data.searched_data&&!this.expanded){this.conditionA=this.data.condition_A||"",this.conditionB=this.data.condition_B||"",this.valueA=this.data.searched_data.filter(it=>it.Condition===this.conditionA).map(it=>it.Value),this.valueB=this.data.searched_data.filter(it=>it.Condition===this.conditionB).map(it=>it.Value);let O=this.calculateMean(this.valueA),q=this.calculateMean(this.valueB);this.colorMap[this.conditionA]||(this.colorMap[this.conditionA]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let tt={x:[t],y:[O],type:"bar",mode:"markers",name:t,error_y:{type:"data",array:[this.calculateWhisker(this.valueA)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionA]},showlegend:!1},ot=this.drawTransparentBoxPlot(this.valueA,t);this.colorMap[this.conditionB]||(this.colorMap[this.conditionB]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let nt={x:[e],y:[q],type:"bar",mode:"markers",name:e,error_y:{type:"data",array:[this.calculateWhisker(this.valueB)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionB]},showlegend:!1},Q=this.drawTransparentBoxPlot(this.valueB,e);S=2,this.graphData=[tt,ot,nt,Q]}else if(this.data&&(this.expanded||this.data.condition_A==""||this.data.condition_B=="")){let O=Array.from(new Set(this.data.searched_data.map(Q=>Q.Condition))),q=O.map(Q=>{let it=this.data.searched_data.filter(ct=>ct.Condition===Q).map(ct=>ct.Value);return this.calculateMean(it)}),tt=O.map(Q=>{let it=this.data.searched_data.filter(ct=>ct.Condition===Q).map(ct=>ct.Value);return this.calculateWhisker(it)}),ot=O.map((Q,it)=>{this.colorMap[Q]||(this.colorMap[Q]=this.graph.defaultColorList[this.currentColor],this.currentColor++,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0));let ct=this.renameCondition[Q];return ct||(ct=Q),{x:[ct],y:[q[it]],type:"bar",mode:"markers",name:ct,error_y:{type:"data",array:[tt[it]],visible:!0},line:{color:"black"},marker:{color:this.colorMap[Q]},showlegend:!1}}),nt=O.map((Q,it)=>{let ct=this.renameCondition[Q];ct||(ct=Q);let _t=this.data.searched_data.filter(Ct=>Ct.Condition===Q).map(Ct=>Ct.Value);return this.drawTransparentBoxPlot(_t,ct)});S=O.length,this.graphData=[...ot,...nt]}console.log(this.colorMap),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*S,this.revision++,console.log(this.graphData)}calculateMean(t){return t.reduce((i,n)=>i+n,0)/t.length}calculateWhisker(t){let e=this.calculateMean(t),i=t.reduce((n,h)=>n+Math.pow(h-e,2),0)/t.length;return Math.sqrt(i)}drawTransparentBoxPlot(t,e){return{x:e,y:t.filter(i=>!isNaN(i)),type:"box",boxpoints:"all",pointpos:0,jitter:.3,fillcolor:"rgba(255,255,255,0)",line:{color:"rgba(255,255,255,0)"},hoveron:"points",marker:{color:"#654949",opacity:.8},name:e,showlegend:!1}}loadPlotSettings(){this.graphLayout.height=this.graph.plotSettings.height,this.graphLayout.margin.l=this.graph.plotSettings.marginLeft,this.graphLayout.margin.r=this.graph.plotSettings.marginRight,this.graphLayout.margin.b=this.graph.plotSettings.marginBottom,this.graphLayout.margin.t=this.graph.plotSettings.marginTop,this.graphLayout.title.font.size=this.graph.plotSettings.titleTextSize,this.barSize=this.graph.plotSettings.barSize}static{this.\u0275fac=function(e){return new(e||o)(F(Ti),F(oe))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-bar-chart"]],inputs:{searchTerm:"searchTerm",renameCondition:"renameCondition",data:"data",expanded:"expanded",colorMap:"colorMap"},decls:1,vars:4,consts:[[3,"data","layout","revision","updateOnLayoutChange"]],template:function(e,i){e&1&&R(0,"plotly-plot",0),e&2&&E("data",i.graphData)("layout",i.graphLayout)("revision",i.revision)("updateOnLayoutChange",!0)},dependencies:[Zi,Yo],encapsulation:2})}}return o})();var Fn=(o,d)=>d.id;function Vn(o,d){if(o&1){let t=W();c(0,"div",3)(1,"mat-slide-toggle",8),k("change",function(){P(t);let i=g(2);return A(i.expanded=!i.expanded)}),C(2," Expand Bar Chart "),p(),c(3,"mat-slide-toggle",8),k("change",function(){P(t);let i=g(2);return A(i.viewDifferentialAnalysis=!i.viewDifferentialAnalysis)}),C(4," View Differential Analysis Stats "),p()()}o&2&&(u(),E("color","primary"),u(2),E("color","primary"))}function On(o,d){if(o&1&&(c(0,"div"),R(1,"app-bar-chart",11),p()),o&2){let t=g().$implicit,e=g(3);u(),E("searchTerm",t.gene_name)("expanded",e.expanded)("renameCondition",e.renameCondition)("colorMap",e.colorMap)("data",t)}}function Bn(o,d){o&1&&(c(0,"div")(1,"p"),C(2,"No data found for this search"),p()())}function Rn(o,d){if(o&1&&(c(0,"div",9),V(1,On,2,5,"div")(2,Bn,3,0,"div"),c(3,"div")(4,"button",10)(5,"mat-icon"),C(6,"drag_handle"),p()(),c(7,"p"),C(8),p()()()),o&2){let t=d.$implicit;u(),H(t.searched_data.length>0?1:2),u(3),E("matTooltip",t.analysis_group.name),u(4),et(" ",t.analysis_group.name," ")}}function Gn(o,d){if(o&1&&rt(0,Rn,9,3,"div",9,Fn),o&2){let t=g(2);at(t.searchResults)}}function Ln(o,d){o&1&&(c(0,"p"),C(1,"No search results found in this project"),p())}function $n(o,d){o&1&&(c(0,"th",24),C(1," Primary ID "),p())}function zn(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.primary_id," ")}}function Nn(o,d){o&1&&(c(0,"th",24),C(1," UniProt ID "),p())}function Hn(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.uniprot_id," ")}}function qn(o,d){o&1&&(c(0,"th",24),C(1," Gene Names "),p())}function Wn(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.gene_name," ")}}function Qn(o,d){o&1&&(c(0,"th",24),C(1," log2FC "),p())}function Xn(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.log2_fc," ")}}function Yn(o,d){o&1&&(c(0,"th",24),C(1," -log10(p) "),p())}function Un(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.log10_p," ")}}function Kn(o,d){o&1&&(c(0,"th",24),C(1," Condition A "),p())}function Jn(o,d){if(o&1&&C(0),o&2){let t=g().$implicit,e=g(3);et(" ",e.renameCondition[t.condition_A]," ")}}function Zn(o,d){if(o&1&&C(0),o&2){let t=g().$implicit;et(" ",t.condition_A," ")}}function tr(o,d){if(o&1&&(c(0,"td",25),V(1,Jn,1,1)(2,Zn,1,1),p()),o&2){let t=g(3);u(),H(t.renameCondition?1:2)}}function er(o,d){o&1&&(c(0,"th",24),C(1," Condition B "),p())}function ir(o,d){if(o&1&&C(0),o&2){let t=g().$implicit,e=g(3);et(" ",e.renameCondition[t.condition_B]," ")}}function or(o,d){if(o&1&&C(0),o&2){let t=g().$implicit;et(" ",t.condition_B," ")}}function nr(o,d){if(o&1&&(c(0,"td",25),V(1,ir,1,1)(2,or,1,1),p()),o&2){let t=g(3);u(),H(t.renameCondition?1:2)}}function rr(o,d){o&1&&(c(0,"th",24),C(1," Comparison "),p())}function ar(o,d){if(o&1&&(c(0,"td",25),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.comparison_label," ")}}function sr(o,d){o&1&&R(0,"tr",26)}function lr(o,d){o&1&&R(0,"tr",27)}function cr(o,d){if(o&1&&(c(0,"table",5),yt(1,12),V(2,$n,2,0,"th",13)(3,zn,2,1,"td",14),bt(),yt(4,15),V(5,Nn,2,0,"th",13)(6,Hn,2,1,"td",14),bt(),yt(7,16),V(8,qn,2,0,"th",13)(9,Wn,2,1,"td",14),bt(),yt(10,17),V(11,Qn,2,0,"th",13)(12,Xn,2,1,"td",14),bt(),yt(13,18),V(14,Yn,2,0,"th",13)(15,Un,2,1,"td",14),bt(),yt(16,19),V(17,Kn,2,0,"th",13)(18,tr,3,1,"td",14),bt(),yt(19,20),V(20,er,2,0,"th",13)(21,nr,3,1,"td",14),bt(),yt(22,21),V(23,rr,2,0,"th",13)(24,ar,2,1,"td",14),bt(),V(25,sr,1,0,"tr",22)(26,lr,1,0,"tr",23),p()),o&2){let t=g(2);E("dataSource",t.searchResults),u(25),E("matHeaderRowDef",t.searchResultDisplayColumns),u(),E("matRowDefColumns",t.searchResultDisplayColumns)}}function dr(o,d){if(o&1){let t=W();c(0,"button",28),k("click",function(){P(t);let i=g(2);return A(i.deleteProject.emit(i.project))}),c(1,"mat-icon"),C(2,"delete"),p()()}if(o&2){let t=g(2);Wi("matTooltip","Delete Project ",t.project.name," from collate")}}function pr(o,d){if(o&1&&(c(0,"a",7)(1,"mat-icon"),C(2,"link"),p()()),o&2){let t=g(2);Wi("href","/#/project/",t.project.id,"",fo)}}function hr(o,d){if(o&1){let t=W();c(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"span",2),C(4),p()(),c(5,"mat-card-subtitle"),C(6),p()(),c(7,"mat-card-content"),V(8,Vn,5,2,"div",3),c(9,"div",4),k("cdkDropListDropped",function(i){P(t);let n=g();return A(n.drop(i))}),V(10,Gn,2,0)(11,Ln,2,0,"p"),p(),V(12,cr,27,3,"table",5),p(),c(13,"mat-card-actions"),V(14,dr,3,2,"button",6)(15,pr,3,2,"a",7),p()()}if(o&2){let t=g();u(4),mt(t.project.name),u(2),mt(t.project.description),u(2),H(t.searchResults.length>0?8:-1),u(2),H(t.searchResults.length>0?10:11),u(2),H(t.searchResults.length>0&&t.viewDifferentialAnalysis?12:-1),u(2),H(t.accounts.loggedIn?14:-1),u(),H(t.project?15:-1)}}var en=(()=>{class o{set project(t){this._project=t}get project(){return this._project}set searchResults(t){this._searchResults=t,console.log(t)}get searchResults(){return this._searchResults}constructor(t){this.accounts=t,this._project=null,this.searchTerm="",this._searchResults=[],this.colorMap={},this.renameCondition={},this.deleteProject=new ut,this.searchResultsChange=new ut,this.searchResultDisplayColumns=["primary_id","uniprot_id","gene_name","condition_A","condition_B","log2_fc","log10_p","comparison_label"],this.expanded=!1,this.viewDifferentialAnalysis=!1}drop(t){let i=this._searchResults[t.previousIndex].analysis_group.id,n=this._searchResults.filter(h=>h.analysis_group.id===i);this._searchResults=this._searchResults.filter(h=>h.analysis_group.id!==i),this._searchResults.splice(t.currentIndex,0,...n),this.searchResultsChange.emit(this._searchResults)}static{this.\u0275fac=function(e){return new(e||o)(F(oe))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-project-card-viewer"]],inputs:{searchTerm:"searchTerm",project:"project",searchResults:"searchResults",colorMap:"colorMap",renameCondition:"renameCondition"},outputs:{deleteProject:"deleteProject",searchResultsChange:"searchResultsChange"},decls:1,vars:1,consts:[["appearance","outlined"],["cdkDragHandle",""],[2,"color","#ba0000"],[2,"display","flex","flex-direction","column","gap","20px"],["cdkDropList","",2,"display","flex","gap","20px","flex-wrap","wrap","justify-content","center",3,"cdkDropListDropped"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-icon-button","","color","primary",3,"matTooltip"],["target","_blank",3,"href"],[3,"change","color"],["cdkDrag",""],["mat-icon-button","","cdkDragHandle","",3,"matTooltip"],[3,"searchTerm","expanded","renameCondition","colorMap","data"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["matColumnDef","log10_p"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","comparison_label"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click","matTooltip"]],template:function(e,i){e&1&&V(0,hr,16,7,"mat-card",0),e&2&&H(i.project?0:-1)},dependencies:[Eo,Do,Ao,Me,je,Pi,tn,Po,Ot,de,ue,ge,xi,fi,Ci,vi,bi,wi,Si,yi,gi,_i,Uo,ri],encapsulation:2})}}return o})();var mr=(o,d)=>d.id,ur=()=>[];function gr(o,d){if(o&1){let t=W();c(0,"app-project-card-viewer",3),k("deleteProject",function(i){P(t);let n=g(2);return A(n.deleteProject.emit(i))}),p()}if(o&2){let t=g().$implicit,e=g();E("searchTerm",e.searchTerm)("colorMap",e.projectConditionColorMap==null?null:e.projectConditionColorMap[t.id])("project",t)("searchResults",e.filteredResults[t.id]||Ye(5,ur))("renameCondition",e.renameCondition==null?null:e.renameCondition[t.id])}}function fr(o,d){if(o&1&&(c(0,"div",1),V(1,gr,1,6,"app-project-card-viewer",2),p()),o&2){let t=d.$implicit;u(),H(t&&t.id?1:-1)}}var Vi=(()=>{class o{constructor(){this._searchTerm="",this.projects=[],this._filteredResults={},this.projectConditionColorMap={},this.renameCondition={},this.projectOrderChanged=new ut,this.deleteProject=new ut}set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set filteredResults(t){console.log(t),t?this._filteredResults=t:this._filteredResults={}}get filteredResults(){return this._filteredResults}drop(t){_e(this.projects,t.previousIndex,t.currentIndex),this.projectOrderChanged.emit(this.projects)}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-project-list"]],inputs:{searchTerm:"searchTerm",projects:"projects",filteredResults:"filteredResults",projectConditionColorMap:"projectConditionColorMap",renameCondition:"renameCondition"},outputs:{projectOrderChanged:"projectOrderChanged",deleteProject:"deleteProject"},decls:3,vars:0,consts:[["cdkDropList","",1,"project-list",3,"cdkDropListDropped"],[2,"margin","20px"],["cdkDrag","",3,"searchTerm","colorMap","project","searchResults","renameCondition"],["cdkDrag","",3,"deleteProject","searchTerm","colorMap","project","searchResults","renameCondition"]],template:function(e,i){e&1&&(c(0,"div",0),k("cdkDropListDropped",function(h){return i.drop(h)}),rt(1,fr,2,1,"div",1,mr),p()),e&2&&(u(),at(i.projects))},dependencies:[ge,en,ue],encapsulation:2})}}return o})();var on=(o,d)=>d.id;function _r(o,d){if(o&1){let t=W();c(0,"mat-chip",4),k("removed",function(){let i=P(t).$implicit,n=g(2);return A(n.removeTag(i))}),C(1),c(2,"mat-icon",5),C(3,"cancel"),p()()}if(o&2){let t=d.$implicit;u(),et(" ",t.name," ")}}function Cr(o,d){if(o&1){let t=W();c(0,"mat-chip-set",2),k("cdkDropListDropped",function(i){P(t);let n=g();return A(n.drop(i))}),rt(1,_r,4,1,"mat-chip",3,on),p()}if(o&2){let t=g();u(),at(t.collageTags)}}function vr(o,d){if(o&1&&(c(0,"mat-chip"),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t.name," ")}}function xr(o,d){if(o&1&&(c(0,"mat-chip-set"),rt(1,vr,2,1,"mat-chip",null,on),p()),o&2){let t=g();u(),at(t.collageTags)}}var Oi=(()=>{class o{constructor(t){this.accounts=t,this.collageTags=[],this.collageTagsChange=new ut}removeTag(t){this.collageTags=this.collageTags.filter(e=>e!==t),this.collageTagsChange.emit(this.collageTags)}drop(t){_e(this.collageTags,t.previousIndex,t.currentIndex),this.collageTagsChange.emit(this.collageTags)}static{this.\u0275fac=function(e){return new(e||o)(F(oe))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-tags"]],inputs:{collageTags:"collageTags"},outputs:{collageTagsChange:"collageTagsChange"},decls:4,vars:1,consts:[[2,"display","flex","justify-content","center"],["cdkDropList",""],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["cdkDrag","",3,"removed"],["matChipRemove",""]],template:function(e,i){e&1&&(c(0,"div",0),V(1,Cr,3,0,"mat-chip-set",1)(2,xr,3,0,"mat-chip-set"),p(),R(3,"div",0)),e&2&&(u(),H(i.accounts.loggedIn?1:2))},dependencies:[ge,ci,si,Ot,li,ue],encapsulation:2})}}return o})();var rn=lo(nn());function wr(o,d){o&1&&(c(0,"div",2),R(1,"div",6),p())}var an=(()=>{class o{set url(t){this.config.data=t,this._url=t}constructor(t){this.dialogRef=t,this._url="",this.config={width:250,height:250,data:this.url,margin:5,dotsOptions:{color:"#780101",type:"dots"},backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0}}}ngAfterViewInit(){let t=new rn.default(this.config),e=document.getElementById("canvas");e&&t.append(e),this.qrCode=t}close(){this.dialogRef.close()}download(){this.qrCode&&this.qrCode.download({name:"qrcode",extension:"svg"}).then(()=>{})}static{this.\u0275fac=function(e){return new(e||o)(F(kt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-qr-code-dialog"]],inputs:{url:"url"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","justify-content","center","align-items","center"],["mat-dialog-actions",""],["mat-button","",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["id","canvas"]],template:function(e,i){e&1&&(c(0,"h1",0),C(1,"Collate QR Code"),p(),c(2,"div",1),V(3,wr,2,0,"div",2),p(),c(4,"div",3)(5,"button",4),k("click",function(){return i.close()}),C(6,"Close"),p(),c(7,"button",5),k("click",function(){return i.download()}),C(8,"Download"),p()()),e&2&&(u(3),H(i.config.data&&i.config.data!==""?3:-1))},dependencies:[Dt,Et,Pt,vt],encapsulation:2})}}return o})();var sn=(o,d)=>d.id,yr=()=>({standalone:!0});function br(o,d){if(o&1){let t=W();c(0,"mat-checkbox",6),Vt("ngModelChange",function(i){let n=P(t).$implicit,h=g(2).$implicit,S=g();return Ft(S.projectAnalysisGroupVisibilityMap[h.id][n.id],i)||(S.projectAnalysisGroupVisibilityMap[h.id][n.id]=i),A(i)}),C(1),p()}if(o&2){let t=d.$implicit,e=g(2).$implicit,i=g();It("ngModel",i.projectAnalysisGroupVisibilityMap[e.id][t.id]),E("ngModelOptions",Ye(3,yr)),u(),et(" ",t.name," ")}}function Sr(o,d){if(o&1&&rt(0,br,2,4,"mat-checkbox",5,sn),o&2){let t=g().$implicit,e=g();at(e.projectAnalysisGroupMap[t.id])}}function Mr(o,d){if(o&1&&(c(0,"h2"),C(1),p(),V(2,Sr,2,0)),o&2){let t=d.$implicit,e=g();u(),mt(t.name),u(),H(e.projectAnalysisGroupMap[t.id]?2:-1)}}var Bi=(()=>{class o{set projects(t){this._projects=t}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}set projectAnalysisGroupVisibilityMap(t){this._projectAnalysisGroupVisibilityMap={};for(let e in t){this._projectAnalysisGroupVisibilityMap[e]={};for(let i in t[e])this._projectAnalysisGroupVisibilityMap[e][i]=t[e][i]}}get projectAnalysisGroupVisibilityMap(){return this._projectAnalysisGroupVisibilityMap}constructor(t){this.dialog=t,this._projects=[],this._projectAnalysisGroupMap={},this._projectAnalysisGroupVisibilityMap={}}close(){this.dialog.close()}save(){this.dialog.close(this.projectAnalysisGroupVisibilityMap)}static{this.\u0275fac=function(e){return new(e||o)(F(kt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-project-analysis-group-visibility-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap",projectAnalysisGroupVisibilityMap:"projectAnalysisGroupVisibilityMap"},decls:11,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"]],template:function(e,i){e&1&&(c(0,"h1",0),C(1,"Analysis Group Visibility"),p(),c(2,"div",1)(3,"form",2),rt(4,Mr,3,2,null,null,sn),p()(),c(6,"div",3)(7,"button",4),k("click",function(){return i.close()}),C(8,"Cancel"),p(),c(9,"button",4),k("click",function(){return i.save()}),C(10,"Submit"),p()()),e&2&&(u(4),at(i.projects))},dependencies:[Dt,Et,he,Wt,St,qt,pe,Vo,ke,Pt,vt],encapsulation:2})}}return o})();function jr(o,d){o&1&&(c(0,"button",11),C(1,"No previous searches"),p())}function Tr(o,d){if(o&1){let t=W();c(0,"button",13),k("click",function(){P(t);let i=g().$implicit,n=g(3);return A(n.restoreSearches(i.searchQuery,i.searchID))}),C(1),p()}if(o&2){let t=g().$implicit;u(),bo("",t.searchID,". ",t.termFounds.join(","),"")}}function kr(o,d){if(o&1&&V(0,Tr,2,2,"button",12),o&2){let t=d.$implicit,e=g(3);H(t.collate===e.collate.id?0:-1)}}function Dr(o,d){if(o&1&&rt(0,kr,1,1,null,null,ae),o&2){let t=g(2);at(t.pastSearches)}}function Er(o,d){if(o&1&&(c(0,"button",10)(1,"mat-icon"),C(2,"history"),p()(),c(3,"mat-menu",null,0),V(5,jr,2,0,"button",11)(6,Dr,2,0),p()),o&2){let t=Yt(4),e=g();E("matMenuTriggerFor",t),u(5),H(e.pastSearches.length===0?5:6)}}function Pr(o,d){if(o&1){let t=W();c(0,"button",14),k("click",function(){P(t);let i=g();return A(i.navigateToEdit())}),c(1,"mat-icon"),C(2,"edit"),p()()}}function Ar(o,d){if(o&1&&R(0,"app-collate-header",7),o&2){let t=g();E("collate",t.collate)}}function Ir(o,d){if(o&1&&(c(0,"div",15),R(1,"app-collate-tags",16),p()),o&2){let t=g(2);u(),E("collageTags",t.collate.tags)}}function Fr(o,d){if(o&1&&V(0,Ir,2,1,"div",15),o&2){let t=g();H(t.collate.settings.showTags?0:-1)}}function Vr(o,d){if(o&1){let t=W();C(0),c(1,"button",21),k("click",function(){P(t);let i=g().$implicit,n=g(2);return A(n.exportData(i))}),c(2,"mat-icon"),C(3,"download"),p()()}if(o&2){let t=g().$implicit,e=g(2);et(" ",t," "),u(),E("disabled",e.waitingForDownload)}}function Or(o,d){o&1&&(c(0,"mat-tab"),V(1,Vr,4,2,"ng-template",20),p())}function Br(o,d){if(o&1&&R(0,"app-collate-project-list",19),o&2){let t=g(2);E("searchTerm",t.selectedSearchTerm)("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("filteredResults",t.filteredResults)}}function Rr(o,d){if(o&1){let t=W();c(0,"div",17)(1,"mat-tab-group",18),k("selectedTabChange",function(){P(t);let i=g();return A(i.filterDataBySearchTerm())}),Vt("selectedIndexChange",function(i){P(t);let n=g();return Ft(n.selectedIndex,i)||(n.selectedIndex=i),A(i)}),rt(2,Or,2,0,"mat-tab",null,ae),p()(),V(4,Br,1,4,"app-collate-project-list",19)}if(o&2){let t=g();u(),It("selectedIndex",t.selectedIndex),E("mat-stretch-tabs",!1),u(),at(t.searchTerms),u(2),H(t.collate?4:-1)}}var Ri=(()=>{class o{set sessionId(t){t&&this.collate&&this.getSearchFromID(t),this._sessionId=t}get sessionId(){return this._sessionId}set collateId(t){t&&this.collateService.getCollate(t).subscribe(e=>{if(this.collate=e,this.title.setTitle(`${e.title} - C|nder`),this.projects=e.projects,e.settings||(e.settings={projectOrder:[],analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),e.settings.plotSettings||(e.settings.plotSettings={}),e.settings.projectOrder&&(this.projects=e.settings.projectOrder.map(i=>e.projects.find(n=>n.id===i))),!this.collate?.settings.projectAnalysisGroupVisibility){this.collate.settings.projectAnalysisGroupVisibility={};for(let i of this.projects)this.collate.settings.projectAnalysisGroupVisibility[i.id]={}}if(this.collate?.settings.renameSampleCondition)this.sessionId&&this.getSearchFromID(this.sessionId);else{this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(n=>{for(let h of n)this.collate.settings.renameSampleCondition[i.id][h.Condition]=h.Condition;console.log(this.collate.settings.renameSampleCondition)});this.sessionId&&this.getSearchFromID(this.sessionId)}console.log(this.projects)})}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,e,i,n,h,S,O,q){this.title=t,this.ws=e,this.sb=i,this.dialog=n,this.collateService=h,this.web=S,this.accounts=O,this.router=q,this._sessionId=null,this.collate=null,this.projects=[],this.filteredResults={},this.searchTerms=[],this.selectedIndex=0,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this._selectedSearchTerm="",this.pastSearches=[],this.waitingForDownload=!1;let tt=localStorage.getItem("cinderPastSearches");tt&&(this.pastSearches=JSON.parse(tt)),this.ws.searchWSConnection?.subscribe(ot=>{if(ot&&ot.type==="export_status"&&this.web.cinderInstanceID===ot.instance_id&&this.waitingForDownload)switch(ot.status){case"error":this.waitingForDownload=!1;break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.waitingForDownload=!1,this.sb.open("Export complete","Dismiss",{duration:2e3});let nt=`${this.web.baseURL}/api/search/download_temp_file/?token=${ot.file}`;window.open(nt,"_blank");break}})}associateAnalysisGroupsWithProjects(){return Tt(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(e=>{let i=e.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(e),this.analysisGroupProjects[e.id]=this.projects.find(n=>n.id===i)})})}distributeSearchResults(t){return Tt(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(e=>e.search_term))),t.forEach(e=>{let i=e.analysis_group.id,n=this.analysisGroupProjects[i];n&&(this.searchResults[n.id]||(this.searchResults[n.id]=[]),this.searchResults[n.id].push(e))}),console.log(this.searchResults),this.searchTerms.sort((e,i)=>e.localeCompare(i)),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(e=>{t[e]=this.searchResults[e].filter(i=>i.search_term===this.selectedSearchTerm),this.collate?.settings?.analysisGroupOrderMap&&(console.log(this.collate.settings.analysisGroupOrderMap),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{let n=parseInt(i),h=this.collate?.settings.analysisGroupOrderMap[n];if(!t[n]||!h)return;console.log(h);let S=t[n].filter(O=>!h.includes(O.analysis_group.id));if(t[n]=t[n].filter(O=>h.includes(O.analysis_group.id)),t[n]=t[n].sort((O,q)=>h.indexOf(O.analysis_group.id)-h.indexOf(q.analysis_group.id)),t[n].concat(S),this.collate?.settings?.projectAnalysisGroupVisibility){let O=this.collate?.settings.projectAnalysisGroupVisibility[n];t[n]=t[n].filter(q=>!O||!(q.analysis_group.id in O)?!0:O[q.analysis_group.id])}}))}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults(),console.log(this.filteredResults)}getSearchFromID(t){this.web.getSearchSession(t).subscribe(e=>{this.searchSession=e}),this.web.getSearchResults(t,99999).subscribe(e=>{if(!this.collate)return;console.log(e.results);let i=Array.from(new Set(e.results.map(h=>h.search_term)));this.pastSearches.find(h=>h.searchID===t)||(this.pastSearches.push({searchQuery:null,termFounds:i,collate:this.collate.id,searchID:t}),this.pastSearches=this.pastSearches.slice(-20),localStorage.setItem("cinderPastSearches",JSON.stringify(this.pastSearches))),this.distributeSearchResults(e.results).then()})}restoreSearches(t,e){this.web.getSearchSession(e).subscribe(i=>{this.searchSession=i}),t?this.distributeSearchResults(t.results).then():this.web.getSearchResults(e,99999).subscribe(i=>{this.distributeSearchResults(i.results).then()})}navigateToEdit(){this.collate&&this.router.navigate([`/collate/edit/${this.collate.id}`])}openQRCodeDialog(){let t=window.location.href,e=this.dialog.open(an);e.componentInstance.url=t}navigateToHome(){this.router.navigate(["/"])}exportData(t){this.web.exportSearchData(this.searchSession.id,t,1e-8,1e-8,this.web.searchSessionID).subscribe(e=>{this.waitingForDownload=!0})}openVisibilityDialog(){let t=this.dialog.open(Bi);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(e=>{let i={};e.forEach(h=>{i[h.project]||(i[h.project]=[]),i[h.project].push(h)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(h=>{let S=parseInt(h),O=this.collate?.settings.analysisGroupOrderMap[S];if(!O||!i[S])return;let q=i[S].filter(tt=>!O.includes(tt.id));i[S]=i[S].filter(tt=>O.includes(tt.id)),i[S]=i[S].sort((tt,ot)=>O.indexOf(tt.id)-O.indexOf(ot.id)),i[S]=i[S].concat(q)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let n={};this.collate?.settings?.projectAnalysisGroupVisibility&&(n=this.collate.settings.projectAnalysisGroupVisibility);for(let h in i){n[h]||(n[h]={});for(let S of i[h])S.id in n[h]||(n[h][S.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},n)}),t.afterClosed().subscribe(e=>{this.collate&&e&&(this.collate.settings.projectAnalysisGroupVisibility=e,this.filteredResults=this.getFilteredSearchResults())})}static{this.\u0275fac=function(e){return new(e||o)(F(To),F(hi),F(Jt),F(Te),F(me),F($t),F(oe),F(be))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-view"]],inputs:{sessionId:"sessionId",collateId:"collateId"},decls:18,vars:9,consts:[["previousSearch","matMenu"],["href","/#/home"],[3,"width","height","ngSrc"],[1,"spacer"],["mat-icon-button","","matTooltip","Open QR code dialog",3,"click"],["mat-icon-button","","matTooltip","Change analysis group visibility",3,"click"],["mat-icon-button","","matTooltip","Edit collate"],[3,"collate"],[2,"display","flex","justify-content","center"],[3,"searchResultID","projects"],["mat-icon-button","","matTooltip","View previous searches",3,"matMenuTriggerFor"],["mat-menu-item","","disabled",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Edit collate",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTags"],[2,"padding","20px"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"searchTerm","renameCondition","projects","filteredResults"],["mat-tab-label",""],["mat-icon-button","","matTooltip","Export data",3,"click","disabled"]],template:function(e,i){e&1&&(c(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"a",1),R(3,"img",2),p(),R(4,"span",3),V(5,Er,7,2),c(6,"button",4),k("click",function(){return i.openQRCodeDialog()}),c(7,"mat-icon"),C(8,"qr_code"),p()(),c(9,"button",5),k("click",function(){return i.openVisibilityDialog()}),c(10,"mat-icon"),C(11,"visibility"),p()(),V(12,Pr,3,0,"button",6),p()(),V(13,Ar,1,1,"app-collate-header",7)(14,Fr,1,1),c(15,"div",8)(16,"app-collate-search",9),k("searchResultID",function(h){return i._sessionId=h,i.getSearchFromID(h)}),p()(),V(17,Rr,5,3)),e&2&&(u(3),E("width",25)("height",25)("ngSrc","/assets/logo.png"),u(2),H(i.collate?5:-1),u(7),H(i.accounts.loggedIn?12:-1),u(),H(i.collate?13:-1),u(),H(i.collate&&i.collate.settings?14:-1),u(2),E("projects",i.projects),u(),H(i.searchTerms.length>0?17:-1))},dependencies:[Zo,Ii,Mi,ji,Vi,Ot,de,mi,ui,Oi,jo,Di,ki,Ei,Xo,ri],encapsulation:2})}}return o})();var ln=(o,d)=>d.id;function Gr(o,d){if(o&1){let t=W();c(0,"mat-chip",2),k("click",function(){let i=P(t).$implicit,n=g(2);return A(n.removeProject(i))}),C(1),p()}if(o&2){let t=d.$implicit;u(),et(" ",t.name," ")}}function Lr(o,d){if(o&1&&(c(0,"div"),C(1),c(2,"mat-chip-set"),rt(3,Gr,2,1,"mat-chip",null,ln),p()()),o&2){let t=g();u(),et(" Selected Projects: ",t.selectedMultipleProjects.length," "),u(2),at(t.selectedMultipleProjects)}}function $r(o,d){if(o&1&&(c(0,"mat-list-option",4),C(1),p()),o&2){let t=d.$implicit;E("value",t),u(),mt(t.name)}}function zr(o,d){if(o&1){let t=W();c(0,"div")(1,"mat-selection-list",3),rt(2,$r,2,2,"mat-list-option",4,ln),p(),c(4,"mat-paginator",5),k("page",function(i){P(t);let n=g(2);return A(n.handleProjectPageEvent(i))}),p()()}if(o&2){let t=g(2);u(),E("multiple",!1),u(),at(t.projectQuery.results),u(2),E("pageSize",t.projectPageSize)("length",t.projectQuery.count)("pageIndex",t.projectPageIndex)}}function Nr(o,d){o&1&&(c(0,"p"),C(1,"No projects found."),p())}function Hr(o,d){if(o&1&&V(0,zr,5,4,"div")(1,Nr,2,0,"p"),o&2){let t=g();H(t.projectQuery.count>0?0:1)}}var cn=(()=>{class o{constructor(t,e){this.fb=t,this.web=e,this.multipleSelection=!1,this.selectedProjects=new ut,this.formProjectSearch=this.fb.group({searchTerm:new Kt("",Ut.required),selectedProjects:new Kt([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(i=>{i&&this.fetchProjects(i,this.projectPageSize,0)}),this.formProjectSearch.controls.selectedProjects.valueChanges.subscribe(i=>{if(i){for(let n of i)this.selectedMultipleProjects.includes(n)||this.selectedMultipleProjects.push(n);this.selectedProjects.emit(this.selectedMultipleProjects)}})}fetchProjects(t,e,i){let n=i*e;this.web.getProjects(void 0,e,n,t,void 0).subscribe(h=>{this.projectQuery=h})}handleProjectPageEvent(t){this.projectPageIndex=t.pageIndex,this.fetchProjects(this.formProjectSearch.controls.searchTerm.value||"",t.pageSize,t.pageIndex)}removeProject(t){this.selectedMultipleProjects=this.selectedMultipleProjects.filter(e=>e!==t),this.selectedProjects.emit(this.selectedMultipleProjects)}static{this.\u0275fac=function(e){return new(e||o)(F(Rt),F($t))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-project-search"]],inputs:{multipleSelection:"multipleSelection"},outputs:{selectedProjects:"selectedProjects"},decls:7,vars:3,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Project Name","type","search"],[3,"click"],["formControlName","selectedProjects",3,"multiple"],[3,"value"],[3,"page","pageSize","length","pageIndex"]],template:function(e,i){e&1&&(c(0,"form",0)(1,"mat-form-field"),R(2,"input",1),c(3,"mat-label"),C(4,"Search For Specific Projects"),p()(),V(5,Lr,5,1,"div")(6,Hr,2,1),p()),e&2&&(E("formGroup",i.formProjectSearch),u(5),H(i.selectedMultipleProjects.length>0?5:-1),u(),H(i.projectQuery?6:-1))},dependencies:[Qt,Wt,Bt,St,qt,te,ee,Gt,Lt,ie,ci,li,ni,oi,ai],encapsulation:2})}}return o})();var dn=(()=>{class o{constructor(t,e,i){this.dialogRef=t,this.fb=e,this.web=i,this.formProjectSearch=this.fb.group({searchTerm:new Kt("",Ut.required),selectedProjects:new Kt([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.multipleSelection=!0,this.web.getProjects(void 0,this.projectPageSize,0,void 0).subscribe(n=>{this.projectQuery=n}),this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(n=>{n&&this.web.getProjects(void 0,this.projectPageSize,0,n).subscribe(h=>{this.projectQuery=h})})}handleSelectedProjects(t){this.selectedMultipleProjects=t}close(){this.dialogRef.close()}save(){this.dialogRef.close(this.selectedMultipleProjects)}static{this.\u0275fac=function(e){return new(e||o)(F(kt),F(Rt),F($t))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-project-add-dialog"]],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"selectedProjects"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(e,i){e&1&&(c(0,"h2",0),C(1,"Project Add"),p(),c(2,"div",1)(3,"app-project-search",2),k("selectedProjects",function(h){return i.handleSelectedProjects(h)}),p(),c(4,"small"),C(5),p()(),c(6,"div",3)(7,"button",4),k("click",function(){return i.save()}),C(8,"Submit"),p(),c(9,"button",4),k("click",function(){return i.close()}),C(10,"Close"),p()()),e&2&&(u(5),et("Selected ",i.selectedMultipleProjects.length," Projects."))},dependencies:[cn,Dt,Et,Pt,vt],encapsulation:2})}}return o})();var pn=(o,d)=>d.id;function qr(o,d){if(o&1&&(c(0,"mat-list-item",5)(1,"mat-icon",7),C(2,"notes"),p(),c(3,"div",8),C(4),p(),R(5,"div",9),p()),o&2){let t=d.$implicit;u(4),mt(t.name)}}function Wr(o,d){if(o&1){let t=W();c(0,"div",5)(1,"div",6)(2,"b"),C(3),p()(),c(4,"div",4),k("cdkDropListDropped",function(i){let n=P(t).$implicit,h=g(2);return A(h.drop(i,n.id))}),rt(5,qr,6,1,"mat-list-item",5,pn),p(),R(7,"mat-divider"),p()}if(o&2){let t=d.$implicit,e=g(2);u(3),mt(t.name),u(2),at(e.projectAnalysisGroupMap[t.id])}}function Qr(o,d){if(o&1){let t=W();c(0,"mat-list")(1,"div",4),k("cdkDropListDropped",function(i){P(t);let n=g();return A(n.dropProject(i))}),rt(2,Wr,8,1,"div",5,pn),p()()}if(o&2){let t=g();u(2),at(t.projects)}}var hn=(()=>{class o{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}constructor(t){this.dialogRef=t,this._projectAnalysisGroupMap={},this._projects=[]}save(){this.dialogRef.close({projects:this.projects,projectAnalysisGroupMap:this.projectAnalysisGroupMap})}cancel(){this.dialogRef.close()}drop(t,e){_e(this.projectAnalysisGroupMap[e],t.previousIndex,t.currentIndex)}dropProject(t){_e(this.projects,t.previousIndex,t.currentIndex)}static{this.\u0275fac=function(e){return new(e||o)(F(kt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-project-analysis-group-reorder-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["mat-subheader","","cdkDragHandle",""],["cdkDragHandle","","matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""]],template:function(e,i){e&1&&(c(0,"h1",0),C(1,"Analysis Group Reorder"),p(),c(2,"div",1),V(3,Qr,4,0,"mat-list"),p(),c(4,"div",2)(5,"button",3),k("click",function(){return i.cancel()}),C(6,"Close"),p(),c(7,"button",3),k("click",function(){return i.save()}),C(8,"Save"),p()()),e&2&&(u(3),H(i.projects.length>0?3:-1))},dependencies:[Dt,Et,Go,$o,Lo,ii,Ot,Ro,Pi,ge,ue,Pt,vt],encapsulation:2})}}return o})();var Xr=["hueSlider"],Yr=["alphaSlider"];function Ur(o,d){if(o&1){let t=W();c(0,"div",10),k("newValue",function(i){P(t);let n=g();return A(n.onSliderChange("saturation-lightness",i))}),c(1,"div",11),R(2,"div"),p()()}if(o&2){let t=g();ce("background-color",t.hueSliderColor),E("rgX",1)("rgY",1),u(),ce("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function Kr(o,d){if(o&1&&(c(0,"div",12),R(1,"div",13)(2,"div",14),p()),o&2){let t=g();u(2),ce("background-color",t.selectedColor)}}function Jr(o,d){if(o&1){let t=W();c(0,"div",15,1),k("newValue",function(i){P(t);let n=g();return A(n.onSliderChange("hue",i))}),c(2,"div",16)(3,"div"),R(4,"div"),p()()()}if(o&2){let t=g();E("rgX",1),u(2),ce("left",t.slider==null?null:t.slider.h,"px")}}function Zr(o,d){if(o&1){let t=W();c(0,"div",17,2),k("newValue",function(i){P(t);let n=g();return A(n.onSliderChange("alpha",i))}),R(2,"div",18),c(3,"div",16)(4,"div"),R(5,"div"),p()()()}if(o&2){let t=g();E("rgX",1),u(2),E("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),u(),ce("left",t.slider==null?null:t.slider.a,"px")}}var ta=["dialog"],gn=o=>({background:o});function ea(o,d){o&1&&R(0,"div",12)}function ia(o,d){if(o&1){let t=W();yt(0),c(1,"div",9)(2,"div",10),k("click",function(){let i=P(t).$implicit,n=g(2);return A(n.onColorClick(i))}),V(3,ea,1,0,"div",11),p()(),bt()}if(o&2){let t=d.$implicit,e=d.index,i=g(2);u(2),qe("colornull",!t),E("ngStyle",i.getBackgroundColor(t)),u(),E("ngIf",e==i.indexSeleccionado)}}function oa(o,d){if(o&1&&R(0,"div",18),o&2){let t=g(3);E("ngStyle",t.getBackgroundColor(t.color))}}function na(o,d){if(o&1){let t=W();c(0,"div",13),k("click",function(){P(t);let i=g(2);return A(i.addColor())}),V(1,oa,1,1,"div",14),Ne(),c(2,"svg",15),R(3,"path",16)(4,"path",17),p()()}if(o&2){let t=g(2);u(),E("ngIf",t.indexSeleccionado===void 0)}}function ra(o,d){if(o&1){let t=W();c(0,"color-picker",19),k("colorChange",function(i){P(t);let n=g(2);return A(n.onChangeColorPicker(i))})("onAlphaChange",function(i){P(t);let n=g(2);return A(n.onAlphaChange(i))}),p()}if(o&2){let t=g(2);E("controls",t.colorPickerControls)("color",t.hsva)}}function aa(o,d){if(o&1&&(yt(0),c(1,"div",5),V(2,ia,4,4,"ng-container",6)(3,na,5,1,"div",7)(4,ra,1,2,"color-picker",8),p(),bt()),o&2){let t=g();u(),E("@colorsAnimation",t.colorsAnimationEffect),u(),E("ngForOf",t.palette),u(),E("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),u(),E("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function sa(o,d){o&1&&R(0,"div",12)}function la(o,d){if(o&1){let t=W();yt(0),c(1,"div",9)(2,"div",25),k("click",function(){let i=P(t).$implicit,n=g(2);return A(n.changeColor(i))}),V(3,sa,1,0,"div",11),p()(),bt()}if(o&2){let t=d.$implicit,e=g(2);u(2),qe("colornull",!t),E("ngStyle",Qi(4,gn,t)),u(),E("ngIf",e.isSelected(t))}}function ca(o,d){if(o&1){let t=W();yt(0),c(1,"div",5)(2,"div",20)(3,"div",21),k("click",function(){P(t);let i=g();return A(i.onClickBack())}),Ne(),c(4,"svg",22),R(5,"path",23)(6,"path",24),p()()(),V(7,la,4,6,"ng-container",6),p(),bt()}if(o&2){let t=g();u(),E("@colorsAnimation",t.colorsAnimationEffect),u(6),E("ngForOf",t.variants)}}function da(o,d){if(o&1){let t=W();yt(0),c(1,"div",26)(2,"div",27),k("click",function(){P(t);let i=g();return A(i.onClickBack())}),Ne(),c(3,"svg",22),R(4,"path",23)(5,"path",24),p()(),uo(),c(6,"button",28),k("click",function(){P(t);let i=g();return A(i.emitClose("cancel"))}),C(7),p(),c(8,"button",28),k("click",function(){P(t);let i=g();return A(i.emitClose("accept"))}),C(9),p()(),c(10,"div",29)(11,"color-picker",30),k("sliderChange",function(i){P(t);let n=g();return A(n.onChangeColorPicker(i))}),p()(),bt()}if(o&2){let t=g();u(7),et(" ",t.cancelLabel," "),u(2),et(" ",t.acceptLabel," "),u(2),E("controls",t.colorPickerControls)("color",t.hsva)}}function pa(o,d){if(o&1){let t=W();c(0,"div",31)(1,"p",32),k("click",function(){P(t);let i=g();return A(i.nextFormat())}),C(2),p(),c(3,"div",33)(4,"input",34,1),k("keyup",function(){P(t);let i=Yt(5),n=g();return A(n.changeColorManual(i.value))})("keydown.enter",function(){P(t);let i=g();return A(i.emitClose("accept"))}),p()()()}if(o&2){let t=g();u(2),mt(t.colorFormats[t.format]),u(2),ce("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),E("placeholder",t.placeholder)("value",t.color)}}var oo=["hex","rgba","hsla","cmyk"],zt=function(o){return o[o.HEX=0]="HEX",o[o.RGBA=1]="RGBA",o[o.HSLA=2]="HSLA",o[o.CMYK=3]="CMYK",o}(zt||{}),mn=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],re=class{constructor(d,t,e,i){this.r=d,this.g=t,this.b=e,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Zt=class{constructor(d,t,e,i){this.h=d,this.s=t,this.v=e,this.a=i,this.onChange=new ut(!0)}onColorChange(d){this.s=d.s/d.rgX,this.v=d.v/d.rgY}onHueChange(d){this.h=d.v/d.rgX}onValueChange(d){this.v=d.v/d.rgX}onAlphaChange(d){this.a=d.v/d.rgX}},Ce=class{constructor(d,t,e,i){this.h=d,this.s=t,this.l=e,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},fe=class{constructor(d,t,e,i,n=1){this.c=d,this.m=t,this.y=e,this.k=i,this.a=n}denormalize(){return this.c=Math.round(this.c*100),this.m=Math.round(this.m*100),this.y=Math.round(this.y*100),this.k=Math.round(this.k*100),this}toString(){return this.denormalize(),"cmyk("+this.c+", "+this.m+", "+this.y+", "+this.k+")"}},no=class{constructor(d){d&&(this.preview=d.preview,this.variants=d.variants)}},Li=(()=>{class o{constructor(){}toFormat(t,e){var i="";if(t)switch(e){case zt.HEX:var h=this.hsvaToRgba(t);h.denormalize();var i=this.rgbaToHex(h,!0);break;case zt.HSLA:var n=this.hsva2hsla(t);n.denormalize();var i=n.toString();break;case zt.RGBA:var h=this.hsvaToRgba(t),i=h.toString();break;case zt.CMYK:var S=this.hsvaToCmyk(t),i=S.toString();break}return i}stringToFormat(t,e){var i=this.stringToHsva(t,!0);return this.toFormat(i,e)}hsva2hsla(t){let e=t.h,i=t.s,n=t.v,h=t.a;if(n===0)return new Ce(e,0,0,h);if(i===0&&n===1)return new Ce(e,1,1,h);{let S=n*(2-i)/2;return new Ce(e,n*i/(1-Math.abs(2*S-1)),S,h)}}hsla2hsva(t){let e=Math.min(t.h,1),i=Math.min(t.s,1),n=Math.min(t.l,1),h=Math.min(t.a,1);if(n===0)return new Zt(e,0,0,h);{let S=n+i*(1-Math.abs(2*n-1))/2;return new Zt(e,2*(S-n)/S,S,h)}}hsvaToRgba(t){let e,i,n,h=t.h,S=t.s,O=t.v,q=t.a,tt=Math.floor(h*6),ot=h*6-tt,nt=O*(1-S),Q=O*(1-ot*S),it=O*(1-(1-ot)*S);switch(tt%6){case 0:e=O,i=it,n=nt;break;case 1:e=Q,i=O,n=nt;break;case 2:e=nt,i=O,n=it;break;case 3:e=nt,i=Q,n=O;break;case 4:e=it,i=nt,n=O;break;case 5:e=O,i=nt,n=Q;break;default:e=0,i=0,n=0}return new re(e,i,n,q)}cmykToRgb(t){let e=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),n=(1-t.y)*(1-t.k);return new re(e,i,n,t.a)}rgbaToCmyk(t){let e=1-Math.max(t.r,t.g,t.b);if(e===1)return new fe(0,0,0,1,t.a);{let i=(1-t.r-e)/(1-e),n=(1-t.g-e)/(1-e),h=(1-t.b-e)/(1-e);return new fe(i,n,h,e,t.a)}}hsvaToCmyk(t){let e=this.hsvaToRgba(t);return this.rgbaToCmyk(e)}rgbaToHsva(t){let e,i,n=Math.min(t.r,1),h=Math.min(t.g,1),S=Math.min(t.b,1),O=Math.min(t.a,1),q=Math.max(n,h,S),tt=Math.min(n,h,S),ot=q,nt=q-tt;if(i=q===0?0:nt/q,q===tt)e=0;else{switch(q){case n:e=(h-S)/nt+(h<S?6:0);break;case h:e=(S-n)/nt+2;break;case S:e=(n-h)/nt+4;break;default:e=0}e/=6}return new Zt(e,i,ot,O)}rgbaToHex(t,e){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new fe(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new fe(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new re(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",e=!0){let i=null;t=(t||"").toLowerCase();let n=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(h){return new re(parseInt(h[2],10)/255,parseInt(h[3],10)/255,parseInt(h[4],10)/255,isNaN(parseFloat(h[5]))?1:parseFloat(h[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(h){return new Ce(parseInt(h[2],10)/360,parseInt(h[3],10)/100,parseInt(h[4],10)/100,isNaN(parseFloat(h[5]))?1:parseFloat(h[5]))}},{re:/cmyk?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(h){return new fe(parseInt(h[1],10)/100,parseInt(h[2],10)/100,parseInt(h[3],10)/100,parseInt(h[4],10)/100)}}];e?n.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(h){return new re(parseInt(h[1],16)/255,parseInt(h[2],16)/255,parseInt(h[3],16)/255,parseInt(h[4]||"FF",16)/255)}}):n.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(h){return new re(parseInt(h[1],16)/255,parseInt(h[2],16)/255,parseInt(h[3],16)/255,1)}}),n.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(h){return new re(parseInt(h[1]+h[1],16)/255,parseInt(h[2]+h[2],16)/255,parseInt(h[3]+h[3],16)/255,1)}});for(let h in n)if(n.hasOwnProperty(h)){let S=n[h],O=S.re.exec(t),q=O&&S.parse(O);if(q){if(q instanceof re)i=this.rgbaToHsva(q);else if(q instanceof Ce)i=this.hsla2hsva(q);else if(q instanceof fe){let tt=this.cmykToRgb(q);i=this.rgbaToHsva(tt)}return i}}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let e=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,n=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/,h=/(cmyk\(\d{1,3}(,\s?\d{1,3}){3}\))/;if(e.test(t))return"hex";if(i.test(t))return"rgba";if(n.test(t))return"hsla";if(h.test(t))return"cmyk"}return"hex"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=zi({token:o,factory:o.\u0275fac}),o})(),Gi=class{constructor(d,t,e,i){this.h=d,this.s=t,this.v=e,this.a=i}},ro=class{constructor(d,t,e,i){this.h=d,this.s=t,this.v=e,this.a=i}},ha=(()=>{class o{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new ut,this.dragStart=new ut,this.newValue=new ut,this.listenerMove=e=>this.move(e),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let e=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-e.left-window.pageXOffset}getY(t){let e=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-e.top-window.pageYOffset}setCursor(t){let e=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,n=Math.max(0,Math.min(this.getX(t),e)),h=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:n/e,v:1-h/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:h/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:n/e,rgX:this.rgX})}}return o.\u0275fac=function(t){return new(t||o)(F(Ni))},o.\u0275dir=qi({type:o,selectors:[["","slider",""]],hostBindings:function(t,e){t&1&&k("mousedown",function(n){return e.mouseDown(n)})("touchstart",function(n){return e.touchStart(n)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"},standalone:!1}),o})(),ma=(()=>{class o{constructor(t,e){this.service=t,this.cdr=e,this.color=new Zt(0,1,1,1),this.controls="default",this.sliderChange=new ut(!1),this.onAlphaChange=new ut(!1),this.hsva=new Zt(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new Zt(0,1,1,1)),this.slider=new Gi(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,e=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new ro(t,220,130,e),this.update()}onSliderChange(t,e){switch(t){case"saturation-lightness":this.hsva.onColorChange(e);break;case"hue":this.hsva.onHueChange(e);break;case"alpha":this.hsva.onAlphaChange(e),this.onAlphaChange.emit(e);break;case"value":this.hsva.onValueChange(e);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),e=this.service.hsvaToRgba(new Zt(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+e.r+","+e.g+","+e.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new Gi(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return o.\u0275fac=function(t){return new(t||o)(F(Li),F(Je))},o.\u0275cmp=Z({type:o,selectors:[["color-picker"]],viewQuery:function(t,e){if(t&1&&(We(Xr,5),We(Yr,5)),t&2){let i;Qe(i=Xe())&&(e.hueSlider=i.first),Qe(i=Xe())&&(e.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},standalone:!1,features:[mo],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,e){if(t&1){let i=W();c(0,"div",3,0),k("click",function(h){return P(i),A(h.stopPropagation())}),V(2,Ur,3,8,"div",4),c(3,"div",5),V(4,Kr,3,2,"div",6),c(5,"div",7),V(6,Jr,5,3,"div",8)(7,Zr,6,4,"div",9),p()()()}t&2&&(u(2),E("ngIf",e.controls!="only-alpha"),u(2),E("ngIf",e.controls!="only-alpha"),u(2),E("ngIf",e.controls!="only-alpha"),u(),E("ngIf",e.controls!="no-alpha"))},dependencies:[Xi,Ze,ha],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),o})(),ua=(()=>{class o{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,e){this.service=t,this.cdr=e,this.color="#000000",this.previewColor="#000000",this.hsva=new Zt(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=mn,this.variants=[],this.userFormats=[],this.colorFormats=oo,this.format=zt.HEX,this.formatMap={hex:zt.HEX,rgba:zt.RGBA,hsla:zt.HSLA,cmyk:zt.CMYK},this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let e;if(this.color)for(let i=0;i<t.length;i++){let n=t[i];typeof n=="string"?this.service.stringToFormat(this.color,zt.HEX)==this.service.stringToFormat(n,zt.HEX)&&(e=i):n===void 0?this.color=void 0:this.findIndexSelectedColor(n.variants)!=null&&(e=i)}return e}iniciate(t,e,i,n,h,S,O,q,tt,ot,nt,Q,it=[]){if(this.colorPickerControls=nt,this.triggerInstance=t,this.TriggerBBox=e,this.color=i,this.hideColorPicker=q,this.hideTextInput=O,this.acceptLabel=tt,this.cancelLabel=ot,it.length&&it.every(_t=>oo.includes(_t))&&(this.colorFormats=it),S?this.colorFormats.includes(S)?(this.format=this.colorFormats.indexOf(S.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=S.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=zt.HEX):(this.format=this.colorFormats.indexOf(this.service.getFormatByString(this.color)),this.format<0&&(this.format=0)),this.previewColor=this.color,this.palette=n??mn,this.colorsAnimationEffect=h,Q=="top"){let ct=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+ct.height+"px ))"}}setPosition(){if(this.TriggerBBox){let e=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=e.top+e.height,e.left+250>window.innerWidth?this.left=e.right<250?window.innerWidth/2-250/2:e.right-250:this.left=e.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),e=this.panelRef.nativeElement.getBoundingClientRect(),i=e.height;t.bottom+i>window.innerHeight?this.positionString=t.top<e.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(e=>e.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,e){var i=[];for(let n=0;n<e.length;n++){let h=e[n];if(typeof h=="string"){let S=this.service.stringToHsva(h);S.onAlphaChange(t),i.push(this.service.toFormat(S,this.format))}else{let S=new no,O=this.service.stringToHsva(h.preview);O.onAlphaChange(t),S.preview=this.service.toFormat(O,this.format),S.variants=this.ChangeAlphaOnPalette(t,h.variants),i.push(S)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.setPreviewColor(this.hsva),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color,this.previewColor)}setColor(t,e=-1){this.hsva=t;let i=this.colorFormats[this.format],n=e;n<0&&(n=this.formatMap[i]),this.color=this.service.toFormat(t,n),this.setPreviewColor(t),this.triggerInstance.setColor(this.color,this.previewColor)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){if(this.canChangeFormat){this.format=(this.format+1)%this.colorFormats.length;let t=this.colorFormats[this.format],e=this.formatMap[t];this.setColor(this.hsva,e),this.placeholder=this.service.toFormat(new Zt(0,0,1,1),e)}}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return o.\u0275fac=function(t){return new(t||o)(F(Li),F(Je))},o.\u0275cmp=Z({type:o,selectors:[["ngx-colors-panel"]],viewQuery:function(t,e){if(t&1&&We(ta,5),t&2){let i;Qe(i=Xe())&&(e.panelRef=i.first)}},hostVars:4,hostBindings:function(t,e){t&1&&k("mousedown",function(n){return e.click(n)},!1,Hi)("scroll",function(){return e.onScroll()},!1,Hi)("resize",function(){return e.onResize()},!1,_o),t&2&&ce("top",e.top,"px")("left",e.left,"px")},standalone:!1,decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[2,"cursor","pointer",3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,e){t&1&&(c(0,"div",2,0),V(2,aa,5,4,"ng-container",3)(3,ca,8,2,"ng-container",3)(4,da,12,4,"ng-container",3)(5,pa,6,7,"div",4),p()),t&2&&(wo(e.positionString),u(2),E("ngIf",e.menu==1),u(),E("ngIf",e.menu==2),u(),E("ngIf",e.menu==3),u(),E("ngIf",!e.hideTextInput))},dependencies:[Mo,Xi,Ze,ma],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[Io("colorsAnimation",[Ki("void => slide-in",[Pe(":enter",se({opacity:0}),{optional:!0}),Pe(":enter",Ji("10ms",[Yi(".3s ease-in",Ui([se({opacity:0,transform:"translatex(-50%)",offset:0}),se({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),se({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),Ki("void => popup",[Pe(":enter",se({opacity:0,transform:"scale(0)"}),{optional:!0}),Pe(":enter",Ji("10ms",[Yi("500ms ease-out",Ui([se({opacity:.5,transform:"scale(.5)",offset:.3}),se({opacity:1,transform:"scale(1.1)",offset:.8}),se({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),o})(),un={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},fn=(()=>{class o{constructor(t,e,i){this.resolver=t,this.applicationRef=e,this.injector=i}createPanel(t,e){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(ua);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let n=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(e),Object.keys(un).forEach(h=>{this.overlay.style[h]=un[h]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(n),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return o.\u0275fac=function(t){return new(t||o)(ze(Co),ze(vo),ze(go))},o.\u0275prov=zi({token:o,factory:o.\u0275fac}),o})(),ao=(()=>{class o{onClick(){this.openPanel()}constructor(t,e,i){this.triggerRef=t,this.panelFactory=e,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new ut,this.input=new ut,this.slider=new ut,this.close=new ut,this.open=new ut,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position,this.formats)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t,e=""){this.writeValue(t,e),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t,e=""){if(t!==this.color){if(this.format){let n=oo.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,n)}this.color=t;let i=!1;t&&t.startsWith("cmyk")&&(i=!0,e||(e=this.service.stringToFormat(t,zt.RGBA))),this.change.emit(i?e:t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return o.\u0275fac=function(t){return new(t||o)(F(Ni),F(fn),F(Li))},o.\u0275dir=qi({type:o,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,e){t&1&&k("click",function(){return e.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",formats:"formats",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},standalone:!1,features:[So([{provide:Fo,useExisting:ho(()=>o),multi:!0}])]}),o})(),_n=(()=>{class o{constructor(t,e){this.cdRef=t,this.triggerDirective=e,this.triggerDirectiveColorChangeSubscription=null,this.color=this.triggerDirective.color}ngOnInit(){this.triggerDirectiveColorChangeSubscription=this.triggerDirective.change.subscribe(t=>{this.color=t,this.cdRef.markForCheck()})}ngOnDestroy(){this.triggerDirectiveColorChangeSubscription&&this.triggerDirectiveColorChangeSubscription.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(F(Je),F(ao,1))},o.\u0275cmp=Z({type:o,selectors:[["ngx-colors"]],standalone:!1,decls:4,vars:5,consts:[[1,"app-color-picker"],[1,"preview"],[1,"preview-background"],[1,"circle",3,"ngStyle"]],template:function(t,e){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2),R(3,"div",3),p()()()),t&2&&(u(3),qe("colornull",!e.color),E("ngStyle",Qi(3,gn,e.color)))},dependencies:[Ze],styles:["[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]{line-height:1px;font-family:sans-serif}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin:2px;display:inline-block;box-sizing:border-box;border-radius:100%;background:white;cursor:pointer;padding:3px;box-shadow:0 1px 1px #0003,0 1px 1px 1px #00000024,0 1px 1px 1px #0000001f}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-background[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px;border-radius:100%}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:20px;width:20px;box-sizing:border-box;border-radius:100%;cursor:pointer}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .noselected[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}"]}),o})(),Cn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=He({type:o}),o.\u0275inj=$e({providers:[Li,fn],imports:[ei]}),o})();var fa=(o,d)=>d.id;function _a(o,d){if(o&1){let t=W();c(0,"div",4)(1,"ngx-colors",5),Vt("ngModelChange",function(i){let n=P(t).$implicit,h=g(2).$implicit,S=g();return Ft(S.projectConditionColorMap[h.id][n],i)||(S.projectConditionColorMap[h.id][n]=i),A(i)}),p(),c(2,"div"),C(3),p()()}if(o&2){let t=d.$implicit,e=g(2).$implicit,i=g();u(),It("ngModel",i.projectConditionColorMap[e.id][t]),u(2),mt(t)}}function Ca(o,d){if(o&1&&rt(0,_a,4,2,"div",4,ae),o&2){let t=g().$implicit,e=g();at(e.projectConditionMap[t.id])}}function va(o,d){if(o&1&&(c(0,"div")(1,"div")(2,"b"),C(3),p()(),V(4,Ca,2,0),p()),o&2){let t=d.$implicit,e=g();u(3),mt(t.name),u(),H(e.projectConditionMap[t.id]?4:-1)}}var vn=(()=>{class o{set projects(t){this._projects=t;for(let e of t)this.web.getProjectUniqueConditions(e.id).subscribe(i=>{for(let n of i)this.projectConditionMap[n.AnalysisGroup.project]||(this.projectConditionMap[n.AnalysisGroup.project]=[]),this.projectConditionMap[n.AnalysisGroup.project].includes(n.Condition)||this.projectConditionMap[n.AnalysisGroup.project].push(n.Condition),this.projectConditionColorMap[n.AnalysisGroup.project]||(this.projectConditionColorMap[n.AnalysisGroup.project]={}),this.projectConditionColorMap[n.AnalysisGroup.project][n.Condition]||(this.projectConditionColorMap[n.AnalysisGroup.project][n.Condition]="")})}get projects(){return this._projects}set projectConditionColorMap(t){if(t==null){this._projectConditionColorMap={};return}this._projectConditionColorMap=Object.assign({},t)}get projectConditionColorMap(){return this._projectConditionColorMap}constructor(t,e){this.dialogRef=t,this.web=e,this._projects=[],this.projectConditionMap={},this._projectConditionColorMap={}}save(){this.dialogRef.close(this.projectConditionColorMap)}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(e){return new(e||o)(F(kt),F($t))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-condition-color-editor-dialog"]],inputs:{projects:"projects",projectConditionColorMap:"projectConditionColorMap"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],[2,"display","flex","gap","5px","align-items","center"],["ngx-colors-trigger","",3,"ngModelChange","ngModel"]],template:function(e,i){e&1&&(c(0,"h1",0),C(1,"Condition Color Editor"),p(),c(2,"div",1),rt(3,va,5,2,"div",null,fa),p(),c(5,"div",2)(6,"button",3),k("click",function(){return i.cancel()}),C(7,"Close"),p(),c(8,"button",3),k("click",function(){return i.save()}),C(9,"Save"),p()()),e&2&&(u(3),at(i.projects))},dependencies:[Dt,Et,Cn,_n,ao,he,St,pe,vt,Pt],encapsulation:2})}}return o})();function xa(o,d){if(o&1&&(c(0,"mat-option",6),C(1),p()),o&2){let t=d.$implicit;E("value",t),u(),mt(t)}}var xn=(()=>{class o{_filter(t){let e=t.toLowerCase();return this.tags.filter(i=>i.toLowerCase().includes(e))}constructor(t,e,i){this.fb=t,this.dialogRef=e,this.collateService=i,this.form=this.fb.group({name:["",Ut.required],existing:[!1],id:[-1]}),this.tags=[]}ngOnInit(){this.filteredTags=this.form.controls.name.valueChanges.pipe(Ge(""),Le(t=>this.collateService.getCollateTags(t).pipe(Re(e=>e.results.map(i=>i.name)))))}submit(){let t=this.form.controls.name.value;this.collateService.getCollateTags(t).subscribe(e=>{let i=e.results.find(h=>h.name.toLowerCase()===t.toLowerCase()),n=!!i;this.form.controls.existing.setValue(n),this.form.controls.id.setValue(n?i.id:null),this.dialogRef.close(this.form.value)})}cancel(){this.dialogRef.close()}onTagSelected(t){let e=t.option.value;this.form.controls.name.setValue(e),this.collateService.getCollateTags(e).subscribe(i=>{let n=i.results.find(h=>h.name.toLowerCase()===e.toLowerCase());this.form.controls.existing.setValue(!!n),this.form.controls.id.setValue(n?n.id:null)})}static{this.\u0275fac=function(e){return new(e||o)(F(Rt),F(kt),F(me))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-tag-create-dialog"]],decls:18,vars:5,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["type","text","matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"]],template:function(e,i){if(e&1){let n=W();c(0,"h1",1),C(1,"Create/Add Tag"),p(),c(2,"div",2)(3,"form",3)(4,"mat-form-field")(5,"mat-label"),C(6,"Tag Name"),p(),R(7,"input",4),c(8,"mat-autocomplete",5,0),k("optionSelected",function(S){return P(n),A(i.onTagSelected(S))}),rt(10,xa,2,2,"mat-option",6,ae),Ue(12,"async"),p()()()(),c(13,"div",7)(14,"button",8),k("click",function(){return P(n),A(i.cancel())}),C(15,"Cancel"),p(),c(16,"button",9),k("click",function(){return P(n),A(i.submit())}),C(17,"Submit"),p()()}if(e&2){let n=Yt(9);u(3),E("formGroup",i.form),u(4),E("matAutocomplete",n),u(3),at(Ke(12,3,i.filteredTags)),u(6),E("disabled",i.form.invalid)}},dependencies:[Dt,Et,Qt,Wt,Bt,St,qt,te,ee,ie,Lt,Gt,vt,Pt,Se,ti,di,pi],encapsulation:2})}}return o})();var wa=(o,d)=>d.id;function ya(o,d){o&1&&(c(0,"th",11),C(1," Original Title "),p())}function ba(o,d){if(o&1&&(c(0,"td",12),C(1),p()),o&2){let t=d.$implicit;u(),et(" ",t," ")}}function Sa(o,d){o&1&&(c(0,"th",11),C(1," Display Title "),p())}function Ma(o,d){if(o&1&&(c(0,"td",12)(1,"form",13)(2,"mat-form-field"),R(3,"input",14),p()()()),o&2){let t=d.$implicit,e=g(2).$implicit,i=g();u(),E("formGroup",i.formMap[e.id][t]),u(2),yo("formControlName",t)}}function ja(o,d){o&1&&R(0,"tr",15)}function Ta(o,d){o&1&&R(0,"tr",16)}function ka(o,d){if(o&1&&(c(0,"h5"),C(1),p(),c(2,"table",4),yt(3,5),V(4,ya,2,0,"th",6)(5,ba,2,1,"td",7),bt(),yt(6,8),V(7,Sa,2,0,"th",6)(8,Ma,4,2,"td",7),bt(),V(9,ja,1,0,"tr",9)(10,Ta,1,0,"tr",10),p()),o&2){let t=g().$implicit,e=g();u(),mt(t.name),u(),E("dataSource",e.projectConditionMap[t.id]),u(7),E("matHeaderRowDef",e.displayedColumns),u(),E("matRowDefColumns",e.displayedColumns)}}function Da(o,d){if(o&1&&V(0,ka,11,4),o&2){let t=d.$implicit,e=g();H(e.formMap[t.id]?0:-1)}}var wn=(()=>{class o{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set renameSampleCondition(t){for(let e of this.projects)this.web.getProjectUniqueConditions(e.id).subscribe(i=>{for(let n of i){if(this.formMap[n.AnalysisGroup.project]||(this.formMap[n.AnalysisGroup.project]={}),!this.formMap[n.AnalysisGroup.project][n.Condition]){let h={};h[n.Condition]=new Kt(n.Condition,Ut.required),this.formMap[n.AnalysisGroup.project][n.Condition]=this.fb.group(h)}this.projectConditionMap[n.AnalysisGroup.project]||(this.projectConditionMap[n.AnalysisGroup.project]=[]),this.projectConditionMap[n.AnalysisGroup.project].includes(n.Condition)||this.projectConditionMap[n.AnalysisGroup.project].push(n.Condition),this.renameSampleCondition[n.AnalysisGroup.project]||(this.renameSampleCondition[n.AnalysisGroup.project]={}),this.renameSampleCondition[n.AnalysisGroup.project][n.Condition]||(this.renameSampleCondition[n.AnalysisGroup.project][n.Condition]=n.Condition),t[n.AnalysisGroup.project]&&t[n.AnalysisGroup.project][n.Condition]&&(this.renameSampleCondition[n.AnalysisGroup.project][n.Condition]=t[n.AnalysisGroup.project][n.Condition],this.formMap[n.AnalysisGroup.project][n.Condition].controls[n.Condition].setValue(t[n.AnalysisGroup.project][n.Condition]))}})}get renameSampleCondition(){return this._renameSampleCondition}constructor(t,e,i,n){this.dialog=t,this.web=e,this.fb=i,this.sb=n,this.displayedColumns=["original","display"],this.projectConditionMap={},this._projects=[],this._renameSampleCondition={},this.formMap={}}close(){this.dialog.close()}submit(){let t={};for(let e in this.formMap){t[e]={};for(let i in this.formMap[e])if(t[e][i]=this.formMap[e][i].value[i],!this.formMap[e][i].valid){this.sb.open(`${i} is invalid`);return}}this.dialog.close(t)}static{this.\u0275fac=function(e){return new(e||o)(F(kt),F($t),F(Rt),F(Jt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-rename-sample-condition-dialog"]],inputs:{projects:"projects",renameSampleCondition:"renameSampleCondition"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","original"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","display"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"formGroup"],["matInput","",2,"border-radius","0",3,"formControlName"],["mat-header-row",""],["mat-row",""]],template:function(e,i){e&1&&(c(0,"h1",0),C(1,"Rename Conditions"),p(),c(2,"div",1),rt(3,Da,1,1,null,null,wa),p(),c(5,"div",2)(6,"button",3),k("click",function(){return i.submit()}),C(7,"Submit"),p(),c(8,"button",3),k("click",function(){return i.close()}),C(9,"Close"),p()()),e&2&&(u(3),at(i.projects))},dependencies:[Dt,Et,Qt,Wt,Bt,St,qt,te,ee,xi,fi,Ci,vi,bi,wi,Si,yi,gi,_i,Pt,vt,Gt,Lt],encapsulation:2})}}return o})();var yn=(()=>{class o{set settings(t){for(let e in t)this._settings[e]=t[e];this._settings&&this.form.patchValue(this._settings)}get settings(){return this._settings}constructor(t,e){this.fb=t,this.dialog=e,this._settings={},this.form=this.fb.group({marginLeft:150,marginRight:100,marginTop:100,marginBottom:100,titleTextSize:14,showTitle:!0,height:500,barSize:50})}submit(){this.dialog.close(this.form.value)}close(){this.dialog.close()}static{this.\u0275fac=function(e){return new(e||o)(F(Rt),F(kt))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-plot-settings"]],inputs:{settings:"settings"},decls:46,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],[2,"display","flex","flex-direction","column","gap","5px"],["matInput","","formControlName","height","type","number"],["matInput","","formControlName","barSize","type","number"],["matInput","","formControlName","marginLeft","type","number"],["matInput","","formControlName","marginRight","type","number"],["matInput","","formControlName","marginTop","type","number"],["matInput","","formControlName","marginBottom","type","number"],["formControlName","showTitle"],["matInput","","formControlName","titleTextSize","type","number"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(e,i){e&1&&(c(0,"h5",0),C(1,"Plot General Settings"),p(),c(2,"div",1)(3,"form",2)(4,"section",3)(5,"b"),C(6,"Overall Size"),p(),c(7,"mat-form-field"),R(8,"input",4),c(9,"mat-label"),C(10,"Height"),p()(),c(11,"mat-form-field"),R(12,"input",5),c(13,"mat-label"),C(14,"Bar size"),p()(),c(15,"mat-form-field"),R(16,"input",6),c(17,"mat-label"),C(18,"Margin Left"),p()(),c(19,"mat-form-field"),R(20,"input",7),c(21,"mat-label"),C(22,"Margin Right"),p()(),c(23,"mat-form-field"),R(24,"input",8),c(25,"mat-label"),C(26,"Margin Top"),p()(),c(27,"mat-form-field"),R(28,"input",9),c(29,"mat-label"),C(30,"Margin Bottom"),p()()(),R(31,"mat-divider"),c(32,"section",3)(33,"b"),C(34,"Title"),p(),c(35,"mat-checkbox",10),C(36,"Show Title"),p(),c(37,"mat-form-field"),R(38,"input",11),c(39,"mat-label"),C(40,"Title Text Size"),p()()()()(),c(41,"div",12)(42,"button",13),k("click",function(){return i.close()}),C(43,"Cancel"),p(),c(44,"button",13),k("click",function(){return i.submit()}),C(45,"Save"),p()()),e&2&&(u(3),E("formGroup",i.form))},dependencies:[Dt,Et,Qt,Wt,Bt,Oo,St,qt,te,ee,Gt,Lt,ie,ke,Pt,vt,ii],encapsulation:2})}}return o})();function Ea(o,d){if(o&1){let t=W();c(0,"mat-checkbox",12),Vt("ngModelChange",function(i){P(t);let n=g(2);return Ft(n.collate.settings.showTags,i)||(n.collate.settings.showTags=i),A(i)}),C(1,"Show Tags"),p()}if(o&2){let t=g(2);It("ngModel",t.collate.settings.showTags)}}function Pa(o,d){if(o&1){let t=W();c(0,"h1",15),k("click",function(){P(t);let i=g(3);return A(i.toggleEditTitle())}),C(1),p(),R(2,"br")}if(o&2){let t=g(3);u(),mt(t.collate.title)}}function Aa(o,d){if(o&1){let t=W();c(0,"div")(1,"mat-form-field",16)(2,"input",17),k("keydown.enter",function(){P(t);let i=g(3);return A(i.toggleEditTitle())}),Vt("ngModelChange",function(i){P(t);let n=g(3);return Ft(n.collate.title,i)||(n.collate.title=i),A(i)}),p()(),c(3,"button",18),k("click",function(){P(t);let i=g(3);return A(i.toggleEditTitle())}),c(4,"mat-icon"),C(5,"save"),p()()()}if(o&2){let t=g(3);u(2),It("ngModel",t.collate.title)}}function Ia(o,d){if(o&1){let t=W();c(0,"div",19),k("click",function(){P(t);let i=g(3);return A(i.toggleEditGreeting())}),C(1),p()}if(o&2){let t=g(3);u(),mt(t.collate.greeting)}}function Fa(o,d){if(o&1){let t=W();c(0,"div")(1,"mat-form-field",20)(2,"input",17),k("keydown.enter",function(){P(t);let i=g(3);return A(i.toggleEditGreeting())}),Vt("ngModelChange",function(i){P(t);let n=g(3);return Ft(n.collate.greeting,i)||(n.collate.greeting=i),A(i)}),p()(),c(3,"button",18),k("click",function(){P(t);let i=g(3);return A(i.toggleEditGreeting())}),c(4,"mat-icon"),C(5,"save"),p()()()}if(o&2){let t=g(3);u(2),It("ngModel",t.collate.greeting)}}function Va(o,d){if(o&1&&(c(0,"div",9)(1,"div",13),V(2,Pa,3,1)(3,Aa,6,1,"div")(4,Ia,2,1,"div",14)(5,Fa,6,1,"div"),p()()),o&2){let t=g(2);u(2),H(t.editTitle?3:2),u(2),H(t.editGreeting?5:4)}}function Oa(o,d){if(o&1){let t=W();c(0,"div",1)(1,"button",21),k("click",function(){P(t);let i=g(2);return A(i.openCollateTagCreateDialog())}),C(2,"Add Tag +"),p()(),c(3,"div",22)(4,"app-collate-tags",23),k("collageTagsChange",function(i){P(t);let n=g(2);return A(n.handleCollageTagsChange(i))}),p()()}if(o&2){let t=g(2);u(4),E("collageTags",t.collate.tags)}}function Ba(o,d){if(o&1&&R(0,"mat-tab",25),o&2){let t=d.$implicit;E("label",t)}}function Ra(o,d){if(o&1){let t=W();c(0,"div",11)(1,"mat-tab-group",24),k("selectedTabChange",function(){P(t);let i=g(2);return A(i.filterDataBySearchTerm())}),Vt("selectedIndexChange",function(i){P(t);let n=g(2);return Ft(n.selectedIndex,i)||(n.selectedIndex=i),A(i)}),rt(2,Ba,1,1,"mat-tab",25,ae),p()()}if(o&2){let t=g(2);u(),It("selectedIndex",t.selectedIndex),E("mat-stretch-tabs",!1),u(),at(t.searchTerms)}}function Ga(o,d){if(o&1){let t=W();c(0,"app-collate-project-list",27),k("deleteProject",function(i){P(t);let n=g(4);return A(n.deleteProject(i))})("projectOrderChanged",function(i){P(t);let n=g(4);return A(n.onProjectOrderChanged(i))}),p()}if(o&2){let t=g(4);E("searchTerm",t.selectedSearchTerm)("projectConditionColorMap",t.collate.settings.projectConditionColorMap)("projects",t.projects)("filteredResults",t.filteredResults)("renameCondition",t.collate.settings.renameSampleCondition)}}function La(o,d){if(o&1&&V(0,Ga,1,5,"app-collate-project-list",26),o&2){let t=g(3);H(t.collate.settings.projectConditionColorMap&&t.collate.settings.renameSampleCondition?0:-1)}}function $a(o,d){if(o&1&&V(0,La,1,1),o&2){let t=g(2);H(t.collate.settings?0:-1)}}function za(o,d){if(o&1){let t=W();c(0,"mat-toolbar")(1,"mat-toolbar-row"),R(2,"span",2),V(3,Ea,2,1,"mat-checkbox",3),c(4,"button",4),k("click",function(){P(t);let i=g();return A(i.goToCollateView())}),c(5,"mat-icon"),C(6,"visibility"),p()(),c(7,"button",5),k("click",function(){P(t);let i=g();return A(i.openProjectAddDialog())}),c(8,"mat-icon"),C(9,"add"),p()(),c(10,"button",6),k("click",function(){P(t);let i=g();return A(i.updateCollate())}),c(11,"mat-icon"),C(12,"save"),p()(),c(13,"button",7)(14,"mat-icon"),C(15,"more_vert"),p()(),c(16,"mat-menu",null,0)(18,"button",8),k("click",function(){P(t);let i=g();return A(i.openReorderDialog())}),C(19,"Reorder Analysis Groups"),p(),c(20,"button",8),k("click",function(){P(t);let i=g();return A(i.openVisibilityDialog())}),C(21,"Change Analysis Group Visibility"),p(),c(22,"button",8),k("click",function(){P(t);let i=g();return A(i.openConditionColorEditorDialog())}),C(23,"Set Condition Colors"),p(),c(24,"button",8),k("click",function(){P(t);let i=g();return A(i.openPlotSettings())}),C(25,"Change Plot General Settings"),p(),c(26,"button",8),k("click",function(){P(t);let i=g();return A(i.openRenameConditionDialog())}),C(27,"Rename Condition"),p()()()(),V(28,Va,6,2,"div",9)(29,Oa,5,1),c(30,"div",1)(31,"app-collate-search",10),k("searchResultID",function(i){P(t);let n=g();return A(n.getSearchFromID(i))}),p()(),V(32,Ra,4,2,"div",11)(33,$a,1,1)}if(o&2){let t=Yt(17),e=g();u(3),H(e.collate?3:-1),u(10),E("matMenuTriggerFor",t),u(15),H(e.collate?28:-1),u(),H(e.collate?29:-1),u(2),E("projects",e.projects),u(),H(e.searchTerms.length>0?32:-1),u(),H(e.collate?33:-1)}}function Na(o,d){o&1&&(c(0,"div",1)(1,"p"),C(2," You do not have permission to edit this collate. "),p()())}var so=(()=>{class o{set collateId(t){t&&this.collateService.getCollate(t).subscribe(e=>{if(this._collate=e,this.accounts.getCollatePermissions(e.id).subscribe(i=>{this.canEdit=i.edit}),this.projects=e.projects,this._collate.settings||(this._collate.settings={projectOrder:this.projects.map(i=>i.id),analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),this._collate.settings.plotSettings||(this._collate.settings.plotSettings={}),e.settings.projectOrder){let i=this.projects.filter(n=>!e.settings.projectOrder.includes(n.id));this.projects=this.projects.filter(n=>e.settings.projectOrder.includes(n.id)),this.projects=this.projects.concat(i)}if(this.collate&&"showTags"in this.collate.settings&&(this.collate.settings.showTags=!1),this.collate?.settings.projectConditionColorMap)this.graph.projectConditionColorMap=this.collate.settings.projectConditionColorMap;else{this.collate.settings.projectConditionColorMap={};for(let i of this.projects)this.collate.settings.projectConditionColorMap[i.id]={}}if(!this.collate?.settings.renameSampleCondition){this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(n=>{for(let h of n)this.collate.settings.renameSampleCondition[i.id][h.Condition]=h.Condition;console.log(this.collate.settings.renameSampleCondition)})}})}get collate(){return this._collate}set collate(t){this._collate=t}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,e,i,n,h,S,O){this.accounts=t,this.graph=e,this.router=i,this.snackBar=n,this.dialog=h,this.collateService=S,this.web=O,this._collate=null,this.canEdit=!1,this.projects=[],this.selectedIndex=0,this.editTitle=!1,this.editGreeting=!1,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this.searchTerms=[],this._selectedSearchTerm="",this.filteredResults={},this.removedTags=[]}openProjectAddDialog(){this.dialog.open(dn).afterClosed().subscribe(e=>{e&&(this.projects=this.projects.concat(e),this.collate&&(this.collate.projects=this.projects,this.updateProjectOrder()))})}updateProjectOrder(){this._collate&&(this._collate.settings.projectOrder=this.projects.map(t=>t.id)),console.log(this.collate)}updateCollate(){this._collate&&this.collateService.updateCollate(this._collate.id,this._collate).subscribe(()=>{if(this.removedTags.length>0){let t=this.removedTags.map(e=>this.collateService.removeTagFromCollate(this._collate?.id,e.id));co(t).subscribe(()=>{this.showSnackBar("Collate saved successfully"),this.removedTags=[]})}else this.showSnackBar("Collate saved successfully")})}toggleEditTitle(){this.editTitle=!this.editTitle}toggleEditGreeting(){this.editGreeting=!this.editGreeting}saveTitle(){this.toggleEditTitle(),this.updateCollate()}saveGreeting(){this.toggleEditGreeting(),this.updateCollate()}getSearchFromID(t){this.web.getSearchSession(t).subscribe(e=>{console.log(e)}),this.web.getSearchResults(t,99999).subscribe(e=>{console.log(e.results),this.distributeSearchResults(e.results).then()})}associateAnalysisGroupsWithProjects(){return Tt(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(e=>{let i=e.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(e),this.analysisGroupProjects[e.id]=this.projects.find(n=>n.id===i)})})}distributeSearchResults(t){return Tt(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(e=>e.search_term))),t.forEach(e=>{let i=e.analysis_group.id,n=this.analysisGroupProjects[i];n&&(this.searchResults[n.id]||(this.searchResults[n.id]=[]),this.searchResults[n.id].push(e))}),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(e=>{t[e]=this.searchResults[e].filter(i=>i.search_term===this.selectedSearchTerm)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(e=>{let i=parseInt(e),n=this.collate?.settings.analysisGroupOrderMap[i];if(!t[i]||!n)return;let h=t[i].filter(S=>!n.includes(S.analysis_group.id));if(t[i]=t[i].filter(S=>n.includes(S.analysis_group.id)),t[i]=t[i].sort((S,O)=>n.indexOf(S.analysis_group.id)-n.indexOf(O.analysis_group.id)),t[i]=t[i].concat(h),this.collate?.settings?.projectAnalysisGroupVisibility){let S=this.collate?.settings.projectAnalysisGroupVisibility[i];t[i]=t[i].filter(O=>!S||!(O.analysis_group.id in S)?!0:S[O.analysis_group.id])}}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults()}onProjectOrderChanged(t){this.projects=t,this.updateProjectOrder()}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}deleteProject(t){this.projects=this.projects.filter(e=>e.id!==t.id),this.updateProjectOrder()}goToCollateView(){this._collate&&this.router.navigate(["/collate/view",this._collate.id])}onSearchResultsChange(t,e){this.filteredResults[e]=t,this.collate&&(this.collate.settings.analysisGroupOrderMap||(this.collate.settings.analysisGroupOrderMap={}),this.collate.settings.analysisGroupOrderMap[e]=t.map(i=>i.analysis_group.id),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{this.collate.settings.analysisGroupOrderMap[i]=Array.from(new Set(this.collate.settings.analysisGroupOrderMap[i]))}))}openVisibilityDialog(){let t=this.dialog.open(Bi);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(e=>{let i={};e.forEach(h=>{i[h.project]||(i[h.project]=[]),i[h.project].push(h)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(h=>{let S=parseInt(h),O=this.collate?.settings.analysisGroupOrderMap[S];if(!O||!i[S])return;let q=i[S].filter(tt=>!O.includes(tt.id));i[S]=i[S].filter(tt=>O.includes(tt.id)),i[S]=i[S].sort((tt,ot)=>O.indexOf(tt.id)-O.indexOf(ot.id)),i[S]=i[S].concat(q)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let n={};this.collate?.settings?.projectAnalysisGroupVisibility&&(n=this.collate.settings.projectAnalysisGroupVisibility);for(let h in i){n[h]||(n[h]={});for(let S of i[h])S.id in n[h]||(n[h][S.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},n)}),t.afterClosed().subscribe(e=>{this.collate&&e&&(this.collate.settings.projectAnalysisGroupVisibility=e,this.filteredResults=this.getFilteredSearchResults())})}openReorderDialog(){let t=this.dialog.open(hn);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(e=>{let i={};e.forEach(n=>{i[n.project]||(i[n.project]=[]),i[n.project].push(n)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(n=>{let h=parseInt(n),S=this.collate?.settings.analysisGroupOrderMap[h];if(!S||!i[h])return;let O=i[h].filter(q=>!S.includes(q.id));i[h]=i[h].filter(q=>S.includes(q.id)),i[h]=i[h].sort((q,tt)=>S.indexOf(q.id)-S.indexOf(tt.id)),i[h]=i[h].concat(O)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects}),t.afterClosed().subscribe(e=>{this.projects=e.projects,this.updateProjectOrder(),this.projectAnalysisGroups=e.projectAnalysisGroupMap;let i={};Object.keys(this.projectAnalysisGroups).forEach(n=>{i[n]=this.projectAnalysisGroups[n].map(h=>h.id)}),this.collate&&(this.collate.settings.analysisGroupOrderMap=i,this.filteredResults=this.getFilteredSearchResults())})}openConditionColorEditorDialog(){let t=this.dialog.open(vn);t.componentInstance.projectConditionColorMap=this.collate?.settings?.projectConditionColorMap,t.componentInstance.projects=this.projects,t.afterClosed().subscribe(e=>{this.collate&&(this.collate.settings.projectConditionColorMap=e),this.graph.projectConditionColorMap=Object.assign({},e),this.filteredResults=this.getFilteredSearchResults(),this.graph.redrawTrigger.next(!0)})}openCollateTagCreateDialog(){this.dialog.open(xn).afterClosed().subscribe(e=>{e&&e.name&&(e.existing&&e.id&&e.id!==-1?this.collateService.addTagToCollate(this.collate?.id,e.id).subscribe(i=>{this.collate&&this.collate.tags.push(i)}):this.collateService.createCollateTag(e.name).subscribe(i=>{this.collateService.addTagToCollate(this.collate?.id,i.id).subscribe(n=>{this.collate&&this.collate.tags.push(n)})}))})}handleCollageTagsChange(t){this.collate&&(this.removedTags=this.collate.tags.filter(e=>!t.includes(e)),this.collate.tags=t)}openRenameConditionDialog(){if(this.collate){let t=this.dialog.open(wn);t.componentInstance.projects=this.collate.projects,t.componentInstance.renameSampleCondition=this.collate.settings.renameSampleCondition,t.afterClosed().subscribe(e=>{this.collate&&(this.collate.settings.renameSampleCondition=Object.assign({},e),console.log(this.collate.settings.renameSampleCondition))})}}openPlotSettings(){if(this.collate){let t=this.dialog.open(yn);t.componentInstance.settings=this.collate.settings.plotSettings,t.afterClosed().subscribe(e=>{this.collate&&e&&(this.collate.settings.plotSettings=e,this.graph.plotSettings=e,this.graph.redrawTrigger.next(!0))})}}static{this.\u0275fac=function(e){return new(e||o)(F(oe),F(Ti),F(be),F(Jt),F(Te),F(me),F($t))}}static{this.\u0275cmp=Z({type:o,selectors:[["app-collate-editor"]],inputs:{collateId:"collateId"},decls:2,vars:1,consts:[["extraActionsMenu","matMenu"],[2,"display","flex","justify-content","center"],[1,"spacer"],[3,"ngModel"],["type","button","aria-label","View Collate","mat-icon-button","",3,"click"],["type","button","aria-label","Add Projects","mat-icon-button","",3,"click"],["type","button","aria-label","Update Collate","mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[3,"searchResultID","projects"],[2,"padding","20px"],[3,"ngModelChange","ngModel"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"],[3,"click"],[2,"font-size","2em","text-align","center","font-family","Roboto, Helvetica Neue, sans-serif","padding","5px"],["matInput","",3,"keydown.enter","ngModelChange","ngModel"],["mat-icon-button","",3,"click"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif",3,"click"],[2,"font-size","25px","text-align","center","font-family","'Roboto', 'Arial Narrow', sans-serif","padding","5px"],["mat-button","",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTagsChange","collageTags"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"label"],[3,"searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"],[3,"deleteProject","projectOrderChanged","searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"]],template:function(e,i){e&1&&V(0,za,34,7)(1,Na,3,0,"div",1),e&2&&H(i.canEdit?0:1)},dependencies:[ui,de,Ot,mi,he,Bt,St,pe,Ii,ji,Mi,Gt,Lt,Vi,Di,ki,Ei,vt,Oi,ke],styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return o})();var Ha=[{component:Jo,path:""},{component:Ri,path:"view"},{component:Ri,path:"view/:collateId"},{component:Ri,path:"view/:collateId/:sessionId"},{component:so,path:"edit"},{component:so,path:"edit/:collateId"}],yd=(()=>{class o{static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275mod=He({type:o})}static{this.\u0275inj=$e({imports:[ei,ko.forChild(Ha)]})}}return o})();export{yd as CollateModule};
