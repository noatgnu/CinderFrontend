import{a as od}from"./chunk-AWGZ4MKE.js";import{a as rd}from"./chunk-RPE34JJH.js";import{a as nd,b as Pp,c as ad,d as Bl,e as Qn,f as as,g as Dn,h as Pn,i as zi}from"./chunk-XL3JMYAF.js";import{a as is,b as Fi,c as Bi,d as Vi}from"./chunk-BJOT2GNF.js";import{a as Ho}from"./chunk-KGZRCUCM.js";import{a as Uo,b as $o}from"./chunk-54PGMWHQ.js";import{a as Kr}from"./chunk-MGQZ7FBO.js";import{a as id,b as rs,c as ns}from"./chunk-KLTEE2KH.js";import{a as Wo,b as Yo,c as qo,d as Xo,e as Ko,f as Zo,g as Qo,h as Jo,i as es,j as ts}from"./chunk-7PP2EWTU.js";import{a as Oi,b as zc,c as Ri,d as Gc,e as jc,f as Hc,g as Ni,h as ki}from"./chunk-OY3G2654.js";import{a as zo,b as Go,c as Jc,d as jo,e as ed,f as td}from"./chunk-AGV2HC3T.js";import{a as Vr}from"./chunk-B5VHFBDM.js";import{a as ko,c as Xc,d as Kc,e as Zc,f as Fo,g as Qc,h as Bo}from"./chunk-SMND6G6L.js";import{a as At,b as $c,c as Tn,d as Dt,e as Pt,f as Ot,g as Zr}from"./chunk-NB6WWNUD.js";import{Aa as qc,Ba as or,Ca as sr,Da as kt,Ea as Mn,Fa as Xt,Ha as lr,Ma as Ft,Na as Kt,Oa as An,Pa as Li,Q as Pr,Qa as Vo,Sa as Zt,V as ar,W as yt,X as Xr,oa as Wc,pa as Wt,ra as Fr,ta as Et,ua as Yt,va as Yc,wa as Br,xa as Sn,ya as qt,za as Ii}from"./chunk-ILDZJ3FZ.js";import{c as Uc,d as Ll,g as cn,i as Nl,j as kl,l as xa,m as Fl}from"./chunk-3CIC7QKD.js";import{h as Bc,l as Pi,p as Vc}from"./chunk-7KPORB6Q.js";import{Aa as xt,Cb as Pc,Cc as _n,D as bc,Db as Oc,Ea as Dl,Eb as Ee,Fb as En,Gb as Oo,H as To,Hb as Rc,Kb as Ue,L as xc,Lb as mr,Mb as tt,Nb as rt,Ob as U,Pb as K,Qb as Fe,Rb as Ut,Sb as $t,Ub as $e,Xb as ge,Xc as Nc,Yc as kc,Z as So,Zb as ce,Zc as Il,_ as Ei,_c as Lo,a as Lt,ac as Ro,ad as Di,b as qr,bb as Mc,bc as Rl,c as Ml,cb as Ac,cd as No,d as wa,da as Ec,db as Pl,e as Eo,ea as Al,eb as ie,ec as _i,f as _t,fa as Mo,fb as Oe,fc as Ti,gc as Si,id as Fc,ja as Ao,jb as Dc,jc as ir,kc as ae,lc as ct,mc as ot,nc as Ic,o as Cc,oc as yr,pa as _c,pc as Cr,qa as De,qc as wr,ra as Pe,rb as qe,rc as Lc,sa as Do,sb as Po,sc as Io,t as wc,ta as Tc,tb as Ol,tc as ba,va as Sc,vc as Mi,wc as Ai,x as _o,xb as ke}from"./chunk-V2ERZPMC.js";var fd=wa((Ea,zl)=>{"use strict";(function(r,e){typeof Ea=="object"&&typeof zl=="object"?zl.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ea=="object"?Ea.QRCodeStyling=e():r.QRCodeStyling=e()})(Ea,()=>(()=>{var r={873:(i,a)=>{var o,s,u=function(){var l=function(w,_){var E=w,x=p[_],C=null,T=0,M=null,D=[],F={},N=function(k,G){C=function(W){for(var te=new Array(W),X=0;X<W;X+=1){te[X]=new Array(W);for(var me=0;me<W;me+=1)te[X][me]=null}return te}(T=4*E+17),z(0,0),z(T-7,0),z(0,T-7),$(),q(),J(k,G),E>=7&&ee(k),M==null&&(M=Z(E,x,D)),j(M,G)},z=function(k,G){for(var W=-1;W<=7;W+=1)if(!(k+W<=-1||T<=k+W))for(var te=-1;te<=7;te+=1)G+te<=-1||T<=G+te||(C[k+W][G+te]=0<=W&&W<=6&&(te==0||te==6)||0<=te&&te<=6&&(W==0||W==6)||2<=W&&W<=4&&2<=te&&te<=4)},q=function(){for(var k=8;k<T-8;k+=1)C[k][6]==null&&(C[k][6]=k%2==0);for(var G=8;G<T-8;G+=1)C[6][G]==null&&(C[6][G]=G%2==0)},$=function(){for(var k=m.getPatternPosition(E),G=0;G<k.length;G+=1)for(var W=0;W<k.length;W+=1){var te=k[G],X=k[W];if(C[te][X]==null)for(var me=-2;me<=2;me+=1)for(var Te=-2;Te<=2;Te+=1)C[te+me][X+Te]=me==-2||me==2||Te==-2||Te==2||me==0&&Te==0}},ee=function(k){for(var G=m.getBCHTypeNumber(E),W=0;W<18;W+=1){var te=!k&&(G>>W&1)==1;C[Math.floor(W/3)][W%3+T-8-3]=te}for(W=0;W<18;W+=1)te=!k&&(G>>W&1)==1,C[W%3+T-8-3][Math.floor(W/3)]=te},J=function(k,G){for(var W=x<<3|G,te=m.getBCHTypeInfo(W),X=0;X<15;X+=1){var me=!k&&(te>>X&1)==1;X<6?C[X][8]=me:X<8?C[X+1][8]=me:C[T-15+X][8]=me}for(X=0;X<15;X+=1)me=!k&&(te>>X&1)==1,X<8?C[8][T-X-1]=me:X<9?C[8][15-X-1+1]=me:C[8][15-X-1]=me;C[T-8][8]=!k},j=function(k,G){for(var W=-1,te=T-1,X=7,me=0,Te=m.getMaskFunction(G),fe=T-1;fe>0;fe-=2)for(fe==6&&(fe-=1);;){for(var ue=0;ue<2;ue+=1)if(C[te][fe-ue]==null){var de=!1;me<k.length&&(de=(k[me]>>>X&1)==1),Te(te,fe-ue)&&(de=!de),C[te][fe-ue]=de,(X-=1)==-1&&(me+=1,X=7)}if((te+=W)<0||T<=te){te-=W,W=-W;break}}},Z=function(k,G,W){for(var te=b.getRSBlocks(k,G),X=S(),me=0;me<W.length;me+=1){var Te=W[me];X.put(Te.getMode(),4),X.put(Te.getLength(),m.getLengthInBits(Te.getMode(),k)),Te.write(X)}var fe=0;for(me=0;me<te.length;me+=1)fe+=te[me].dataCount;if(X.getLengthInBits()>8*fe)throw"code length overflow. ("+X.getLengthInBits()+">"+8*fe+")";for(X.getLengthInBits()+4<=8*fe&&X.put(0,4);X.getLengthInBits()%8!=0;)X.putBit(!1);for(;!(X.getLengthInBits()>=8*fe||(X.put(236,8),X.getLengthInBits()>=8*fe));)X.put(17,8);return function(ue,de){for(var ye=0,Se=0,xe=0,Ce=new Array(de.length),_e=new Array(de.length),be=0;be<de.length;be+=1){var he=de[be].dataCount,V=de[be].totalCount-he;Se=Math.max(Se,he),xe=Math.max(xe,V),Ce[be]=new Array(he);for(var re=0;re<Ce[be].length;re+=1)Ce[be][re]=255&ue.getBuffer()[re+ye];ye+=he;var le=m.getErrorCorrectPolynomial(V),Y=y(Ce[be],le.getLength()-1).mod(le);for(_e[be]=new Array(le.getLength()-1),re=0;re<_e[be].length;re+=1){var Q=re+Y.getLength()-_e[be].length;_e[be][re]=Q>=0?Y.getAt(Q):0}}var oe=0;for(re=0;re<de.length;re+=1)oe+=de[re].totalCount;var ne=new Array(oe),se=0;for(re=0;re<Se;re+=1)for(be=0;be<de.length;be+=1)re<Ce[be].length&&(ne[se]=Ce[be][re],se+=1);for(re=0;re<xe;re+=1)for(be=0;be<de.length;be+=1)re<_e[be].length&&(ne[se]=_e[be][re],se+=1);return ne}(X,te)};F.addData=function(k,G){var W=null;switch(G=G||"Byte"){case"Numeric":W=A(k);break;case"Alphanumeric":W=P(k);break;case"Byte":W=O(k);break;case"Kanji":W=I(k);break;default:throw"mode:"+G}D.push(W),M=null},F.isDark=function(k,G){if(k<0||T<=k||G<0||T<=G)throw k+","+G;return C[k][G]},F.getModuleCount=function(){return T},F.make=function(){if(E<1){for(var k=1;k<40;k++){for(var G=b.getRSBlocks(k,x),W=S(),te=0;te<D.length;te++){var X=D[te];W.put(X.getMode(),4),W.put(X.getLength(),m.getLengthInBits(X.getMode(),k)),X.write(W)}var me=0;for(te=0;te<G.length;te++)me+=G[te].dataCount;if(W.getLengthInBits()<=8*me)break}E=k}N(!1,function(){for(var Te=0,fe=0,ue=0;ue<8;ue+=1){N(!0,ue);var de=m.getLostPoint(F);(ue==0||Te>de)&&(Te=de,fe=ue)}return fe}())},F.createTableTag=function(k,G){k=k||2;var W="";W+='<table style="',W+=" border-width: 0px; border-style: none;",W+=" border-collapse: collapse;",W+=" padding: 0px; margin: "+(G=G===void 0?4*k:G)+"px;",W+='">',W+="<tbody>";for(var te=0;te<F.getModuleCount();te+=1){W+="<tr>";for(var X=0;X<F.getModuleCount();X+=1)W+='<td style="',W+=" border-width: 0px; border-style: none;",W+=" border-collapse: collapse;",W+=" padding: 0px; margin: 0px;",W+=" width: "+k+"px;",W+=" height: "+k+"px;",W+=" background-color: ",W+=F.isDark(te,X)?"#000000":"#ffffff",W+=";",W+='"/>';W+="</tr>"}return(W+="</tbody>")+"</table>"},F.createSvgTag=function(k,G,W,te){var X={};typeof arguments[0]=="object"&&(k=(X=arguments[0]).cellSize,G=X.margin,W=X.alt,te=X.title),k=k||2,G=G===void 0?4*k:G,(W=typeof W=="string"?{text:W}:W||{}).text=W.text||null,W.id=W.text?W.id||"qrcode-description":null,(te=typeof te=="string"?{text:te}:te||{}).text=te.text||null,te.id=te.text?te.id||"qrcode-title":null;var me,Te,fe,ue,de=F.getModuleCount()*k+2*G,ye="";for(ue="l"+k+",0 0,"+k+" -"+k+",0 0,-"+k+"z ",ye+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',ye+=X.scalable?"":' width="'+de+'px" height="'+de+'px"',ye+=' viewBox="0 0 '+de+" "+de+'" ',ye+=' preserveAspectRatio="xMinYMin meet"',ye+=te.text||W.text?' role="img" aria-labelledby="'+H([te.id,W.id].join(" ").trim())+'"':"",ye+=">",ye+=te.text?'<title id="'+H(te.id)+'">'+H(te.text)+"</title>":"",ye+=W.text?'<description id="'+H(W.id)+'">'+H(W.text)+"</description>":"",ye+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',ye+='<path d="',Te=0;Te<F.getModuleCount();Te+=1)for(fe=Te*k+G,me=0;me<F.getModuleCount();me+=1)F.isDark(Te,me)&&(ye+="M"+(me*k+G)+","+fe+ue);return(ye+='" stroke="transparent" fill="black"/>')+"</svg>"},F.createDataURL=function(k,G){k=k||2,G=G===void 0?4*k:G;var W=F.getModuleCount()*k+2*G,te=G,X=W-G;return B(W,W,function(me,Te){if(te<=me&&me<X&&te<=Te&&Te<X){var fe=Math.floor((me-te)/k),ue=Math.floor((Te-te)/k);return F.isDark(ue,fe)?0:1}return 1})},F.createImgTag=function(k,G,W){k=k||2,G=G===void 0?4*k:G;var te=F.getModuleCount()*k+2*G,X="";return X+="<img",X+=' src="',X+=F.createDataURL(k,G),X+='"',X+=' width="',X+=te,X+='"',X+=' height="',X+=te,X+='"',W&&(X+=' alt="',X+=H(W),X+='"'),X+"/>"};var H=function(k){for(var G="",W=0;W<k.length;W+=1){var te=k.charAt(W);switch(te){case"<":G+="&lt;";break;case">":G+="&gt;";break;case"&":G+="&amp;";break;case'"':G+="&quot;";break;default:G+=te}}return G};return F.createASCII=function(k,G){if((k=k||1)<2)return function(Ce){Ce=Ce===void 0?2:Ce;var _e,be,he,V,re,le=1*F.getModuleCount()+2*Ce,Y=Ce,Q=le-Ce,oe={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},ne={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},se="";for(_e=0;_e<le;_e+=2){for(he=Math.floor((_e-Y)/1),V=Math.floor((_e+1-Y)/1),be=0;be<le;be+=1)re="\u2588",Y<=be&&be<Q&&Y<=_e&&_e<Q&&F.isDark(he,Math.floor((be-Y)/1))&&(re=" "),Y<=be&&be<Q&&Y<=_e+1&&_e+1<Q&&F.isDark(V,Math.floor((be-Y)/1))?re+=" ":re+="\u2588",se+=Ce<1&&_e+1>=Q?ne[re]:oe[re];se+=`
`}return le%2&&Ce>0?se.substring(0,se.length-le-1)+Array(le+1).join("\u2580"):se.substring(0,se.length-1)}(G);k-=1,G=G===void 0?2*k:G;var W,te,X,me,Te=F.getModuleCount()*k+2*G,fe=G,ue=Te-G,de=Array(k+1).join("\u2588\u2588"),ye=Array(k+1).join("  "),Se="",xe="";for(W=0;W<Te;W+=1){for(X=Math.floor((W-fe)/k),xe="",te=0;te<Te;te+=1)me=1,fe<=te&&te<ue&&fe<=W&&W<ue&&F.isDark(X,Math.floor((te-fe)/k))&&(me=0),xe+=me?de:ye;for(X=0;X<k;X+=1)Se+=xe+`
`}return Se.substring(0,Se.length-1)},F.renderTo2dContext=function(k,G){G=G||2;for(var W=F.getModuleCount(),te=0;te<W;te++)for(var X=0;X<W;X++)k.fillStyle=F.isDark(te,X)?"black":"white",k.fillRect(te*G,X*G,G,G)},F};l.stringToBytes=(l.stringToBytesFuncs={default:function(w){for(var _=[],E=0;E<w.length;E+=1){var x=w.charCodeAt(E);_.push(255&x)}return _}}).default,l.createStringToBytes=function(w,_){var E=function(){for(var C=L(w),T=function(){var q=C.read();if(q==-1)throw"eof";return q},M=0,D={};;){var F=C.read();if(F==-1)break;var N=T(),z=T()<<8|T();D[String.fromCharCode(F<<8|N)]=z,M+=1}if(M!=_)throw M+" != "+_;return D}(),x=63;return function(C){for(var T=[],M=0;M<C.length;M+=1){var D=C.charCodeAt(M);if(D<128)T.push(D);else{var F=E[C.charAt(M)];typeof F=="number"?(255&F)==F?T.push(F):(T.push(F>>>8),T.push(255&F)):T.push(x)}}return T}};var c,d,h,f,v,p={L:1,M:0,Q:3,H:2},m=(c=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d=1335,h=7973,v=function(w){for(var _=0;w!=0;)_+=1,w>>>=1;return _},(f={}).getBCHTypeInfo=function(w){for(var _=w<<10;v(_)-v(d)>=0;)_^=d<<v(_)-v(d);return 21522^(w<<10|_)},f.getBCHTypeNumber=function(w){for(var _=w<<12;v(_)-v(h)>=0;)_^=h<<v(_)-v(h);return w<<12|_},f.getPatternPosition=function(w){return c[w-1]},f.getMaskFunction=function(w){switch(w){case 0:return function(_,E){return(_+E)%2==0};case 1:return function(_,E){return _%2==0};case 2:return function(_,E){return E%3==0};case 3:return function(_,E){return(_+E)%3==0};case 4:return function(_,E){return(Math.floor(_/2)+Math.floor(E/3))%2==0};case 5:return function(_,E){return _*E%2+_*E%3==0};case 6:return function(_,E){return(_*E%2+_*E%3)%2==0};case 7:return function(_,E){return(_*E%3+(_+E)%2)%2==0};default:throw"bad maskPattern:"+w}},f.getErrorCorrectPolynomial=function(w){for(var _=y([1],0),E=0;E<w;E+=1)_=_.multiply(y([1,g.gexp(E)],0));return _},f.getLengthInBits=function(w,_){if(1<=_&&_<10)switch(w){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+w}else if(_<27)switch(w){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+w}else{if(!(_<41))throw"type:"+_;switch(w){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+w}}},f.getLostPoint=function(w){for(var _=w.getModuleCount(),E=0,x=0;x<_;x+=1)for(var C=0;C<_;C+=1){for(var T=0,M=w.isDark(x,C),D=-1;D<=1;D+=1)if(!(x+D<0||_<=x+D))for(var F=-1;F<=1;F+=1)C+F<0||_<=C+F||D==0&&F==0||M==w.isDark(x+D,C+F)&&(T+=1);T>5&&(E+=3+T-5)}for(x=0;x<_-1;x+=1)for(C=0;C<_-1;C+=1){var N=0;w.isDark(x,C)&&(N+=1),w.isDark(x+1,C)&&(N+=1),w.isDark(x,C+1)&&(N+=1),w.isDark(x+1,C+1)&&(N+=1),N!=0&&N!=4||(E+=3)}for(x=0;x<_;x+=1)for(C=0;C<_-6;C+=1)w.isDark(x,C)&&!w.isDark(x,C+1)&&w.isDark(x,C+2)&&w.isDark(x,C+3)&&w.isDark(x,C+4)&&!w.isDark(x,C+5)&&w.isDark(x,C+6)&&(E+=40);for(C=0;C<_;C+=1)for(x=0;x<_-6;x+=1)w.isDark(x,C)&&!w.isDark(x+1,C)&&w.isDark(x+2,C)&&w.isDark(x+3,C)&&w.isDark(x+4,C)&&!w.isDark(x+5,C)&&w.isDark(x+6,C)&&(E+=40);var z=0;for(C=0;C<_;C+=1)for(x=0;x<_;x+=1)w.isDark(x,C)&&(z+=1);return E+Math.abs(100*z/_/_-50)/5*10},f),g=function(){for(var w=new Array(256),_=new Array(256),E=0;E<8;E+=1)w[E]=1<<E;for(E=8;E<256;E+=1)w[E]=w[E-4]^w[E-5]^w[E-6]^w[E-8];for(E=0;E<255;E+=1)_[w[E]]=E;return{glog:function(x){if(x<1)throw"glog("+x+")";return _[x]},gexp:function(x){for(;x<0;)x+=255;for(;x>=256;)x-=255;return w[x]}}}();function y(w,_){if(w.length===void 0)throw w.length+"/"+_;var E=function(){for(var C=0;C<w.length&&w[C]==0;)C+=1;for(var T=new Array(w.length-C+_),M=0;M<w.length-C;M+=1)T[M]=w[M+C];return T}(),x={getAt:function(C){return E[C]},getLength:function(){return E.length},multiply:function(C){for(var T=new Array(x.getLength()+C.getLength()-1),M=0;M<x.getLength();M+=1)for(var D=0;D<C.getLength();D+=1)T[M+D]^=g.gexp(g.glog(x.getAt(M))+g.glog(C.getAt(D)));return y(T,0)},mod:function(C){if(x.getLength()-C.getLength()<0)return x;for(var T=g.glog(x.getAt(0))-g.glog(C.getAt(0)),M=new Array(x.getLength()),D=0;D<x.getLength();D+=1)M[D]=x.getAt(D);for(D=0;D<C.getLength();D+=1)M[D]^=g.gexp(g.glog(C.getAt(D))+T);return y(M,0).mod(C)}};return x}var b=function(){var w=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],_=function(x,C){var T={};return T.totalCount=x,T.dataCount=C,T},E={getRSBlocks:function(x,C){var T=function(ee,J){switch(J){case p.L:return w[4*(ee-1)+0];case p.M:return w[4*(ee-1)+1];case p.Q:return w[4*(ee-1)+2];case p.H:return w[4*(ee-1)+3];default:return}}(x,C);if(T===void 0)throw"bad rs block @ typeNumber:"+x+"/errorCorrectionLevel:"+C;for(var M=T.length/3,D=[],F=0;F<M;F+=1)for(var N=T[3*F+0],z=T[3*F+1],q=T[3*F+2],$=0;$<N;$+=1)D.push(_(z,q));return D}};return E}(),S=function(){var w=[],_=0,E={getBuffer:function(){return w},getAt:function(x){var C=Math.floor(x/8);return(w[C]>>>7-x%8&1)==1},put:function(x,C){for(var T=0;T<C;T+=1)E.putBit((x>>>C-T-1&1)==1)},getLengthInBits:function(){return _},putBit:function(x){var C=Math.floor(_/8);w.length<=C&&w.push(0),x&&(w[C]|=128>>>_%8),_+=1}};return E},A=function(w){var _=w,E={getMode:function(){return 1},getLength:function(T){return _.length},write:function(T){for(var M=_,D=0;D+2<M.length;)T.put(x(M.substring(D,D+3)),10),D+=3;D<M.length&&(M.length-D==1?T.put(x(M.substring(D,D+1)),4):M.length-D==2&&T.put(x(M.substring(D,D+2)),7))}},x=function(T){for(var M=0,D=0;D<T.length;D+=1)M=10*M+C(T.charAt(D));return M},C=function(T){if("0"<=T&&T<="9")return T.charCodeAt(0)-48;throw"illegal char :"+T};return E},P=function(w){var _=w,E={getMode:function(){return 2},getLength:function(C){return _.length},write:function(C){for(var T=_,M=0;M+1<T.length;)C.put(45*x(T.charAt(M))+x(T.charAt(M+1)),11),M+=2;M<T.length&&C.put(x(T.charAt(M)),6)}},x=function(C){if("0"<=C&&C<="9")return C.charCodeAt(0)-48;if("A"<=C&&C<="Z")return C.charCodeAt(0)-65+10;switch(C){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+C}};return E},O=function(w){var _=l.stringToBytes(w);return{getMode:function(){return 4},getLength:function(E){return _.length},write:function(E){for(var x=0;x<_.length;x+=1)E.put(_[x],8)}}},I=function(w){var _=l.stringToBytesFuncs.SJIS;if(!_)throw"sjis not supported.";(function(){var C=_("\u53CB");if(C.length!=2||(C[0]<<8|C[1])!=38726)throw"sjis not supported."})();var E=_(w),x={getMode:function(){return 8},getLength:function(C){return~~(E.length/2)},write:function(C){for(var T=E,M=0;M+1<T.length;){var D=(255&T[M])<<8|255&T[M+1];if(33088<=D&&D<=40956)D-=33088;else{if(!(57408<=D&&D<=60351))throw"illegal char at "+(M+1)+"/"+D;D-=49472}D=192*(D>>>8&255)+(255&D),C.put(D,13),M+=2}if(M<T.length)throw"illegal char at "+(M+1)}};return x},R=function(){var w=[],_={writeByte:function(E){w.push(255&E)},writeShort:function(E){_.writeByte(E),_.writeByte(E>>>8)},writeBytes:function(E,x,C){x=x||0,C=C||E.length;for(var T=0;T<C;T+=1)_.writeByte(E[T+x])},writeString:function(E){for(var x=0;x<E.length;x+=1)_.writeByte(E.charCodeAt(x))},toByteArray:function(){return w},toString:function(){var E="";E+="[";for(var x=0;x<w.length;x+=1)x>0&&(E+=","),E+=w[x];return E+"]"}};return _},L=function(w){var _=w,E=0,x=0,C=0,T={read:function(){for(;C<8;){if(E>=_.length){if(C==0)return-1;throw"unexpected end of file./"+C}var D=_.charAt(E);if(E+=1,D=="=")return C=0,-1;D.match(/^\s$/)||(x=x<<6|M(D.charCodeAt(0)),C+=6)}var F=x>>>C-8&255;return C-=8,F}},M=function(D){if(65<=D&&D<=90)return D-65;if(97<=D&&D<=122)return D-97+26;if(48<=D&&D<=57)return D-48+52;if(D==43)return 62;if(D==47)return 63;throw"c:"+D};return T},B=function(w,_,E){for(var x=function(z,q){var $=z,ee=q,J=new Array(z*q),j={setPixel:function(k,G,W){J[G*$+k]=W},write:function(k){k.writeString("GIF87a"),k.writeShort($),k.writeShort(ee),k.writeByte(128),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(0),k.writeByte(255),k.writeByte(255),k.writeByte(255),k.writeString(","),k.writeShort(0),k.writeShort(0),k.writeShort($),k.writeShort(ee),k.writeByte(0);var G=Z(2);k.writeByte(2);for(var W=0;G.length-W>255;)k.writeByte(255),k.writeBytes(G,W,255),W+=255;k.writeByte(G.length-W),k.writeBytes(G,W,G.length-W),k.writeByte(0),k.writeString(";")}},Z=function(k){for(var G=1<<k,W=1+(1<<k),te=k+1,X=H(),me=0;me<G;me+=1)X.add(String.fromCharCode(me));X.add(String.fromCharCode(G)),X.add(String.fromCharCode(W));var Te,fe,ue,de=R(),ye=(Te=de,fe=0,ue=0,{write:function(_e,be){if(_e>>>be)throw"length over";for(;fe+be>=8;)Te.writeByte(255&(_e<<fe|ue)),be-=8-fe,_e>>>=8-fe,ue=0,fe=0;ue|=_e<<fe,fe+=be},flush:function(){fe>0&&Te.writeByte(ue)}});ye.write(G,te);var Se=0,xe=String.fromCharCode(J[Se]);for(Se+=1;Se<J.length;){var Ce=String.fromCharCode(J[Se]);Se+=1,X.contains(xe+Ce)?xe+=Ce:(ye.write(X.indexOf(xe),te),X.size()<4095&&(X.size()==1<<te&&(te+=1),X.add(xe+Ce)),xe=Ce)}return ye.write(X.indexOf(xe),te),ye.write(W,te),ye.flush(),de.toByteArray()},H=function(){var k={},G=0,W={add:function(te){if(W.contains(te))throw"dup key:"+te;k[te]=G,G+=1},size:function(){return G},indexOf:function(te){return k[te]},contains:function(te){return k[te]!==void 0}};return W};return j}(w,_),C=0;C<_;C+=1)for(var T=0;T<w;T+=1)x.setPixel(T,C,E(T,C));var M=R();x.write(M);for(var D=function(){var z=0,q=0,$=0,ee="",J={},j=function(H){ee+=String.fromCharCode(Z(63&H))},Z=function(H){if(!(H<0)){if(H<26)return 65+H;if(H<52)return H-26+97;if(H<62)return H-52+48;if(H==62)return 43;if(H==63)return 47}throw"n:"+H};return J.writeByte=function(H){for(z=z<<8|255&H,q+=8,$+=1;q>=6;)j(z>>>q-6),q-=6},J.flush=function(){if(q>0&&(j(z<<6-q),z=0,q=0),$%3!=0)for(var H=3-$%3,k=0;k<H;k+=1)ee+="="},J.toString=function(){return ee},J}(),F=M.toByteArray(),N=0;N<F.length;N+=1)D.writeByte(F[N]);return D.flush(),"data:image/gif;base64,"+D};return l}();u.stringToBytesFuncs["UTF-8"]=function(l){return function(c){for(var d=[],h=0;h<c.length;h++){var f=c.charCodeAt(h);f<128?d.push(f):f<2048?d.push(192|f>>6,128|63&f):f<55296||f>=57344?d.push(224|f>>12,128|f>>6&63,128|63&f):(h++,f=65536+((1023&f)<<10|1023&c.charCodeAt(h)),d.push(240|f>>18,128|f>>12&63,128|f>>6&63,128|63&f))}return d}(l)},(s=typeof(o=function(){return u})=="function"?o.apply(a,[]):o)===void 0||(i.exports=s)}},e={};function t(i){var a=e[i];if(a!==void 0)return a.exports;var o=e[i]={exports:{}};return r[i](o,o.exports,t),o.exports}t.n=i=>{var a=i&&i.__esModule?()=>i.default:()=>i;return t.d(a,{a}),a},t.d=(i,a)=>{for(var o in a)t.o(a,o)&&!t.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:a[o]})},t.o=(i,a)=>Object.prototype.hasOwnProperty.call(i,a);var n={};return(()=>{"use strict";t.d(n,{default:()=>_});let i=E=>!!E&&typeof E=="object"&&!Array.isArray(E);function a(E,...x){if(!x.length)return E;let C=x.shift();return C!==void 0&&i(E)&&i(C)?(E=Object.assign({},E),Object.keys(C).forEach(T=>{let M=E[T],D=C[T];Array.isArray(M)&&Array.isArray(D)?E[T]=D:i(M)&&i(D)?E[T]=a(Object.assign({},M),D):E[T]=D}),a(E,...x)):E}function o(E,x){let C=document.createElement("a");C.download=x,C.href=E,document.body.appendChild(C),C.click(),document.body.removeChild(C)}let s={L:.07,M:.15,Q:.25,H:.3};class u{constructor({svg:x,type:C,window:T}){this._svg=x,this._type=C,this._window=T}draw(x,C,T,M){let D;switch(this._type){case"dots":D=this._drawDot;break;case"classy":D=this._drawClassy;break;case"classy-rounded":D=this._drawClassyRounded;break;case"rounded":D=this._drawRounded;break;case"extra-rounded":D=this._drawExtraRounded;break;default:D=this._drawSquare}D.call(this,{x,y:C,size:T,getNeighbor:M})}_rotateFigure({x,y:C,size:T,rotation:M=0,draw:D}){var F;let N=x+T/2,z=C+T/2;D(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(T+C/2)),this._element.setAttribute("cy",String(M+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(T)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_basicSideRounded(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${T} ${M}v ${C}h `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, 0 ${-C}`)}}))}_basicCornerRounded(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${T} ${M}v ${C}h ${C}v `+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_basicCornerExtraRounded(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${T} ${M}v ${C}h ${C}a ${C} ${C}, 0, 0, 0, ${-C} ${-C}`)}}))}_basicCornersRounded(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${T} ${M}v `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${C/2} ${C/2}h `+C/2+"v "+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_drawDot({x,y:C,size:T}){this._basicDot({x,y:C,size:T,rotation:0})}_drawSquare({x,y:C,size:T}){this._basicSquare({x,y:C,size:T,rotation:0})}_drawRounded({x,y:C,size:T,getNeighbor:M}){let D=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0,q=D+F+N+z;if(q!==0)if(q>2||D&&F||N&&z)this._basicSquare({x,y:C,size:T,rotation:0});else{if(q===2){let $=0;return D&&N?$=Math.PI/2:N&&F?$=Math.PI:F&&z&&($=-Math.PI/2),void this._basicCornerRounded({x,y:C,size:T,rotation:$})}if(q===1){let $=0;return N?$=Math.PI/2:F?$=Math.PI:z&&($=-Math.PI/2),void this._basicSideRounded({x,y:C,size:T,rotation:$})}}else this._basicDot({x,y:C,size:T,rotation:0})}_drawExtraRounded({x,y:C,size:T,getNeighbor:M}){let D=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0,q=D+F+N+z;if(q!==0)if(q>2||D&&F||N&&z)this._basicSquare({x,y:C,size:T,rotation:0});else{if(q===2){let $=0;return D&&N?$=Math.PI/2:N&&F?$=Math.PI:F&&z&&($=-Math.PI/2),void this._basicCornerExtraRounded({x,y:C,size:T,rotation:$})}if(q===1){let $=0;return N?$=Math.PI/2:F?$=Math.PI:z&&($=-Math.PI/2),void this._basicSideRounded({x,y:C,size:T,rotation:$})}}else this._basicDot({x,y:C,size:T,rotation:0})}_drawClassy({x,y:C,size:T,getNeighbor:M}){let D=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0;D+F+N+z!==0?D||N?F||z?this._basicSquare({x,y:C,size:T,rotation:0}):this._basicCornerRounded({x,y:C,size:T,rotation:Math.PI/2}):this._basicCornerRounded({x,y:C,size:T,rotation:-Math.PI/2}):this._basicCornersRounded({x,y:C,size:T,rotation:Math.PI/2})}_drawClassyRounded({x,y:C,size:T,getNeighbor:M}){let D=M?+M(-1,0):0,F=M?+M(1,0):0,N=M?+M(0,-1):0,z=M?+M(0,1):0;D+F+N+z!==0?D||N?F||z?this._basicSquare({x,y:C,size:T,rotation:0}):this._basicCornerExtraRounded({x,y:C,size:T,rotation:Math.PI/2}):this._basicCornerExtraRounded({x,y:C,size:T,rotation:-Math.PI/2}):this._basicCornersRounded({x,y:C,size:T,rotation:Math.PI/2})}}let l={dot:"dot",square:"square",extraRounded:"extra-rounded"},c=Object.values(l);class d{constructor({svg:x,type:C,window:T}){this._svg=x,this._type=C,this._window=T}draw(x,C,T,M){let D;switch(this._type){case l.square:D=this._drawSquare;break;case l.extraRounded:D=this._drawExtraRounded;break;default:D=this._drawDot}D.call(this,{x,y:C,size:T,rotation:M})}_rotateFigure({x,y:C,size:T,rotation:M=0,draw:D}){var F;let N=x+T/2,z=C+T/2;D(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(x){let{size:C,x:T,y:M}=x,D=C/7;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${T+C/2} ${M}a ${C/2} ${C/2} 0 1 0 0.1 0zm 0 ${D}a ${C/2-D} ${C/2-D} 0 1 1 -0.1 0Z`)}}))}_basicSquare(x){let{size:C,x:T,y:M}=x,D=C/7;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${T} ${M}v ${C}h ${C}v `+-C+`zM ${T+D} ${M+D}h `+(C-2*D)+"v "+(C-2*D)+"h "+(2*D-C)+"z")}}))}_basicExtraRounded(x){let{size:C,x:T,y:M}=x,D=C/7;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${T} ${M+2.5*D}v `+2*D+`a ${2.5*D} ${2.5*D}, 0, 0, 0, ${2.5*D} ${2.5*D}h `+2*D+`a ${2.5*D} ${2.5*D}, 0, 0, 0, ${2.5*D} ${2.5*-D}v `+-2*D+`a ${2.5*D} ${2.5*D}, 0, 0, 0, ${2.5*-D} ${2.5*-D}h `+-2*D+`a ${2.5*D} ${2.5*D}, 0, 0, 0, ${2.5*-D} ${2.5*D}M ${T+2.5*D} ${M+D}h `+2*D+`a ${1.5*D} ${1.5*D}, 0, 0, 1, ${1.5*D} ${1.5*D}v `+2*D+`a ${1.5*D} ${1.5*D}, 0, 0, 1, ${1.5*-D} ${1.5*D}h `+-2*D+`a ${1.5*D} ${1.5*D}, 0, 0, 1, ${1.5*-D} ${1.5*-D}v `+-2*D+`a ${1.5*D} ${1.5*D}, 0, 0, 1, ${1.5*D} ${1.5*-D}`)}}))}_drawDot({x,y:C,size:T,rotation:M}){this._basicDot({x,y:C,size:T,rotation:M})}_drawSquare({x,y:C,size:T,rotation:M}){this._basicSquare({x,y:C,size:T,rotation:M})}_drawExtraRounded({x,y:C,size:T,rotation:M}){this._basicExtraRounded({x,y:C,size:T,rotation:M})}}let h={dot:"dot",square:"square"},f=Object.values(h);class v{constructor({svg:x,type:C,window:T}){this._svg=x,this._type=C,this._window=T}draw(x,C,T,M){let D;D=this._type===h.square?this._drawSquare:this._drawDot,D.call(this,{x,y:C,size:T,rotation:M})}_rotateFigure({x,y:C,size:T,rotation:M=0,draw:D}){var F;let N=x+T/2,z=C+T/2;D(),(F=this._element)===null||F===void 0||F.setAttribute("transform",`rotate(${180*M/Math.PI},${N},${z})`)}_basicDot(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(T+C/2)),this._element.setAttribute("cy",String(M+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(x){let{size:C,x:T,y:M}=x;this._rotateFigure(Object.assign(Object.assign({},x),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(T)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_drawDot({x,y:C,size:T,rotation:M}){this._basicDot({x,y:C,size:T,rotation:M})}_drawSquare({x,y:C,size:T,rotation:M}){this._basicSquare({x,y:C,size:T,rotation:M})}}let p="circle",m=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],g=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],b=(()=>{class E{constructor(C,T){this._roundSize=M=>this._options.dotsOptions.roundSize?Math.floor(M):M,this._window=T,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(C.width)),this._element.setAttribute("height",String(C.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),C.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${C.width} ${C.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=C.image,this._instanceId=E.instanceCount++,this._options=C}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}drawQR(C){return _t(this,null,function*(){let T=C.getModuleCount(),M=Math.min(this._options.width,this._options.height)-2*this._options.margin,D=this._options.shape===p?M/Math.sqrt(2):M,F=this._roundSize(D/T),N={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=C,this._options.image){if(yield this.loadImage(),!this._image)return;let{imageOptions:z,qrOptions:q}=this._options,$=z.imageSize*s[q.errorCorrectionLevel],ee=Math.floor($*T*T);N=function({originalHeight:J,originalWidth:j,maxHiddenDots:Z,maxHiddenAxisDots:H,dotSize:k}){let G={x:0,y:0},W={x:0,y:0};if(J<=0||j<=0||Z<=0||k<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};let te=J/j;return G.x=Math.floor(Math.sqrt(Z/te)),G.x<=0&&(G.x=1),H&&H<G.x&&(G.x=H),G.x%2==0&&G.x--,W.x=G.x*k,G.y=1+2*Math.ceil((G.x*te-1)/2),W.y=Math.round(W.x*te),(G.y*G.x>Z||H&&H<G.y)&&(H&&H<G.y?(G.y=H,G.y%2==0&&G.x--):G.y-=2,W.y=G.y*k,G.x=1+2*Math.ceil((G.y/te-1)/2),W.x=Math.round(W.y/te)),{height:W.y,width:W.x,hideYDots:G.y,hideXDots:G.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:ee,maxHiddenAxisDots:T-14,dotSize:F})}this.drawBackground(),this.drawDots((z,q)=>{var $,ee,J,j,Z,H;return!(this._options.imageOptions.hideBackgroundDots&&z>=(T-N.hideYDots)/2&&z<(T+N.hideYDots)/2&&q>=(T-N.hideXDots)/2&&q<(T+N.hideXDots)/2||!(($=m[z])===null||$===void 0)&&$[q]||!((ee=m[z-T+7])===null||ee===void 0)&&ee[q]||!((J=m[z])===null||J===void 0)&&J[q-T+7]||!((j=g[z])===null||j===void 0)&&j[q]||!((Z=g[z-T+7])===null||Z===void 0)&&Z[q]||!((H=g[z])===null||H===void 0)&&H[q-T+7])}),this.drawCorners(),this._options.image&&(yield this.drawImage({width:N.width,height:N.height,count:T,dotSize:F}))})}drawBackground(){var C,T,M;let D=this._element,F=this._options;if(D){let N=(C=F.backgroundOptions)===null||C===void 0?void 0:C.gradient,z=(T=F.backgroundOptions)===null||T===void 0?void 0:T.color,q=F.height,$=F.width;if(N||z){let ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((M=F.backgroundOptions)===null||M===void 0)&&M.round&&(q=$=Math.min(F.width,F.height),ee.setAttribute("rx",String(q/2*F.backgroundOptions.round))),ee.setAttribute("x",String(this._roundSize((F.width-$)/2))),ee.setAttribute("y",String(this._roundSize((F.height-q)/2))),ee.setAttribute("width",String($)),ee.setAttribute("height",String(q)),this._backgroundClipPath.appendChild(ee),this._createColor({options:N,color:z,additionalRotation:0,x:0,y:0,height:F.height,width:F.width,name:`background-color-${this._instanceId}`})}}}drawDots(C){var T,M;if(!this._qr)throw"QR code is not defined";let D=this._options,F=this._qr.getModuleCount();if(F>D.width||F>D.height)throw"The canvas is too small.";let N=Math.min(D.width,D.height)-2*D.margin,z=D.shape===p?N/Math.sqrt(2):N,q=this._roundSize(z/F),$=this._roundSize((D.width-F*q)/2),ee=this._roundSize((D.height-F*q)/2),J=new u({svg:this._element,type:D.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(T=D.dotsOptions)===null||T===void 0?void 0:T.gradient,color:D.dotsOptions.color,additionalRotation:0,x:0,y:0,height:D.height,width:D.width,name:`dot-color-${this._instanceId}`});for(let j=0;j<F;j++)for(let Z=0;Z<F;Z++)C&&!C(j,Z)||!((M=this._qr)===null||M===void 0)&&M.isDark(j,Z)&&(J.draw($+Z*q,ee+j*q,q,(H,k)=>!(Z+H<0||j+k<0||Z+H>=F||j+k>=F)&&!(C&&!C(j+k,Z+H))&&!!this._qr&&this._qr.isDark(j+k,Z+H)),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element));if(D.shape===p){let j=this._roundSize((N/q-F)/2),Z=F+2*j,H=$-j*q,k=ee-j*q,G=[],W=this._roundSize(Z/2);for(let te=0;te<Z;te++){G[te]=[];for(let X=0;X<Z;X++)te>=j-1&&te<=Z-j&&X>=j-1&&X<=Z-j||Math.sqrt((te-W)*(te-W)+(X-W)*(X-W))>W?G[te][X]=0:G[te][X]=this._qr.isDark(X-2*j<0?X:X>=F?X-2*j:X-j,te-2*j<0?te:te>=F?te-2*j:te-j)?1:0}for(let te=0;te<Z;te++)for(let X=0;X<Z;X++)G[te][X]&&(J.draw(H+X*q,k+te*q,q,(me,Te)=>{var fe;return!!(!((fe=G[te+Te])===null||fe===void 0)&&fe[X+me])}),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";let C=this._element,T=this._options;if(!C)throw"Element code is not defined";let M=this._qr.getModuleCount(),D=Math.min(T.width,T.height)-2*T.margin,F=T.shape===p?D/Math.sqrt(2):D,N=this._roundSize(F/M),z=7*N,q=3*N,$=this._roundSize((T.width-M*N)/2),ee=this._roundSize((T.height-M*N)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([J,j,Z])=>{var H,k,G,W,te,X,me,Te,fe,ue,de,ye,Se,xe;let Ce=$+J*N*(M-7),_e=ee+j*N*(M-7),be=this._dotsClipPath,he=this._dotsClipPath;if((!((H=T.cornersSquareOptions)===null||H===void 0)&&H.gradient||!((k=T.cornersSquareOptions)===null||k===void 0)&&k.color)&&(be=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),be.setAttribute("id",`clip-path-corners-square-color-${J}-${j}-${this._instanceId}`),this._defs.appendChild(be),this._cornersSquareClipPath=this._cornersDotClipPath=he=be,this._createColor({options:(G=T.cornersSquareOptions)===null||G===void 0?void 0:G.gradient,color:(W=T.cornersSquareOptions)===null||W===void 0?void 0:W.color,additionalRotation:Z,x:Ce,y:_e,height:z,width:z,name:`corners-square-color-${J}-${j}-${this._instanceId}`})),((te=T.cornersSquareOptions)===null||te===void 0?void 0:te.type)&&c.includes(T.cornersSquareOptions.type)){let V=new d({svg:this._element,type:T.cornersSquareOptions.type,window:this._window});V.draw(Ce,_e,z,Z),V._element&&be&&be.appendChild(V._element)}else{let V=new u({svg:this._element,type:((X=T.cornersSquareOptions)===null||X===void 0?void 0:X.type)||T.dotsOptions.type,window:this._window});for(let re=0;re<m.length;re++)for(let le=0;le<m[re].length;le++)!((me=m[re])===null||me===void 0)&&me[le]&&(V.draw(Ce+le*N,_e+re*N,N,(Y,Q)=>{var oe;return!!(!((oe=m[re+Q])===null||oe===void 0)&&oe[le+Y])}),V._element&&be&&be.appendChild(V._element))}if((!((Te=T.cornersDotOptions)===null||Te===void 0)&&Te.gradient||!((fe=T.cornersDotOptions)===null||fe===void 0)&&fe.color)&&(he=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),he.setAttribute("id",`clip-path-corners-dot-color-${J}-${j}-${this._instanceId}`),this._defs.appendChild(he),this._cornersDotClipPath=he,this._createColor({options:(ue=T.cornersDotOptions)===null||ue===void 0?void 0:ue.gradient,color:(de=T.cornersDotOptions)===null||de===void 0?void 0:de.color,additionalRotation:Z,x:Ce+2*N,y:_e+2*N,height:q,width:q,name:`corners-dot-color-${J}-${j}-${this._instanceId}`})),((ye=T.cornersDotOptions)===null||ye===void 0?void 0:ye.type)&&f.includes(T.cornersDotOptions.type)){let V=new v({svg:this._element,type:T.cornersDotOptions.type,window:this._window});V.draw(Ce+2*N,_e+2*N,q,Z),V._element&&he&&he.appendChild(V._element)}else{let V=new u({svg:this._element,type:((Se=T.cornersDotOptions)===null||Se===void 0?void 0:Se.type)||T.dotsOptions.type,window:this._window});for(let re=0;re<g.length;re++)for(let le=0;le<g[re].length;le++)!((xe=g[re])===null||xe===void 0)&&xe[le]&&(V.draw(Ce+le*N,_e+re*N,N,(Y,Q)=>{var oe;return!!(!((oe=g[re+Q])===null||oe===void 0)&&oe[le+Y])}),V._element&&he&&he.appendChild(V._element))}})}loadImage(){return new Promise((C,T)=>{var M;let D=this._options;if(!D.image)return T("Image is not defined");if(!((M=D.nodeCanvas)===null||M===void 0)&&M.loadImage)D.nodeCanvas.loadImage(D.image).then(F=>{var N,z;if(this._image=F,this._options.imageOptions.saveAsBlob){let q=(N=D.nodeCanvas)===null||N===void 0?void 0:N.createCanvas(this._image.width,this._image.height);(z=q?.getContext("2d"))===null||z===void 0||z.drawImage(F,0,0),this._imageUri=q?.toDataURL()}C()}).catch(T);else{let F=new this._window.Image;typeof D.imageOptions.crossOrigin=="string"&&(F.crossOrigin=D.imageOptions.crossOrigin),this._image=F,F.onload=()=>_t(this,null,function*(){this._options.imageOptions.saveAsBlob&&(this._imageUri=yield function(N,z){return _t(this,null,function*(){return new Promise(q=>{let $=new z.XMLHttpRequest;$.onload=function(){let ee=new z.FileReader;ee.onloadend=function(){q(ee.result)},ee.readAsDataURL($.response)},$.open("GET",N),$.responseType="blob",$.send()})})}(D.image||"",this._window)),C()}),F.src=D.image}})}drawImage(F){return _t(this,arguments,function*({width:C,height:T,count:M,dotSize:D}){let N=this._options,z=this._roundSize((N.width-M*D)/2),q=this._roundSize((N.height-M*D)/2),$=z+this._roundSize(N.imageOptions.margin+(M*D-C)/2),ee=q+this._roundSize(N.imageOptions.margin+(M*D-T)/2),J=C-2*N.imageOptions.margin,j=T-2*N.imageOptions.margin,Z=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");Z.setAttribute("href",this._imageUri||""),Z.setAttribute("x",String($)),Z.setAttribute("y",String(ee)),Z.setAttribute("width",`${J}px`),Z.setAttribute("height",`${j}px`),this._element.appendChild(Z)})}_createColor({options:C,color:T,additionalRotation:M,x:D,y:F,height:N,width:z,name:q}){let $=z>N?z:N,ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(ee.setAttribute("x",String(D)),ee.setAttribute("y",String(F)),ee.setAttribute("height",String(N)),ee.setAttribute("width",String(z)),ee.setAttribute("clip-path",`url('#clip-path-${q}')`),C){let J;if(C.type==="radial")J=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),J.setAttribute("id",q),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("fx",String(D+z/2)),J.setAttribute("fy",String(F+N/2)),J.setAttribute("cx",String(D+z/2)),J.setAttribute("cy",String(F+N/2)),J.setAttribute("r",String($/2));else{let j=((C.rotation||0)+M)%(2*Math.PI),Z=(j+2*Math.PI)%(2*Math.PI),H=D+z/2,k=F+N/2,G=D+z/2,W=F+N/2;Z>=0&&Z<=.25*Math.PI||Z>1.75*Math.PI&&Z<=2*Math.PI?(H-=z/2,k-=N/2*Math.tan(j),G+=z/2,W+=N/2*Math.tan(j)):Z>.25*Math.PI&&Z<=.75*Math.PI?(k-=N/2,H-=z/2/Math.tan(j),W+=N/2,G+=z/2/Math.tan(j)):Z>.75*Math.PI&&Z<=1.25*Math.PI?(H+=z/2,k+=N/2*Math.tan(j),G-=z/2,W-=N/2*Math.tan(j)):Z>1.25*Math.PI&&Z<=1.75*Math.PI&&(k+=N/2,H+=z/2/Math.tan(j),W-=N/2,G-=z/2/Math.tan(j)),J=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),J.setAttribute("id",q),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("x1",String(Math.round(H))),J.setAttribute("y1",String(Math.round(k))),J.setAttribute("x2",String(Math.round(G))),J.setAttribute("y2",String(Math.round(W)))}C.colorStops.forEach(({offset:j,color:Z})=>{let H=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");H.setAttribute("offset",100*j+"%"),H.setAttribute("stop-color",Z),J.appendChild(H)}),ee.setAttribute("fill",`url('#${q}')`),this._defs.appendChild(J)}else T&&ee.setAttribute("fill",T);this._element.appendChild(ee)}}return E.instanceCount=0,E})(),S="canvas",A={};for(let E=0;E<=40;E++)A[E]=E;let P={type:S,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:A[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function O(E){let x=Object.assign({},E);if(!x.colorStops||!x.colorStops.length)throw"Field 'colorStops' is required in gradient";return x.rotation?x.rotation=Number(x.rotation):x.rotation=0,x.colorStops=x.colorStops.map(C=>Object.assign(Object.assign({},C),{offset:Number(C.offset)})),x}function I(E){let x=Object.assign({},E);return x.width=Number(x.width),x.height=Number(x.height),x.margin=Number(x.margin),x.imageOptions=Object.assign(Object.assign({},x.imageOptions),{hideBackgroundDots:!!x.imageOptions.hideBackgroundDots,imageSize:Number(x.imageOptions.imageSize),margin:Number(x.imageOptions.margin)}),x.margin>Math.min(x.width,x.height)&&(x.margin=Math.min(x.width,x.height)),x.dotsOptions=Object.assign({},x.dotsOptions),x.dotsOptions.gradient&&(x.dotsOptions.gradient=O(x.dotsOptions.gradient)),x.cornersSquareOptions&&(x.cornersSquareOptions=Object.assign({},x.cornersSquareOptions),x.cornersSquareOptions.gradient&&(x.cornersSquareOptions.gradient=O(x.cornersSquareOptions.gradient))),x.cornersDotOptions&&(x.cornersDotOptions=Object.assign({},x.cornersDotOptions),x.cornersDotOptions.gradient&&(x.cornersDotOptions.gradient=O(x.cornersDotOptions.gradient))),x.backgroundOptions&&(x.backgroundOptions=Object.assign({},x.backgroundOptions),x.backgroundOptions.gradient&&(x.backgroundOptions.gradient=O(x.backgroundOptions.gradient))),x}var R=t(873),L=t.n(R);function B(E){if(!E)throw new Error("Extension must be defined");E[0]==="."&&(E=E.substring(1));let x={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[E.toLowerCase()];if(!x)throw new Error(`Extension "${E}" is not supported`);return x}class w{constructor(x){x?.jsdom?this._window=new x.jsdom("",{resources:"usable"}).window:this._window=window,this._options=x?I(a(P,x)):P,this.update()}static _clearContainer(x){x&&(x.innerHTML="")}_setupSvg(){if(!this._qr)return;let x=new b(this._options,this._window);this._svg=x.getElement(),this._svgDrawingPromise=x.drawQR(this._qr).then(()=>{var C;this._svg&&((C=this._extension)===null||C===void 0||C.call(this,x.getElement(),this._options))})}_setupCanvas(){var x,C;this._qr&&(!((x=this._options.nodeCanvas)===null||x===void 0)&&x.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(C=this._svgDrawingPromise)===null||C===void 0?void 0:C.then(()=>{var T;if(!this._svg)return;let M=this._svg,D=new this._window.XMLSerializer().serializeToString(M),F=btoa(D),N=`data:${B("svg")};base64,${F}`;if(!((T=this._options.nodeCanvas)===null||T===void 0)&&T.loadImage)return this._options.nodeCanvas.loadImage(N).then(z=>{var q,$;z.width=this._options.width,z.height=this._options.height,($=(q=this._nodeCanvas)===null||q===void 0?void 0:q.getContext("2d"))===null||$===void 0||$.drawImage(z,0,0)});{let z=new this._window.Image;return new Promise(q=>{z.onload=()=>{var $,ee;(ee=($=this._domCanvas)===null||$===void 0?void 0:$.getContext("2d"))===null||ee===void 0||ee.drawImage(z,0,0),q()},z.src=N})}}))}_getElement(x="png"){return _t(this,null,function*(){if(!this._qr)throw"QR code is empty";return x.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),yield this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),yield this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)})}update(x){w._clearContainer(this._container),this._options=x?I(a(this._options,x)):this._options,this._options.data&&(this._qr=L()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(C){switch(!0){case/^[0-9]*$/.test(C):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(C):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===S?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(x){if(x){if(typeof x.appendChild!="function")throw"Container should be a single DOM node";this._options.type===S?this._domCanvas&&x.appendChild(this._domCanvas):this._svg&&x.appendChild(this._svg),this._container=x}}applyExtension(x){if(!x)throw"Extension function should be defined.";this._extension=x,this.update()}deleteExtension(){this._extension=void 0,this.update()}getRawData(x="png"){return _t(this,null,function*(){if(!this._qr)throw"QR code is empty";let C=yield this._getElement(x),T=B(x);if(!C)return null;if(x.toLowerCase()==="svg"){let M=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(C)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(M):new Blob([M],{type:T})}return new Promise(M=>{let D=C;if("toBuffer"in D)if(T==="image/png")M(D.toBuffer(T));else if(T==="image/jpeg")M(D.toBuffer(T));else{if(T!=="application/pdf")throw Error("Unsupported extension");M(D.toBuffer(T))}else"toBlob"in D&&D.toBlob(M,T,1)})})}download(x){return _t(this,null,function*(){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let C="png",T="qr";typeof x=="string"?(C=x,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof x=="object"&&x!==null&&(x.name&&(T=x.name),x.extension&&(C=x.extension));let M=yield this._getElement(C);if(M)if(C.toLowerCase()==="svg"){let D=new XMLSerializer().serializeToString(M);D=`<?xml version="1.0" standalone="no"?>\r
`+D,o(`data:${B(C)};charset=utf-8,${encodeURIComponent(D)}`,`${T}.svg`)}else o(M.toDataURL(B(C)),`${T}.${C}`)})}}let _=w})(),n.default})())});var Pv=wa((so,$u)=>{"use strict";(function(e,t){typeof so=="object"&&typeof $u=="object"?$u.exports=t():typeof define=="function"&&define.amd?define([],t):typeof so=="object"?so.cytoscapePopper=t():e.cytoscapePopper=t()})(so,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=7)}([function(r,e,t){"use strict";var n=t(5),i=n.getBoundingBox;function a(o,s){var u={getBoundingClientRect:function(){return i(o,s)}};return u}r.exports={getRef:a}},function(r,e,t){"use strict";r.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return a.forEach(function(s){s!=null&&Object.keys(s).forEach(function(u){return n[u]=s[u]})}),n}},function(r,e,t){"use strict";var n=t(0),i=n.getRef,a=t(6),o=a.getContent;function s(u,l){var c=i(u,l),d=o(u,l.content);return u.popperFactory(c,d,l.popper)}r.exports={getPopper:s}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function u(v){return f(this),a(this[0],c(this[0],v))}function l(v){return f(this),s(this[0],c(this[0],v))}function c(v,p){var m=function(P){return P.isNode()?{w:P.renderedWidth(),h:P.renderedHeight()}:{w:3,h:3}},g=function(P){return P.isNode()?d(P,m):h(P)},y={},b=v.cy(),S={renderedDimensions:m,renderedPosition:g,popper:y,cy:b};return n({},S,p)}function d(v,p){var m=v.renderedPosition(),g=p(v),y=g.w/2,b=g.h/2;return{x:m.x-y,y:m.y-b}}function h(v){var p=v.midpoint(),m=v.cy().pan(),g=v.cy().zoom();return{x:p.x*g+m.x,y:p.y*g+m.y}}function f(v){v.length>1&&(console.warn("Popper.js Extension should only be used on one element."),console.warn("Ignoring all subsequent elements"))}r.exports={popper:u,popperRef:l}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function u(d){return a(this,c(this,d))}function l(d){return s(this,c(this,d))}function c(d,h){var f={boundingBox:{top:0,left:0,right:0,bottom:0,w:3,h:3},renderedDimensions:function(){return{w:3,h:3}},renderedPosition:function(){return{x:0,y:0}},popper:{},cy:d};return n({},f,h)}r.exports={popper:u,popperRef:l}},function(r,e,t){"use strict";function n(i,a){var o=a.renderedPosition,s=a.cy,u=a.renderedDimensions,l=s.container().getBoundingClientRect(),c=u(i),d=o(i);return{top:d.y+l.top,left:d.x+l.left,right:d.x+c.w+l.left,bottom:d.y+c.h+l.top,width:c.w,height:c.h}}r.exports={getBoundingBox:n}},function(r,e,t){"use strict";function n(i,a){var o=null;if(typeof a=="function")o=a(i);else{if(a instanceof HTMLElement)return a;throw new Error("Can not create popper from 'target' with unknown type")}if(o===null)throw new Error("No 'target' specified to create popper");return o}r.exports={getContent:n}},function(r,e,t){"use strict";var n=t(4),i=t(3),a=function(s){if(typeof s!="function")throw new Error("Provide 'popperFactory' before registering the module");return function(l){l&&(l("core","popperFactory",s),l("collection","popperFactory",s),l("core","popper",n.popper),l("collection","popper",i.popper),l("core","popperRef",n.popperRef),l("collection","popperRef",i.popperRef))}};r.exports=a}])})});var uc=wa((yo,lc)=>{"use strict";(function(e,t){typeof yo=="object"&&typeof lc=="object"?lc.exports=t():typeof define=="function"&&define.amd?define([],t):typeof yo=="object"?yo.layoutBase=t():e.layoutBase=t()})(yo,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=28)}([function(r,e,t){"use strict";function n(){}n.QUALITY=1,n.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,n.DEFAULT_INCREMENTAL=!1,n.DEFAULT_ANIMATION_ON_LAYOUT=!0,n.DEFAULT_ANIMATION_DURING_LAYOUT=!1,n.DEFAULT_ANIMATION_PERIOD=50,n.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,n.DEFAULT_GRAPH_MARGIN=15,n.NODE_DIMENSIONS_INCLUDE_LABELS=!1,n.SIMPLE_NODE_SIZE=40,n.SIMPLE_NODE_HALF_SIZE=n.SIMPLE_NODE_SIZE/2,n.EMPTY_COMPOUND_NODE_SIZE=40,n.MIN_EDGE_LENGTH=1,n.WORLD_BOUNDARY=1e6,n.INITIAL_WORLD_BOUNDARY=n.WORLD_BOUNDARY/1e3,n.WORLD_CENTER_X=1200,n.WORLD_CENTER_Y=900,r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(8),a=t(9);function o(u,l,c){n.call(this,c),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=c,this.bendpoints=[],this.source=u,this.target=l}o.prototype=Object.create(n.prototype);for(var s in n)o[s]=n[s];o.prototype.getSource=function(){return this.source},o.prototype.getTarget=function(){return this.target},o.prototype.isInterGraph=function(){return this.isInterGraph},o.prototype.getLength=function(){return this.length},o.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},o.prototype.getBendpoints=function(){return this.bendpoints},o.prototype.getLca=function(){return this.lca},o.prototype.getSourceInLca=function(){return this.sourceInLca},o.prototype.getTargetInLca=function(){return this.targetInLca},o.prototype.getOtherEnd=function(u){if(this.source===u)return this.target;if(this.target===u)return this.source;throw"Node is not incident with this edge"},o.prototype.getOtherEndInGraph=function(u,l){for(var c=this.getOtherEnd(u),d=l.getGraphManager().getRoot();;){if(c.getOwner()==l)return c;if(c.getOwner()==d)break;c=c.getOwner().getParent()}return null},o.prototype.updateLength=function(){var u=new Array(4);this.isOverlapingSourceAndTarget=i.getIntersection(this.target.getRect(),this.source.getRect(),u),this.isOverlapingSourceAndTarget||(this.lengthX=u[0]-u[2],this.lengthY=u[1]-u[3],Math.abs(this.lengthX)<1&&(this.lengthX=a.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=a.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},o.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=a.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=a.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},r.exports=o},function(r,e,t){"use strict";function n(i){this.vGraphObject=i}r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(10),a=t(13),o=t(0),s=t(16),u=t(5);function l(d,h,f,v){f==null&&v==null&&(v=h),n.call(this,v),d.graphManager!=null&&(d=d.graphManager),this.estimatedSize=i.MIN_VALUE,this.inclusionTreeDepth=i.MAX_VALUE,this.vGraphObject=v,this.edges=[],this.graphManager=d,f!=null&&h!=null?this.rect=new a(h.x,h.y,f.width,f.height):this.rect=new a}l.prototype=Object.create(n.prototype);for(var c in n)l[c]=n[c];l.prototype.getEdges=function(){return this.edges},l.prototype.getChild=function(){return this.child},l.prototype.getOwner=function(){return this.owner},l.prototype.getWidth=function(){return this.rect.width},l.prototype.setWidth=function(d){this.rect.width=d},l.prototype.getHeight=function(){return this.rect.height},l.prototype.setHeight=function(d){this.rect.height=d},l.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},l.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},l.prototype.getCenter=function(){return new u(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},l.prototype.getLocation=function(){return new u(this.rect.x,this.rect.y)},l.prototype.getRect=function(){return this.rect},l.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},l.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},l.prototype.setRect=function(d,h){this.rect.x=d.x,this.rect.y=d.y,this.rect.width=h.width,this.rect.height=h.height},l.prototype.setCenter=function(d,h){this.rect.x=d-this.rect.width/2,this.rect.y=h-this.rect.height/2},l.prototype.setLocation=function(d,h){this.rect.x=d,this.rect.y=h},l.prototype.moveBy=function(d,h){this.rect.x+=d,this.rect.y+=h},l.prototype.getEdgeListToNode=function(d){var h=[],f,v=this;return v.edges.forEach(function(p){if(p.target==d){if(p.source!=v)throw"Incorrect edge source!";h.push(p)}}),h},l.prototype.getEdgesBetween=function(d){var h=[],f,v=this;return v.edges.forEach(function(p){if(!(p.source==v||p.target==v))throw"Incorrect edge source and/or target";(p.target==d||p.source==d)&&h.push(p)}),h},l.prototype.getNeighborsList=function(){var d=new Set,h=this;return h.edges.forEach(function(f){if(f.source==h)d.add(f.target);else{if(f.target!=h)throw"Incorrect incidency!";d.add(f.source)}}),d},l.prototype.withChildren=function(){var d=new Set,h,f;if(d.add(this),this.child!=null)for(var v=this.child.getNodes(),p=0;p<v.length;p++)h=v[p],f=h.withChildren(),f.forEach(function(m){d.add(m)});return d},l.prototype.getNoOfChildren=function(){var d=0,h;if(this.child==null)d=1;else for(var f=this.child.getNodes(),v=0;v<f.length;v++)h=f[v],d+=h.getNoOfChildren();return d==0&&(d=1),d},l.prototype.getEstimatedSize=function(){if(this.estimatedSize==i.MIN_VALUE)throw"assert failed";return this.estimatedSize},l.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},l.prototype.scatter=function(){var d,h,f=-o.INITIAL_WORLD_BOUNDARY,v=o.INITIAL_WORLD_BOUNDARY;d=o.WORLD_CENTER_X+s.nextDouble()*(v-f)+f;var p=-o.INITIAL_WORLD_BOUNDARY,m=o.INITIAL_WORLD_BOUNDARY;h=o.WORLD_CENTER_Y+s.nextDouble()*(m-p)+p,this.rect.x=d,this.rect.y=h},l.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var d=this.getChild();if(d.updateBounds(!0),this.rect.x=d.getLeft(),this.rect.y=d.getTop(),this.setWidth(d.getRight()-d.getLeft()),this.setHeight(d.getBottom()-d.getTop()),o.NODE_DIMENSIONS_INCLUDE_LABELS){var h=d.getRight()-d.getLeft(),f=d.getBottom()-d.getTop();this.labelWidth&&(this.labelPosHorizontal=="left"?(this.rect.x-=this.labelWidth,this.setWidth(h+this.labelWidth)):this.labelPosHorizontal=="center"&&this.labelWidth>h?(this.rect.x-=(this.labelWidth-h)/2,this.setWidth(this.labelWidth)):this.labelPosHorizontal=="right"&&this.setWidth(h+this.labelWidth)),this.labelHeight&&(this.labelPosVertical=="top"?(this.rect.y-=this.labelHeight,this.setHeight(f+this.labelHeight)):this.labelPosVertical=="center"&&this.labelHeight>f?(this.rect.y-=(this.labelHeight-f)/2,this.setHeight(this.labelHeight)):this.labelPosVertical=="bottom"&&this.setHeight(f+this.labelHeight))}}},l.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==i.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},l.prototype.transform=function(d){var h=this.rect.x;h>o.WORLD_BOUNDARY?h=o.WORLD_BOUNDARY:h<-o.WORLD_BOUNDARY&&(h=-o.WORLD_BOUNDARY);var f=this.rect.y;f>o.WORLD_BOUNDARY?f=o.WORLD_BOUNDARY:f<-o.WORLD_BOUNDARY&&(f=-o.WORLD_BOUNDARY);var v=new u(h,f),p=d.inverseTransformPoint(v);this.setLocation(p.x,p.y)},l.prototype.getLeft=function(){return this.rect.x},l.prototype.getRight=function(){return this.rect.x+this.rect.width},l.prototype.getTop=function(){return this.rect.y},l.prototype.getBottom=function(){return this.rect.y+this.rect.height},l.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},r.exports=l},function(r,e,t){"use strict";var n=t(0);function i(){}for(var a in n)i[a]=n[a];i.MAX_ITERATIONS=2500,i.DEFAULT_EDGE_LENGTH=50,i.DEFAULT_SPRING_STRENGTH=.45,i.DEFAULT_REPULSION_STRENGTH=4500,i.DEFAULT_GRAVITY_STRENGTH=.4,i.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,i.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,i.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,i.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,i.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,i.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,i.COOLING_ADAPTATION_FACTOR=.33,i.ADAPTATION_LOWER_NODE_LIMIT=1e3,i.ADAPTATION_UPPER_NODE_LIMIT=5e3,i.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,i.MAX_NODE_DISPLACEMENT=i.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,i.MIN_REPULSION_DIST=i.DEFAULT_EDGE_LENGTH/10,i.CONVERGENCE_CHECK_PERIOD=100,i.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,i.MIN_EDGE_LENGTH=1,i.GRID_CALCULATION_CHECK_PERIOD=10,r.exports=i},function(r,e,t){"use strict";function n(i,a){i==null&&a==null?(this.x=0,this.y=0):(this.x=i,this.y=a)}n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.setX=function(i){this.x=i},n.prototype.setY=function(i){this.y=i},n.prototype.getDifference=function(i){return new DimensionD(this.x-i.x,this.y-i.y)},n.prototype.getCopy=function(){return new n(this.x,this.y)},n.prototype.translate=function(i){return this.x+=i.width,this.y+=i.height,this},r.exports=n},function(r,e,t){"use strict";var n=t(2),i=t(10),a=t(0),o=t(7),s=t(3),u=t(1),l=t(13),c=t(12),d=t(11);function h(v,p,m){n.call(this,m),this.estimatedSize=i.MIN_VALUE,this.margin=a.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=v,p!=null&&p instanceof o?this.graphManager=p:p!=null&&p instanceof Layout&&(this.graphManager=p.graphManager)}h.prototype=Object.create(n.prototype);for(var f in n)h[f]=n[f];h.prototype.getNodes=function(){return this.nodes},h.prototype.getEdges=function(){return this.edges},h.prototype.getGraphManager=function(){return this.graphManager},h.prototype.getParent=function(){return this.parent},h.prototype.getLeft=function(){return this.left},h.prototype.getRight=function(){return this.right},h.prototype.getTop=function(){return this.top},h.prototype.getBottom=function(){return this.bottom},h.prototype.isConnected=function(){return this.isConnected},h.prototype.add=function(v,p,m){if(p==null&&m==null){var g=v;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(g)>-1)throw"Node already in graph!";return g.owner=this,this.getNodes().push(g),g}else{var y=v;if(!(this.getNodes().indexOf(p)>-1&&this.getNodes().indexOf(m)>-1))throw"Source or target not in graph!";if(!(p.owner==m.owner&&p.owner==this))throw"Both owners must be this graph!";return p.owner!=m.owner?null:(y.source=p,y.target=m,y.isInterGraph=!1,this.getEdges().push(y),p.edges.push(y),m!=p&&m.edges.push(y),y)}},h.prototype.remove=function(v){var p=v;if(v instanceof s){if(p==null)throw"Node is null!";if(!(p.owner!=null&&p.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var m=p.edges.slice(),g,y=m.length,b=0;b<y;b++)g=m[b],g.isInterGraph?this.graphManager.remove(g):g.source.owner.remove(g);var S=this.nodes.indexOf(p);if(S==-1)throw"Node not in owner node list!";this.nodes.splice(S,1)}else if(v instanceof u){var g=v;if(g==null)throw"Edge is null!";if(!(g.source!=null&&g.target!=null))throw"Source and/or target is null!";if(!(g.source.owner!=null&&g.target.owner!=null&&g.source.owner==this&&g.target.owner==this))throw"Source and/or target owner is invalid!";var A=g.source.edges.indexOf(g),P=g.target.edges.indexOf(g);if(!(A>-1&&P>-1))throw"Source and/or target doesn't know this edge!";g.source.edges.splice(A,1),g.target!=g.source&&g.target.edges.splice(P,1);var S=g.source.owner.getEdges().indexOf(g);if(S==-1)throw"Not in owner's edge list!";g.source.owner.getEdges().splice(S,1)}},h.prototype.updateLeftTop=function(){for(var v=i.MAX_VALUE,p=i.MAX_VALUE,m,g,y,b=this.getNodes(),S=b.length,A=0;A<S;A++){var P=b[A];m=P.getTop(),g=P.getLeft(),v>m&&(v=m),p>g&&(p=g)}return v==i.MAX_VALUE?null:(b[0].getParent().paddingLeft!=null?y=b[0].getParent().paddingLeft:y=this.margin,this.left=p-y,this.top=v-y,new c(this.left,this.top))},h.prototype.updateBounds=function(v){for(var p=i.MAX_VALUE,m=-i.MAX_VALUE,g=i.MAX_VALUE,y=-i.MAX_VALUE,b,S,A,P,O,I=this.nodes,R=I.length,L=0;L<R;L++){var B=I[L];v&&B.child!=null&&B.updateBounds(),b=B.getLeft(),S=B.getRight(),A=B.getTop(),P=B.getBottom(),p>b&&(p=b),m<S&&(m=S),g>A&&(g=A),y<P&&(y=P)}var w=new l(p,g,m-p,y-g);p==i.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),I[0].getParent().paddingLeft!=null?O=I[0].getParent().paddingLeft:O=this.margin,this.left=w.x-O,this.right=w.x+w.width+O,this.top=w.y-O,this.bottom=w.y+w.height+O},h.calculateBounds=function(v){for(var p=i.MAX_VALUE,m=-i.MAX_VALUE,g=i.MAX_VALUE,y=-i.MAX_VALUE,b,S,A,P,O=v.length,I=0;I<O;I++){var R=v[I];b=R.getLeft(),S=R.getRight(),A=R.getTop(),P=R.getBottom(),p>b&&(p=b),m<S&&(m=S),g>A&&(g=A),y<P&&(y=P)}var L=new l(p,g,m-p,y-g);return L},h.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},h.prototype.getEstimatedSize=function(){if(this.estimatedSize==i.MIN_VALUE)throw"assert failed";return this.estimatedSize},h.prototype.calcEstimatedSize=function(){for(var v=0,p=this.nodes,m=p.length,g=0;g<m;g++){var y=p[g];v+=y.calcEstimatedSize()}return v==0?this.estimatedSize=a.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=v/Math.sqrt(this.nodes.length),this.estimatedSize},h.prototype.updateConnected=function(){var v=this;if(this.nodes.length==0){this.isConnected=!0;return}var p=new d,m=new Set,g=this.nodes[0],y,b,S=g.withChildren();for(S.forEach(function(L){p.push(L),m.add(L)});p.length!==0;){g=p.shift(),y=g.getEdges();for(var A=y.length,P=0;P<A;P++){var O=y[P];if(b=O.getOtherEndInGraph(g,this),b!=null&&!m.has(b)){var I=b.withChildren();I.forEach(function(L){p.push(L),m.add(L)})}}}if(this.isConnected=!1,m.size>=this.nodes.length){var R=0;m.forEach(function(L){L.owner==v&&R++}),R==this.nodes.length&&(this.isConnected=!0)}},r.exports=h},function(r,e,t){"use strict";var n,i=t(1);function a(o){n=t(6),this.layout=o,this.graphs=[],this.edges=[]}a.prototype.addRoot=function(){var o=this.layout.newGraph(),s=this.layout.newNode(null),u=this.add(o,s);return this.setRootGraph(u),this.rootGraph},a.prototype.add=function(o,s,u,l,c){if(u==null&&l==null&&c==null){if(o==null)throw"Graph is null!";if(s==null)throw"Parent node is null!";if(this.graphs.indexOf(o)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(o),o.parent!=null)throw"Already has a parent!";if(s.child!=null)throw"Already has a child!";return o.parent=s,s.child=o,o}else{c=u,l=s,u=o;var d=l.getOwner(),h=c.getOwner();if(!(d!=null&&d.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(h!=null&&h.getGraphManager()==this))throw"Target not in this graph mgr!";if(d==h)return u.isInterGraph=!1,d.add(u,l,c);if(u.isInterGraph=!0,u.source=l,u.target=c,this.edges.indexOf(u)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(u),!(u.source!=null&&u.target!=null))throw"Edge source and/or target is null!";if(!(u.source.edges.indexOf(u)==-1&&u.target.edges.indexOf(u)==-1))throw"Edge already in source and/or target incidency list!";return u.source.edges.push(u),u.target.edges.push(u),u}},a.prototype.remove=function(o){if(o instanceof n){var s=o;if(s.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(s==this.rootGraph||s.parent!=null&&s.parent.graphManager==this))throw"Invalid parent node!";var u=[];u=u.concat(s.getEdges());for(var l,c=u.length,d=0;d<c;d++)l=u[d],s.remove(l);var h=[];h=h.concat(s.getNodes());var f;c=h.length;for(var d=0;d<c;d++)f=h[d],s.remove(f);s==this.rootGraph&&this.setRootGraph(null);var v=this.graphs.indexOf(s);this.graphs.splice(v,1),s.parent=null}else if(o instanceof i){if(l=o,l==null)throw"Edge is null!";if(!l.isInterGraph)throw"Not an inter-graph edge!";if(!(l.source!=null&&l.target!=null))throw"Source and/or target is null!";if(!(l.source.edges.indexOf(l)!=-1&&l.target.edges.indexOf(l)!=-1))throw"Source and/or target doesn't know this edge!";var v=l.source.edges.indexOf(l);if(l.source.edges.splice(v,1),v=l.target.edges.indexOf(l),l.target.edges.splice(v,1),!(l.source.owner!=null&&l.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(l.source.owner.getGraphManager().edges.indexOf(l)==-1)throw"Not in owner graph manager's edge list!";var v=l.source.owner.getGraphManager().edges.indexOf(l);l.source.owner.getGraphManager().edges.splice(v,1)}},a.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},a.prototype.getGraphs=function(){return this.graphs},a.prototype.getAllNodes=function(){if(this.allNodes==null){for(var o=[],s=this.getGraphs(),u=s.length,l=0;l<u;l++)o=o.concat(s[l].getNodes());this.allNodes=o}return this.allNodes},a.prototype.resetAllNodes=function(){this.allNodes=null},a.prototype.resetAllEdges=function(){this.allEdges=null},a.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},a.prototype.getAllEdges=function(){if(this.allEdges==null){for(var o=[],s=this.getGraphs(),u=s.length,l=0;l<s.length;l++)o=o.concat(s[l].getEdges());o=o.concat(this.edges),this.allEdges=o}return this.allEdges},a.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},a.prototype.setAllNodesToApplyGravitation=function(o){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=o},a.prototype.getRoot=function(){return this.rootGraph},a.prototype.setRootGraph=function(o){if(o.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=o,o.parent==null&&(o.parent=this.layout.newNode("Root node"))},a.prototype.getLayout=function(){return this.layout},a.prototype.isOneAncestorOfOther=function(o,s){if(!(o!=null&&s!=null))throw"assert failed";if(o==s)return!0;var u=o.getOwner(),l;do{if(l=u.getParent(),l==null)break;if(l==s)return!0;if(u=l.getOwner(),u==null)break}while(!0);u=s.getOwner();do{if(l=u.getParent(),l==null)break;if(l==o)return!0;if(u=l.getOwner(),u==null)break}while(!0);return!1},a.prototype.calcLowestCommonAncestors=function(){for(var o,s,u,l,c,d=this.getAllEdges(),h=d.length,f=0;f<h;f++){if(o=d[f],s=o.source,u=o.target,o.lca=null,o.sourceInLca=s,o.targetInLca=u,s==u){o.lca=s.getOwner();continue}for(l=s.getOwner();o.lca==null;){for(o.targetInLca=u,c=u.getOwner();o.lca==null;){if(c==l){o.lca=c;break}if(c==this.rootGraph)break;if(o.lca!=null)throw"assert failed";o.targetInLca=c.getParent(),c=o.targetInLca.getOwner()}if(l==this.rootGraph)break;o.lca==null&&(o.sourceInLca=l.getParent(),l=o.sourceInLca.getOwner())}if(o.lca==null)throw"assert failed"}},a.prototype.calcLowestCommonAncestor=function(o,s){if(o==s)return o.getOwner();var u=o.getOwner();do{if(u==null)break;var l=s.getOwner();do{if(l==null)break;if(l==u)return l;l=l.getParent().getOwner()}while(!0);u=u.getParent().getOwner()}while(!0);return u},a.prototype.calcInclusionTreeDepths=function(o,s){o==null&&s==null&&(o=this.rootGraph,s=1);for(var u,l=o.getNodes(),c=l.length,d=0;d<c;d++)u=l[d],u.inclusionTreeDepth=s,u.child!=null&&this.calcInclusionTreeDepths(u.child,s+1)},a.prototype.includesInvalidEdge=function(){for(var o,s=[],u=this.edges.length,l=0;l<u;l++)o=this.edges[l],this.isOneAncestorOfOther(o.source,o.target)&&s.push(o);for(var l=0;l<s.length;l++)this.remove(s[l]);return!1},r.exports=a},function(r,e,t){"use strict";var n=t(12);function i(){}i.calcSeparationAmount=function(a,o,s,u){if(!a.intersects(o))throw"assert failed";var l=new Array(2);this.decideDirectionsForOverlappingNodes(a,o,l),s[0]=Math.min(a.getRight(),o.getRight())-Math.max(a.x,o.x),s[1]=Math.min(a.getBottom(),o.getBottom())-Math.max(a.y,o.y),a.getX()<=o.getX()&&a.getRight()>=o.getRight()?s[0]+=Math.min(o.getX()-a.getX(),a.getRight()-o.getRight()):o.getX()<=a.getX()&&o.getRight()>=a.getRight()&&(s[0]+=Math.min(a.getX()-o.getX(),o.getRight()-a.getRight())),a.getY()<=o.getY()&&a.getBottom()>=o.getBottom()?s[1]+=Math.min(o.getY()-a.getY(),a.getBottom()-o.getBottom()):o.getY()<=a.getY()&&o.getBottom()>=a.getBottom()&&(s[1]+=Math.min(a.getY()-o.getY(),o.getBottom()-a.getBottom()));var c=Math.abs((o.getCenterY()-a.getCenterY())/(o.getCenterX()-a.getCenterX()));o.getCenterY()===a.getCenterY()&&o.getCenterX()===a.getCenterX()&&(c=1);var d=c*s[0],h=s[1]/c;s[0]<h?h=s[0]:d=s[1],s[0]=-1*l[0]*(h/2+u),s[1]=-1*l[1]*(d/2+u)},i.decideDirectionsForOverlappingNodes=function(a,o,s){a.getCenterX()<o.getCenterX()?s[0]=-1:s[0]=1,a.getCenterY()<o.getCenterY()?s[1]=-1:s[1]=1},i.getIntersection2=function(a,o,s){var u=a.getCenterX(),l=a.getCenterY(),c=o.getCenterX(),d=o.getCenterY();if(a.intersects(o))return s[0]=u,s[1]=l,s[2]=c,s[3]=d,!0;var h=a.getX(),f=a.getY(),v=a.getRight(),p=a.getX(),m=a.getBottom(),g=a.getRight(),y=a.getWidthHalf(),b=a.getHeightHalf(),S=o.getX(),A=o.getY(),P=o.getRight(),O=o.getX(),I=o.getBottom(),R=o.getRight(),L=o.getWidthHalf(),B=o.getHeightHalf(),w=!1,_=!1;if(u===c){if(l>d)return s[0]=u,s[1]=f,s[2]=c,s[3]=I,!1;if(l<d)return s[0]=u,s[1]=m,s[2]=c,s[3]=A,!1}else if(l===d){if(u>c)return s[0]=h,s[1]=l,s[2]=P,s[3]=d,!1;if(u<c)return s[0]=v,s[1]=l,s[2]=S,s[3]=d,!1}else{var E=a.height/a.width,x=o.height/o.width,C=(d-l)/(c-u),T=void 0,M=void 0,D=void 0,F=void 0,N=void 0,z=void 0;if(-E===C?u>c?(s[0]=p,s[1]=m,w=!0):(s[0]=v,s[1]=f,w=!0):E===C&&(u>c?(s[0]=h,s[1]=f,w=!0):(s[0]=g,s[1]=m,w=!0)),-x===C?c>u?(s[2]=O,s[3]=I,_=!0):(s[2]=P,s[3]=A,_=!0):x===C&&(c>u?(s[2]=S,s[3]=A,_=!0):(s[2]=R,s[3]=I,_=!0)),w&&_)return!1;if(u>c?l>d?(T=this.getCardinalDirection(E,C,4),M=this.getCardinalDirection(x,C,2)):(T=this.getCardinalDirection(-E,C,3),M=this.getCardinalDirection(-x,C,1)):l>d?(T=this.getCardinalDirection(-E,C,1),M=this.getCardinalDirection(-x,C,3)):(T=this.getCardinalDirection(E,C,2),M=this.getCardinalDirection(x,C,4)),!w)switch(T){case 1:F=f,D=u+-b/C,s[0]=D,s[1]=F;break;case 2:D=g,F=l+y*C,s[0]=D,s[1]=F;break;case 3:F=m,D=u+b/C,s[0]=D,s[1]=F;break;case 4:D=p,F=l+-y*C,s[0]=D,s[1]=F;break}if(!_)switch(M){case 1:z=A,N=c+-B/C,s[2]=N,s[3]=z;break;case 2:N=R,z=d+L*C,s[2]=N,s[3]=z;break;case 3:z=I,N=c+B/C,s[2]=N,s[3]=z;break;case 4:N=O,z=d+-L*C,s[2]=N,s[3]=z;break}}return!1},i.getCardinalDirection=function(a,o,s){return a>o?s:1+s%4},i.getIntersection=function(a,o,s,u){if(u==null)return this.getIntersection2(a,o,s);var l=a.x,c=a.y,d=o.x,h=o.y,f=s.x,v=s.y,p=u.x,m=u.y,g=void 0,y=void 0,b=void 0,S=void 0,A=void 0,P=void 0,O=void 0,I=void 0,R=void 0;return b=h-c,A=l-d,O=d*c-l*h,S=m-v,P=f-p,I=p*v-f*m,R=b*P-S*A,R===0?null:(g=(A*I-P*O)/R,y=(S*O-b*I)/R,new n(g,y))},i.angleOfVector=function(a,o,s,u){var l=void 0;return a!==s?(l=Math.atan((u-o)/(s-a)),s<a?l+=Math.PI:u<o&&(l+=this.TWO_PI)):u<o?l=this.ONE_AND_HALF_PI:l=this.HALF_PI,l},i.doIntersect=function(a,o,s,u){var l=a.x,c=a.y,d=o.x,h=o.y,f=s.x,v=s.y,p=u.x,m=u.y,g=(d-l)*(m-v)-(p-f)*(h-c);if(g===0)return!1;var y=((m-v)*(p-l)+(f-p)*(m-c))/g,b=((c-h)*(p-l)+(d-l)*(m-c))/g;return 0<y&&y<1&&0<b&&b<1},i.findCircleLineIntersections=function(a,o,s,u,l,c,d){var h=(s-a)*(s-a)+(u-o)*(u-o),f=2*((a-l)*(s-a)+(o-c)*(u-o)),v=(a-l)*(a-l)+(o-c)*(o-c)-d*d,p=f*f-4*h*v;if(p>=0){var m=(-f+Math.sqrt(f*f-4*h*v))/(2*h),g=(-f-Math.sqrt(f*f-4*h*v))/(2*h),y=null;return m>=0&&m<=1?[m]:g>=0&&g<=1?[g]:y}else return null},i.HALF_PI=.5*Math.PI,i.ONE_AND_HALF_PI=1.5*Math.PI,i.TWO_PI=2*Math.PI,i.THREE_PI=3*Math.PI,r.exports=i},function(r,e,t){"use strict";function n(){}n.sign=function(i){return i>0?1:i<0?-1:0},n.floor=function(i){return i<0?Math.ceil(i):Math.floor(i)},n.ceil=function(i){return i<0?Math.floor(i):Math.ceil(i)},r.exports=n},function(r,e,t){"use strict";function n(){}n.MAX_VALUE=2147483647,n.MIN_VALUE=-2147483648,r.exports=n},function(r,e,t){"use strict";var n=function(){function l(c,d){for(var h=0;h<d.length;h++){var f=d[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}}return function(c,d,h){return d&&l(c.prototype,d),h&&l(c,h),c}}();function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(c){return{value:c,next:null,prev:null}},o=function(c,d,h,f){return c!==null?c.next=d:f.head=d,h!==null?h.prev=d:f.tail=d,d.prev=c,d.next=h,f.length++,d},s=function(c,d){var h=c.prev,f=c.next;return h!==null?h.next=f:d.head=f,f!==null?f.prev=h:d.tail=h,c.prev=c.next=null,d.length--,c},u=function(){function l(c){var d=this;i(this,l),this.length=0,this.head=null,this.tail=null,c?.forEach(function(h){return d.push(h)})}return n(l,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(d,h){return o(h.prev,a(d),h,this)}},{key:"insertAfter",value:function(d,h){return o(h,a(d),h.next,this)}},{key:"insertNodeBefore",value:function(d,h){return o(h.prev,d,h,this)}},{key:"insertNodeAfter",value:function(d,h){return o(h,d,h.next,this)}},{key:"push",value:function(d){return o(this.tail,a(d),null,this)}},{key:"unshift",value:function(d){return o(null,a(d),this.head,this)}},{key:"remove",value:function(d){return s(d,this)}},{key:"pop",value:function(){return s(this.tail,this).value}},{key:"popNode",value:function(){return s(this.tail,this)}},{key:"shift",value:function(){return s(this.head,this).value}},{key:"shiftNode",value:function(){return s(this.head,this)}},{key:"get_object_at",value:function(d){if(d<=this.length()){for(var h=1,f=this.head;h<d;)f=f.next,h++;return f.value}}},{key:"set_object_at",value:function(d,h){if(d<=this.length()){for(var f=1,v=this.head;f<d;)v=v.next,f++;v.value=h}}}]),l}();r.exports=u},function(r,e,t){"use strict";function n(i,a,o){this.x=null,this.y=null,i==null&&a==null&&o==null?(this.x=0,this.y=0):typeof i=="number"&&typeof a=="number"&&o==null?(this.x=i,this.y=a):i.constructor.name=="Point"&&a==null&&o==null&&(o=i,this.x=o.x,this.y=o.y)}n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.getLocation=function(){return new n(this.x,this.y)},n.prototype.setLocation=function(i,a,o){i.constructor.name=="Point"&&a==null&&o==null?(o=i,this.setLocation(o.x,o.y)):typeof i=="number"&&typeof a=="number"&&o==null&&(parseInt(i)==i&&parseInt(a)==a?this.move(i,a):(this.x=Math.floor(i+.5),this.y=Math.floor(a+.5)))},n.prototype.move=function(i,a){this.x=i,this.y=a},n.prototype.translate=function(i,a){this.x+=i,this.y+=a},n.prototype.equals=function(i){if(i.constructor.name=="Point"){var a=i;return this.x==a.x&&this.y==a.y}return this==i},n.prototype.toString=function(){return new n().constructor.name+"[x="+this.x+",y="+this.y+"]"},r.exports=n},function(r,e,t){"use strict";function n(i,a,o,s){this.x=0,this.y=0,this.width=0,this.height=0,i!=null&&a!=null&&o!=null&&s!=null&&(this.x=i,this.y=a,this.width=o,this.height=s)}n.prototype.getX=function(){return this.x},n.prototype.setX=function(i){this.x=i},n.prototype.getY=function(){return this.y},n.prototype.setY=function(i){this.y=i},n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(i){this.width=i},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(i){this.height=i},n.prototype.getRight=function(){return this.x+this.width},n.prototype.getBottom=function(){return this.y+this.height},n.prototype.intersects=function(i){return!(this.getRight()<i.x||this.getBottom()<i.y||i.getRight()<this.x||i.getBottom()<this.y)},n.prototype.getCenterX=function(){return this.x+this.width/2},n.prototype.getMinX=function(){return this.getX()},n.prototype.getMaxX=function(){return this.getX()+this.width},n.prototype.getCenterY=function(){return this.y+this.height/2},n.prototype.getMinY=function(){return this.getY()},n.prototype.getMaxY=function(){return this.getY()+this.height},n.prototype.getWidthHalf=function(){return this.width/2},n.prototype.getHeightHalf=function(){return this.height/2},r.exports=n},function(r,e,t){"use strict";var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function i(){}i.lastID=0,i.createID=function(a){return i.isPrimitive(a)?a:(a.uniqueID!=null||(a.uniqueID=i.getString(),i.lastID++),a.uniqueID)},i.getString=function(a){return a==null&&(a=i.lastID),"Object#"+a},i.isPrimitive=function(a){var o=typeof a>"u"?"undefined":n(a);return a==null||o!="object"&&o!="function"},r.exports=i},function(r,e,t){"use strict";function n(f){if(Array.isArray(f)){for(var v=0,p=Array(f.length);v<f.length;v++)p[v]=f[v];return p}else return Array.from(f)}var i=t(0),a=t(7),o=t(3),s=t(1),u=t(6),l=t(5),c=t(17),d=t(29);function h(f){d.call(this),this.layoutQuality=i.QUALITY,this.createBendsAsNeeded=i.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=i.DEFAULT_INCREMENTAL,this.animationOnLayout=i.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=i.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=i.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=i.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new a(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,f!=null&&(this.isRemoteUse=f)}h.RANDOM_SEED=1,h.prototype=Object.create(d.prototype),h.prototype.getGraphManager=function(){return this.graphManager},h.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},h.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},h.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},h.prototype.newGraphManager=function(){var f=new a(this);return this.graphManager=f,f},h.prototype.newGraph=function(f){return new u(null,this.graphManager,f)},h.prototype.newNode=function(f){return new o(this.graphManager,f)},h.prototype.newEdge=function(f){return new s(null,null,f)},h.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},h.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var f;return this.checkLayoutSuccess()?f=!1:f=this.layout(),i.ANIMATE==="during"?!1:(f&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,f)},h.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},h.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var f,v=this.graphManager.getAllEdges(),p=0;p<v.length;p++)f=v[p];for(var m,g=this.graphManager.getRoot().getNodes(),p=0;p<g.length;p++)m=g[p];this.update(this.graphManager.getRoot())}},h.prototype.update=function(f){if(f==null)this.update2();else if(f instanceof o){var v=f;if(v.getChild()!=null)for(var p=v.getChild().getNodes(),m=0;m<p.length;m++)update(p[m]);if(v.vGraphObject!=null){var g=v.vGraphObject;g.update(v)}}else if(f instanceof s){var y=f;if(y.vGraphObject!=null){var b=y.vGraphObject;b.update(y)}}else if(f instanceof u){var S=f;if(S.vGraphObject!=null){var A=S.vGraphObject;A.update(S)}}},h.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=i.QUALITY,this.animationDuringLayout=i.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=i.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=i.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=i.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=i.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=i.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},h.prototype.transform=function(f){if(f==null)this.transform(new l(0,0));else{var v=new c,p=this.graphManager.getRoot().updateLeftTop();if(p!=null){v.setWorldOrgX(f.x),v.setWorldOrgY(f.y),v.setDeviceOrgX(p.x),v.setDeviceOrgY(p.y);for(var m=this.getAllNodes(),g,y=0;y<m.length;y++)g=m[y],g.transform(v)}}},h.prototype.positionNodesRandomly=function(f){if(f==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var v,p,m=f.getNodes(),g=0;g<m.length;g++)v=m[g],p=v.getChild(),p==null||p.getNodes().length==0?v.scatter():(this.positionNodesRandomly(p),v.updateBounds())},h.prototype.getFlatForest=function(){for(var f=[],v=!0,p=this.graphManager.getRoot().getNodes(),m=!0,g=0;g<p.length;g++)p[g].getChild()!=null&&(m=!1);if(!m)return f;var y=new Set,b=[],S=new Map,A=[];for(A=A.concat(p);A.length>0&&v;){for(b.push(A[0]);b.length>0&&v;){var P=b[0];b.splice(0,1),y.add(P);for(var O=P.getEdges(),g=0;g<O.length;g++){var I=O[g].getOtherEnd(P);if(S.get(P)!=I)if(!y.has(I))b.push(I),S.set(I,P);else{v=!1;break}}}if(!v)f=[];else{var R=[].concat(n(y));f.push(R);for(var g=0;g<R.length;g++){var L=R[g],B=A.indexOf(L);B>-1&&A.splice(B,1)}y=new Set,S=new Map}}return f},h.prototype.createDummyNodesForBendpoints=function(f){for(var v=[],p=f.source,m=this.graphManager.calcLowestCommonAncestor(f.source,f.target),g=0;g<f.bendpoints.length;g++){var y=this.newNode(null);y.setRect(new Point(0,0),new Dimension(1,1)),m.add(y);var b=this.newEdge(null);this.graphManager.add(b,p,y),v.add(y),p=y}var b=this.newEdge(null);return this.graphManager.add(b,p,f.target),this.edgeToDummyNodes.set(f,v),f.isInterGraph()?this.graphManager.remove(f):m.remove(f),v},h.prototype.createBendpointsFromDummyNodes=function(){var f=[];f=f.concat(this.graphManager.getAllEdges()),f=[].concat(n(this.edgeToDummyNodes.keys())).concat(f);for(var v=0;v<f.length;v++){var p=f[v];if(p.bendpoints.length>0){for(var m=this.edgeToDummyNodes.get(p),g=0;g<m.length;g++){var y=m[g],b=new l(y.getCenterX(),y.getCenterY()),S=p.bendpoints.get(g);S.x=b.x,S.y=b.y,y.getOwner().remove(y)}this.graphManager.add(p,p.source,p.target)}}},h.transform=function(f,v,p,m){if(p!=null&&m!=null){var g=v;if(f<=50){var y=v/p;g-=(v-y)/50*(50-f)}else{var b=v*m;g+=(b-v)/50*(f-50)}return g}else{var S,A;return f<=50?(S=9*v/500,A=v/10):(S=9*v/50,A=-8*v),S*f+A}},h.findCenterOfTree=function(f){var v=[];v=v.concat(f);var p=[],m=new Map,g=!1,y=null;(v.length==1||v.length==2)&&(g=!0,y=v[0]);for(var b=0;b<v.length;b++){var S=v[b],A=S.getNeighborsList().size;m.set(S,S.getNeighborsList().size),A==1&&p.push(S)}var P=[];for(P=P.concat(p);!g;){var O=[];O=O.concat(P),P=[];for(var b=0;b<v.length;b++){var S=v[b],I=v.indexOf(S);I>=0&&v.splice(I,1);var R=S.getNeighborsList();R.forEach(function(w){if(p.indexOf(w)<0){var _=m.get(w),E=_-1;E==1&&P.push(w),m.set(w,E)}})}p=p.concat(P),(v.length==1||v.length==2)&&(g=!0,y=v[0])}return y},h.prototype.setGraphManager=function(f){this.graphManager=f},r.exports=h},function(r,e,t){"use strict";function n(){}n.seed=1,n.x=0,n.nextDouble=function(){return n.x=Math.sin(n.seed++)*1e4,n.x-Math.floor(n.x)},r.exports=n},function(r,e,t){"use strict";var n=t(5);function i(a,o){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}i.prototype.getWorldOrgX=function(){return this.lworldOrgX},i.prototype.setWorldOrgX=function(a){this.lworldOrgX=a},i.prototype.getWorldOrgY=function(){return this.lworldOrgY},i.prototype.setWorldOrgY=function(a){this.lworldOrgY=a},i.prototype.getWorldExtX=function(){return this.lworldExtX},i.prototype.setWorldExtX=function(a){this.lworldExtX=a},i.prototype.getWorldExtY=function(){return this.lworldExtY},i.prototype.setWorldExtY=function(a){this.lworldExtY=a},i.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},i.prototype.setDeviceOrgX=function(a){this.ldeviceOrgX=a},i.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},i.prototype.setDeviceOrgY=function(a){this.ldeviceOrgY=a},i.prototype.getDeviceExtX=function(){return this.ldeviceExtX},i.prototype.setDeviceExtX=function(a){this.ldeviceExtX=a},i.prototype.getDeviceExtY=function(){return this.ldeviceExtY},i.prototype.setDeviceExtY=function(a){this.ldeviceExtY=a},i.prototype.transformX=function(a){var o=0,s=this.lworldExtX;return s!=0&&(o=this.ldeviceOrgX+(a-this.lworldOrgX)*this.ldeviceExtX/s),o},i.prototype.transformY=function(a){var o=0,s=this.lworldExtY;return s!=0&&(o=this.ldeviceOrgY+(a-this.lworldOrgY)*this.ldeviceExtY/s),o},i.prototype.inverseTransformX=function(a){var o=0,s=this.ldeviceExtX;return s!=0&&(o=this.lworldOrgX+(a-this.ldeviceOrgX)*this.lworldExtX/s),o},i.prototype.inverseTransformY=function(a){var o=0,s=this.ldeviceExtY;return s!=0&&(o=this.lworldOrgY+(a-this.ldeviceOrgY)*this.lworldExtY/s),o},i.prototype.inverseTransformPoint=function(a){var o=new n(this.inverseTransformX(a.x),this.inverseTransformY(a.y));return o},r.exports=i},function(r,e,t){"use strict";function n(d){if(Array.isArray(d)){for(var h=0,f=Array(d.length);h<d.length;h++)f[h]=d[h];return f}else return Array.from(d)}var i=t(15),a=t(4),o=t(0),s=t(8),u=t(9);function l(){i.call(this),this.useSmartIdealEdgeLengthCalculation=a.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=a.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=a.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=a.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=a.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*a.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=a.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=a.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=a.MAX_ITERATIONS}l.prototype=Object.create(i.prototype);for(var c in i)l[c]=i[c];l.prototype.initParameters=function(){i.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=a.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},l.prototype.calcIdealEdgeLengths=function(){for(var d,h,f,v,p,m,g,y=this.getGraphManager().getAllEdges(),b=0;b<y.length;b++)d=y[b],h=d.idealLength,d.isInterGraph&&(v=d.getSource(),p=d.getTarget(),m=d.getSourceInLca().getEstimatedSize(),g=d.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(d.idealLength+=m+g-2*o.SIMPLE_NODE_SIZE),f=d.getLca().getInclusionTreeDepth(),d.idealLength+=h*a.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(v.getInclusionTreeDepth()+p.getInclusionTreeDepth()-2*f))},l.prototype.initSpringEmbedder=function(){var d=this.getAllNodes().length;this.incremental?(d>a.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*a.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(d-a.ADAPTATION_LOWER_NODE_LIMIT)/(a.ADAPTATION_UPPER_NODE_LIMIT-a.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-a.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=a.MAX_NODE_DISPLACEMENT_INCREMENTAL):(d>a.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(a.COOLING_ADAPTATION_FACTOR,1-(d-a.ADAPTATION_LOWER_NODE_LIMIT)/(a.ADAPTATION_UPPER_NODE_LIMIT-a.ADAPTATION_LOWER_NODE_LIMIT)*(1-a.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=a.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.displacementThresholdPerNode=3*a.DEFAULT_EDGE_LENGTH/100,this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},l.prototype.calcSpringForces=function(){for(var d=this.getAllEdges(),h,f=0;f<d.length;f++)h=d[f],this.calcSpringForce(h,h.idealLength)},l.prototype.calcRepulsionForces=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f,v,p,m,g=this.getAllNodes(),y;if(this.useFRGridVariant)for(this.totalIterations%a.GRID_CALCULATION_CHECK_PERIOD==1&&d&&this.updateGrid(),y=new Set,f=0;f<g.length;f++)p=g[f],this.calculateRepulsionForceOfANode(p,y,d,h),y.add(p);else for(f=0;f<g.length;f++)for(p=g[f],v=f+1;v<g.length;v++)m=g[v],p.getOwner()==m.getOwner()&&this.calcRepulsionForce(p,m)},l.prototype.calcGravitationalForces=function(){for(var d,h=this.getAllNodesToApplyGravitation(),f=0;f<h.length;f++)d=h[f],this.calcGravitationalForce(d)},l.prototype.moveNodes=function(){for(var d=this.getAllNodes(),h,f=0;f<d.length;f++)h=d[f],h.move()},l.prototype.calcSpringForce=function(d,h){var f=d.getSource(),v=d.getTarget(),p,m,g,y;if(this.uniformLeafNodeSizes&&f.getChild()==null&&v.getChild()==null)d.updateLengthSimple();else if(d.updateLength(),d.isOverlapingSourceAndTarget)return;p=d.getLength(),p!=0&&(m=d.edgeElasticity*(p-h),g=m*(d.lengthX/p),y=m*(d.lengthY/p),f.springForceX+=g,f.springForceY+=y,v.springForceX-=g,v.springForceY-=y)},l.prototype.calcRepulsionForce=function(d,h){var f=d.getRect(),v=h.getRect(),p=new Array(2),m=new Array(4),g,y,b,S,A,P,O;if(f.intersects(v)){s.calcSeparationAmount(f,v,p,a.DEFAULT_EDGE_LENGTH/2),P=2*p[0],O=2*p[1];var I=d.noOfChildren*h.noOfChildren/(d.noOfChildren+h.noOfChildren);d.repulsionForceX-=I*P,d.repulsionForceY-=I*O,h.repulsionForceX+=I*P,h.repulsionForceY+=I*O}else this.uniformLeafNodeSizes&&d.getChild()==null&&h.getChild()==null?(g=v.getCenterX()-f.getCenterX(),y=v.getCenterY()-f.getCenterY()):(s.getIntersection(f,v,m),g=m[2]-m[0],y=m[3]-m[1]),Math.abs(g)<a.MIN_REPULSION_DIST&&(g=u.sign(g)*a.MIN_REPULSION_DIST),Math.abs(y)<a.MIN_REPULSION_DIST&&(y=u.sign(y)*a.MIN_REPULSION_DIST),b=g*g+y*y,S=Math.sqrt(b),A=(d.nodeRepulsion/2+h.nodeRepulsion/2)*d.noOfChildren*h.noOfChildren/b,P=A*g/S,O=A*y/S,d.repulsionForceX-=P,d.repulsionForceY-=O,h.repulsionForceX+=P,h.repulsionForceY+=O},l.prototype.calcGravitationalForce=function(d){var h,f,v,p,m,g,y,b;h=d.getOwner(),f=(h.getRight()+h.getLeft())/2,v=(h.getTop()+h.getBottom())/2,p=d.getCenterX()-f,m=d.getCenterY()-v,g=Math.abs(p)+d.getWidth()/2,y=Math.abs(m)+d.getHeight()/2,d.getOwner()==this.graphManager.getRoot()?(b=h.getEstimatedSize()*this.gravityRangeFactor,(g>b||y>b)&&(d.gravitationForceX=-this.gravityConstant*p,d.gravitationForceY=-this.gravityConstant*m)):(b=h.getEstimatedSize()*this.compoundGravityRangeFactor,(g>b||y>b)&&(d.gravitationForceX=-this.gravityConstant*p*this.compoundGravityConstant,d.gravitationForceY=-this.gravityConstant*m*this.compoundGravityConstant))},l.prototype.isConverged=function(){var d,h=!1;return this.totalIterations>this.maxIterations/3&&(h=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),d=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,d||h},l.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},l.prototype.calcNoOfChildrenForAllNodes=function(){for(var d,h=this.graphManager.getAllNodes(),f=0;f<h.length;f++)d=h[f],d.noOfChildren=d.getNoOfChildren()},l.prototype.calcGrid=function(d){var h=0,f=0;h=parseInt(Math.ceil((d.getRight()-d.getLeft())/this.repulsionRange)),f=parseInt(Math.ceil((d.getBottom()-d.getTop())/this.repulsionRange));for(var v=new Array(h),p=0;p<h;p++)v[p]=new Array(f);for(var p=0;p<h;p++)for(var m=0;m<f;m++)v[p][m]=new Array;return v},l.prototype.addNodeToGrid=function(d,h,f){var v=0,p=0,m=0,g=0;v=parseInt(Math.floor((d.getRect().x-h)/this.repulsionRange)),p=parseInt(Math.floor((d.getRect().width+d.getRect().x-h)/this.repulsionRange)),m=parseInt(Math.floor((d.getRect().y-f)/this.repulsionRange)),g=parseInt(Math.floor((d.getRect().height+d.getRect().y-f)/this.repulsionRange));for(var y=v;y<=p;y++)for(var b=m;b<=g;b++)this.grid[y][b].push(d),d.setGridCoordinates(v,p,m,g)},l.prototype.updateGrid=function(){var d,h,f=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),d=0;d<f.length;d++)h=f[d],this.addNodeToGrid(h,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},l.prototype.calculateRepulsionForceOfANode=function(d,h,f,v){if(this.totalIterations%a.GRID_CALCULATION_CHECK_PERIOD==1&&f||v){var p=new Set;d.surrounding=new Array;for(var m,g=this.grid,y=d.startX-1;y<d.finishX+2;y++)for(var b=d.startY-1;b<d.finishY+2;b++)if(!(y<0||b<0||y>=g.length||b>=g[0].length)){for(var S=0;S<g[y][b].length;S++)if(m=g[y][b][S],!(d.getOwner()!=m.getOwner()||d==m)&&!h.has(m)&&!p.has(m)){var A=Math.abs(d.getCenterX()-m.getCenterX())-(d.getWidth()/2+m.getWidth()/2),P=Math.abs(d.getCenterY()-m.getCenterY())-(d.getHeight()/2+m.getHeight()/2);A<=this.repulsionRange&&P<=this.repulsionRange&&p.add(m)}}d.surrounding=[].concat(n(p))}for(y=0;y<d.surrounding.length;y++)this.calcRepulsionForce(d,d.surrounding[y])},l.prototype.calcRepulsionRange=function(){return 0},r.exports=l},function(r,e,t){"use strict";var n=t(1),i=t(4);function a(s,u,l){n.call(this,s,u,l),this.idealLength=i.DEFAULT_EDGE_LENGTH,this.edgeElasticity=i.DEFAULT_SPRING_STRENGTH}a.prototype=Object.create(n.prototype);for(var o in n)a[o]=n[o];r.exports=a},function(r,e,t){"use strict";var n=t(3),i=t(4);function a(s,u,l,c){n.call(this,s,u,l,c),this.nodeRepulsion=i.DEFAULT_REPULSION_STRENGTH,this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}a.prototype=Object.create(n.prototype);for(var o in n)a[o]=n[o];a.prototype.setGridCoordinates=function(s,u,l,c){this.startX=s,this.finishX=u,this.startY=l,this.finishY=c},r.exports=a},function(r,e,t){"use strict";function n(i,a){this.width=0,this.height=0,i!==null&&a!==null&&(this.height=a,this.width=i)}n.prototype.getWidth=function(){return this.width},n.prototype.setWidth=function(i){this.width=i},n.prototype.getHeight=function(){return this.height},n.prototype.setHeight=function(i){this.height=i},r.exports=n},function(r,e,t){"use strict";var n=t(14);function i(){this.map={},this.keys=[]}i.prototype.put=function(a,o){var s=n.createID(a);this.contains(s)||(this.map[s]=o,this.keys.push(a))},i.prototype.contains=function(a){var o=n.createID(a);return this.map[a]!=null},i.prototype.get=function(a){var o=n.createID(a);return this.map[o]},i.prototype.keySet=function(){return this.keys},r.exports=i},function(r,e,t){"use strict";var n=t(14);function i(){this.set={}}i.prototype.add=function(a){var o=n.createID(a);this.contains(o)||(this.set[o]=a)},i.prototype.remove=function(a){delete this.set[n.createID(a)]},i.prototype.clear=function(){this.set={}},i.prototype.contains=function(a){return this.set[n.createID(a)]==a},i.prototype.isEmpty=function(){return this.size()===0},i.prototype.size=function(){return Object.keys(this.set).length},i.prototype.addAllTo=function(a){for(var o=Object.keys(this.set),s=o.length,u=0;u<s;u++)a.push(this.set[o[u]])},i.prototype.size=function(){return Object.keys(this.set).length},i.prototype.addAll=function(a){for(var o=a.length,s=0;s<o;s++){var u=a[s];this.add(u)}},r.exports=i},function(r,e,t){"use strict";function n(){}n.multMat=function(i,a){for(var o=[],s=0;s<i.length;s++){o[s]=[];for(var u=0;u<a[0].length;u++){o[s][u]=0;for(var l=0;l<i[0].length;l++)o[s][u]+=i[s][l]*a[l][u]}}return o},n.transpose=function(i){for(var a=[],o=0;o<i[0].length;o++){a[o]=[];for(var s=0;s<i.length;s++)a[o][s]=i[s][o]}return a},n.multCons=function(i,a){for(var o=[],s=0;s<i.length;s++)o[s]=i[s]*a;return o},n.minusOp=function(i,a){for(var o=[],s=0;s<i.length;s++)o[s]=i[s]-a[s];return o},n.dotProduct=function(i,a){for(var o=0,s=0;s<i.length;s++)o+=i[s]*a[s];return o},n.mag=function(i){return Math.sqrt(this.dotProduct(i,i))},n.normalize=function(i){for(var a=[],o=this.mag(i),s=0;s<i.length;s++)a[s]=i[s]/o;return a},n.multGamma=function(i){for(var a=[],o=0,s=0;s<i.length;s++)o+=i[s];o*=-1/i.length;for(var u=0;u<i.length;u++)a[u]=o+i[u];return a},n.multL=function(i,a,o){for(var s=[],u=[],l=[],c=0;c<a[0].length;c++){for(var d=0,h=0;h<a.length;h++)d+=-.5*a[h][c]*i[h];u[c]=d}for(var f=0;f<o.length;f++){for(var v=0,p=0;p<o.length;p++)v+=o[f][p]*u[p];l[f]=v}for(var m=0;m<a.length;m++){for(var g=0,y=0;y<a[0].length;y++)g+=a[m][y]*l[y];s[m]=g}return s},r.exports=n},function(r,e,t){"use strict";var n=function(){function s(u,l){for(var c=0;c<l.length;c++){var d=l[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}return function(u,l,c){return l&&s(u.prototype,l),c&&s(u,c),u}}();function i(s,u){if(!(s instanceof u))throw new TypeError("Cannot call a class as a function")}var a=t(11),o=function(){function s(u,l){i(this,s),(l!==null||l!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var c=void 0;u instanceof a?c=u.size():c=u.length,this._quicksort(u,0,c-1)}return n(s,[{key:"_quicksort",value:function(l,c,d){if(c<d){var h=this._partition(l,c,d);this._quicksort(l,c,h),this._quicksort(l,h+1,d)}}},{key:"_partition",value:function(l,c,d){for(var h=this._get(l,c),f=c,v=d;;){for(;this.compareFunction(h,this._get(l,v));)v--;for(;this.compareFunction(this._get(l,f),h);)f++;if(f<v)this._swap(l,f,v),f++,v--;else return v}}},{key:"_get",value:function(l,c){return l instanceof a?l.get_object_at(c):l[c]}},{key:"_set",value:function(l,c,d){l instanceof a?l.set_object_at(c,d):l[c]=d}},{key:"_swap",value:function(l,c,d){var h=this._get(l,c);this._set(l,c,this._get(l,d)),this._set(l,d,h)}},{key:"_defaultCompareFunction",value:function(l,c){return c>l}}]),s}();r.exports=o},function(r,e,t){"use strict";function n(){}n.svd=function(i){this.U=null,this.V=null,this.s=null,this.m=0,this.n=0,this.m=i.length,this.n=i[0].length;var a=Math.min(this.m,this.n);this.s=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(Math.min(this.m+1,this.n)),this.U=function(et){var Ze=function It(Je){if(Je.length==0)return 0;for(var st=[],pt=0;pt<Je[0];pt++)st.push(It(Je.slice(1)));return st};return Ze(et)}([this.m,a]),this.V=function(et){var Ze=function It(Je){if(Je.length==0)return 0;for(var st=[],pt=0;pt<Je[0];pt++)st.push(It(Je.slice(1)));return st};return Ze(et)}([this.n,this.n]);for(var o=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(this.n),s=function(et){for(var Ze=[];et-- >0;)Ze.push(0);return Ze}(this.m),u=!0,l=!0,c=Math.min(this.m-1,this.n),d=Math.max(0,Math.min(this.n-2,this.m)),h=0;h<Math.max(c,d);h++){if(h<c){this.s[h]=0;for(var f=h;f<this.m;f++)this.s[h]=n.hypot(this.s[h],i[f][h]);if(this.s[h]!==0){i[h][h]<0&&(this.s[h]=-this.s[h]);for(var v=h;v<this.m;v++)i[v][h]/=this.s[h];i[h][h]+=1}this.s[h]=-this.s[h]}for(var p=h+1;p<this.n;p++){if(function(et,Ze){return et&&Ze}(h<c,this.s[h]!==0)){for(var m=0,g=h;g<this.m;g++)m+=i[g][h]*i[g][p];m=-m/i[h][h];for(var y=h;y<this.m;y++)i[y][p]+=m*i[y][h]}o[p]=i[h][p]}if(function(et,Ze){return et&&Ze}(u,h<c))for(var b=h;b<this.m;b++)this.U[b][h]=i[b][h];if(h<d){o[h]=0;for(var S=h+1;S<this.n;S++)o[h]=n.hypot(o[h],o[S]);if(o[h]!==0){o[h+1]<0&&(o[h]=-o[h]);for(var A=h+1;A<this.n;A++)o[A]/=o[h];o[h+1]+=1}if(o[h]=-o[h],function(et,Ze){return et&&Ze}(h+1<this.m,o[h]!==0)){for(var P=h+1;P<this.m;P++)s[P]=0;for(var O=h+1;O<this.n;O++)for(var I=h+1;I<this.m;I++)s[I]+=o[O]*i[I][O];for(var R=h+1;R<this.n;R++)for(var L=-o[R]/o[h+1],B=h+1;B<this.m;B++)i[B][R]+=L*s[B]}if(l)for(var w=h+1;w<this.n;w++)this.V[w][h]=o[w]}}var _=Math.min(this.n,this.m+1);if(c<this.n&&(this.s[c]=i[c][c]),this.m<_&&(this.s[_-1]=0),d+1<_&&(o[d]=i[d][_-1]),o[_-1]=0,u){for(var E=c;E<a;E++){for(var x=0;x<this.m;x++)this.U[x][E]=0;this.U[E][E]=1}for(var C=c-1;C>=0;C--)if(this.s[C]!==0){for(var T=C+1;T<a;T++){for(var M=0,D=C;D<this.m;D++)M+=this.U[D][C]*this.U[D][T];M=-M/this.U[C][C];for(var F=C;F<this.m;F++)this.U[F][T]+=M*this.U[F][C]}for(var N=C;N<this.m;N++)this.U[N][C]=-this.U[N][C];this.U[C][C]=1+this.U[C][C];for(var z=0;z<C-1;z++)this.U[z][C]=0}else{for(var q=0;q<this.m;q++)this.U[q][C]=0;this.U[C][C]=1}}if(l)for(var $=this.n-1;$>=0;$--){if(function(et,Ze){return et&&Ze}($<d,o[$]!==0))for(var ee=$+1;ee<a;ee++){for(var J=0,j=$+1;j<this.n;j++)J+=this.V[j][$]*this.V[j][ee];J=-J/this.V[$+1][$];for(var Z=$+1;Z<this.n;Z++)this.V[Z][ee]+=J*this.V[Z][$]}for(var H=0;H<this.n;H++)this.V[H][$]=0;this.V[$][$]=1}for(var k=_-1,G=0,W=Math.pow(2,-52),te=Math.pow(2,-966);_>0;){var X=void 0,me=void 0;for(X=_-2;X>=-1&&X!==-1;X--)if(Math.abs(o[X])<=te+W*(Math.abs(this.s[X])+Math.abs(this.s[X+1]))){o[X]=0;break}if(X===_-2)me=4;else{var Te=void 0;for(Te=_-1;Te>=X&&Te!==X;Te--){var fe=(Te!==_?Math.abs(o[Te]):0)+(Te!==X+1?Math.abs(o[Te-1]):0);if(Math.abs(this.s[Te])<=te+W*fe){this.s[Te]=0;break}}Te===X?me=3:Te===_-1?me=1:(me=2,X=Te)}switch(X++,me){case 1:{var ue=o[_-2];o[_-2]=0;for(var de=_-2;de>=X;de--){var ye=n.hypot(this.s[de],ue),Se=this.s[de]/ye,xe=ue/ye;if(this.s[de]=ye,de!==X&&(ue=-xe*o[de-1],o[de-1]=Se*o[de-1]),l)for(var Ce=0;Ce<this.n;Ce++)ye=Se*this.V[Ce][de]+xe*this.V[Ce][_-1],this.V[Ce][_-1]=-xe*this.V[Ce][de]+Se*this.V[Ce][_-1],this.V[Ce][de]=ye}}break;case 2:{var _e=o[X-1];o[X-1]=0;for(var be=X;be<_;be++){var he=n.hypot(this.s[be],_e),V=this.s[be]/he,re=_e/he;if(this.s[be]=he,_e=-re*o[be],o[be]=V*o[be],u)for(var le=0;le<this.m;le++)he=V*this.U[le][be]+re*this.U[le][X-1],this.U[le][X-1]=-re*this.U[le][be]+V*this.U[le][X-1],this.U[le][be]=he}}break;case 3:{var Y=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[_-1]),Math.abs(this.s[_-2])),Math.abs(o[_-2])),Math.abs(this.s[X])),Math.abs(o[X])),Q=this.s[_-1]/Y,oe=this.s[_-2]/Y,ne=o[_-2]/Y,se=this.s[X]/Y,ve=o[X]/Y,Re=((oe+Q)*(oe-Q)+ne*ne)/2,we=Q*ne*(Q*ne),pe=0;(function(et,Ze){return et||Ze})(Re!==0,we!==0)&&(pe=Math.sqrt(Re*Re+we),Re<0&&(pe=-pe),pe=we/(Re+pe));for(var Me=(se+Q)*(se-Q)+pe,Ae=se*ve,Ie=X;Ie<_-1;Ie++){var Ve=n.hypot(Me,Ae),Ke=Me/Ve,ze=Ae/Ve;if(Ie!==X&&(o[Ie-1]=Ve),Me=Ke*this.s[Ie]+ze*o[Ie],o[Ie]=Ke*o[Ie]-ze*this.s[Ie],Ae=ze*this.s[Ie+1],this.s[Ie+1]=Ke*this.s[Ie+1],l)for(var Le=0;Le<this.n;Le++)Ve=Ke*this.V[Le][Ie]+ze*this.V[Le][Ie+1],this.V[Le][Ie+1]=-ze*this.V[Le][Ie]+Ke*this.V[Le][Ie+1],this.V[Le][Ie]=Ve;if(Ve=n.hypot(Me,Ae),Ke=Me/Ve,ze=Ae/Ve,this.s[Ie]=Ve,Me=Ke*o[Ie]+ze*this.s[Ie+1],this.s[Ie+1]=-ze*o[Ie]+Ke*this.s[Ie+1],Ae=ze*o[Ie+1],o[Ie+1]=Ke*o[Ie+1],u&&Ie<this.m-1)for(var He=0;He<this.m;He++)Ve=Ke*this.U[He][Ie]+ze*this.U[He][Ie+1],this.U[He][Ie+1]=-ze*this.U[He][Ie]+Ke*this.U[He][Ie+1],this.U[He][Ie]=Ve}o[_-2]=Me,G=G+1}break;case 4:{if(this.s[X]<=0&&(this.s[X]=this.s[X]<0?-this.s[X]:0,l))for(var Be=0;Be<=k;Be++)this.V[Be][X]=-this.V[Be][X];for(;X<k&&!(this.s[X]>=this.s[X+1]);){var Ge=this.s[X];if(this.s[X]=this.s[X+1],this.s[X+1]=Ge,l&&X<this.n-1)for(var it=0;it<this.n;it++)Ge=this.V[it][X+1],this.V[it][X+1]=this.V[it][X],this.V[it][X]=Ge;if(u&&X<this.m-1)for(var at=0;at<this.m;at++)Ge=this.U[at][X+1],this.U[at][X+1]=this.U[at][X],this.U[at][X]=Ge;X++}G=0,_--}break}}var mt={U:this.U,V:this.V,S:this.s};return mt},n.hypot=function(i,a){var o=void 0;return Math.abs(i)>Math.abs(a)?(o=a/i,o=Math.abs(i)*Math.sqrt(1+o*o)):a!=0?(o=i/a,o=Math.abs(a)*Math.sqrt(1+o*o)):o=0,o},r.exports=n},function(r,e,t){"use strict";var n=function(){function o(s,u){for(var l=0;l<u.length;l++){var c=u[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(s,c.key,c)}}return function(s,u,l){return u&&o(s.prototype,u),l&&o(s,l),s}}();function i(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}var a=function(){function o(s,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;i(this,o),this.sequence1=s,this.sequence2=u,this.match_score=l,this.mismatch_penalty=c,this.gap_penalty=d,this.iMax=s.length+1,this.jMax=u.length+1,this.grid=new Array(this.iMax);for(var h=0;h<this.iMax;h++){this.grid[h]=new Array(this.jMax);for(var f=0;f<this.jMax;f++)this.grid[h][f]=0}this.tracebackGrid=new Array(this.iMax);for(var v=0;v<this.iMax;v++){this.tracebackGrid[v]=new Array(this.jMax);for(var p=0;p<this.jMax;p++)this.tracebackGrid[v][p]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return n(o,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var u=1;u<this.jMax;u++)this.grid[0][u]=this.grid[0][u-1]+this.gap_penalty,this.tracebackGrid[0][u]=[!1,!1,!0];for(var l=1;l<this.iMax;l++)this.grid[l][0]=this.grid[l-1][0]+this.gap_penalty,this.tracebackGrid[l][0]=[!1,!0,!1];for(var c=1;c<this.iMax;c++)for(var d=1;d<this.jMax;d++){var h=void 0;this.sequence1[c-1]===this.sequence2[d-1]?h=this.grid[c-1][d-1]+this.match_score:h=this.grid[c-1][d-1]+this.mismatch_penalty;var f=this.grid[c-1][d]+this.gap_penalty,v=this.grid[c][d-1]+this.gap_penalty,p=[h,f,v],m=this.arrayAllMaxIndexes(p);this.grid[c][d]=p[m[0]],this.tracebackGrid[c][d]=[m.includes(0),m.includes(1),m.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var u=[];for(u.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});u[0];){var l=u[0],c=this.tracebackGrid[l.pos[0]][l.pos[1]];c[0]&&u.push({pos:[l.pos[0]-1,l.pos[1]-1],seq1:this.sequence1[l.pos[0]-1]+l.seq1,seq2:this.sequence2[l.pos[1]-1]+l.seq2}),c[1]&&u.push({pos:[l.pos[0]-1,l.pos[1]],seq1:this.sequence1[l.pos[0]-1]+l.seq1,seq2:"-"+l.seq2}),c[2]&&u.push({pos:[l.pos[0],l.pos[1]-1],seq1:"-"+l.seq1,seq2:this.sequence2[l.pos[1]-1]+l.seq2}),l.pos[0]===0&&l.pos[1]===0&&this.alignments.push({sequence1:l.seq1,sequence2:l.seq2}),u.shift()}return this.alignments}},{key:"getAllIndexes",value:function(u,l){for(var c=[],d=-1;(d=u.indexOf(l,d+1))!==-1;)c.push(d);return c}},{key:"arrayAllMaxIndexes",value:function(u){return this.getAllIndexes(u,Math.max.apply(null,u))}}]),o}();r.exports=a},function(r,e,t){"use strict";var n=function(){};n.FDLayout=t(18),n.FDLayoutConstants=t(4),n.FDLayoutEdge=t(19),n.FDLayoutNode=t(20),n.DimensionD=t(21),n.HashMap=t(22),n.HashSet=t(23),n.IGeometry=t(8),n.IMath=t(9),n.Integer=t(10),n.Point=t(12),n.PointD=t(5),n.RandomSeed=t(16),n.RectangleD=t(13),n.Transform=t(17),n.UniqueIDGeneretor=t(14),n.Quicksort=t(25),n.LinkedList=t(11),n.LGraphObject=t(2),n.LGraph=t(6),n.LEdge=t(1),n.LGraphManager=t(7),n.LNode=t(3),n.Layout=t(15),n.LayoutConstants=t(0),n.NeedlemanWunsch=t(27),n.Matrix=t(24),n.SVD=t(26),r.exports=n},function(r,e,t){"use strict";function n(){this.listeners=[]}var i=n.prototype;i.addListener=function(a,o){this.listeners.push({event:a,callback:o})},i.removeListener=function(a,o){for(var s=this.listeners.length;s>=0;s--){var u=this.listeners[s];u.event===a&&u.callback===o&&this.listeners.splice(s,1)}},i.emit=function(a,o){for(var s=0;s<this.listeners.length;s++){var u=this.listeners[s];a===u.event&&u.callback(o)}},r.exports=n}])})});var dc=wa((Co,cc)=>{"use strict";(function(e,t){typeof Co=="object"&&typeof cc=="object"?cc.exports=t(uc()):typeof define=="function"&&define.amd?define(["layout-base"],t):typeof Co=="object"?Co.coseBase=t(uc()):e.coseBase=t(e.layoutBase)})(Co,function(r){return(()=>{"use strict";var e={45:(a,o,s)=>{var u={};u.layoutBase=s(551),u.CoSEConstants=s(806),u.CoSEEdge=s(767),u.CoSEGraph=s(880),u.CoSEGraphManager=s(578),u.CoSELayout=s(765),u.CoSENode=s(991),u.ConstraintHandler=s(902),a.exports=u},806:(a,o,s)=>{var u=s(551).FDLayoutConstants;function l(){}for(var c in u)l[c]=u[c];l.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,l.DEFAULT_RADIAL_SEPARATION=u.DEFAULT_EDGE_LENGTH,l.DEFAULT_COMPONENT_SEPERATION=60,l.TILE=!0,l.TILING_PADDING_VERTICAL=10,l.TILING_PADDING_HORIZONTAL=10,l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,l.ENFORCE_CONSTRAINTS=!0,l.APPLY_LAYOUT=!0,l.RELAX_MOVEMENT_ON_CONSTRAINTS=!0,l.TREE_REDUCTION_ON_INCREMENTAL=!0,l.PURE_INCREMENTAL=l.DEFAULT_INCREMENTAL,a.exports=l},767:(a,o,s)=>{var u=s(551).FDLayoutEdge;function l(d,h,f){u.call(this,d,h,f)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},880:(a,o,s)=>{var u=s(551).LGraph;function l(d,h,f){u.call(this,d,h,f)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},578:(a,o,s)=>{var u=s(551).LGraphManager;function l(d){u.call(this,d)}l.prototype=Object.create(u.prototype);for(var c in u)l[c]=u[c];a.exports=l},765:(a,o,s)=>{var u=s(551).FDLayout,l=s(578),c=s(880),d=s(991),h=s(767),f=s(806),v=s(902),p=s(551).FDLayoutConstants,m=s(551).LayoutConstants,g=s(551).Point,y=s(551).PointD,b=s(551).DimensionD,S=s(551).Layout,A=s(551).Integer,P=s(551).IGeometry,O=s(551).LGraph,I=s(551).Transform,R=s(551).LinkedList;function L(){u.call(this),this.toBeTiled={},this.constraints={}}L.prototype=Object.create(u.prototype);for(var B in u)L[B]=u[B];L.prototype.newGraphManager=function(){var w=new l(this);return this.graphManager=w,w},L.prototype.newGraph=function(w){return new c(null,this.graphManager,w)},L.prototype.newNode=function(w){return new d(this.graphManager,w)},L.prototype.newEdge=function(w){return new h(null,null,w)},L.prototype.initParameters=function(){u.prototype.initParameters.call(this,arguments),this.isSubLayout||(f.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=f.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=f.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=p.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=p.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=p.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=p.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1)},L.prototype.initSpringEmbedder=function(){u.prototype.initSpringEmbedder.call(this),this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/p.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=.04,this.coolingAdjuster=1},L.prototype.layout=function(){var w=m.DEFAULT_CREATE_BENDS_AS_NEEDED;return w&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},L.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(f.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var _=new Set(this.getAllNodes()),E=this.nodesWithGravity.filter(function(T){return _.has(T)});this.graphManager.setAllNodesToApplyGravitation(E)}}else{var w=this.getFlatForest();if(w.length>0)this.positionNodesRadially(w);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var _=new Set(this.getAllNodes()),E=this.nodesWithGravity.filter(function(x){return _.has(x)});this.graphManager.setAllNodesToApplyGravitation(E),this.positionNodesRandomly()}}return Object.keys(this.constraints).length>0&&(v.handleConstraints(this),this.initConstraintVariables()),this.initSpringEmbedder(),f.APPLY_LAYOUT&&this.runSpringEmbedder(),!0},L.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%p.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var w=new Set(this.getAllNodes()),_=this.nodesWithGravity.filter(function(C){return w.has(C)});this.graphManager.setAllNodesToApplyGravitation(_),this.graphManager.updateBounds(),this.updateGrid(),f.PURE_INCREMENTAL?this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL/2:this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),f.PURE_INCREMENTAL?this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL/2*((100-this.afterGrowthIterations)/100):this.coolingFactor=p.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var E=!this.isTreeGrowing&&!this.isGrowthFinished,x=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(E,x),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},L.prototype.getPositionsData=function(){for(var w=this.graphManager.getAllNodes(),_={},E=0;E<w.length;E++){var x=w[E].rect,C=w[E].id;_[C]={id:C,x:x.getCenterX(),y:x.getCenterY(),w:x.width,h:x.height}}return _},L.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var w=!1;if(p.ANIMATE==="during")this.emit("layoutstarted");else{for(;!w;)w=this.tick();this.graphManager.updateBounds()}},L.prototype.moveNodes=function(){for(var w=this.getAllNodes(),_,E=0;E<w.length;E++)_=w[E],_.calculateDisplacement();Object.keys(this.constraints).length>0&&this.updateDisplacements();for(var E=0;E<w.length;E++)_=w[E],_.move()},L.prototype.initConstraintVariables=function(){var w=this;this.idToNodeMap=new Map,this.fixedNodeSet=new Set;for(var _=this.graphManager.getAllNodes(),E=0;E<_.length;E++){var x=_[E];this.idToNodeMap.set(x.id,x)}var C=function j(Z){for(var H=Z.getChild().getNodes(),k,G=0,W=0;W<H.length;W++)k=H[W],k.getChild()==null?w.fixedNodeSet.has(k.id)&&(G+=100):G+=j(k);return G};if(this.constraints.fixedNodeConstraint){this.constraints.fixedNodeConstraint.forEach(function(H){w.fixedNodeSet.add(H.nodeId)});for(var _=this.graphManager.getAllNodes(),x,E=0;E<_.length;E++)if(x=_[E],x.getChild()!=null){var T=C(x);T>0&&(x.fixedNodeWeight=T)}}if(this.constraints.relativePlacementConstraint){var M=new Map,D=new Map;if(this.dummyToNodeForVerticalAlignment=new Map,this.dummyToNodeForHorizontalAlignment=new Map,this.fixedNodesOnHorizontal=new Set,this.fixedNodesOnVertical=new Set,this.fixedNodeSet.forEach(function(j){w.fixedNodesOnHorizontal.add(j),w.fixedNodesOnVertical.add(j)}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var F=this.constraints.alignmentConstraint.vertical,E=0;E<F.length;E++)this.dummyToNodeForVerticalAlignment.set("dummy"+E,[]),F[E].forEach(function(Z){M.set(Z,"dummy"+E),w.dummyToNodeForVerticalAlignment.get("dummy"+E).push(Z),w.fixedNodeSet.has(Z)&&w.fixedNodesOnHorizontal.add("dummy"+E)});if(this.constraints.alignmentConstraint.horizontal)for(var N=this.constraints.alignmentConstraint.horizontal,E=0;E<N.length;E++)this.dummyToNodeForHorizontalAlignment.set("dummy"+E,[]),N[E].forEach(function(Z){D.set(Z,"dummy"+E),w.dummyToNodeForHorizontalAlignment.get("dummy"+E).push(Z),w.fixedNodeSet.has(Z)&&w.fixedNodesOnVertical.add("dummy"+E)})}if(f.RELAX_MOVEMENT_ON_CONSTRAINTS)this.shuffle=function(j){var Z,H,k;for(k=j.length-1;k>=2*j.length/3;k--)Z=Math.floor(Math.random()*(k+1)),H=j[k],j[k]=j[Z],j[Z]=H;return j},this.nodesInRelativeHorizontal=[],this.nodesInRelativeVertical=[],this.nodeToRelativeConstraintMapHorizontal=new Map,this.nodeToRelativeConstraintMapVertical=new Map,this.nodeToTempPositionMapHorizontal=new Map,this.nodeToTempPositionMapVertical=new Map,this.constraints.relativePlacementConstraint.forEach(function(j){if(j.left){var Z=M.has(j.left)?M.get(j.left):j.left,H=M.has(j.right)?M.get(j.right):j.right;w.nodesInRelativeHorizontal.includes(Z)||(w.nodesInRelativeHorizontal.push(Z),w.nodeToRelativeConstraintMapHorizontal.set(Z,[]),w.dummyToNodeForVerticalAlignment.has(Z)?w.nodeToTempPositionMapHorizontal.set(Z,w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(Z)[0]).getCenterX()):w.nodeToTempPositionMapHorizontal.set(Z,w.idToNodeMap.get(Z).getCenterX())),w.nodesInRelativeHorizontal.includes(H)||(w.nodesInRelativeHorizontal.push(H),w.nodeToRelativeConstraintMapHorizontal.set(H,[]),w.dummyToNodeForVerticalAlignment.has(H)?w.nodeToTempPositionMapHorizontal.set(H,w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(H)[0]).getCenterX()):w.nodeToTempPositionMapHorizontal.set(H,w.idToNodeMap.get(H).getCenterX())),w.nodeToRelativeConstraintMapHorizontal.get(Z).push({right:H,gap:j.gap}),w.nodeToRelativeConstraintMapHorizontal.get(H).push({left:Z,gap:j.gap})}else{var k=D.has(j.top)?D.get(j.top):j.top,G=D.has(j.bottom)?D.get(j.bottom):j.bottom;w.nodesInRelativeVertical.includes(k)||(w.nodesInRelativeVertical.push(k),w.nodeToRelativeConstraintMapVertical.set(k,[]),w.dummyToNodeForHorizontalAlignment.has(k)?w.nodeToTempPositionMapVertical.set(k,w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(k)[0]).getCenterY()):w.nodeToTempPositionMapVertical.set(k,w.idToNodeMap.get(k).getCenterY())),w.nodesInRelativeVertical.includes(G)||(w.nodesInRelativeVertical.push(G),w.nodeToRelativeConstraintMapVertical.set(G,[]),w.dummyToNodeForHorizontalAlignment.has(G)?w.nodeToTempPositionMapVertical.set(G,w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(G)[0]).getCenterY()):w.nodeToTempPositionMapVertical.set(G,w.idToNodeMap.get(G).getCenterY())),w.nodeToRelativeConstraintMapVertical.get(k).push({bottom:G,gap:j.gap}),w.nodeToRelativeConstraintMapVertical.get(G).push({top:k,gap:j.gap})}});else{var z=new Map,q=new Map;this.constraints.relativePlacementConstraint.forEach(function(j){if(j.left){var Z=M.has(j.left)?M.get(j.left):j.left,H=M.has(j.right)?M.get(j.right):j.right;z.has(Z)?z.get(Z).push(H):z.set(Z,[H]),z.has(H)?z.get(H).push(Z):z.set(H,[Z])}else{var k=D.has(j.top)?D.get(j.top):j.top,G=D.has(j.bottom)?D.get(j.bottom):j.bottom;q.has(k)?q.get(k).push(G):q.set(k,[G]),q.has(G)?q.get(G).push(k):q.set(G,[k])}});var $=function(Z,H){var k=[],G=[],W=new R,te=new Set,X=0;return Z.forEach(function(me,Te){if(!te.has(Te)){k[X]=[],G[X]=!1;var fe=Te;for(W.push(fe),te.add(fe),k[X].push(fe);W.length!=0;){fe=W.shift(),H.has(fe)&&(G[X]=!0);var ue=Z.get(fe);ue.forEach(function(de){te.has(de)||(W.push(de),te.add(de),k[X].push(de))})}X++}}),{components:k,isFixed:G}},ee=$(z,w.fixedNodesOnHorizontal);this.componentsOnHorizontal=ee.components,this.fixedComponentsOnHorizontal=ee.isFixed;var J=$(q,w.fixedNodesOnVertical);this.componentsOnVertical=J.components,this.fixedComponentsOnVertical=J.isFixed}}},L.prototype.updateDisplacements=function(){var w=this;if(this.constraints.fixedNodeConstraint&&this.constraints.fixedNodeConstraint.forEach(function(J){var j=w.idToNodeMap.get(J.nodeId);j.displacementX=0,j.displacementY=0}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var _=this.constraints.alignmentConstraint.vertical,E=0;E<_.length;E++){for(var x=0,C=0;C<_[E].length;C++){if(this.fixedNodeSet.has(_[E][C])){x=0;break}x+=this.idToNodeMap.get(_[E][C]).displacementX}for(var T=x/_[E].length,C=0;C<_[E].length;C++)this.idToNodeMap.get(_[E][C]).displacementX=T}if(this.constraints.alignmentConstraint.horizontal)for(var M=this.constraints.alignmentConstraint.horizontal,E=0;E<M.length;E++){for(var D=0,C=0;C<M[E].length;C++){if(this.fixedNodeSet.has(M[E][C])){D=0;break}D+=this.idToNodeMap.get(M[E][C]).displacementY}for(var F=D/M[E].length,C=0;C<M[E].length;C++)this.idToNodeMap.get(M[E][C]).displacementY=F}}if(this.constraints.relativePlacementConstraint)if(f.RELAX_MOVEMENT_ON_CONSTRAINTS)this.totalIterations%10==0&&(this.shuffle(this.nodesInRelativeHorizontal),this.shuffle(this.nodesInRelativeVertical)),this.nodesInRelativeHorizontal.forEach(function(J){if(!w.fixedNodesOnHorizontal.has(J)){var j=0;w.dummyToNodeForVerticalAlignment.has(J)?j=w.idToNodeMap.get(w.dummyToNodeForVerticalAlignment.get(J)[0]).displacementX:j=w.idToNodeMap.get(J).displacementX,w.nodeToRelativeConstraintMapHorizontal.get(J).forEach(function(Z){if(Z.right){var H=w.nodeToTempPositionMapHorizontal.get(Z.right)-w.nodeToTempPositionMapHorizontal.get(J)-j;H<Z.gap&&(j-=Z.gap-H)}else{var H=w.nodeToTempPositionMapHorizontal.get(J)-w.nodeToTempPositionMapHorizontal.get(Z.left)+j;H<Z.gap&&(j+=Z.gap-H)}}),w.nodeToTempPositionMapHorizontal.set(J,w.nodeToTempPositionMapHorizontal.get(J)+j),w.dummyToNodeForVerticalAlignment.has(J)?w.dummyToNodeForVerticalAlignment.get(J).forEach(function(Z){w.idToNodeMap.get(Z).displacementX=j}):w.idToNodeMap.get(J).displacementX=j}}),this.nodesInRelativeVertical.forEach(function(J){if(!w.fixedNodesOnHorizontal.has(J)){var j=0;w.dummyToNodeForHorizontalAlignment.has(J)?j=w.idToNodeMap.get(w.dummyToNodeForHorizontalAlignment.get(J)[0]).displacementY:j=w.idToNodeMap.get(J).displacementY,w.nodeToRelativeConstraintMapVertical.get(J).forEach(function(Z){if(Z.bottom){var H=w.nodeToTempPositionMapVertical.get(Z.bottom)-w.nodeToTempPositionMapVertical.get(J)-j;H<Z.gap&&(j-=Z.gap-H)}else{var H=w.nodeToTempPositionMapVertical.get(J)-w.nodeToTempPositionMapVertical.get(Z.top)+j;H<Z.gap&&(j+=Z.gap-H)}}),w.nodeToTempPositionMapVertical.set(J,w.nodeToTempPositionMapVertical.get(J)+j),w.dummyToNodeForHorizontalAlignment.has(J)?w.dummyToNodeForHorizontalAlignment.get(J).forEach(function(Z){w.idToNodeMap.get(Z).displacementY=j}):w.idToNodeMap.get(J).displacementY=j}});else{for(var E=0;E<this.componentsOnHorizontal.length;E++){var N=this.componentsOnHorizontal[E];if(this.fixedComponentsOnHorizontal[E])for(var C=0;C<N.length;C++)this.dummyToNodeForVerticalAlignment.has(N[C])?this.dummyToNodeForVerticalAlignment.get(N[C]).forEach(function(Z){w.idToNodeMap.get(Z).displacementX=0}):this.idToNodeMap.get(N[C]).displacementX=0;else{for(var z=0,q=0,C=0;C<N.length;C++)if(this.dummyToNodeForVerticalAlignment.has(N[C])){var $=this.dummyToNodeForVerticalAlignment.get(N[C]);z+=$.length*this.idToNodeMap.get($[0]).displacementX,q+=$.length}else z+=this.idToNodeMap.get(N[C]).displacementX,q++;for(var ee=z/q,C=0;C<N.length;C++)this.dummyToNodeForVerticalAlignment.has(N[C])?this.dummyToNodeForVerticalAlignment.get(N[C]).forEach(function(Z){w.idToNodeMap.get(Z).displacementX=ee}):this.idToNodeMap.get(N[C]).displacementX=ee}}for(var E=0;E<this.componentsOnVertical.length;E++){var N=this.componentsOnVertical[E];if(this.fixedComponentsOnVertical[E])for(var C=0;C<N.length;C++)this.dummyToNodeForHorizontalAlignment.has(N[C])?this.dummyToNodeForHorizontalAlignment.get(N[C]).forEach(function(H){w.idToNodeMap.get(H).displacementY=0}):this.idToNodeMap.get(N[C]).displacementY=0;else{for(var z=0,q=0,C=0;C<N.length;C++)if(this.dummyToNodeForHorizontalAlignment.has(N[C])){var $=this.dummyToNodeForHorizontalAlignment.get(N[C]);z+=$.length*this.idToNodeMap.get($[0]).displacementY,q+=$.length}else z+=this.idToNodeMap.get(N[C]).displacementY,q++;for(var ee=z/q,C=0;C<N.length;C++)this.dummyToNodeForHorizontalAlignment.has(N[C])?this.dummyToNodeForHorizontalAlignment.get(N[C]).forEach(function(W){w.idToNodeMap.get(W).displacementY=ee}):this.idToNodeMap.get(N[C]).displacementY=ee}}}},L.prototype.calculateNodesToApplyGravitationTo=function(){var w=[],_,E=this.graphManager.getGraphs(),x=E.length,C;for(C=0;C<x;C++)_=E[C],_.updateConnected(),_.isConnected||(w=w.concat(_.getNodes()));return w},L.prototype.createBendpoints=function(){var w=[];w=w.concat(this.graphManager.getAllEdges());var _=new Set,E;for(E=0;E<w.length;E++){var x=w[E];if(!_.has(x)){var C=x.getSource(),T=x.getTarget();if(C==T)x.getBendpoints().push(new y),x.getBendpoints().push(new y),this.createDummyNodesForBendpoints(x),_.add(x);else{var M=[];if(M=M.concat(C.getEdgeListToNode(T)),M=M.concat(T.getEdgeListToNode(C)),!_.has(M[0])){if(M.length>1){var D;for(D=0;D<M.length;D++){var F=M[D];F.getBendpoints().push(new y),this.createDummyNodesForBendpoints(F)}}M.forEach(function(N){_.add(N)})}}}if(_.size==w.length)break}},L.prototype.positionNodesRadially=function(w){for(var _=new g(0,0),E=Math.ceil(Math.sqrt(w.length)),x=0,C=0,T=0,M=new y(0,0),D=0;D<w.length;D++){D%E==0&&(T=0,C=x,D!=0&&(C+=f.DEFAULT_COMPONENT_SEPERATION),x=0);var F=w[D],N=S.findCenterOfTree(F);_.x=T,_.y=C,M=L.radialLayout(F,N,_),M.y>x&&(x=Math.floor(M.y)),T=Math.floor(M.x+f.DEFAULT_COMPONENT_SEPERATION)}this.transform(new y(m.WORLD_CENTER_X-M.x/2,m.WORLD_CENTER_Y-M.y/2))},L.radialLayout=function(w,_,E){var x=Math.max(this.maxDiagonalInTree(w),f.DEFAULT_RADIAL_SEPARATION);L.branchRadialLayout(_,null,0,359,0,x);var C=O.calculateBounds(w),T=new I;T.setDeviceOrgX(C.getMinX()),T.setDeviceOrgY(C.getMinY()),T.setWorldOrgX(E.x),T.setWorldOrgY(E.y);for(var M=0;M<w.length;M++){var D=w[M];D.transform(T)}var F=new y(C.getMaxX(),C.getMaxY());return T.inverseTransformPoint(F)},L.branchRadialLayout=function(w,_,E,x,C,T){var M=(x-E+1)/2;M<0&&(M+=180);var D=(M+E)%360,F=D*P.TWO_PI/360,N=Math.cos(F),z=C*Math.cos(F),q=C*Math.sin(F);w.setCenter(z,q);var $=[];$=$.concat(w.getEdges());var ee=$.length;_!=null&&ee--;for(var J=0,j=$.length,Z,H=w.getEdgesBetween(_);H.length>1;){var k=H[0];H.splice(0,1);var G=$.indexOf(k);G>=0&&$.splice(G,1),j--,ee--}_!=null?Z=($.indexOf(H[0])+1)%j:Z=0;for(var W=Math.abs(x-E)/ee,te=Z;J!=ee;te=++te%j){var X=$[te].getOtherEnd(w);if(X!=_){var me=(E+J*W)%360,Te=(me+W)%360;L.branchRadialLayout(X,w,me,Te,C+T,T),J++}}},L.maxDiagonalInTree=function(w){for(var _=A.MIN_VALUE,E=0;E<w.length;E++){var x=w[E],C=x.getDiagonal();C>_&&(_=C)}return _},L.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},L.prototype.groupZeroDegreeMembers=function(){var w=this,_={};this.memberGroups={},this.idToDummyNode={};for(var E=[],x=this.graphManager.getAllNodes(),C=0;C<x.length;C++){var T=x[C],M=T.getParent();this.getNodeDegreeWithChildren(T)===0&&(M.id==null||!this.getToBeTiled(M))&&E.push(T)}for(var C=0;C<E.length;C++){var T=E[C],D=T.getParent().id;typeof _[D]>"u"&&(_[D]=[]),_[D]=_[D].concat(T)}Object.keys(_).forEach(function(F){if(_[F].length>1){var N="DummyCompound_"+F;w.memberGroups[N]=_[F];var z=_[F][0].getParent(),q=new d(w.graphManager);q.id=N,q.paddingLeft=z.paddingLeft||0,q.paddingRight=z.paddingRight||0,q.paddingBottom=z.paddingBottom||0,q.paddingTop=z.paddingTop||0,w.idToDummyNode[N]=q;var $=w.getGraphManager().add(w.newGraph(),q),ee=z.getChild();ee.add(q);for(var J=0;J<_[F].length;J++){var j=_[F][J];ee.remove(j),$.add(j)}}})},L.prototype.clearCompounds=function(){var w={},_={};this.performDFSOnCompounds();for(var E=0;E<this.compoundOrder.length;E++)_[this.compoundOrder[E].id]=this.compoundOrder[E],w[this.compoundOrder[E].id]=[].concat(this.compoundOrder[E].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[E].getChild()),this.compoundOrder[E].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(w,_)},L.prototype.clearZeroDegreeMembers=function(){var w=this,_=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(E){var x=w.idToDummyNode[E];if(_[E]=w.tileNodes(w.memberGroups[E],x.paddingLeft+x.paddingRight),x.rect.width=_[E].width,x.rect.height=_[E].height,x.setCenter(_[E].centerX,_[E].centerY),x.labelMarginLeft=0,x.labelMarginTop=0,f.NODE_DIMENSIONS_INCLUDE_LABELS){var C=x.rect.width,T=x.rect.height;x.labelWidth&&(x.labelPosHorizontal=="left"?(x.rect.x-=x.labelWidth,x.setWidth(C+x.labelWidth),x.labelMarginLeft=x.labelWidth):x.labelPosHorizontal=="center"&&x.labelWidth>C?(x.rect.x-=(x.labelWidth-C)/2,x.setWidth(x.labelWidth),x.labelMarginLeft=(x.labelWidth-C)/2):x.labelPosHorizontal=="right"&&x.setWidth(C+x.labelWidth)),x.labelHeight&&(x.labelPosVertical=="top"?(x.rect.y-=x.labelHeight,x.setHeight(T+x.labelHeight),x.labelMarginTop=x.labelHeight):x.labelPosVertical=="center"&&x.labelHeight>T?(x.rect.y-=(x.labelHeight-T)/2,x.setHeight(x.labelHeight),x.labelMarginTop=(x.labelHeight-T)/2):x.labelPosVertical=="bottom"&&x.setHeight(T+x.labelHeight))}})},L.prototype.repopulateCompounds=function(){for(var w=this.compoundOrder.length-1;w>=0;w--){var _=this.compoundOrder[w],E=_.id,x=_.paddingLeft,C=_.paddingTop,T=_.labelMarginLeft,M=_.labelMarginTop;this.adjustLocations(this.tiledMemberPack[E],_.rect.x,_.rect.y,x,C,T,M)}},L.prototype.repopulateZeroDegreeMembers=function(){var w=this,_=this.tiledZeroDegreePack;Object.keys(_).forEach(function(E){var x=w.idToDummyNode[E],C=x.paddingLeft,T=x.paddingTop,M=x.labelMarginLeft,D=x.labelMarginTop;w.adjustLocations(_[E],x.rect.x,x.rect.y,C,T,M,D)})},L.prototype.getToBeTiled=function(w){var _=w.id;if(this.toBeTiled[_]!=null)return this.toBeTiled[_];var E=w.getChild();if(E==null)return this.toBeTiled[_]=!1,!1;for(var x=E.getNodes(),C=0;C<x.length;C++){var T=x[C];if(this.getNodeDegree(T)>0)return this.toBeTiled[_]=!1,!1;if(T.getChild()==null){this.toBeTiled[T.id]=!1;continue}if(!this.getToBeTiled(T))return this.toBeTiled[_]=!1,!1}return this.toBeTiled[_]=!0,!0},L.prototype.getNodeDegree=function(w){for(var _=w.id,E=w.getEdges(),x=0,C=0;C<E.length;C++){var T=E[C];T.getSource().id!==T.getTarget().id&&(x=x+1)}return x},L.prototype.getNodeDegreeWithChildren=function(w){var _=this.getNodeDegree(w);if(w.getChild()==null)return _;for(var E=w.getChild().getNodes(),x=0;x<E.length;x++){var C=E[x];_+=this.getNodeDegreeWithChildren(C)}return _},L.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},L.prototype.fillCompexOrderByDFS=function(w){for(var _=0;_<w.length;_++){var E=w[_];E.getChild()!=null&&this.fillCompexOrderByDFS(E.getChild().getNodes()),this.getToBeTiled(E)&&this.compoundOrder.push(E)}},L.prototype.adjustLocations=function(w,_,E,x,C,T,M){_+=x+T,E+=C+M;for(var D=_,F=0;F<w.rows.length;F++){var N=w.rows[F];_=D;for(var z=0,q=0;q<N.length;q++){var $=N[q];$.rect.x=_,$.rect.y=E,_+=$.rect.width+w.horizontalPadding,$.rect.height>z&&(z=$.rect.height)}E+=z+w.verticalPadding}},L.prototype.tileCompoundMembers=function(w,_){var E=this;this.tiledMemberPack=[],Object.keys(w).forEach(function(x){var C=_[x];if(E.tiledMemberPack[x]=E.tileNodes(w[x],C.paddingLeft+C.paddingRight),C.rect.width=E.tiledMemberPack[x].width,C.rect.height=E.tiledMemberPack[x].height,C.setCenter(E.tiledMemberPack[x].centerX,E.tiledMemberPack[x].centerY),C.labelMarginLeft=0,C.labelMarginTop=0,f.NODE_DIMENSIONS_INCLUDE_LABELS){var T=C.rect.width,M=C.rect.height;C.labelWidth&&(C.labelPosHorizontal=="left"?(C.rect.x-=C.labelWidth,C.setWidth(T+C.labelWidth),C.labelMarginLeft=C.labelWidth):C.labelPosHorizontal=="center"&&C.labelWidth>T?(C.rect.x-=(C.labelWidth-T)/2,C.setWidth(C.labelWidth),C.labelMarginLeft=(C.labelWidth-T)/2):C.labelPosHorizontal=="right"&&C.setWidth(T+C.labelWidth)),C.labelHeight&&(C.labelPosVertical=="top"?(C.rect.y-=C.labelHeight,C.setHeight(M+C.labelHeight),C.labelMarginTop=C.labelHeight):C.labelPosVertical=="center"&&C.labelHeight>M?(C.rect.y-=(C.labelHeight-M)/2,C.setHeight(C.labelHeight),C.labelMarginTop=(C.labelHeight-M)/2):C.labelPosVertical=="bottom"&&C.setHeight(M+C.labelHeight))}})},L.prototype.tileNodes=function(w,_){var E=this.tileNodesByFavoringDim(w,_,!0),x=this.tileNodesByFavoringDim(w,_,!1),C=this.getOrgRatio(E),T=this.getOrgRatio(x),M;return T<C?M=x:M=E,M},L.prototype.getOrgRatio=function(w){var _=w.width,E=w.height,x=_/E;return x<1&&(x=1/x),x},L.prototype.calcIdealRowWidth=function(w,_){var E=f.TILING_PADDING_VERTICAL,x=f.TILING_PADDING_HORIZONTAL,C=w.length,T=0,M=0,D=0;w.forEach(function(J){T+=J.getWidth(),M+=J.getHeight(),J.getWidth()>D&&(D=J.getWidth())});var F=T/C,N=M/C,z=Math.pow(E-x,2)+4*(F+x)*(N+E)*C,q=(x-E+Math.sqrt(z))/(2*(F+x)),$;_?($=Math.ceil(q),$==q&&$++):$=Math.floor(q);var ee=$*(F+x)-x;return D>ee&&(ee=D),ee+=x*2,ee},L.prototype.tileNodesByFavoringDim=function(w,_,E){var x=f.TILING_PADDING_VERTICAL,C=f.TILING_PADDING_HORIZONTAL,T=f.TILING_COMPARE_BY,M={rows:[],rowWidth:[],rowHeight:[],width:0,height:_,verticalPadding:x,horizontalPadding:C,centerX:0,centerY:0};T&&(M.idealRowWidth=this.calcIdealRowWidth(w,E));var D=function(j){return j.rect.width*j.rect.height},F=function(j,Z){return D(Z)-D(j)};w.sort(function(J,j){var Z=F;return M.idealRowWidth?(Z=T,Z(J.id,j.id)):Z(J,j)});for(var N=0,z=0,q=0;q<w.length;q++){var $=w[q];N+=$.getCenterX(),z+=$.getCenterY()}M.centerX=N/w.length,M.centerY=z/w.length;for(var q=0;q<w.length;q++){var $=w[q];if(M.rows.length==0)this.insertNodeToRow(M,$,0,_);else if(this.canAddHorizontal(M,$.rect.width,$.rect.height)){var ee=M.rows.length-1;M.idealRowWidth||(ee=this.getShortestRowIndex(M)),this.insertNodeToRow(M,$,ee,_)}else this.insertNodeToRow(M,$,M.rows.length,_);this.shiftToLastRow(M)}return M},L.prototype.insertNodeToRow=function(w,_,E,x){var C=x;if(E==w.rows.length){var T=[];w.rows.push(T),w.rowWidth.push(C),w.rowHeight.push(0)}var M=w.rowWidth[E]+_.rect.width;w.rows[E].length>0&&(M+=w.horizontalPadding),w.rowWidth[E]=M,w.width<M&&(w.width=M);var D=_.rect.height;E>0&&(D+=w.verticalPadding);var F=0;D>w.rowHeight[E]&&(F=w.rowHeight[E],w.rowHeight[E]=D,F=w.rowHeight[E]-F),w.height+=F,w.rows[E].push(_)},L.prototype.getShortestRowIndex=function(w){for(var _=-1,E=Number.MAX_VALUE,x=0;x<w.rows.length;x++)w.rowWidth[x]<E&&(_=x,E=w.rowWidth[x]);return _},L.prototype.getLongestRowIndex=function(w){for(var _=-1,E=Number.MIN_VALUE,x=0;x<w.rows.length;x++)w.rowWidth[x]>E&&(_=x,E=w.rowWidth[x]);return _},L.prototype.canAddHorizontal=function(w,_,E){if(w.idealRowWidth){var x=w.rows.length-1,C=w.rowWidth[x];return C+_+w.horizontalPadding<=w.idealRowWidth}var T=this.getShortestRowIndex(w);if(T<0)return!0;var M=w.rowWidth[T];if(M+w.horizontalPadding+_<=w.width)return!0;var D=0;w.rowHeight[T]<E&&T>0&&(D=E+w.verticalPadding-w.rowHeight[T]);var F;w.width-M>=_+w.horizontalPadding?F=(w.height+D)/(M+_+w.horizontalPadding):F=(w.height+D)/w.width,D=E+w.verticalPadding;var N;return w.width<_?N=(w.height+D)/_:N=(w.height+D)/w.width,N<1&&(N=1/N),F<1&&(F=1/F),F<N},L.prototype.shiftToLastRow=function(w){var _=this.getLongestRowIndex(w),E=w.rowWidth.length-1,x=w.rows[_],C=x[x.length-1],T=C.width+w.horizontalPadding;if(w.width-w.rowWidth[E]>T&&_!=E){x.splice(-1,1),w.rows[E].push(C),w.rowWidth[_]=w.rowWidth[_]-T,w.rowWidth[E]=w.rowWidth[E]+T,w.width=w.rowWidth[instance.getLongestRowIndex(w)];for(var M=Number.MIN_VALUE,D=0;D<x.length;D++)x[D].height>M&&(M=x[D].height);_>0&&(M+=w.verticalPadding);var F=w.rowHeight[_]+w.rowHeight[E];w.rowHeight[_]=M,w.rowHeight[E]<C.height+w.verticalPadding&&(w.rowHeight[E]=C.height+w.verticalPadding);var N=w.rowHeight[_]+w.rowHeight[E];w.height+=N-F,this.shiftToLastRow(w)}},L.prototype.tilingPreLayout=function(){f.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},L.prototype.tilingPostLayout=function(){f.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},L.prototype.reduceTrees=function(){for(var w=[],_=!0,E;_;){var x=this.graphManager.getAllNodes(),C=[];_=!1;for(var T=0;T<x.length;T++)if(E=x[T],E.getEdges().length==1&&!E.getEdges()[0].isInterGraph&&E.getChild()==null){if(f.PURE_INCREMENTAL){var M=E.getEdges()[0].getOtherEnd(E),D=new b(E.getCenterX()-M.getCenterX(),E.getCenterY()-M.getCenterY());C.push([E,E.getEdges()[0],E.getOwner(),D])}else C.push([E,E.getEdges()[0],E.getOwner()]);_=!0}if(_==!0){for(var F=[],N=0;N<C.length;N++)C[N][0].getEdges().length==1&&(F.push(C[N]),C[N][0].getOwner().remove(C[N][0]));w.push(F),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=w},L.prototype.growTree=function(w){for(var _=w.length,E=w[_-1],x,C=0;C<E.length;C++)x=E[C],this.findPlaceforPrunedNode(x),x[2].add(x[0]),x[2].add(x[1],x[1].source,x[1].target);w.splice(w.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},L.prototype.findPlaceforPrunedNode=function(w){var _,E,x=w[0];if(x==w[1].source?E=w[1].target:E=w[1].source,f.PURE_INCREMENTAL)x.setCenter(E.getCenterX()+w[3].getWidth(),E.getCenterY()+w[3].getHeight());else{var C=E.startX,T=E.finishX,M=E.startY,D=E.finishY,F=0,N=0,z=0,q=0,$=[F,z,N,q];if(M>0)for(var ee=C;ee<=T;ee++)$[0]+=this.grid[ee][M-1].length+this.grid[ee][M].length-1;if(T<this.grid.length-1)for(var ee=M;ee<=D;ee++)$[1]+=this.grid[T+1][ee].length+this.grid[T][ee].length-1;if(D<this.grid[0].length-1)for(var ee=C;ee<=T;ee++)$[2]+=this.grid[ee][D+1].length+this.grid[ee][D].length-1;if(C>0)for(var ee=M;ee<=D;ee++)$[3]+=this.grid[C-1][ee].length+this.grid[C][ee].length-1;for(var J=A.MAX_VALUE,j,Z,H=0;H<$.length;H++)$[H]<J?(J=$[H],j=1,Z=H):$[H]==J&&j++;if(j==3&&J==0)$[0]==0&&$[1]==0&&$[2]==0?_=1:$[0]==0&&$[1]==0&&$[3]==0?_=0:$[0]==0&&$[2]==0&&$[3]==0?_=3:$[1]==0&&$[2]==0&&$[3]==0&&(_=2);else if(j==2&&J==0){var k=Math.floor(Math.random()*2);$[0]==0&&$[1]==0?k==0?_=0:_=1:$[0]==0&&$[2]==0?k==0?_=0:_=2:$[0]==0&&$[3]==0?k==0?_=0:_=3:$[1]==0&&$[2]==0?k==0?_=1:_=2:$[1]==0&&$[3]==0?k==0?_=1:_=3:k==0?_=2:_=3}else if(j==4&&J==0){var k=Math.floor(Math.random()*4);_=k}else _=Z;_==0?x.setCenter(E.getCenterX(),E.getCenterY()-E.getHeight()/2-p.DEFAULT_EDGE_LENGTH-x.getHeight()/2):_==1?x.setCenter(E.getCenterX()+E.getWidth()/2+p.DEFAULT_EDGE_LENGTH+x.getWidth()/2,E.getCenterY()):_==2?x.setCenter(E.getCenterX(),E.getCenterY()+E.getHeight()/2+p.DEFAULT_EDGE_LENGTH+x.getHeight()/2):x.setCenter(E.getCenterX()-E.getWidth()/2-p.DEFAULT_EDGE_LENGTH-x.getWidth()/2,E.getCenterY())}},a.exports=L},991:(a,o,s)=>{var u=s(551).FDLayoutNode,l=s(551).IMath;function c(h,f,v,p){u.call(this,h,f,v,p)}c.prototype=Object.create(u.prototype);for(var d in u)c[d]=u[d];c.prototype.calculateDisplacement=function(){var h=this.graphManager.getLayout();this.getChild()!=null&&this.fixedNodeWeight?(this.displacementX+=h.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.fixedNodeWeight,this.displacementY+=h.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.fixedNodeWeight):(this.displacementX+=h.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY+=h.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren),Math.abs(this.displacementX)>h.coolingFactor*h.maxNodeDisplacement&&(this.displacementX=h.coolingFactor*h.maxNodeDisplacement*l.sign(this.displacementX)),Math.abs(this.displacementY)>h.coolingFactor*h.maxNodeDisplacement&&(this.displacementY=h.coolingFactor*h.maxNodeDisplacement*l.sign(this.displacementY)),this.child&&this.child.getNodes().length>0&&this.propogateDisplacementToChildren(this.displacementX,this.displacementY)},c.prototype.propogateDisplacementToChildren=function(h,f){for(var v=this.getChild().getNodes(),p,m=0;m<v.length;m++)p=v[m],p.getChild()==null?(p.displacementX+=h,p.displacementY+=f):p.propogateDisplacementToChildren(h,f)},c.prototype.move=function(){var h=this.graphManager.getLayout();(this.child==null||this.child.getNodes().length==0)&&(this.moveBy(this.displacementX,this.displacementY),h.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},c.prototype.setPred1=function(h){this.pred1=h},c.prototype.getPred1=function(){return pred1},c.prototype.getPred2=function(){return pred2},c.prototype.setNext=function(h){this.next=h},c.prototype.getNext=function(){return next},c.prototype.setProcessed=function(h){this.processed=h},c.prototype.isProcessed=function(){return processed},a.exports=c},902:(a,o,s)=>{function u(v){if(Array.isArray(v)){for(var p=0,m=Array(v.length);p<v.length;p++)m[p]=v[p];return m}else return Array.from(v)}var l=s(806),c=s(551).LinkedList,d=s(551).Matrix,h=s(551).SVD;function f(){}f.handleConstraints=function(v){var p={};p.fixedNodeConstraint=v.constraints.fixedNodeConstraint,p.alignmentConstraint=v.constraints.alignmentConstraint,p.relativePlacementConstraint=v.constraints.relativePlacementConstraint;for(var m=new Map,g=new Map,y=[],b=[],S=v.getAllNodes(),A=0,P=0;P<S.length;P++){var O=S[P];O.getChild()==null&&(g.set(O.id,A++),y.push(O.getCenterX()),b.push(O.getCenterY()),m.set(O.id,O))}p.relativePlacementConstraint&&p.relativePlacementConstraint.forEach(function(Y){!Y.gap&&Y.gap!=0&&(Y.left?Y.gap=l.DEFAULT_EDGE_LENGTH+m.get(Y.left).getWidth()/2+m.get(Y.right).getWidth()/2:Y.gap=l.DEFAULT_EDGE_LENGTH+m.get(Y.top).getHeight()/2+m.get(Y.bottom).getHeight()/2)});var I=function(Q,oe){return{x:Q.x-oe.x,y:Q.y-oe.y}},R=function(Q){var oe=0,ne=0;return Q.forEach(function(se){oe+=y[g.get(se)],ne+=b[g.get(se)]}),{x:oe/Q.size,y:ne/Q.size}},L=function(Q,oe,ne,se,ve){function Re(ze,Le){var He=new Set(ze),Be=!0,Ge=!1,it=void 0;try{for(var at=Le[Symbol.iterator](),mt;!(Be=(mt=at.next()).done);Be=!0){var et=mt.value;He.add(et)}}catch(Ze){Ge=!0,it=Ze}finally{try{!Be&&at.return&&at.return()}finally{if(Ge)throw it}}return He}var we=new Map;Q.forEach(function(ze,Le){we.set(Le,0)}),Q.forEach(function(ze,Le){ze.forEach(function(He){we.set(He.id,we.get(He.id)+1)})});var pe=new Map,Me=new Map,Ae=new c;we.forEach(function(ze,Le){ze==0?(Ae.push(Le),ne||(oe=="horizontal"?pe.set(Le,g.has(Le)?y[g.get(Le)]:se.get(Le)):pe.set(Le,g.has(Le)?b[g.get(Le)]:se.get(Le)))):pe.set(Le,Number.NEGATIVE_INFINITY),ne&&Me.set(Le,new Set([Le]))}),ne&&ve.forEach(function(ze){var Le=[];if(ze.forEach(function(Ge){ne.has(Ge)&&Le.push(Ge)}),Le.length>0){var He=0;Le.forEach(function(Ge){oe=="horizontal"?(pe.set(Ge,g.has(Ge)?y[g.get(Ge)]:se.get(Ge)),He+=pe.get(Ge)):(pe.set(Ge,g.has(Ge)?b[g.get(Ge)]:se.get(Ge)),He+=pe.get(Ge))}),He=He/Le.length,ze.forEach(function(Ge){ne.has(Ge)||pe.set(Ge,He)})}else{var Be=0;ze.forEach(function(Ge){oe=="horizontal"?Be+=g.has(Ge)?y[g.get(Ge)]:se.get(Ge):Be+=g.has(Ge)?b[g.get(Ge)]:se.get(Ge)}),Be=Be/ze.length,ze.forEach(function(Ge){pe.set(Ge,Be)})}});for(var Ie=function(){var Le=Ae.shift(),He=Q.get(Le);He.forEach(function(Be){if(pe.get(Be.id)<pe.get(Le)+Be.gap)if(ne&&ne.has(Be.id)){var Ge=void 0;if(oe=="horizontal"?Ge=g.has(Be.id)?y[g.get(Be.id)]:se.get(Be.id):Ge=g.has(Be.id)?b[g.get(Be.id)]:se.get(Be.id),pe.set(Be.id,Ge),Ge<pe.get(Le)+Be.gap){var it=pe.get(Le)+Be.gap-Ge;Me.get(Le).forEach(function(at){pe.set(at,pe.get(at)-it)})}}else pe.set(Be.id,pe.get(Le)+Be.gap);we.set(Be.id,we.get(Be.id)-1),we.get(Be.id)==0&&Ae.push(Be.id),ne&&Me.set(Be.id,Re(Me.get(Le),Me.get(Be.id)))})};Ae.length!=0;)Ie();if(ne){var Ve=new Set;Q.forEach(function(ze,Le){ze.length==0&&Ve.add(Le)});var Ke=[];Me.forEach(function(ze,Le){if(Ve.has(Le)){var He=!1,Be=!0,Ge=!1,it=void 0;try{for(var at=ze[Symbol.iterator](),mt;!(Be=(mt=at.next()).done);Be=!0){var et=mt.value;ne.has(et)&&(He=!0)}}catch(Je){Ge=!0,it=Je}finally{try{!Be&&at.return&&at.return()}finally{if(Ge)throw it}}if(!He){var Ze=!1,It=void 0;Ke.forEach(function(Je,st){Je.has([].concat(u(ze))[0])&&(Ze=!0,It=st)}),Ze?ze.forEach(function(Je){Ke[It].add(Je)}):Ke.push(new Set(ze))}}}),Ke.forEach(function(ze,Le){var He=Number.POSITIVE_INFINITY,Be=Number.POSITIVE_INFINITY,Ge=Number.NEGATIVE_INFINITY,it=Number.NEGATIVE_INFINITY,at=!0,mt=!1,et=void 0;try{for(var Ze=ze[Symbol.iterator](),It;!(at=(It=Ze.next()).done);at=!0){var Je=It.value,st=void 0;oe=="horizontal"?st=g.has(Je)?y[g.get(Je)]:se.get(Je):st=g.has(Je)?b[g.get(Je)]:se.get(Je);var pt=pe.get(Je);st<He&&(He=st),st>Ge&&(Ge=st),pt<Be&&(Be=pt),pt>it&&(it=pt)}}catch(bn){mt=!0,et=bn}finally{try{!at&&Ze.return&&Ze.return()}finally{if(mt)throw et}}var yn=(He+Ge)/2-(Be+it)/2,Ht=!0,ln=!1,Cn=void 0;try{for(var un=ze[Symbol.iterator](),Ci;!(Ht=(Ci=un.next()).done);Ht=!0){var wn=Ci.value;pe.set(wn,pe.get(wn)+yn)}}catch(bn){ln=!0,Cn=bn}finally{try{!Ht&&un.return&&un.return()}finally{if(ln)throw Cn}}})}return pe},B=function(Q){var oe=0,ne=0,se=0,ve=0;if(Q.forEach(function(Me){Me.left?y[g.get(Me.left)]-y[g.get(Me.right)]>=0?oe++:ne++:b[g.get(Me.top)]-b[g.get(Me.bottom)]>=0?se++:ve++}),oe>ne&&se>ve)for(var Re=0;Re<g.size;Re++)y[Re]=-1*y[Re],b[Re]=-1*b[Re];else if(oe>ne)for(var we=0;we<g.size;we++)y[we]=-1*y[we];else if(se>ve)for(var pe=0;pe<g.size;pe++)b[pe]=-1*b[pe]},w=function(Q){var oe=[],ne=new c,se=new Set,ve=0;return Q.forEach(function(Re,we){if(!se.has(we)){oe[ve]=[];var pe=we;for(ne.push(pe),se.add(pe),oe[ve].push(pe);ne.length!=0;){pe=ne.shift();var Me=Q.get(pe);Me.forEach(function(Ae){se.has(Ae.id)||(ne.push(Ae.id),se.add(Ae.id),oe[ve].push(Ae.id))})}ve++}}),oe},_=function(Q){var oe=new Map;return Q.forEach(function(ne,se){oe.set(se,[])}),Q.forEach(function(ne,se){ne.forEach(function(ve){oe.get(se).push(ve),oe.get(ve.id).push({id:se,gap:ve.gap,direction:ve.direction})})}),oe},E=function(Q){var oe=new Map;return Q.forEach(function(ne,se){oe.set(se,[])}),Q.forEach(function(ne,se){ne.forEach(function(ve){oe.get(ve.id).push({id:se,gap:ve.gap,direction:ve.direction})})}),oe},x=[],C=[],T=!1,M=!1,D=new Set,F=new Map,N=new Map,z=[];if(p.fixedNodeConstraint&&p.fixedNodeConstraint.forEach(function(Y){D.add(Y.nodeId)}),p.relativePlacementConstraint&&(p.relativePlacementConstraint.forEach(function(Y){Y.left?(F.has(Y.left)?F.get(Y.left).push({id:Y.right,gap:Y.gap,direction:"horizontal"}):F.set(Y.left,[{id:Y.right,gap:Y.gap,direction:"horizontal"}]),F.has(Y.right)||F.set(Y.right,[])):(F.has(Y.top)?F.get(Y.top).push({id:Y.bottom,gap:Y.gap,direction:"vertical"}):F.set(Y.top,[{id:Y.bottom,gap:Y.gap,direction:"vertical"}]),F.has(Y.bottom)||F.set(Y.bottom,[]))}),N=_(F),z=w(N)),l.TRANSFORM_ON_CONSTRAINT_HANDLING){if(p.fixedNodeConstraint&&p.fixedNodeConstraint.length>1)p.fixedNodeConstraint.forEach(function(Y,Q){x[Q]=[Y.position.x,Y.position.y],C[Q]=[y[g.get(Y.nodeId)],b[g.get(Y.nodeId)]]}),T=!0;else if(p.alignmentConstraint)(function(){var Y=0;if(p.alignmentConstraint.vertical){for(var Q=p.alignmentConstraint.vertical,oe=function(pe){var Me=new Set;Q[pe].forEach(function(Ve){Me.add(Ve)});var Ae=new Set([].concat(u(Me)).filter(function(Ve){return D.has(Ve)})),Ie=void 0;Ae.size>0?Ie=y[g.get(Ae.values().next().value)]:Ie=R(Me).x,Q[pe].forEach(function(Ve){x[Y]=[Ie,b[g.get(Ve)]],C[Y]=[y[g.get(Ve)],b[g.get(Ve)]],Y++})},ne=0;ne<Q.length;ne++)oe(ne);T=!0}if(p.alignmentConstraint.horizontal){for(var se=p.alignmentConstraint.horizontal,ve=function(pe){var Me=new Set;se[pe].forEach(function(Ve){Me.add(Ve)});var Ae=new Set([].concat(u(Me)).filter(function(Ve){return D.has(Ve)})),Ie=void 0;Ae.size>0?Ie=y[g.get(Ae.values().next().value)]:Ie=R(Me).y,se[pe].forEach(function(Ve){x[Y]=[y[g.get(Ve)],Ie],C[Y]=[y[g.get(Ve)],b[g.get(Ve)]],Y++})},Re=0;Re<se.length;Re++)ve(Re);T=!0}p.relativePlacementConstraint&&(M=!0)})();else if(p.relativePlacementConstraint){for(var q=0,$=0,ee=0;ee<z.length;ee++)z[ee].length>q&&(q=z[ee].length,$=ee);if(q<N.size/2)B(p.relativePlacementConstraint),T=!1,M=!1;else{var J=new Map,j=new Map,Z=[];z[$].forEach(function(Y){F.get(Y).forEach(function(Q){Q.direction=="horizontal"?(J.has(Y)?J.get(Y).push(Q):J.set(Y,[Q]),J.has(Q.id)||J.set(Q.id,[]),Z.push({left:Y,right:Q.id})):(j.has(Y)?j.get(Y).push(Q):j.set(Y,[Q]),j.has(Q.id)||j.set(Q.id,[]),Z.push({top:Y,bottom:Q.id}))})}),B(Z),M=!1;var H=L(J,"horizontal"),k=L(j,"vertical");z[$].forEach(function(Y,Q){C[Q]=[y[g.get(Y)],b[g.get(Y)]],x[Q]=[],H.has(Y)?x[Q][0]=H.get(Y):x[Q][0]=y[g.get(Y)],k.has(Y)?x[Q][1]=k.get(Y):x[Q][1]=b[g.get(Y)]}),T=!0}}if(T){for(var G=void 0,W=d.transpose(x),te=d.transpose(C),X=0;X<W.length;X++)W[X]=d.multGamma(W[X]),te[X]=d.multGamma(te[X]);var me=d.multMat(W,d.transpose(te)),Te=h.svd(me);G=d.multMat(Te.V,d.transpose(Te.U));for(var fe=0;fe<g.size;fe++){var ue=[y[fe],b[fe]],de=[G[0][0],G[1][0]],ye=[G[0][1],G[1][1]];y[fe]=d.dotProduct(ue,de),b[fe]=d.dotProduct(ue,ye)}M&&B(p.relativePlacementConstraint)}}if(l.ENFORCE_CONSTRAINTS){if(p.fixedNodeConstraint&&p.fixedNodeConstraint.length>0){var Se={x:0,y:0};p.fixedNodeConstraint.forEach(function(Y,Q){var oe={x:y[g.get(Y.nodeId)],y:b[g.get(Y.nodeId)]},ne=Y.position,se=I(ne,oe);Se.x+=se.x,Se.y+=se.y}),Se.x/=p.fixedNodeConstraint.length,Se.y/=p.fixedNodeConstraint.length,y.forEach(function(Y,Q){y[Q]+=Se.x}),b.forEach(function(Y,Q){b[Q]+=Se.y}),p.fixedNodeConstraint.forEach(function(Y){y[g.get(Y.nodeId)]=Y.position.x,b[g.get(Y.nodeId)]=Y.position.y})}if(p.alignmentConstraint){if(p.alignmentConstraint.vertical)for(var xe=p.alignmentConstraint.vertical,Ce=function(Q){var oe=new Set;xe[Q].forEach(function(ve){oe.add(ve)});var ne=new Set([].concat(u(oe)).filter(function(ve){return D.has(ve)})),se=void 0;ne.size>0?se=y[g.get(ne.values().next().value)]:se=R(oe).x,oe.forEach(function(ve){D.has(ve)||(y[g.get(ve)]=se)})},_e=0;_e<xe.length;_e++)Ce(_e);if(p.alignmentConstraint.horizontal)for(var be=p.alignmentConstraint.horizontal,he=function(Q){var oe=new Set;be[Q].forEach(function(ve){oe.add(ve)});var ne=new Set([].concat(u(oe)).filter(function(ve){return D.has(ve)})),se=void 0;ne.size>0?se=b[g.get(ne.values().next().value)]:se=R(oe).y,oe.forEach(function(ve){D.has(ve)||(b[g.get(ve)]=se)})},V=0;V<be.length;V++)he(V)}p.relativePlacementConstraint&&function(){var Y=new Map,Q=new Map,oe=new Map,ne=new Map,se=new Map,ve=new Map,Re=new Set,we=new Set;if(D.forEach(function(Nt){Re.add(Nt),we.add(Nt)}),p.alignmentConstraint){if(p.alignmentConstraint.vertical)for(var pe=p.alignmentConstraint.vertical,Me=function(Xe){oe.set("dummy"+Xe,[]),pe[Xe].forEach(function(Qe){Y.set(Qe,"dummy"+Xe),oe.get("dummy"+Xe).push(Qe),D.has(Qe)&&Re.add("dummy"+Xe)}),se.set("dummy"+Xe,y[g.get(pe[Xe][0])])},Ae=0;Ae<pe.length;Ae++)Me(Ae);if(p.alignmentConstraint.horizontal)for(var Ie=p.alignmentConstraint.horizontal,Ve=function(Xe){ne.set("dummy"+Xe,[]),Ie[Xe].forEach(function(Qe){Q.set(Qe,"dummy"+Xe),ne.get("dummy"+Xe).push(Qe),D.has(Qe)&&we.add("dummy"+Xe)}),ve.set("dummy"+Xe,b[g.get(Ie[Xe][0])])},Ke=0;Ke<Ie.length;Ke++)Ve(Ke)}var ze=new Map,Le=new Map,He=function(Xe){F.get(Xe).forEach(function(Qe){var Yr=void 0,Dr=void 0;Qe.direction=="horizontal"?(Yr=Y.get(Xe)?Y.get(Xe):Xe,Y.get(Qe.id)?Dr={id:Y.get(Qe.id),gap:Qe.gap,direction:Qe.direction}:Dr=Qe,ze.has(Yr)?ze.get(Yr).push(Dr):ze.set(Yr,[Dr]),ze.has(Dr.id)||ze.set(Dr.id,[])):(Yr=Q.get(Xe)?Q.get(Xe):Xe,Q.get(Qe.id)?Dr={id:Q.get(Qe.id),gap:Qe.gap,direction:Qe.direction}:Dr=Qe,Le.has(Yr)?Le.get(Yr).push(Dr):Le.set(Yr,[Dr]),Le.has(Dr.id)||Le.set(Dr.id,[]))})},Be=!0,Ge=!1,it=void 0;try{for(var at=F.keys()[Symbol.iterator](),mt;!(Be=(mt=at.next()).done);Be=!0){var et=mt.value;He(et)}}catch(Nt){Ge=!0,it=Nt}finally{try{!Be&&at.return&&at.return()}finally{if(Ge)throw it}}var Ze=_(ze),It=_(Le),Je=w(Ze),st=w(It),pt=E(ze),yn=E(Le),Ht=[],ln=[];Je.forEach(function(Nt,Xe){Ht[Xe]=[],Nt.forEach(function(Qe){pt.get(Qe).length==0&&Ht[Xe].push(Qe)})}),st.forEach(function(Nt,Xe){ln[Xe]=[],Nt.forEach(function(Qe){yn.get(Qe).length==0&&ln[Xe].push(Qe)})});var Cn=L(ze,"horizontal",Re,se,Ht),un=L(Le,"vertical",we,ve,ln),Ci=function(Xe){oe.get(Xe)?oe.get(Xe).forEach(function(Qe){y[g.get(Qe)]=Cn.get(Xe)}):y[g.get(Xe)]=Cn.get(Xe)},wn=!0,bn=!1,bo=void 0;try{for(var ya=Cn.keys()[Symbol.iterator](),xn;!(wn=(xn=ya.next()).done);wn=!0){var Zn=xn.value;Ci(Zn)}}catch(Nt){bn=!0,bo=Nt}finally{try{!wn&&ya.return&&ya.return()}finally{if(bn)throw bo}}var wi=function(Xe){ne.get(Xe)?ne.get(Xe).forEach(function(Qe){b[g.get(Qe)]=un.get(Xe)}):b[g.get(Xe)]=un.get(Xe)},bi=!0,Ca=!1,xo=void 0;try{for(var vr=un.keys()[Symbol.iterator](),xi;!(bi=(xi=vr.next()).done);bi=!0){var Zn=xi.value;wi(Zn)}}catch(Nt){Ca=!0,xo=Nt}finally{try{!bi&&vr.return&&vr.return()}finally{if(Ca)throw xo}}}()}for(var re=0;re<S.length;re++){var le=S[re];le.getChild()==null&&le.setCenter(y[g.get(le.id)],b[g.get(le.id)])}},a.exports=f},551:a=>{a.exports=r}},t={};function n(a){var o=t[a];if(o!==void 0)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}var i=n(45);return i})()})});var lp=wa((wo,hc)=>{"use strict";(function(e,t){typeof wo=="object"&&typeof hc=="object"?hc.exports=t(dc()):typeof define=="function"&&define.amd?define(["cose-base"],t):typeof wo=="object"?wo.cytoscapeFcose=t(dc()):e.cytoscapeFcose=t(e.coseBase)})(wo,function(r){return(()=>{"use strict";var e={658:a=>{a.exports=Object.assign!=null?Object.assign.bind(Object):function(o){for(var s=arguments.length,u=Array(s>1?s-1:0),l=1;l<s;l++)u[l-1]=arguments[l];return u.forEach(function(c){Object.keys(c).forEach(function(d){return o[d]=c[d]})}),o}},548:(a,o,s)=>{var u=function(){function d(h,f){var v=[],p=!0,m=!1,g=void 0;try{for(var y=h[Symbol.iterator](),b;!(p=(b=y.next()).done)&&(v.push(b.value),!(f&&v.length===f));p=!0);}catch(S){m=!0,g=S}finally{try{!p&&y.return&&y.return()}finally{if(m)throw g}}return v}return function(h,f){if(Array.isArray(h))return h;if(Symbol.iterator in Object(h))return d(h,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=s(140).layoutBase.LinkedList,c={};c.getTopMostNodes=function(d){for(var h={},f=0;f<d.length;f++)h[d[f].id()]=!0;var v=d.filter(function(p,m){typeof p=="number"&&(p=m);for(var g=p.parent()[0];g!=null;){if(h[g.id()])return!1;g=g.parent()[0]}return!0});return v},c.connectComponents=function(d,h,f,v){var p=new l,m=new Set,g=[],y=void 0,b=void 0,S=void 0,A=!1,P=1,O=[],I=[],R=function(){var B=d.collection();I.push(B);var w=f[0],_=d.collection();_.merge(w).merge(w.descendants().intersection(h)),g.push(w),_.forEach(function(C){p.push(C),m.add(C),B.merge(C)});for(var E=function(){w=p.shift();var T=d.collection();w.neighborhood().nodes().forEach(function(N){h.intersection(w.edgesWith(N)).length>0&&T.merge(N)});for(var M=0;M<T.length;M++){var D=T[M];if(y=f.intersection(D.union(D.ancestors())),y!=null&&!m.has(y[0])){var F=y.union(y.descendants());F.forEach(function(N){p.push(N),m.add(N),B.merge(N),f.has(N)&&g.push(N)})}}};p.length!=0;)E();if(B.forEach(function(C){h.intersection(C.connectedEdges()).forEach(function(T){B.has(T.source())&&B.has(T.target())&&B.merge(T)})}),g.length==f.length&&(A=!0),!A||A&&P>1){b=g[0],S=b.connectedEdges().length,g.forEach(function(C){C.connectedEdges().length<S&&(S=C.connectedEdges().length,b=C)}),O.push(b.id());var x=d.collection();x.merge(g[0]),g.forEach(function(C){x.merge(C)}),g=[],f=f.difference(x),P++}};do R();while(!A);return v&&O.length>0&&v.set("dummy"+(v.size+1),O),I},c.relocateComponent=function(d,h,f){if(!f.fixedNodeConstraint){var v=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;if(f.quality=="draft"){var y=!0,b=!1,S=void 0;try{for(var A=h.nodeIndexes[Symbol.iterator](),P;!(y=(P=A.next()).done);y=!0){var O=P.value,I=u(O,2),R=I[0],L=I[1],B=f.cy.getElementById(R);if(B){var w=B.boundingBox(),_=h.xCoords[L]-w.w/2,E=h.xCoords[L]+w.w/2,x=h.yCoords[L]-w.h/2,C=h.yCoords[L]+w.h/2;_<v&&(v=_),E>p&&(p=E),x<m&&(m=x),C>g&&(g=C)}}}catch(N){b=!0,S=N}finally{try{!y&&A.return&&A.return()}finally{if(b)throw S}}var T=d.x-(p+v)/2,M=d.y-(g+m)/2;h.xCoords=h.xCoords.map(function(N){return N+T}),h.yCoords=h.yCoords.map(function(N){return N+M})}else{Object.keys(h).forEach(function(N){var z=h[N],q=z.getRect().x,$=z.getRect().x+z.getRect().width,ee=z.getRect().y,J=z.getRect().y+z.getRect().height;q<v&&(v=q),$>p&&(p=$),ee<m&&(m=ee),J>g&&(g=J)});var D=d.x-(p+v)/2,F=d.y-(g+m)/2;Object.keys(h).forEach(function(N){var z=h[N];z.setCenter(z.getCenterX()+D,z.getCenterY()+F)})}}},c.calcBoundingBox=function(d,h,f,v){for(var p=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER,b=void 0,S=void 0,A=void 0,P=void 0,O=d.descendants().not(":parent"),I=O.length,R=0;R<I;R++){var L=O[R];b=h[v.get(L.id())]-L.width()/2,S=h[v.get(L.id())]+L.width()/2,A=f[v.get(L.id())]-L.height()/2,P=f[v.get(L.id())]+L.height()/2,p>b&&(p=b),m<S&&(m=S),g>A&&(g=A),y<P&&(y=P)}var B={};return B.topLeftX=p,B.topLeftY=g,B.width=m-p,B.height=y-g,B},c.calcParentsWithoutChildren=function(d,h){var f=d.collection();return h.nodes(":parent").forEach(function(v){var p=!1;v.children().forEach(function(m){m.css("display")!="none"&&(p=!0)}),p||f.merge(v)}),f},a.exports=c},816:(a,o,s)=>{var u=s(548),l=s(140).CoSELayout,c=s(140).CoSENode,d=s(140).layoutBase.PointD,h=s(140).layoutBase.DimensionD,f=s(140).layoutBase.LayoutConstants,v=s(140).layoutBase.FDLayoutConstants,p=s(140).CoSEConstants,m=function(y,b){var S=y.cy,A=y.eles,P=A.nodes(),O=A.edges(),I=void 0,R=void 0,L=void 0,B={};y.randomize&&(I=b.nodeIndexes,R=b.xCoords,L=b.yCoords);var w=function(N){return typeof N=="function"},_=function(N,z){return w(N)?N(z):N},E=u.calcParentsWithoutChildren(S,A),x=function F(N,z,q,$){for(var ee=z.length,J=0;J<ee;J++){var j=z[J],Z=null;j.intersection(E).length==0&&(Z=j.children());var H=void 0,k=j.layoutDimensions({nodeDimensionsIncludeLabels:$.nodeDimensionsIncludeLabels});if(j.outerWidth()!=null&&j.outerHeight()!=null)if($.randomize)if(!j.isParent())H=N.add(new c(q.graphManager,new d(R[I.get(j.id())]-k.w/2,L[I.get(j.id())]-k.h/2),new h(parseFloat(k.w),parseFloat(k.h))));else{var G=u.calcBoundingBox(j,R,L,I);j.intersection(E).length==0?H=N.add(new c(q.graphManager,new d(G.topLeftX,G.topLeftY),new h(G.width,G.height))):H=N.add(new c(q.graphManager,new d(G.topLeftX,G.topLeftY),new h(parseFloat(k.w),parseFloat(k.h))))}else H=N.add(new c(q.graphManager,new d(j.position("x")-k.w/2,j.position("y")-k.h/2),new h(parseFloat(k.w),parseFloat(k.h))));else H=N.add(new c(this.graphManager));if(H.id=j.data("id"),H.nodeRepulsion=_($.nodeRepulsion,j),H.paddingLeft=parseInt(j.css("padding")),H.paddingTop=parseInt(j.css("padding")),H.paddingRight=parseInt(j.css("padding")),H.paddingBottom=parseInt(j.css("padding")),$.nodeDimensionsIncludeLabels&&(H.labelWidth=j.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w,H.labelHeight=j.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h,H.labelPosVertical=j.css("text-valign"),H.labelPosHorizontal=j.css("text-halign")),B[j.data("id")]=H,isNaN(H.rect.x)&&(H.rect.x=0),isNaN(H.rect.y)&&(H.rect.y=0),Z!=null&&Z.length>0){var W=void 0;W=q.getGraphManager().add(q.newGraph(),H),F(W,Z,q,$)}}},C=function(N,z,q){for(var $=0,ee=0,J=0;J<q.length;J++){var j=q[J],Z=B[j.data("source")],H=B[j.data("target")];if(Z&&H&&Z!==H&&Z.getEdgesBetween(H).length==0){var k=z.add(N.newEdge(),Z,H);k.id=j.id(),k.idealLength=_(y.idealEdgeLength,j),k.edgeElasticity=_(y.edgeElasticity,j),$+=k.idealLength,ee++}}y.idealEdgeLength!=null&&(ee>0?p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=$/ee:w(y.idealEdgeLength)?p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=50:p.DEFAULT_EDGE_LENGTH=v.DEFAULT_EDGE_LENGTH=y.idealEdgeLength,p.MIN_REPULSION_DIST=v.MIN_REPULSION_DIST=v.DEFAULT_EDGE_LENGTH/10,p.DEFAULT_RADIAL_SEPARATION=v.DEFAULT_EDGE_LENGTH)},T=function(N,z){z.fixedNodeConstraint&&(N.constraints.fixedNodeConstraint=z.fixedNodeConstraint),z.alignmentConstraint&&(N.constraints.alignmentConstraint=z.alignmentConstraint),z.relativePlacementConstraint&&(N.constraints.relativePlacementConstraint=z.relativePlacementConstraint)};y.nestingFactor!=null&&(p.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=v.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=y.nestingFactor),y.gravity!=null&&(p.DEFAULT_GRAVITY_STRENGTH=v.DEFAULT_GRAVITY_STRENGTH=y.gravity),y.numIter!=null&&(p.MAX_ITERATIONS=v.MAX_ITERATIONS=y.numIter),y.gravityRange!=null&&(p.DEFAULT_GRAVITY_RANGE_FACTOR=v.DEFAULT_GRAVITY_RANGE_FACTOR=y.gravityRange),y.gravityCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_STRENGTH=v.DEFAULT_COMPOUND_GRAVITY_STRENGTH=y.gravityCompound),y.gravityRangeCompound!=null&&(p.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=v.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=y.gravityRangeCompound),y.initialEnergyOnIncremental!=null&&(p.DEFAULT_COOLING_FACTOR_INCREMENTAL=v.DEFAULT_COOLING_FACTOR_INCREMENTAL=y.initialEnergyOnIncremental),y.tilingCompareBy!=null&&(p.TILING_COMPARE_BY=y.tilingCompareBy),y.quality=="proof"?f.QUALITY=2:f.QUALITY=0,p.NODE_DIMENSIONS_INCLUDE_LABELS=v.NODE_DIMENSIONS_INCLUDE_LABELS=f.NODE_DIMENSIONS_INCLUDE_LABELS=y.nodeDimensionsIncludeLabels,p.DEFAULT_INCREMENTAL=v.DEFAULT_INCREMENTAL=f.DEFAULT_INCREMENTAL=!y.randomize,p.ANIMATE=v.ANIMATE=f.ANIMATE=y.animate,p.TILE=y.tile,p.TILING_PADDING_VERTICAL=typeof y.tilingPaddingVertical=="function"?y.tilingPaddingVertical.call():y.tilingPaddingVertical,p.TILING_PADDING_HORIZONTAL=typeof y.tilingPaddingHorizontal=="function"?y.tilingPaddingHorizontal.call():y.tilingPaddingHorizontal,p.DEFAULT_INCREMENTAL=v.DEFAULT_INCREMENTAL=f.DEFAULT_INCREMENTAL=!0,p.PURE_INCREMENTAL=!y.randomize,f.DEFAULT_UNIFORM_LEAF_NODE_SIZES=y.uniformNodeDimensions,y.step=="transformed"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!1),y.step=="enforced"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!1),y.step=="cose"&&(p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!1,p.APPLY_LAYOUT=!0),y.step=="all"&&(y.randomize?p.TRANSFORM_ON_CONSTRAINT_HANDLING=!0:p.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,p.ENFORCE_CONSTRAINTS=!0,p.APPLY_LAYOUT=!0),y.fixedNodeConstraint||y.alignmentConstraint||y.relativePlacementConstraint?p.TREE_REDUCTION_ON_INCREMENTAL=!1:p.TREE_REDUCTION_ON_INCREMENTAL=!0;var M=new l,D=M.newGraphManager();return x(D.addRoot(),u.getTopMostNodes(P),M,y),C(M,D,O),T(M,y),M.runLayout(),B};a.exports={coseLayout:m}},212:(a,o,s)=>{var u=function(){function y(b,S){for(var A=0;A<S.length;A++){var P=S[A];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(b,P.key,P)}}return function(b,S,A){return S&&y(b.prototype,S),A&&y(b,A),b}}();function l(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}var c=s(658),d=s(548),h=s(657),f=h.spectralLayout,v=s(816),p=v.coseLayout,m=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:void 0,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1e-7,nodeRepulsion:function(b){return 4500},idealEdgeLength:function(b){return 50},edgeElasticity:function(b){return .45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingCompareBy:void 0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:void 0,alignmentConstraint:void 0,relativePlacementConstraint:void 0,ready:function(){},stop:function(){}}),g=function(){function y(b){l(this,y),this.options=c({},m,b)}return u(y,[{key:"run",value:function(){var S=this,A=this.options,P=A.cy,O=A.eles,I=[],R=void 0,L=void 0,B=[],w=void 0,_=[];A.fixedNodeConstraint&&(!Array.isArray(A.fixedNodeConstraint)||A.fixedNodeConstraint.length==0)&&(A.fixedNodeConstraint=void 0),A.alignmentConstraint&&(A.alignmentConstraint.vertical&&(!Array.isArray(A.alignmentConstraint.vertical)||A.alignmentConstraint.vertical.length==0)&&(A.alignmentConstraint.vertical=void 0),A.alignmentConstraint.horizontal&&(!Array.isArray(A.alignmentConstraint.horizontal)||A.alignmentConstraint.horizontal.length==0)&&(A.alignmentConstraint.horizontal=void 0)),A.relativePlacementConstraint&&(!Array.isArray(A.relativePlacementConstraint)||A.relativePlacementConstraint.length==0)&&(A.relativePlacementConstraint=void 0);var E=A.fixedNodeConstraint||A.alignmentConstraint||A.relativePlacementConstraint;E&&(A.tile=!1,A.packComponents=!1);var x=void 0,C=!1;if(P.layoutUtilities&&A.packComponents&&(x=P.layoutUtilities("get"),x||(x=P.layoutUtilities()),C=!0),O.nodes().length>0)if(C){var D=d.getTopMostNodes(A.eles.nodes());if(w=d.connectComponents(P,A.eles,D),w.forEach(function(fe){var ue=fe.boundingBox();_.push({x:ue.x1+ue.w/2,y:ue.y1+ue.h/2})}),A.randomize&&w.forEach(function(fe){A.eles=fe,I.push(f(A))}),A.quality=="default"||A.quality=="proof"){var F=P.collection();if(A.tile){var N=new Map,z=[],q=[],$=0,ee={nodeIndexes:N,xCoords:z,yCoords:q},J=[];if(w.forEach(function(fe,ue){fe.edges().length==0&&(fe.nodes().forEach(function(de,ye){F.merge(fe.nodes()[ye]),de.isParent()||(ee.nodeIndexes.set(fe.nodes()[ye].id(),$++),ee.xCoords.push(fe.nodes()[0].position().x),ee.yCoords.push(fe.nodes()[0].position().y))}),J.push(ue))}),F.length>1){var j=F.boundingBox();_.push({x:j.x1+j.w/2,y:j.y1+j.h/2}),w.push(F),I.push(ee);for(var Z=J.length-1;Z>=0;Z--)w.splice(J[Z],1),I.splice(J[Z],1),_.splice(J[Z],1)}}w.forEach(function(fe,ue){A.eles=fe,B.push(p(A,I[ue])),d.relocateComponent(_[ue],B[ue],A)})}else w.forEach(function(fe,ue){d.relocateComponent(_[ue],I[ue],A)});var H=new Set;if(w.length>1){var k=[],G=O.filter(function(fe){return fe.css("display")=="none"});w.forEach(function(fe,ue){var de=void 0;if(A.quality=="draft"&&(de=I[ue].nodeIndexes),fe.nodes().not(G).length>0){var ye={};ye.edges=[],ye.nodes=[];var Se=void 0;fe.nodes().not(G).forEach(function(xe){if(A.quality=="draft")if(!xe.isParent())Se=de.get(xe.id()),ye.nodes.push({x:I[ue].xCoords[Se]-xe.boundingbox().w/2,y:I[ue].yCoords[Se]-xe.boundingbox().h/2,width:xe.boundingbox().w,height:xe.boundingbox().h});else{var Ce=d.calcBoundingBox(xe,I[ue].xCoords,I[ue].yCoords,de);ye.nodes.push({x:Ce.topLeftX,y:Ce.topLeftY,width:Ce.width,height:Ce.height})}else B[ue][xe.id()]&&ye.nodes.push({x:B[ue][xe.id()].getLeft(),y:B[ue][xe.id()].getTop(),width:B[ue][xe.id()].getWidth(),height:B[ue][xe.id()].getHeight()})}),fe.edges().forEach(function(xe){var Ce=xe.source(),_e=xe.target();if(Ce.css("display")!="none"&&_e.css("display")!="none")if(A.quality=="draft"){var be=de.get(Ce.id()),he=de.get(_e.id()),V=[],re=[];if(Ce.isParent()){var le=d.calcBoundingBox(Ce,I[ue].xCoords,I[ue].yCoords,de);V.push(le.topLeftX+le.width/2),V.push(le.topLeftY+le.height/2)}else V.push(I[ue].xCoords[be]),V.push(I[ue].yCoords[be]);if(_e.isParent()){var Y=d.calcBoundingBox(_e,I[ue].xCoords,I[ue].yCoords,de);re.push(Y.topLeftX+Y.width/2),re.push(Y.topLeftY+Y.height/2)}else re.push(I[ue].xCoords[he]),re.push(I[ue].yCoords[he]);ye.edges.push({startX:V[0],startY:V[1],endX:re[0],endY:re[1]})}else B[ue][Ce.id()]&&B[ue][_e.id()]&&ye.edges.push({startX:B[ue][Ce.id()].getCenterX(),startY:B[ue][Ce.id()].getCenterY(),endX:B[ue][_e.id()].getCenterX(),endY:B[ue][_e.id()].getCenterY()})}),ye.nodes.length>0&&(k.push(ye),H.add(ue))}});var W=x.packComponents(k,A.randomize).shifts;if(A.quality=="draft")I.forEach(function(fe,ue){var de=fe.xCoords.map(function(Se){return Se+W[ue].dx}),ye=fe.yCoords.map(function(Se){return Se+W[ue].dy});fe.xCoords=de,fe.yCoords=ye});else{var te=0;H.forEach(function(fe){Object.keys(B[fe]).forEach(function(ue){var de=B[fe][ue];de.setCenter(de.getCenterX()+W[te].dx,de.getCenterY()+W[te].dy)}),te++})}}}else{var T=A.eles.boundingBox();if(_.push({x:T.x1+T.w/2,y:T.y1+T.h/2}),A.randomize){var M=f(A);I.push(M)}A.quality=="default"||A.quality=="proof"?(B.push(p(A,I[0])),d.relocateComponent(_[0],B[0],A)):d.relocateComponent(_[0],I[0],A)}var X=function(ue,de){if(A.quality=="default"||A.quality=="proof"){typeof ue=="number"&&(ue=de);var ye=void 0,Se=void 0,xe=ue.data("id");return B.forEach(function(_e){xe in _e&&(ye={x:_e[xe].getRect().getCenterX(),y:_e[xe].getRect().getCenterY()},Se=_e[xe])}),A.nodeDimensionsIncludeLabels&&(Se.labelWidth&&(Se.labelPosHorizontal=="left"?ye.x+=Se.labelWidth/2:Se.labelPosHorizontal=="right"&&(ye.x-=Se.labelWidth/2)),Se.labelHeight&&(Se.labelPosVertical=="top"?ye.y+=Se.labelHeight/2:Se.labelPosVertical=="bottom"&&(ye.y-=Se.labelHeight/2))),ye==null&&(ye={x:ue.position("x"),y:ue.position("y")}),{x:ye.x,y:ye.y}}else{var Ce=void 0;return I.forEach(function(_e){var be=_e.nodeIndexes.get(ue.id());be!=null&&(Ce={x:_e.xCoords[be],y:_e.yCoords[be]})}),Ce==null&&(Ce={x:ue.position("x"),y:ue.position("y")}),{x:Ce.x,y:Ce.y}}};if(A.quality=="default"||A.quality=="proof"||A.randomize){var me=d.calcParentsWithoutChildren(P,O),Te=O.filter(function(fe){return fe.css("display")=="none"});A.eles=O.not(Te),O.nodes().not(":parent").not(Te).layoutPositions(S,A,X),me.length>0&&me.forEach(function(fe){fe.position(X(fe))})}else console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}]),y}();a.exports=g},657:(a,o,s)=>{var u=s(548),l=s(140).layoutBase.Matrix,c=s(140).layoutBase.SVD,d=function(f){var v=f.cy,p=f.eles,m=p.nodes(),g=p.nodes(":parent"),y=new Map,b=new Map,S=new Map,A=[],P=[],O=[],I=[],R=[],L=[],B=[],w=[],_=void 0,E=void 0,x=1e8,C=1e-9,T=f.piTol,M=f.samplingType,D=f.nodeSeparation,F=void 0,N=function(){for(var oe=0,ne=0,se=!1;ne<F;){oe=Math.floor(Math.random()*E),se=!1;for(var ve=0;ve<ne;ve++)if(I[ve]==oe){se=!0;break}if(!se)I[ne]=oe,ne++;else continue}},z=function(oe,ne,se){for(var ve=[],Re=0,we=0,pe=0,Me=void 0,Ae=[],Ie=0,Ve=1,Ke=0;Ke<E;Ke++)Ae[Ke]=x;for(ve[we]=oe,Ae[oe]=0;we>=Re;){pe=ve[Re++];for(var ze=A[pe],Le=0;Le<ze.length;Le++)Me=b.get(ze[Le]),Ae[Me]==x&&(Ae[Me]=Ae[pe]+1,ve[++we]=Me);L[pe][ne]=Ae[pe]*D}if(se){for(var He=0;He<E;He++)L[He][ne]<R[He]&&(R[He]=L[He][ne]);for(var Be=0;Be<E;Be++)R[Be]>Ie&&(Ie=R[Be],Ve=Be)}return Ve},q=function(oe){var ne=void 0;if(oe){ne=Math.floor(Math.random()*E),_=ne;for(var ve=0;ve<E;ve++)R[ve]=x;for(var Re=0;Re<F;Re++)I[Re]=ne,ne=z(ne,Re,oe)}else{N();for(var se=0;se<F;se++)z(I[se],se,oe,!1)}for(var we=0;we<E;we++)for(var pe=0;pe<F;pe++)L[we][pe]*=L[we][pe];for(var Me=0;Me<F;Me++)B[Me]=[];for(var Ae=0;Ae<F;Ae++)for(var Ie=0;Ie<F;Ie++)B[Ae][Ie]=L[I[Ie]][Ae]},$=function(){for(var oe=c.svd(B),ne=oe.S,se=oe.U,ve=oe.V,Re=ne[0]*ne[0]*ne[0],we=[],pe=0;pe<F;pe++){we[pe]=[];for(var Me=0;Me<F;Me++)we[pe][Me]=0,pe==Me&&(we[pe][Me]=ne[pe]/(ne[pe]*ne[pe]+Re/(ne[pe]*ne[pe])))}w=l.multMat(l.multMat(ve,we),l.transpose(se))},ee=function(){for(var oe=void 0,ne=void 0,se=[],ve=[],Re=[],we=[],pe=0;pe<E;pe++)se[pe]=Math.random(),ve[pe]=Math.random();se=l.normalize(se),ve=l.normalize(ve);for(var Me=0,Ae=C,Ie=C,Ve=void 0;;){Me++;for(var Ke=0;Ke<E;Ke++)Re[Ke]=se[Ke];if(se=l.multGamma(l.multL(l.multGamma(Re),L,w)),oe=l.dotProduct(Re,se),se=l.normalize(se),Ae=l.dotProduct(Re,se),Ve=Math.abs(Ae/Ie),Ve<=1+T&&Ve>=1)break;Ie=Ae}for(var ze=0;ze<E;ze++)Re[ze]=se[ze];for(Me=0,Ie=C;;){Me++;for(var Le=0;Le<E;Le++)we[Le]=ve[Le];if(we=l.minusOp(we,l.multCons(Re,l.dotProduct(Re,we))),ve=l.multGamma(l.multL(l.multGamma(we),L,w)),ne=l.dotProduct(we,ve),ve=l.normalize(ve),Ae=l.dotProduct(we,ve),Ve=Math.abs(Ae/Ie),Ve<=1+T&&Ve>=1)break;Ie=Ae}for(var He=0;He<E;He++)we[He]=ve[He];P=l.multCons(Re,Math.sqrt(Math.abs(oe))),O=l.multCons(we,Math.sqrt(Math.abs(ne)))};u.connectComponents(v,p,u.getTopMostNodes(m),y),g.forEach(function(Q){u.connectComponents(v,p,u.getTopMostNodes(Q.descendants().intersection(p)),y)});for(var J=0,j=0;j<m.length;j++)m[j].isParent()||b.set(m[j].id(),J++);var Z=!0,H=!1,k=void 0;try{for(var G=y.keys()[Symbol.iterator](),W;!(Z=(W=G.next()).done);Z=!0){var te=W.value;b.set(te,J++)}}catch(Q){H=!0,k=Q}finally{try{!Z&&G.return&&G.return()}finally{if(H)throw k}}for(var X=0;X<b.size;X++)A[X]=[];g.forEach(function(Q){for(var oe=Q.children().intersection(p);oe.nodes(":childless").length==0;)oe=oe.nodes()[0].children().intersection(p);var ne=0,se=oe.nodes(":childless")[0].connectedEdges().length;oe.nodes(":childless").forEach(function(ve,Re){ve.connectedEdges().length<se&&(se=ve.connectedEdges().length,ne=Re)}),S.set(Q.id(),oe.nodes(":childless")[ne].id())}),m.forEach(function(Q){var oe=void 0;Q.isParent()?oe=b.get(S.get(Q.id())):oe=b.get(Q.id()),Q.neighborhood().nodes().forEach(function(ne){p.intersection(Q.edgesWith(ne)).length>0&&(ne.isParent()?A[oe].push(S.get(ne.id())):A[oe].push(ne.id()))})});var me=function(oe){var ne=b.get(oe),se=void 0;y.get(oe).forEach(function(ve){v.getElementById(ve).isParent()?se=S.get(ve):se=ve,A[ne].push(se),A[b.get(se)].push(oe)})},Te=!0,fe=!1,ue=void 0;try{for(var de=y.keys()[Symbol.iterator](),ye;!(Te=(ye=de.next()).done);Te=!0){var Se=ye.value;me(Se)}}catch(Q){fe=!0,ue=Q}finally{try{!Te&&de.return&&de.return()}finally{if(fe)throw ue}}E=b.size;var xe=void 0;if(E>2){F=E<f.sampleSize?E:f.sampleSize;for(var Ce=0;Ce<E;Ce++)L[Ce]=[];for(var _e=0;_e<F;_e++)w[_e]=[];return f.quality=="draft"||f.step=="all"?(q(M),$(),ee(),xe={nodeIndexes:b,xCoords:P,yCoords:O}):(b.forEach(function(Q,oe){P.push(v.getElementById(oe).position("x")),O.push(v.getElementById(oe).position("y"))}),xe={nodeIndexes:b,xCoords:P,yCoords:O}),xe}else{var be=b.keys(),he=v.getElementById(be.next().value),V=he.position(),re=he.outerWidth();if(P.push(V.x),O.push(V.y),E==2){var le=v.getElementById(be.next().value),Y=le.outerWidth();P.push(V.x+re/2+Y/2+f.idealEdgeLength),O.push(V.y)}return xe={nodeIndexes:b,xCoords:P,yCoords:O},xe}};a.exports={spectralLayout:d}},579:(a,o,s)=>{var u=s(212),l=function(d){d&&d("layout","fcose",u)};typeof cytoscape<"u"&&l(cytoscape),a.exports=l},140:a=>{a.exports=r}},t={};function n(a){var o=t[a];if(o!==void 0)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}var i=n(579);return i})()})});var Vl=(r,e)=>e.id;function Op(r,e){if(r&1){let t=$e();U(0,"mat-chip-row",15),ge("removed",function(){let i=De(t).$implicit,a=ce();return Pe(a.removeTag(i))}),ae(1),U(2,"button",16)(3,"mat-icon"),ae(4,"cancel"),K()()()}if(r&2){let t=e.$implicit;Ee("removable",!0),ie(),ot(" ",t.name," "),ie(),Oc("aria-label","remove "+t.name)}}function Rp(r,e){if(r&1&&(U(0,"mat-option",13),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ot(" ",t.name," ")}}function Ip(r,e){if(r&1&&(U(0,"mat-list-option",13),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ot(" ",t.title," ")}}function Lp(r,e){if(r&1){let t=$e();U(0,"mat-selection-list",17),wr("ngModelChange",function(i){De(t);let a=ce();return Cr(a.selectedCollate,i)||(a.selectedCollate=i),Pe(i)}),ge("selectionChange",function(i){De(t);let a=ce();return Pe(a.onCollateSelect(i))}),tt(1,Ip,2,2,"mat-list-option",13,Vl),K(),U(3,"mat-paginator",18),ge("page",function(i){De(t);let a=ce();return Pe(a.handlePageEvent(i))}),K()}if(r&2){let t=ce();yr("ngModel",t.selectedCollate),Ee("multiple",!1),ie(),rt(t.collates),ie(2),Ee("length",t.totalCount)("pageSize",t.limit)}}function Np(r,e){r&1&&(U(0,"p"),ae(1,"No collates could be found."),K())}var ld=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.fb=n,this.router=i,this.collateService=a,this.dialog=o,this.collates=[],this.searchTags=[],this.selectedCollate=null,this.searchTerm="",this.limit=5,this.offset=0,this.totalCount=0,this.separatorKeysCodes=[13,188],this.form=this.fb.group({tag:[""]}),this.loading=!1}ngOnInit(){this.searchCollates(),this.filteredTags=this.form.controls.tag.valueChanges.pipe(So(""),To(t=>t?t.length>=2:!1),Ei(t=>this.collateService.getCollateTags(t).pipe(_o(n=>n.results))))}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,this.searchTerm,this.searchTags.map(t=>t.id)).subscribe({next:t=>{this.collates=t.results,this.totalCount=t.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onCollateSelect(t){this.selectedCollate=t.options[0].value,this.router.navigate([`/collate/view/${t.options[0].value.id}`]).then(n=>console.log(n))}openCreateCollateDialog(){this.dialog.open(rd).afterClosed().subscribe(n=>{n&&this.collateService.createCollate(n.title,n.greeting).subscribe(i=>{this.router.navigate([`/collate/edit/${i.id}`]).then(a=>console.log(a))})})}handlePageEvent(t){this.limit=t.pageSize,this.offset=t.pageIndex*this.limit,this.searchCollates()}addTag(t){let n=t.option.value;n&&!this.searchTags.find(i=>i.id===n.id)&&this.searchTags.push(n),this.form.controls.tag.setValue(""),this.searchCollates()}removeTag(t){let n=this.searchTags.indexOf(t);n>=0&&this.searchTags.splice(n,1),this.searchCollates()}static{this.\u0275fac=function(n){return new(n||r)(Oe(Vr),Oe(kt),Oe(Pi),Oe(Kr),Oe(Tn))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate"]],decls:33,vars:8,consts:[["chipGrid",""],["auto","matAutocomplete"],[1,"collate-container"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[1,"search-box"],["mat-button","",2,"width","100%",3,"click"],["appearance","outlined",2,"width","500px"],[2,"width","100%"],["matInput","","placeholder","Search Collates",3,"ngModelChange","ngModel"],[3,"removable"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-raised-button","","color","primary",3,"click"],[3,"removed","removable"],["matChipRemove",""],[3,"ngModelChange","selectionChange","ngModel","multiple"],[3,"page","length","pageSize"]],template:function(n,i){if(n&1){let a=$e();U(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),ae(4,"C|nder Collates"),K(),Fe(5,"br"),K()(),U(6,"div",5)(7,"div")(8,"button",6),ge("click",function(){return De(a),Pe(i.openCreateCollateDialog())}),U(9,"h3"),ae(10,"+ Create Collate From Projects"),K()()(),Fe(11,"hr"),U(12,"mat-card",7)(13,"mat-card-content")(14,"mat-form-field",8)(15,"input",9),wr("ngModelChange",function(s){return De(a),Cr(i.searchTerm,s)||(i.searchTerm=s),Pe(s)}),ge("ngModelChange",function(){return De(a),Pe(i.searchCollates())}),K()(),U(16,"mat-form-field",8)(17,"mat-label"),ae(18,"Search Tags"),K(),U(19,"mat-chip-grid",null,0),tt(21,Op,5,3,"mat-chip-row",10,Vl),Fe(23,"input",11),K(),U(24,"mat-autocomplete",12,1),ge("optionSelected",function(s){return De(a),Pe(i.addTag(s))}),tt(26,Rp,2,2,"mat-option",13,Vl),Mi(28,"async"),K()(),U(29,"button",14),ge("click",function(){return De(a),Pe(i.searchCollates())}),ae(30,"Search"),K(),ke(31,Lp,4,4)(32,Np,2,0,"p"),K()()()()}if(n&2){let a=ir(20),o=ir(25);ie(15),yr("ngModel",i.searchTerm),ie(6),rt(i.searchTags),ie(2),Ee("matChipInputFor",a)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("formControl",i.form.controls.tag)("matAutocomplete",o),ie(3),rt(Ai(28,6,i.filteredTags)),ie(5),Ue(i.collates.length>0?31:32)}},dependencies:[Ft,Mn,Wt,Et,Sn,Kt,Bo,Fo,lr,Ri,Oi,yt,Vo,ar,zo,td,ed,Jc,Pr,Ni,Di,Xt,qc,ki],styles:[".collate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:80vh}.search-box[_ngcontent-%COMP%]{width:500px}"]})}}return r})();var ud=(()=>{class r{constructor(){this.collate=null}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-header"]],inputs:{collate:"collate"},decls:7,vars:2,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(n,i){n&1&&(U(0,"div",0)(1,"div",1)(2,"h1"),ae(3),K(),Fe(4,"br"),U(5,"div",2),ae(6),K()()()),n&2&&(ie(3),ct(i.collate==null?null:i.collate.title),ie(3),ct(i.collate==null?null:i.collate.greeting))},styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();function Fp(r,e){if(r&1&&(U(0,"p"),ae(1),Fe(2,"br"),ae(3),K(),Fe(4,"mat-progress-bar",8)),r&2){let t=ce();ie(),ot("Elapsed Time: ",t.elapsedTime," seconds"),ie(2),ot(" ",t.progress," ")}}var ls=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.ws=n,this.fb=i,this.web=a,this.sb=o,this.projects=[],this.loading=!1,this.searchStartTime=null,this.elapsedTime="0.00",this.progress="",this.form=this.fb.group({searchQuery:new Br("",Fr.required),searchMode:new Br("gene",Fr.required)}),this.searchResultID=new xt,this.ws.searchWSConnection?.subscribe(s=>{if(s&&s.type==="search_status")switch(s.status){case"complete":this.loading=!1,clearInterval(this.timerInterval);let u=this.calculateElapsedTime();this.progress="",this.showSnackBar(`Search complete in ${u} seconds`),this.searchResultID.emit(parseInt(s.id));break;case"in_progress":this.progress=`Current progress: ${s.current_progress}/${s.found_files}`;break;case"error":this.loading=!1,this.progress="Search error",this.showSnackBar("Search error");break}})}runSearch(){return _t(this,null,function*(){if(this.form.invalid)return;this.loading=!0,this.progress="Current progress: search initiated",this.searchStartTime=new Date,this.elapsedTime="0.00",this.timerInterval=setInterval(()=>{this.elapsedTime=this.calculateElapsedTime().toFixed(2)},200);let t=[];if(this.projects.length>0){let n=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();if(n)for(let i of n)t.push(i.id)}if(this.form.value.searchQuery&&this.form.value.searchMode){let i=this.form.value.searchQuery.toUpperCase().split("OR").map(a=>`"${a.trim().replace(/'/g,"").replace(/"/g,"")}"`);this.web.createSearch(t,i.join(" OR "),this.web.searchSessionID,1e-9,1e-9,this.form.value.searchMode).subscribe({next:()=>{this.sb.open("Search queued","Dismiss",{duration:2e3})},error:()=>{this.loading=!1,clearInterval(this.timerInterval),this.showSnackBar("Search error")}})}})}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}calculateElapsedTime(){return this.searchStartTime?(new Date().getTime()-this.searchStartTime.getTime())/1e3:0}static{this.\u0275fac=function(n){return new(n||r)(Oe(Vr),Oe(Ho),Oe(kt),Oe(Zt),Oe(Vr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-search"]],inputs:{projects:"projects"},outputs:{searchResultID:"searchResultID"},decls:22,vars:2,consts:[["appearance","outlined"],[2,"display","flex","gap","20px","align-items","center",3,"ngSubmit","formGroup"],[2,"width","500px"],["matInput","","placeholder","Search Query","formControlName","searchQuery"],["formControlName","searchMode"],["value","pi"],["value","gene"],["mat-icon-button","","color","primary","type","submit"],["mode","indeterminate"]],template:function(n,i){n&1&&(U(0,"mat-card",0)(1,"mat-card-content")(2,"form",1),ge("ngSubmit",function(){return i.runSearch()}),U(3,"mat-form-field",2),Fe(4,"input",3),K(),U(5,"mat-form-field")(6,"mat-label"),ae(7,"Search Mode"),K(),U(8,"mat-select",4)(9,"mat-option",5),ae(10,"Primary Ids"),K(),U(11,"mat-option",6),ae(12,"Gene Names"),K()()(),U(13,"button",7)(14,"mat-icon"),ae(15,"search"),K()()(),U(16,"p"),ae(17," For multiple search terms separate them with "),U(18,"b"),ae(19,"OR"),K(),ae(20,". "),K(),ke(21,Fp,5,2),K()()),n&2&&(ie(2),Ee("formGroup",i.form),ie(19),Ue(i.loading?21:-1))},dependencies:[Kt,Xt,qt,Wt,Et,Yt,or,sr,Ft,Xr,ar,Ri,Oi,Pr,An,lr,nd],encapsulation:2})}}return r})();var Vp=Eo(Pp());Bl.plotlyjs=Vp;var cd=(()=>{class r{set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set renameCondition(t){t?this._renameCondition=t:this._renameCondition={}}get renameCondition(){return this._renameCondition}set data(t){this._data=t,this.graphLayout.title.text=t?.analysis_group?.name||"",this.graphLayout.yaxis.title=this.searchTerm||"",this.conditionA=t?.condition_A||"",this.conditionB=t?.condition_B||"",this.drawGraph()}get data(){return this._data}set expanded(t){this._expanded=t,this.data&&this.drawGraph()}get expanded(){return this._expanded}set colorMap(t){t&&(this._colorMap=t,this.data&&t&&this.drawGraph())}get colorMap(){return this._colorMap}constructor(t,n){this.graph=t,this.accounts=n,this._data=null,this._renameCondition={},this._searchTerm="",this._expanded=!1,this.graphData=[],this.graphLayout={title:{text:"",font:{size:16}},height:400,margin:{l:150,r:100,b:100,t:100},yaxis:{title:this.searchTerm,tickfont:{size:14}}},this.conditionA="",this.conditionB="",this.valueA=[],this.valueB=[],this.barSize=50,this.revision=0,this._colorMap={},this.currentColor=0,this.graph.redrawTrigger.subscribe(()=>{this.drawGraph()})}drawGraph(){this.loadPlotSettings(),this.graph.plotSettings.showTitle||(this.graphLayout.title.text="");let t=this.renameCondition[this.conditionA];t||(t=this.conditionA);let n=this.renameCondition[this.conditionB];n||(n=this.conditionB);let i=document.getElementsByTagName("body")[0],o=window.getComputedStyle(i).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=o,this.graphLayout.paper_bgcolor=o,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let s=0;if(this.data&&this.data.condition_A&&this.data.condition_B&&this.data.searched_data&&!this.expanded){this.conditionA=this.data.condition_A||"",this.conditionB=this.data.condition_B||"",this.valueA=this.data.searched_data.filter(v=>v.Condition===this.conditionA).map(v=>v.Value),this.valueB=this.data.searched_data.filter(v=>v.Condition===this.conditionB).map(v=>v.Value);let u=this.calculateMean(this.valueA),l=this.calculateMean(this.valueB);this.colorMap[this.conditionA]||(this.colorMap[this.conditionA]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let c={x:[t],y:[u],type:"bar",mode:"markers",name:t,error_y:{type:"data",array:[this.calculateWhisker(this.valueA)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionA]},showlegend:!1},d=this.drawTransparentBoxPlot(this.valueA,t);this.colorMap[this.conditionB]||(this.colorMap[this.conditionB]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let h={x:[n],y:[l],type:"bar",mode:"markers",name:n,error_y:{type:"data",array:[this.calculateWhisker(this.valueB)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionB]},showlegend:!1},f=this.drawTransparentBoxPlot(this.valueB,n);s=2,this.graphData=[c,d,h,f]}else if(this.data&&(this.expanded||this.data.condition_A==""||this.data.condition_B=="")){let u=Array.from(new Set(this.data.searched_data.map(f=>f.Condition))),l=u.map(f=>{let v=this.data.searched_data.filter(p=>p.Condition===f).map(p=>p.Value);return this.calculateMean(v)}),c=u.map(f=>{let v=this.data.searched_data.filter(p=>p.Condition===f).map(p=>p.Value);return this.calculateWhisker(v)}),d=u.map((f,v)=>{this.colorMap[f]||(this.colorMap[f]=this.graph.defaultColorList[this.currentColor],this.currentColor++,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0));let p=this.renameCondition[f];return p||(p=f),{x:[p],y:[l[v]],type:"bar",mode:"markers",name:p,error_y:{type:"data",array:[c[v]],visible:!0},line:{color:"black"},marker:{color:this.colorMap[f]},showlegend:!1}}),h=u.map((f,v)=>{let p=this.renameCondition[f];p||(p=f);let m=this.data.searched_data.filter(g=>g.Condition===f).map(g=>g.Value);return this.drawTransparentBoxPlot(m,p)});s=u.length,this.graphData=[...d,...h]}console.log(this.colorMap),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*s,this.revision++,console.log(this.graphData)}calculateMean(t){return t.reduce((i,a)=>i+a,0)/t.length}calculateWhisker(t){let n=this.calculateMean(t),i=t.reduce((a,o)=>a+Math.pow(o-n,2),0)/t.length;return Math.sqrt(i)}drawTransparentBoxPlot(t,n){return{x:n,y:t.filter(i=>!isNaN(i)),type:"box",boxpoints:"all",pointpos:0,jitter:.3,fillcolor:"rgba(255,255,255,0)",line:{color:"rgba(255,255,255,0)"},hoveron:"points",marker:{color:"#654949",opacity:.8},name:n,showlegend:!1}}loadPlotSettings(){this.graphLayout.height=this.graph.plotSettings.height,this.graphLayout.margin.l=this.graph.plotSettings.marginLeft,this.graphLayout.margin.r=this.graph.plotSettings.marginRight,this.graphLayout.margin.b=this.graph.plotSettings.marginBottom,this.graphLayout.margin.t=this.graph.plotSettings.marginTop,this.graphLayout.title.font.size=this.graph.plotSettings.titleTextSize,this.barSize=this.graph.plotSettings.barSize}static{this.\u0275fac=function(n){return new(n||r)(Oe(is),Oe(Zr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-bar-chart"]],inputs:{searchTerm:"searchTerm",renameCondition:"renameCondition",data:"data",expanded:"expanded",colorMap:"colorMap"},decls:1,vars:4,consts:[[3,"data","layout","revision","updateOnLayoutChange"]],template:function(n,i){n&1&&Fe(0,"plotly-plot",0),n&2&&Ee("data",i.graphData)("layout",i.graphLayout)("revision",i.revision)("updateOnLayoutChange",!0)},dependencies:[Bl,ad],encapsulation:2})}}return r})();var zp=(r,e)=>e.id;function Gp(r,e){if(r&1){let t=$e();U(0,"div",3)(1,"mat-slide-toggle",8),ge("change",function(){De(t);let i=ce(2);return Pe(i.expanded=!i.expanded)}),ae(2," Expand Bar Chart "),K(),U(3,"mat-slide-toggle",8),ge("change",function(){De(t);let i=ce(2);return Pe(i.viewDifferentialAnalysis=!i.viewDifferentialAnalysis)}),ae(4," View Differential Analysis Stats "),K()()}r&2&&(ie(),Ee("color","primary"),ie(2),Ee("color","primary"))}function jp(r,e){if(r&1&&(U(0,"div"),Fe(1,"app-bar-chart",11),K()),r&2){let t=ce().$implicit,n=ce(3);ie(),Ee("searchTerm",t.gene_name)("expanded",n.expanded)("renameCondition",n.renameCondition)("colorMap",n.colorMap)("data",t)}}function Hp(r,e){r&1&&(U(0,"div")(1,"p"),ae(2,"No data found for this search"),K()())}function Up(r,e){if(r&1&&(U(0,"div",9),ke(1,jp,2,5,"div")(2,Hp,3,0,"div"),U(3,"div")(4,"button",10)(5,"mat-icon"),ae(6,"drag_handle"),K()(),U(7,"p"),ae(8),K()()()),r&2){let t=e.$implicit;ie(),Ue(t.searched_data.length>0?1:2),ie(3),Ee("matTooltip",t.analysis_group.name),ie(4),ot(" ",t.analysis_group.name," ")}}function $p(r,e){if(r&1&&tt(0,Up,9,3,"div",9,zp),r&2){let t=ce(2);rt(t.searchResults)}}function Wp(r,e){r&1&&(U(0,"p"),ae(1,"No search results found in this project"),K())}function Yp(r,e){r&1&&(U(0,"th",24),ae(1," Primary ID "),K())}function qp(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.primary_id," ")}}function Xp(r,e){r&1&&(U(0,"th",24),ae(1," UniProt ID "),K())}function Kp(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.uniprot_id," ")}}function Zp(r,e){r&1&&(U(0,"th",24),ae(1," Gene Names "),K())}function Qp(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.gene_name," ")}}function Jp(r,e){r&1&&(U(0,"th",24),ae(1," log2FC "),K())}function eg(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.log2_fc," ")}}function tg(r,e){r&1&&(U(0,"th",24),ae(1," -log10(p) "),K())}function rg(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.log10_p," ")}}function ng(r,e){r&1&&(U(0,"th",24),ae(1," Condition A "),K())}function ig(r,e){if(r&1&&ae(0),r&2){let t=ce().$implicit,n=ce(3);ot(" ",n.renameCondition[t.condition_A]," ")}}function ag(r,e){if(r&1&&ae(0),r&2){let t=ce().$implicit;ot(" ",t.condition_A," ")}}function og(r,e){if(r&1&&(U(0,"td",25),ke(1,ig,1,1)(2,ag,1,1),K()),r&2){let t=ce(3);ie(),Ue(t.renameCondition?1:2)}}function sg(r,e){r&1&&(U(0,"th",24),ae(1," Condition B "),K())}function lg(r,e){if(r&1&&ae(0),r&2){let t=ce().$implicit,n=ce(3);ot(" ",n.renameCondition[t.condition_B]," ")}}function ug(r,e){if(r&1&&ae(0),r&2){let t=ce().$implicit;ot(" ",t.condition_B," ")}}function cg(r,e){if(r&1&&(U(0,"td",25),ke(1,lg,1,1)(2,ug,1,1),K()),r&2){let t=ce(3);ie(),Ue(t.renameCondition?1:2)}}function dg(r,e){r&1&&(U(0,"th",24),ae(1," Comparison "),K())}function hg(r,e){if(r&1&&(U(0,"td",25),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.comparison_label," ")}}function fg(r,e){r&1&&Fe(0,"tr",26)}function vg(r,e){r&1&&Fe(0,"tr",27)}function pg(r,e){if(r&1&&(U(0,"table",5),Ut(1,12),ke(2,Yp,2,0,"th",13)(3,qp,2,1,"td",14),$t(),Ut(4,15),ke(5,Xp,2,0,"th",13)(6,Kp,2,1,"td",14),$t(),Ut(7,16),ke(8,Zp,2,0,"th",13)(9,Qp,2,1,"td",14),$t(),Ut(10,17),ke(11,Jp,2,0,"th",13)(12,eg,2,1,"td",14),$t(),Ut(13,18),ke(14,tg,2,0,"th",13)(15,rg,2,1,"td",14),$t(),Ut(16,19),ke(17,ng,2,0,"th",13)(18,og,3,1,"td",14),$t(),Ut(19,20),ke(20,sg,2,0,"th",13)(21,cg,3,1,"td",14),$t(),Ut(22,21),ke(23,dg,2,0,"th",13)(24,hg,2,1,"td",14),$t(),ke(25,fg,1,0,"tr",22)(26,vg,1,0,"tr",23),K()),r&2){let t=ce(2);Ee("dataSource",t.searchResults),ie(25),Ee("matHeaderRowDef",t.searchResultDisplayColumns),ie(),Ee("matRowDefColumns",t.searchResultDisplayColumns)}}function gg(r,e){if(r&1){let t=$e();U(0,"button",28),ge("click",function(){De(t);let i=ce(2);return Pe(i.deleteProject.emit(i.project))}),U(1,"mat-icon"),ae(2,"delete"),K()()}if(r&2){let t=ce(2);Rl("matTooltip","Delete Project ",t.project.name," from collate")}}function mg(r,e){if(r&1&&(U(0,"a",7)(1,"mat-icon"),ae(2,"link"),K()()),r&2){let t=ce(2);Rl("href","/#/project/",t.project.id,"",Mc)}}function yg(r,e){if(r&1){let t=$e();U(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"span",2),ae(4),K()(),U(5,"mat-card-subtitle"),ae(6),K()(),U(7,"mat-card-content"),ke(8,Gp,5,2,"div",3),U(9,"div",4),ge("cdkDropListDropped",function(i){De(t);let a=ce();return Pe(a.drop(i))}),ke(10,$p,2,0)(11,Wp,2,0,"p"),K(),ke(12,pg,27,3,"table",5),K(),U(13,"mat-card-actions"),ke(14,gg,3,2,"button",6)(15,mg,3,2,"a",7),K()()}if(r&2){let t=ce();ie(4),ct(t.project.name),ie(2),ct(t.project.description),ie(2),Ue(t.searchResults.length>0?8:-1),ie(2),Ue(t.searchResults.length>0?10:11),ie(2),Ue(t.searchResults.length>0&&t.viewDifferentialAnalysis?12:-1),ie(2),Ue(t.accounts.loggedIn?14:-1),ie(),Ue(t.project?15:-1)}}var dd=(()=>{class r{set project(t){this._project=t}get project(){return this._project}set searchResults(t){this._searchResults=t,console.log(t)}get searchResults(){return this._searchResults}constructor(t){this.accounts=t,this._project=null,this.searchTerm="",this._searchResults=[],this.colorMap={},this.renameCondition={},this.deleteProject=new xt,this.searchResultsChange=new xt,this.searchResultDisplayColumns=["primary_id","uniprot_id","gene_name","condition_A","condition_B","log2_fc","log10_p","comparison_label"],this.expanded=!1,this.viewDifferentialAnalysis=!1}drop(t){let i=this._searchResults[t.previousIndex].analysis_group.id,a=this._searchResults.filter(o=>o.analysis_group.id===i);this._searchResults=this._searchResults.filter(o=>o.analysis_group.id!==i),this._searchResults.splice(t.currentIndex,0,...a),this.searchResultsChange.emit(this._searchResults)}static{this.\u0275fac=function(n){return new(n||r)(Oe(Zr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-card-viewer"]],inputs:{searchTerm:"searchTerm",project:"project",searchResults:"searchResults",colorMap:"colorMap",renameCondition:"renameCondition"},outputs:{deleteProject:"deleteProject",searchResultsChange:"searchResultsChange"},decls:1,vars:1,consts:[["appearance","outlined"],["cdkDragHandle",""],[2,"color","#ba0000"],[2,"display","flex","flex-direction","column","gap","20px"],["cdkDropList","",2,"display","flex","gap","20px","flex-wrap","wrap","justify-content","center",3,"cdkDropListDropped"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-icon-button","","color","primary",3,"matTooltip"],["target","_blank",3,"href"],[3,"change","color"],["cdkDrag",""],["mat-icon-button","","cdkDragHandle","",3,"matTooltip"],[3,"searchTerm","expanded","renameCondition","colorMap","data"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["matColumnDef","log10_p"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","comparison_label"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click","matTooltip"]],template:function(n,i){n&1&&ke(0,yg,16,7,"mat-card",0),n&2&&Ue(i.project?0:-1)},dependencies:[Gc,zc,Hc,Oi,Ri,as,cd,jc,ar,Xr,Dn,Pn,Zo,Yo,Xo,Ko,es,Qo,ts,Jo,Wo,qo,od,Li],encapsulation:2})}}return r})();var Cg=(r,e)=>e.id,wg=()=>[];function bg(r,e){if(r&1){let t=$e();U(0,"app-project-card-viewer",3),ge("deleteProject",function(i){De(t);let a=ce(2);return Pe(a.deleteProject.emit(i))}),K()}if(r&2){let t=ce().$implicit,n=ce();Ee("searchTerm",n.searchTerm)("colorMap",n.projectConditionColorMap==null?null:n.projectConditionColorMap[t.id])("project",t)("searchResults",n.filteredResults[t.id]||Io(5,wg))("renameCondition",n.renameCondition==null?null:n.renameCondition[t.id])}}function xg(r,e){if(r&1&&(U(0,"div",1),ke(1,bg,1,6,"app-project-card-viewer",2),K()),r&2){let t=e.$implicit;ie(),Ue(t&&t.id?1:-1)}}var cs=(()=>{class r{constructor(){this._searchTerm="",this.projects=[],this._filteredResults={},this.projectConditionColorMap={},this.renameCondition={},this.projectOrderChanged=new xt,this.deleteProject=new xt}set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set filteredResults(t){console.log(t),t?this._filteredResults=t:this._filteredResults={}}get filteredResults(){return this._filteredResults}drop(t){Qn(this.projects,t.previousIndex,t.currentIndex),this.projectOrderChanged.emit(this.projects)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-list"]],inputs:{searchTerm:"searchTerm",projects:"projects",filteredResults:"filteredResults",projectConditionColorMap:"projectConditionColorMap",renameCondition:"renameCondition"},outputs:{projectOrderChanged:"projectOrderChanged",deleteProject:"deleteProject"},decls:3,vars:0,consts:[["cdkDropList","",1,"project-list",3,"cdkDropListDropped"],[2,"margin","20px"],["cdkDrag","",3,"searchTerm","colorMap","project","searchResults","renameCondition"],["cdkDrag","",3,"deleteProject","searchTerm","colorMap","project","searchResults","renameCondition"]],template:function(n,i){n&1&&(U(0,"div",0),ge("cdkDropListDropped",function(o){return i.drop(o)}),tt(1,xg,2,1,"div",1,Cg),K()),n&2&&(ie(),rt(i.projects))},dependencies:[Pn,dd,Dn],encapsulation:2})}}return r})();var hd=(r,e)=>e.id;function Eg(r,e){if(r&1){let t=$e();U(0,"mat-chip",4),ge("removed",function(){let i=De(t).$implicit,a=ce(2);return Pe(a.removeTag(i))}),ae(1),U(2,"mat-icon",5),ae(3,"cancel"),K()()}if(r&2){let t=e.$implicit;ie(),ot(" ",t.name," ")}}function _g(r,e){if(r&1){let t=$e();U(0,"mat-chip-set",2),ge("cdkDropListDropped",function(i){De(t);let a=ce();return Pe(a.drop(i))}),tt(1,Eg,4,1,"mat-chip",3,hd),K()}if(r&2){let t=ce();ie(),rt(t.collageTags)}}function Tg(r,e){if(r&1&&(U(0,"mat-chip"),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t.name," ")}}function Sg(r,e){if(r&1&&(U(0,"mat-chip-set"),tt(1,Tg,2,1,"mat-chip",null,hd),K()),r&2){let t=ce();ie(),rt(t.collageTags)}}var ds=(()=>{class r{constructor(t){this.accounts=t,this.collageTags=[],this.collageTagsChange=new xt}removeTag(t){this.collageTags=this.collageTags.filter(n=>n!==t),this.collageTagsChange.emit(this.collageTags)}drop(t){Qn(this.collageTags,t.previousIndex,t.currentIndex),this.collageTagsChange.emit(this.collageTags)}static{this.\u0275fac=function(n){return new(n||r)(Oe(Zr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-tags"]],inputs:{collageTags:"collageTags"},outputs:{collageTagsChange:"collageTagsChange"},decls:4,vars:1,consts:[[2,"display","flex","justify-content","center"],["cdkDropList",""],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["cdkDrag","",3,"removed"],["matChipRemove",""]],template:function(n,i){n&1&&(U(0,"div",0),ke(1,_g,3,0,"mat-chip-set",1)(2,Sg,3,0,"mat-chip-set"),K(),Fe(3,"div",0)),n&2&&(ie(),Ue(i.accounts.loggedIn?1:2))},dependencies:[Pn,jo,zo,ar,Go,Dn],encapsulation:2})}}return r})();var vd=Eo(fd());function Mg(r,e){r&1&&(U(0,"div",2),Fe(1,"div",5),K())}var pd=(()=>{class r{set url(t){this.config.data=t,this._url=t}constructor(t){this.dialogRef=t,this._url="",this.config={width:250,height:250,data:this.url,margin:5,dotsOptions:{color:"#780101",type:"dots"},backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0}}}ngAfterViewInit(){let t=new vd.default(this.config),n=document.getElementById("canvas");n&&t.append(n),this.qrCode=t}close(){this.dialogRef.close()}download(){this.qrCode&&this.qrCode.download({name:"qrcode",extension:"svg"}).then(()=>{})}static{this.\u0275fac=function(n){return new(n||r)(Oe(At))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-qr-code-dialog"]],inputs:{url:"url"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","justify-content","center","align-items","center"],["mat-dialog-actions",""],["mat-button","",3,"click"],["id","canvas"]],template:function(n,i){n&1&&(U(0,"h1",0),ae(1,"Collate QR Code"),K(),U(2,"div",1),ke(3,Mg,2,0,"div",2),K(),U(4,"div",3)(5,"button",4),ge("click",function(){return i.close()}),ae(6,"Close"),K(),U(7,"button",4),ge("click",function(){return i.download()}),ae(8,"Download"),K()()),n&2&&(ie(3),Ue(i.config.data&&i.config.data!==""?3:-1))},dependencies:[Dt,Pt,Ot,yt],encapsulation:2})}}return r})();var gd=(r,e)=>e.id,Ag=()=>({standalone:!0});function Dg(r,e){if(r&1){let t=$e();U(0,"mat-checkbox",6),wr("ngModelChange",function(i){let a=De(t).$implicit,o=ce(2).$implicit,s=ce();return Cr(s.projectAnalysisGroupVisibilityMap[o.id][a.id],i)||(s.projectAnalysisGroupVisibilityMap[o.id][a.id]=i),Pe(i)}),ae(1),K()}if(r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();yr("ngModel",i.projectAnalysisGroupVisibilityMap[n.id][t.id]),Ee("ngModelOptions",Io(3,Ag)),ie(),ot(" ",t.name," ")}}function Pg(r,e){if(r&1&&tt(0,Dg,2,4,"mat-checkbox",5,gd),r&2){let t=ce().$implicit,n=ce();rt(n.projectAnalysisGroupMap[t.id])}}function Og(r,e){if(r&1&&(U(0,"h2"),ae(1),K(),ke(2,Pg,2,0)),r&2){let t=e.$implicit,n=ce();ie(),ct(t.name),ie(),Ue(n.projectAnalysisGroupMap[t.id]?2:-1)}}var hs=(()=>{class r{set projects(t){this._projects=t}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}set projectAnalysisGroupVisibilityMap(t){this._projectAnalysisGroupVisibilityMap={};for(let n in t){this._projectAnalysisGroupVisibilityMap[n]={};for(let i in t[n])this._projectAnalysisGroupVisibilityMap[n][i]=t[n][i]}}get projectAnalysisGroupVisibilityMap(){return this._projectAnalysisGroupVisibilityMap}constructor(t){this.dialog=t,this._projects=[],this._projectAnalysisGroupMap={},this._projectAnalysisGroupVisibilityMap={}}close(){this.dialog.close()}save(){this.dialog.close(this.projectAnalysisGroupVisibilityMap)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-analysis-group-visibility-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap",projectAnalysisGroupVisibilityMap:"projectAnalysisGroupVisibilityMap"},decls:11,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"]],template:function(n,i){n&1&&(U(0,"h1",0),ae(1,"Analysis Group Visibility"),K(),U(2,"div",1)(3,"form",2),tt(4,Og,3,2,null,null,gd),K()(),U(6,"div",3)(7,"button",4),ge("click",function(){return i.close()}),ae(8,"Cancel"),K(),U(9,"button",4),ge("click",function(){return i.save()}),ae(10,"Submit"),K()()),n&2&&(ie(4),rt(i.projects))},dependencies:[Dt,Pt,Mn,qt,Et,Yt,Sn,Yc,zi,Ot,yt],encapsulation:2})}}return r})();function Gt(r){"@babel/helpers - typeof";return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(r)}function Un(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function md(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function $n(r,e,t){return e&&md(r.prototype,e),t&&md(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function kh(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Bt(r,e){return Ig(r)||Ng(r,e)||wu(r,e)||Fg()}function Fh(r){return Rg(r)||Lg(r)||wu(r)||kg()}function Rg(r){if(Array.isArray(r))return nu(r)}function Ig(r){if(Array.isArray(r))return r}function Lg(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ng(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],i=!0,a=!1,o,s;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(u){a=!0,s=u}finally{try{!i&&t.return!=null&&t.return()}finally{if(a)throw s}}return n}}function wu(r,e){if(r){if(typeof r=="string")return nu(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nu(r,e)}}function nu(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function kg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mr(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=wu(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return a=u.done,u},e:function(u){o=!0,s=u},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}var Vt=typeof window>"u"?null:window,yd=Vt?Vt.navigator:null;Vt&&Vt.document;var Bg=Gt(""),Bh=Gt({}),Vg=Gt(function(){}),zg=typeof HTMLElement>"u"?"undefined":Gt(HTMLElement),Za=function(e){return e&&e.instanceString&&Mt(e.instanceString)?e.instanceString():null},We=function(e){return e!=null&&Gt(e)==Bg},Mt=function(e){return e!=null&&Gt(e)===Vg},gt=function(e){return!Ar(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},ut=function(e){return e!=null&&Gt(e)===Bh&&!gt(e)&&e.constructor===Object},Gg=function(e){return e!=null&&Gt(e)===Bh},Ne=function(e){return e!=null&&Gt(e)===Gt(1)&&!isNaN(e)},jg=function(e){return Ne(e)&&Math.floor(e)===e},ks=function(e){if(zg!=="undefined")return e!=null&&e instanceof HTMLElement},Ar=function(e){return Qa(e)||Vh(e)},Qa=function(e){return Za(e)==="collection"&&e._private.single},Vh=function(e){return Za(e)==="collection"&&!e._private.single},bu=function(e){return Za(e)==="core"},zh=function(e){return Za(e)==="stylesheet"},Hg=function(e){return Za(e)==="event"},Bn=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},Ug=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},$g=function(e){return ut(e)&&Ne(e.x1)&&Ne(e.x2)&&Ne(e.y1)&&Ne(e.y2)},Wg=function(e){return Gg(e)&&Mt(e.then)},Yg=function(){return yd&&yd.userAgent.match(/msie|trident|edge/i)},za=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);return a.join("$")});var n=function i(){var a=this,o=arguments,s,u=t.apply(a,o),l=i.cache;return(s=l[u])||(s=l[u]=e.apply(a,o)),s};return n.cache={},n},xu=za(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),qs=za(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),Gh=za(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),Cd=function(e){return Bn(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},zt="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",qg="rgb[a]?\\(("+zt+"[%]?)\\s*,\\s*("+zt+"[%]?)\\s*,\\s*("+zt+"[%]?)(?:\\s*,\\s*("+zt+"))?\\)",Xg="rgb[a]?\\((?:"+zt+"[%]?)\\s*,\\s*(?:"+zt+"[%]?)\\s*,\\s*(?:"+zt+"[%]?)(?:\\s*,\\s*(?:"+zt+"))?\\)",Kg="hsl[a]?\\(("+zt+")\\s*,\\s*("+zt+"[%])\\s*,\\s*("+zt+"[%])(?:\\s*,\\s*("+zt+"))?\\)",Zg="hsl[a]?\\((?:"+zt+")\\s*,\\s*(?:"+zt+"[%])\\s*,\\s*(?:"+zt+"[%])(?:\\s*,\\s*(?:"+zt+"))?\\)",Qg="\\#[0-9a-fA-F]{3}",Jg="\\#[0-9a-fA-F]{6}",jh=function(e,t){return e<t?-1:e>t?1:0},em=function(e,t){return-1*jh(e,t)},Ye=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var n=e[t];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var o=i[a];r[o]=n[o]}}return r},tm=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,n,i,a,o=16;return t?(n=parseInt(e[1]+e[1],o),i=parseInt(e[2]+e[2],o),a=parseInt(e[3]+e[3],o)):(n=parseInt(e[1]+e[2],o),i=parseInt(e[3]+e[4],o),a=parseInt(e[5]+e[6],o)),[n,i,a]}},rm=function(e){var t,n,i,a,o,s,u,l;function c(v,p,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?v+(p-v)*6*m:m<1/2?p:m<2/3?v+(p-v)*(2/3-m)*6:v}var d=new RegExp("^"+Kg+"$").exec(e);if(d){if(n=parseInt(d[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(d[2]),i<0||i>100||(i=i/100,a=parseFloat(d[3]),a<0||a>100)||(a=a/100,o=d[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(i===0)s=u=l=Math.round(a*255);else{var h=a<.5?a*(1+i):a+i-a*i,f=2*a-h;s=Math.round(255*c(f,h,n+1/3)),u=Math.round(255*c(f,h,n)),l=Math.round(255*c(f,h,n-1/3))}t=[s,u,l,o]}return t},nm=function(e){var t,n=new RegExp("^"+qg+"$").exec(e);if(n){t=[];for(var i=[],a=1;a<=3;a++){var o=n[a];if(o[o.length-1]==="%"&&(i[a]=!0),o=parseFloat(o),i[a]&&(o=o/100*255),o<0||o>255)return;t.push(Math.floor(o))}var s=i[1]||i[2]||i[3],u=i[1]&&i[2]&&i[3];if(s&&!u)return;var l=n[4];if(l!==void 0){if(l=parseFloat(l),l<0||l>1)return;t.push(l)}}return t},im=function(e){return am[e.toLowerCase()]},Hh=function(e){return(gt(e)?e:null)||im(e)||tm(e)||nm(e)||rm(e)},am={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Uh=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(ut(o))throw Error("Tried to set map with object key");a<n.length-1?(t[o]==null&&(t[o]={}),t=t[o]):t[o]=e.value}},$h=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(ut(o))throw Error("Tried to get map with object key");if(t=t[o],t==null)return t}return t};function om(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var oi=om,Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sm(r,e){return e={exports:{}},r(e,e.exports),e.exports}var lm=typeof Oa=="object"&&Oa&&Oa.Object===Object&&Oa,um=lm,cm=typeof self=="object"&&self&&self.Object===Object&&self,dm=um||cm||Function("return this")(),Xs=dm,hm=function(){return Xs.Date.now()},Gl=hm,fm=/\s/;function vm(r){for(var e=r.length;e--&&fm.test(r.charAt(e)););return e}var pm=vm,gm=/^\s+/;function mm(r){return r&&r.slice(0,pm(r)+1).replace(gm,"")}var ym=mm,Cm=Xs.Symbol,Ji=Cm,Wh=Object.prototype,wm=Wh.hasOwnProperty,bm=Wh.toString,_a=Ji?Ji.toStringTag:void 0;function xm(r){var e=wm.call(r,_a),t=r[_a];try{r[_a]=void 0;var n=!0}catch{}var i=bm.call(r);return n&&(e?r[_a]=t:delete r[_a]),i}var Em=xm,_m=Object.prototype,Tm=_m.toString;function Sm(r){return Tm.call(r)}var Mm=Sm,Am="[object Null]",Dm="[object Undefined]",wd=Ji?Ji.toStringTag:void 0;function Pm(r){return r==null?r===void 0?Dm:Am:wd&&wd in Object(r)?Em(r):Mm(r)}var Yh=Pm;function Om(r){return r!=null&&typeof r=="object"}var Rm=Om,Im="[object Symbol]";function Lm(r){return typeof r=="symbol"||Rm(r)&&Yh(r)==Im}var Ja=Lm,bd=NaN,Nm=/^[-+]0x[0-9a-f]+$/i,km=/^0b[01]+$/i,Fm=/^0o[0-7]+$/i,Bm=parseInt;function Vm(r){if(typeof r=="number")return r;if(Ja(r))return bd;if(oi(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=oi(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=ym(r);var t=km.test(r);return t||Fm.test(r)?Bm(r.slice(2),t?2:8):Nm.test(r)?bd:+r}var xd=Vm,zm="Expected a function",Gm=Math.max,jm=Math.min;function Hm(r,e,t){var n,i,a,o,s,u,l=0,c=!1,d=!1,h=!0;if(typeof r!="function")throw new TypeError(zm);e=xd(e)||0,oi(t)&&(c=!!t.leading,d="maxWait"in t,a=d?Gm(xd(t.maxWait)||0,e):a,h="trailing"in t?!!t.trailing:h);function f(P){var O=n,I=i;return n=i=void 0,l=P,o=r.apply(I,O),o}function v(P){return l=P,s=setTimeout(g,e),c?f(P):o}function p(P){var O=P-u,I=P-l,R=e-O;return d?jm(R,a-I):R}function m(P){var O=P-u,I=P-l;return u===void 0||O>=e||O<0||d&&I>=a}function g(){var P=Gl();if(m(P))return y(P);s=setTimeout(g,p(P))}function y(P){return s=void 0,h&&n?f(P):(n=i=void 0,o)}function b(){s!==void 0&&clearTimeout(s),l=0,n=u=i=s=void 0}function S(){return s===void 0?o:y(Gl())}function A(){var P=Gl(),O=m(P);if(n=arguments,i=this,u=P,O){if(s===void 0)return v(u);if(d)return clearTimeout(s),s=setTimeout(g,e),f(u)}return s===void 0&&(s=setTimeout(g,e)),o}return A.cancel=b,A.flush=S,A}var eo=Hm,jl=Vt?Vt.performance:null,qh=jl&&jl.now?function(){return jl.now()}:function(){return Date.now()},Um=function(){if(Vt){if(Vt.requestAnimationFrame)return function(r){Vt.requestAnimationFrame(r)};if(Vt.mozRequestAnimationFrame)return function(r){Vt.mozRequestAnimationFrame(r)};if(Vt.webkitRequestAnimationFrame)return function(r){Vt.webkitRequestAnimationFrame(r)};if(Vt.msRequestAnimationFrame)return function(r){Vt.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(qh())},1e3/60)}}(),Fs=function(e){return Um(e)},hn=qh,Wi=9261,Xh=65599,Ra=5381,Kh=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wi,n=t,i;i=e.next(),!i.done;)n=n*Xh+i.value|0;return n},Ga=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wi;return t*Xh+e|0},ja=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ra;return(t<<5)+t+e|0},$m=function(e,t){return e*2097152+t},Rn=function(e){return e[0]*2097152+e[1]},fs=function(e,t){return[Ga(e[0],t[0]),ja(e[1],t[1])]},Wm=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return Kh(o,t)},Vn=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return Kh(o,t)},Zh=function(){return Ym(arguments)},Ym=function(e){for(var t,n=0;n<e.length;n++){var i=e[n];n===0?t=Vn(i):t=Vn(i,t)}return t},Ed=!0,qm=console.warn!=null,Xm=console.trace!=null,Eu=Number.MAX_SAFE_INTEGER||9007199254740991,Qh=function(){return!0},Bs=function(){return!1},_d=function(){return 0},_u=function(){},St=function(e){throw new Error(e)},Jh=function(e){if(e!==void 0)Ed=!!e;else return Ed},ft=function(e){Jh()&&(qm?console.warn(e):(console.log(e),Xm&&console.trace()))},Km=function(e){return Ye({},e)},en=function(e){return e==null?e:gt(e)?e.slice():ut(e)?Km(e):e},Zm=function(e){return e.slice()},ef=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},Qm={},tf=function(){return Qm},Jt=function(e){var t=Object.keys(e);return function(n){for(var i={},a=0;a<t.length;a++){var o=t[a],s=n?.[o];i[o]=s===void 0?e[o]:s}return i}},zn=function(e,t,n){for(var i=e.length-1;i>=0&&!(e[i]===t&&(e.splice(i,1),n));i--);},Tu=function(e){e.splice(0,e.length)},Jm=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.push(i)}},Gr=function(e,t,n){return n&&(t=Gh(n,t)),e[t]},Ln=function(e,t,n,i){n&&(t=Gh(n,t)),e[t]=i},e0=function(){function r(){Un(this,r),this._obj={}}return $n(r,[{key:"set",value:function(t,n){return this._obj[t]=n,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}]),r}(),tn=typeof Map<"u"?Map:e0,t0="undefined",r0=function(){function r(e){if(Un(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var n=0;n<t.length;n++)this.add(t[n])}}return $n(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var n=this._obj;n[t]!==1&&(n[t]=1,this.size++)}},{key:"delete",value:function(t){var n=this._obj;n[t]===1&&(n[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(n){return t.has(n)})}},{key:"forEach",value:function(t,n){return this.toArray().forEach(t,n)}}]),r}(),na=(typeof Set>"u"?"undefined":Gt(Set))!==t0?Set:r0,Ks=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!bu(e)){St("An element must have a core reference and parameters set");return}var i=t.group;if(i==null&&(t.data&&t.data.source!=null&&t.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){St("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?i==="edges":!!t.pannable,active:!1,classes:new na,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var o=t.renderedPosition,s=e.pan(),u=e.zoom();a.position={x:(o.x-s.x)/u,y:(o.y-s.y)/u}}var l=[];gt(t.classes)?l=t.classes:We(t.classes)&&(l=t.classes.split(/\s+/));for(var c=0,d=l.length;c<d;c++){var h=l[c];!h||h===""||a.classes.add(h)}this.createEmitter();var f=t.style||t.css;f&&(ft("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(f)),(n===void 0||n)&&this.restore()},Td=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var o;ut(n)&&!Ar(n)&&(o=n,n=o.roots||o.root,i=o.visit,a=o.directed),a=arguments.length===2&&!Mt(i)?i:a,i=Mt(i)?i:function(){};for(var s=this._private.cy,u=n=We(n)?this.filter(n):n,l=[],c=[],d={},h={},f={},v=0,p,m=this.byGroup(),g=m.nodes,y=m.edges,b=0;b<u.length;b++){var S=u[b],A=S.id();S.isNode()&&(l.unshift(S),e.bfs&&(f[A]=!0,c.push(S)),h[A]=0)}for(var P=function(){var _=e.bfs?l.shift():l.pop(),E=_.id();if(e.dfs){if(f[E])return"continue";f[E]=!0,c.push(_)}var x=h[E],C=d[E],T=C!=null?C.source():null,M=C!=null?C.target():null,D=C==null?void 0:_.same(T)?M[0]:T[0],F=void 0;if(F=i(_,C,D,v++,x),F===!0)return p=_,"break";if(F===!1)return"break";for(var N=_.connectedEdges().filter(function(J){return(!a||J.source().same(_))&&y.has(J)}),z=0;z<N.length;z++){var q=N[z],$=q.connectedNodes().filter(function(J){return!J.same(_)&&g.has(J)}),ee=$.id();$.length!==0&&!f[ee]&&($=$[0],l.push($),e.bfs&&(f[ee]=!0,c.push($)),d[ee]=q,h[ee]=h[E]+1)}};l.length!==0;){var O=P();if(O!=="continue"&&O==="break")break}for(var I=s.collection(),R=0;R<c.length;R++){var L=c[R],B=d[L.id()];B!=null&&I.push(B),I.push(L)}return{path:s.collection(I),found:s.collection(p)}}},Ha={breadthFirstSearch:Td({bfs:!0}),depthFirstSearch:Td({dfs:!0})};Ha.bfs=Ha.breadthFirstSearch;Ha.dfs=Ha.depthFirstSearch;var n0=sm(function(r,e){(function(){var t,n,i,a,o,s,u,l,c,d,h,f,v,p,m;i=Math.floor,d=Math.min,n=function(g,y){return g<y?-1:g>y?1:0},c=function(g,y,b,S,A){var P;if(b==null&&(b=0),A==null&&(A=n),b<0)throw new Error("lo must be non-negative");for(S==null&&(S=g.length);b<S;)P=i((b+S)/2),A(y,g[P])<0?S=P:b=P+1;return[].splice.apply(g,[b,b-b].concat(y)),y},s=function(g,y,b){return b==null&&(b=n),g.push(y),p(g,0,g.length-1,b)},o=function(g,y){var b,S;return y==null&&(y=n),b=g.pop(),g.length?(S=g[0],g[0]=b,m(g,0,y)):S=b,S},l=function(g,y,b){var S;return b==null&&(b=n),S=g[0],g[0]=y,m(g,0,b),S},u=function(g,y,b){var S;return b==null&&(b=n),g.length&&b(g[0],y)<0&&(S=[g[0],y],y=S[0],g[0]=S[1],m(g,0,b)),y},a=function(g,y){var b,S,A,P,O,I;for(y==null&&(y=n),P=function(){I=[];for(var R=0,L=i(g.length/2);0<=L?R<L:R>L;0<=L?R++:R--)I.push(R);return I}.apply(this).reverse(),O=[],S=0,A=P.length;S<A;S++)b=P[S],O.push(m(g,b,y));return O},v=function(g,y,b){var S;if(b==null&&(b=n),S=g.indexOf(y),S!==-1)return p(g,0,S,b),m(g,S,b)},h=function(g,y,b){var S,A,P,O,I;if(b==null&&(b=n),A=g.slice(0,y),!A.length)return A;for(a(A,b),I=g.slice(y),P=0,O=I.length;P<O;P++)S=I[P],u(A,S,b);return A.sort(b).reverse()},f=function(g,y,b){var S,A,P,O,I,R,L,B,w;if(b==null&&(b=n),y*10<=g.length){if(P=g.slice(0,y).sort(b),!P.length)return P;for(A=P[P.length-1],L=g.slice(y),O=0,R=L.length;O<R;O++)S=L[O],b(S,A)<0&&(c(P,S,0,null,b),P.pop(),A=P[P.length-1]);return P}for(a(g,b),w=[],I=0,B=d(y,g.length);0<=B?I<B:I>B;0<=B?++I:--I)w.push(o(g,b));return w},p=function(g,y,b,S){var A,P,O;for(S==null&&(S=n),A=g[b];b>y;){if(O=b-1>>1,P=g[O],S(A,P)<0){g[b]=P,b=O;continue}break}return g[b]=A},m=function(g,y,b){var S,A,P,O,I;for(b==null&&(b=n),A=g.length,I=y,P=g[y],S=2*y+1;S<A;)O=S+1,O<A&&!(b(g[S],g[O])<0)&&(S=O),g[y]=g[S],y=S,S=2*y+1;return g[y]=P,p(g,I,y,b)},t=function(){g.push=s,g.pop=o,g.replace=l,g.pushpop=u,g.heapify=a,g.updateItem=v,g.nlargest=h,g.nsmallest=f;function g(y){this.cmp=y??n,this.nodes=[]}return g.prototype.push=function(y){return s(this.nodes,y,this.cmp)},g.prototype.pop=function(){return o(this.nodes,this.cmp)},g.prototype.peek=function(){return this.nodes[0]},g.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},g.prototype.replace=function(y){return l(this.nodes,y,this.cmp)},g.prototype.pushpop=function(y){return u(this.nodes,y,this.cmp)},g.prototype.heapify=function(){return a(this.nodes,this.cmp)},g.prototype.updateItem=function(y){return v(this.nodes,y,this.cmp)},g.prototype.clear=function(){return this.nodes=[]},g.prototype.empty=function(){return this.nodes.length===0},g.prototype.size=function(){return this.nodes.length},g.prototype.clone=function(){var y;return y=new g,y.nodes=this.nodes.slice(0),y},g.prototype.toArray=function(){return this.nodes.slice(0)},g.prototype.insert=g.prototype.push,g.prototype.top=g.prototype.peek,g.prototype.front=g.prototype.peek,g.prototype.has=g.prototype.contains,g.prototype.copy=g.prototype.clone,g}(),function(g,y){return r.exports=y()}(this,function(){return t})}).call(Oa)}),to=n0,i0=Jt({root:null,weight:function(e){return 1},directed:!1}),a0={dijkstra:function(e){if(!ut(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=i0(e),i=n.root,a=n.weight,o=n.directed,s=this,u=a,l=We(i)?this.filter(i)[0]:i[0],c={},d={},h={},f=this.byGroup(),v=f.nodes,p=f.edges;p.unmergeBy(function(x){return x.isLoop()});for(var m=function(C){return c[C.id()]},g=function(C,T){c[C.id()]=T,y.updateItem(C)},y=new to(function(x,C){return m(x)-m(C)}),b=0;b<v.length;b++){var S=v[b];c[S.id()]=S.same(l)?0:1/0,y.push(S)}for(var A=function(C,T){for(var M=(o?C.edgesTo(T):C.edgesWith(T)).intersect(p),D=1/0,F,N=0;N<M.length;N++){var z=M[N],q=u(z);(q<D||!F)&&(D=q,F=z)}return{edge:F,dist:D}};y.size()>0;){var P=y.pop(),O=m(P),I=P.id();if(h[I]=O,O!==1/0)for(var R=P.neighborhood().intersect(v),L=0;L<R.length;L++){var B=R[L],w=B.id(),_=A(P,B),E=O+_.dist;E<m(B)&&(g(B,E),d[w]={node:P,edge:_.edge})}}return{distanceTo:function(C){var T=We(C)?v.filter(C)[0]:C[0];return h[T.id()]},pathTo:function(C){var T=We(C)?v.filter(C)[0]:C[0],M=[],D=T,F=D.id();if(T.length>0)for(M.unshift(T);d[F];){var N=d[F];M.unshift(N.edge),M.unshift(N.node),D=N.node,F=D.id()}return s.spawn(M)}}}},o0={kruskal:function(e){e=e||function(b){return 1};for(var t=this.byGroup(),n=t.nodes,i=t.edges,a=n.length,o=new Array(a),s=n,u=function(S){for(var A=0;A<o.length;A++){var P=o[A];if(P.has(S))return A}},l=0;l<a;l++)o[l]=this.spawn(n[l]);for(var c=i.sort(function(b,S){return e(b)-e(S)}),d=0;d<c.length;d++){var h=c[d],f=h.source()[0],v=h.target()[0],p=u(f),m=u(v),g=o[p],y=o[m];p!==m&&(s.merge(h),g.merge(y),o.splice(m,1))}return s}},s0=Jt({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),l0={aStar:function(e){var t=this.cy(),n=s0(e),i=n.root,a=n.goal,o=n.heuristic,s=n.directed,u=n.weight;i=t.collection(i)[0],a=t.collection(a)[0];var l=i.id(),c=a.id(),d={},h={},f={},v=new to(function(F,N){return h[F.id()]-h[N.id()]}),p=new na,m={},g={},y=function(N,z){v.push(N),p.add(z)},b,S,A=function(){b=v.pop(),S=b.id(),p.delete(S)},P=function(N){return p.has(N)};y(i,l),d[l]=0,h[l]=o(i);for(var O=0;v.size()>0;){if(A(),O++,S===c){for(var I=[],R=a,L=c,B=g[L];I.unshift(R),B!=null&&I.unshift(B),R=m[L],R!=null;)L=R.id(),B=g[L];return{found:!0,distance:d[S],path:this.spawn(I),steps:O}}f[S]=!0;for(var w=b._private.edges,_=0;_<w.length;_++){var E=w[_];if(this.hasElementWithId(E.id())&&!(s&&E.data("source")!==S)){var x=E.source(),C=E.target(),T=x.id()!==S?x:C,M=T.id();if(this.hasElementWithId(M)&&!f[M]){var D=d[S]+u(E);if(!P(M)){d[M]=D,h[M]=D+o(T),y(T,M),m[M]=b,g[M]=E;continue}D<d[M]&&(d[M]=D,h[M]=D+o(T),m[M]=b,g[M]=E)}}}}return{found:!1,distance:void 0,path:void 0,steps:O}}},u0=Jt({weight:function(e){return 1},directed:!1}),c0={floydWarshall:function(e){for(var t=this.cy(),n=u0(e),i=n.weight,a=n.directed,o=i,s=this.byGroup(),u=s.nodes,l=s.edges,c=u.length,d=c*c,h=function(q){return u.indexOf(q)},f=function(q){return u[q]},v=new Array(d),p=0;p<d;p++){var m=p%c,g=(p-m)/c;g===m?v[p]=0:v[p]=1/0}for(var y=new Array(d),b=new Array(d),S=0;S<l.length;S++){var A=l[S],P=A.source()[0],O=A.target()[0];if(P!==O){var I=h(P),R=h(O),L=I*c+R,B=o(A);if(v[L]>B&&(v[L]=B,y[L]=R,b[L]=A),!a){var w=R*c+I;!a&&v[w]>B&&(v[w]=B,y[w]=I,b[w]=A)}}}for(var _=0;_<c;_++)for(var E=0;E<c;E++)for(var x=E*c+_,C=0;C<c;C++){var T=E*c+C,M=_*c+C;v[x]+v[M]<v[T]&&(v[T]=v[x]+v[M],y[T]=y[x])}var D=function(q){return(We(q)?t.filter(q):q)[0]},F=function(q){return h(D(q))},N={distance:function(q,$){var ee=F(q),J=F($);return v[ee*c+J]},path:function(q,$){var ee=F(q),J=F($),j=f(ee);if(ee===J)return j.collection();if(y[ee*c+J]==null)return t.collection();var Z=t.collection(),H=ee,k;for(Z.merge(j);ee!==J;)H=ee,ee=y[ee*c+J],k=b[H*c+ee],Z.merge(k),Z.merge(f(ee));return Z}};return N}},d0=Jt({weight:function(e){return 1},directed:!1,root:null}),h0={bellmanFord:function(e){var t=this,n=d0(e),i=n.weight,a=n.directed,o=n.root,s=i,u=this,l=this.cy(),c=this.byGroup(),d=c.edges,h=c.nodes,f=h.length,v=new tn,p=!1,m=[];o=l.collection(o)[0],d.unmergeBy(function(fe){return fe.isLoop()});for(var g=d.length,y=function(ue){var de=v.get(ue.id());return de||(de={},v.set(ue.id(),de)),de},b=function(ue){return(We(ue)?l.$(ue):ue)[0]},S=function(ue){return y(b(ue)).dist},A=function(ue){for(var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,ye=b(ue),Se=[],xe=ye;;){if(xe==null)return t.spawn();var Ce=y(xe),_e=Ce.edge,be=Ce.pred;if(Se.unshift(xe[0]),xe.same(de)&&Se.length>0)break;_e!=null&&Se.unshift(_e),xe=be}return u.spawn(Se)},P=0;P<f;P++){var O=h[P],I=y(O);O.same(o)?I.dist=0:I.dist=1/0,I.pred=null,I.edge=null}for(var R=!1,L=function(ue,de,ye,Se,xe,Ce){var _e=Se.dist+Ce;_e<xe.dist&&!ye.same(Se.edge)&&(xe.dist=_e,xe.pred=ue,xe.edge=ye,R=!0)},B=1;B<f;B++){R=!1;for(var w=0;w<g;w++){var _=d[w],E=_.source(),x=_.target(),C=s(_),T=y(E),M=y(x);L(E,x,_,T,M,C),a||L(x,E,_,M,T,C)}if(!R)break}if(R)for(var D=[],F=0;F<g;F++){var N=d[F],z=N.source(),q=N.target(),$=s(N),ee=y(z).dist,J=y(q).dist;if(ee+$<J||!a&&J+$<ee)if(p||(ft("Graph contains a negative weight cycle for Bellman-Ford"),p=!0),e.findNegativeWeightCycles!==!1){var j=[];ee+$<J&&j.push(z),!a&&J+$<ee&&j.push(q);for(var Z=j.length,H=0;H<Z;H++){var k=j[H],G=[k];G.push(y(k).edge);for(var W=y(k).pred;G.indexOf(W)===-1;)G.push(W),G.push(y(W).edge),W=y(W).pred;G=G.slice(G.indexOf(W));for(var te=G[0].id(),X=0,me=2;me<G.length;me+=2)G[me].id()<te&&(te=G[me].id(),X=me);G=G.slice(X).concat(G.slice(0,X)),G.push(G[0]);var Te=G.map(function(fe){return fe.id()}).join(",");D.indexOf(Te)===-1&&(m.push(u.spawn(G)),D.push(Te))}}else break}return{distanceTo:S,pathTo:A,hasNegativeWeightCycle:p,negativeWeightCycles:m}}},f0=Math.sqrt(2),v0=function(e,t,n){n.length===0&&St("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],o=i[2],s=t[a],u=t[o],l=n,c=l.length-1;c>=0;c--){var d=l[c],h=d[1],f=d[2];(t[h]===s&&t[f]===u||t[h]===u&&t[f]===s)&&l.splice(c,1)}for(var v=0;v<l.length;v++){var p=l[v];p[1]===u?(l[v]=p.slice(),l[v][1]=s):p[2]===u&&(l[v]=p.slice(),l[v][2]=s)}for(var m=0;m<t.length;m++)t[m]===u&&(t[m]=s);return l},Hl=function(e,t,n,i){for(;n>i;){var a=Math.floor(Math.random()*t.length);t=v0(a,e,t),n--}return t},p0={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,i=t.edges;i.unmergeBy(function(M){return M.isLoop()});var a=n.length,o=i.length,s=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),u=Math.floor(a/f0);if(a<2){St("At least 2 nodes are required for Karger-Stein algorithm");return}for(var l=[],c=0;c<o;c++){var d=i[c];l.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var h=1/0,f=[],v=new Array(a),p=new Array(a),m=new Array(a),g=function(D,F){for(var N=0;N<a;N++)F[N]=D[N]},y=0;y<=s;y++){for(var b=0;b<a;b++)p[b]=b;var S=Hl(p,l.slice(),a,u),A=S.slice();g(p,m);var P=Hl(p,S,u,2),O=Hl(m,A,u,2);P.length<=O.length&&P.length<h?(h=P.length,f=P,g(p,v)):O.length<=P.length&&O.length<h&&(h=O.length,f=O,g(m,v))}for(var I=this.spawn(f.map(function(M){return i[M[0]]})),R=this.spawn(),L=this.spawn(),B=v[0],w=0;w<v.length;w++){var _=v[w],E=n[w];_===B?R.merge(E):L.merge(E)}var x=function(D){var F=e.spawn();return D.forEach(function(N){F.merge(N),N.connectedEdges().forEach(function(z){e.contains(z)&&!I.contains(z)&&F.merge(z)})}),F},C=[x(R),x(L)],T={cut:I,components:C,partition1:R,partition2:L};return T}},g0=function(e){return{x:e.x,y:e.y}},Zs=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},rf=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},Yi=function(e){return{x:e[0],y:e[1]}},m0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.min(o,i))}return i},y0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.max(o,i))}return i},C0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,o=t;o<n;o++){var s=e[o];isFinite(s)&&(i+=s,a++)}return i/a},w0=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(t,n):(n<e.length&&e.splice(n,e.length-n),t>0&&e.splice(0,t));for(var s=0,u=e.length-1;u>=0;u--){var l=e[u];o?isFinite(l)||(e[u]=-1/0,s++):e.splice(u,1)}a&&e.sort(function(h,f){return h-f});var c=e.length,d=Math.floor(c/2);return c%2!==0?e[d+1+s]:(e[d-1+s]+e[d+s])/2},b0=function(e){return Math.PI*e/180},vs=function(e,t){return Math.atan2(t,e)-Math.PI/2},Su=Math.log2||function(r){return Math.log(r)/Math.log(2)},nf=function(e){return e>0?1:e<0?-1:0},si=function(e,t){return Math.sqrt(ti(e,t))},ti=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},x0=function(e){for(var t=e.length,n=0,i=0;i<t;i++)n+=e[i];for(var a=0;a<t;a++)e[a]=e[a]/n;return e},Qt=function(e,t,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*n},Xi=function(e,t,n,i){return{x:Qt(e.x,t.x,n.x,i),y:Qt(e.y,t.y,n.y,i)}},E0=function(e,t,n,i){var a={x:t.x-e.x,y:t.y-e.y},o=si(e,t),s={x:a.x/o,y:a.y/o};return n=n??0,i=i??n*o,{x:e.x+s.x*i,y:e.y+s.y*i}},Ua=function(e,t,n){return Math.max(e,Math.min(n,t))},Er=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},_0=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},T0=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},S0=function(e,t,n){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},af=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},M0=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},Ms=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},As=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,o;if(t.length===1)n=i=a=o=t[0];else if(t.length===2)n=a=t[0],o=i=t[1];else if(t.length===4){var s=Bt(t,4);n=s[0],i=s[1],a=s[2],o=s[3]}return e.x1-=o,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Sd=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},Mu=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},ea=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},A0=function(e,t){return ea(e,t.x,t.y)},of=function(e,t){return ea(e,t.x1,t.y1)&&ea(e,t.x2,t.y2)},sf=function(e,t,n,i,a,o,s){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",l=u==="auto"?li(a,o):u,c=a/2,d=o/2;l=Math.min(l,c,d);var h=l!==c,f=l!==d,v;if(h){var p=n-c+l-s,m=i-d-s,g=n+c-l+s,y=m;if(v=Nn(e,t,n,i,p,m,g,y,!1),v.length>0)return v}if(f){var b=n+c+s,S=i-d+l-s,A=b,P=i+d-l+s;if(v=Nn(e,t,n,i,b,S,A,P,!1),v.length>0)return v}if(h){var O=n-c+l-s,I=i+d+s,R=n+c-l+s,L=I;if(v=Nn(e,t,n,i,O,I,R,L,!1),v.length>0)return v}if(f){var B=n-c-s,w=i-d+l-s,_=B,E=i+d-l+s;if(v=Nn(e,t,n,i,B,w,_,E,!1),v.length>0)return v}var x;{var C=n-c+l,T=i-d+l;if(x=Ia(e,t,n,i,C,T,l+s),x.length>0&&x[0]<=C&&x[1]<=T)return[x[0],x[1]]}{var M=n+c-l,D=i-d+l;if(x=Ia(e,t,n,i,M,D,l+s),x.length>0&&x[0]>=M&&x[1]<=D)return[x[0],x[1]]}{var F=n+c-l,N=i+d-l;if(x=Ia(e,t,n,i,F,N,l+s),x.length>0&&x[0]>=F&&x[1]>=N)return[x[0],x[1]]}{var z=n-c+l,q=i+d-l;if(x=Ia(e,t,n,i,z,q,l+s),x.length>0&&x[0]<=z&&x[1]>=q)return[x[0],x[1]]}return[]},D0=function(e,t,n,i,a,o,s){var u=s,l=Math.min(n,a),c=Math.max(n,a),d=Math.min(i,o),h=Math.max(i,o);return l-u<=e&&e<=c+u&&d-u<=t&&t<=h+u},P0=function(e,t,n,i,a,o,s,u,l){var c={x1:Math.min(n,s,a)-l,x2:Math.max(n,s,a)+l,y1:Math.min(i,u,o)-l,y2:Math.max(i,u,o)+l};return!(e<c.x1||e>c.x2||t<c.y1||t>c.y2)},O0=function(e,t,n,i){n-=i;var a=t*t-4*e*n;if(a<0)return[];var o=Math.sqrt(a),s=2*e,u=(-t+o)/s,l=(-t-o)/s;return[u,l]},R0=function(e,t,n,i,a){var o=1e-5;e===0&&(e=o),t/=e,n/=e,i/=e;var s,u,l,c,d,h,f,v;if(u=(3*n-t*t)/9,l=-(27*i)+t*(9*n-2*(t*t)),l/=54,s=u*u*u+l*l,a[1]=0,f=t/3,s>0){d=l+Math.sqrt(s),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),h=l-Math.sqrt(s),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),a[0]=-f+d+h,f+=(d+h)/2,a[4]=a[2]=-f,f=Math.sqrt(3)*(-h+d)/2,a[3]=f,a[5]=-f;return}if(a[5]=a[3]=0,s===0){v=l<0?-Math.pow(-l,1/3):Math.pow(l,1/3),a[0]=-f+2*v,a[4]=a[2]=-(v+f);return}u=-u,c=u*u*u,c=Math.acos(l/Math.sqrt(c)),v=2*Math.sqrt(u),a[0]=-f+v*Math.cos(c/3),a[2]=-f+v*Math.cos((c+2*Math.PI)/3),a[4]=-f+v*Math.cos((c+4*Math.PI)/3)},I0=function(e,t,n,i,a,o,s,u){var l=1*n*n-4*n*a+2*n*s+4*a*a-4*a*s+s*s+i*i-4*i*o+2*i*u+4*o*o-4*o*u+u*u,c=1*9*n*a-3*n*n-3*n*s-6*a*a+3*a*s+9*i*o-3*i*i-3*i*u-6*o*o+3*o*u,d=1*3*n*n-6*n*a+n*s-n*e+2*a*a+2*a*e-s*e+3*i*i-6*i*o+i*u-i*t+2*o*o+2*o*t-u*t,h=1*n*a-n*n+n*e-a*e+i*o-i*i+i*t-o*t,f=[];R0(l,c,d,h,f);for(var v=1e-7,p=[],m=0;m<6;m+=2)Math.abs(f[m+1])<v&&f[m]>=0&&f[m]<=1&&p.push(f[m]);p.push(1),p.push(0);for(var g=-1,y,b,S,A=0;A<p.length;A++)y=Math.pow(1-p[A],2)*n+2*(1-p[A])*p[A]*a+p[A]*p[A]*s,b=Math.pow(1-p[A],2)*i+2*(1-p[A])*p[A]*o+p[A]*p[A]*u,S=Math.pow(y-e,2)+Math.pow(b-t,2),g>=0?S<g&&(g=S):g=S;return g},L0=function(e,t,n,i,a,o){var s=[e-n,t-i],u=[a-n,o-i],l=u[0]*u[0]+u[1]*u[1],c=s[0]*s[0]+s[1]*s[1],d=s[0]*u[0]+s[1]*u[1],h=d*d/l;return d<0?c:h>l?(e-a)*(e-a)+(t-o)*(t-o):c-h},xr=function(e,t,n){for(var i,a,o,s,u,l=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(o=n[(c+1)*2],s=n[(c+1)*2+1]):(o=n[(c+1-n.length/2)*2],s=n[(c+1-n.length/2)*2+1]),!(i==e&&o==e))if(i>=e&&e>=o||i<=e&&e<=o)u=(e-i)/(o-i)*(s-a)+a,u>t&&l++;else continue;return l%2!==0},fn=function(e,t,n,i,a,o,s,u,l){var c=new Array(n.length),d;u[0]!=null?(d=Math.atan(u[1]/u[0]),u[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=u;for(var h=Math.cos(-d),f=Math.sin(-d),v=0;v<c.length/2;v++)c[v*2]=o/2*(n[v*2]*h-n[v*2+1]*f),c[v*2+1]=s/2*(n[v*2+1]*h+n[v*2]*f),c[v*2]+=i,c[v*2+1]+=a;var p;if(l>0){var m=zs(c,-l);p=Vs(m)}else p=c;return xr(e,t,p)},N0=function(e,t,n,i,a,o,s,u){for(var l=new Array(n.length*2),c=0;c<u.length;c++){var d=u[c];l[c*4+0]=d.startX,l[c*4+1]=d.startY,l[c*4+2]=d.stopX,l[c*4+3]=d.stopY;var h=Math.pow(d.cx-e,2)+Math.pow(d.cy-t,2);if(h<=Math.pow(d.radius,2))return!0}return xr(e,t,l)},Vs=function(e){for(var t=new Array(e.length/2),n,i,a,o,s,u,l,c,d=0;d<e.length/4;d++){n=e[d*4],i=e[d*4+1],a=e[d*4+2],o=e[d*4+3],d<e.length/4-1?(s=e[(d+1)*4],u=e[(d+1)*4+1],l=e[(d+1)*4+2],c=e[(d+1)*4+3]):(s=e[0],u=e[1],l=e[2],c=e[3]);var h=Nn(n,i,a,o,s,u,l,c,!0);t[d*2]=h[0],t[d*2+1]=h[1]}return t},zs=function(e,t){for(var n=new Array(e.length*2),i,a,o,s,u=0;u<e.length/2;u++){i=e[u*2],a=e[u*2+1],u<e.length/2-1?(o=e[(u+1)*2],s=e[(u+1)*2+1]):(o=e[0],s=e[1]);var l=s-a,c=-(o-i),d=Math.sqrt(l*l+c*c),h=l/d,f=c/d;n[u*4]=i+h*t,n[u*4+1]=a+f*t,n[u*4+2]=o+h*t,n[u*4+3]=s+f*t}return n},k0=function(e,t,n,i,a,o){var s=n-e,u=i-t;s/=a,u/=o;var l=Math.sqrt(s*s+u*u),c=l-1;if(c<0)return[];var d=c/l;return[(n-e)*d+e,(i-t)*d+t]},ai=function(e,t,n,i,a,o,s){return e-=a,t-=o,e/=n/2+s,t/=i/2+s,e*e+t*t<=1},Ia=function(e,t,n,i,a,o,s){var u=[n-e,i-t],l=[e-a,t-o],c=u[0]*u[0]+u[1]*u[1],d=2*(l[0]*u[0]+l[1]*u[1]),h=l[0]*l[0]+l[1]*l[1]-s*s,f=d*d-4*c*h;if(f<0)return[];var v=(-d+Math.sqrt(f))/(2*c),p=(-d-Math.sqrt(f))/(2*c),m=Math.min(v,p),g=Math.max(v,p),y=[];if(m>=0&&m<=1&&y.push(m),g>=0&&g<=1&&y.push(g),y.length===0)return[];var b=y[0]*u[0]+e,S=y[0]*u[1]+t;if(y.length>1){if(y[0]==y[1])return[b,S];var A=y[1]*u[0]+e,P=y[1]*u[1]+t;return[b,S,A,P]}else return[b,S]},Ul=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},Nn=function(e,t,n,i,a,o,s,u,l){var c=e-a,d=n-e,h=s-a,f=t-o,v=i-t,p=u-o,m=h*f-p*c,g=d*f-v*c,y=p*d-h*v;if(y!==0){var b=m/y,S=g/y,A=.001,P=0-A,O=1+A;return P<=b&&b<=O&&P<=S&&S<=O?[e+b*d,t+b*v]:l?[e+b*d,t+b*v]:[]}else return m===0||g===0?Ul(e,n,s)===s?[s,u]:Ul(e,n,a)===a?[a,o]:Ul(a,s,n)===n?[n,i]:[]:[]},$a=function(e,t,n,i,a,o,s,u){var l=[],c,d=new Array(n.length),h=!0;o==null&&(h=!1);var f;if(h){for(var v=0;v<d.length/2;v++)d[v*2]=n[v*2]*o+i,d[v*2+1]=n[v*2+1]*s+a;if(u>0){var p=zs(d,-u);f=Vs(p)}else f=d}else f=n;for(var m,g,y,b,S=0;S<f.length/2;S++)m=f[S*2],g=f[S*2+1],S<f.length/2-1?(y=f[(S+1)*2],b=f[(S+1)*2+1]):(y=f[0],b=f[1]),c=Nn(e,t,i,a,m,g,y,b),c.length!==0&&l.push(c[0],c[1]);return l},F0=function(e,t,n,i,a,o,s,u,l){var c=[],d,h=new Array(n.length*2);l.forEach(function(y,b){b===0?(h[h.length-2]=y.startX,h[h.length-1]=y.startY):(h[b*4-2]=y.startX,h[b*4-1]=y.startY),h[b*4]=y.stopX,h[b*4+1]=y.stopY,d=Ia(e,t,i,a,y.cx,y.cy,y.radius),d.length!==0&&c.push(d[0],d[1])});for(var f=0;f<h.length/4;f++)d=Nn(e,t,i,a,h[f*4],h[f*4+1],h[f*4+2],h[f*4+3],!1),d.length!==0&&c.push(d[0],d[1]);if(c.length>2){for(var v=[c[0],c[1]],p=Math.pow(v[0]-e,2)+Math.pow(v[1]-t,2),m=1;m<c.length/2;m++){var g=Math.pow(c[m*2]-e,2)+Math.pow(c[m*2+1]-t,2);g<=p&&(v[0]=c[m*2],v[1]=c[m*2+1],p=g)}return v}return c},ps=function(e,t,n){var i=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),o=(a-n)/a;return o<0&&(o=1e-5),[t[0]+o*i[0],t[1]+o*i[1]]},pr=function(e,t){var n=iu(e,t);return n=lf(n),n},lf=function(e){for(var t,n,i=e.length/2,a=1/0,o=1/0,s=-1/0,u=-1/0,l=0;l<i;l++)t=e[2*l],n=e[2*l+1],a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),u=Math.max(u,n);for(var c=2/(s-a),d=2/(u-o),h=0;h<i;h++)t=e[2*h]=e[2*h]*c,n=e[2*h+1]=e[2*h+1]*d,a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),u=Math.max(u,n);if(o<-1)for(var f=0;f<i;f++)n=e[2*f+1]=e[2*f+1]+(-1-o);return e},iu=function(e,t){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=t;for(var a=new Array(e*2),o,s=0;s<e;s++)o=s*n+i,a[2*s]=Math.cos(o),a[2*s+1]=Math.sin(-o);return a},li=function(e,t){return Math.min(e/4,t/4,8)},uf=function(e,t){return Math.min(e/10,t/10,8)},Au=function(){return 8},B0=function(e,t,n){return[e-2*t+n,2*(t-e),e]},au=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},V0=Jt({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),z0={pageRank:function(e){for(var t=V0(e),n=t.dampingFactor,i=t.precision,a=t.iterations,o=t.weight,s=this._private.cy,u=this.byGroup(),l=u.nodes,c=u.edges,d=l.length,h=d*d,f=c.length,v=new Array(h),p=new Array(d),m=(1-n)/d,g=0;g<d;g++){for(var y=0;y<d;y++){var b=g*d+y;v[b]=0}p[g]=0}for(var S=0;S<f;S++){var A=c[S],P=A.data("source"),O=A.data("target");if(P!==O){var I=l.indexOfId(P),R=l.indexOfId(O),L=o(A),B=R*d+I;v[B]+=L,p[I]+=L}}for(var w=1/d+m,_=0;_<d;_++)if(p[_]===0)for(var E=0;E<d;E++){var x=E*d+_;v[x]=w}else for(var C=0;C<d;C++){var T=C*d+_;v[T]=v[T]/p[_]+m}for(var M=new Array(d),D=new Array(d),F,N=0;N<d;N++)M[N]=1;for(var z=0;z<a;z++){for(var q=0;q<d;q++)D[q]=0;for(var $=0;$<d;$++)for(var ee=0;ee<d;ee++){var J=$*d+ee;D[$]+=v[J]*M[ee]}x0(D),F=M,M=D,D=F;for(var j=0,Z=0;Z<d;Z++){var H=F[Z]-M[Z];j+=H*H}if(j<i)break}var k={rank:function(W){return W=s.collection(W)[0],M[l.indexOf(W)]}};return k}},Md=Jt({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Ki={degreeCentralityNormalized:function(e){e=Md(e);var t=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},d={},h=0,f=0,v=0;v<i;v++){var p=n[v],m=p.id();e.root=p;var g=this.degreeCentrality(e);h<g.indegree&&(h=g.indegree),f<g.outdegree&&(f=g.outdegree),c[m]=g.indegree,d[m]=g.outdegree}return{indegree:function(b){return h==0?0:(We(b)&&(b=t.filter(b)),c[b.id()]/h)},outdegree:function(b){return f===0?0:(We(b)&&(b=t.filter(b)),d[b.id()]/f)}}}else{for(var a={},o=0,s=0;s<i;s++){var u=n[s];e.root=u;var l=this.degreeCentrality(e);o<l.degree&&(o=l.degree),a[u.id()]=l.degree}return{degree:function(b){return o===0?0:(We(b)&&(b=t.filter(b)),a[b.id()]/o)}}}},degreeCentrality:function(e){e=Md(e);var t=this.cy(),n=this,i=e,a=i.root,o=i.weight,s=i.directed,u=i.alpha;if(a=t.collection(a)[0],s){for(var f=a.connectedEdges(),v=f.filter(function(P){return P.target().same(a)&&n.has(P)}),p=f.filter(function(P){return P.source().same(a)&&n.has(P)}),m=v.length,g=p.length,y=0,b=0,S=0;S<v.length;S++)y+=o(v[S]);for(var A=0;A<p.length;A++)b+=o(p[A]);return{indegree:Math.pow(m,1-u)*Math.pow(y,u),outdegree:Math.pow(g,1-u)*Math.pow(b,u)}}else{for(var l=a.connectedEdges().intersection(n),c=l.length,d=0,h=0;h<l.length;h++)d+=o(l[h]);return{degree:Math.pow(c,1-u)*Math.pow(d,u)}}}};Ki.dc=Ki.degreeCentrality;Ki.dcn=Ki.degreeCentralityNormalised=Ki.degreeCentralityNormalized;var Ad=Jt({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Zi={closenessCentralityNormalized:function(e){for(var t=Ad(e),n=t.harmonic,i=t.weight,a=t.directed,o=this.cy(),s={},u=0,l=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),d=0;d<l.length;d++){for(var h=0,f=l[d],v=0;v<l.length;v++)if(d!==v){var p=c.distance(f,l[v]);n?h+=1/p:h+=p}n||(h=1/h),u<h&&(u=h),s[f.id()]=h}return{closeness:function(g){return u==0?0:(We(g)?g=o.filter(g)[0].id():g=g.id(),s[g]/u)}}},closenessCentrality:function(e){var t=Ad(e),n=t.root,i=t.weight,a=t.directed,o=t.harmonic;n=this.filter(n)[0];for(var s=this.dijkstra({root:n,weight:i,directed:a}),u=0,l=this.nodes(),c=0;c<l.length;c++){var d=l[c];if(!d.same(n)){var h=s.distanceTo(d);o?u+=1/h:u+=h}}return o?u:1/u}};Zi.cc=Zi.closenessCentrality;Zi.ccn=Zi.closenessCentralityNormalised=Zi.closenessCentralityNormalized;var G0=Jt({weight:null,directed:!1}),ou={betweennessCentrality:function(e){for(var t=G0(e),n=t.directed,i=t.weight,a=i!=null,o=this.cy(),s=this.nodes(),u={},l={},c=0,d={set:function(b,S){l[b]=S,S>c&&(c=S)},get:function(b){return l[b]}},h=0;h<s.length;h++){var f=s[h],v=f.id();n?u[v]=f.outgoers().nodes():u[v]=f.openNeighborhood().nodes(),d.set(v,0)}for(var p=function(b){for(var S=s[b].id(),A=[],P={},O={},I={},R=new to(function(ee,J){return I[ee]-I[J]}),L=0;L<s.length;L++){var B=s[L].id();P[B]=[],O[B]=0,I[B]=1/0}for(O[S]=1,I[S]=0,R.push(S);!R.empty();){var w=R.pop();if(A.push(w),a)for(var _=0;_<u[w].length;_++){var E=u[w][_],x=o.getElementById(w),C=void 0;x.edgesTo(E).length>0?C=x.edgesTo(E)[0]:C=E.edgesTo(x)[0];var T=i(C);E=E.id(),I[E]>I[w]+T&&(I[E]=I[w]+T,R.nodes.indexOf(E)<0?R.push(E):R.updateItem(E),O[E]=0,P[E]=[]),I[E]==I[w]+T&&(O[E]=O[E]+O[w],P[E].push(w))}else for(var M=0;M<u[w].length;M++){var D=u[w][M].id();I[D]==1/0&&(R.push(D),I[D]=I[w]+1),I[D]==I[w]+1&&(O[D]=O[D]+O[w],P[D].push(w))}}for(var F={},N=0;N<s.length;N++)F[s[N].id()]=0;for(;A.length>0;){for(var z=A.pop(),q=0;q<P[z].length;q++){var $=P[z][q];F[$]=F[$]+O[$]/O[z]*(1+F[z])}z!=s[b].id()&&d.set(z,d.get(z)+F[z])}},m=0;m<s.length;m++)p(m);var g={betweenness:function(b){var S=o.collection(b).id();return d.get(S)},betweennessNormalized:function(b){if(c==0)return 0;var S=o.collection(b).id();return d.get(S)/c}};return g.betweennessNormalised=g.betweennessNormalized,g}};ou.bc=ou.betweennessCentrality;var j0=Jt({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),H0=function(e){return j0(e)},U0=function(e,t){for(var n=0,i=0;i<t.length;i++)n+=t[i](e);return n},$0=function(e,t,n){for(var i=0;i<t;i++)e[i*t+i]=n},cf=function(e,t){for(var n,i=0;i<t;i++){n=0;for(var a=0;a<t;a++)n+=e[a*t+i];for(var o=0;o<t;o++)e[o*t+i]=e[o*t+i]/n}},W0=function(e,t,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var o=0;o<n;o++)i[a*n+o]=0;for(var s=0;s<n;s++)for(var u=0;u<n;u++)i[a*n+u]+=e[a*n+s]*t[s*n+u]}return i},Y0=function(e,t,n){for(var i=e.slice(0),a=1;a<n;a++)e=W0(e,i,t);return e},q0=function(e,t,n){for(var i=new Array(t*t),a=0;a<t*t;a++)i[a]=Math.pow(e[a],n);return cf(i,t),i},X0=function(e,t,n,i){for(var a=0;a<n;a++){var o=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),s=Math.round(t[a]*Math.pow(10,i))/Math.pow(10,i);if(o!==s)return!1}return!0},K0=function(e,t,n,i){for(var a=[],o=0;o<t;o++){for(var s=[],u=0;u<t;u++)Math.round(e[o*t+u]*1e3)/1e3>0&&s.push(n[u]);s.length!==0&&a.push(i.collection(s))}return a},Z0=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},Q0=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&Z0(e[t],e[n])&&e.splice(n,1);return e},Dd=function(e){for(var t=this.nodes(),n=this.edges(),i=this.cy(),a=H0(e),o={},s=0;s<t.length;s++)o[t[s].id()]=s;for(var u=t.length,l=u*u,c=new Array(l),d,h=0;h<l;h++)c[h]=0;for(var f=0;f<n.length;f++){var v=n[f],p=o[v.source().id()],m=o[v.target().id()],g=U0(v,a.attributes);c[p*u+m]+=g,c[m*u+p]+=g}$0(c,u,a.multFactor),cf(c,u);for(var y=!0,b=0;y&&b<a.maxIterations;)y=!1,d=Y0(c,u,a.expandFactor),c=q0(d,u,a.inflateFactor),X0(c,d,l,4)||(y=!0),b++;var S=K0(c,u,t,i);return S=Q0(S),S},J0={markovClustering:Dd,mcl:Dd},ey=function(e){return e},df=function(e,t){return Math.abs(t-e)},Pd=function(e,t,n){return e+df(t,n)},Od=function(e,t,n){return e+Math.pow(n-t,2)},ty=function(e){return Math.sqrt(e)},ry=function(e,t,n){return Math.max(e,df(t,n))},Ta=function(e,t,n,i,a){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:ey,s=i,u,l,c=0;c<e;c++)u=t(c),l=n(c),s=a(s,u,l);return o(s)},ta={euclidean:function(e,t,n){return e>=2?Ta(e,t,n,0,Od,ty):Ta(e,t,n,0,Pd)},squaredEuclidean:function(e,t,n){return Ta(e,t,n,0,Od)},manhattan:function(e,t,n){return Ta(e,t,n,0,Pd)},max:function(e,t,n){return Ta(e,t,n,-1/0,ry)}};ta["squared-euclidean"]=ta.squaredEuclidean;ta.squaredeuclidean=ta.squaredEuclidean;function Qs(r,e,t,n,i,a){var o;return Mt(r)?o=r:o=ta[r]||ta.euclidean,e===0&&Mt(r)?o(i,a):o(e,t,n,i,a)}var ny=Jt({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Du=function(e){return ny(e)},Gs=function(e,t,n,i,a){var o=a!=="kMedoids",s=o?function(d){return n[d]}:function(d){return i[d](n)},u=function(h){return i[h](t)},l=n,c=t;return Qs(e,i.length,s,u,l,c)},$l=function(e,t,n){for(var i=n.length,a=new Array(i),o=new Array(i),s=new Array(t),u=null,l=0;l<i;l++)a[l]=e.min(n[l]).value,o[l]=e.max(n[l]).value;for(var c=0;c<t;c++){u=[];for(var d=0;d<i;d++)u[d]=Math.random()*(o[d]-a[d])+a[d];s[c]=u}return s},hf=function(e,t,n,i,a){for(var o=1/0,s=0,u=0;u<t.length;u++){var l=Gs(n,e,t[u],i,a);l<o&&(o=l,s=u)}return s},ff=function(e,t,n){for(var i=[],a=null,o=0;o<t.length;o++)a=t[o],n[a.id()]===e&&i.push(a);return i},iy=function(e,t,n){return Math.abs(t-e)<=n},ay=function(e,t,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var o=Math.abs(e[i][a]-t[i][a]);if(o>n)return!1}return!0},oy=function(e,t,n){for(var i=0;i<n;i++)if(e===t[i])return!0;return!1},Rd=function(e,t){var n=new Array(t);if(e.length<50)for(var i=0;i<t;i++){for(var a=e[Math.floor(Math.random()*e.length)];oy(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var o=0;o<t;o++)n[o]=e[Math.floor(Math.random()*e.length)];return n},Id=function(e,t,n){for(var i=0,a=0;a<t.length;a++)i+=Gs("manhattan",t[a],e,n,"kMedoids");return i},sy=function(e){var t=this.cy(),n=this.nodes(),i=null,a=Du(e),o=new Array(a.k),s={},u;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,u=$l(n,a.k,a.attributes)):Gt(a.testCentroids)==="object"?u=a.testCentroids:u=$l(n,a.k,a.attributes):u=$l(n,a.k,a.attributes);for(var l=!0,c=0;l&&c<a.maxIterations;){for(var d=0;d<n.length;d++)i=n[d],s[i.id()]=hf(i,u,a.distance,a.attributes,"kMeans");l=!1;for(var h=0;h<a.k;h++){var f=ff(h,n,s);if(f.length!==0){for(var v=a.attributes.length,p=u[h],m=new Array(v),g=new Array(v),y=0;y<v;y++){g[y]=0;for(var b=0;b<f.length;b++)i=f[b],g[y]+=a.attributes[y](i);m[y]=g[y]/f.length,iy(m[y],p[y],a.sensitivityThreshold)||(l=!0)}u[h]=m,o[h]=t.collection(f)}}c++}return o},ly=function(e){var t=this.cy(),n=this.nodes(),i=null,a=Du(e),o=new Array(a.k),s,u={},l,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Gt(a.testCentroids)==="object"?s=a.testCentroids:s=Rd(n,a.k)):s=Rd(n,a.k);for(var d=!0,h=0;d&&h<a.maxIterations;){for(var f=0;f<n.length;f++)i=n[f],u[i.id()]=hf(i,s,a.distance,a.attributes,"kMedoids");d=!1;for(var v=0;v<s.length;v++){var p=ff(v,n,u);if(p.length!==0){c[v]=Id(s[v],p,a.attributes);for(var m=0;m<p.length;m++)l=Id(p[m],p,a.attributes),l<c[v]&&(c[v]=l,s[v]=p[m],d=!0);o[v]=t.collection(p)}}h++}return o},uy=function(e,t,n,i,a){for(var o,s,u=0;u<t.length;u++)for(var l=0;l<e.length;l++)i[u][l]=Math.pow(n[u][l],a.m);for(var c=0;c<e.length;c++)for(var d=0;d<a.attributes.length;d++){o=0,s=0;for(var h=0;h<t.length;h++)o+=i[h][c]*a.attributes[d](t[h]),s+=i[h][c];e[c][d]=o/s}},cy=function(e,t,n,i,a){for(var o=0;o<e.length;o++)t[o]=e[o].slice();for(var s,u,l,c=2/(a.m-1),d=0;d<n.length;d++)for(var h=0;h<i.length;h++){s=0;for(var f=0;f<n.length;f++)u=Gs(a.distance,i[h],n[d],a.attributes,"cmeans"),l=Gs(a.distance,i[h],n[f],a.attributes,"cmeans"),s+=Math.pow(u/l,c);e[h][d]=1/s}},dy=function(e,t,n,i){for(var a=new Array(n.k),o=0;o<a.length;o++)a[o]=[];for(var s,u,l=0;l<t.length;l++){s=-1/0,u=-1;for(var c=0;c<t[0].length;c++)t[l][c]>s&&(s=t[l][c],u=c);a[u].push(e[l])}for(var d=0;d<a.length;d++)a[d]=i.collection(a[d]);return a},Ld=function(e){var t=this.cy(),n=this.nodes(),i=Du(e),a,o,s,u,l;u=new Array(n.length);for(var c=0;c<n.length;c++)u[c]=new Array(i.k);s=new Array(n.length);for(var d=0;d<n.length;d++)s[d]=new Array(i.k);for(var h=0;h<n.length;h++){for(var f=0,v=0;v<i.k;v++)s[h][v]=Math.random(),f+=s[h][v];for(var p=0;p<i.k;p++)s[h][p]=s[h][p]/f}o=new Array(i.k);for(var m=0;m<i.k;m++)o[m]=new Array(i.attributes.length);l=new Array(n.length);for(var g=0;g<n.length;g++)l[g]=new Array(i.k);for(var y=!0,b=0;y&&b<i.maxIterations;)y=!1,uy(o,n,s,l,i),cy(s,u,o,n,i),ay(s,u,i.sensitivityThreshold)||(y=!0),b++;return a=dy(n,s,i,t),{clusters:a,degreeOfMembership:s}},hy={kMeans:sy,kMedoids:ly,fuzzyCMeans:Ld,fcm:Ld},fy=Jt({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),vy={single:"min",complete:"max"},py=function(e){var t=fy(e),n=vy[t.linkage];return n!=null&&(t.linkage=n),t},Nd=function(e,t,n,i,a){for(var o=0,s=1/0,u,l=a.attributes,c=function(R,L){return Qs(a.distance,l.length,function(B){return l[B](R)},function(B){return l[B](L)},R,L)},d=0;d<e.length;d++){var h=e[d].key,f=n[h][i[h]];f<s&&(o=h,s=f)}if(a.mode==="threshold"&&s>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=t[o],p=t[i[o]],m;a.mode==="dendrogram"?m={left:v,right:p,key:v.key}:m={value:v.value.concat(p.value),key:v.key},e[v.index]=m,e.splice(p.index,1),t[v.key]=m;for(var g=0;g<e.length;g++){var y=e[g];v.key===y.key?u=1/0:a.linkage==="min"?(u=n[v.key][y.key],n[v.key][y.key]>n[p.key][y.key]&&(u=n[p.key][y.key])):a.linkage==="max"?(u=n[v.key][y.key],n[v.key][y.key]<n[p.key][y.key]&&(u=n[p.key][y.key])):a.linkage==="mean"?u=(n[v.key][y.key]*v.size+n[p.key][y.key]*p.size)/(v.size+p.size):a.mode==="dendrogram"?u=c(y.value,v.value):u=c(y.value[0],v.value[0]),n[v.key][y.key]=n[y.key][v.key]=u}for(var b=0;b<e.length;b++){var S=e[b].key;if(i[S]===v.key||i[S]===p.key){for(var A=S,P=0;P<e.length;P++){var O=e[P].key;n[S][O]<n[S][A]&&(A=O)}i[S]=A}e[b].index=b}return v.key=p.key=v.index=p.index=null,!0},gs=function r(e,t,n){e&&(e.value?t.push(e.value):(e.left&&r(e.left,t),e.right&&r(e.right,t)))},gy=function r(e,t){if(!e)return"";if(e.left&&e.right){var n=r(e.left,t),i=r(e.right,t),a=t.add({group:"nodes",data:{id:n+","+i}});return t.add({group:"edges",data:{source:n,target:a.id()}}),t.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},my=function r(e,t,n){if(!e)return[];var i=[],a=[],o=[];return t===0?(e.left&&gs(e.left,i),e.right&&gs(e.right,a),o=i.concat(a),[n.collection(o)]):t===1?e.value?[n.collection(e.value)]:(e.left&&gs(e.left,i),e.right&&gs(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=r(e.left,t-1,n)),e.right&&(a=r(e.right,t-1,n)),i.concat(a))},kd=function(e){for(var t=this.cy(),n=this.nodes(),i=py(e),a=i.attributes,o=function(b,S){return Qs(i.distance,a.length,function(A){return a[A](b)},function(A){return a[A](S)},b,S)},s=[],u=[],l=[],c=[],d=0;d<n.length;d++){var h={value:i.mode==="dendrogram"?n[d]:[n[d]],key:d,index:d};s[d]=h,c[d]=h,u[d]=[],l[d]=0}for(var f=0;f<s.length;f++)for(var v=0;v<=f;v++){var p=void 0;i.mode==="dendrogram"?p=f===v?1/0:o(s[f].value,s[v].value):p=f===v?1/0:o(s[f].value[0],s[v].value[0]),u[f][v]=p,u[v][f]=p,p<u[f][l[f]]&&(l[f]=v)}for(var m=Nd(s,c,u,l,i);m;)m=Nd(s,c,u,l,i);var g;return i.mode==="dendrogram"?(g=my(s[0],i.dendrogramDepth,t),i.addDendrogram&&gy(s[0],t)):(g=new Array(s.length),s.forEach(function(y,b){y.key=y.index=null,g[b]=t.collection(y.value)})),g},yy={hierarchicalClustering:kd,hca:kd},Cy=Jt({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),wy=function(e){var t=e.damping,n=e.preference;.5<=t&&t<1||St("Damping must range on [0.5, 1).  Got: ".concat(t));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Ne(n)||St("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),Cy(e)},by=function(e,t,n,i){var a=function(s,u){return i[u](s)};return-Qs(e,i.length,function(o){return a(t,o)},function(o){return a(n,o)},t,n)},xy=function(e,t){var n=null;return t==="median"?n=w0(e):t==="mean"?n=C0(e):t==="min"?n=m0(e):t==="max"?n=y0(e):n=t,n},Ey=function(e,t,n){for(var i=[],a=0;a<e;a++)t[a*e+a]+n[a*e+a]>0&&i.push(a);return i},Fd=function(e,t,n){for(var i=[],a=0;a<e;a++){for(var o=-1,s=-1/0,u=0;u<n.length;u++){var l=n[u];t[a*e+l]>s&&(o=l,s=t[a*e+l])}o>0&&i.push(o)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},_y=function(e,t,n){for(var i=Fd(e,t,n),a=0;a<n.length;a++){for(var o=[],s=0;s<i.length;s++)i[s]===n[a]&&o.push(s);for(var u=-1,l=-1/0,c=0;c<o.length;c++){for(var d=0,h=0;h<o.length;h++)d+=t[o[h]*e+o[c]];d>l&&(u=c,l=d)}n[a]=o[u]}return i=Fd(e,t,n),i},Bd=function(e){for(var t=this.cy(),n=this.nodes(),i=wy(e),a={},o=0;o<n.length;o++)a[n[o].id()]=o;var s,u,l,c,d,h;s=n.length,u=s*s,l=new Array(u);for(var f=0;f<u;f++)l[f]=-1/0;for(var v=0;v<s;v++)for(var p=0;p<s;p++)v!==p&&(l[v*s+p]=by(i.distance,n[v],n[p],i.attributes));c=xy(l,i.preference);for(var m=0;m<s;m++)l[m*s+m]=c;d=new Array(u);for(var g=0;g<u;g++)d[g]=0;h=new Array(u);for(var y=0;y<u;y++)h[y]=0;for(var b=new Array(s),S=new Array(s),A=new Array(s),P=0;P<s;P++)b[P]=0,S[P]=0,A[P]=0;for(var O=new Array(s*i.minIterations),I=0;I<O.length;I++)O[I]=0;var R;for(R=0;R<i.maxIterations;R++){for(var L=0;L<s;L++){for(var B=-1/0,w=-1/0,_=-1,E=0,x=0;x<s;x++)b[x]=d[L*s+x],E=h[L*s+x]+l[L*s+x],E>=B?(w=B,B=E,_=x):E>w&&(w=E);for(var C=0;C<s;C++)d[L*s+C]=(1-i.damping)*(l[L*s+C]-B)+i.damping*b[C];d[L*s+_]=(1-i.damping)*(l[L*s+_]-w)+i.damping*b[_]}for(var T=0;T<s;T++){for(var M=0,D=0;D<s;D++)b[D]=h[D*s+T],S[D]=Math.max(0,d[D*s+T]),M+=S[D];M-=S[T],S[T]=d[T*s+T],M+=S[T];for(var F=0;F<s;F++)h[F*s+T]=(1-i.damping)*Math.min(0,M-S[F])+i.damping*b[F];h[T*s+T]=(1-i.damping)*(M-S[T])+i.damping*b[T]}for(var N=0,z=0;z<s;z++){var q=h[z*s+z]+d[z*s+z]>0?1:0;O[R%i.minIterations*s+z]=q,N+=q}if(N>0&&(R>=i.minIterations-1||R==i.maxIterations-1)){for(var $=0,ee=0;ee<s;ee++){A[ee]=0;for(var J=0;J<i.minIterations;J++)A[ee]+=O[J*s+ee];(A[ee]===0||A[ee]===i.minIterations)&&$++}if($===s)break}}for(var j=Ey(s,d,h),Z=_y(s,l,j),H={},k=0;k<j.length;k++)H[j[k]]=[];for(var G=0;G<n.length;G++){var W=a[n[G].id()],te=Z[W];te!=null&&H[te].push(n[G])}for(var X=new Array(j.length),me=0;me<j.length;me++)X[me]=t.collection(H[j[me]]);return X},Ty={affinityPropagation:Bd,ap:Bd},Sy=Jt({root:void 0,directed:!1}),My={hierholzer:function(e){if(!ut(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n=Sy(e),i=n.root,a=n.directed,o=this,s=!1,u,l,c;i&&(c=We(i)?this.filter(i)[0].id():i[0].id());var d={},h={};a?o.forEach(function(y){var b=y.id();if(y.isNode()){var S=y.indegree(!0),A=y.outdegree(!0),P=S-A,O=A-S;P==1?u?s=!0:u=b:O==1?l?s=!0:l=b:(O>1||P>1)&&(s=!0),d[b]=[],y.outgoers().forEach(function(I){I.isEdge()&&d[b].push(I.id())})}else h[b]=[void 0,y.target().id()]}):o.forEach(function(y){var b=y.id();if(y.isNode()){var S=y.degree(!0);S%2&&(u?l?s=!0:l=b:u=b),d[b]=[],y.connectedEdges().forEach(function(A){return d[b].push(A.id())})}else h[b]=[y.source().id(),y.target().id()]});var f={found:!1,trail:void 0};if(s)return f;if(l&&u)if(a){if(c&&l!=c)return f;c=l}else{if(c&&l!=c&&u!=c)return f;c||(c=l)}else c||(c=o[0].id());var v=function(b){for(var S=b,A=[b],P,O,I;d[S].length;)P=d[S].shift(),O=h[P][0],I=h[P][1],S!=I?(d[I]=d[I].filter(function(R){return R!=P}),S=I):!a&&S!=O&&(d[O]=d[O].filter(function(R){return R!=P}),S=O),A.unshift(P),A.unshift(S);return A},p=[],m=[];for(m=v(c);m.length!=1;)d[m[0]].length==0?(p.unshift(o.getElementById(m.shift())),p.unshift(o.getElementById(m.shift()))):m=v(m.shift()).concat(m);p.unshift(o.getElementById(m.shift()));for(var g in d)if(d[g].length)return f;return f.found=!0,f.trail=this.spawn(p,!0),f}},ms=function(){var e=this,t={},n=0,i=0,a=[],o=[],s={},u=function(h,f){for(var v=o.length-1,p=[],m=e.spawn();o[v].x!=h||o[v].y!=f;)p.push(o.pop().edge),v--;p.push(o.pop().edge),p.forEach(function(g){var y=g.connectedNodes().intersection(e);m.merge(g),y.forEach(function(b){var S=b.id(),A=b.connectedEdges().intersection(e);m.merge(b),t[S].cutVertex?m.merge(A.filter(function(P){return P.isLoop()})):m.merge(A)})}),a.push(m)},l=function d(h,f,v){h===v&&(i+=1),t[f]={id:n,low:n++,cutVertex:!1};var p=e.getElementById(f).connectedEdges().intersection(e);if(p.size()===0)a.push(e.spawn(e.getElementById(f)));else{var m,g,y,b;p.forEach(function(S){m=S.source().id(),g=S.target().id(),y=m===f?g:m,y!==v&&(b=S.id(),s[b]||(s[b]=!0,o.push({x:f,y,edge:S})),y in t?t[f].low=Math.min(t[f].low,t[y].id):(d(h,y,f),t[f].low=Math.min(t[f].low,t[y].low),t[f].id<=t[y].low&&(t[f].cutVertex=!0,u(f,y))))})}};e.forEach(function(d){if(d.isNode()){var h=d.id();h in t||(i=0,l(h,h),t[h].cutVertex=i>1)}});var c=Object.keys(t).filter(function(d){return t[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(c),components:a}},Ay={hopcroftTarjanBiconnected:ms,htbc:ms,htb:ms,hopcroftTarjanBiconnectedComponents:ms},ys=function(){var e=this,t={},n=0,i=[],a=[],o=e.spawn(e),s=function u(l){a.push(l),t[l]={index:n,low:n++,explored:!1};var c=e.getElementById(l).connectedEdges().intersection(e);if(c.forEach(function(p){var m=p.target().id();m!==l&&(m in t||u(m),t[m].explored||(t[l].low=Math.min(t[l].low,t[m].low)))}),t[l].index===t[l].low){for(var d=e.spawn();;){var h=a.pop();if(d.merge(e.getElementById(h)),t[h].low=t[l].index,t[h].explored=!0,h===l)break}var f=d.edgesWith(d),v=d.merge(f);i.push(v),o=o.difference(v)}};return e.forEach(function(u){if(u.isNode()){var l=u.id();l in t||s(l)}}),{cut:o,components:i}},Dy={tarjanStronglyConnected:ys,tsc:ys,tscc:ys,tarjanStronglyConnectedComponents:ys},vf={};[Ha,a0,o0,l0,c0,h0,p0,z0,Ki,Zi,ou,J0,hy,yy,Ty,My,Ay,Dy].forEach(function(r){Ye(vf,r)});var pf=0,gf=1,mf=2,vn=function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.7",this.state=pf,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};vn.prototype={fulfill:function(e){return Vd(this,gf,"fulfillValue",e)},reject:function(e){return Vd(this,mf,"rejectReason",e)},then:function(e,t){var n=this,i=new vn;return n.onFulfilled.push(Gd(e,i,"fulfill")),n.onRejected.push(Gd(t,i,"reject")),yf(n),i.proxy}};var Vd=function(e,t,n,i){return e.state===pf&&(e.state=t,e[n]=i,yf(e)),e},yf=function(e){e.state===gf?zd(e,"onFulfilled",e.fulfillValue):e.state===mf&&zd(e,"onRejected",e.rejectReason)},zd=function(e,t,n){if(e[t].length!==0){var i=e[t];e[t]=[];var a=function(){for(var s=0;s<i.length;s++)i[s](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},Gd=function(e,t,n){return function(i){if(typeof e!="function")t[n].call(t,i);else{var a;try{a=e(i)}catch(o){t.reject(o);return}Py(t,a)}}},Py=function r(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Gt(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(t,function(a){i||(i=!0,a===t?e.reject(new TypeError("circular thenable chain")):r(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(t)};vn.all=function(r){return new vn(function(e,t){for(var n=new Array(r.length),i=0,a=function(u,l){n[u]=l,i++,i===r.length&&e(n)},o=0;o<r.length;o++)(function(s){var u=r[s],l=u!=null&&u.then!=null;if(l)u.then(function(d){a(s,d)},function(d){t(d)});else{var c=u;a(s,c)}})(o)})};vn.resolve=function(r){return new vn(function(e,t){e(r)})};vn.reject=function(r){return new vn(function(e,t){t(r)})};var ia=typeof Promise<"u"?Promise:vn,su=function(e,t,n){var i=bu(e),a=!i,o=this._private=Ye({duration:1e3},t,n);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&Mt(o.complete)&&o.completes.push(o.complete),a){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(i){var u=e.pan();o.startPan={x:u.x,y:u.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},ui=su.prototype;Ye(ui,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,n=e.target._private.animation;e.queue?t=n.queue:t=n.current,t.push(this),Ar(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(l,c){var d=e[l];d!=null&&(e[l]=e[c],e[c]=d)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],o=a.name,s=e.startStyle[o];e.startStyle[o]=a,e.style[i]=s}return t&&this.play(),this},promise:function(e){var t=this._private,n;switch(e){case"frame":n=t.frames;break;default:case"complete":case"completed":n=t.completes}return new ia(function(i,a){n.push(function(){i()})})}});ui.complete=ui.completed;ui.run=ui.play;ui.running=ui.playing;var Oy={animated:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return!1;var o=i[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var o=0;o<i.length;o++){var s=i[o];s._private.animation.queue=[]}return this}},delay:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:t,duration:t,complete:n}):this}},delayAnimation:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:t,duration:t,complete:n}):this}},animation:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this,u=!a,l=!u;if(!s.styleEnabled())return this;var c=s.style();t=Ye({},t,n);var d=Object.keys(t).length===0;if(d)return new su(o[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(l&&(t.style=c.getPropsList(t.style||t.css),t.css=void 0),l&&t.renderedPosition!=null){var h=t.renderedPosition,f=s.pan(),v=s.zoom();t.position=rf(h,v,f)}if(u&&t.panBy!=null){var p=t.panBy,m=s.pan();t.pan={x:m.x+p.x,y:m.y+p.y}}var g=t.center||t.centre;if(u&&g!=null){var y=s.getCenterPan(g.eles,t.zoom);y!=null&&(t.pan=y)}if(u&&t.fit!=null){var b=t.fit,S=s.getFitViewport(b.eles||b.boundingBox,b.padding);S!=null&&(t.pan=S.pan,t.zoom=S.zoom)}if(u&&ut(t.zoom)){var A=s.getZoomedViewport(t.zoom);A!=null?(A.zoomed&&(t.zoom=A.zoom),A.panned&&(t.pan=A.pan)):t.zoom=null}return new su(o[0],t)}},animate:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;n&&(t=Ye({},t,n));for(var u=0;u<o.length;u++){var l=o[u],c=l.animated()&&(t.queue===void 0||t.queue),d=l.animation(t,c?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var u=0;u<o.length;u++){for(var l=o[u],c=l._private,d=c.animation.current,h=0;h<d.length;h++){var f=d[h],v=f._private;n&&(v.duration=0)}t&&(c.animation.queue=[]),n||(c.animation.current=[])}return s.notify("draw"),this}}},Ry=Array.isArray,Js=Ry,Iy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ly=/^\w*$/;function Ny(r,e){if(Js(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||Ja(r)?!0:Ly.test(r)||!Iy.test(r)||e!=null&&r in Object(e)}var ky=Ny,Fy="[object AsyncFunction]",By="[object Function]",Vy="[object GeneratorFunction]",zy="[object Proxy]";function Gy(r){if(!oi(r))return!1;var e=Yh(r);return e==By||e==Vy||e==Fy||e==zy}var jy=Gy,Hy=Xs["__core-js_shared__"],Wl=Hy,jd=function(){var r=/[^.]+$/.exec(Wl&&Wl.keys&&Wl.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Uy(r){return!!jd&&jd in r}var $y=Uy,Wy=Function.prototype,Yy=Wy.toString;function qy(r){if(r!=null){try{return Yy.call(r)}catch{}try{return r+""}catch{}}return""}var Xy=qy,Ky=/[\\^$.*+?()[\]{}|]/g,Zy=/^\[object .+?Constructor\]$/,Qy=Function.prototype,Jy=Object.prototype,e1=Qy.toString,t1=Jy.hasOwnProperty,r1=RegExp("^"+e1.call(t1).replace(Ky,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function n1(r){if(!oi(r)||$y(r))return!1;var e=jy(r)?r1:Zy;return e.test(Xy(r))}var i1=n1;function a1(r,e){return r?.[e]}var o1=a1;function s1(r,e){var t=o1(r,e);return i1(t)?t:void 0}var Pu=s1,l1=Pu(Object,"create"),Wa=l1;function u1(){this.__data__=Wa?Wa(null):{},this.size=0}var c1=u1;function d1(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var h1=d1,f1="__lodash_hash_undefined__",v1=Object.prototype,p1=v1.hasOwnProperty;function g1(r){var e=this.__data__;if(Wa){var t=e[r];return t===f1?void 0:t}return p1.call(e,r)?e[r]:void 0}var m1=g1,y1=Object.prototype,C1=y1.hasOwnProperty;function w1(r){var e=this.__data__;return Wa?e[r]!==void 0:C1.call(e,r)}var b1=w1,x1="__lodash_hash_undefined__";function E1(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Wa&&e===void 0?x1:e,this}var _1=E1;function aa(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}aa.prototype.clear=c1;aa.prototype.delete=h1;aa.prototype.get=m1;aa.prototype.has=b1;aa.prototype.set=_1;var Hd=aa;function T1(){this.__data__=[],this.size=0}var S1=T1;function M1(r,e){return r===e||r!==r&&e!==e}var Cf=M1;function A1(r,e){for(var t=r.length;t--;)if(Cf(r[t][0],e))return t;return-1}var el=A1,D1=Array.prototype,P1=D1.splice;function O1(r){var e=this.__data__,t=el(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():P1.call(e,t,1),--this.size,!0}var R1=O1;function I1(r){var e=this.__data__,t=el(e,r);return t<0?void 0:e[t][1]}var L1=I1;function N1(r){return el(this.__data__,r)>-1}var k1=N1;function F1(r,e){var t=this.__data__,n=el(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var B1=F1;function oa(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}oa.prototype.clear=S1;oa.prototype.delete=R1;oa.prototype.get=L1;oa.prototype.has=k1;oa.prototype.set=B1;var V1=oa,z1=Pu(Xs,"Map"),G1=z1;function j1(){this.size=0,this.__data__={hash:new Hd,map:new(G1||V1),string:new Hd}}var H1=j1;function U1(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var $1=U1;function W1(r,e){var t=r.__data__;return $1(e)?t[typeof e=="string"?"string":"hash"]:t.map}var tl=W1;function Y1(r){var e=tl(this,r).delete(r);return this.size-=e?1:0,e}var q1=Y1;function X1(r){return tl(this,r).get(r)}var K1=X1;function Z1(r){return tl(this,r).has(r)}var Q1=Z1;function J1(r,e){var t=tl(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var eC=J1;function sa(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}sa.prototype.clear=H1;sa.prototype.delete=q1;sa.prototype.get=K1;sa.prototype.has=Q1;sa.prototype.set=eC;var wf=sa,tC="Expected a function";function Ou(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(tC);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=r.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(Ou.Cache||wf),t}Ou.Cache=wf;var rC=Ou,nC=500;function iC(r){var e=rC(r,function(n){return t.size===nC&&t.clear(),n}),t=e.cache;return e}var aC=iC,oC=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,sC=/\\(\\)?/g,lC=aC(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(oC,function(t,n,i,a){e.push(i?a.replace(sC,"$1"):n||t)}),e}),bf=lC;function uC(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var xf=uC,cC=1/0,Ud=Ji?Ji.prototype:void 0,$d=Ud?Ud.toString:void 0;function Ef(r){if(typeof r=="string")return r;if(Js(r))return xf(r,Ef)+"";if(Ja(r))return $d?$d.call(r):"";var e=r+"";return e=="0"&&1/r==-cC?"-0":e}var dC=Ef;function hC(r){return r==null?"":dC(r)}var _f=hC;function fC(r,e){return Js(r)?r:ky(r,e)?[r]:bf(_f(r))}var Tf=fC,vC=1/0;function pC(r){if(typeof r=="string"||Ja(r))return r;var e=r+"";return e=="0"&&1/r==-vC?"-0":e}var Ru=pC;function gC(r,e){e=Tf(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Ru(e[t++])];return t&&t==n?r:void 0}var mC=gC;function yC(r,e,t){var n=r==null?void 0:mC(r,e);return n===void 0?t:n}var CC=yC,wC=function(){try{var r=Pu(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Wd=wC;function bC(r,e,t){e=="__proto__"&&Wd?Wd(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var xC=bC,EC=Object.prototype,_C=EC.hasOwnProperty;function TC(r,e,t){var n=r[e];(!(_C.call(r,e)&&Cf(n,t))||t===void 0&&!(e in r))&&xC(r,e,t)}var SC=TC,MC=9007199254740991,AC=/^(?:0|[1-9]\d*)$/;function DC(r,e){var t=typeof r;return e=e??MC,!!e&&(t=="number"||t!="symbol"&&AC.test(r))&&r>-1&&r%1==0&&r<e}var PC=DC;function OC(r,e,t,n){if(!oi(r))return r;e=Tf(e,r);for(var i=-1,a=e.length,o=a-1,s=r;s!=null&&++i<a;){var u=Ru(e[i]),l=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(i!=o){var c=s[u];l=n?n(c,u,s):void 0,l===void 0&&(l=oi(c)?c:PC(e[i+1])?[]:{})}SC(s,u,l),s=s[u]}return r}var RC=OC;function IC(r,e,t){return r==null?r:RC(r,e,t)}var LC=IC;function NC(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var kC=NC;function FC(r){return Js(r)?xf(r,Ru):Ja(r)?[r]:kC(bf(_f(r)))}var BC=FC,VC={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Ye({},t,e),function(i,a){var o=e,s=this,u=s.length!==void 0,l=u?s:[s],c=u?s[0]:s;if(We(i)){var d=i.indexOf(".")!==-1,h=d&&BC(i);if(o.allowGetting&&a===void 0){var f;return c&&(o.beforeGet(c),h&&c._private[o.field][i]===void 0?f=CC(c._private[o.field],h):f=c._private[o.field][i]),f}else if(o.allowSetting&&a!==void 0){var v=!o.immutableKeys[i];if(v){var p=kh({},i,a);o.beforeSet(s,p);for(var m=0,g=l.length;m<g;m++){var y=l[m];o.canSet(y)&&(h&&c._private[o.field][i]===void 0?LC(y._private[o.field],h,a):y._private[o.field][i]=a)}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&ut(i)){var b=i,S,A,P=Object.keys(b);o.beforeSet(s,b);for(var O=0;O<P.length;O++){S=P[O],A=b[S];var I=!o.immutableKeys[S];if(I)for(var R=0;R<l.length;R++){var L=l[R];o.canSet(L)&&(L._private[o.field][S]=A)}}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&Mt(i)){var B=i;s.on(o.bindingEvent,B)}else if(o.allowGetting&&i===void 0){var w;return c&&(o.beforeGet(c),w=c._private[o.field]),w}return s}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ye({},t,e),function(i){var a=e,o=this,s=o.length!==void 0,u=s?o:[o];if(We(i)){for(var l=i.split(/\s+/),c=l.length,d=0;d<c;d++){var h=l[d];if(!Bn(h)){var f=!a.immutableKeys[h];if(f)for(var v=0,p=u.length;v<p;v++)u[v]._private[a.field][h]=void 0}}a.triggerEvent&&o[a.triggerFnName](a.event)}else if(i===void 0){for(var m=0,g=u.length;m<g;m++)for(var y=u[m]._private[a.field],b=Object.keys(y),S=0;S<b.length;S++){var A=b[S],P=!a.immutableKeys[A];P&&(y[A]=void 0)}a.triggerEvent&&o[a.triggerFnName](a.event)}return o}}},zC={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,i){var a=this,o=Array.prototype.slice.call(arguments,0);return new ia(function(s,u){var l=function(f){a.off.apply(a,d),s(f)},c=o.concat([l]),d=c.concat([]);a.on.apply(a,c)})}}},ht={};[Oy,VC,zC].forEach(function(r){Ye(ht,r)});var GC={animate:ht.animate(),animation:ht.animation(),animated:ht.animated(),clearQueue:ht.clearQueue(),delay:ht.delay(),delayAnimation:ht.delayAnimation(),stop:ht.stop()},Ds={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(v){return n.push(v)}),n}else gt(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new na(e),o=0;o<t.length;o++){for(var s=t[o],u=s._private,l=u.classes,c=!1,d=0;d<e.length;d++){var h=e[d],f=l.has(h);if(!f){c=!0;break}}c||(c=l.size!==e.length),c&&(u.classes=a,i.push(s))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){gt(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=t===void 0,a=[],o=0,s=n.length;o<s;o++)for(var u=n[o],l=u._private.classes,c=!1,d=0;d<e.length;d++){var h=e[d],f=l.has(h),v=!1;t||i&&!f?(l.add(h),v=!0):(!t||i&&f)&&(l.delete(h),v=!0),!c&&v&&(a.push(u),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};Ds.className=Ds.classNames=Ds.classes;var lt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:zt,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};lt.variable="(?:[\\w-.]|(?:\\\\"+lt.metaChar+"))+";lt.className="(?:[\\w-]|(?:\\\\"+lt.metaChar+"))+";lt.value=lt.string+"|"+lt.number;lt.id=lt.variable;(function(){var r,e,t;for(r=lt.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],lt.comparatorOp+="|@"+e;for(r=lt.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(lt.comparatorOp+="|\\!"+e)})();var vt=function(){return{checks:[]}},je={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},lu=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return em(r.selector,e.selector)}),jC=function(){for(var r={},e,t=0;t<lu.length;t++)e=lu[t],r[e.selector]=e.matches;return r}(),HC=function(e,t){return jC[e](t)},UC="("+lu.map(function(r){return r.selector}).join("|")+")",Gi=function(e){return e.replace(new RegExp("\\\\("+lt.metaChar+")","g"),function(t,n){return n})},In=function(e,t,n){e[e.length-1]=n},uu=[{name:"group",query:!0,regex:"("+lt.group+")",populate:function(e,t,n){var i=Bt(n,1),a=i[0];t.checks.push({type:je.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:UC,populate:function(e,t,n){var i=Bt(n,1),a=i[0];t.checks.push({type:je.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+lt.id+")",populate:function(e,t,n){var i=Bt(n,1),a=i[0];t.checks.push({type:je.ID,value:Gi(a)})}},{name:"className",query:!0,regex:"\\.("+lt.className+")",populate:function(e,t,n){var i=Bt(n,1),a=i[0];t.checks.push({type:je.CLASS,value:Gi(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+lt.variable+")\\s*\\]",populate:function(e,t,n){var i=Bt(n,1),a=i[0];t.checks.push({type:je.DATA_EXIST,field:Gi(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+lt.variable+")\\s*("+lt.comparatorOp+")\\s*("+lt.value+")\\s*\\]",populate:function(e,t,n){var i=Bt(n,3),a=i[0],o=i[1],s=i[2],u=new RegExp("^"+lt.string+"$").exec(s)!=null;u?s=s.substring(1,s.length-1):s=parseFloat(s),t.checks.push({type:je.DATA_COMPARE,field:Gi(a),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+lt.boolOp+")\\s*("+lt.variable+")\\s*\\]",populate:function(e,t,n){var i=Bt(n,2),a=i[0],o=i[1];t.checks.push({type:je.DATA_BOOL,field:Gi(o),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+lt.meta+")\\s*("+lt.comparatorOp+")\\s*("+lt.number+")\\s*\\]\\]",populate:function(e,t,n){var i=Bt(n,3),a=i[0],o=i[1],s=i[2];t.checks.push({type:je.META_COMPARE,field:Gi(a),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:lt.separator,populate:function(e,t){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,o=e[e.length-1];n!=null&&(o.subject=n,e.currentSubject=null),o.edgeCount=i,o.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var s=e[e.length++]=vt();return s}},{name:"directedEdge",separator:!0,regex:lt.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n=vt(),i=t,a=vt();return n.checks.push({type:je.DIRECTED_EDGE,source:i,target:a}),In(e,t,n),e.edgeCount++,a}else{var o=vt(),s=t,u=vt();return o.checks.push({type:je.NODE_SOURCE,source:s,target:u}),In(e,t,o),e.edgeCount++,u}}},{name:"undirectedEdge",separator:!0,regex:lt.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n=vt(),i=t,a=vt();return n.checks.push({type:je.UNDIRECTED_EDGE,nodes:[i,a]}),In(e,t,n),e.edgeCount++,a}else{var o=vt(),s=t,u=vt();return o.checks.push({type:je.NODE_NEIGHBOR,node:s,neighbor:u}),In(e,t,o),u}}},{name:"child",separator:!0,regex:lt.child,populate:function(e,t){if(e.currentSubject==null){var n=vt(),i=vt(),a=e[e.length-1];return n.checks.push({type:je.CHILD,parent:a,child:i}),In(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=vt(),s=e[e.length-1],u=vt(),l=vt(),c=vt(),d=vt();return o.checks.push({type:je.COMPOUND_SPLIT,left:s,right:u,subject:l}),l.checks=t.checks,t.checks=[{type:je.TRUE}],d.checks.push({type:je.TRUE}),u.checks.push({type:je.PARENT,parent:d,child:c}),In(e,s,o),e.currentSubject=l,e.compoundCount++,c}else{var h=vt(),f=vt(),v=[{type:je.PARENT,parent:h,child:f}];return h.checks=t.checks,t.checks=v,e.compoundCount++,f}}},{name:"descendant",separator:!0,regex:lt.descendant,populate:function(e,t){if(e.currentSubject==null){var n=vt(),i=vt(),a=e[e.length-1];return n.checks.push({type:je.DESCENDANT,ancestor:a,descendant:i}),In(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=vt(),s=e[e.length-1],u=vt(),l=vt(),c=vt(),d=vt();return o.checks.push({type:je.COMPOUND_SPLIT,left:s,right:u,subject:l}),l.checks=t.checks,t.checks=[{type:je.TRUE}],d.checks.push({type:je.TRUE}),u.checks.push({type:je.ANCESTOR,ancestor:d,descendant:c}),In(e,s,o),e.currentSubject=l,e.compoundCount++,c}else{var h=vt(),f=vt(),v=[{type:je.ANCESTOR,ancestor:h,descendant:f}];return h.checks=t.checks,t.checks=v,e.compoundCount++,f}}},{name:"subject",modifier:!0,regex:lt.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return ft("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===je.DIRECTED_EDGE?i.type=je.NODE_TARGET:a===je.UNDIRECTED_EDGE&&(i.type=je.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];uu.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var $C=function(e){for(var t,n,i,a=0;a<uu.length;a++){var o=uu[a],s=o.name,u=e.match(o.regexObj);if(u!=null){n=u,t=o,i=s;var l=u[0];e=e.substring(l.length);break}}return{expr:t,match:n,name:i,remaining:e}},WC=function(e){var t=e.match(/^\s+/);if(t){var n=t[0];e=e.substring(n.length)}return e},YC=function(e){var t=this,n=t.inputText=e,i=t[0]=vt();for(t.length=1,n=WC(n);;){var a=$C(n);if(a.expr==null)return ft("The selector `"+e+"`is invalid"),!1;var o=a.match.slice(1),s=a.expr.populate(t,i,o);if(s===!1)return!1;if(s!=null&&(i=s),n=a.remaining,n.match(/^\s*$/))break}var u=t[t.length-1];t.currentSubject!=null&&(u.subject=t.currentSubject),u.edgeCount=t.edgeCount,u.compoundCount=t.compoundCount;for(var l=0;l<t.length;l++){var c=t[l];if(c.compoundCount>0&&c.edgeCount>0)return ft("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return ft("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&ft("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},qC=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},t=function(c){return We(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,d){var h=c.type,f=c.value;switch(h){case je.GROUP:{var v=e(f);return v.substring(0,v.length-1)}case je.DATA_COMPARE:{var p=c.field,m=c.operator;return"["+p+n(e(m))+t(f)+"]"}case je.DATA_BOOL:{var g=c.operator,y=c.field;return"["+e(g)+y+"]"}case je.DATA_EXIST:{var b=c.field;return"["+b+"]"}case je.META_COMPARE:{var S=c.operator,A=c.field;return"[["+A+n(e(S))+t(f)+"]]"}case je.STATE:return f;case je.ID:return"#"+f;case je.CLASS:return"."+f;case je.PARENT:case je.CHILD:return a(c.parent,d)+n(">")+a(c.child,d);case je.ANCESTOR:case je.DESCENDANT:return a(c.ancestor,d)+" "+a(c.descendant,d);case je.COMPOUND_SPLIT:{var P=a(c.left,d),O=a(c.subject,d),I=a(c.right,d);return P+(P.length>0?" ":"")+O+I}case je.TRUE:return""}},a=function(c,d){return c.checks.reduce(function(h,f,v){return h+(d===c&&v===0?"$":"")+i(f,d)},"")},o="",s=0;s<this.length;s++){var u=this[s];o+=a(u,u.subject),this.length>1&&s<this.length-1&&(o+=", ")}return this.toStringCache=o,o},XC={parse:YC,toString:qC},Sf=function(e,t,n){var i,a=We(e),o=Ne(e),s=We(n),u,l,c=!1,d=!1,h=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(a||s||c)&&(u=!a&&!o?"":""+e,l=""+n),c&&(e=u=u.toLowerCase(),n=l=l.toLowerCase()),t){case"*=":i=u.indexOf(l)>=0;break;case"$=":i=u.indexOf(l,u.length-l.length)>=0;break;case"^=":i=u.indexOf(l)===0;break;case"=":i=e===n;break;case">":h=!0,i=e>n;break;case">=":h=!0,i=e>=n;break;case"<":h=!0,i=e<n;break;case"<=":h=!0,i=e<=n;break;default:i=!1;break}return d&&(e!=null||!h)&&(i=!i),i},KC=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},ZC=function(e){return e!==void 0},Iu=function(e,t){return e.data(t)},QC=function(e,t){return e[t]()},Rt=[],bt=function(e,t){return e.checks.every(function(n){return Rt[n.type](n,t)})};Rt[je.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};Rt[je.STATE]=function(r,e){var t=r.value;return HC(t,e)};Rt[je.ID]=function(r,e){var t=r.value;return e.id()===t};Rt[je.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};Rt[je.META_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return Sf(QC(e,t),n,i)};Rt[je.DATA_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return Sf(Iu(e,t),n,i)};Rt[je.DATA_BOOL]=function(r,e){var t=r.field,n=r.operator;return KC(Iu(e,t),n)};Rt[je.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,ZC(Iu(e,t))};Rt[je.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],n=r.nodes[1],i=e.source(),a=e.target();return bt(t,i)&&bt(n,a)||bt(n,i)&&bt(t,a)};Rt[je.NODE_NEIGHBOR]=function(r,e){return bt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&bt(r.neighbor,t)})};Rt[je.DIRECTED_EDGE]=function(r,e){return bt(r.source,e.source())&&bt(r.target,e.target())};Rt[je.NODE_SOURCE]=function(r,e){return bt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&bt(r.target,t)})};Rt[je.NODE_TARGET]=function(r,e){return bt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&bt(r.source,t)})};Rt[je.CHILD]=function(r,e){return bt(r.child,e)&&bt(r.parent,e.parent())};Rt[je.PARENT]=function(r,e){return bt(r.parent,e)&&e.children().some(function(t){return bt(r.child,t)})};Rt[je.DESCENDANT]=function(r,e){return bt(r.descendant,e)&&e.ancestors().some(function(t){return bt(r.ancestor,t)})};Rt[je.ANCESTOR]=function(r,e){return bt(r.ancestor,e)&&e.descendants().some(function(t){return bt(r.descendant,t)})};Rt[je.COMPOUND_SPLIT]=function(r,e){return bt(r.subject,e)&&bt(r.left,e)&&bt(r.right,e)};Rt[je.TRUE]=function(){return!0};Rt[je.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};Rt[je.FILTER]=function(r,e){var t=r.value;return t(e)};var JC=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===je.ID)return e.getElementById(t[0].checks[0].value).collection();var n=function(a){for(var o=0;o<t.length;o++){var s=t[o];if(bt(s,a))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)},ew=function(e){for(var t=this,n=0;n<t.length;n++){var i=t[n];if(bt(i,e))return!0}return!1},tw={matches:ew,filter:JC},Gn=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||We(e)&&e.match(/^\s*$/)||(Ar(e)?this.addQuery({checks:[{type:je.COLLECTION,value:e.collection()}]}):Mt(e)?this.addQuery({checks:[{type:je.FILTER,value:e}]}):We(e)?this.parse(e)||(this.invalid=!0):St("A selector must be created from a string; found "))},jn=Gn.prototype;[XC,tw].forEach(function(r){return Ye(jn,r)});jn.text=function(){return this.inputText};jn.size=function(){return this.length};jn.eq=function(r){return this[r]};jn.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};jn.addQuery=function(r){this[this.length++]=r};jn.selector=jn.toString;var kn={allAre:function(e){var t=new Gn(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new Gn(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,n=e.length;return t!==n?!1:t===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};kn.allAreNeighbours=kn.allAreNeighbors;kn.has=kn.contains;kn.equal=kn.equals=kn.same;var Lr=function(e,t){return function(i,a,o,s){var u=i,l=this,c;if(u==null?c="":Ar(u)&&u.length===1&&(c=u.id()),l.length===1&&c){var d=l[0]._private,h=d.traversalCache=d.traversalCache||{},f=h[t]=h[t]||[],v=Vn(c),p=f[v];return p||(f[v]=e.call(l,i,a,o,s))}else return e.call(l,i,a,o,s)}},ra={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],o=a._private.parent;o&&t.push(o)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];t.push(a)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var i=this[n],a=i.parents();t=t||a,t=t.intersect(a)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:Lr(function(r){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function n(i){for(var a=0;a<i.length;a++){var o=i[a];t.push(o),o.children().nonempty()&&n(o.children())}}return n(this.children()),this.spawn(t,!0).filter(e)}};function Lu(r,e,t,n){for(var i=[],a=new na,o=r.cy(),s=o.hasCompoundNodes(),u=0;u<r.length;u++){var l=r[u];t?i.push(l):s&&n(i,a,l)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),s&&n(i,a,c)}return r}function Mf(r,e,t){if(t.isParent())for(var n=t._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||r.push(a)}}ra.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Lu(this,r,e,Mf)};function Af(r,e,t){if(t.isChild()){var n=t._private.parent;e.has(n.id())||r.push(n)}}ra.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Lu(this,r,e,Af)};function rw(r,e,t){Af(r,e,t),Mf(r,e,t)}ra.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Lu(this,r,e,rw)};ra.ancestors=ra.parents;var Ya,Df;Ya=Df={data:ht.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:ht.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:ht.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:ht.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:ht.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:ht.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Ya.attr=Ya.data;Ya.removeAttr=Ya.removeData;var nw=Df,rl={};function Yl(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var n=0,i=t[0],a=i._private.edges,o=0;o<a.length;o++){var s=a[o];!e&&s.isLoop()||(n+=r(i,s))}return n}else return}}Ye(rl,{degree:Yl(function(r,e){return e.source().same(e.target())?2:1}),indegree:Yl(function(r,e){return e.target().same(r)?1:0}),outdegree:Yl(function(r,e){return e.source().same(r)?1:0})});function ji(r,e){return function(t){for(var n,i=this.nodes(),a=0;a<i.length;a++){var o=i[a],s=o[r](t);s!==void 0&&(n===void 0||e(s,n))&&(n=s)}return n}}Ye(rl,{minDegree:ji("degree",function(r,e){return r<e}),maxDegree:ji("degree",function(r,e){return r>e}),minIndegree:ji("indegree",function(r,e){return r<e}),maxIndegree:ji("indegree",function(r,e){return r>e}),minOutdegree:ji("outdegree",function(r,e){return r<e}),maxOutdegree:ji("outdegree",function(r,e){return r>e})});Ye(rl,{totalDegree:function(e){for(var t=0,n=this.nodes(),i=0;i<n.length;i++)t+=n[i].degree(e);return t}});var jr,Pf,Of=function(e,t,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var o=a._private.position,s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};a.isParent()&&!(s.x===0&&s.y===0)&&a.children().shift(s,n),a.dirtyBoundingBoxCache()}}},Yd={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){Of(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};jr=Pf={position:ht.data(Yd),silentPosition:ht.data(Ye({},Yd,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){Of(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(ut(e))t?this.silentPosition(e):this.position(e);else if(Mt(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var o=this[a],s=void 0;(s=n(o,a))&&(t?o.silentPosition(s):o.position(s))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var i;if(ut(e)?(i={x:Ne(e.x)?e.x:0,y:Ne(e.y)?e.y:0},n=t):We(e)&&Ne(t)&&(i={x:0,y:0},i[e]=t),i!=null){var a=this.cy();a.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(a.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var u=s.position(),l={x:u.x+i.x,y:u.y+i.y};n?s.silentPosition(l):s.position(l)}}a.endBatch()}return this},silentShift:function(e,t){return ut(e)?this.shift(e,!0):We(e)&&Ne(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],i=this.cy(),a=i.zoom(),o=i.pan(),s=ut(e)?e:void 0,u=s!==void 0||t!==void 0&&We(e);if(n&&n.isNode())if(u)for(var l=0;l<this.length;l++){var c=this[l];t!==void 0?c.position(e,(t-o[e])/a):s!==void 0&&c.position(rf(s,a,o))}else{var d=n.position();return s=Zs(d,a,o),e===void 0?s:s[e]}else if(!u)return;return this},relativePosition:function(e,t){var n=this[0],i=this.cy(),a=ut(e)?e:void 0,o=a!==void 0||t!==void 0&&We(e),s=i.hasCompoundNodes();if(n&&n.isNode())if(o)for(var u=0;u<this.length;u++){var l=this[u],c=s?l.parent():null,d=c&&c.length>0,h=d;d&&(c=c[0]);var f=h?c.position():{x:0,y:0};t!==void 0?l.position(e,t+f[e]):a!==void 0&&l.position({x:a.x+f.x,y:a.y+f.y})}else{var v=n.position(),p=s?n.parent():null,m=p&&p.length>0,g=m;m&&(p=p[0]);var y=g?p.position():{x:0,y:0};return a={x:v.x-y.x,y:v.y-y.y},e===void 0?a:a[e]}else if(!o)return;return this}};jr.modelPosition=jr.point=jr.position;jr.modelPositions=jr.points=jr.positions;jr.renderedPoint=jr.renderedPosition;jr.relativePoint=jr.relativePosition;var iw=Pf,Qi,Wn;Qi=Wn={};Wn.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),n=t.zoom(),i=t.pan(),a=e.x1*n+i.x,o=e.x2*n+i.x,s=e.y1*n+i.y,u=e.y2*n+i.y;return{x1:a,x2:o,y1:s,y2:u,w:o-a,h:u-s}};Wn.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var n=t._private;n.compoundBoundsClean=!1,n.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};Wn.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(o){if(!o.isParent())return;var s=o._private,u=o.children(),l=o.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=u.boundingBox({includeLabels:l,includeOverlays:!1,useCache:!1}),h=s.position;(d.w===0||d.h===0)&&(d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},d.x1=h.x-d.w/2,d.x2=h.x+d.w/2,d.y1=h.y-d.h/2,d.y2=h.y+d.h/2);function f(R,L,B){var w=0,_=0,E=L+B;return R>0&&E>0&&(w=L/E*R,_=B/E*R),{biasDiff:w,biasComplementDiff:_}}function v(R,L,B,w){if(B.units==="%")switch(w){case"width":return R>0?B.pfValue*R:0;case"height":return L>0?B.pfValue*L:0;case"average":return R>0&&L>0?B.pfValue*(R+L)/2:0;case"min":return R>0&&L>0?R>L?B.pfValue*L:B.pfValue*R:0;case"max":return R>0&&L>0?R>L?B.pfValue*R:B.pfValue*L:0;default:return 0}else return B.units==="px"?B.pfValue:0}var p=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(p=p*100/c.width.val);var m=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var g=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(g=g*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var b=f(c.width.val-d.w,p,m),S=b.biasDiff,A=b.biasComplementDiff,P=f(c.height.val-d.h,g,y),O=P.biasDiff,I=P.biasComplementDiff;s.autoPadding=v(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(d.w,c.width.val),h.x=(-S+d.x1+d.x2+A)/2,s.autoHeight=Math.max(d.h,c.height.val),h.y=(-O+d.y1+d.y2+I)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||r)&&(t(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var Ir=function(e){return e===1/0||e===-1/0?0:e},zr=function(e,t,n,i,a){i-t===0||a-n===0||t==null||n==null||i==null||a==null||(e.x1=t<e.x1?t:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},ri=function(e,t){return t==null?e:zr(e,t.x1,t.y1,t.x2,t.y2)},Sa=function(e,t,n){return Gr(e,t,n)},Cs=function(e,t,n){if(!t.cy().headless()){var i=t._private,a=i.rstyle,o=a.arrowWidth/2,s=t.pstyle(n+"-arrow-shape").value,u,l;if(s!=="none"){n==="source"?(u=a.srcX,l=a.srcY):n==="target"?(u=a.tgtX,l=a.tgtY):(u=a.midX,l=a.midY);var c=i.arrowBounds=i.arrowBounds||{},d=c[n]=c[n]||{};d.x1=u-o,d.y1=l-o,d.x2=u+o,d.y2=l+o,d.w=d.x2-d.x1,d.h=d.y2-d.y1,Ms(d,1),zr(e,d.x1,d.y1,d.x2,d.y2)}}},ql=function(e,t,n){if(!t.cy().headless()){var i;n?i=n+"-":i="";var a=t._private,o=a.rstyle,s=t.pstyle(i+"label").strValue;if(s){var u=t.pstyle("text-halign"),l=t.pstyle("text-valign"),c=Sa(o,"labelWidth",n),d=Sa(o,"labelHeight",n),h=Sa(o,"labelX",n),f=Sa(o,"labelY",n),v=t.pstyle(i+"text-margin-x").pfValue,p=t.pstyle(i+"text-margin-y").pfValue,m=t.isEdge(),g=t.pstyle(i+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,b=t.pstyle("text-border-width").pfValue,S=b/2,A=t.pstyle("text-background-padding").pfValue,P=2,O=d,I=c,R=I/2,L=O/2,B,w,_,E;if(m)B=h-R,w=h+R,_=f-L,E=f+L;else{switch(u.value){case"left":B=h-I,w=h;break;case"center":B=h-R,w=h+R;break;case"right":B=h,w=h+I;break}switch(l.value){case"top":_=f-O,E=f;break;case"center":_=f-L,E=f+L;break;case"bottom":_=f,E=f+O;break}}var x=v-Math.max(y,S)-A-P,C=v+Math.max(y,S)+A+P,T=p-Math.max(y,S)-A-P,M=p+Math.max(y,S)+A+P;B+=x,w+=C,_+=T,E+=M;var D=n||"main",F=a.labelBounds,N=F[D]=F[D]||{};N.x1=B,N.y1=_,N.x2=w,N.y2=E,N.w=w-B,N.h=E-_,N.leftPad=x,N.rightPad=C,N.topPad=T,N.botPad=M;var z=m&&g.strValue==="autorotate",q=g.pfValue!=null&&g.pfValue!==0;if(z||q){var $=z?Sa(a.rstyle,"labelAngle",n):g.pfValue,ee=Math.cos($),J=Math.sin($),j=(B+w)/2,Z=(_+E)/2;if(!m){switch(u.value){case"left":j=w;break;case"right":j=B;break}switch(l.value){case"top":Z=E;break;case"bottom":Z=_;break}}var H=function(fe,ue){return fe=fe-j,ue=ue-Z,{x:fe*ee-ue*J+j,y:fe*J+ue*ee+Z}},k=H(B,_),G=H(B,E),W=H(w,_),te=H(w,E);B=Math.min(k.x,G.x,W.x,te.x),w=Math.max(k.x,G.x,W.x,te.x),_=Math.min(k.y,G.y,W.y,te.y),E=Math.max(k.y,G.y,W.y,te.y)}var X=D+"Rot",me=F[X]=F[X]||{};me.x1=B,me.y1=_,me.x2=w,me.y2=E,me.w=w-B,me.h=E-_,zr(e,B,_,w,E),zr(a.labelBounds.all,B,_,w,E)}return e}},aw=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,i=t.pstyle("outline-width").value;if(n>0&&i>0){var a=t.pstyle("outline-offset").value,o=t.pstyle("shape").value,s=i+a,u=(e.w+s*2)/e.w,l=(e.h+s*2)/e.h,c=0,d=0;["diamond","pentagon","round-triangle"].includes(o)?(u=(e.w+s*2.4)/e.w,d=-s/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(o)?u=(e.w+s*2.4)/e.w:o==="star"?(u=(e.w+s*2.8)/e.w,l=(e.h+s*2.6)/e.h,d=-s/3.8):o==="triangle"?(u=(e.w+s*2.8)/e.w,l=(e.h+s*2.4)/e.h,d=-s/1.4):o==="vee"&&(u=(e.w+s*4.4)/e.w,l=(e.h+s*3.8)/e.h,d=-s*.5);var h=e.h*l-e.h,f=e.w*u-e.w;if(As(e,[Math.ceil(h/2),Math.ceil(f/2)]),c!=0||d!==0){var v=S0(e,c,d);af(e,v)}}}},ow=function(e,t){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),o=Er(),s=e._private,u=e.isNode(),l=e.isEdge(),c,d,h,f,v,p,m=s.rstyle,g=u&&i?e.pstyle("bounds-expansion").pfValue:[0],y=function(Te){return Te.pstyle("display").value!=="none"},b=!i||y(e)&&(!l||y(e.source())&&y(e.target()));if(b){var S=0,A=0;i&&t.includeOverlays&&(S=e.pstyle("overlay-opacity").value,S!==0&&(A=e.pstyle("overlay-padding").value));var P=0,O=0;i&&t.includeUnderlays&&(P=e.pstyle("underlay-opacity").value,P!==0&&(O=e.pstyle("underlay-padding").value));var I=Math.max(A,O),R=0,L=0;if(i&&(R=e.pstyle("width").pfValue,L=R/2),u&&t.includeNodes){var B=e.position();v=B.x,p=B.y;var w=e.outerWidth(),_=w/2,E=e.outerHeight(),x=E/2;c=v-_,d=v+_,h=p-x,f=p+x,zr(o,c,h,d,f),i&&t.includeOutlines&&aw(o,e)}else if(l&&t.includeEdges)if(i&&!a){var C=e.pstyle("curve-style").strValue;if(c=Math.min(m.srcX,m.midX,m.tgtX),d=Math.max(m.srcX,m.midX,m.tgtX),h=Math.min(m.srcY,m.midY,m.tgtY),f=Math.max(m.srcY,m.midY,m.tgtY),c-=L,d+=L,h-=L,f+=L,zr(o,c,h,d,f),C==="haystack"){var T=m.haystackPts;if(T&&T.length===2){if(c=T[0].x,h=T[0].y,d=T[1].x,f=T[1].y,c>d){var M=c;c=d,d=M}if(h>f){var D=h;h=f,f=D}zr(o,c-L,h-L,d+L,f+L)}}else if(C==="bezier"||C==="unbundled-bezier"||C.endsWith("segments")||C.endsWith("taxi")){var F;switch(C){case"bezier":case"unbundled-bezier":F=m.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":F=m.linePts;break}if(F!=null)for(var N=0;N<F.length;N++){var z=F[N];c=z.x-L,d=z.x+L,h=z.y-L,f=z.y+L,zr(o,c,h,d,f)}}}else{var q=e.source(),$=q.position(),ee=e.target(),J=ee.position();if(c=$.x,d=J.x,h=$.y,f=J.y,c>d){var j=c;c=d,d=j}if(h>f){var Z=h;h=f,f=Z}c-=L,d+=L,h-=L,f+=L,zr(o,c,h,d,f)}if(i&&t.includeEdges&&l&&(Cs(o,e,"mid-source"),Cs(o,e,"mid-target"),Cs(o,e,"source"),Cs(o,e,"target")),i){var H=e.pstyle("ghost").value==="yes";if(H){var k=e.pstyle("ghost-offset-x").pfValue,G=e.pstyle("ghost-offset-y").pfValue;zr(o,o.x1+k,o.y1+G,o.x2+k,o.y2+G)}}var W=s.bodyBounds=s.bodyBounds||{};Sd(W,o),As(W,g),Ms(W,1),i&&(c=o.x1,d=o.x2,h=o.y1,f=o.y2,zr(o,c-I,h-I,d+I,f+I));var te=s.overlayBounds=s.overlayBounds||{};Sd(te,o),As(te,g),Ms(te,1);var X=s.labelBounds=s.labelBounds||{};X.all!=null?T0(X.all):X.all=Er(),i&&t.includeLabels&&(t.includeMainLabels&&ql(o,e,null),l&&(t.includeSourceLabels&&ql(o,e,"source"),t.includeTargetLabels&&ql(o,e,"target")))}return o.x1=Ir(o.x1),o.y1=Ir(o.y1),o.x2=Ir(o.x2),o.y2=Ir(o.y2),o.w=Ir(o.x2-o.x1),o.h=Ir(o.y2-o.y1),o.w>0&&o.h>0&&b&&(As(o,g),Ms(o,1)),o},Rf=function(e){var t=0,n=function(o){return(o?1:0)<<t++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},If=function(e){if(e.isEdge()){var t=e.source().position(),n=e.target().position(),i=function(o){return Math.round(o)};return Wm([i(t.x),i(t.y),i(n.x),i(n.y)])}else return 0},qd=function(e,t){var n=e._private,i,a=e.isEdge(),o=t==null?Xd:Rf(t),s=o===Xd,u=If(e),l=n.bbCachePosKey===u,c=t.useCache&&l,d=function(p){return p._private.bbCache==null||p._private.styleDirty},h=!c||d(e)||a&&(d(e.source())||d(e.target()));if(h?(l||e.recalculateRenderedStyle(c),i=ow(e,qa),n.bbCache=i,n.bbCachePosKey=u):i=n.bbCache,!s){var f=e.isNode();i=Er(),(t.includeNodes&&f||t.includeEdges&&!f)&&(t.includeOverlays?ri(i,n.overlayBounds):ri(i,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?ri(i,n.labelBounds.all):(t.includeMainLabels&&ri(i,n.labelBounds.mainRot),t.includeSourceLabels&&ri(i,n.labelBounds.sourceRot),t.includeTargetLabels&&ri(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},qa={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},Xd=Rf(qa),Kd=Jt(qa);Wn.boundingBox=function(r){var e;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(r===void 0||r.useCache===void 0||r.useCache===!0))r===void 0?r=qa:r=Kd(r),e=qd(this[0],r);else{e=Er(),r=r||qa;var t=Kd(r),n=this,i=n.cy(),a=i.styleEnabled();if(a)for(var o=0;o<n.length;o++){var s=n[o],u=s._private,l=If(s),c=u.bbCachePosKey===l,d=t.useCache&&c&&!u.styleDirty;s.recalculateRenderedStyle(d)}this.updateCompoundBounds(!r.useCache);for(var h=0;h<n.length;h++){var f=n[h];ri(e,qd(f,t))}}return e.x1=Ir(e.x1),e.y1=Ir(e.y1),e.x2=Ir(e.x2),e.y2=Ir(e.y2),e.w=Ir(e.x2-e.x1),e.h=Ir(e.y2-e.y1),e};Wn.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Wn.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),n=t.hasCompoundNodes(),i=t.collection();if(n&&(i=e.filter(function(l){return l.isParent()}),e=e.not(i)),ut(r)){var a=r;r=function(){return a}}var o=function(c,d){return c._private.bbAtOldPos=r(c,d)},s=function(c){return c._private.bbAtOldPos};t.startBatch(),e.forEach(o).silentPositions(r),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var u=_0(this.boundingBox({useCache:!1}));return e.silentPositions(s),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),t.endBatch(),u};Qi.boundingbox=Qi.bb=Qi.boundingBox;Qi.renderedBoundingbox=Qi.renderedBoundingBox;var sw=Wn,La,ro;La=ro={};var Lf=function(e){e.uppercaseName=Cd(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=Cd(e.outerName),La[e.name]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var s=n.pstyle(e.name);switch(s.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return s.pfValue}}else return 1},La["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){var s=n[e.name](),u=n.pstyle("border-width").pfValue,l=2*n.padding();return s+u+l}else return 1},La["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},La["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};Lf({name:"width"});Lf({name:"height"});ro.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};ro.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};ro.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var lw=ro,uw=function(e,t){if(e.isEdge())return t(e)},cw=function(e,t){if(e.isEdge()){var n=e.cy();return Zs(t(e),n.zoom(),n.pan())}},dw=function(e,t){if(e.isEdge()){var n=e.cy(),i=n.pan(),a=n.zoom();return t(e).map(function(o){return Zs(o,a,i)})}},hw=function(e){return e.renderer().getControlPoints(e)},fw=function(e){return e.renderer().getSegmentPoints(e)},vw=function(e){return e.renderer().getSourceEndpoint(e)},pw=function(e){return e.renderer().getTargetEndpoint(e)},gw=function(e){return e.renderer().getEdgeMidpoint(e)},Zd={controlPoints:{get:hw,mult:!0},segmentPoints:{get:fw,mult:!0},sourceEndpoint:{get:vw},targetEndpoint:{get:pw},midpoint:{get:gw}},mw=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},yw=Object.keys(Zd).reduce(function(r,e){var t=Zd[e],n=mw(e);return r[e]=function(){return uw(this,t.get)},t.mult?r[n]=function(){return dw(this,t.get)}:r[n]=function(){return cw(this,t.get)},r},{}),Cw=Ye({},iw,sw,lw,yw);var Nf=function(e,t){this.recycle(e,t)};function Ma(){return!1}function ws(){return!0}Nf.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ma,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?ws:Ma):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=ws;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=ws;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ws,this.stopPropagation()},isDefaultPrevented:Ma,isPropagationStopped:Ma,isImmediatePropagationStopped:Ma};var kf=/^([^.]+)(\.(?:[^.]+))?$/,ww=".*",Ff={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Qd=Object.keys(Ff),bw={};function nl(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bw,e=arguments.length>1?arguments[1]:void 0,t=0;t<Qd.length;t++){var n=Qd[t];this[n]=r[n]||Ff[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Hn=nl.prototype,Bf=function(e,t,n,i,a,o,s){Mt(i)&&(a=i,i=null),s&&(o==null?o=s:o=Ye({},o,s));for(var u=gt(n)?n:n.split(/\s+/),l=0;l<u.length;l++){var c=u[l];if(!Bn(c)){var d=c.match(kf);if(d){var h=d[1],f=d[2]?d[2]:null,v=t(e,c,h,f,i,a,o);if(v===!1)break}}}},Jd=function(e,t){return e.addEventFields(e.context,t),new Nf(t.type,t)},xw=function(e,t,n){if(Hg(n)){t(e,n);return}else if(ut(n)){t(e,Jd(e,n));return}for(var i=gt(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var o=i[a];if(!Bn(o)){var s=o.match(kf);if(s){var u=s[1],l=s[2]?s[2]:null,c=Jd(e,{type:u,namespace:l,target:e.context});t(e,c)}}}};Hn.on=Hn.addListener=function(r,e,t,n,i){return Bf(this,function(a,o,s,u,l,c,d){Mt(c)&&a.listeners.push({event:o,callback:c,type:s,namespace:u,qualifier:l,conf:d})},r,e,t,n,i),this};Hn.one=function(r,e,t,n){return this.on(r,e,t,n,{one:!0})};Hn.removeListener=Hn.off=function(r,e,t,n){var i=this;this.emitting!==0&&(this.listeners=Zm(this.listeners));for(var a=this.listeners,o=function(l){var c=a[l];Bf(i,function(d,h,f,v,p,m){if((c.type===f||r==="*")&&(!v&&c.namespace!==".*"||c.namespace===v)&&(!p||d.qualifierCompare(c.qualifier,p))&&(!m||c.callback===m))return a.splice(l,1),!1},r,e,t,n)},s=a.length-1;s>=0;s--)o(s);return this};Hn.removeAllListeners=function(){return this.removeListener("*")};Hn.emit=Hn.trigger=function(r,e,t){var n=this.listeners,i=n.length;return this.emitting++,gt(e)||(e=[e]),xw(this,function(a,o){t!=null&&(n=[{event:o.event,type:o.type,namespace:o.namespace,callback:t}],i=n.length);for(var s=function(c){var d=n[c];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===ww)&&a.eventMatches(a.context,d,o)){var h=[o];e!=null&&Jm(h,e),a.beforeEmit(a.context,d,o),d.conf&&d.conf.one&&(a.listeners=a.listeners.filter(function(p){return p!==d}));var f=a.callbackContext(a.context,d,o),v=d.callback.apply(f,h);a.afterEmit(a.context,d,o),v===!1&&(o.stopPropagation(),o.preventDefault())}},u=0;u<i;u++)s(u);a.bubble(a.context)&&!o.isPropagationStopped()&&a.parent(a.context).emit(o,e)},r),this.emitting--,this};var Ew={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&Qa(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},bs=function(e){return We(e)?new Gn(e):e},Vf={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new nl(Ew,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n)}return this},removeListener:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().one(e,i,n)}return this},once:function(e,t,n){for(var i=bs(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,t){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};ht.eventAliasesOn(Vf);var zf={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):t.push(i)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(We(e)||Ar(e))return new Gn(e).filter(this);if(Mt(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);s&&n.push(o)}return n}return this.spawn()},not:function(e){if(e){We(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||t.push(i)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(We(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),i=this,a=e,o=this.length<e.length,s=o?i:a,u=o?a:i,l=0;l<s.length;l++){var c=s[l];u.has(c)&&n.push(c)}return n},xor:function(e){var t=this._private.cy;We(e)&&(e=t.$(e));var n=this.spawn(),i=this,a=e,o=function(u,l){for(var c=0;c<u.length;c++){var d=u[c],h=d._private.data.id,f=l.hasElementWithId(h);f||n.push(d)}};return o(i,a),o(a,i),n},diff:function(e){var t=this._private.cy;We(e)&&(e=t.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),o=this,s=e,u=function(c,d,h){for(var f=0;f<c.length;f++){var v=c[f],p=v._private.data.id,m=d.hasElementWithId(p);m?a.merge(v):h.push(v)}};return u(o,s,n),u(s,o,i),{left:n,right:i,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(We(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var o=e[a],s=!this.has(o);s&&i.push(o)}return i},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&We(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=t.map,o=0;o<e.length;o++){var s=e[o],u=s._private.data.id,l=!a.has(u);if(l){var c=this.length++;this[c]=s,a.set(u,{ele:s,index:c})}}return this},unmergeAt:function(e){var t=this[e],n=t.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1,u=this[s],l=u._private.data.id;this[s]=void 0,this[e]=u,a.set(l,{ele:u,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,i=t.map,a=i.get(n);if(!a)return this;var o=a.index;return this.unmergeAt(o),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&We(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var n=this[t];e(n)&&this.unmergeAt(t)}return this},map:function(e,t){for(var n=[],i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);n.push(s)}return n},reduce:function(e,t){for(var n=t,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,t){for(var n=-1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],u=t?e.apply(t,[s,o,a]):e(s,o,a);u>n&&(n=u,i=s)}return{value:n,ele:i}},min:function(e,t){for(var n=1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],u=t?e.apply(t,[s,o,a]):e(s,o,a);u<n&&(n=u,i=s)}return{value:n,ele:i}}},dt=zf;dt.u=dt["|"]=dt["+"]=dt.union=dt.or=dt.add;dt["\\"]=dt["!"]=dt["-"]=dt.difference=dt.relativeComplement=dt.subtract=dt.not;dt.n=dt["&"]=dt["."]=dt.and=dt.intersection=dt.intersect;dt["^"]=dt["(+)"]=dt["(-)"]=dt.symmetricDifference=dt.symdiff=dt.xor;dt.fnFilter=dt.filterFn=dt.stdFilter=dt.filter;dt.complement=dt.abscomp=dt.absoluteComplement;var _w={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},Gf=function(e,t){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var d=c.pstyle("z-compound-depth");return d.value==="auto"?i?c.zDepth():0:d.value==="bottom"?-1:d.value==="top"?Eu:0}var o=a(e)-a(t);if(o!==0)return o;function s(c){var d=c.pstyle("z-index-compare");return d.value==="auto"&&c.isNode()?1:0}var u=s(e)-s(t);if(u!==0)return u;var l=e.pstyle("z-index").value-t.pstyle("z-index").value;return l!==0?l:e.poolIndex()-t.poolIndex()},js={forEach:function(e,t){if(Mt(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],o=t?e.apply(t,[a,i,this]):e(a,i,this);if(o===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],i=this.length;t==null&&(t=i),e==null&&(e=0),e<0&&(e=i+e),t<0&&(t=i+t);for(var a=e;a>=0&&a<t&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!Mt(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(Gf)},zDepth:function(){var e=this[0];if(e){var t=e._private,n=t.group;if(n==="nodes"){var i=t.data.parent?e.parents().size():0;return e.isParent()?i:Eu-1}else{var a=t.source,o=t.target,s=a.zDepth(),u=o.zDepth();return Math.max(s,u,0)}}}};js.each=js.forEach;var Tw=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":Gt(Symbol))!=e&&Gt(Symbol.iterator)!=e;t&&(js[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,o=this.length;return kh({next:function(){return a<o?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};Tw();var Sw=Jt({nodeDimensionsIncludeLabels:!1}),Ps={layoutDimensions:function(e){e=Sw(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,n){var i=this.nodes().filter(function(A){return!A.isParent()}),a=this.cy(),o=t.eles,s=function(P){return P.id()},u=za(n,s);e.emit({type:"layoutstart",layout:e}),e.animations=[];var l=function(P,O,I){var R={x:O.x1+O.w/2,y:O.y1+O.h/2},L={x:(I.x-R.x)*P,y:(I.y-R.y)*P};return{x:R.x+L.x,y:R.y+L.y}},c=t.spacingFactor&&t.spacingFactor!==1,d=function(){if(!c)return null;for(var P=Er(),O=0;O<i.length;O++){var I=i[O],R=u(I,O);M0(P,R.x,R.y)}return P},h=d(),f=za(function(A,P){var O=u(A,P);if(c){var I=Math.abs(t.spacingFactor);O=l(I,h,O)}return t.transform!=null&&(O=t.transform(A,O)),O},s);if(t.animate){for(var v=0;v<i.length;v++){var p=i[v],m=f(p,v),g=t.animateFilter==null||t.animateFilter(p,v);if(g){var y=p.animation({position:m,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else p.position(m)}if(t.fit){var b=a.animation({fit:{boundingBox:o.boundingBoxAt(f),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else if(t.zoom!==void 0&&t.pan!==void 0){var S=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(S)}e.animations.forEach(function(A){return A.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),ia.all(e.animations.map(function(A){return A.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(f),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(Ye({},e,{eles:this}))}};Ps.createLayout=Ps.makeLayout=Ps.layout;function jf(r,e,t){var n=t._private,i=n.styleCache=n.styleCache||[],a;return(a=i[r])!=null||(a=i[r]=e(t)),a}function il(r,e){return r=Vn(r),function(n){return jf(r,e,n)}}function al(r,e){r=Vn(r);var t=function(i){return e.call(i)};return function(){var i=this[0];if(i)return jf(r,t,i)}}var tr={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),i=t.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(t)}else this.forEach(function(i){t(i),i.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var n=t._private.batchStyleEles;return n.merge(this),this}var i=t.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=a;return e?o.emitAndNotify("style"):o.emit("style"),a.forEach(function(s){return s._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(t?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];if(n)return t.style().getRenderedStyle(n,e)},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(ut(e)){var o=e;a.applyBypass(this,o,i),this.emitAndNotify("style")}else if(We(e))if(t===void 0){var s=this[0];return s?a.getStylePropertyValue(s,e):void 0}else a.applyBypass(this,e,t,i),this.emitAndNotify("style");else if(e===void 0){var u=this[0];return u?a.getRawStyle(u):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,i=t.style(),a=this;if(e===void 0)for(var o=0;o<a.length;o++){var s=a[o];i.removeAllBypasses(s,n)}else{e=e.split(/\s+/);for(var u=0;u<a.length;u++){var l=a[u];i.removeBypasses(l,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!t)return a;var o=i.data.parent?n.parents():null;if(o)for(var s=0;s<o.length;s++){var u=o[s],l=u.pstyle("opacity").value;a=l*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],n=t.cy().hasCompoundNodes();if(t)return n?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function Xl(r,e){var t=r._private,n=t.data.parent?r.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function Nu(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,n=r.parentOk||r.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],o=i.hasCompoundNodes();if(a){var s=a._private;if(!e(a))return!1;if(a.isNode())return!o||Xl(a,n);var u=s.source,l=s.target;return t(u)&&(!o||Xl(u,t))&&(u===l||t(l)&&(!o||Xl(l,t)))}}}var la=il("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});tr.takesUpSpace=al("takesUpSpace",Nu({ok:la}));var Mw=il("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&la(r)}),Aw=il("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&la(r)});tr.interactive=al("interactive",Nu({ok:Mw,parentOk:Aw,edgeOkViaNode:la}));tr.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var Dw=il("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&la(r)}),Pw=la;tr.visible=al("visible",Nu({ok:Dw,edgeOkViaNode:Pw}));tr.hidden=function(){var r=this[0];if(r)return!r.visible()};tr.isBundledBezier=al("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});tr.bypass=tr.css=tr.style;tr.renderedCss=tr.renderedStyle;tr.removeBypass=tr.removeCss=tr.removeStyle;tr.pstyle=tr.parsedStyle;var Fn={};function eh(r){return function(){var e=arguments,t=[];if(e.length===2){var n=e[0],i=e[1];this.on(r.event,n,i)}else if(e.length===1&&Mt(e[0])){var a=e[0];this.on(r.event,a)}else if(e.length===0||e.length===1&&gt(e[0])){for(var o=e.length===1?e[0]:null,s=0;s<this.length;s++){var u=this[s],l=!r.ableField||u._private[r.ableField],c=u._private[r.field]!=r.value;if(r.overrideAble){var d=r.overrideAble(u);if(d!==void 0&&(l=d,!d))return this}l&&(u._private[r.field]=r.value,c&&t.push(u))}var h=this.spawn(t);h.updateStyle(),h.emit(r.event),o&&h.emit(o)}return this}}function ua(r){Fn[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},Fn[r.on]=eh({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),Fn[r.off]=eh({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}ua({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});ua({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});ua({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});ua({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Fn.deselect=Fn.unselect;Fn.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};ua({field:"active",on:"activate",off:"unactivate"});ua({field:"pannable",on:"panify",off:"unpanify"});Fn.inactive=function(){var r=this[0];if(r)return!r._private.active};var cr={},th=function(e){return function(n){for(var i=this,a=[],o=0;o<i.length;o++){var s=i[o];if(s.isNode()){for(var u=!1,l=s.connectedEdges(),c=0;c<l.length;c++){var d=l[c],h=d.source(),f=d.target();if(e.noIncomingEdges&&f===s&&h!==s||e.noOutgoingEdges&&h===s&&f!==s){u=!0;break}}u||a.push(s)}}return this.spawn(a,!0).filter(n)}},rh=function(e){return function(t){for(var n=this,i=[],a=0;a<n.length;a++){var o=n[a];if(o.isNode())for(var s=o.connectedEdges(),u=0;u<s.length;u++){var l=s[u],c=l.source(),d=l.target();e.outgoing&&c===o?(i.push(l),i.push(d)):e.incoming&&d===o&&(i.push(l),i.push(c))}}return this.spawn(i,!0).filter(t)}},nh=function(e){return function(t){for(var n=this,i=[],a={};;){var o=e.outgoing?n.outgoers():n.incomers();if(o.length===0)break;for(var s=!1,u=0;u<o.length;u++){var l=o[u],c=l.id();a[c]||(a[c]=!0,i.push(l),s=!0)}if(!s)break;n=o}return this.spawn(i,!0).filter(t)}};cr.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Ye(cr,{roots:th({noIncomingEdges:!0}),leaves:th({noOutgoingEdges:!0}),outgoers:Lr(rh({outgoing:!0}),"outgoers"),successors:nh({outgoing:!0}),incomers:Lr(rh({incoming:!0}),"incomers"),predecessors:nh({incoming:!0})});Ye(cr,{neighborhood:Lr(function(r){for(var e=[],t=this.nodes(),n=0;n<t.length;n++)for(var i=t[n],a=i.connectedEdges(),o=0;o<a.length;o++){var s=a[o],u=s.source(),l=s.target(),c=i===u?l:u;c.length>0&&e.push(c[0]),e.push(s[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});cr.neighbourhood=cr.neighborhood;cr.closedNeighbourhood=cr.closedNeighborhood;cr.openNeighbourhood=cr.openNeighborhood;Ye(cr,{source:Lr(function(e){var t=this[0],n;return t&&(n=t._private.source||t.cy().collection()),n&&e?n.filter(e):n},"source"),target:Lr(function(e){var t=this[0],n;return t&&(n=t._private.target||t.cy().collection()),n&&e?n.filter(e):n},"target"),sources:ih({attr:"source"}),targets:ih({attr:"target"})});function ih(r){return function(t){for(var n=[],i=0;i<this.length;i++){var a=this[i],o=a._private[r.attr];o&&n.push(o)}return this.spawn(n,!0).filter(t)}}Ye(cr,{edgesWith:Lr(ah(),"edgesWith"),edgesTo:Lr(ah({thisIsSrc:!0}),"edgesTo")});function ah(r){return function(t){var n=[],i=this._private.cy,a=r||{};We(t)&&(t=i.$(t));for(var o=0;o<t.length;o++)for(var s=t[o]._private.edges,u=0;u<s.length;u++){var l=s[u],c=l._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),h=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target),f=d||h;f&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!d||a.thisIsTgt&&!h)||n.push(l))}return this.spawn(n,!0)}}Ye(cr,{connectedEdges:Lr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];if(i.isNode())for(var a=i._private.edges,o=0;o<a.length;o++){var s=a[o];e.push(s)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:Lr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:Lr(oh(),"parallelEdges"),codirectedEdges:Lr(oh({codirected:!0}),"codirectedEdges")});function oh(r){var e={codirected:!1};return r=Ye({},e,r),function(n){for(var i=[],a=this.edges(),o=r,s=0;s<a.length;s++)for(var u=a[s],l=u._private,c=l.source,d=c._private.data.id,h=l.data.target,f=c._private.edges,v=0;v<f.length;v++){var p=f[v],m=p._private.data,g=m.target,y=m.source,b=g===h&&y===d,S=d===g&&h===y;(o.codirected&&b||!o.codirected&&(b||S))&&i.push(p)}return this.spawn(i,!0).filter(n)}}Ye(cr,{components:function(e){var t=this,n=t.cy(),i=n.collection(),a=e==null?t.nodes():e.nodes(),o=[];e!=null&&a.empty()&&(a=e.sources());var s=function(c,d){i.merge(c),a.unmerge(c),d.merge(c)};if(a.empty())return t.spawn();var u=function(){var c=n.collection();o.push(c);var d=a[0];s(d,c),t.bfs({directed:!1,roots:d,visit:function(f){return s(f,c)}}),c.forEach(function(h){h.connectedEdges().forEach(function(f){t.has(f)&&c.has(f.source())&&c.has(f.target())&&c.merge(f)})})};do u();while(a.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});cr.componentsOf=cr.components;var rr=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){St("A collection must have a reference to the core");return}var a=new tn,o=!1;if(!t)t=[];else if(t.length>0&&ut(t[0])&&!Qa(t[0])){o=!0;for(var s=[],u=new na,l=0,c=t.length;l<c;l++){var d=t[l];d.data==null&&(d.data={});var h=d.data;if(h.id==null)h.id=ef();else if(e.hasElementWithId(h.id)||u.has(h.id))continue;var f=new Ks(e,d,!1);s.push(f),u.add(h.id)}t=s}this.length=0;for(var v=0,p=t.length;v<p;v++){var m=t[v][0];if(m!=null){var g=m._private.data.id;(!n||!a.has(g))&&(n&&a.set(g,{index:this.length,ele:m}),this[this.length]=m,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var b=this.lazyMap=new tn,S=this.eles,A=0;A<S.length;A++){var P=S[A];b.set(P.id(),{index:A,ele:P})}}},n&&(this._private.map=a),o&&!i&&this.restore()},wt=Ks.prototype=rr.prototype=Object.create(Array.prototype);wt.instanceString=function(){return"collection"};wt.spawn=function(r,e){return new rr(this.cy(),r,e)};wt.spawnSelf=function(){return this.spawn(this)};wt.cy=function(){return this._private.cy};wt.renderer=function(){return this._private.cy.renderer()};wt.element=function(){return this[0]};wt.collection=function(){return Vh(this)?this:new rr(this._private.cy,[this])};wt.unique=function(){return new rr(this._private.cy,this,!0)};wt.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};wt.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new rr(e)};wt.$id=wt.getElementById;wt.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};wt.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};wt.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};wt.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var n=e._private;if(ut(r)){if(t.startBatch(),r.data){e.data(r.data);var i=n.data;if(e.isEdge()){var a=!1,o={},s=r.data.source,u=r.data.target;s!=null&&s!=i.source&&(o.source=""+s,a=!0),u!=null&&u!=i.target&&(o.target=""+u,a=!0),a&&(e=e.move(o))}else{var l="parent"in r.data,c=r.data.parent;l&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}r.position&&e.position(r.position);var d=function(p,m,g){var y=r[p];y!=null&&y!==n[p]&&(y?e[m]():e[g]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var h={data:en(n.data),position:en(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};h.classes="";var f=0;return n.classes.forEach(function(v){return h.classes+=f++===0?v:" "+v}),h}}};wt.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],n=t.json();r.push(n)}return r};wt.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var n=this[t],i=n.json(),a=new Ks(r,i,!1);e.push(a)}return new rr(r,e)};wt.copy=wt.clone;wt.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=t.cy(),i=n._private,a=[],o=[],s,u=0,l=t.length;u<l;u++){var c=t[u];e&&!c.removed()||(c.isNode()?a.push(c):o.push(c))}s=a.concat(o);var d,h=function(){s.splice(d,1),d--};for(d=0;d<s.length;d++){var f=s[d],v=f._private,p=v.data;if(f.clearTraversalCache(),!(!e&&!v.removed)){if(p.id===void 0)p.id=ef();else if(Ne(p.id))p.id=""+p.id;else if(Bn(p.id)||!We(p.id)){St("Can not create element with invalid string ID `"+p.id+"`"),h();continue}else if(n.hasElementWithId(p.id)){St("Can not create second element with ID `"+p.id+"`"),h();continue}}var m=p.id;if(f.isNode()){var g=v.position;g.x==null&&(g.x=0),g.y==null&&(g.y=0)}if(f.isEdge()){for(var y=f,b=["source","target"],S=b.length,A=!1,P=0;P<S;P++){var O=b[P],I=p[O];Ne(I)&&(I=p[O]=""+p[O]),I==null||I===""?(St("Can not create edge `"+m+"` with unspecified "+O),A=!0):n.hasElementWithId(I)||(St("Can not create edge `"+m+"` with nonexistant "+O+" `"+I+"`"),A=!0)}if(A){h();continue}var R=n.getElementById(p.source),L=n.getElementById(p.target);R.same(L)?R._private.edges.push(y):(R._private.edges.push(y),L._private.edges.push(y)),y._private.source=R,y._private.target=L}v.map=new tn,v.map.set(m,{ele:f,index:0}),v.removed=!1,e&&n.addToPool(f)}for(var B=0;B<a.length;B++){var w=a[B],_=w._private.data;Ne(_.parent)&&(_.parent=""+_.parent);var E=_.parent,x=E!=null;if(x||w._private.parent){var C=w._private.parent?n.collection().merge(w._private.parent):n.getElementById(E);if(C.empty())_.parent=void 0;else if(C[0].removed())ft("Node added with missing parent, reference to parent removed"),_.parent=void 0,w._private.parent=null;else{for(var T=!1,M=C;!M.empty();){if(w.same(M)){T=!0,_.parent=void 0;break}M=M.parent()}T||(C[0]._private.children.push(w),w._private.parent=C[0],i.hasCompoundNodes=!0)}}}if(s.length>0){for(var D=s.length===t.length?t:new rr(n,s),F=0;F<D.length;F++){var N=D[F];N.isNode()||(N.parallelEdges().clearTraversalCache(),N.source().clearTraversalCache(),N.target().clearTraversalCache())}var z;i.hasCompoundNodes?z=n.collection().merge(D).merge(D.connectedNodes()).merge(D.parent()):z=D,z.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?D.emitAndNotify("add"):e&&D.emit("add")}return t};wt.removed=function(){var r=this[0];return r&&r._private.removed};wt.inside=function(){var r=this[0];return r&&!r._private.removed};wt.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=[],i={},a=t._private.cy;function o(E){for(var x=E._private.edges,C=0;C<x.length;C++)u(x[C])}function s(E){for(var x=E._private.children,C=0;C<x.length;C++)u(x[C])}function u(E){var x=i[E.id()];e&&E.removed()||x||(i[E.id()]=!0,E.isNode()?(n.push(E),o(E),s(E)):n.unshift(E))}for(var l=0,c=t.length;l<c;l++){var d=t[l];u(d)}function h(E,x){var C=E._private.edges;zn(C,x),E.clearTraversalCache()}function f(E){E.clearTraversalCache()}var v=[];v.ids={};function p(E,x){x=x[0],E=E[0];var C=E._private.children,T=E.id();zn(C,x),x._private.parent=null,v.ids[T]||(v.ids[T]=!0,v.push(E))}t.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var m=0;m<n.length;m++){var g=n[m];if(g.isEdge()){var y=g.source()[0],b=g.target()[0];h(y,g),h(b,g);for(var S=g.parallelEdges(),A=0;A<S.length;A++){var P=S[A];f(P),P.isBundledBezier()&&P.dirtyBoundingBoxCache()}}else{var O=g.parent();O.length!==0&&p(O,g)}e&&(g._private.removed=!0)}var I=a._private.elements;a._private.hasCompoundNodes=!1;for(var R=0;R<I.length;R++){var L=I[R];if(L.isParent()){a._private.hasCompoundNodes=!0;break}}var B=new rr(this.cy(),n);B.size()>0&&(r?B.emitAndNotify("remove"):e&&B.emit("remove"));for(var w=0;w<v.length;w++){var _=v[w];(!e||!_.removed())&&_.updateStyle()}return B};wt.move=function(r){var e=this._private.cy,t=this,n=!1,i=!1,a=function(v){return v==null?v:""+v};if(r.source!==void 0||r.target!==void 0){var o=a(r.source),s=a(r.target),u=o!=null&&e.hasElementWithId(o),l=s!=null&&e.hasElementWithId(s);(u||l)&&(e.batch(function(){t.remove(n,i),t.emitAndNotify("moveout");for(var f=0;f<t.length;f++){var v=t[f],p=v._private.data;v.isEdge()&&(u&&(p.source=o),l&&(p.target=s))}t.restore(n,i)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var c=a(r.parent),d=c===null||e.hasElementWithId(c);if(d){var h=c===null?void 0:c;e.batch(function(){var f=t.remove(n,i);f.emitAndNotify("moveout");for(var v=0;v<t.length;v++){var p=t[v],m=p._private.data;p.isNode()&&(m.parent=h)}f.restore(n,i)}),t.emitAndNotify("move")}}return this};[vf,GC,Ds,kn,ra,nw,rl,Cw,Vf,zf,_w,js,Ps,tr,Fn,cr].forEach(function(r){Ye(wt,r)});var Ow={add:function(e){var t,n=this;if(Ar(e)){var i=e;if(i._private.cy===n)t=i.restore();else{for(var a=[],o=0;o<i.length;o++){var s=i[o];a.push(s.json())}t=new rr(n,a)}}else if(gt(e)){var u=e;t=new rr(n,u)}else if(ut(e)&&(gt(e.nodes)||gt(e.edges))){for(var l=e,c=[],d=["nodes","edges"],h=0,f=d.length;h<f;h++){var v=d[h],p=l[v];if(gt(p))for(var m=0,g=p.length;m<g;m++){var y=Ye({group:v},p[m]);c.push(y)}}t=new rr(n,c)}else{var b=e;t=new Ks(n,b).collection()}return t},remove:function(e){if(!Ar(e)){if(We(e)){var t=e;e=this.$(t)}}return e.remove()}};function Rw(r,e,t,n){var i=4,a=.001,o=1e-7,s=10,u=11,l=1/(u-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var h=c?new Float32Array(u):new Array(u);function f(L,B){return 1-3*B+3*L}function v(L,B){return 3*B-6*L}function p(L){return 3*L}function m(L,B,w){return((f(B,w)*L+v(B,w))*L+p(B))*L}function g(L,B,w){return 3*f(B,w)*L*L+2*v(B,w)*L+p(B)}function y(L,B){for(var w=0;w<i;++w){var _=g(B,r,t);if(_===0)return B;var E=m(B,r,t)-L;B-=E/_}return B}function b(){for(var L=0;L<u;++L)h[L]=m(L*l,r,t)}function S(L,B,w){var _,E,x=0;do E=B+(w-B)/2,_=m(E,r,t)-L,_>0?w=E:B=E;while(Math.abs(_)>o&&++x<s);return E}function A(L){for(var B=0,w=1,_=u-1;w!==_&&h[w]<=L;++w)B+=l;--w;var E=(L-h[w])/(h[w+1]-h[w]),x=B+E*l,C=g(x,r,t);return C>=a?y(L,x):C===0?x:S(L,B,B+l)}var P=!1;function O(){P=!0,(r!==e||t!==n)&&b()}var I=function(B){return P||O(),r===e&&t===n?B:B===0?0:B===1?1:m(A(B),e,n)};I.getControlPoints=function(){return[{x:r,y:e},{x:t,y:n}]};var R="generateBezier("+[r,e,t,n]+")";return I.toString=function(){return R},I}var Iw=function(){function r(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var o={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:o.v,dv:r(o)}}function t(n,i){var a={dx:n.v,dv:r(n)},o=e(n,i*.5,a),s=e(n,i*.5,o),u=e(n,i,s),l=1/6*(a.dx+2*(o.dx+s.dx)+u.dx),c=1/6*(a.dv+2*(o.dv+s.dv)+u.dv);return n.x=n.x+l*i,n.v=n.v+c*i,n}return function n(i,a,o){var s={x:-1,v:0,tension:null,friction:null},u=[0],l=0,c=1/1e4,d=16/1e3,h,f,v;for(i=parseFloat(i)||500,a=parseFloat(a)||20,o=o||null,s.tension=i,s.friction=a,h=o!==null,h?(l=n(i,a),f=l/o*d):f=d;v=t(v||s,f),u.push(1+v.x),l+=16,Math.abs(v.x)>c&&Math.abs(v.v)>c;);return h?function(p){return u[p*(u.length-1)|0]}:l}}(),Ct=function(e,t,n,i){var a=Rw(e,t,n,i);return function(o,s,u){return o+(s-o)*a(u)}},Os={linear:function(e,t,n){return e+(t-e)*n},ease:Ct(.25,.1,.25,1),"ease-in":Ct(.42,0,1,1),"ease-out":Ct(0,0,.58,1),"ease-in-out":Ct(.42,0,.58,1),"ease-in-sine":Ct(.47,0,.745,.715),"ease-out-sine":Ct(.39,.575,.565,1),"ease-in-out-sine":Ct(.445,.05,.55,.95),"ease-in-quad":Ct(.55,.085,.68,.53),"ease-out-quad":Ct(.25,.46,.45,.94),"ease-in-out-quad":Ct(.455,.03,.515,.955),"ease-in-cubic":Ct(.55,.055,.675,.19),"ease-out-cubic":Ct(.215,.61,.355,1),"ease-in-out-cubic":Ct(.645,.045,.355,1),"ease-in-quart":Ct(.895,.03,.685,.22),"ease-out-quart":Ct(.165,.84,.44,1),"ease-in-out-quart":Ct(.77,0,.175,1),"ease-in-quint":Ct(.755,.05,.855,.06),"ease-out-quint":Ct(.23,1,.32,1),"ease-in-out-quint":Ct(.86,0,.07,1),"ease-in-expo":Ct(.95,.05,.795,.035),"ease-out-expo":Ct(.19,1,.22,1),"ease-in-out-expo":Ct(1,0,0,1),"ease-in-circ":Ct(.6,.04,.98,.335),"ease-out-circ":Ct(.075,.82,.165,1),"ease-in-out-circ":Ct(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return Os.linear;var i=Iw(e,t,n);return function(a,o,s){return a+(o-a)*i(s)}},"cubic-bezier":Ct};function sh(r,e,t,n,i){if(n===1||e===t)return t;var a=i(e,t,n);return r==null||((r.roundValue||r.color)&&(a=Math.round(a)),r.min!==void 0&&(a=Math.max(a,r.min)),r.max!==void 0&&(a=Math.min(a,r.max))),a}function lh(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function Hi(r,e,t,n,i){var a=i!=null?i.type:null;t<0?t=0:t>1&&(t=1);var o=lh(r,i),s=lh(e,i);if(Ne(o)&&Ne(s))return sh(a,o,s,t,n);if(gt(o)&&gt(s)){for(var u=[],l=0;l<s.length;l++){var c=o[l],d=s[l];if(c!=null&&d!=null){var h=sh(a,c,d,t,n);u.push(h)}else u.push(d)}return u}}function Lw(r,e,t,n){var i=!n,a=r._private,o=e._private,s=o.easing,u=o.startTime,l=n?r:r.cy(),c=l.style();if(!o.easingImpl)if(s==null)o.easingImpl=Os.linear;else{var d;if(We(s)){var h=c.parse("transition-timing-function",s);d=h.value}else d=s;var f,v;We(d)?(f=d,v=[]):(f=d[1],v=d.slice(2).map(function(D){return+D})),v.length>0?(f==="spring"&&v.push(o.duration),o.easingImpl=Os[f].apply(null,v)):o.easingImpl=Os[f]}var p=o.easingImpl,m;if(o.duration===0?m=1:m=(t-u)/o.duration,o.applying&&(m=o.progress),m<0?m=0:m>1&&(m=1),o.delay==null){var g=o.startPosition,y=o.position;if(y&&i&&!r.locked()){var b={};Aa(g.x,y.x)&&(b.x=Hi(g.x,y.x,m,p)),Aa(g.y,y.y)&&(b.y=Hi(g.y,y.y,m,p)),r.position(b)}var S=o.startPan,A=o.pan,P=a.pan,O=A!=null&&n;O&&(Aa(S.x,A.x)&&(P.x=Hi(S.x,A.x,m,p)),Aa(S.y,A.y)&&(P.y=Hi(S.y,A.y,m,p)),r.emit("pan"));var I=o.startZoom,R=o.zoom,L=R!=null&&n;L&&(Aa(I,R)&&(a.zoom=Ua(a.minZoom,Hi(I,R,m,p),a.maxZoom)),r.emit("zoom")),(O||L)&&r.emit("viewport");var B=o.style;if(B&&B.length>0&&i){for(var w=0;w<B.length;w++){var _=B[w],E=_.name,x=_,C=o.startStyle[E],T=c.properties[C.name],M=Hi(C,x,m,p,T);c.overrideBypass(r,E,M)}r.emit("style")}}return o.progress=m,m}function Aa(r,e){return r==null||e==null?!1:Ne(r)&&Ne(e)?!0:!!(r&&e)}function Nw(r,e,t,n){var i=e._private;i.started=!0,i.startTime=t-i.progress*i.duration}function uh(r,e){var t=e._private.aniEles,n=[];function i(c,d){var h=c._private,f=h.animation.current,v=h.animation.queue,p=!1;if(f.length===0){var m=v.shift();m&&f.push(m)}for(var g=function(P){for(var O=P.length-1;O>=0;O--){var I=P[O];I()}P.splice(0,P.length)},y=f.length-1;y>=0;y--){var b=f[y],S=b._private;if(S.stopped){f.splice(y,1),S.hooked=!1,S.playing=!1,S.started=!1,g(S.frames);continue}!S.playing&&!S.applying||(S.playing&&S.applying&&(S.applying=!1),S.started||Nw(c,b,r),Lw(c,b,r,d),S.applying&&(S.applying=!1),g(S.frames),S.step!=null&&S.step(r),b.completed()&&(f.splice(y,1),S.hooked=!1,S.playing=!1,S.started=!1,g(S.completes)),p=!0)}return!d&&f.length===0&&v.length===0&&n.push(c),p}for(var a=!1,o=0;o<t.length;o++){var s=t[o],u=i(s);a=a||u}var l=i(e,!0);(a||l)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(n),e.emit("step")}var kw={animate:ht.animate(),animation:ht.animation(),animated:ht.animated(),clearQueue:ht.clearQueue(),delay:ht.delay(),delayAnimation:ht.delayAnimation(),stop:ht.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){e._private.animationsRunning&&Fs(function(a){uh(a,e),t()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,o){uh(o,e)},n.beforeRenderPriorities.animations):t()}},Fw={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&Qa(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},xs=function(e){return We(e)?new Gn(e):e},Hf={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new nl(Fw,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,xs(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,xs(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,xs(t),n),this},once:function(e,t,n){return this.emitter().one(e,xs(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};ht.eventAliasesOn(Hf);var cu={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};cu.jpeg=cu.jpg;var Rs={layout:function(e){var t=this;if(e==null){St("Layout options must be specified to make a layout");return}if(e.name==null){St("A `name` must be specified to make a layout");return}var n=e.name,i=t.extension("layout",n);if(i==null){St("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;We(e.eles)?a=t.$(e.eles):a=e.eles!=null?e.eles:t.$();var o=new i(Ye({},e,{cy:t,eles:a}));return o}};Rs.createLayout=Rs.makeLayout=Rs.layout;var Bw={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&i.merge(t);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?t.notify(n):t.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],o=e[a],s=t.getElementById(a);s.data(o)}})}},Vw=Jt({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:12,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),du={renderTo:function(e,t,n,i){var a=this._private.renderer;return a.renderTo(e,t,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n==null){St("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&ft("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=Vw(e);i.cy=t,t._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};du.invalidateDimensions=du.resize;var Is={collection:function(e,t){return We(e)?this.$(e):Ar(e)?e.collection():gt(e)?(t||(t={}),new rr(this,e,t.unique,t.removed)):new rr(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};Is.elements=Is.filter=Is.$;var hr={},ka="t",zw="f";hr.apply=function(r){for(var e=this,t=e._private,n=t.cy,i=n.collection(),a=0;a<r.length;a++){var o=r[a],s=e.getContextMeta(o);if(!s.empty){var u=e.getContextStyle(s),l=e.applyContextStyle(s,u,o);o._private.appliedInitStyle?e.updateTransitions(o,l.diffProps):o._private.appliedInitStyle=!0;var c=e.updateStyleHints(o);c&&i.push(o)}}return i};hr.getPropertiesDiff=function(r,e){var t=this,n=t._private.propDiffs=t._private.propDiffs||{},i=r+"-"+e,a=n[i];if(a)return a;for(var o=[],s={},u=0;u<t.length;u++){var l=t[u],c=r[u]===ka,d=e[u]===ka,h=c!==d,f=l.mappedProperties.length>0;if(h||d&&f){var v=void 0;h&&f||h?v=l.properties:f&&(v=l.mappedProperties);for(var p=0;p<v.length;p++){for(var m=v[p],g=m.name,y=!1,b=u+1;b<t.length;b++){var S=t[b],A=e[b]===ka;if(A&&(y=S.properties[m.name]!=null,y))break}!s[g]&&!y&&(s[g]=!0,o.push(g))}}}return n[i]=o,o};hr.getContextMeta=function(r){for(var e=this,t="",n,i=r._private.styleCxtKey||"",a=0;a<e.length;a++){var o=e[a],s=o.selector&&o.selector.matches(r);s?t+=ka:t+=zw}return n=e.getPropertiesDiff(i,t),r._private.styleCxtKey=t,{key:t,diffPropNames:n,empty:n.length===0}};hr.getContextStyle=function(r){var e=r.key,t=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<t.length;a++){var o=t[a],s=e[a]===ka;if(s)for(var u=0;u<o.properties.length;u++){var l=o.properties[u];i[l.name]=l}}return n[e]=i,i};hr.applyContextStyle=function(r,e,t){for(var n=this,i=r.diffPropNames,a={},o=n.types,s=0;s<i.length;s++){var u=i[s],l=e[u],c=t.pstyle(u);if(!l)if(c)c.bypass?l={name:u,deleteBypassed:!0}:l={name:u,delete:!0};else continue;if(c!==l){if(l.mapped===o.fn&&c!=null&&c.mapping!=null&&c.mapping.value===l.value){var d=c.mapping,h=d.fnValue=l.value(t);if(h===d.prevFnValue)continue}var f=a[u]={prev:c};n.applyParsedProperty(t,l),f.next=t.pstyle(u),f.next&&f.next.bypass&&(f.next=f.next.bypassed)}}return{diffProps:a}};hr.updateStyleHints=function(r){var e=r._private,t=this,n=t.propertyGroupNames,i=t.propertyGroupKeys,a=function(G,W,te){return t.getPropertiesHash(G,W,te)},o=e.styleKey;if(r.removed())return!1;var s=e.group==="nodes",u=r._private.style;n=Object.keys(u);for(var l=0;l<i.length;l++){var c=i[l];e.styleKeys[c]=[Wi,Ra]}for(var d=function(G,W){return e.styleKeys[W][0]=Ga(G,e.styleKeys[W][0])},h=function(G,W){return e.styleKeys[W][1]=ja(G,e.styleKeys[W][1])},f=function(G,W){d(G,W),h(G,W)},v=function(G,W){for(var te=0;te<G.length;te++){var X=G.charCodeAt(te);d(X,W),h(X,W)}},p=2e9,m=function(G){return-128<G&&G<128&&Math.floor(G)!==G?p-(G*1024|0):G},g=0;g<n.length;g++){var y=n[g],b=u[y];if(b!=null){var S=this.properties[y],A=S.type,P=S.groupKey,O=void 0;S.hashOverride!=null?O=S.hashOverride(r,b):b.pfValue!=null&&(O=b.pfValue);var I=S.enums==null?b.value:null,R=O!=null,L=I!=null,B=R||L,w=b.units;if(A.number&&B&&!A.multiple){var _=R?O:I;f(m(_),P),!R&&w!=null&&v(w,P)}else v(b.strValue,P)}}for(var E=[Wi,Ra],x=0;x<i.length;x++){var C=i[x],T=e.styleKeys[C];E[0]=Ga(T[0],E[0]),E[1]=ja(T[1],E[1])}e.styleKey=$m(E[0],E[1]);var M=e.styleKeys;e.labelDimsKey=Rn(M.labelDimensions);var D=a(r,["label"],M.labelDimensions);if(e.labelKey=Rn(D),e.labelStyleKey=Rn(fs(M.commonLabel,D)),!s){var F=a(r,["source-label"],M.labelDimensions);e.sourceLabelKey=Rn(F),e.sourceLabelStyleKey=Rn(fs(M.commonLabel,F));var N=a(r,["target-label"],M.labelDimensions);e.targetLabelKey=Rn(N),e.targetLabelStyleKey=Rn(fs(M.commonLabel,N))}if(s){var z=e.styleKeys,q=z.nodeBody,$=z.nodeBorder,ee=z.nodeOutline,J=z.backgroundImage,j=z.compound,Z=z.pie,H=[q,$,ee,J,j,Z].filter(function(k){return k!=null}).reduce(fs,[Wi,Ra]);e.nodeKey=Rn(H),e.hasPie=Z!=null&&Z[0]!==Wi&&Z[1]!==Ra}return o!==e.styleKey};hr.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null};hr.applyParsedProperty=function(r,e){var t=this,n=e,i=r._private.style,a,o=t.types,s=t.properties[n.name].type,u=n.bypass,l=i[n.name],c=l&&l.bypass,d=r._private,h="mapping",f=function(q){return q==null?null:q.pfValue!=null?q.pfValue:q.value},v=function(){var q=f(l),$=f(n);t.checkTriggers(r,n.name,q,$)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(n=e=this.parse(e.name,"bezier",u)),n.delete)return i[n.name]=void 0,v(),!0;if(n.deleteBypassed)return l?l.bypass?(l.bypassed=void 0,v(),!0):!1:(v(),!0);if(n.deleteBypass)return l?l.bypass?(i[n.name]=l.bypassed,v(),!0):!1:(v(),!0);var p=function(){ft("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case o.mapData:{for(var m=n.field.split("."),g=d.data,y=0;y<m.length&&g;y++){var b=m[y];g=g[b]}if(g==null)return p(),!1;var S;if(Ne(g)){var A=n.fieldMax-n.fieldMin;A===0?S=0:S=(g-n.fieldMin)/A}else return ft("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+g+"` for `"+r.id()+"` is non-numeric)"),!1;if(S<0?S=0:S>1&&(S=1),s.color){var P=n.valueMin[0],O=n.valueMax[0],I=n.valueMin[1],R=n.valueMax[1],L=n.valueMin[2],B=n.valueMax[2],w=n.valueMin[3]==null?1:n.valueMin[3],_=n.valueMax[3]==null?1:n.valueMax[3],E=[Math.round(P+(O-P)*S),Math.round(I+(R-I)*S),Math.round(L+(B-L)*S),Math.round(w+(_-w)*S)];a={bypass:n.bypass,name:n.name,value:E,strValue:"rgb("+E[0]+", "+E[1]+", "+E[2]+")"}}else if(s.number){var x=n.valueMin+(n.valueMax-n.valueMin)*S;a=this.parse(n.name,x,n.bypass,h)}else return!1;if(!a)return p(),!1;a.mapping=n,n=a;break}case o.data:{for(var C=n.field.split("."),T=d.data,M=0;M<C.length&&T;M++){var D=C[M];T=T[D]}if(T!=null&&(a=this.parse(n.name,T,n.bypass,h)),!a)return p(),!1;a.mapping=n,n=a;break}case o.fn:{var F=n.value,N=n.fnValue!=null?n.fnValue:F(r);if(n.prevFnValue=N,N==null)return ft("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+r.id()+"` is null)"),!1;if(a=this.parse(n.name,N,n.bypass,h),!a)return ft("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+r.id()+"` is invalid)"),!1;a.mapping=en(n),n=a;break}case void 0:break;default:return!1}return u?(c?n.bypassed=l.bypassed:n.bypassed=l,i[n.name]=n):c?l.bypassed=n:i[n.name]=n,v(),!0};hr.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),o=0;o<a.length;o++){var s=a[o],u=i[s];u!=null&&(u.bypass?u.bypassed=null:i[s]=null)}}};hr.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};hr.updateTransitions=function(r,e){var t=this,n=r._private,i=r.pstyle("transition-property").value,a=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var s={},u=!1,l=0;l<i.length;l++){var c=i[l],d=r.pstyle(c),h=e[c];if(h){var f=h.prev,v=f,p=h.next!=null?h.next:d,m=!1,g=void 0,y=1e-6;v&&(Ne(v.pfValue)&&Ne(p.pfValue)?(m=p.pfValue-v.pfValue,g=v.pfValue+y*m):Ne(v.value)&&Ne(p.value)?(m=p.value-v.value,g=v.value+y*m):gt(v.value)&&gt(p.value)&&(m=v.value[0]!==p.value[0]||v.value[1]!==p.value[1]||v.value[2]!==p.value[2],g=v.strValue),m&&(s[c]=p.strValue,this.applyBypass(r,c,g),u=!0))}}if(!u)return;n.transitioning=!0,new ia(function(b){o>0?r.delayAnimation(o).play().promise().then(b):b()}).then(function(){return r.animation({style:s,duration:a,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1)};hr.checkTrigger=function(r,e,t,n,i,a){var o=this.properties[e],s=i(o);s!=null&&s(t,n)&&a(o)};hr.checkZOrderTrigger=function(r,e,t,n){var i=this;this.checkTrigger(r,e,t,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",r)})};hr.checkBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBounds},function(i){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),i.triggersBoundsOfParallelBeziers&&e==="curve-style"&&(t==="bezier"||n==="bezier")&&r.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()}),i.triggersBoundsOfConnectedEdges&&e==="display"&&(t==="none"||n==="none")&&r.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};hr.checkTriggers=function(r,e,t,n){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,n),this.checkBoundsTrigger(r,e,t,n)};var no={};no.applyBypass=function(r,e,t,n){var i=this,a=[],o=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var s=0;s<i.properties.length;s++){var u=i.properties[s],l=u.name,c=this.parse(l,t,!0);c&&a.push(c)}}else if(We(e)){var d=this.parse(e,t,!0);d&&a.push(d)}else if(ut(e)){var h=e;n=t;for(var f=Object.keys(h),v=0;v<f.length;v++){var p=f[v],m=h[p];if(m===void 0&&(m=h[qs(p)]),m!==void 0){var g=this.parse(p,m,!0);g&&a.push(g)}}}else return!1;if(a.length===0)return!1;for(var y=!1,b=0;b<r.length;b++){for(var S=r[b],A={},P=void 0,O=0;O<a.length;O++){var I=a[O];if(n){var R=S.pstyle(I.name);P=A[I.name]={prev:R}}y=this.applyParsedProperty(S,en(I))||y,n&&(P.next=S.pstyle(I.name))}y&&this.updateStyleHints(S),n&&this.updateTransitions(S,A,o)}return y};no.overrideBypass=function(r,e,t){e=xu(e);for(var n=0;n<r.length;n++){var i=r[n],a=i._private.style[e],o=this.properties[e].type,s=o.color,u=o.mutiple,l=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,t):(a.value=t,a.pfValue!=null&&(a.pfValue=t),s?a.strValue="rgb("+t.join(",")+")":u?a.strValue=t.join(" "):a.strValue=""+t,this.updateStyleHints(i)),this.checkTriggers(i,e,l,t)}};no.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};no.removeBypasses=function(r,e,t){for(var n=!0,i=0;i<r.length;i++){for(var a=r[i],o={},s=0;s<e.length;s++){var u=e[s],l=this.properties[u],c=a.pstyle(l.name);if(!(!c||!c.bypass)){var d="",h=this.parse(u,d,!0),f=o[l.name]={prev:c};this.applyParsedProperty(a,h),f.next=a.pstyle(l.name)}}this.updateStyleHints(a),t&&this.updateTransitions(a,o,n)}};var ku={};ku.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};ku.containerCss=function(r){var e=this._private.cy,t=e.container(),n=e.window();if(n&&t&&n.getComputedStyle)return n.getComputedStyle(t).getPropertyValue(r)};var rn={};rn.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};rn.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var n={},i=0;i<t.properties.length;i++){var a=t.properties[i],o=t.getStylePropertyValue(r,a.name,e);o!=null&&(n[a.name]=o,n[qs(a.name)]=o)}return n}};rn.getIndexedStyle=function(r,e,t,n){var i=r.pstyle(e)[t][n];return i??r.cy().style().getDefaultProperty(e)[t][0]};rn.getStylePropertyValue=function(r,e,t){var n=this;if(r=r[0],r){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,o=r.pstyle(i.name);if(o){var s=o.value,u=o.units,l=o.strValue;if(t&&a.number&&s!=null&&Ne(s)){var c=r.cy().zoom(),d=function(m){return m*c},h=function(m,g){return d(m)+g},f=gt(s),v=f?u.every(function(p){return p!=null}):u!=null;return v?f?s.map(function(p,m){return h(p,u[m])}).join(" "):h(s,u):f?s.map(function(p){return We(p)?p:""+d(p)}).join(" "):""+d(s)}else if(l!=null)return l}return null}};rn.getAnimationStartStyle=function(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],a=i.name,o=r.pstyle(a);o!==void 0&&(ut(o)?o=this.parse(a,o.strValue):o=this.parse(a,o)),o&&(t[a]=o)}return t};rn.getPropsList=function(r){var e=this,t=[],n=r,i=e.properties;if(n)for(var a=Object.keys(n),o=0;o<a.length;o++){var s=a[o],u=n[s],l=i[s]||i[xu(s)],c=this.parse(l.name,u);c&&t.push(c)}return t};rn.getNonDefaultPropertiesHash=function(r,e,t){var n=t.slice(),i,a,o,s,u,l;for(u=0;u<e.length;u++)if(i=e[u],a=r.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=Ga(s,n[0]),n[1]=ja(s,n[1]);else for(o=a.strValue,l=0;l<o.length;l++)s=o.charCodeAt(l),n[0]=Ga(s,n[0]),n[1]=ja(s,n[1]);return n};rn.getPropertiesHash=rn.getNonDefaultPropertiesHash;var ol={};ol.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var n=r[t],i=n.selector,a=n.style||n.css,o=Object.keys(a);e.selector(i);for(var s=0;s<o.length;s++){var u=o[s],l=a[u];e.css(u,l)}}return e};ol.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};ol.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],n=t.selector,i=t.properties,a={},o=0;o<i.length;o++){var s=i[o];a[s.name]=s.strValue}r.push({selector:n?n.toString():"core",style:a})}return r};var Fu={};Fu.appendFromString=function(r){var e=this,t=this,n=""+r,i,a,o;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){n.length>i.length?n=n.substr(i.length):n=""}function u(){a.length>o.length?a=a.substr(o.length):a=""}for(;;){var l=n.match(/^\s*$/);if(l)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){ft("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var d=c[1];if(d!=="core"){var h=new Gn(d);if(h.invalid){ft("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),s();continue}}var f=c[2],v=!1;a=f;for(var p=[];;){var m=a.match(/^\s*$/);if(m)break;var g=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!g){ft("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+f),v=!0;break}o=g[0];var y=g[1],b=g[2],S=e.properties[y];if(!S){ft("Skipping property: Invalid property name in: "+o),u();continue}var A=t.parse(y,b);if(!A){ft("Skipping property: Invalid property definition in: "+o),u();continue}p.push({name:y,val:b}),u()}if(v){s();break}t.selector(d);for(var P=0;P<p.length;P++){var O=p[P];t.css(O.name,O.val)}s()}return t};Fu.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var er={};(function(){var r=zt,e=Xg,t=Zg,n=Qg,i=Jg,a=function(H){return"^"+H+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(H){var k=r+"|\\w+|"+e+"|"+t+"|"+n+"|"+i;return"^"+H+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+k+")\\s*\\,\\s*("+k+")\\)$"},s=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];er.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:s,singleRegexMatchValue:!0},urls:{regexes:s,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(H,k){switch(H.length){case 2:return k[0]!=="deg"&&k[0]!=="rad"&&k[1]!=="deg"&&k[1]!=="rad";case 1:return We(H[0])||k[0]==="deg"||k[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(H){var k=H.length;return k===1||k===2||k===4}}};var u={zeroNonZero:function(H,k){return(H==null||k==null)&&H!==k||H==0&&k!=0?!0:H!=0&&k==0},any:function(H,k){return H!=k},emptyNonEmpty:function(H,k){var G=Bn(H),W=Bn(k);return G&&!W||!G&&W}},l=er.types,c=[{name:"label",type:l.text,triggersBounds:u.any,triggersZOrder:u.emptyNonEmpty},{name:"text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any}],d=[{name:"source-label",type:l.text,triggersBounds:u.any},{name:"source-text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"source-text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"source-text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"source-text-offset",type:l.size,triggersBounds:u.any}],h=[{name:"target-label",type:l.text,triggersBounds:u.any},{name:"target-text-rotation",type:l.textRotation,triggersBounds:u.any},{name:"target-text-margin-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"target-text-margin-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"target-text-offset",type:l.size,triggersBounds:u.any}],f=[{name:"font-family",type:l.fontFamily,triggersBounds:u.any},{name:"font-style",type:l.fontStyle,triggersBounds:u.any},{name:"font-weight",type:l.fontWeight,triggersBounds:u.any},{name:"font-size",type:l.size,triggersBounds:u.any},{name:"text-transform",type:l.textTransform,triggersBounds:u.any},{name:"text-wrap",type:l.textWrap,triggersBounds:u.any},{name:"text-overflow-wrap",type:l.textOverflowWrap,triggersBounds:u.any},{name:"text-max-width",type:l.size,triggersBounds:u.any},{name:"text-outline-width",type:l.size,triggersBounds:u.any},{name:"line-height",type:l.positiveNumber,triggersBounds:u.any}],v=[{name:"text-valign",type:l.valign,triggersBounds:u.any},{name:"text-halign",type:l.halign,triggersBounds:u.any},{name:"color",type:l.color},{name:"text-outline-color",type:l.color},{name:"text-outline-opacity",type:l.zeroOneNumber},{name:"text-background-color",type:l.color},{name:"text-background-opacity",type:l.zeroOneNumber},{name:"text-background-padding",type:l.size,triggersBounds:u.any},{name:"text-border-opacity",type:l.zeroOneNumber},{name:"text-border-color",type:l.color},{name:"text-border-width",type:l.size,triggersBounds:u.any},{name:"text-border-style",type:l.borderStyle,triggersBounds:u.any},{name:"text-background-shape",type:l.textBackgroundShape,triggersBounds:u.any},{name:"text-justification",type:l.justification}],p=[{name:"events",type:l.bool,triggersZOrder:u.any},{name:"text-events",type:l.bool,triggersZOrder:u.any}],m=[{name:"display",type:l.display,triggersZOrder:u.any,triggersBounds:u.any,triggersBoundsOfConnectedEdges:!0},{name:"visibility",type:l.visibility,triggersZOrder:u.any},{name:"opacity",type:l.zeroOneNumber,triggersZOrder:u.zeroNonZero},{name:"text-opacity",type:l.zeroOneNumber},{name:"min-zoomed-font-size",type:l.size},{name:"z-compound-depth",type:l.zCompoundDepth,triggersZOrder:u.any},{name:"z-index-compare",type:l.zIndexCompare,triggersZOrder:u.any},{name:"z-index",type:l.number,triggersZOrder:u.any}],g=[{name:"overlay-padding",type:l.size,triggersBounds:u.any},{name:"overlay-color",type:l.color},{name:"overlay-opacity",type:l.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"overlay-shape",type:l.overlayShape,triggersBounds:u.any},{name:"overlay-corner-radius",type:l.cornerRadius}],y=[{name:"underlay-padding",type:l.size,triggersBounds:u.any},{name:"underlay-color",type:l.color},{name:"underlay-opacity",type:l.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"underlay-shape",type:l.overlayShape,triggersBounds:u.any},{name:"underlay-corner-radius",type:l.cornerRadius}],b=[{name:"transition-property",type:l.propList},{name:"transition-duration",type:l.time},{name:"transition-delay",type:l.time},{name:"transition-timing-function",type:l.easing}],S=function(H,k){return k.value==="label"?-H.poolIndex():k.pfValue},A=[{name:"height",type:l.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"width",type:l.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"shape",type:l.nodeShape,triggersBounds:u.any},{name:"shape-polygon-points",type:l.polygonPointList,triggersBounds:u.any},{name:"corner-radius",type:l.cornerRadius},{name:"background-color",type:l.color},{name:"background-fill",type:l.fill},{name:"background-opacity",type:l.zeroOneNumber},{name:"background-blacken",type:l.nOneOneNumber},{name:"background-gradient-stop-colors",type:l.colors},{name:"background-gradient-stop-positions",type:l.percentages},{name:"background-gradient-direction",type:l.gradientDirection},{name:"padding",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"padding-relative-to",type:l.paddingRelativeTo,triggersBounds:u.any},{name:"bounds-expansion",type:l.boundsExpansion,triggersBounds:u.any}],P=[{name:"border-color",type:l.color},{name:"border-opacity",type:l.zeroOneNumber},{name:"border-width",type:l.size,triggersBounds:u.any},{name:"border-style",type:l.borderStyle},{name:"border-cap",type:l.lineCap},{name:"border-join",type:l.lineJoin},{name:"border-dash-pattern",type:l.numbers},{name:"border-dash-offset",type:l.number},{name:"border-position",type:l.linePosition}],O=[{name:"outline-color",type:l.color},{name:"outline-opacity",type:l.zeroOneNumber},{name:"outline-width",type:l.size,triggersBounds:u.any},{name:"outline-style",type:l.borderStyle},{name:"outline-offset",type:l.size,triggersBounds:u.any}],I=[{name:"background-image",type:l.urls},{name:"background-image-crossorigin",type:l.bgCrossOrigin},{name:"background-image-opacity",type:l.zeroOneNumbers},{name:"background-image-containment",type:l.bgContainment},{name:"background-image-smoothing",type:l.bools},{name:"background-position-x",type:l.bgPos},{name:"background-position-y",type:l.bgPos},{name:"background-width-relative-to",type:l.bgRelativeTo},{name:"background-height-relative-to",type:l.bgRelativeTo},{name:"background-repeat",type:l.bgRepeat},{name:"background-fit",type:l.bgFit},{name:"background-clip",type:l.bgClip},{name:"background-width",type:l.bgWH},{name:"background-height",type:l.bgWH},{name:"background-offset-x",type:l.bgPos},{name:"background-offset-y",type:l.bgPos}],R=[{name:"position",type:l.position,triggersBounds:u.any},{name:"compound-sizing-wrt-labels",type:l.compoundIncludeLabels,triggersBounds:u.any},{name:"min-width",type:l.size,triggersBounds:u.any},{name:"min-width-bias-left",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-width-bias-right",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-height",type:l.size,triggersBounds:u.any},{name:"min-height-bias-top",type:l.sizeMaybePercent,triggersBounds:u.any},{name:"min-height-bias-bottom",type:l.sizeMaybePercent,triggersBounds:u.any}],L=[{name:"line-style",type:l.lineStyle},{name:"line-color",type:l.color},{name:"line-fill",type:l.fill},{name:"line-cap",type:l.lineCap},{name:"line-opacity",type:l.zeroOneNumber},{name:"line-dash-pattern",type:l.numbers},{name:"line-dash-offset",type:l.number},{name:"line-outline-width",type:l.size},{name:"line-outline-color",type:l.color},{name:"line-gradient-stop-colors",type:l.colors},{name:"line-gradient-stop-positions",type:l.percentages},{name:"curve-style",type:l.curveStyle,triggersBounds:u.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:l.zeroOneNumber,triggersBounds:u.any},{name:"source-endpoint",type:l.edgeEndpoint,triggersBounds:u.any},{name:"target-endpoint",type:l.edgeEndpoint,triggersBounds:u.any},{name:"control-point-step-size",type:l.size,triggersBounds:u.any},{name:"control-point-distances",type:l.bidirectionalSizes,triggersBounds:u.any},{name:"control-point-weights",type:l.numbers,triggersBounds:u.any},{name:"segment-distances",type:l.bidirectionalSizes,triggersBounds:u.any},{name:"segment-weights",type:l.numbers,triggersBounds:u.any},{name:"segment-radii",type:l.numbers,triggersBounds:u.any},{name:"radius-type",type:l.radiusType,triggersBounds:u.any},{name:"taxi-turn",type:l.bidirectionalSizeMaybePercent,triggersBounds:u.any},{name:"taxi-turn-min-distance",type:l.size,triggersBounds:u.any},{name:"taxi-direction",type:l.axisDirection,triggersBounds:u.any},{name:"taxi-radius",type:l.number,triggersBounds:u.any},{name:"edge-distances",type:l.edgeDistances,triggersBounds:u.any},{name:"arrow-scale",type:l.positiveNumber,triggersBounds:u.any},{name:"loop-direction",type:l.angle,triggersBounds:u.any},{name:"loop-sweep",type:l.angle,triggersBounds:u.any},{name:"source-distance-from-node",type:l.size,triggersBounds:u.any},{name:"target-distance-from-node",type:l.size,triggersBounds:u.any}],B=[{name:"ghost",type:l.bool,triggersBounds:u.any},{name:"ghost-offset-x",type:l.bidirectionalSize,triggersBounds:u.any},{name:"ghost-offset-y",type:l.bidirectionalSize,triggersBounds:u.any},{name:"ghost-opacity",type:l.zeroOneNumber}],w=[{name:"selection-box-color",type:l.color},{name:"selection-box-opacity",type:l.zeroOneNumber},{name:"selection-box-border-color",type:l.color},{name:"selection-box-border-width",type:l.size},{name:"active-bg-color",type:l.color},{name:"active-bg-opacity",type:l.zeroOneNumber},{name:"active-bg-size",type:l.size},{name:"outside-texture-bg-color",type:l.color},{name:"outside-texture-bg-opacity",type:l.zeroOneNumber}],_=[];er.pieBackgroundN=16,_.push({name:"pie-size",type:l.sizeMaybePercent});for(var E=1;E<=er.pieBackgroundN;E++)_.push({name:"pie-"+E+"-background-color",type:l.color}),_.push({name:"pie-"+E+"-background-size",type:l.percent}),_.push({name:"pie-"+E+"-background-opacity",type:l.zeroOneNumber});var x=[],C=er.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:l.arrowShape,triggersBounds:u.any},{name:"arrow-color",type:l.color},{name:"arrow-fill",type:l.arrowFill},{name:"arrow-width",type:l.arrowWidth}].forEach(function(Z){C.forEach(function(H){var k=H+"-"+Z.name,G=Z.type,W=Z.triggersBounds;x.push({name:k,type:G,triggersBounds:W})})},{});var T=er.properties=[].concat(p,b,m,g,y,B,v,f,c,d,h,A,P,O,I,_,R,L,x,w),M=er.propertyGroups={behavior:p,transition:b,visibility:m,overlay:g,underlay:y,ghost:B,commonLabel:v,labelDimensions:f,mainLabel:c,sourceLabel:d,targetLabel:h,nodeBody:A,nodeBorder:P,nodeOutline:O,backgroundImage:I,pie:_,compound:R,edgeLine:L,edgeArrow:x,core:w},D=er.propertyGroupNames={},F=er.propertyGroupKeys=Object.keys(M);F.forEach(function(Z){D[Z]=M[Z].map(function(H){return H.name}),M[Z].forEach(function(H){return H.groupKey=Z})});var N=er.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];er.propertyNames=T.map(function(Z){return Z.name});for(var z=0;z<T.length;z++){var q=T[z];T[q.name]=q}for(var $=0;$<N.length;$++){var ee=N[$],J=T[ee.pointsTo],j={name:ee.name,alias:!0,pointsTo:J};T.push(j),T[ee.name]=j}})();er.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};er.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Ye({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(u,l){for(var c=1;c<=er.pieBackgroundN;c++){var d=l.name.replace("{{i}}",c),h=l.value;u[d]=h}return u},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(u,l){return er.arrowPrefixes.forEach(function(c){var d=c+"-"+l.name,h=l.value;u[d]=h}),u},{})),t={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,o=e[a],s=this.parse(a,o);t[a]=s}}return r.defaultProperties=t,r.defaultProperties};er.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var sl={};sl.parse=function(r,e,t,n){var i=this;if(Mt(e))return i.parseImplWarn(r,e,t,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,o=t?"t":"f",s=""+e,u=Zh(r,s,o,a),l=i.propCache=i.propCache||[],c;return(c=l[u])||(c=l[u]=i.parseImplWarn(r,e,t,n)),(t||n==="mapping")&&(c=en(c),c&&(c.value=en(c.value))),c};sl.parseImplWarn=function(r,e,t,n){var i=this.parseImpl(r,e,t,n);return!i&&e!=null&&ft("The style property `".concat(r,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&ft("The style value of `label` is deprecated for `"+i.name+"`"),i};sl.parseImpl=function(r,e,t,n){var i=this;r=xu(r);var a=i.properties[r],o=e,s=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,r=a.name);var u=We(e);u&&(e=e.trim());var l=a.type;if(!l)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(Mt(e))return{name:r,value:e,strValue:"fn",mapped:s.fn,bypass:t};var c,d;if(!(!u||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(s.data.regex).exec(e))){if(t)return!1;var h=s.data;return{name:r,value:c,strValue:""+e,mapped:h,field:c[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(s.mapData.regex).exec(e))){if(t||l.multiple)return!1;var f=s.mapData;if(!(l.color||l.number))return!1;var v=this.parse(r,d[4]);if(!v||v.mapped)return!1;var p=this.parse(r,d[5]);if(!p||p.mapped)return!1;if(v.pfValue===p.pfValue||v.strValue===p.strValue)return ft("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+v.strValue+"`"),this.parse(r,v.strValue);if(l.color){var m=v.value,g=p.value,y=m[0]===g[0]&&m[1]===g[1]&&m[2]===g[2]&&(m[3]===g[3]||(m[3]==null||m[3]===1)&&(g[3]==null||g[3]===1));if(y)return!1}return{name:r,value:d,strValue:""+e,mapped:f,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:v.value,valueMax:p.value,bypass:t}}}if(l.multiple&&n!=="multiple"){var b;if(u?b=e.split(/\s+/):gt(e)?b=e:b=[e],l.evenMultiple&&b.length%2!==0)return null;for(var S=[],A=[],P=[],O="",I=!1,R=0;R<b.length;R++){var L=i.parse(r,b[R],t,"multiple");I=I||We(L.value),S.push(L.value),P.push(L.pfValue!=null?L.pfValue:L.value),A.push(L.units),O+=(R>0?" ":"")+L.strValue}return l.validate&&!l.validate(S,A)?null:l.singleEnum&&I?S.length===1&&We(S[0])?{name:r,value:S[0],strValue:S[0],bypass:t}:null:{name:r,value:S,pfValue:P,strValue:O,bypass:t,units:A}}var B=function(){for(var H=0;H<l.enums.length;H++){var k=l.enums[H];if(k===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(l.number){var w,_="px";if(l.units&&(w=l.units),l.implicitUnits&&(_=l.implicitUnits),!l.unitless)if(u){var E="px|em"+(l.allowPercent?"|\\%":"");w&&(E=w);var x=e.match("^("+zt+")("+E+")?$");x&&(e=x[1],w=x[2]||_)}else(!w||l.implicitUnits)&&(w=_);if(e=parseFloat(e),isNaN(e)&&l.enums===void 0)return null;if(isNaN(e)&&l.enums!==void 0)return e=o,B();if(l.integer&&!jg(e)||l.min!==void 0&&(e<l.min||l.strictMin&&e===l.min)||l.max!==void 0&&(e>l.max||l.strictMax&&e===l.max))return null;var C={name:r,value:e,strValue:""+e+(w||""),units:w,bypass:t};return l.unitless||w!=="px"&&w!=="em"?C.pfValue=e:C.pfValue=w==="px"||!w?e:this.getEmSizeInPixels()*e,(w==="ms"||w==="s")&&(C.pfValue=w==="ms"?e:1e3*e),(w==="deg"||w==="rad")&&(C.pfValue=w==="rad"?e:b0(e)),w==="%"&&(C.pfValue=e/100),C}else if(l.propList){var T=[],M=""+e;if(M!=="none"){for(var D=M.split(/\s*,\s*|\s+/),F=0;F<D.length;F++){var N=D[F].trim();i.properties[N]?T.push(N):ft("`"+N+"` is not a valid property name")}if(T.length===0)return null}return{name:r,value:T,strValue:T.length===0?"none":T.join(" "),bypass:t}}else if(l.color){var z=Hh(e);return z?{name:r,value:z,pfValue:z,strValue:"rgb("+z[0]+","+z[1]+","+z[2]+")",bypass:t}:null}else if(l.regex||l.regexes){if(l.enums){var q=B();if(q)return q}for(var $=l.regexes?l.regexes:[l.regex],ee=0;ee<$.length;ee++){var J=new RegExp($[ee]),j=J.exec(e);if(j)return{name:r,value:l.singleRegexMatchValue?j[1]:j,strValue:""+e,bypass:t}}return null}else return l.string?{name:r,value:""+e,strValue:""+e,bypass:t}:l.enums?B():null};var ur=function r(e){if(!(this instanceof r))return new r(e);if(!bu(e)){St("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},dr=ur.prototype;dr.instanceString=function(){return"style"};dr.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};dr.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};dr.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};dr.selector=function(r){var e=r==="core"?null:new Gn(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};dr.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],n=0;n<r.properties.length;n++){var i=r.properties[n],a=t[i.name];a===void 0&&(a=t[qs(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};dr.style=dr.css;dr.cssRule=function(r,e){var t=this.parse(r,e);if(t){var n=this.length-1;this[n].properties.push(t),this[n].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.mapped&&this[n].mappedProperties.push(t);var i=!this[n].selector;i&&(this._private.coreStyle[t.name]=t)}return this};dr.append=function(r){return zh(r)?r.appendToStyle(this):gt(r)?this.appendFromJson(r):We(r)&&this.appendFromString(r),this};ur.fromJson=function(r,e){var t=new ur(r);return t.fromJson(e),t};ur.fromString=function(r,e){return new ur(r).fromString(e)};[hr,no,ku,rn,ol,Fu,er,sl].forEach(function(r){Ye(dr,r)});ur.types=dr.types;ur.properties=dr.properties;ur.propertyGroups=dr.propertyGroups;ur.propertyGroupNames=dr.propertyGroupNames;ur.propertyGroupKeys=dr.propertyGroupKeys;var Gw={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return zh(e)?t.style=e.generateStyle(this):gt(e)?t.style=ur.fromJson(this,e):We(e)?t.style=ur.fromString(this,e):t.style=ur(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},jw="single",ci={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=jw),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,n,i,a,o,s;switch(e.length){case 0:return t;case 1:if(We(e[0]))return n=e[0],t[n];if(ut(e[0])){if(!this._private.panningEnabled)return this;a=e[0],o=a.x,s=a.y,Ne(o)&&(t.x=o),Ne(s)&&(t.y=s),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Ne(i)&&(t[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var n=arguments,i=this._private.pan,a,o,s,u,l;if(!this._private.panningEnabled)return this;switch(n.length){case 1:ut(e)&&(s=n[0],u=s.x,l=s.y,Ne(u)&&(i.x+=u),Ne(l)&&(i.y+=l),this.emit("pan viewport"));break;case 2:a=e,o=t,(a==="x"||a==="y")&&Ne(o)&&(i[a]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(Ne(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(We(e)){var i=e;e=this.$(i)}else if($g(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Ar(e)||(e=this.mutableElements());if(!(Ar(e)&&e.empty())){n=n||e.boundingBox();var o=this.width(),s=this.height(),u;if(t=Ne(t)?t:0,!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){u=Math.min((o-2*t)/n.w,(s-2*t)/n.h),u=u>this._private.maxZoom?this._private.maxZoom:u,u=u<this._private.minZoom?this._private.minZoom:u;var l={x:(o-u*(n.x1+n.x2))/2,y:(s-u*(n.y1+n.y2))/2};return{zoom:u,pan:l}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var i=e;e=i.min,t=i.max}return Ne(e)&&Ne(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):Ne(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:Ne(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,n=t.pan,i=t.zoom,a,o,s=!1;if(t.zoomingEnabled||(s=!0),Ne(e)?o=e:ut(e)&&(o=e.level,e.position!=null?a=Zs(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!t.panningEnabled&&(s=!0)),o=o>t.maxZoom?t.maxZoom:o,o=o<t.minZoom?t.minZoom:o,s||!Ne(o)||o===i||a!=null&&(!Ne(a.x)||!Ne(a.y)))return null;if(a!=null){var u=n,l=i,c=o,d={x:-c/l*(a.x-u.x)+a.x,y:-c/l*(a.y-u.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:d}}else return{zoomed:!0,panned:!1,zoom:o,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t==null||!t.zoomed?this:(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,n=!0,i=!0,a=[],o=!1,s=!1;if(!e)return this;if(Ne(e.zoom)||(n=!1),ut(e.pan)||(i=!1),!n&&!i)return this;if(n){var u=e.zoom;u<t.minZoom||u>t.maxZoom||!t.zoomingEnabled?o=!0:(t.zoom=u,a.push("zoom"))}if(i&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var l=e.pan;Ne(l.x)&&(t.pan.x=l.x,s=!1),Ne(l.y)&&(t.pan.y=l.y,s=!1),s||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(We(e)){var n=e;e=this.mutableElements().filter(n)}else Ar(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(a-t*(i.x1+i.x2))/2,y:(o-t*(i.y1+i.y2))/2};return s}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container,n=this;return e.sizeCache=e.sizeCache||(t?function(){var i=n.window().getComputedStyle(t),a=function(s){return parseFloat(i.getPropertyValue(s))};return{width:t.clientWidth-a("padding-left")-a("padding-right"),height:t.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};ci.centre=ci.center;ci.autolockNodes=ci.autolock;ci.autoungrabifyNodes=ci.autoungrabify;var Xa={data:ht.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:ht.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:ht.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:ht.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Xa.attr=Xa.data;Xa.removeAttr=Xa.removeData;var Ka=function(e){var t=this;e=Ye({},e);var n=e.container;n&&!ks(n)&&ks(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=t;var o=Vt!==void 0&&n!==void 0&&!e.headless,s=e;s.layout=Ye({name:o?"grid":"null"},s.layout),s.renderer=Ye({name:o?"canvas":"null"},s.renderer);var u=function(v,p,m){return p!==void 0?p:m!==void 0?m:v},l=this._private={container:n,ready:!1,options:s,elements:new rr(this),listeners:[],aniEles:new rr(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,s.zoomingEnabled),userZoomingEnabled:u(!0,s.userZoomingEnabled),panningEnabled:u(!0,s.panningEnabled),userPanningEnabled:u(!0,s.userPanningEnabled),boxSelectionEnabled:u(!0,s.boxSelectionEnabled),autolock:u(!1,s.autolock,s.autolockNodes),autoungrabify:u(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:u(!1,s.autounselectify),styleEnabled:s.styleEnabled===void 0?o:s.styleEnabled,zoom:Ne(s.zoom)?s.zoom:1,pan:{x:ut(s.pan)&&Ne(s.pan.x)?s.pan.x:0,y:ut(s.pan)&&Ne(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:u(250,s.multiClickDebounceTime)};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});var c=function(v,p){var m=v.some(Wg);if(m)return ia.all(v).then(p);p(v)};l.styleEnabled&&t.setStyle([]);var d=Ye({},s,s.renderer);t.initRenderer(d);var h=function(v,p,m){t.notifications(!1);var g=t.mutableElements();g.length>0&&g.remove(),v!=null&&(ut(v)||gt(v))&&t.add(v),t.one("layoutready",function(b){t.notifications(!0),t.emit(b),t.one("load",p),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",m),t.emit("done")});var y=Ye({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};c([s.style,s.elements],function(f){var v=f[0],p=f[1];l.styleEnabled&&t.style().append(v),h(p,function(){t.startAnimationLoop(),l.ready=!0,Mt(s.ready)&&t.on("ready",s.ready);for(var m=0;m<a.length;m++){var g=a[m];t.on("ready",g)}i&&(i.readies=[]),t.emit("ready")},s.done)})},Hs=Ka.prototype;Ye(Hs,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Vt;var t=this._private.container.ownerDocument;return t===void 0||t==null?Vt:t.defaultView||Vt},mount:function(e){if(e!=null){var t=this,n=t._private,i=n.options;return!ks(e)&&ks(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(Ye({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),t.startAnimationLoop(),t.style(i.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return en(this._private.options)},json:function(e){var t=this,n=t._private,i=t.mutableElements(),a=function(S){return t.getElementById(S.id())};if(ut(e)){if(t.startBatch(),e.elements){var o={},s=function(S,A){for(var P=[],O=[],I=0;I<S.length;I++){var R=S[I];if(!R.data.id){ft("cy.json() cannot handle elements without an ID attribute");continue}var L=""+R.data.id,B=t.getElementById(L);o[L]=!0,B.length!==0?O.push({ele:B,json:R}):(A&&(R.group=A),P.push(R))}t.add(P);for(var w=0;w<O.length;w++){var _=O[w],E=_.ele,x=_.json;E.json(x)}};if(gt(e.elements))s(e.elements);else for(var u=["nodes","edges"],l=0;l<u.length;l++){var c=u[l],d=e.elements[c];gt(d)&&s(d,c)}var h=t.collection();i.filter(function(b){return!o[b.id()]}).forEach(function(b){b.isParent()?h.merge(b):b.remove()}),h.forEach(function(b){return b.children().move({parent:null})}),h.forEach(function(b){return a(b).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var f=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<f.length;v++){var p=f[v];e[p]!=null&&t[p](e[p])}return t.endBatch(),this}else{var m=!!e,g={};m?g.elements=this.elements().map(function(b){return b.json()}):(g.elements={},i.forEach(function(b){var S=b.group();g.elements[S]||(g.elements[S]=[]),g.elements[S].push(b.json())})),this._private.styleEnabled&&(g.style=t.style().json()),g.data=en(t.data());var y=n.options;return g.zoomingEnabled=n.zoomingEnabled,g.userZoomingEnabled=n.userZoomingEnabled,g.zoom=n.zoom,g.minZoom=n.minZoom,g.maxZoom=n.maxZoom,g.panningEnabled=n.panningEnabled,g.userPanningEnabled=n.userPanningEnabled,g.pan=en(n.pan),g.boxSelectionEnabled=n.boxSelectionEnabled,g.renderer=en(y.renderer),g.hideEdgesOnViewport=y.hideEdgesOnViewport,g.textureOnViewport=y.textureOnViewport,g.wheelSensitivity=y.wheelSensitivity,g.motionBlur=y.motionBlur,g.multiClickDebounceTime=y.multiClickDebounceTime,g}}});Hs.$id=Hs.getElementById;[Ow,kw,Hf,cu,Rs,Bw,du,Is,Gw,ci,Xa].forEach(function(r){Ye(Hs,r)});var Hw={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Uw={maximal:!1,acyclic:!1},Ui=function(e){return e.scratch("breadthfirst")},ch=function(e,t){return e.scratch("breadthfirst",t)};function Uf(r){this.options=Ye({},Hw,Uw,r)}Uf.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=t.nodes().filter(function(ue){return ue.isChildless()}),i=t,a=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,s=!!r.boundingBox,u=e.extent(),l=Er(s?r.boundingBox:{x1:u.x1,y1:u.y1,w:u.w,h:u.h}),c;if(Ar(r.roots))c=r.roots;else if(gt(r.roots)){for(var d=[],h=0;h<r.roots.length;h++){var f=r.roots[h],v=e.getElementById(f);d.push(v)}c=e.collection(d)}else if(We(r.roots))c=e.$(r.roots);else if(a)c=n.roots();else{var p=t.components();c=e.collection();for(var m=function(de){var ye=p[de],Se=ye.maxDegree(!1),xe=ye.filter(function(Ce){return Ce.degree(!1)===Se});c=c.add(xe)},g=0;g<p.length;g++)m(g)}var y=[],b={},S=function(de,ye){y[ye]==null&&(y[ye]=[]);var Se=y[ye].length;y[ye].push(de),ch(de,{index:Se,depth:ye})},A=function(de,ye){var Se=Ui(de),xe=Se.depth,Ce=Se.index;y[xe][Ce]=null,de.isChildless()&&S(de,ye)};i.bfs({roots:c,directed:r.directed,visit:function(de,ye,Se,xe,Ce){var _e=de[0],be=_e.id();_e.isChildless()&&S(_e,Ce),b[be]=!0}});for(var P=[],O=0;O<n.length;O++){var I=n[O];b[I.id()]||P.push(I)}var R=function(de){for(var ye=y[de],Se=0;Se<ye.length;Se++){var xe=ye[Se];if(xe==null){ye.splice(Se,1),Se--;continue}ch(xe,{depth:de,index:Se})}},L=function(de,ye){for(var Se=Ui(de),xe=de.incomers().filter(function(le){return le.isNode()&&t.has(le)}),Ce=-1,_e=de.id(),be=0;be<xe.length;be++){var he=xe[be],V=Ui(he);Ce=Math.max(Ce,V.depth)}if(Se.depth<=Ce){if(!r.acyclic&&ye[_e])return null;var re=Ce+1;return A(de,re),ye[_e]=re,!0}return!1};if(a&&o){var B=[],w={},_=function(de){return B.push(de)},E=function(){return B.shift()};for(n.forEach(function(ue){return B.push(ue)});B.length>0;){var x=E(),C=L(x,w);if(C)x.outgoers().filter(function(ue){return ue.isNode()&&t.has(ue)}).forEach(_);else if(C===null){ft("Detected double maximal shift for node `"+x.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var T=0;if(r.avoidOverlap)for(var M=0;M<n.length;M++){var D=n[M],F=D.layoutDimensions(r),N=F.w,z=F.h;T=Math.max(T,N,z)}var q={},$=function(de){if(q[de.id()])return q[de.id()];for(var ye=Ui(de).depth,Se=de.neighborhood(),xe=0,Ce=0,_e=0;_e<Se.length;_e++){var be=Se[_e];if(!(be.isEdge()||be.isParent()||!n.has(be))){var he=Ui(be);if(he!=null){var V=he.index,re=he.depth;if(!(V==null||re==null)){var le=y[re].length;re<ye&&(xe+=V/le,Ce++)}}}}return Ce=Math.max(1,Ce),xe=xe/Ce,Ce===0&&(xe=0),q[de.id()]=xe,xe},ee=function(de,ye){var Se=$(de),xe=$(ye),Ce=Se-xe;return Ce===0?jh(de.id(),ye.id()):Ce};r.depthSort!==void 0&&(ee=r.depthSort);for(var J=y.length,j=0;j<J;j++)y[j].sort(ee),R(j);for(var Z=[],H=0;H<P.length;H++)Z.push(P[H]);var k=function(){for(var de=0;de<J;de++)R(de)};Z.length&&(y.unshift(Z),J=y.length,k());for(var G=0,W=0;W<J;W++)G=Math.max(y[W].length,G);var te={x:l.x1+l.w/2,y:l.y1+l.h/2},X=n.reduce(function(ue,de){return function(ye){return{w:ue.w===-1?ye.w:(ue.w+ye.w)/2,h:ue.h===-1?ye.h:(ue.h+ye.h)/2}}(de.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),me=Math.max(J===1?0:s?(l.h-r.padding*2-X.h)/(J-1):(l.h-r.padding*2-X.h)/(J+1),T),Te=y.reduce(function(ue,de){return Math.max(ue,de.length)},0),fe=function(de){var ye=Ui(de),Se=ye.depth,xe=ye.index;if(r.circle){var Ce=Math.min(l.w/2/J,l.h/2/J);Ce=Math.max(Ce,T);var _e=Ce*Se+Ce-(J>0&&y[0].length<=3?Ce/2:0),be=2*Math.PI/y[Se].length*xe;return Se===0&&y[0].length===1&&(_e=1),{x:te.x+_e*Math.cos(be),y:te.y+_e*Math.sin(be)}}else{var he=y[Se].length,V=Math.max(he===1?0:s?(l.w-r.padding*2-X.w)/((r.grid?Te:he)-1):(l.w-r.padding*2-X.w)/((r.grid?Te:he)+1),T),re={x:te.x+(xe+1-(he+1)/2)*V,y:te.y+(Se+1-(J+1)/2)*me};return re}};return t.nodes().layoutPositions(this,r,fe),this};var $w={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function $f(r){this.options=Ye({},$w,r)}$f.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var o=Er(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},u=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,l=u/Math.max(1,a.length-1),c,d=0,h=0;h<a.length;h++){var f=a[h],v=f.layoutDimensions(e),p=v.w,m=v.h;d=Math.max(d,p,m)}if(Ne(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(o.h,o.w)/2-d,a.length>1&&e.avoidOverlap){d*=1.75;var g=Math.cos(l)-Math.cos(0),y=Math.sin(l)-Math.sin(0),b=Math.sqrt(d*d/(g*g+y*y));c=Math.max(b,c)}var S=function(P,O){var I=e.startAngle+O*l*(i?1:-1),R=c*Math.cos(I),L=c*Math.sin(I),B={x:s.x+R,y:s.y+L};return B};return n.nodes().layoutPositions(this,e,S),this};var Ww={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Wf(r){this.options=Ye({},Ww,r)}Wf.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=r.cy,i=e.eles,a=i.nodes().not(":parent"),o=Er(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},u=[],l=0,c=0;c<a.length;c++){var d=a[c],h=void 0;h=e.concentric(d),u.push({value:h,node:d}),d._private.scratch.concentric=h}a.updateStyle();for(var f=0;f<a.length;f++){var v=a[f],p=v.layoutDimensions(e);l=Math.max(l,p.w,p.h)}u.sort(function(X,me){return me.value-X.value});for(var m=e.levelWidth(a),g=[[]],y=g[0],b=0;b<u.length;b++){var S=u[b];if(y.length>0){var A=Math.abs(y[0].value-S.value);A>=m&&(y=[],g.push(y))}y.push(S)}var P=l+e.minNodeSpacing;if(!e.avoidOverlap){var O=g.length>0&&g[0].length>1,I=Math.min(o.w,o.h)/2-P,R=I/(g.length+O?1:0);P=Math.min(P,R)}for(var L=0,B=0;B<g.length;B++){var w=g[B],_=e.sweep===void 0?2*Math.PI-2*Math.PI/w.length:e.sweep,E=w.dTheta=_/Math.max(1,w.length-1);if(w.length>1&&e.avoidOverlap){var x=Math.cos(E)-Math.cos(0),C=Math.sin(E)-Math.sin(0),T=Math.sqrt(P*P/(x*x+C*C));L=Math.max(T,L)}w.r=L,L+=P}if(e.equidistant){for(var M=0,D=0,F=0;F<g.length;F++){var N=g[F],z=N.r-D;M=Math.max(M,z)}D=0;for(var q=0;q<g.length;q++){var $=g[q];q===0&&(D=$.r),$.r=D,D+=M}}for(var ee={},J=0;J<g.length;J++)for(var j=g[J],Z=j.dTheta,H=j.r,k=0;k<j.length;k++){var G=j[k],W=e.startAngle+(t?1:-1)*Z*k,te={x:s.x+H*Math.cos(W),y:s.y+H*Math.sin(W)};ee[G.node.id()]=te}return i.nodes().layoutPositions(this,e,function(X){var me=X.id();return ee[me]}),this};var Kl,Yw={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function ll(r){this.options=Ye({},Yw,r),this.options.layout=this;var e=this.options.eles.nodes(),t=this.options.eles.edges(),n=t.filter(function(i){var a=i.source().data("id"),o=i.target().data("id"),s=e.some(function(l){return l.data("id")===a}),u=e.some(function(l){return l.data("id")===o});return!s||!u});this.options.eles=this.options.eles.not(n)}ll.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Kl=!0:Kl=!1;var n=qw(e,t,r);Kl&&Zw(n),r.randomize&&Qw(n);var i=hn(),a=function(){Jw(n,e,r),r.fit===!0&&e.fit(r.padding)},o=function(h){return!(t.stopped||h>=r.numIter||(eb(n,r),n.temperature=n.temperature*r.coolingFactor,n.temperature<r.minTemp))},s=function(){if(r.animate===!0||r.animate===!1)a(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var h=r.eles.nodes(),f=Yf(n,r,h);h.layoutPositions(t,r,f)}},u=0,l=!0;if(r.animate===!0){var c=function d(){for(var h=0;l&&h<r.refresh;)l=o(u),u++,h++;if(!l)hh(n,r),s();else{var f=hn();f-i>=r.animationThreshold&&a(),Fs(d)}};c()}else{for(;l;)l=o(u),u++;hh(n,r),s()}return this};ll.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};ll.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var qw=function(e,t,n){for(var i=n.eles.edges(),a=n.eles.nodes(),o=Er(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},u=n.eles.components(),l={},c=0;c<u.length;c++)for(var d=u[c],h=0;h<d.length;h++){var f=d[h];l[f.id()]=c}for(var c=0;c<s.nodeSize;c++){var v=a[c],p=v.layoutDimensions(n),m={};m.isLocked=v.locked(),m.id=v.data("id"),m.parentId=v.data("parent"),m.cmptId=l[v.id()],m.children=[],m.positionX=v.position("x"),m.positionY=v.position("y"),m.offsetX=0,m.offsetY=0,m.height=p.w,m.width=p.h,m.maxX=m.positionX+m.width/2,m.minX=m.positionX-m.width/2,m.maxY=m.positionY+m.height/2,m.minY=m.positionY-m.height/2,m.padLeft=parseFloat(v.style("padding")),m.padRight=parseFloat(v.style("padding")),m.padTop=parseFloat(v.style("padding")),m.padBottom=parseFloat(v.style("padding")),m.nodeRepulsion=Mt(n.nodeRepulsion)?n.nodeRepulsion(v):n.nodeRepulsion,s.layoutNodes.push(m),s.idToIndex[m.id]=c}for(var g=[],y=0,b=-1,S=[],c=0;c<s.nodeSize;c++){var v=s.layoutNodes[c],A=v.parentId;A!=null?s.layoutNodes[s.idToIndex[A]].children.push(v.id):(g[++b]=v.id,S.push(v.id))}for(s.graphSet.push(S);y<=b;){var P=g[y++],O=s.idToIndex[P],f=s.layoutNodes[O],I=f.children;if(I.length>0){s.graphSet.push(I);for(var c=0;c<I.length;c++)g[++b]=I[c]}}for(var c=0;c<s.graphSet.length;c++)for(var R=s.graphSet[c],h=0;h<R.length;h++){var L=s.idToIndex[R[h]];s.indexToGraph[L]=c}for(var c=0;c<s.edgeSize;c++){var B=i[c],w={};w.id=B.data("id"),w.sourceId=B.data("source"),w.targetId=B.data("target");var _=Mt(n.idealEdgeLength)?n.idealEdgeLength(B):n.idealEdgeLength,E=Mt(n.edgeElasticity)?n.edgeElasticity(B):n.edgeElasticity,x=s.idToIndex[w.sourceId],C=s.idToIndex[w.targetId],T=s.indexToGraph[x],M=s.indexToGraph[C];if(T!=M){for(var D=Xw(w.sourceId,w.targetId,s),F=s.graphSet[D],N=0,m=s.layoutNodes[x];F.indexOf(m.id)===-1;)m=s.layoutNodes[s.idToIndex[m.parentId]],N++;for(m=s.layoutNodes[C];F.indexOf(m.id)===-1;)m=s.layoutNodes[s.idToIndex[m.parentId]],N++;_*=N*n.nestingFactor}w.idealLength=_,w.elasticity=E,s.layoutEdges.push(w)}return s},Xw=function(e,t,n){var i=Kw(e,t,0,n);return 2>i.count?0:i.graph},Kw=function r(e,t,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:n};for(var o=0,s=0;s<a.length;s++){var u=a[s],l=i.idToIndex[u],c=i.layoutNodes[l].children;if(c.length!==0){var d=i.indexToGraph[i.idToIndex[c[0]]],h=r(e,t,d,i);if(h.count!==0)if(h.count===1){if(o++,o===2)break}else return h}}return{count:o,graph:n}},Zw,Qw=function(e,t){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var o=e.layoutNodes[a];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*n,o.positionY=Math.random()*i)}},Yf=function(e,t,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(o){var s=e.layoutNodes[e.idToIndex[o.data("id")]];a.x1=Math.min(a.x1,s.positionX),a.x2=Math.max(a.x2,s.positionX),a.y1=Math.min(a.y1,s.positionY),a.y2=Math.max(a.y2,s.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(o,s){var u=e.layoutNodes[e.idToIndex[o.data("id")]];if(t.boundingBox){var l=(u.positionX-a.x1)/a.w,c=(u.positionY-a.y1)/a.h;return{x:i.x1+l*i.w,y:i.y1+c*i.h}}else return{x:u.positionX,y:u.positionY}}},Jw=function(e,t,n){var i=n.layout,a=n.eles.nodes(),o=Yf(e,n,a);a.positions(o),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},eb=function(e,t,n){tb(e,t),ib(e),ab(e,t),ob(e),sb(e)},tb=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,o=0;o<a;o++)for(var s=e.layoutNodes[e.idToIndex[i[o]]],u=o+1;u<a;u++){var l=e.layoutNodes[e.idToIndex[i[u]]];rb(s,l,e,t)}},dh=function(e){return-e+2*e*Math.random()},rb=function(e,t,n,i){var a=e.cmptId,o=t.cmptId;if(!(a!==o&&!n.isCompound)){var s=t.positionX-e.positionX,u=t.positionY-e.positionY,l=1;s===0&&u===0&&(s=dh(l),u=dh(l));var c=nb(e,t,s,u);if(c>0)var d=i.nodeOverlap*c,h=Math.sqrt(s*s+u*u),f=d*s/h,v=d*u/h;else var p=Us(e,s,u),m=Us(t,-1*s,-1*u),g=m.x-p.x,y=m.y-p.y,b=g*g+y*y,h=Math.sqrt(b),d=(e.nodeRepulsion+t.nodeRepulsion)/b,f=d*g/h,v=d*y/h;e.isLocked||(e.offsetX-=f,e.offsetY-=v),t.isLocked||(t.offsetX+=f,t.offsetY+=v)}},nb=function(e,t,n,i){if(n>0)var a=e.maxX-t.minX;else var a=t.maxX-e.minX;if(i>0)var o=e.maxY-t.minY;else var o=t.maxY-e.minY;return a>=0&&o>=0?Math.sqrt(a*a+o*o):0},Us=function(e,t,n){var i=e.positionX,a=e.positionY,o=e.height||1,s=e.width||1,u=n/t,l=o/s,c={};return t===0&&0<n||t===0&&0>n?(c.x=i,c.y=a+o/2,c):0<t&&-1*l<=u&&u<=l?(c.x=i+s/2,c.y=a+s*n/2/t,c):0>t&&-1*l<=u&&u<=l?(c.x=i-s/2,c.y=a-s*n/2/t,c):0<n&&(u<=-1*l||u>=l)?(c.x=i+o*t/2/n,c.y=a+o/2,c):(0>n&&(u<=-1*l||u>=l)&&(c.x=i-o*t/2/n,c.y=a-o/2),c)},ib=function(e,t){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],o=e.layoutNodes[a],s=e.idToIndex[i.targetId],u=e.layoutNodes[s],l=u.positionX-o.positionX,c=u.positionY-o.positionY;if(!(l===0&&c===0)){var d=Us(o,l,c),h=Us(u,-1*l,-1*c),f=h.x-d.x,v=h.y-d.y,p=Math.sqrt(f*f+v*v),m=Math.pow(i.idealLength-p,2)/i.elasticity;if(p!==0)var g=m*f/p,y=m*v/p;else var g=0,y=0;o.isLocked||(o.offsetX+=g,o.offsetY+=y),u.isLocked||(u.offsetX-=g,u.offsetY-=y)}}},ab=function(e,t){if(t.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],o=a.length;if(i===0)var s=e.clientHeight/2,u=e.clientWidth/2;else var l=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[l.parentId]],s=c.positionX,u=c.positionY;for(var d=0;d<o;d++){var h=e.layoutNodes[e.idToIndex[a[d]]];if(!h.isLocked){var f=s-h.positionX,v=u-h.positionY,p=Math.sqrt(f*f+v*v);if(p>n){var m=t.gravity*f/p,g=t.gravity*v/p;h.offsetX+=m,h.offsetY+=g}}}}},ob=function(e,t){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var o=n[i++],s=e.idToIndex[o],u=e.layoutNodes[s],l=u.children;if(0<l.length&&!u.isLocked){for(var c=u.offsetX,d=u.offsetY,h=0;h<l.length;h++){var f=e.layoutNodes[e.idToIndex[l[h]]];f.offsetX+=c,f.offsetY+=d,n[++a]=l[h]}u.offsetX=0,u.offsetY=0}}},sb=function(e,t){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=lb(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,ub(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},lb=function(e,t,n){var i=Math.sqrt(e*e+t*t);if(i>n)var a={x:n*e/i,y:n*t/i};else var a={x:e,y:t};return a},ub=function r(e,t){var n=e.parentId;if(n!=null){var i=t.layoutNodes[t.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return r(i,t)}},hh=function(e,t){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var o=n[a],s=o.cmptId,u=i[s]=i[s]||[];u.push(o)}for(var l=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var d=0;d<c.length;d++){var h=c[d];c.x1=Math.min(c.x1,h.positionX-h.width/2),c.x2=Math.max(c.x2,h.positionX+h.width/2),c.y1=Math.min(c.y1,h.positionY-h.height/2),c.y2=Math.max(c.y2,h.positionY+h.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,l+=c.w*c.h}}i.sort(function(y,b){return b.w*b.h-y.w*y.h});for(var f=0,v=0,p=0,m=0,g=Math.sqrt(l)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var d=0;d<c.length;d++){var h=c[d];h.isLocked||(h.positionX+=f-c.x1,h.positionY+=v-c.y1)}f+=c.w+t.componentSpacing,p+=c.w+t.componentSpacing,m=Math.max(m,c.h),p>g&&(v+=m+t.componentSpacing,f=0,p=0,m=0)}}},cb={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function qf(r){this.options=Ye({},cb,r)}qf.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=Er(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(q){return{x:a.x1,y:a.y1}});else{var o=i.size(),s=Math.sqrt(o*a.h/a.w),u=Math.round(s),l=Math.round(a.w/a.h*s),c=function($){if($==null)return Math.min(u,l);var ee=Math.min(u,l);ee==u?u=$:l=$},d=function($){if($==null)return Math.max(u,l);var ee=Math.max(u,l);ee==u?u=$:l=$},h=e.rows,f=e.cols!=null?e.cols:e.columns;if(h!=null&&f!=null)u=h,l=f;else if(h!=null&&f==null)u=h,l=Math.ceil(o/u);else if(h==null&&f!=null)l=f,u=Math.ceil(o/l);else if(l*u>o){var v=c(),p=d();(v-1)*p>=o?c(v-1):(p-1)*v>=o&&d(p-1)}else for(;l*u<o;){var m=c(),g=d();(g+1)*m>=o?d(g+1):c(m+1)}var y=a.w/l,b=a.h/u;if(e.condense&&(y=0,b=0),e.avoidOverlap)for(var S=0;S<i.length;S++){var A=i[S],P=A._private.position;(P.x==null||P.y==null)&&(P.x=0,P.y=0);var O=A.layoutDimensions(e),I=e.avoidOverlapPadding,R=O.w+I,L=O.h+I;y=Math.max(y,R),b=Math.max(b,L)}for(var B={},w=function($,ee){return!!B["c-"+$+"-"+ee]},_=function($,ee){B["c-"+$+"-"+ee]=!0},E=0,x=0,C=function(){x++,x>=l&&(x=0,E++)},T={},M=0;M<i.length;M++){var D=i[M],F=e.position(D);if(F&&(F.row!==void 0||F.col!==void 0)){var N={row:F.row,col:F.col};if(N.col===void 0)for(N.col=0;w(N.row,N.col);)N.col++;else if(N.row===void 0)for(N.row=0;w(N.row,N.col);)N.row++;T[D.id()]=N,_(N.row,N.col)}}var z=function($,ee){var J,j;if($.locked()||$.isParent())return!1;var Z=T[$.id()];if(Z)J=Z.col*y+y/2+a.x1,j=Z.row*b+b/2+a.y1;else{for(;w(E,x);)C();J=x*y+y/2+a.x1,j=E*b+b/2+a.y1,_(E,x),C()}return{x:J,y:j}};i.layoutPositions(this,e,z)}return this};var db={ready:function(){},stop:function(){}};function Bu(r){this.options=Ye({},db,r)}Bu.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};Bu.prototype.stop=function(){return this};var hb={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Xf(r){this.options=Ye({},hb,r)}Xf.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),n=Mt(r.positions);function i(a){if(r.positions==null)return g0(a.position());if(n)return r.positions(a);var o=r.positions[a._private.data.id];return o??null}return t.layoutPositions(this,r,function(a,o){var s=i(a);return a.locked()||s==null?!1:s}),this};var fb={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Kf(r){this.options=Ye({},fb,r)}Kf.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=Er(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(o,s){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return t.nodes().layoutPositions(this,r,i),this};var vb=[{name:"breadthfirst",impl:Uf},{name:"circle",impl:$f},{name:"concentric",impl:Wf},{name:"cose",impl:ll},{name:"grid",impl:qf},{name:"null",impl:Bu},{name:"preset",impl:Xf},{name:"random",impl:Kf}];function Zf(r){this.options=r,this.notifications=0}var fh=function(){},vh=function(){throw new Error("A headless instance can not render images")};Zf.prototype={recalculateRenderedStyle:fh,notify:function(){this.notifications++},init:fh,isHeadless:function(){return!0},png:vh,jpg:vh};var Vu={};Vu.arrowShapeWidth=.3;Vu.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(l,c,d,h,f,v,p){var m=f.x-d/2-p,g=f.x+d/2+p,y=f.y-d/2-p,b=f.y+d/2+p,S=m<=l&&l<=g&&y<=c&&c<=b;return S},n=function(l,c,d,h,f){var v=l*Math.cos(h)-c*Math.sin(h),p=l*Math.sin(h)+c*Math.cos(h),m=v*d,g=p*d,y=m+f.x,b=g+f.y;return{x:y,y:b}},i=function(l,c,d,h){for(var f=[],v=0;v<l.length;v+=2){var p=l[v],m=l[v+1];f.push(n(p,m,c,d,h))}return f},a=function(l){for(var c=[],d=0;d<l.length;d++){var h=l[d];c.push(h.x,h.y)}return c},o=function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").pfValue*2},s=function(l,c){We(c)&&(c=r[c]),r[l]=Ye({name:l,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(h,f,v,p,m,g){var y=a(i(this.points,v+2*g,p,m)),b=xr(h,f,y);return b},roughCollide:t,draw:function(h,f,v,p){var m=i(this.points,f,v,p);e.arrowShapeImpl("polygon")(h,m)},spacing:function(h){return 0},gap:o},c)};s("none",{collide:Bs,roughCollide:Bs,draw:_u,spacing:_d,gap:_d}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(l,c,d,h,f){var v=i(this.points,c,d,h),p=this.controlPoint,m=n(p[0],p[1],c,d,h);e.arrowShapeImpl(this.name)(l,v,m)},gap:function(l){return o(l)*.8}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(l,c,d,h,f,v,p){var m=a(i(this.points,d+2*p,h,f)),g=a(i(this.pointsTee,d+2*p,h,f)),y=xr(l,c,m)||xr(l,c,g);return y},draw:function(l,c,d,h,f){var v=i(this.points,c,d,h),p=i(this.pointsTee,c,d,h);e.arrowShapeImpl(this.name)(l,v,p)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(l,c,d,h,f,v,p){var m=f,g=Math.pow(m.x-l,2)+Math.pow(m.y-c,2)<=Math.pow((d+2*p)*this.radius,2),y=a(i(this.points,d+2*p,h,f));return xr(l,c,y)||g},draw:function(l,c,d,h,f){var v=i(this.pointsTr,c,d,h);e.arrowShapeImpl(this.name)(l,v,h.x,h.y,this.radius*c)},spacing:function(l){return e.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(l,c){var d=this.baseCrossLinePts.slice(),h=c/l,f=3,v=5;return d[f]=d[f]-h,d[v]=d[v]-h,d},collide:function(l,c,d,h,f,v,p){var m=a(i(this.points,d+2*p,h,f)),g=a(i(this.crossLinePts(d,v),d+2*p,h,f)),y=xr(l,c,m)||xr(l,c,g);return y},draw:function(l,c,d,h,f){var v=i(this.points,c,d,h),p=i(this.crossLinePts(c,f),c,d,h);e.arrowShapeImpl(this.name)(l,v,p)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(l){return o(l)*.525}}),s("circle",{radius:.15,collide:function(l,c,d,h,f,v,p){var m=f,g=Math.pow(m.x-l,2)+Math.pow(m.y-c,2)<=Math.pow((d+2*p)*this.radius,2);return g},draw:function(l,c,d,h,f){e.arrowShapeImpl(this.name)(l,h.x,h.y,this.radius*c)},spacing:function(l){return e.getArrowWidth(l.pstyle("width").pfValue,l.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(l){return 1},gap:function(l){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(l){return l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(l){return .95*l.pstyle("width").pfValue*l.pstyle("arrow-scale").value}})};var hi={};hi.projectIntoViewport=function(r,e){var t=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],o=n[4],s=t.pan(),u=t.zoom(),l=((r-i)/o-s.x)/u,c=((e-a)/o-s.y)/u;return[l,c]};hi.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=this.cy.window().getComputedStyle(r),n=function(g){return parseFloat(t.getPropertyValue(g))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},o=r.clientWidth,s=r.clientHeight,u=i.left+i.right,l=i.top+i.bottom,c=a.left+a.right,d=e.width/(o+c),h=o-u,f=s-l,v=e.left+i.left+a.left,p=e.top+i.top+a.top;return this.containerBB=[v,p,h,f,d]};hi.invalidateContainerClientCoordsCache=function(){this.containerBB=null};hi.findNearestElement=function(r,e,t,n){return this.findNearestElements(r,e,t,n)[0]};hi.findNearestElements=function(r,e,t,n){var i=this,a=this,o=a.getCachedZSortedEles(),s=[],u=a.cy.zoom(),l=a.cy.hasCompoundNodes(),c=(n?24:8)/u,d=(n?8:2)/u,h=(n?8:2)/u,f=1/0,v,p;t&&(o=o.interactive);function m(O,I){if(O.isNode()){if(p)return;p=O,s.push(O)}if(O.isEdge()&&(I==null||I<f))if(v){if(v.pstyle("z-compound-depth").value===O.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===O.pstyle("z-compound-depth").value){for(var R=0;R<s.length;R++)if(s[R].isEdge()){s[R]=O,v=O,f=I??f;break}}}else s.push(O),v=O,f=I??f}function g(O){var I=O.outerWidth()+2*d,R=O.outerHeight()+2*d,L=I/2,B=R/2,w=O.position(),_=O.pstyle("corner-radius").value==="auto"?"auto":O.pstyle("corner-radius").pfValue,E=O._private.rscratch;if(w.x-L<=r&&r<=w.x+L&&w.y-B<=e&&e<=w.y+B){var x=a.nodeShapes[i.getNodeShape(O)];if(x.checkPoint(r,e,0,I,R,w.x,w.y,_,E))return m(O,0),!0}}function y(O){var I=O._private,R=I.rscratch,L=O.pstyle("width").pfValue,B=O.pstyle("arrow-scale").value,w=L/2+c,_=w*w,E=w*2,M=I.source,D=I.target,x;if(R.edgeType==="segments"||R.edgeType==="straight"||R.edgeType==="haystack"){for(var C=R.allpts,T=0;T+3<C.length;T+=2)if(D0(r,e,C[T],C[T+1],C[T+2],C[T+3],E)&&_>(x=L0(r,e,C[T],C[T+1],C[T+2],C[T+3])))return m(O,x),!0}else if(R.edgeType==="bezier"||R.edgeType==="multibezier"||R.edgeType==="self"||R.edgeType==="compound"){for(var C=R.allpts,T=0;T+5<R.allpts.length;T+=4)if(P0(r,e,C[T],C[T+1],C[T+2],C[T+3],C[T+4],C[T+5],E)&&_>(x=I0(r,e,C[T],C[T+1],C[T+2],C[T+3],C[T+4],C[T+5])))return m(O,x),!0}for(var M=M||I.source,D=D||I.target,F=i.getArrowWidth(L,B),N=[{name:"source",x:R.arrowStartX,y:R.arrowStartY,angle:R.srcArrowAngle},{name:"target",x:R.arrowEndX,y:R.arrowEndY,angle:R.tgtArrowAngle},{name:"mid-source",x:R.midX,y:R.midY,angle:R.midsrcArrowAngle},{name:"mid-target",x:R.midX,y:R.midY,angle:R.midtgtArrowAngle}],T=0;T<N.length;T++){var z=N[T],q=a.arrowShapes[O.pstyle(z.name+"-arrow-shape").value],$=O.pstyle("width").pfValue;if(q.roughCollide(r,e,F,z.angle,{x:z.x,y:z.y},$,c)&&q.collide(r,e,F,z.angle,{x:z.x,y:z.y},$,c))return m(O),!0}l&&s.length>0&&(g(M),g(D))}function b(O,I,R){return Gr(O,I,R)}function S(O,I){var R=O._private,L=h,B;I?B=I+"-":B="",O.boundingBox();var w=R.labelBounds[I||"main"],_=O.pstyle(B+"label").value,E=O.pstyle("text-events").strValue==="yes";if(!(!E||!_)){var x=b(R.rscratch,"labelX",I),C=b(R.rscratch,"labelY",I),T=b(R.rscratch,"labelAngle",I),M=O.pstyle(B+"text-margin-x").pfValue,D=O.pstyle(B+"text-margin-y").pfValue,F=w.x1-L-M,N=w.x2+L-M,z=w.y1-L-D,q=w.y2+L-D;if(T){var $=Math.cos(T),ee=Math.sin(T),J=function(te,X){return te=te-x,X=X-C,{x:te*$-X*ee+x,y:te*ee+X*$+C}},j=J(F,z),Z=J(F,q),H=J(N,z),k=J(N,q),G=[j.x+M,j.y+D,H.x+M,H.y+D,k.x+M,k.y+D,Z.x+M,Z.y+D];if(xr(r,e,G))return m(O),!0}else if(ea(w,r,e))return m(O),!0}}for(var A=o.length-1;A>=0;A--){var P=o[A];P.isNode()?g(P)||S(P):y(P)||S(P)||S(P,"source")||S(P,"target")}return s};hi.getAllInBox=function(r,e,t,n){var i=this.getCachedZSortedEles().interactive,a=[],o=Math.min(r,t),s=Math.max(r,t),u=Math.min(e,n),l=Math.max(e,n);r=o,t=s,e=u,n=l;for(var c=Er({x1:r,y1:e,x2:t,y2:n}),d=0;d<i.length;d++){var h=i[d];if(h.isNode()){var f=h,v=f.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Mu(c,v)&&!of(v,c)&&a.push(f)}else{var p=h,m=p._private,g=m.rscratch;if(g.startX!=null&&g.startY!=null&&!ea(c,g.startX,g.startY)||g.endX!=null&&g.endY!=null&&!ea(c,g.endX,g.endY))continue;if(g.edgeType==="bezier"||g.edgeType==="multibezier"||g.edgeType==="self"||g.edgeType==="compound"||g.edgeType==="segments"||g.edgeType==="haystack"){for(var y=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts,b=!0,S=0;S<y.length;S++)if(!A0(c,y[S])){b=!1;break}b&&a.push(p)}else(g.edgeType==="haystack"||g.edgeType==="straight")&&a.push(p)}}return a};var $s={};$s.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",o=e.edgeType==="compound",s=e.edgeType==="self",u,l,c,d,h,f,g,y;if(t?(c=e.haystackPts[0],d=e.haystackPts[1],h=e.haystackPts[2],f=e.haystackPts[3]):(c=e.arrowStartX,d=e.arrowStartY,h=e.arrowEndX,f=e.arrowEndY),g=e.midX,y=e.midY,a)u=c-e.segpts[0],l=d-e.segpts[1];else if(i||o||s||n){var v=e.allpts,p=Qt(v[0],v[2],v[4],.1),m=Qt(v[1],v[3],v[5],.1);u=c-p,l=d-m}else u=c-g,l=d-y;e.srcArrowAngle=vs(u,l);var g=e.midX,y=e.midY;if(t&&(g=(c+h)/2,y=(d+f)/2),u=h-c,l=f-d,a){var v=e.allpts;if(v.length/2%2===0){var b=v.length/2,S=b-2;u=v[b]-v[S],l=v[b+1]-v[S+1]}else if(e.isRound)u=e.midVector[1],l=-e.midVector[0];else{var b=v.length/2-1,S=b-2;u=v[b]-v[S],l=v[b+1]-v[S+1]}}else if(i||o||s){var v=e.allpts,A=e.ctrlpts,P,O,I,R;if(A.length/2%2===0){var L=v.length/2-1,B=L+2,w=B+2;P=Qt(v[L],v[B],v[w],0),O=Qt(v[L+1],v[B+1],v[w+1],0),I=Qt(v[L],v[B],v[w],1e-4),R=Qt(v[L+1],v[B+1],v[w+1],1e-4)}else{var B=v.length/2-1,L=B-2,w=B+2;P=Qt(v[L],v[B],v[w],.4999),O=Qt(v[L+1],v[B+1],v[w+1],.4999),I=Qt(v[L],v[B],v[w],.5),R=Qt(v[L+1],v[B+1],v[w+1],.5)}u=I-P,l=R-O}if(e.midtgtArrowAngle=vs(u,l),e.midDispX=u,e.midDispY=l,u*=-1,l*=-1,a){var v=e.allpts;if(v.length/2%2!==0){if(!e.isRound){var b=v.length/2-1,_=b+2;u=-(v[_]-v[b]),l=-(v[_+1]-v[b+1])}}}if(e.midsrcArrowAngle=vs(u,l),a)u=h-e.segpts[e.segpts.length-2],l=f-e.segpts[e.segpts.length-1];else if(i||o||s||n){var v=e.allpts,E=v.length,p=Qt(v[E-6],v[E-4],v[E-2],.9),m=Qt(v[E-5],v[E-3],v[E-1],.9);u=h-p,l=f-m}else u=h-g,l=f-y;e.tgtArrowAngle=vs(u,l)};$s.getArrowWidth=$s.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[r+", "+e];return n||(n=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=n,n)};var hu,fu,Jr={},Rr={},ph,gh,ii,Ls,dn,Jn,ni,Qr,$i,Es,Qf,Jf,vu,pu,mh,yh=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},pb=function(e,t){t.x=e.x*-1,t.y=e.y*-1,t.nx=e.nx*-1,t.ny=e.ny*-1,t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},gb=function(e,t,n,i,a){if(e!==mh?yh(t,e,Jr):pb(Rr,Jr),yh(t,n,Rr),ph=Jr.nx*Rr.ny-Jr.ny*Rr.nx,gh=Jr.nx*Rr.nx-Jr.ny*-Rr.ny,dn=Math.asin(Math.max(-1,Math.min(1,ph))),Math.abs(dn)<1e-6){hu=t.x,fu=t.y,ni=$i=0;return}ii=1,Ls=!1,gh<0?dn<0?dn=Math.PI+dn:(dn=Math.PI-dn,ii=-1,Ls=!0):dn>0&&(ii=-1,Ls=!0),t.radius!==void 0?$i=t.radius:$i=i,Jn=dn/2,Es=Math.min(Jr.len/2,Rr.len/2),a?(Qr=Math.abs(Math.cos(Jn)*$i/Math.sin(Jn)),Qr>Es?(Qr=Es,ni=Math.abs(Qr*Math.sin(Jn)/Math.cos(Jn))):ni=$i):(Qr=Math.min(Es,$i),ni=Math.abs(Qr*Math.sin(Jn)/Math.cos(Jn))),vu=t.x+Rr.nx*Qr,pu=t.y+Rr.ny*Qr,hu=vu-Rr.ny*ni*ii,fu=pu+Rr.nx*ni*ii,Qf=t.x+Jr.nx*Qr,Jf=t.y+Jr.ny*Qr,mh=t};function ev(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function zu(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(gb(r,e,t,n,i),{cx:hu,cy:fu,radius:ni,startX:Qf,startY:Jf,stopX:vu,stopY:pu,startAngle:Jr.ang+Math.PI/2*ii,endAngle:Rr.ang-Math.PI/2*ii,counterClockwise:Ls})}var fr={};fr.findMidptPtsEtc=function(r,e){var t=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,o=r.pstyle("source-endpoint"),s=r.pstyle("target-endpoint"),u=o.units!=null&&s.units!=null,l=function(A,P,O,I){var R=I-P,L=O-A,B=Math.sqrt(L*L+R*R);return{x:-R/B,y:L/B}},c=r.pstyle("edge-distances").value;switch(c){case"node-position":a=t;break;case"intersection":a=n;break;case"endpoints":{if(u){var d=this.manualEndptToPx(r.source()[0],o),h=Bt(d,2),f=h[0],v=h[1],p=this.manualEndptToPx(r.target()[0],s),m=Bt(p,2),g=m[0],y=m[1],b={x1:f,y1:v,x2:g,y2:y};i=l(f,v,g,y),a=b}else ft("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};fr.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],n=t._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var o=n.source,s=n.target,u=o.position(),l=s.position(),c=o.width(),d=s.width(),h=o.height(),f=s.height(),v=t.pstyle("haystack-radius").value,p=v/2;i.haystackPts=i.allpts=[i.source.x*c*p+u.x,i.source.y*h*p+u.y,i.target.x*d*p+l.x,i.target.y*f*p+l.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};fr.findSegmentsPoints=function(r,e){var t=r._private.rscratch,n=r.pstyle("segment-weights"),i=r.pstyle("segment-distances"),a=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),s=Math.min(n.pfValue.length,i.pfValue.length),u=a.pfValue[a.pfValue.length-1],l=o.pfValue[o.pfValue.length-1];t.edgeType="segments",t.segpts=[],t.radii=[],t.isArcRadius=[];for(var c=0;c<s;c++){var d=n.pfValue[c],h=i.pfValue[c],f=1-d,v=d,p=this.findMidptPtsEtc(r,e),m=p.midptPts,g=p.vectorNormInverse,y={x:m.x1*f+m.x2*v,y:m.y1*f+m.y2*v};t.segpts.push(y.x+g.x*h,y.y+g.y*h),t.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:u),t.isArcRadius.push((o.pfValue[c]!==void 0?o.pfValue[c]:l)==="arc-radius")}};fr.findLoopPoints=function(r,e,t,n){var i=r._private.rscratch,a=e.dirCounts,o=e.srcPos,s=r.pstyle("control-point-distances"),u=s?s.pfValue[0]:void 0,l=r.pstyle("loop-direction").pfValue,c=r.pstyle("loop-sweep").pfValue,d=r.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=t,f=d;n&&(h=0,f=u);var v=l-Math.PI/2,p=v-c/2,m=v+c/2,g=l+"_"+c;h=a[g]===void 0?a[g]=0:++a[g],i.ctrlpts=[o.x+Math.cos(p)*1.4*f*(h/3+1),o.y+Math.sin(p)*1.4*f*(h/3+1),o.x+Math.cos(m)*1.4*f*(h/3+1),o.y+Math.sin(m)*1.4*f*(h/3+1)]};fr.findCompoundLoopPoints=function(r,e,t,n){var i=r._private.rscratch;i.edgeType="compound";var a=e.srcPos,o=e.tgtPos,s=e.srcW,u=e.srcH,l=e.tgtW,c=e.tgtH,d=r.pstyle("control-point-step-size").pfValue,h=r.pstyle("control-point-distances"),f=h?h.pfValue[0]:void 0,v=t,p=d;n&&(v=0,p=f);var m=50,g={x:a.x-s/2,y:a.y-u/2},y={x:o.x-l/2,y:o.y-c/2},b={x:Math.min(g.x,y.x),y:Math.min(g.y,y.y)},S=.5,A=Math.max(S,Math.log(s*.01)),P=Math.max(S,Math.log(l*.01));i.ctrlpts=[b.x,b.y-(1+Math.pow(m,1.12)/100)*p*(v/3+1)*A,b.x-(1+Math.pow(m,1.12)/100)*p*(v/3+1)*P,b.y]};fr.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};fr.findBezierPoints=function(r,e,t,n,i){var a=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,s=r.pstyle("control-point-distances"),u=r.pstyle("control-point-weights"),l=s&&u?Math.min(s.value.length,u.value.length):1,c=s?s.pfValue[0]:void 0,d=u.value[0],h=n;a.edgeType=h?"multibezier":"bezier",a.ctrlpts=[];for(var f=0;f<l;f++){var v=(.5-e.eles.length/2+t)*o*(i?-1:1),p=void 0,m=nf(v);h&&(c=s?s.pfValue[f]:o,d=u.value[f]),n?p=c:p=c!==void 0?m*c:void 0;var g=p!==void 0?p:v,y=1-d,b=d,S=this.findMidptPtsEtc(r,e),A=S.midptPts,P=S.vectorNormInverse,O={x:A.x1*y+A.x2*b,y:A.y1*y+A.y2*b};a.ctrlpts.push(O.x+P.x*g,O.y+P.y*g)}};fr.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var n="vertical",i="horizontal",a="leftward",o="rightward",s="downward",u="upward",l="auto",c=e.posPts,d=e.srcW,h=e.srcH,f=e.tgtW,v=e.tgtH,p=r.pstyle("edge-distances").value,m=p!=="node-position",g=r.pstyle("taxi-direction").value,y=g,b=r.pstyle("taxi-turn"),S=b.units==="%",A=b.pfValue,P=A<0,O=r.pstyle("taxi-turn-min-distance").pfValue,I=m?(d+f)/2:0,R=m?(h+v)/2:0,L=c.x2-c.x1,B=c.y2-c.y1,w=function(ne,se){return ne>0?Math.max(ne-se,0):Math.min(ne+se,0)},_=w(L,I),E=w(B,R),x=!1;y===l?g=Math.abs(_)>Math.abs(E)?i:n:y===u||y===s?(g=n,x=!0):(y===a||y===o)&&(g=i,x=!0);var C=g===n,T=C?E:_,M=C?B:L,D=nf(M),F=!1;!(x&&(S||P))&&(y===s&&M<0||y===u&&M>0||y===a&&M>0||y===o&&M<0)&&(D*=-1,T=D*Math.abs(T),F=!0);var N;if(S){var z=A<0?1+A:A;N=z*T}else{var q=A<0?T:0;N=q+A*D}var $=function(ne){return Math.abs(ne)<O||Math.abs(ne)>=Math.abs(T)},ee=$(N),J=$(Math.abs(T)-Math.abs(N)),j=ee||J;if(j&&!F)if(C){var Z=Math.abs(M)<=h/2,H=Math.abs(L)<=f/2;if(Z){var k=(c.x1+c.x2)/2,G=c.y1,W=c.y2;t.segpts=[k,G,k,W]}else if(H){var te=(c.y1+c.y2)/2,X=c.x1,me=c.x2;t.segpts=[X,te,me,te]}else t.segpts=[c.x1,c.y2]}else{var Te=Math.abs(M)<=d/2,fe=Math.abs(B)<=v/2;if(Te){var ue=(c.y1+c.y2)/2,de=c.x1,ye=c.x2;t.segpts=[de,ue,ye,ue]}else if(fe){var Se=(c.x1+c.x2)/2,xe=c.y1,Ce=c.y2;t.segpts=[Se,xe,Se,Ce]}else t.segpts=[c.x2,c.y1]}else if(C){var _e=c.y1+N+(m?h/2*D:0),be=c.x1,he=c.x2;t.segpts=[be,_e,he,_e]}else{var V=c.x1+N+(m?d/2*D:0),re=c.y1,le=c.y2;t.segpts=[V,re,V,le]}if(t.isRound){var Y=r.pstyle("taxi-radius").value,Q=r.pstyle("radius-type").value[0]==="arc-radius";t.radii=new Array(t.segpts.length/2).fill(Y),t.isArcRadius=new Array(t.segpts.length/2).fill(Q)}};fr.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,o=e.srcH,s=e.tgtW,u=e.tgtH,l=e.srcShape,c=e.tgtShape,d=e.srcCornerRadius,h=e.tgtCornerRadius,f=e.srcRs,v=e.tgtRs,p=!Ne(t.startX)||!Ne(t.startY),m=!Ne(t.arrowStartX)||!Ne(t.arrowStartY),g=!Ne(t.endX)||!Ne(t.endY),y=!Ne(t.arrowEndX)||!Ne(t.arrowEndY),b=3,S=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,A=b*S,P=si({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),O=P<A,I=si({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),R=I<A,L=!1;if(p||m||O){L=!0;var B={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},w=Math.sqrt(B.x*B.x+B.y*B.y),_={x:B.x/w,y:B.y/w},E=Math.max(a,o),x={x:t.ctrlpts[0]+_.x*2*E,y:t.ctrlpts[1]+_.y*2*E},C=l.intersectLine(n.x,n.y,a,o,x.x,x.y,0,d,f);O?(t.ctrlpts[0]=t.ctrlpts[0]+_.x*(A-P),t.ctrlpts[1]=t.ctrlpts[1]+_.y*(A-P)):(t.ctrlpts[0]=C[0]+_.x*A,t.ctrlpts[1]=C[1]+_.y*A)}if(g||y||R){L=!0;var T={x:t.ctrlpts[0]-i.x,y:t.ctrlpts[1]-i.y},M=Math.sqrt(T.x*T.x+T.y*T.y),D={x:T.x/M,y:T.y/M},F=Math.max(a,o),N={x:t.ctrlpts[0]+D.x*2*F,y:t.ctrlpts[1]+D.y*2*F},z=c.intersectLine(i.x,i.y,s,u,N.x,N.y,0,h,v);R?(t.ctrlpts[0]=t.ctrlpts[0]+D.x*(A-I),t.ctrlpts[1]=t.ctrlpts[1]+D.y*(A-I)):(t.ctrlpts[0]=z[0]+D.x*A,t.ctrlpts[1]=z[1]+D.y*A)}L&&this.findEndpoints(r)}};fr.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=Qt(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=Qt(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var o=e.radii[a/2-1],s=e.isArcRadius[a/2-1];e.roundCorners.push(zu({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:o},{x:e.allpts[a+2],y:e.allpts[a+3]},o,s))}}if(e.segpts.length%4===0){var u=e.segpts.length/2,l=u-2;e.midX=(e.segpts[l]+e.segpts[u])/2,e.midY=(e.segpts[l+1]+e.segpts[u+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var d={x:e.segpts[c],y:e.segpts[c+1]},h=e.roundCorners[c/2],f=[d.x-h.cx,d.y-h.cy],v=h.radius/Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));f=f.map(function(p){return p*v}),e.midX=h.cx+f[0],e.midY=h.cy+f[1],e.midVector=f}}}};fr.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Ne(e.startX)&&Ne(e.startY)&&Ne(e.endX)&&Ne(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,ft("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};fr.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,n=t.cy,i=n.hasCompoundNodes(),a={map:new tn,get:function(O){var I=this.map.get(O[0]);return I!=null?I.get(O[1]):null},set:function(O,I){var R=this.map.get(O[0]);R==null&&(R=new tn,this.map.set(O[0],R)),R.set(O[1],I)}},o=[],s=[],u=0;u<r.length;u++){var l=r[u],c=l._private,d=l.pstyle("curve-style").value;if(!(l.removed()||!l.takesUpSpace())){if(d==="haystack"){s.push(l);continue}var h=d==="unbundled-bezier"||d.endsWith("segments")||d==="straight"||d==="straight-triangle"||d.endsWith("taxi"),f=d==="unbundled-bezier"||d==="bezier",v=c.source,p=c.target,m=v.poolIndex(),g=p.poolIndex(),y=[m,g].sort(),b=a.get(y);b==null&&(b={eles:[]},a.set(y,b),o.push(y)),b.eles.push(l),h&&(b.hasUnbundled=!0),f&&(b.hasBezier=!0)}}for(var S=function(O){var I=o[O],R=a.get(I),L=void 0;if(!R.hasUnbundled){var B=R.eles[0].parallelEdges().filter(function(V){return V.isBundledBezier()});Tu(R.eles),B.forEach(function(V){return R.eles.push(V)}),R.eles.sort(function(V,re){return V.poolIndex()-re.poolIndex()})}var w=R.eles[0],_=w.source(),E=w.target();if(_.poolIndex()>E.poolIndex()){var x=_;_=E,E=x}var C=R.srcPos=_.position(),T=R.tgtPos=E.position(),M=R.srcW=_.outerWidth(),D=R.srcH=_.outerHeight(),F=R.tgtW=E.outerWidth(),N=R.tgtH=E.outerHeight(),z=R.srcShape=t.nodeShapes[e.getNodeShape(_)],q=R.tgtShape=t.nodeShapes[e.getNodeShape(E)],$=R.srcCornerRadius=_.pstyle("corner-radius").value==="auto"?"auto":_.pstyle("corner-radius").pfValue,ee=R.tgtCornerRadius=E.pstyle("corner-radius").value==="auto"?"auto":E.pstyle("corner-radius").pfValue,J=R.tgtRs=E._private.rscratch,j=R.srcRs=_._private.rscratch;R.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var Z=0;Z<R.eles.length;Z++){var H=R.eles[Z],k=H[0]._private.rscratch,G=H.pstyle("curve-style").value,W=G==="unbundled-bezier"||G.endsWith("segments")||G.endsWith("taxi"),te=!_.same(H.source());if(!R.calculatedIntersection&&_!==E&&(R.hasBezier||R.hasUnbundled)){R.calculatedIntersection=!0;var X=z.intersectLine(C.x,C.y,M,D,T.x,T.y,0,$,j),me=R.srcIntn=X,Te=q.intersectLine(T.x,T.y,F,N,C.x,C.y,0,ee,J),fe=R.tgtIntn=Te,ue=R.intersectionPts={x1:X[0],x2:Te[0],y1:X[1],y2:Te[1]},de=R.posPts={x1:C.x,x2:T.x,y1:C.y,y2:T.y},ye=Te[1]-X[1],Se=Te[0]-X[0],xe=Math.sqrt(Se*Se+ye*ye),Ce=R.vector={x:Se,y:ye},_e=R.vectorNorm={x:Ce.x/xe,y:Ce.y/xe},be={x:-_e.y,y:_e.x};R.nodesOverlap=!Ne(xe)||q.checkPoint(X[0],X[1],0,F,N,T.x,T.y,ee,J)||z.checkPoint(Te[0],Te[1],0,M,D,C.x,C.y,$,j),R.vectorNormInverse=be,L={nodesOverlap:R.nodesOverlap,dirCounts:R.dirCounts,calculatedIntersection:!0,hasBezier:R.hasBezier,hasUnbundled:R.hasUnbundled,eles:R.eles,srcPos:T,srcRs:J,tgtPos:C,tgtRs:j,srcW:F,srcH:N,tgtW:M,tgtH:D,srcIntn:fe,tgtIntn:me,srcShape:q,tgtShape:z,posPts:{x1:de.x2,y1:de.y2,x2:de.x1,y2:de.y1},intersectionPts:{x1:ue.x2,y1:ue.y2,x2:ue.x1,y2:ue.y1},vector:{x:-Ce.x,y:-Ce.y},vectorNorm:{x:-_e.x,y:-_e.y},vectorNormInverse:{x:-be.x,y:-be.y}}}var he=te?L:R;k.nodesOverlap=he.nodesOverlap,k.srcIntn=he.srcIntn,k.tgtIntn=he.tgtIntn,k.isRound=G.startsWith("round"),i&&(_.isParent()||_.isChild()||E.isParent()||E.isChild())&&(_.parents().anySame(E)||E.parents().anySame(_)||_.same(E)&&_.isParent())?e.findCompoundLoopPoints(H,he,Z,W):_===E?e.findLoopPoints(H,he,Z,W):G.endsWith("segments")?e.findSegmentsPoints(H,he):G.endsWith("taxi")?e.findTaxiPoints(H,he):G==="straight"||!W&&R.eles.length%2===1&&Z===Math.floor(R.eles.length/2)?e.findStraightEdgePoints(H):e.findBezierPoints(H,he,Z,W,te),e.findEndpoints(H),e.tryToCorrectInvalidPoints(H,he),e.checkForInvalidEdgeWarning(H),e.storeAllpts(H),e.storeEdgeProjections(H),e.calculateArrowAngles(H),e.recalculateEdgeLabelProjections(H),e.calculateLabelAngles(H)}},A=0;A<o.length;A++)S(A);this.findHaystackPoints(s)}};function tv(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var n=r[t],i=r[t+1];e.push({x:n,y:i})}return e}}fr.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="segments")return tv(e.segpts)};fr.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return tv(e.ctrlpts)};fr.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var io={};io.manualEndptToPx=function(r,e){var t=this,n=r.position(),i=r.outerWidth(),a=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var s=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(s[0]=s[0]*i),e.units[1]==="%"&&(s[1]=s[1]*a),s[0]+=n.x,s[1]+=n.y,s}else{var u=e.pfValue[0];u=-Math.PI/2+u;var l=2*Math.max(i,a),c=[n.x+Math.cos(u)*l,n.y+Math.sin(u)*l];return t.nodeShapes[this.getNodeShape(r)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};io.findEndpoints=function(r){var e=this,t,n=r.source()[0],i=r.target()[0],a=n.position(),o=i.position(),s=r.pstyle("target-arrow-shape").value,u=r.pstyle("source-arrow-shape").value,l=r.pstyle("target-distance-from-node").pfValue,c=r.pstyle("source-distance-from-node").pfValue,d=n._private.rscratch,h=i._private.rscratch,f=r.pstyle("curve-style").value,v=r._private.rscratch,p=v.edgeType,m=f==="taxi",g=p==="self"||p==="compound",y=p==="bezier"||p==="multibezier"||g,b=p!=="bezier",S=p==="straight"||p==="segments",A=p==="segments",P=y||b||S,O=g||m,I=r.pstyle("source-endpoint"),R=O?"outside-to-node":I.value,L=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,B=r.pstyle("target-endpoint"),w=O?"outside-to-node":B.value,_=i.pstyle("corner-radius").value==="auto"?"auto":i.pstyle("corner-radius").pfValue;v.srcManEndpt=I,v.tgtManEndpt=B;var E,x,C,T;if(y){var M=[v.ctrlpts[0],v.ctrlpts[1]],D=b?[v.ctrlpts[v.ctrlpts.length-2],v.ctrlpts[v.ctrlpts.length-1]]:M;E=D,x=M}else if(S){var F=A?v.segpts.slice(0,2):[o.x,o.y],N=A?v.segpts.slice(v.segpts.length-2):[a.x,a.y];E=N,x=F}if(w==="inside-to-node")t=[o.x,o.y];else if(B.units)t=this.manualEndptToPx(i,B);else if(w==="outside-to-line")t=v.tgtIntn;else if(w==="outside-to-node"||w==="outside-to-node-or-label"?C=E:(w==="outside-to-line"||w==="outside-to-line-or-label")&&(C=[a.x,a.y]),t=e.nodeShapes[this.getNodeShape(i)].intersectLine(o.x,o.y,i.outerWidth(),i.outerHeight(),C[0],C[1],0,_,h),w==="outside-to-node-or-label"||w==="outside-to-line-or-label"){var z=i._private.rscratch,q=z.labelWidth,$=z.labelHeight,ee=z.labelX,J=z.labelY,j=q/2,Z=$/2,H=i.pstyle("text-valign").value;H==="top"?J-=Z:H==="bottom"&&(J+=Z);var k=i.pstyle("text-halign").value;k==="left"?ee-=j:k==="right"&&(ee+=j);var G=$a(C[0],C[1],[ee-j,J-Z,ee+j,J-Z,ee+j,J+Z,ee-j,J+Z],o.x,o.y);if(G.length>0){var W=a,te=ti(W,Yi(t)),X=ti(W,Yi(G)),me=te;if(X<te&&(t=G,me=X),G.length>2){var Te=ti(W,{x:G[2],y:G[3]});Te<me&&(t=[G[2],G[3]])}}}var fe=ps(t,E,e.arrowShapes[s].spacing(r)+l),ue=ps(t,E,e.arrowShapes[s].gap(r)+l);if(v.endX=ue[0],v.endY=ue[1],v.arrowEndX=fe[0],v.arrowEndY=fe[1],R==="inside-to-node")t=[a.x,a.y];else if(I.units)t=this.manualEndptToPx(n,I);else if(R==="outside-to-line")t=v.srcIntn;else if(R==="outside-to-node"||R==="outside-to-node-or-label"?T=x:(R==="outside-to-line"||R==="outside-to-line-or-label")&&(T=[o.x,o.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(a.x,a.y,n.outerWidth(),n.outerHeight(),T[0],T[1],0,L,d),R==="outside-to-node-or-label"||R==="outside-to-line-or-label"){var de=n._private.rscratch,ye=de.labelWidth,Se=de.labelHeight,xe=de.labelX,Ce=de.labelY,_e=ye/2,be=Se/2,he=n.pstyle("text-valign").value;he==="top"?Ce-=be:he==="bottom"&&(Ce+=be);var V=n.pstyle("text-halign").value;V==="left"?xe-=_e:V==="right"&&(xe+=_e);var re=$a(T[0],T[1],[xe-_e,Ce-be,xe+_e,Ce-be,xe+_e,Ce+be,xe-_e,Ce+be],a.x,a.y);if(re.length>0){var le=o,Y=ti(le,Yi(t)),Q=ti(le,Yi(re)),oe=Y;if(Q<Y&&(t=[re[0],re[1]],oe=Q),re.length>2){var ne=ti(le,{x:re[2],y:re[3]});ne<oe&&(t=[re[2],re[3]])}}}var se=ps(t,x,e.arrowShapes[u].spacing(r)+c),ve=ps(t,x,e.arrowShapes[u].gap(r)+c);v.startX=ve[0],v.startY=ve[1],v.arrowStartX=se[0],v.arrowStartY=se[1],P&&(!Ne(v.startX)||!Ne(v.startY)||!Ne(v.endX)||!Ne(v.endY)?v.badLine=!0:v.badLine=!1)};io.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};io.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var Gu={};function mb(r,e,t){for(var n=function(l,c,d,h){return Qt(l,c,d,h)},i=e._private,a=i.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var s=r.bezierProjPcts[o];a.push({x:n(t[0],t[2],t[4],s),y:n(t[1],t[3],t[5],s)})}}Gu.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,n=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<t.allpts.length;i+=4)mb(this,r,t.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<t.allpts.length;i+=2)a.push({x:t.allpts[i],y:t.allpts[i+1]});else if(n==="haystack"){var o=t.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};Gu.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var nn={};nn.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!Bn(e)){var t,n,i=r._private,a=r.width(),o=r.height(),s=r.padding(),u=r.position(),l=r.pstyle("text-halign").strValue,c=r.pstyle("text-valign").strValue,d=i.rscratch,h=i.rstyle;switch(l){case"left":t=u.x-a/2-s;break;case"right":t=u.x+a/2+s;break;default:t=u.x}switch(c){case"top":n=u.y-o/2-s;break;case"bottom":n=u.y+o/2+s;break;default:n=u.y}d.labelX=t,d.labelY=n,h.labelX=t,h.labelY=n,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var rv=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n=n*-1),n},nv=function(e,t){var n=t.x-e.x,i=t.y-e.y;return rv(n,i)},yb=function(e,t,n,i){var a=Ua(0,i-.001,1),o=Ua(0,i+.001,1),s=Xi(e,t,n,a),u=Xi(e,t,n,o);return nv(s,u)};nn.recalculateEdgeLabelProjections=function(r){var e,t=r._private,n=t.rscratch,i=this,a={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var o=function(d,h,f){Ln(t.rscratch,d,h,f),Ln(t.rstyle,d,h,f)};o("labelX",null,e.x),o("labelY",null,e.y);var s=rv(n.midDispX,n.midDispY);o("labelAutoAngle",null,s);var u=function c(){if(c.cache)return c.cache;for(var d=[],h=0;h+5<n.allpts.length;h+=4){var f={x:n.allpts[h],y:n.allpts[h+1]},v={x:n.allpts[h+2],y:n.allpts[h+3]},p={x:n.allpts[h+4],y:n.allpts[h+5]};d.push({p0:f,p1:v,p2:p,startDist:0,length:0,segments:[]})}var m=t.rstyle.bezierPts,g=i.bezierProjPcts.length;function y(O,I,R,L,B){var w=si(I,R),_=O.segments[O.segments.length-1],E={p0:I,p1:R,t0:L,t1:B,startDist:_?_.startDist+_.length:0,length:w};O.segments.push(E),O.length+=w}for(var b=0;b<d.length;b++){var S=d[b],A=d[b-1];A&&(S.startDist=A.startDist+A.length),y(S,S.p0,m[b*g],0,i.bezierProjPcts[0]);for(var P=0;P<g-1;P++)y(S,m[b*g+P],m[b*g+P+1],i.bezierProjPcts[P],i.bezierProjPcts[P+1]);y(S,m[b*g+g-1],S.p2,i.bezierProjPcts[g-1],1)}return c.cache=d},l=function(d){var h,f=d==="source";if(a[d]){var v=r.pstyle(d+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var p=u(),m,g=0,y=0,b=0;b<p.length;b++){for(var S=p[f?b:p.length-1-b],A=0;A<S.segments.length;A++){var P=S.segments[f?A:S.segments.length-1-A],O=b===p.length-1&&A===S.segments.length-1;if(g=y,y+=P.length,y>=v||O){m={cp:S,segment:P};break}}if(m)break}var I=m.cp,R=m.segment,L=(v-g)/R.length,B=R.t1-R.t0,w=f?R.t0+B*L:R.t1-B*L;w=Ua(0,w,1),e=Xi(I.p0,I.p1,I.p2,w),h=yb(I.p0,I.p1,I.p2,w);break}case"straight":case"segments":case"haystack":{for(var _=0,E,x,C,T,M=n.allpts.length,D=0;D+3<M&&(f?(C={x:n.allpts[D],y:n.allpts[D+1]},T={x:n.allpts[D+2],y:n.allpts[D+3]}):(C={x:n.allpts[M-2-D],y:n.allpts[M-1-D]},T={x:n.allpts[M-4-D],y:n.allpts[M-3-D]}),E=si(C,T),x=_,_+=E,!(_>=v));D+=2);var F=v-x,N=F/E;N=Ua(0,N,1),e=E0(C,T,N),h=nv(C,T);break}}o("labelX",d,e.x),o("labelY",d,e.y),o("labelAutoAngle",d,h)}};l("source"),l("target"),this.applyLabelDimensions(r)}};nn.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};nn.applyPrefixedLabelDimensions=function(r,e){var t=r._private,n=this.getLabelText(r,e),i=this.calculateLabelDimensions(r,n),a=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,s=Gr(t.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(s.length,1),l=i.height/u,c=l*a,d=i.width,h=i.height+(u-1)*(a-1)*l;Ln(t.rstyle,"labelWidth",e,d),Ln(t.rscratch,"labelWidth",e,d),Ln(t.rstyle,"labelHeight",e,h),Ln(t.rscratch,"labelHeight",e,h),Ln(t.rscratch,"labelLineHeight",e,c)};nn.getLabelText=function(r,e){var t=r._private,n=e?e+"-":"",i=r.pstyle(n+"label").strValue,a=r.pstyle("text-transform").value,o=function(q,$){return $?(Ln(t.rscratch,q,e,$),$):Gr(t.rscratch,q,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var s=r.pstyle("text-wrap").value;if(s==="wrap"){var u=o("labelKey");if(u!=null&&o("labelWrapKey")===u)return o("labelWrapCachedText");for(var l="\u200B",c=i.split(`
`),d=r.pstyle("text-max-width").pfValue,h=r.pstyle("text-overflow-wrap").value,f=h==="anywhere",v=[],p=/[\s\u200b]+|$/g,m=0;m<c.length;m++){var g=c[m],y=this.calculateLabelDimensions(r,g),b=y.width;if(f){var S=g.split("").join(l);g=S}if(b>d){var A=g.matchAll(p),P="",O=0,I=Mr(A),R;try{for(I.s();!(R=I.n()).done;){var L=R.value,B=L[0],w=g.substring(O,L.index);O=L.index+B.length;var _=P.length===0?w:P+w+B,E=this.calculateLabelDimensions(r,_),x=E.width;x<=d?P+=w+B:(P&&v.push(P),P=w+B)}}catch(z){I.e(z)}finally{I.f()}P.match(/^[\s\u200b]+$/)||v.push(P)}else v.push(g)}o("labelWrapCachedLines",v),i=o("labelWrapCachedText",v.join(`
`)),o("labelWrapKey",u)}else if(s==="ellipsis"){var C=r.pstyle("text-max-width").pfValue,T="",M="\u2026",D=!1;if(this.calculateLabelDimensions(r,i).width<C)return i;for(var F=0;F<i.length;F++){var N=this.calculateLabelDimensions(r,T+i[F]+M).width;if(N>C)break;T+=i[F],F===i.length-1&&(D=!0)}return D||(T+=M),T}return i};nn.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};nn.calculateLabelDimensions=function(r,e){var t=this,n=t.cy.window(),i=n.document,a=Vn(e,r._private.labelDimsKey),o=t.labelDimCache||(t.labelDimCache=[]),s=o[a];if(s!=null)return s;var u=0,l=r.pstyle("font-style").strValue,c=r.pstyle("font-size").pfValue,d=r.pstyle("font-family").strValue,h=r.pstyle("font-weight").strValue,f=this.labelCalcCanvas,v=this.labelCalcCanvasContext;if(!f){f=this.labelCalcCanvas=i.createElement("canvas"),v=this.labelCalcCanvasContext=f.getContext("2d");var p=f.style;p.position="absolute",p.left="-9999px",p.top="-9999px",p.zIndex="-1",p.visibility="hidden",p.pointerEvents="none"}v.font="".concat(l," ").concat(h," ").concat(c,"px ").concat(d);for(var m=0,g=0,y=e.split(`
`),b=0;b<y.length;b++){var S=y[b],A=v.measureText(S),P=Math.ceil(A.width),O=c;m=Math.max(P,m),g+=O}return m+=u,g+=u,o[a]={width:m,height:g}};nn.calculateLabelAngle=function(r,e){var t=r._private,n=t.rscratch,i=r.isEdge(),a=e?e+"-":"",o=r.pstyle(a+"text-rotation"),s=o.strValue;return s==="none"?0:i&&s==="autorotate"?n.labelAutoAngle:s==="autorotate"?0:o.pfValue};nn.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),n=r._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(r),t&&(i.sourceLabelAngle=e.calculateLabelAngle(r,"source"),i.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var iv={},Ch=28,wh=!1;iv.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<Ch||r.height()<Ch))return wh||(ft("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),wh=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return t};var ul={};ul.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,n=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),s)for(var u=0;u<o.length;u++){var l=o[u],c=l._private,d=c.rstyle;d.clean=!1,d.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(o){var s=o.target;n(s)}).on("style.* background.*",function(o){var s=o.target;n(s,!1)});var i=function(o){if(o){var s=t.onUpdateEleCalcsFns;e.cleanStyle();for(var u=0;u<e.length;u++){var l=e[u],c=l._private.rstyle;l.isNode()&&!c.cleanConnected&&(n(l.connectedEdges()),c.cleanConnected=!0)}if(s)for(var d=0;d<s.length;d++){var h=s[d];h(o,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){i(!0)},t.beforeRender(i,t.beforeRenderPriorities.eleCalcs)};ul.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};ul.recalculateRenderedStyle=function(r,e){var t=function(S){return S._private.rstyle.cleanConnected},n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<r.length;a++){var o=r[a],s=o._private,u=s.rstyle;o.isEdge()&&(!t(o.source())||!t(o.target()))&&(u.clean=!1),!(e&&u.clean||o.removed())&&o.pstyle("display").value!=="none"&&(s.group==="nodes"?i.push(o):n.push(o),u.clean=!0)}for(var l=0;l<i.length;l++){var c=i[l],d=c._private,h=d.rstyle,f=c.position();this.recalculateNodeLabelProjection(c),h.nodeX=f.x,h.nodeY=f.y,h.nodeW=c.pstyle("width").pfValue,h.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var v=0;v<n.length;v++){var p=n[v],m=p._private,g=m.rstyle,y=m.rscratch;g.srcX=y.arrowStartX,g.srcY=y.arrowStartY,g.tgtX=y.arrowEndX,g.tgtY=y.arrowEndY,g.midX=y.midX,g.midY=y.midY,g.labelAngle=y.labelAngle,g.sourceLabelAngle=y.sourceLabelAngle,g.targetLabelAngle=y.targetLabelAngle}}};var cl={};cl.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var n=r[t],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?r.drag.push(n):r.nondrag.push(n)}for(var t=0;t<e.length;t++){var n=e[t];r.drag.push(n)}}};cl.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};cl.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(Gf),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var av={};[hi,$s,fr,io,Gu,nn,iv,ul,cl].forEach(function(r){Ye(av,r)});var ov={};ov.getCachedImage=function(r,e,t){var n=this,i=n.imageCache=n.imageCache||{},a=i[r];if(a)return a.image.complete||a.image.addEventListener("load",t),a.image;a=i[r]=i[r]||{};var o=a.image=new Image;o.addEventListener("load",t),o.addEventListener("error",function(){o.error=!0});var s="data:",u=r.substring(0,s.length).toLowerCase()===s;return u||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var ca={};ca.registerBinding=function(r,e,t,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var a=[],o=0;o<r.length;o++){var s=r[o];if(s!==void 0){var u=this.binder(s);a.push(u.on.apply(u,i))}}return a}var u=this.binder(r);return u.on.apply(u,i)};ca.binder=function(r){var e=this,t=e.cy.window(),n=r===t||r===t.document||r===t.document.body||Ug(r);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});t.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var o=function(u,l,c){var d=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(d[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:d}),(r.addEventListener||r.on).apply(r,d),this};return{on:o,addEventListener:o,addListener:o,bind:o}};ca.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};ca.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};ca.load=function(){var r=this,e=r.cy.window(),t=function(V){return V.selected()},n=function(V){var re=V.getRootNode();if(re&&re.nodeType===11&&re.host!==void 0)return re},i=function(V,re,le,Y){V==null&&(V=r.cy);for(var Q=0;Q<re.length;Q++){var oe=re[Q];V.emit({originalEvent:le,type:oe,position:Y})}},a=function(V){return V.shiftKey||V.metaKey||V.ctrlKey},o=function(V,re){var le=!0;if(r.cy.hasCompoundNodes()&&V&&V.pannable())for(var Y=0;re&&Y<re.length;Y++){var V=re[Y];if(V.isNode()&&V.isParent()&&!V.pannable()){le=!1;break}}else le=!0;return le},s=function(V){V[0]._private.grabbed=!0},u=function(V){V[0]._private.grabbed=!1},l=function(V){V[0]._private.rscratch.inDragLayer=!0},c=function(V){V[0]._private.rscratch.inDragLayer=!1},d=function(V){V[0]._private.rscratch.isGrabTarget=!0},h=function(V){V[0]._private.rscratch.isGrabTarget=!1},f=function(V,re){var le=re.addToList,Y=le.has(V);!Y&&V.grabbable()&&!V.locked()&&(le.merge(V),s(V))},v=function(V,re){if(V.cy().hasCompoundNodes()&&!(re.inDragLayer==null&&re.addToList==null)){var le=V.descendants();re.inDragLayer&&(le.forEach(l),le.connectedEdges().forEach(l)),re.addToList&&f(le,re)}},p=function(V,re){re=re||{};var le=V.cy().hasCompoundNodes();re.inDragLayer&&(V.forEach(l),V.neighborhood().stdFilter(function(Y){return!le||Y.isEdge()}).forEach(l)),re.addToList&&V.forEach(function(Y){f(Y,re)}),v(V,re),y(V,{inDragLayer:re.inDragLayer}),r.updateCachedGrabbedEles()},m=p,g=function(V){V&&(r.getCachedZSortedEles().forEach(function(re){u(re),c(re),h(re)}),r.updateCachedGrabbedEles())},y=function(V,re){if(!(re.inDragLayer==null&&re.addToList==null)&&V.cy().hasCompoundNodes()){var le=V.ancestors().orphans();if(!le.same(V)){var Y=le.descendants().spawnSelf().merge(le).unmerge(V).unmerge(V.descendants()),Q=Y.connectedEdges();re.inDragLayer&&(Q.forEach(l),Y.forEach(l)),re.addToList&&Y.forEach(function(oe){f(oe,re)})}}},b=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},S=typeof MutationObserver<"u",A=typeof ResizeObserver<"u";S?(r.removeObserver=new MutationObserver(function(he){for(var V=0;V<he.length;V++){var re=he[V],le=re.removedNodes;if(le)for(var Y=0;Y<le.length;Y++){var Q=le[Y];if(Q===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(he){r.destroy()});var P=eo(function(){r.cy.resize()},100);S&&(r.styleObserver=new MutationObserver(P),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",P),A&&(r.resizeObserver=new ResizeObserver(P),r.resizeObserver.observe(r.container));var O=function(V,re){for(;V!=null;)re(V),V=V.parentNode},I=function(){r.invalidateContainerClientCoordsCache()};O(r.container,function(he){r.registerBinding(he,"transitionend",I),r.registerBinding(he,"animationend",I),r.registerBinding(he,"scroll",I)}),r.registerBinding(r.container,"contextmenu",function(he){he.preventDefault()});var R=function(){return r.selection[4]!==0},L=function(V){for(var re=r.findContainerClientCoords(),le=re[0],Y=re[1],Q=re[2],oe=re[3],ne=V.touches?V.touches:[V],se=!1,ve=0;ve<ne.length;ve++){var Re=ne[ve];if(le<=Re.clientX&&Re.clientX<=le+Q&&Y<=Re.clientY&&Re.clientY<=Y+oe){se=!0;break}}if(!se)return!1;for(var we=r.container,pe=V.target,Me=pe.parentNode,Ae=!1;Me;){if(Me===we){Ae=!0;break}Me=Me.parentNode}return!!Ae};r.registerBinding(r.container,"mousedown",function(V){if(L(V)&&!(r.hoverData.which===1&&V.which!==1)){V.preventDefault(),b(),r.hoverData.capture=!0,r.hoverData.which=V.which;var re=r.cy,le=[V.clientX,V.clientY],Y=r.projectIntoViewport(le[0],le[1]),Q=r.selection,oe=r.findNearestElements(Y[0],Y[1],!0,!1),ne=oe[0],se=r.dragData.possibleDragElements;r.hoverData.mdownPos=Y,r.hoverData.mdownGPos=le;var ve=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var Ie=r.hoverData.down;Ie?Ie.emit({originalEvent:V,type:"taphold",position:{x:Y[0],y:Y[1]}}):re.emit({originalEvent:V,type:"taphold",position:{x:Y[0],y:Y[1]}})}},r.tapholdDuration)};if(V.which==3){r.hoverData.cxtStarted=!0;var Re={originalEvent:V,type:"cxttapstart",position:{x:Y[0],y:Y[1]}};ne?(ne.activate(),ne.emit(Re),r.hoverData.down=ne):re.emit(Re),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(V.which==1){ne&&ne.activate();{if(ne!=null&&r.nodeIsGrabbable(ne)){var we=function(Ie){return{originalEvent:V,type:Ie,position:{x:Y[0],y:Y[1]}}},pe=function(Ie){Ie.emit(we("grab"))};if(d(ne),!ne.selected())se=r.dragData.possibleDragElements=re.collection(),m(ne,{addToList:se}),ne.emit(we("grabon")).emit(we("grab"));else{se=r.dragData.possibleDragElements=re.collection();var Me=re.$(function(Ae){return Ae.isNode()&&Ae.selected()&&r.nodeIsGrabbable(Ae)});p(Me,{addToList:se}),ne.emit(we("grabon")),Me.forEach(pe)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=ne,r.hoverData.downs=oe,r.hoverData.downTime=new Date().getTime()}i(ne,["mousedown","tapstart","vmousedown"],V,{x:Y[0],y:Y[1]}),ne==null?(Q[4]=1,r.data.bgActivePosistion={x:Y[0],y:Y[1]},r.redrawHint("select",!0),r.redraw()):ne.pannable()&&(Q[4]=1),ve()}Q[0]=Q[2]=Y[0],Q[1]=Q[3]=Y[1]}},!1);var B=n(r.container);r.registerBinding([e,B],"mousemove",function(V){var re=r.hoverData.capture;if(!(!re&&!L(V))){var le=!1,Y=r.cy,Q=Y.zoom(),oe=[V.clientX,V.clientY],ne=r.projectIntoViewport(oe[0],oe[1]),se=r.hoverData.mdownPos,ve=r.hoverData.mdownGPos,Re=r.selection,we=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(we=r.findNearestElement(ne[0],ne[1],!0,!1));var pe=r.hoverData.last,Me=r.hoverData.down,Ae=[ne[0]-Re[2],ne[1]-Re[3]],Ie=r.dragData.possibleDragElements,Ve;if(ve){var Ke=oe[0]-ve[0],ze=Ke*Ke,Le=oe[1]-ve[1],He=Le*Le,Be=ze+He;r.hoverData.isOverThresholdDrag=Ve=Be>=r.desktopTapThreshold2}var Ge=a(V);Ve&&(r.hoverData.tapholdCancelled=!0);var it=function(){var Ht=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Ht.length===0?(Ht.push(Ae[0]),Ht.push(Ae[1])):(Ht[0]+=Ae[0],Ht[1]+=Ae[1])};le=!0,i(we,["mousemove","vmousemove","tapdrag"],V,{x:ne[0],y:ne[1]});var at=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||Y.emit({originalEvent:V,type:"boxstart",position:{x:ne[0],y:ne[1]}}),Re[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(Ve){var mt={originalEvent:V,type:"cxtdrag",position:{x:ne[0],y:ne[1]}};Me?Me.emit(mt):Y.emit(mt),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||we!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:V,type:"cxtdragout",position:{x:ne[0],y:ne[1]}}),r.hoverData.cxtOver=we,we&&we.emit({originalEvent:V,type:"cxtdragover",position:{x:ne[0],y:ne[1]}}))}}else if(r.hoverData.dragging){if(le=!0,Y.panningEnabled()&&Y.userPanningEnabled()){var et;if(r.hoverData.justStartedPan){var Ze=r.hoverData.mdownPos;et={x:(ne[0]-Ze[0])*Q,y:(ne[1]-Ze[1])*Q},r.hoverData.justStartedPan=!1}else et={x:Ae[0]*Q,y:Ae[1]*Q};Y.panBy(et),Y.emit("dragpan"),r.hoverData.dragged=!0}ne=r.projectIntoViewport(V.clientX,V.clientY)}else if(Re[4]==1&&(Me==null||Me.pannable())){if(Ve){if(!r.hoverData.dragging&&Y.boxSelectionEnabled()&&(Ge||!Y.panningEnabled()||!Y.userPanningEnabled()))at();else if(!r.hoverData.selecting&&Y.panningEnabled()&&Y.userPanningEnabled()){var It=o(Me,r.hoverData.downs);It&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,Re[4]=0,r.data.bgActivePosistion=Yi(se),r.redrawHint("select",!0),r.redraw())}Me&&Me.pannable()&&Me.active()&&Me.unactivate()}}else{if(Me&&Me.pannable()&&Me.active()&&Me.unactivate(),(!Me||!Me.grabbed())&&we!=pe&&(pe&&i(pe,["mouseout","tapdragout"],V,{x:ne[0],y:ne[1]}),we&&i(we,["mouseover","tapdragover"],V,{x:ne[0],y:ne[1]}),r.hoverData.last=we),Me)if(Ve){if(Y.boxSelectionEnabled()&&Ge)Me&&Me.grabbed()&&(g(Ie),Me.emit("freeon"),Ie.emit("free"),r.dragData.didDrag&&(Me.emit("dragfreeon"),Ie.emit("dragfree"))),at();else if(Me&&Me.grabbed()&&r.nodeIsDraggable(Me)){var Je=!r.dragData.didDrag;Je&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||p(Ie,{inDragLayer:!0});var st={x:0,y:0};if(Ne(Ae[0])&&Ne(Ae[1])&&(st.x+=Ae[0],st.y+=Ae[1],Je)){var pt=r.hoverData.dragDelta;pt&&Ne(pt[0])&&Ne(pt[1])&&(st.x+=pt[0],st.y+=pt[1])}r.hoverData.draggingEles=!0,Ie.silentShift(st).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else it();le=!0}if(Re[2]=ne[0],Re[3]=ne[1],le)return V.stopPropagation&&V.stopPropagation(),V.preventDefault&&V.preventDefault(),!1}},!1);var w,_,E;r.registerBinding(e,"mouseup",function(V){if(!(r.hoverData.which===1&&V.which!==1&&r.hoverData.capture)){var re=r.hoverData.capture;if(re){r.hoverData.capture=!1;var le=r.cy,Y=r.projectIntoViewport(V.clientX,V.clientY),Q=r.selection,oe=r.findNearestElement(Y[0],Y[1],!0,!1),ne=r.dragData.possibleDragElements,se=r.hoverData.down,ve=a(V);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,se&&se.unactivate(),r.hoverData.which===3){var Re={originalEvent:V,type:"cxttapend",position:{x:Y[0],y:Y[1]}};if(se?se.emit(Re):le.emit(Re),!r.hoverData.cxtDragged){var we={originalEvent:V,type:"cxttap",position:{x:Y[0],y:Y[1]}};se?se.emit(we):le.emit(we)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(i(oe,["mouseup","tapend","vmouseup"],V,{x:Y[0],y:Y[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(i(se,["click","tap","vclick"],V,{x:Y[0],y:Y[1]}),_=!1,V.timeStamp-E<=le.multiClickDebounceTime()?(w&&clearTimeout(w),_=!0,E=null,i(se,["dblclick","dbltap","vdblclick"],V,{x:Y[0],y:Y[1]})):(w=setTimeout(function(){_||i(se,["oneclick","onetap","voneclick"],V,{x:Y[0],y:Y[1]})},le.multiClickDebounceTime()),E=V.timeStamp)),se==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!a(V)&&(le.$(t).unselect(["tapunselect"]),ne.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=ne=le.collection()),oe==se&&!r.dragData.didDrag&&!r.hoverData.selecting&&oe!=null&&oe._private.selectable&&(r.hoverData.dragging||(le.selectionType()==="additive"||ve?oe.selected()?oe.unselect(["tapunselect"]):oe.select(["tapselect"]):ve||(le.$(t).unmerge(oe).unselect(["tapunselect"]),oe.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var pe=le.collection(r.getAllInBox(Q[0],Q[1],Q[2],Q[3]));r.redrawHint("select",!0),pe.length>0&&r.redrawHint("eles",!0),le.emit({type:"boxend",originalEvent:V,position:{x:Y[0],y:Y[1]}});var Me=function(Ve){return Ve.selectable()&&!Ve.selected()};le.selectionType()==="additive"||ve||le.$(t).unmerge(pe).unselect(),pe.emit("box").stdFilter(Me).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!Q[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Ae=se&&se.grabbed();g(ne),Ae&&(se.emit("freeon"),ne.emit("free"),r.dragData.didDrag&&(se.emit("dragfreeon"),ne.emit("dragfree")))}}Q[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var x=function(V){if(!r.scrollingPage){var re=r.cy,le=re.zoom(),Y=re.pan(),Q=r.projectIntoViewport(V.clientX,V.clientY),oe=[Q[0]*le+Y.x,Q[1]*le+Y.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||R()){V.preventDefault();return}if(re.panningEnabled()&&re.userPanningEnabled()&&re.zoomingEnabled()&&re.userZoomingEnabled()){V.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var ne;V.deltaY!=null?ne=V.deltaY/-250:V.wheelDeltaY!=null?ne=V.wheelDeltaY/1e3:ne=V.wheelDelta/1e3,ne=ne*r.wheelSensitivity;var se=V.deltaMode===1;se&&(ne*=33);var ve=re.zoom()*Math.pow(10,ne);V.type==="gesturechange"&&(ve=r.gestureStartZoom*V.scale),re.zoom({level:ve,renderedPosition:{x:oe[0],y:oe[1]}}),re.emit(V.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",x,!0),r.registerBinding(e,"scroll",function(V){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(V){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||V.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(he){r.hasTouchStarted||x(he)},!0),r.registerBinding(r.container,"mouseout",function(V){var re=r.projectIntoViewport(V.clientX,V.clientY);r.cy.emit({originalEvent:V,type:"mouseout",position:{x:re[0],y:re[1]}})},!1),r.registerBinding(r.container,"mouseover",function(V){var re=r.projectIntoViewport(V.clientX,V.clientY);r.cy.emit({originalEvent:V,type:"mouseover",position:{x:re[0],y:re[1]}})},!1);var C,T,M,D,F,N,z,q,$,ee,J,j,Z,H=function(V,re,le,Y){return Math.sqrt((le-V)*(le-V)+(Y-re)*(Y-re))},k=function(V,re,le,Y){return(le-V)*(le-V)+(Y-re)*(Y-re)},G;r.registerBinding(r.container,"touchstart",G=function(V){if(r.hasTouchStarted=!0,!!L(V)){b(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var re=r.cy,le=r.touchData.now,Y=r.touchData.earlier;if(V.touches[0]){var Q=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);le[0]=Q[0],le[1]=Q[1]}if(V.touches[1]){var Q=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);le[2]=Q[0],le[3]=Q[1]}if(V.touches[2]){var Q=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);le[4]=Q[0],le[5]=Q[1]}if(V.touches[1]){r.touchData.singleTouchMoved=!0,g(r.dragData.touchDragEles);var oe=r.findContainerClientCoords();$=oe[0],ee=oe[1],J=oe[2],j=oe[3],C=V.touches[0].clientX-$,T=V.touches[0].clientY-ee,M=V.touches[1].clientX-$,D=V.touches[1].clientY-ee,Z=0<=C&&C<=J&&0<=M&&M<=J&&0<=T&&T<=j&&0<=D&&D<=j;var ne=re.pan(),se=re.zoom();F=H(C,T,M,D),N=k(C,T,M,D),z=[(C+M)/2,(T+D)/2],q=[(z[0]-ne.x)/se,(z[1]-ne.y)/se];var ve=200,Re=ve*ve;if(N<Re&&!V.touches[2]){var we=r.findNearestElement(le[0],le[1],!0,!0),pe=r.findNearestElement(le[2],le[3],!0,!0);we&&we.isNode()?(we.activate().emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start=we):pe&&pe.isNode()?(pe.activate().emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start=pe):re.emit({originalEvent:V,type:"cxttapstart",position:{x:le[0],y:le[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(V.touches[2])re.boxSelectionEnabled()&&V.preventDefault();else if(!V.touches[1]){if(V.touches[0]){var Me=r.findNearestElements(le[0],le[1],!0,!0),Ae=Me[0];if(Ae!=null&&(Ae.activate(),r.touchData.start=Ae,r.touchData.starts=Me,r.nodeIsGrabbable(Ae))){var Ie=r.dragData.touchDragEles=re.collection(),Ve=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Ae.selected()?(Ve=re.$(function(Be){return Be.selected()&&r.nodeIsGrabbable(Be)}),p(Ve,{addToList:Ie})):m(Ae,{addToList:Ie}),d(Ae);var Ke=function(Ge){return{originalEvent:V,type:Ge,position:{x:le[0],y:le[1]}}};Ae.emit(Ke("grabon")),Ve?Ve.forEach(function(Be){Be.emit(Ke("grab"))}):Ae.emit(Ke("grab"))}i(Ae,["touchstart","tapstart","vmousedown"],V,{x:le[0],y:le[1]}),Ae==null&&(r.data.bgActivePosistion={x:Q[0],y:Q[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&i(r.touchData.start,["taphold"],V,{x:le[0],y:le[1]})},r.tapholdDuration)}}if(V.touches.length>=1){for(var ze=r.touchData.startPosition=[null,null,null,null,null,null],Le=0;Le<le.length;Le++)ze[Le]=Y[Le]=le[Le];var He=V.touches[0];r.touchData.startGPosition=[He.clientX,He.clientY]}}},!1);var W;r.registerBinding(e,"touchmove",W=function(V){var re=r.touchData.capture;if(!(!re&&!L(V))){var le=r.selection,Y=r.cy,Q=r.touchData.now,oe=r.touchData.earlier,ne=Y.zoom();if(V.touches[0]){var se=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Q[0]=se[0],Q[1]=se[1]}if(V.touches[1]){var se=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);Q[2]=se[0],Q[3]=se[1]}if(V.touches[2]){var se=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);Q[4]=se[0],Q[5]=se[1]}var ve=r.touchData.startGPosition,Re;if(re&&V.touches[0]&&ve){for(var we=[],pe=0;pe<Q.length;pe++)we[pe]=Q[pe]-oe[pe];var Me=V.touches[0].clientX-ve[0],Ae=Me*Me,Ie=V.touches[0].clientY-ve[1],Ve=Ie*Ie,Ke=Ae+Ve;Re=Ke>=r.touchTapThreshold2}if(re&&r.touchData.cxt){V.preventDefault();var ze=V.touches[0].clientX-$,Le=V.touches[0].clientY-ee,He=V.touches[1].clientX-$,Be=V.touches[1].clientY-ee,Ge=k(ze,Le,He,Be),it=Ge/N,at=150,mt=at*at,et=1.5,Ze=et*et;if(it>=Ze||Ge>=mt){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var It={originalEvent:V,type:"cxttapend",position:{x:Q[0],y:Q[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(It),r.touchData.start=null):Y.emit(It)}}if(re&&r.touchData.cxt){var It={originalEvent:V,type:"cxtdrag",position:{x:Q[0],y:Q[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(It):Y.emit(It),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var Je=r.findNearestElement(Q[0],Q[1],!0,!0);(!r.touchData.cxtOver||Je!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:V,type:"cxtdragout",position:{x:Q[0],y:Q[1]}}),r.touchData.cxtOver=Je,Je&&Je.emit({originalEvent:V,type:"cxtdragover",position:{x:Q[0],y:Q[1]}}))}else if(re&&V.touches[2]&&Y.boxSelectionEnabled())V.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||Y.emit({originalEvent:V,type:"boxstart",position:{x:Q[0],y:Q[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,le[4]=1,!le||le.length===0||le[0]===void 0?(le[0]=(Q[0]+Q[2]+Q[4])/3,le[1]=(Q[1]+Q[3]+Q[5])/3,le[2]=(Q[0]+Q[2]+Q[4])/3+1,le[3]=(Q[1]+Q[3]+Q[5])/3+1):(le[2]=(Q[0]+Q[2]+Q[4])/3,le[3]=(Q[1]+Q[3]+Q[5])/3),r.redrawHint("select",!0),r.redraw();else if(re&&V.touches[1]&&!r.touchData.didSelect&&Y.zoomingEnabled()&&Y.panningEnabled()&&Y.userZoomingEnabled()&&Y.userPanningEnabled()){V.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var st=r.dragData.touchDragEles;if(st){r.redrawHint("drag",!0);for(var pt=0;pt<st.length;pt++){var yn=st[pt]._private;yn.grabbed=!1,yn.rscratch.inDragLayer=!1}}var Ht=r.touchData.start,ze=V.touches[0].clientX-$,Le=V.touches[0].clientY-ee,He=V.touches[1].clientX-$,Be=V.touches[1].clientY-ee,ln=H(ze,Le,He,Be),Cn=ln/F;if(Z){var un=ze-C,Ci=Le-T,wn=He-M,bn=Be-D,bo=(un+wn)/2,ya=(Ci+bn)/2,xn=Y.zoom(),Zn=xn*Cn,wi=Y.pan(),bi=q[0]*xn+wi.x,Ca=q[1]*xn+wi.y,xo={x:-Zn/xn*(bi-wi.x-bo)+bi,y:-Zn/xn*(Ca-wi.y-ya)+Ca};if(Ht&&Ht.active()){var st=r.dragData.touchDragEles;g(st),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Ht.unactivate().emit("freeon"),st.emit("free"),r.dragData.didDrag&&(Ht.emit("dragfreeon"),st.emit("dragfree"))}Y.viewport({zoom:Zn,pan:xo,cancelOnFailedZoom:!0}),Y.emit("pinchzoom"),F=ln,C=ze,T=Le,M=He,D=Be,r.pinching=!0}if(V.touches[0]){var se=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Q[0]=se[0],Q[1]=se[1]}if(V.touches[1]){var se=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);Q[2]=se[0],Q[3]=se[1]}if(V.touches[2]){var se=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);Q[4]=se[0],Q[5]=se[1]}}else if(V.touches[0]&&!r.touchData.didSelect){var vr=r.touchData.start,xi=r.touchData.last,Je;if(!r.hoverData.draggingEles&&!r.swipePanning&&(Je=r.findNearestElement(Q[0],Q[1],!0,!0)),re&&vr!=null&&V.preventDefault(),re&&vr!=null&&r.nodeIsDraggable(vr))if(Re){var st=r.dragData.touchDragEles,Nt=!r.dragData.didDrag;Nt&&p(st,{inDragLayer:!0}),r.dragData.didDrag=!0;var Xe={x:0,y:0};if(Ne(we[0])&&Ne(we[1])&&(Xe.x+=we[0],Xe.y+=we[1],Nt)){r.redrawHint("eles",!0);var Qe=r.touchData.dragDelta;Qe&&Ne(Qe[0])&&Ne(Qe[1])&&(Xe.x+=Qe[0],Xe.y+=Qe[1])}r.hoverData.draggingEles=!0,st.silentShift(Xe).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==oe[0]&&r.touchData.startPosition[1]==oe[1]&&r.redrawHint("eles",!0),r.redraw()}else{var Qe=r.touchData.dragDelta=r.touchData.dragDelta||[];Qe.length===0?(Qe.push(we[0]),Qe.push(we[1])):(Qe[0]+=we[0],Qe[1]+=we[1])}if(i(vr||Je,["touchmove","tapdrag","vmousemove"],V,{x:Q[0],y:Q[1]}),(!vr||!vr.grabbed())&&Je!=xi&&(xi&&xi.emit({originalEvent:V,type:"tapdragout",position:{x:Q[0],y:Q[1]}}),Je&&Je.emit({originalEvent:V,type:"tapdragover",position:{x:Q[0],y:Q[1]}})),r.touchData.last=Je,re)for(var pt=0;pt<Q.length;pt++)Q[pt]&&r.touchData.startPosition[pt]&&Re&&(r.touchData.singleTouchMoved=!0);if(re&&(vr==null||vr.pannable())&&Y.panningEnabled()&&Y.userPanningEnabled()){var Yr=o(vr,r.touchData.starts);Yr&&(V.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Yi(r.touchData.startPosition)),r.swipePanning?(Y.panBy({x:we[0]*ne,y:we[1]*ne}),Y.emit("dragpan")):Re&&(r.swipePanning=!0,Y.panBy({x:Me*ne,y:Ie*ne}),Y.emit("dragpan"),vr&&(vr.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var se=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);Q[0]=se[0],Q[1]=se[1]}}for(var pe=0;pe<Q.length;pe++)oe[pe]=Q[pe];re&&V.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var te;r.registerBinding(e,"touchcancel",te=function(V){var re=r.touchData.start;r.touchData.capture=!1,re&&re.unactivate()});var X,me,Te,fe;if(r.registerBinding(e,"touchend",X=function(V){var re=r.touchData.start,le=r.touchData.capture;if(le)V.touches.length===0&&(r.touchData.capture=!1),V.preventDefault();else return;var Y=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var Q=r.cy,oe=Q.zoom(),ne=r.touchData.now,se=r.touchData.earlier;if(V.touches[0]){var ve=r.projectIntoViewport(V.touches[0].clientX,V.touches[0].clientY);ne[0]=ve[0],ne[1]=ve[1]}if(V.touches[1]){var ve=r.projectIntoViewport(V.touches[1].clientX,V.touches[1].clientY);ne[2]=ve[0],ne[3]=ve[1]}if(V.touches[2]){var ve=r.projectIntoViewport(V.touches[2].clientX,V.touches[2].clientY);ne[4]=ve[0],ne[5]=ve[1]}re&&re.unactivate();var Re;if(r.touchData.cxt){if(Re={originalEvent:V,type:"cxttapend",position:{x:ne[0],y:ne[1]}},re?re.emit(Re):Q.emit(Re),!r.touchData.cxtDragged){var we={originalEvent:V,type:"cxttap",position:{x:ne[0],y:ne[1]}};re?re.emit(we):Q.emit(we)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!V.touches[2]&&Q.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var pe=Q.collection(r.getAllInBox(Y[0],Y[1],Y[2],Y[3]));Y[0]=void 0,Y[1]=void 0,Y[2]=void 0,Y[3]=void 0,Y[4]=0,r.redrawHint("select",!0),Q.emit({type:"boxend",originalEvent:V,position:{x:ne[0],y:ne[1]}});var Me=function(mt){return mt.selectable()&&!mt.selected()};pe.emit("box").stdFilter(Me).select().emit("boxselect"),pe.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(re?.unactivate(),V.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!V.touches[1]){if(!V.touches[0]){if(!V.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Ae=r.dragData.touchDragEles;if(re!=null){var Ie=re._private.grabbed;g(Ae),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Ie&&(re.emit("freeon"),Ae.emit("free"),r.dragData.didDrag&&(re.emit("dragfreeon"),Ae.emit("dragfree"))),i(re,["touchend","tapend","vmouseup","tapdragout"],V,{x:ne[0],y:ne[1]}),re.unactivate(),r.touchData.start=null}else{var Ve=r.findNearestElement(ne[0],ne[1],!0,!0);i(Ve,["touchend","tapend","vmouseup","tapdragout"],V,{x:ne[0],y:ne[1]})}var Ke=r.touchData.startPosition[0]-ne[0],ze=Ke*Ke,Le=r.touchData.startPosition[1]-ne[1],He=Le*Le,Be=ze+He,Ge=Be*oe*oe;r.touchData.singleTouchMoved||(re||Q.$(":selected").unselect(["tapunselect"]),i(re,["tap","vclick"],V,{x:ne[0],y:ne[1]}),me=!1,V.timeStamp-fe<=Q.multiClickDebounceTime()?(Te&&clearTimeout(Te),me=!0,fe=null,i(re,["dbltap","vdblclick"],V,{x:ne[0],y:ne[1]})):(Te=setTimeout(function(){me||i(re,["onetap","voneclick"],V,{x:ne[0],y:ne[1]})},Q.multiClickDebounceTime()),fe=V.timeStamp)),re!=null&&!r.dragData.didDrag&&re._private.selectable&&Ge<r.touchTapThreshold2&&!r.pinching&&(Q.selectionType()==="single"?(Q.$(t).unmerge(re).unselect(["tapunselect"]),re.select(["tapselect"])):re.selected()?re.unselect(["tapunselect"]):re.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var it=0;it<ne.length;it++)se[it]=ne[it];r.dragData.didDrag=!1,V.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),V.touches.length<2&&(V.touches.length===1&&(r.touchData.startGPosition=[V.touches[0].clientX,V.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var ue=[],de=function(V){return{clientX:V.clientX,clientY:V.clientY,force:1,identifier:V.pointerId,pageX:V.pageX,pageY:V.pageY,radiusX:V.width/2,radiusY:V.height/2,screenX:V.screenX,screenY:V.screenY,target:V.target}},ye=function(V){return{event:V,touch:de(V)}},Se=function(V){ue.push(ye(V))},xe=function(V){for(var re=0;re<ue.length;re++){var le=ue[re];if(le.event.pointerId===V.pointerId){ue.splice(re,1);return}}},Ce=function(V){var re=ue.filter(function(le){return le.event.pointerId===V.pointerId})[0];re.event=V,re.touch=de(V)},_e=function(V){V.touches=ue.map(function(re){return re.touch})},be=function(V){return V.pointerType==="mouse"||V.pointerType===4};r.registerBinding(r.container,"pointerdown",function(he){be(he)||(he.preventDefault(),Se(he),_e(he),G(he))}),r.registerBinding(r.container,"pointerup",function(he){be(he)||(xe(he),_e(he),X(he))}),r.registerBinding(r.container,"pointercancel",function(he){be(he)||(xe(he),_e(he),te(he))}),r.registerBinding(r.container,"pointermove",function(he){be(he)||(he.preventDefault(),Ce(he),_e(he),W(he))})}};var pn={};pn.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(n,i,a,o,s,u){this.renderer.nodeShapeImpl("polygon",n,i,a,o,s,this.points)},intersectLine:function(n,i,a,o,s,u,l,c){return $a(s,u,this.points,n,i,a/2,o/2,l)},checkPoint:function(n,i,a,o,s,u,l,c){return fn(n,i,this.points,u,l,o,s,[0,-1],a)}}};pn.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,u){return k0(a,o,e,t,n/2+s,i/2+s)},checkPoint:function(e,t,n,i,a,o,s,u){return ai(e,t,i,a,o,s,n)}}};pn.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(n,i,a,o,s,u,l){if(u[l]!==void 0&&u[l+"-cx"]===n&&u[l+"-cy"]===i)return u[l];u[l]=new Array(e.length/2),u[l+"-cx"]=n,u[l+"-cy"]=i;var c=a/2,d=o/2;s=s==="auto"?uf(a,o):s;for(var h=new Array(e.length/2),f=0;f<e.length/2;f++)h[f]={x:n+c*e[f*2],y:i+d*e[f*2+1]};var v,p,m,g,y=h.length;for(p=h[y-1],v=0;v<y;v++)m=h[v%y],g=h[(v+1)%y],u[l][v]=zu(p,m,g,s),p=m,m=g;return u[l]},draw:function(n,i,a,o,s,u,l){this.renderer.nodeShapeImpl("round-polygon",n,i,a,o,s,this.points,this.getOrCreateCorners(i,a,o,s,u,l,"drawCorners"))},intersectLine:function(n,i,a,o,s,u,l,c,d){return F0(s,u,this.points,n,i,a,o,l,this.getOrCreateCorners(n,i,a,o,c,d,"corners"))},checkPoint:function(n,i,a,o,s,u,l,c,d){return N0(n,i,this.points,u,l,o,s,this.getOrCreateCorners(u,l,o,s,c,d,"corners"))}}};pn.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:pr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,u){return sf(a,o,e,t,n,i,s,u)},checkPoint:function(e,t,n,i,a,o,s,u){var l=i/2,c=a/2;u=u==="auto"?li(i,a):u,u=Math.min(l,c,u);var d=u*2;return!!(fn(e,t,this.points,o,s,i,a-d,[0,-1],n)||fn(e,t,this.points,o,s,i-d,a,[0,-1],n)||ai(e,t,d,d,o-l+u,s-c+u,n)||ai(e,t,d,d,o+l-u,s-c+u,n)||ai(e,t,d,d,o+l-u,s+c-u,n)||ai(e,t,d,d,o-l+u,s+c-u,n))}}};pn.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:Au(),points:pr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,null,o)},generateCutTrianglePts:function(e,t,n,i,a){var o=a==="auto"?this.cornerLength:a,s=t/2,u=e/2,l=n-u,c=n+u,d=i-s,h=i+s;return{topLeft:[l,d+o,l+o,d,l+o,d+o],topRight:[c-o,d,c,d+o,c-o,d+o],bottomRight:[c,h-o,c-o,h,c-o,h-o],bottomLeft:[l+o,h,l,h-o,l+o,h-o]}},intersectLine:function(e,t,n,i,a,o,s,u){var l=this.generateCutTrianglePts(n+2*s,i+2*s,e,t,u),c=[].concat.apply([],[l.topLeft.splice(0,4),l.topRight.splice(0,4),l.bottomRight.splice(0,4),l.bottomLeft.splice(0,4)]);return $a(a,o,c,e,t)},checkPoint:function(e,t,n,i,a,o,s,u){var l=u==="auto"?this.cornerLength:u;if(fn(e,t,this.points,o,s,i,a-2*l,[0,-1],n)||fn(e,t,this.points,o,s,i-2*l,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,o,s);return xr(e,t,c.topLeft)||xr(e,t,c.topRight)||xr(e,t,c.bottomRight)||xr(e,t,c.bottomLeft)}}};pn.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:pr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,u){var l=.15,c=.5,d=.85,h=this.generateBarrelBezierPts(n+2*s,i+2*s,e,t),f=function(m){var g=Xi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},l),y=Xi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},c),b=Xi({x:m[0],y:m[1]},{x:m[2],y:m[3]},{x:m[4],y:m[5]},d);return[m[0],m[1],g.x,g.y,y.x,y.y,b.x,b.y,m[4],m[5]]},v=[].concat(f(h.topLeft),f(h.topRight),f(h.bottomRight),f(h.bottomLeft));return $a(a,o,v,e,t)},generateBarrelBezierPts:function(e,t,n,i){var a=t/2,o=e/2,s=n-o,u=n+o,l=i-a,c=i+a,d=au(e,t),h=d.heightOffset,f=d.widthOffset,v=d.ctrlPtOffsetPct*e,p={topLeft:[s,l+h,s+v,l,s+f,l],topRight:[u-f,l,u-v,l,u,l+h],bottomRight:[u,c-h,u-v,c,u-f,c],bottomLeft:[s+f,c,s+v,c,s,c-h]};return p.topLeft.isTop=!0,p.topRight.isTop=!0,p.bottomLeft.isBottom=!0,p.bottomRight.isBottom=!0,p},checkPoint:function(e,t,n,i,a,o,s,u){var l=au(i,a),c=l.heightOffset,d=l.widthOffset;if(fn(e,t,this.points,o,s,i,a-2*c,[0,-1],n)||fn(e,t,this.points,o,s,i-2*d,a,[0,-1],n))return!0;for(var h=this.generateBarrelBezierPts(i,a,o,s),f=function(I,R,L){var B=L[4],w=L[2],_=L[0],E=L[5],x=L[1],C=Math.min(B,_),T=Math.max(B,_),M=Math.min(E,x),D=Math.max(E,x);if(C<=I&&I<=T&&M<=R&&R<=D){var F=B0(B,w,_),N=O0(F[0],F[1],F[2],I),z=N.filter(function(q){return 0<=q&&q<=1});if(z.length>0)return z[0]}return null},v=Object.keys(h),p=0;p<v.length;p++){var m=v[p],g=h[m],y=f(e,t,g);if(y!=null){var b=g[5],S=g[3],A=g[1],P=Qt(b,S,A,y);if(g.isTop&&P<=t||g.isBottom&&t<=P)return!0}}return!1}}};pn.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:pr(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,u){var l=e-(n/2+s),c=t-(i/2+s),d=c,h=e+(n/2+s),f=Nn(a,o,e,t,l,c,h,d,!1);return f.length>0?f:sf(a,o,e,t,n,i,s,u)},checkPoint:function(e,t,n,i,a,o,s,u){u=u==="auto"?li(i,a):u;var l=2*u;if(fn(e,t,this.points,o,s,i,a-l,[0,-1],n)||fn(e,t,this.points,o,s,i-l,a,[0,-1],n))return!0;var c=i/2+2*n,d=a/2+2*n,h=[o-c,s-d,o-c,s,o+c,s,o+c,s-d];return!!(xr(e,t,h)||ai(e,t,l,l,o+i/2-u,s+a/2-u,n)||ai(e,t,l,l,o-i/2+u,s+a/2-u,n))}}};pn.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",pr(3,0)),this.generateRoundPolygon("round-triangle",pr(3,0)),this.generatePolygon("rectangle",pr(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",pr(5,0)),this.generateRoundPolygon("round-pentagon",pr(5,0)),this.generatePolygon("hexagon",pr(6,0)),this.generateRoundPolygon("round-hexagon",pr(6,0)),this.generatePolygon("heptagon",pr(7,0)),this.generateRoundPolygon("round-heptagon",pr(7,0)),this.generatePolygon("octagon",pr(8,0)),this.generateRoundPolygon("round-octagon",pr(8,0));var n=new Array(20);{var i=iu(5,0),a=iu(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<a.length/2;s++)a[s*2]*=o,a[s*2+1]*=o;for(var s=0;s<20/4;s++)n[s*4]=i[s*2],n[s*4+1]=i[s*2+1],n[s*4+2]=a[s*2],n[s*4+3]=a[s*2+1]}n=lf(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u),this.generateRoundPolygon("round-tag",u)}r.makePolygon=function(l){var c=l.join("$"),d="polygon-"+c,h;return(h=this[d])?h:e.generatePolygon(d,l)}};var ao={};ao.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};ao.redraw=function(r){r=r||tf();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};ao.beforeRender=function(r,e){if(!this.destroyed){e==null&&St("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(n,i){return i.priority-n.priority})}};var bh=function(e,t,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(t,n)};ao.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function n(i){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){bh(r,!0,i);var a=hn();r.render(r.renderOptions);var o=r.lastDrawTime=hn();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-a),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var s=o-a;r.redrawTotalTime+=s,r.lastRedrawTime=s,r.averageRedrawTime=r.averageRedrawTime/2+s/2,r.requestedFrame=!1}else bh(r,!1,i);r.skipFrame=!1,Fs(n)}};Fs(t)}};var Cb=function(e){this.init(e)},sv=Cb,da=sv.prototype;da.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];da.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,o="__________cytoscape_stylesheet",s="__________cytoscape_container",u=i.getElementById(o)!=null;if(t.className.indexOf(s)<0&&(t.className=(t.className||"")+" "+s),!u){var l=i.createElement("style");l.id=o,l.textContent="."+s+" { position: relative; }",a.insertBefore(l,a.children[0])}var c=n.getComputedStyle(t),d=c.getPropertyValue("position");d==="static"&&ft("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Ne(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};da.notify=function(r,e){var t=this,n=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&n.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),r==="gc"&&t.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};da.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],n=t,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};da.isHeadless=function(){return!1};[Vu,av,ov,ca,pn,ao].forEach(function(r){Ye(da,r)});var Zl=1e3/60,lv={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=eo(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),o=function(l,c){var d=hn(),h=i.averageRedrawTime,f=i.lastRedrawTime,v=[],p=i.cy.extent(),m=i.getPixelRatio();for(l||i.flushRenderedStyleQueue();;){var g=hn(),y=g-d,b=g-c;if(f<Zl){var S=Zl-(l?h:0);if(b>=e.deqFastCost*S)break}else if(l){if(y>=e.deqCost*f||y>=e.deqAvgCost*h)break}else if(b>=e.deqNoDrawCost*Zl)break;var A=e.deq(n,m,p);if(A.length>0)for(var P=0;P<A.length;P++)v.push(A[P]);else break}v.length>0&&(e.onDeqd(n,v),!l&&e.shouldRedraw(n,v,m,p)&&a())},s=e.priority||_u;i.beforeRender(o,s(n))}}}},wb=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bs;Un(this,r),this.idsByKey=new tn,this.keyForId=new tn,this.cachesByLvl=new tn,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return $n(r,[{key:"getIdsFor",value:function(t){t==null&&St("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(t);return i||(i=new na,n.set(t,i)),i}},{key:"addIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).add(n)}},{key:"deleteIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).delete(n)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);return i!==a}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var n=this.cachesByLvl,i=this.lvls,a=n.get(t);return a||(a=new tn,n.set(t,a),i.push(t)),a}},{key:"getCache",value:function(t,n){return this.getCachesAt(n).get(t)}},{key:"get",value:function(t,n){var i=this.getKey(t),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(t),a}},{key:"getForCachedKey",value:function(t,n){var i=this.keyForId.get(t.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(t,n){return this.getCachesAt(n).has(t)}},{key:"has",value:function(t,n){var i=this.getKey(t);return this.hasCache(i,n)}},{key:"setCache",value:function(t,n,i){i.key=t,this.getCachesAt(n).set(t,i)}},{key:"set",value:function(t,n,i){var a=this.getKey(t);this.setCache(a,n,i),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,n){this.getCachesAt(n).delete(t)}},{key:"delete",value:function(t,n){var i=this.getKey(t);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(t){var n=this;this.lvls.forEach(function(i){return n.deleteCache(t,i)})}},{key:"invalidate",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(t);var a=this.doesEleInvalidateKey(t);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}]),r}(),xh=25,_s=50,Ns=-4,gu=3,uv=7.99,bb=8,xb=1024,Eb=1024,_b=1024,Tb=.2,Sb=.8,Mb=10,Ab=.15,Db=.1,Pb=.9,Ob=.9,Rb=100,Ib=1,qi={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Lb=Jt({getKey:null,doesEleInvalidateKey:Bs,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Qh,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Na=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var i=Lb(t);Ye(n,i),n.lookup=new wb(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},jt=Na.prototype;jt.reasons=qi;jt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};jt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=t[r]=t[r]||[];return n};jt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new to(function(t,n){return n.reqs-t.reqs});return e};jt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};jt.getElement=function(r,e,t,n,i){var a=this,o=this.renderer,s=o.cy.zoom(),u=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!a.allowEdgeTxrCaching&&r.isEdge()||!a.allowParentTxrCaching&&r.isParent())return null;if(n==null&&(n=Math.ceil(Su(s*t))),n<Ns)n=Ns;else if(s>=uv||n>gu)return null;var l=Math.pow(2,n),c=e.h*l,d=e.w*l,h=o.eleTextBiggerThanMin(r,l);if(!this.isVisible(r,h))return null;var f=u.get(r,n);if(f&&f.invalidated&&(f.invalidated=!1,f.texture.invalidatedWidth-=f.width),f)return f;var v;if(c<=xh?v=xh:c<=_s?v=_s:v=Math.ceil(c/_s)*_s,c>_b||d>Eb)return null;var p=a.getTextureQueue(v),m=p[p.length-2],g=function(){return a.recycleTexture(v,d)||a.addTexture(v,d)};m||(m=p[p.length-1]),m||(m=g()),m.width-m.usedWidth<d&&(m=g());for(var y=function(C){return C&&C.scaledLabelShown===h},b=i&&i===qi.dequeue,S=i&&i===qi.highQuality,A=i&&i===qi.downscale,P,O=n+1;O<=gu;O++){var I=u.get(r,O);if(I){P=I;break}}var R=P&&P.level===n+1?P:null,L=function(){m.context.drawImage(R.texture.canvas,R.x,0,R.width,R.height,m.usedWidth,0,d,c)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,d,v),y(R))L();else if(y(P))if(S){for(var B=P.level;B>n;B--)R=a.getElement(r,e,t,B,qi.downscale);L()}else return a.queueElement(r,P.level-1),P;else{var w;if(!b&&!S&&!A)for(var _=n-1;_>=Ns;_--){var E=u.get(r,_);if(E){w=E;break}}if(y(w))return a.queueElement(r,n),w;m.context.translate(m.usedWidth,0),m.context.scale(l,l),this.drawElement(m.context,r,e,h,!1),m.context.scale(1/l,1/l),m.context.translate(-m.usedWidth,0)}return f={x:m.usedWidth,texture:m,level:n,scale:l,width:d,height:c,scaledLabelShown:h},m.usedWidth+=Math.ceil(d+bb),m.eleCaches.push(f),u.set(r,n,f),a.checkTextureFullness(m),f};jt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};jt.invalidateElement=function(r){var e=this,t=e.lookup,n=[],i=t.isInvalid(r);if(i){for(var a=Ns;a<=gu;a++){var o=t.getForCachedKey(r,a);o&&n.push(o)}var s=t.invalidate(r);if(s)for(var u=0;u<n.length;u++){var l=n[u],c=l.texture;c.invalidatedWidth+=l.width,l.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(r)}};jt.checkTextureUtility=function(r){r.invalidatedWidth>=Tb*r.width&&this.retireTexture(r)};jt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>Sb&&r.fullnessChecks>=Mb?zn(t,r):r.fullnessChecks++};jt.retireTexture=function(r){var e=this,t=r.height,n=e.getTextureQueue(t),i=this.lookup;zn(n,r),r.retired=!0;for(var a=r.eleCaches,o=0;o<a.length;o++){var s=a[o];i.deleteCache(s.key,s.level)}Tu(a);var u=e.getRetiredTextureQueue(t);u.push(r)};jt.addTexture=function(r,e){var t=this,n=t.getTextureQueue(r),i={};return n.push(i),i.eleCaches=[],i.height=r,i.width=Math.max(xb,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=t.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};jt.recycleTexture=function(r,e){for(var t=this,n=t.getTextureQueue(r),i=t.getRetiredTextureQueue(r),a=0;a<i.length;a++){var o=i[a];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,Tu(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),zn(i,o),n.push(o),o}};jt.queueElement=function(r,e){var t=this,n=t.getElementQueue(),i=t.getElementKeyToQueue(),a=this.getKey(r),o=i[a];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,n.updateItem(o);else{var s={eles:r.spawn().merge(r),level:e,reqs:1,key:a};n.push(s),i[a]=s}};jt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,o=0;o<Ib&&t.size()>0;o++){var s=t.pop(),u=s.key,l=s.eles[0],c=a.hasCache(l,s.level);if(n[u]=null,c)continue;i.push(s);var d=e.getBoundingBox(l);e.getElement(l,d,r,s.level,qi.dequeue)}return i};jt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(r),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=Eu,t.updateItem(a),t.pop(),n[i]=null):a.eles.unmerge(r))};jt.onDequeue=function(r){this.onDequeues.push(r)};jt.offDequeue=function(r){zn(this.onDequeues,r)};jt.setupDequeueing=lv.setupDequeueing({deqRedrawThreshold:Rb,deqCost:Ab,deqAvgCost:Db,deqNoDrawCost:Pb,deqFastCost:Ob,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(t)}},shouldRedraw:function(e,t,n,i){for(var a=0;a<t.length;a++)for(var o=t[a].eles,s=0;s<o.length;s++){var u=o[s].boundingBox();if(Mu(u,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Nb=1,Fa=-4,Ws=2,kb=3.99,Fb=50,Bb=50,Vb=.15,zb=.1,Gb=.9,jb=.9,Hb=1,Eh=250,Ub=4e3*4e3,_h=32767,$b=!0,cv=function(e){var t=this,n=t.renderer=e,i=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=hn()-2*Eh,t.skipping=!1,t.eleTxrDeqs=i.collection(),t.scheduleElementRefinement=eo(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},Bb),n.beforeRender(function(o,s){s-t.lastInvalidationTime<=Eh?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(s,u){return u.reqs-s.reqs};t.layersQueue=new to(a),t.setupDequeueing()},nr=cv.prototype,Th=0,Wb=Math.pow(2,53)-1;nr.makeLayer=function(r,e){var t=Math.pow(2,e),n=Math.ceil(r.w*t),i=Math.ceil(r.h*t),a=this.renderer.makeOffscreenCanvas(n,i),o={id:Th=++Th%Wb,bb:r,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,u=-o.bb.x1,l=-o.bb.y1;return s.scale(t,t),s.translate(u,l),o};nr.getLayers=function(r,e,t){var n=this,i=n.renderer,a=i.cy,o=a.zoom(),s=n.firstGet;if(n.firstGet=!1,t==null){if(t=Math.ceil(Su(o*e)),t<Fa)t=Fa;else if(o>=kb||t>Ws)return null}n.validateLayersElesOrdering(t,r);var u=n.layersByLevel,l=Math.pow(2,t),c=u[t]=u[t]||[],d,h=n.levelIsComplete(t,r),f,v=function(){var L=function(x){if(n.validateLayersElesOrdering(x,r),n.levelIsComplete(x,r))return f=u[x],!0},B=function(x){if(!f)for(var C=t+x;Fa<=C&&C<=Ws&&!L(C);C+=x);};B(1),B(-1);for(var w=c.length-1;w>=0;w--){var _=c[w];_.invalid&&zn(c,_)}};if(!h)v();else return c;var p=function(){if(!d){d=Er();for(var L=0;L<r.length;L++)af(d,r[L].boundingBox())}return d},m=function(L){L=L||{};var B=L.after;p();var w=Math.ceil(d.w*l),_=Math.ceil(d.h*l);if(w>_h||_>_h)return null;var E=w*_;if(E>Ub)return null;var x=n.makeLayer(d,t);if(B!=null){var C=c.indexOf(B)+1;c.splice(C,0,x)}else(L.insert===void 0||L.insert)&&c.unshift(x);return x};if(n.skipping&&!s)return null;for(var g=null,y=r.length/Nb,b=!s,S=0;S<r.length;S++){var A=r[S],P=A._private.rscratch,O=P.imgLayerCaches=P.imgLayerCaches||{},I=O[t];if(I){g=I;continue}if((!g||g.eles.length>=y||!of(g.bb,A.boundingBox()))&&(g=m({insert:!0,after:g}),!g))return null;f||b?n.queueLayer(g,A):n.drawEleInLayer(g,A,t,e),g.eles.push(A),O[t]=g}return f||(b?null:c)};nr.getEleLevelForLayerLevel=function(r,e){return r};nr.drawEleInLayer=function(r,e,t,n){var i=this,a=this.renderer,o=r.context,s=e.boundingBox();s.w===0||s.h===0||!e.visible()||(t=i.getEleLevelForLayerLevel(t,n),a.setImgSmoothing(o,!1),a.drawCachedElement(o,e,null,null,t,$b),a.setImgSmoothing(o,!0))};nr.levelIsComplete=function(r,e){var t=this,n=t.layersByLevel[r];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var o=n[a];if(o.reqs>0||o.invalid)return!1;i+=o.eles.length}return i===e.length};nr.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(t)for(var n=0;n<t.length;n++){for(var i=t[n],a=-1,o=0;o<e.length;o++)if(i.eles[0]===e[o]){a=o;break}if(a<0){this.invalidateLayer(i);continue}for(var s=a,o=0;o<i.eles.length;o++)if(i.eles[o]!==e[s+o]){this.invalidateLayer(i);break}}};nr.updateElementsInLayers=function(r,e){for(var t=this,n=Qa(r[0]),i=0;i<r.length;i++)for(var a=n?null:r[i],o=n?r[i]:r[i].ele,s=o._private.rscratch,u=s.imgLayerCaches=s.imgLayerCaches||{},l=Fa;l<=Ws;l++){var c=u[l];c&&(a&&t.getEleLevelForLayerLevel(c.level)!==a.level||e(c,o,a))}};nr.haveLayers=function(){for(var r=this,e=!1,t=Fa;t<=Ws;t++){var n=r.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e};nr.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=hn(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(n,i,a){e.invalidateLayer(n)}))};nr.invalidateLayer=function(r){if(this.lastInvalidationTime=hn(),!r.invalid){var e=r.level,t=r.eles,n=this.layersByLevel[e];zn(n,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var i=0;i<t.length;i++){var a=t[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};nr.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(n,i,a){var o=n.replacement;if(o||(o=n.replacement=e.makeLayer(n.bb,n.level),o.replaces=n,o.eles=n.eles),!o.reqs)for(var s=0;s<o.eles.length;s++)e.queueLayer(o,o.eles[s])})};nr.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};nr.queueLayer=function(r,e){var t=this,n=t.layersQueue,i=r.elesQueue,a=i.hasId=i.hasId||{};if(!r.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}r.reqs?(r.reqs++,n.updateItem(r)):(r.reqs=1,n.push(r))}};nr.dequeue=function(r){for(var e=this,t=e.layersQueue,n=[],i=0;i<Hb&&t.size()!==0;){var a=t.peek();if(a.replacement){t.pop();continue}if(a.replaces&&a!==a.replaces.replacement){t.pop();continue}if(a.invalid){t.pop();continue}var o=a.elesQueue.shift();o&&(e.drawEleInLayer(a,o,a.level,r),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(t.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};nr.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],n=r.replaces,i=t.indexOf(n);if(!(i<0||n.invalid)){t[i]=r;for(var a=0;a<r.eles.length;a++){var o=r.eles[a]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[r.level]=r)}e.requestRedraw()}};nr.requestRedraw=eo(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);nr.setupDequeueing=lv.setupDequeueing({deqRedrawThreshold:Fb,deqCost:Vb,deqAvgCost:zb,deqNoDrawCost:Gb,deqFastCost:jb,deq:function(e,t){return e.dequeue(t)},onDeqd:_u,shouldRedraw:Qh,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var dv={},Sh;function Yb(r,e){for(var t=0;t<e.length;t++){var n=e[t];r.lineTo(n.x,n.y)}}function qb(r,e,t){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),r.lineTo(a.x,a.y)}r.quadraticCurveTo(t.x,t.y,n.x,n.y)}function Mh(r,e,t){r.beginPath&&r.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];r.lineTo(a.x,a.y)}var o=t,s=t[0];r.moveTo(s.x,s.y);for(var i=1;i<o.length;i++){var a=o[i];r.lineTo(a.x,a.y)}r.closePath&&r.closePath()}function Xb(r,e,t,n,i){r.beginPath&&r.beginPath(),r.arc(t,n,i,0,Math.PI*2,!1);var a=e,o=a[0];r.moveTo(o.x,o.y);for(var s=0;s<a.length;s++){var u=a[s];r.lineTo(u.x,u.y)}r.closePath&&r.closePath()}function Kb(r,e,t,n){r.arc(e,t,n,0,Math.PI*2,!1)}dv.arrowShapeImpl=function(r){return(Sh||(Sh={polygon:Yb,"triangle-backcurve":qb,"triangle-tee":Mh,"circle-triangle":Xb,"triangle-cross":Mh,circle:Kb}))[r]};var an={};an.drawElement=function(r,e,t,n,i,a){var o=this;e.isNode()?o.drawNode(r,e,t,n,i,a):o.drawEdge(r,e,t,n,i,a)};an.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};an.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};an.drawCachedElementPortion=function(r,e,t,n,i,a,o,s){var u=this,l=t.getBoundingBox(e);if(!(l.w===0||l.h===0)){var c=t.getElement(e,l,n,i,a);if(c!=null){var d=s(u,e);if(d===0)return;var h=o(u,e),f=l.x1,v=l.y1,p=l.w,m=l.h,g,y,b,S,A;if(h!==0){var P=t.getRotationPoint(e);b=P.x,S=P.y,r.translate(b,S),r.rotate(h),A=u.getImgSmoothing(r),A||u.setImgSmoothing(r,!0);var O=t.getRotationOffset(e);g=O.x,y=O.y}else g=f,y=v;var I;d!==1&&(I=r.globalAlpha,r.globalAlpha=I*d),r.drawImage(c.texture.canvas,c.x,0,c.width,c.height,g,y,p,m),d!==1&&(r.globalAlpha=I),h!==0&&(r.rotate(-h),r.translate(-b,-S),A||u.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var Zb=function(){return 0},Qb=function(e,t){return e.getTextAngle(t,null)},Jb=function(e,t){return e.getTextAngle(t,"source")},ex=function(e,t){return e.getTextAngle(t,"target")},tx=function(e,t){return t.effectiveOpacity()},Ql=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};an.drawCachedElement=function(r,e,t,n,i,a){var o=this,s=o.data,u=s.eleTxrCache,l=s.lblTxrCache,c=s.slbTxrCache,d=s.tlbTxrCache,h=e.boundingBox(),f=a===!0?u.reasons.highQuality:null;if(!(h.w===0||h.h===0||!e.visible())&&(!n||Mu(h,n))){var v=e.isEdge(),p=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,u,t,i,f,Zb,tx),(!v||!p)&&o.drawCachedElementPortion(r,e,l,t,i,f,Qb,Ql),v&&!p&&(o.drawCachedElementPortion(r,e,c,t,i,f,Jb,Ql),o.drawCachedElementPortion(r,e,d,t,i,f,ex,Ql)),o.drawElementOverlay(r,e)}};an.drawElements=function(r,e){for(var t=this,n=0;n<e.length;n++){var i=e[n];t.drawElement(r,i)}};an.drawCachedElements=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];i.drawCachedElement(r,o,t,n)}};an.drawCachedNodes=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];o.isNode()&&i.drawCachedElement(r,o,t,n)}};an.drawLayeredElements=function(r,e,t,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,t);if(a)for(var o=0;o<a.length;o++){var s=a[o],u=s.bb;u.w===0||u.h===0||r.drawImage(s.canvas,u.x1,u.y1,u.w,u.h)}else i.drawCachedElements(r,e,t,n)};var gn={};gn.drawEdge=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s=e._private.rscratch;if(!(a&&!e.visible())&&!(s.badLine||s.allpts==null||isNaN(s.allpts[0]))){var u;t&&(u=t,r.translate(-u.x1,-u.y1));var l=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,h=e.pstyle("line-style").value,f=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,p=e.pstyle("line-outline-width").value,m=e.pstyle("line-outline-color").value,g=l*c,y=l*c,b=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;d==="straight-triangle"?(o.eleStrokeStyle(r,e,x),o.drawEdgeTrianglePath(e,r,s.allpts)):(r.lineWidth=f,r.lineCap=v,o.eleStrokeStyle(r,e,x),o.drawEdgePath(e,r,s.allpts,h),r.lineCap="butt")},S=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;if(r.lineWidth=f+p,r.lineCap=v,p>0)o.colorStrokeStyle(r,m[0],m[1],m[2],x);else{r.lineCap="butt";return}d==="straight-triangle"?o.drawEdgeTrianglePath(e,r,s.allpts):(o.drawEdgePath(e,r,s.allpts,h),r.lineCap="butt")},A=function(){i&&o.drawEdgeOverlay(r,e)},P=function(){i&&o.drawEdgeUnderlay(r,e)},O=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;o.drawArrowheads(r,e,x)},I=function(){o.drawElementText(r,e,null,n)};r.lineJoin="round";var R=e.pstyle("ghost").value==="yes";if(R){var L=e.pstyle("ghost-offset-x").pfValue,B=e.pstyle("ghost-offset-y").pfValue,w=e.pstyle("ghost-opacity").value,_=g*w;r.translate(L,B),b(_),O(_),r.translate(-L,-B)}else S();P(),b(),O(),A(),I(),t&&r.translate(u.x1,u.y1)}};var hv=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,o=a.usePaths(),s=n._private.rscratch,u=n.pstyle("".concat(e,"-padding")).pfValue,l=2*u,c=n.pstyle("".concat(e,"-color")).value;t.lineWidth=l,s.edgeType==="self"&&!o?t.lineCap="butt":t.lineCap="round",a.colorStrokeStyle(t,c[0],c[1],c[2],i),a.drawEdgePath(n,t,s.allpts,"solid")}}}};gn.drawEdgeOverlay=hv("overlay");gn.drawEdgeUnderlay=hv("underlay");gn.drawEdgePath=function(r,e,t,n){var i=r._private.rscratch,a=e,o,s=!1,u=this.usePaths(),l=r.pstyle("line-dash-pattern").pfValue,c=r.pstyle("line-dash-offset").pfValue;if(u){var d=t.join("$"),h=i.pathCacheKey&&i.pathCacheKey===d;h?(o=e=i.pathCache,s=!0):(o=e=new Path2D,i.pathCacheKey=d,i.pathCache=o)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(l),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!s&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var f=2;f+3<t.length;f+=4)e.quadraticCurveTo(t[f],t[f+1],t[f+2],t[f+3]);break;case"straight":case"haystack":for(var v=2;v+1<t.length;v+=2)e.lineTo(t[v],t[v+1]);break;case"segments":if(i.isRound){var p=Mr(i.roundCorners),m;try{for(p.s();!(m=p.n()).done;){var g=m.value;ev(e,g)}}catch(b){p.e(b)}finally{p.f()}e.lineTo(t[t.length-2],t[t.length-1])}else for(var y=2;y+1<t.length;y+=2)e.lineTo(t[y],t[y+1]);break}e=a,u?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};gn.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var n=r.pstyle("width").pfValue,i=0;i+1<t.length;i+=2){var a=[t[i+2]-t[i],t[i+3]-t[i+1]],o=Math.sqrt(a[0]*a[0]+a[1]*a[1]),s=[a[1]/o,-a[0]/o],u=[s[0]*n/2,s[1]*n/2];e.beginPath(),e.moveTo(t[i]-u[0],t[i+1]-u[1]),e.lineTo(t[i]+u[0],t[i+1]+u[1]),e.lineTo(t[i+2],t[i+3]),e.closePath(),e.fill()}};gn.drawArrowheads=function(r,e,t){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(r,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,t),i||this.drawArrowhead(r,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,t)};gn.drawArrowhead=function(r,e,t,n,i,a,o){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var s=this,u=e.pstyle(t+"-arrow-shape").value;if(u!=="none"){var l=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(t+"-arrow-fill").value,d=e.pstyle("width").pfValue,h=e.pstyle(t+"-arrow-width"),f=h.value==="match-line"?d:h.pfValue;h.units==="%"&&(f*=d);var v=e.pstyle("opacity").value;o===void 0&&(o=v);var p=r.globalCompositeOperation;(o!==1||c==="hollow")&&(r.globalCompositeOperation="destination-out",s.colorFillStyle(r,255,255,255,1),s.colorStrokeStyle(r,255,255,255,1),s.drawArrowShape(e,r,l,d,u,f,n,i,a),r.globalCompositeOperation=p);var m=e.pstyle(t+"-arrow-color").value;s.colorFillStyle(r,m[0],m[1],m[2],o),s.colorStrokeStyle(r,m[0],m[1],m[2],o),s.drawArrowShape(e,r,c,d,u,f,n,i,a)}}};gn.drawArrowShape=function(r,e,t,n,i,a,o,s,u){var l=this,c=this.usePaths()&&i!=="triangle-cross",d=!1,h,f=e,v={x:o,y:s},p=r.pstyle("arrow-scale").value,m=this.getArrowWidth(n,p),g=l.arrowShapes[i];if(c){var y=l.arrowPathCache=l.arrowPathCache||[],b=Vn(i),S=y[b];S!=null?(h=e=S,d=!0):(h=e=new Path2D,y[b]=h)}d||(e.beginPath&&e.beginPath(),c?g.draw(e,1,0,{x:0,y:0},1):g.draw(e,m,u,v,n),e.closePath&&e.closePath()),e=f,c&&(e.translate(o,s),e.rotate(u),e.scale(m,m)),(t==="filled"||t==="both")&&(c?e.fill(h):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=a/(c?m:1),e.lineJoin="miter",c?e.stroke(h):e.stroke()),c&&(e.scale(1/m,1/m),e.rotate(-u),e.translate(-o,-s))};var ju={};ju.safeDrawImage=function(r,e,t,n,i,a,o,s,u,l){if(!(i<=0||a<=0||u<=0||l<=0))try{r.drawImage(e,t,n,i,a,o,s,u,l)}catch(c){ft(c)}};ju.drawInscribedImage=function(r,e,t,n,i){var a=this,o=t.position(),s=o.x,u=o.y,l=t.cy().style(),c=l.getIndexedStyle.bind(l),d=c(t,"background-fit","value",n),h=c(t,"background-repeat","value",n),f=t.width(),v=t.height(),p=t.padding()*2,m=f+(c(t,"background-width-relative-to","value",n)==="inner"?0:p),g=v+(c(t,"background-height-relative-to","value",n)==="inner"?0:p),y=t._private.rscratch,b=c(t,"background-clip","value",n),S=b==="node",A=c(t,"background-image-opacity","value",n)*i,P=c(t,"background-image-smoothing","value",n),O=t.pstyle("corner-radius").value;O!=="auto"&&(O=t.pstyle("corner-radius").pfValue);var I=e.width||e.cachedW,R=e.height||e.cachedH;(I==null||R==null)&&(document.body.appendChild(e),I=e.cachedW=e.width||e.offsetWidth,R=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var L=I,B=R;if(c(t,"background-width","value",n)!=="auto"&&(c(t,"background-width","units",n)==="%"?L=c(t,"background-width","pfValue",n)*m:L=c(t,"background-width","pfValue",n)),c(t,"background-height","value",n)!=="auto"&&(c(t,"background-height","units",n)==="%"?B=c(t,"background-height","pfValue",n)*g:B=c(t,"background-height","pfValue",n)),!(L===0||B===0)){if(d==="contain"){var w=Math.min(m/L,g/B);L*=w,B*=w}else if(d==="cover"){var w=Math.max(m/L,g/B);L*=w,B*=w}var _=s-m/2,E=c(t,"background-position-x","units",n),x=c(t,"background-position-x","pfValue",n);E==="%"?_+=(m-L)*x:_+=x;var C=c(t,"background-offset-x","units",n),T=c(t,"background-offset-x","pfValue",n);C==="%"?_+=(m-L)*T:_+=T;var M=u-g/2,D=c(t,"background-position-y","units",n),F=c(t,"background-position-y","pfValue",n);D==="%"?M+=(g-B)*F:M+=F;var N=c(t,"background-offset-y","units",n),z=c(t,"background-offset-y","pfValue",n);N==="%"?M+=(g-B)*z:M+=z,y.pathCache&&(_-=s,M-=u,s=0,u=0);var q=r.globalAlpha;r.globalAlpha=A;var $=a.getImgSmoothing(r),ee=!1;if(P==="no"&&$?(a.setImgSmoothing(r,!1),ee=!0):P==="yes"&&!$&&(a.setImgSmoothing(r,!0),ee=!0),h==="no-repeat")S&&(r.save(),y.pathCache?r.clip(y.pathCache):(a.nodeShapes[a.getNodeShape(t)].draw(r,s,u,m,g,O,y),r.clip())),a.safeDrawImage(r,e,0,0,I,R,_,M,L,B),S&&r.restore();else{var J=r.createPattern(e,h);r.fillStyle=J,a.nodeShapes[a.getNodeShape(t)].draw(r,s,u,m,g,O,y),r.translate(_,M),r.fill(),r.translate(-_,-M)}r.globalAlpha=q,ee&&a.setImgSmoothing(r,$)}};var fi={};fi.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(Su(t*n));e=Math.pow(2,i)}var a=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(a<o)};fi.drawElementText=function(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(n==null){if(a&&!o.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var s=e.pstyle("label");if(!s||!s.value)return;var u=o.getLabelJustification(e);r.textAlign=u,r.textBaseline="bottom"}else{var l=e.element()._private.rscratch.badLine,c=e.pstyle("label"),d=e.pstyle("source-label"),h=e.pstyle("target-label");if(l||(!c||!c.value)&&(!d||!d.value)&&(!h||!h.value))return;r.textAlign="center",r.textBaseline="bottom"}var f=!t,v;t&&(v=t,r.translate(-v.x1,-v.y1)),i==null?(o.drawText(r,e,null,f,a),e.isEdge()&&(o.drawText(r,e,"source",f,a),o.drawText(r,e,"target",f,a))):o.drawText(r,e,i,f,a),t&&r.translate(v.x1,v.y1)};fi.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};fi.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,u=e.pstyle("text-outline-opacity").value*s,l=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;r.font=n+" "+o+" "+i+" "+a,r.lineJoin="round",this.colorFillStyle(r,l[0],l[1],l[2],s),this.colorStrokeStyle(r,c[0],c[1],c[2],u)};function Jl(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0;r.beginPath(),r.moveTo(e+a,t),r.lineTo(e+n-a,t),r.quadraticCurveTo(e+n,t,e+n,t+a),r.lineTo(e+n,t+i-a),r.quadraticCurveTo(e+n,t+i,e+n-a,t+i),r.lineTo(e+a,t+i),r.quadraticCurveTo(e,t+i,e,t+i-a),r.lineTo(e,t+a),r.quadraticCurveTo(e,t,e+a,t),r.closePath(),o?r.stroke():r.fill()}fi.getTextAngle=function(r,e){var t,n=r._private,i=n.rscratch,a=e?e+"-":"",o=r.pstyle(a+"text-rotation");if(o.strValue==="autorotate"){var s=Gr(i,"labelAngle",e);t=r.isEdge()?s:0}else o.strValue==="none"?t=0:t=o.pfValue;return t};fi.drawText=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,o=a.rscratch,s=i?e.effectiveOpacity():1;if(!(i&&(s===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var u=Gr(o,"labelX",t),l=Gr(o,"labelY",t),c,d,h=this.getLabelText(e,t);if(h!=null&&h!==""&&!isNaN(u)&&!isNaN(l)){this.setupTextStyle(r,e,i);var f=t?t+"-":"",v=Gr(o,"labelWidth",t),p=Gr(o,"labelHeight",t),m=e.pstyle(f+"text-margin-x").pfValue,g=e.pstyle(f+"text-margin-y").pfValue,y=e.isEdge(),b=e.pstyle("text-halign").value,S=e.pstyle("text-valign").value;y&&(b="center",S="center"),u+=m,l+=g;var A;switch(n?A=this.getTextAngle(e,t):A=0,A!==0&&(c=u,d=l,r.translate(c,d),r.rotate(A),u=0,l=0),S){case"top":break;case"center":l+=p/2;break;case"bottom":l+=p;break}var P=e.pstyle("text-background-opacity").value,O=e.pstyle("text-border-opacity").value,I=e.pstyle("text-border-width").pfValue,R=e.pstyle("text-background-padding").pfValue,L=e.pstyle("text-background-shape").strValue,B=L.indexOf("round")===0,w=2;if(P>0||I>0&&O>0){var _=u-R;switch(b){case"left":_-=v;break;case"center":_-=v/2;break}var E=l-p-R,x=v+2*R,C=p+2*R;if(P>0){var T=r.fillStyle,M=e.pstyle("text-background-color").value;r.fillStyle="rgba("+M[0]+","+M[1]+","+M[2]+","+P*s+")",B?Jl(r,_,E,x,C,w):r.fillRect(_,E,x,C),r.fillStyle=T}if(I>0&&O>0){var D=r.strokeStyle,F=r.lineWidth,N=e.pstyle("text-border-color").value,z=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+N[0]+","+N[1]+","+N[2]+","+O*s+")",r.lineWidth=I,r.setLineDash)switch(z){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=I/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(B?Jl(r,_,E,x,C,w,"stroke"):r.strokeRect(_,E,x,C),z==="double"){var q=I/2;B?Jl(r,_+q,E+q,x-q*2,C-q*2,w,"stroke"):r.strokeRect(_+q,E+q,x-q*2,C-q*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=F,r.strokeStyle=D}}var $=2*e.pstyle("text-outline-width").pfValue;if($>0&&(r.lineWidth=$),e.pstyle("text-wrap").value==="wrap"){var ee=Gr(o,"labelWrapCachedLines",t),J=Gr(o,"labelLineHeight",t),j=v/2,Z=this.getLabelJustification(e);switch(Z==="auto"||(b==="left"?Z==="left"?u+=-v:Z==="center"&&(u+=-j):b==="center"?Z==="left"?u+=-j:Z==="right"&&(u+=j):b==="right"&&(Z==="center"?u+=j:Z==="right"&&(u+=v))),S){case"top":l-=(ee.length-1)*J;break;case"center":case"bottom":l-=(ee.length-1)*J;break}for(var H=0;H<ee.length;H++)$>0&&r.strokeText(ee[H],u,l),r.fillText(ee[H],u,l),l+=J}else $>0&&r.strokeText(h,u,l),r.fillText(h,u,l);A!==0&&(r.rotate(-A),r.translate(-c,-d))}}};var ha={};ha.drawNode=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s,u,l=e._private,c=l.rscratch,d=e.position();if(!(!Ne(d.x)||!Ne(d.y))&&!(a&&!e.visible())){var h=a?e.effectiveOpacity():1,f=o.usePaths(),v,p=!1,m=e.padding();s=e.width()+2*m,u=e.height()+2*m;var g;t&&(g=t,r.translate(-g.x1,-g.y1));for(var y=e.pstyle("background-image"),b=y.value,S=new Array(b.length),A=new Array(b.length),P=0,O=0;O<b.length;O++){var I=b[O],R=S[O]=I!=null&&I!=="none";if(R){var L=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",O);P++,A[O]=o.getCachedImage(I,L,function(){l.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var B=e.pstyle("background-blacken").value,w=e.pstyle("border-width").pfValue,_=e.pstyle("background-opacity").value*h,E=e.pstyle("border-color").value,x=e.pstyle("border-style").value,C=e.pstyle("border-join").value,T=e.pstyle("border-cap").value,M=e.pstyle("border-position").value,D=e.pstyle("border-dash-pattern").pfValue,F=e.pstyle("border-dash-offset").pfValue,N=e.pstyle("border-opacity").value*h,z=e.pstyle("outline-width").pfValue,q=e.pstyle("outline-color").value,$=e.pstyle("outline-style").value,ee=e.pstyle("outline-opacity").value*h,J=e.pstyle("outline-offset").value,j=e.pstyle("corner-radius").value;j!=="auto"&&(j=e.pstyle("corner-radius").pfValue);var Z=function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_;o.eleFillStyle(r,e,Y)},H=function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;o.colorStrokeStyle(r,E[0],E[1],E[2],Y)},k=function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ee;o.colorStrokeStyle(r,q[0],q[1],q[2],Y)},G=function(Y,Q,oe,ne){var se=o.nodePathCache=o.nodePathCache||[],ve=Zh(oe==="polygon"?oe+","+ne.join(","):oe,""+Q,""+Y,""+j),Re=se[ve],we,pe=!1;return Re!=null?(we=Re,pe=!0,c.pathCache=we):(we=new Path2D,se[ve]=c.pathCache=we),{path:we,cacheHit:pe}},W=e.pstyle("shape").strValue,te=e.pstyle("shape-polygon-points").pfValue;if(f){r.translate(d.x,d.y);var X=G(s,u,W,te);v=X.path,p=X.cacheHit}var me=function(){if(!p){var Y=d;f&&(Y={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(v||r,Y.x,Y.y,s,u,j,c)}f?r.fill(v):r.fill()},Te=function(){for(var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,oe=l.backgrounding,ne=0,se=0;se<A.length;se++){var ve=e.cy().style().getIndexedStyle(e,"background-image-containment","value",se);if(Q&&ve==="over"||!Q&&ve==="inside"){ne++;continue}S[se]&&A[se].complete&&!A[se].error&&(ne++,o.drawInscribedImage(r,A[se],e,se,Y))}l.backgrounding=ne!==P,oe!==l.backgrounding&&e.updateStyle(!1)},fe=function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;o.hasPie(e)&&(o.drawPie(r,e,Q),Y&&(f||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,s,u,j,c)))},ue=function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,Q=(B>0?B:-B)*Y,oe=B>0?0:255;B!==0&&(o.colorFillStyle(r,oe,oe,oe,Q),f?r.fill(v):r.fill())},de=function(){if(w>0){if(r.lineWidth=w,r.lineCap=T,r.lineJoin=C,r.setLineDash)switch(x){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(D),r.lineDashOffset=F;break;case"solid":case"double":r.setLineDash([]);break}if(M!=="center"){if(r.save(),r.lineWidth*=2,M==="inside")f?r.clip(v):r.clip();else{var Y=new Path2D;Y.rect(-s/2-w,-u/2-w,s+2*w,u+2*w),Y.addPath(v),r.clip(Y,"evenodd")}f?r.stroke(v):r.stroke(),r.restore()}else f?r.stroke(v):r.stroke();if(x==="double"){r.lineWidth=w/3;var Q=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",f?r.stroke(v):r.stroke(),r.globalCompositeOperation=Q}r.setLineDash&&r.setLineDash([])}},ye=function(){if(z>0){if(r.lineWidth=z,r.lineCap="butt",r.setLineDash)switch($){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var Y=d;f&&(Y={x:0,y:0});var Q=o.getNodeShape(e),oe=w;M==="inside"&&(oe=0),M==="outside"&&(oe*=2);var ne=(s+oe+(z+J))/s,se=(u+oe+(z+J))/u,ve=s*ne,Re=u*se,we=o.nodeShapes[Q].points,pe;if(f){var Me=G(ve,Re,Q,we);pe=Me.path}if(Q==="ellipse")o.drawEllipsePath(pe||r,Y.x,Y.y,ve,Re);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(Q)){var Ae=0,Ie=0,Ve=0;Q==="round-diamond"?Ae=(oe+J+z)*1.4:Q==="round-heptagon"?(Ae=(oe+J+z)*1.075,Ve=-(oe/2+J+z)/35):Q==="round-hexagon"?Ae=(oe+J+z)*1.12:Q==="round-pentagon"?(Ae=(oe+J+z)*1.13,Ve=-(oe/2+J+z)/15):Q==="round-tag"?(Ae=(oe+J+z)*1.12,Ie=(oe/2+z+J)*.07):Q==="round-triangle"&&(Ae=(oe+J+z)*(Math.PI/2),Ve=-(oe+J/2+z)/Math.PI),Ae!==0&&(ne=(s+Ae)/s,ve=s*ne,["round-hexagon","round-tag"].includes(Q)||(se=(u+Ae)/u,Re=u*se)),j=j==="auto"?uf(ve,Re):j;for(var Ke=ve/2,ze=Re/2,Le=j+(oe+z+J)/2,He=new Array(we.length/2),Be=new Array(we.length/2),Ge=0;Ge<we.length/2;Ge++)He[Ge]={x:Y.x+Ie+Ke*we[Ge*2],y:Y.y+Ve+ze*we[Ge*2+1]};var it,at,mt,et,Ze=He.length;for(at=He[Ze-1],it=0;it<Ze;it++)mt=He[it%Ze],et=He[(it+1)%Ze],Be[it]=zu(at,mt,et,Le),at=mt,mt=et;o.drawRoundPolygonPath(pe||r,Y.x+Ie,Y.y+Ve,s*ne,u*se,we,Be)}else if(["roundrectangle","round-rectangle"].includes(Q))j=j==="auto"?li(ve,Re):j,o.drawRoundRectanglePath(pe||r,Y.x,Y.y,ve,Re,j+(oe+z+J)/2);else if(["cutrectangle","cut-rectangle"].includes(Q))j=j==="auto"?Au():j,o.drawCutRectanglePath(pe||r,Y.x,Y.y,ve,Re,null,j+(oe+z+J)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(Q))j=j==="auto"?li(ve,Re):j,o.drawBottomRoundRectanglePath(pe||r,Y.x,Y.y,ve,Re,j+(oe+z+J)/2);else if(Q==="barrel")o.drawBarrelPath(pe||r,Y.x,Y.y,ve,Re);else if(Q.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(Q)){var It=(oe+z+J)/s;we=Vs(zs(we,It)),o.drawPolygonPath(pe||r,Y.x,Y.y,s,u,we)}else{var Je=(oe+z+J)/s;we=Vs(zs(we,-Je)),o.drawPolygonPath(pe||r,Y.x,Y.y,s,u,we)}if(f?r.stroke(pe):r.stroke(),$==="double"){r.lineWidth=oe/3;var st=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",f?r.stroke(pe):r.stroke(),r.globalCompositeOperation=st}r.setLineDash&&r.setLineDash([])}},Se=function(){i&&o.drawNodeOverlay(r,e,d,s,u)},xe=function(){i&&o.drawNodeUnderlay(r,e,d,s,u)},Ce=function(){o.drawElementText(r,e,null,n)},_e=e.pstyle("ghost").value==="yes";if(_e){var be=e.pstyle("ghost-offset-x").pfValue,he=e.pstyle("ghost-offset-y").pfValue,V=e.pstyle("ghost-opacity").value,re=V*h;r.translate(be,he),k(),ye(),Z(V*_),me(),Te(re,!0),H(V*N),de(),fe(B!==0||w!==0),Te(re,!1),ue(re),r.translate(-be,-he)}f&&r.translate(-d.x,-d.y),xe(),f&&r.translate(d.x,d.y),k(),ye(),Z(),me(),Te(h,!0),H(),de(),fe(B!==0||w!==0),Te(h,!1),ue(),f&&r.translate(-d.x,-d.y),Ce(),Se(),t&&r.translate(g.x1,g.y1)}};var fv=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,i,a,o){var s=this;if(n.visible()){var u=n.pstyle("".concat(e,"-padding")).pfValue,l=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,d=n.pstyle("".concat(e,"-shape")).value,h=n.pstyle("".concat(e,"-corner-radius")).value;if(l>0){if(i=i||n.position(),a==null||o==null){var f=n.padding();a=n.width()+2*f,o=n.height()+2*f}s.colorFillStyle(t,c[0],c[1],c[2],l),s.nodeShapes[d].draw(t,i.x,i.y,a+u*2,o+u*2,h),t.fill()}}}};ha.drawNodeOverlay=fv("overlay");ha.drawNodeUnderlay=fv("underlay");ha.hasPie=function(r){return r=r[0],r._private.hasPie};ha.drawPie=function(r,e,t,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),o=n.x,s=n.y,u=e.width(),l=e.height(),c=Math.min(u,l)/2,d=0,h=this.usePaths();h&&(o=0,s=0),a.units==="%"?c=c*a.pfValue:a.pfValue!==void 0&&(c=a.pfValue/2);for(var f=1;f<=i.pieBackgroundN;f++){var v=e.pstyle("pie-"+f+"-background-size").value,p=e.pstyle("pie-"+f+"-background-color").value,m=e.pstyle("pie-"+f+"-background-opacity").value*t,g=v/100;g+d>1&&(g=1-d);var y=1.5*Math.PI+2*Math.PI*d,b=2*Math.PI*g,S=y+b;v===0||d>=1||d+g>1||(r.beginPath(),r.moveTo(o,s),r.arc(o,s,c,y,S),r.closePath(),this.colorFillStyle(r,p[0],p[1],p[2],m),r.fill(),d+=g)}};var gr={},rx=100;gr.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),t=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/t};gr.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===r){t=!1;break}return t&&(n={context:r},e.push(n)),n};gr.createGradientStyleFor=function(r,e,t,n,i){var a,o=this.usePaths(),s=t.pstyle(e+"-gradient-stop-colors").value,u=t.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(t.isEdge()){var l=t.sourceEndpoint(),c=t.targetEndpoint(),d=t.midpoint(),h=si(l,d),f=si(c,d);a=r.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(h,f))}else{var v=o?{x:0,y:0}:t.position(),p=t.paddedWidth(),m=t.paddedHeight();a=r.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(p,m))}else if(t.isEdge()){var g=t.sourceEndpoint(),y=t.targetEndpoint();a=r.createLinearGradient(g.x,g.y,y.x,y.y)}else{var b=o?{x:0,y:0}:t.position(),S=t.paddedWidth(),A=t.paddedHeight(),P=S/2,O=A/2,I=t.pstyle("background-gradient-direction").value;switch(I){case"to-bottom":a=r.createLinearGradient(b.x,b.y-O,b.x,b.y+O);break;case"to-top":a=r.createLinearGradient(b.x,b.y+O,b.x,b.y-O);break;case"to-left":a=r.createLinearGradient(b.x+P,b.y,b.x-P,b.y);break;case"to-right":a=r.createLinearGradient(b.x-P,b.y,b.x+P,b.y);break;case"to-bottom-right":case"to-right-bottom":a=r.createLinearGradient(b.x-P,b.y-O,b.x+P,b.y+O);break;case"to-top-right":case"to-right-top":a=r.createLinearGradient(b.x-P,b.y+O,b.x+P,b.y-O);break;case"to-bottom-left":case"to-left-bottom":a=r.createLinearGradient(b.x+P,b.y-O,b.x-P,b.y+O);break;case"to-top-left":case"to-left-top":a=r.createLinearGradient(b.x+P,b.y+O,b.x-P,b.y-O);break}}if(!a)return null;for(var R=u.length===s.length,L=s.length,B=0;B<L;B++)a.addColorStop(R?u[B]:B/(L-1),"rgba("+s[B][0]+","+s[B][1]+","+s[B][2]+","+i+")");return a};gr.gradientFillStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"background",e,t,n);if(!i)return null;r.fillStyle=i};gr.colorFillStyle=function(r,e,t,n,i){r.fillStyle="rgba("+e+","+t+","+n+","+i+")"};gr.eleFillStyle=function(r,e,t){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(r,e,n,t);else{var i=e.pstyle("background-color").value;this.colorFillStyle(r,i[0],i[1],i[2],t)}};gr.gradientStrokeStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"line",e,t,n);if(!i)return null;r.strokeStyle=i};gr.colorStrokeStyle=function(r,e,t,n,i){r.strokeStyle="rgba("+e+","+t+","+n+","+i+")"};gr.eleStrokeStyle=function(r,e,t){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(r,e,n,t);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(r,i[0],i[1],i[2],t)}};gr.matchCanvasSize=function(r){var e=this,t=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],o=e.getPixelRatio(),s=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var u=i*o,l=a*o,c;if(!(u===e.canvasWidth&&l===e.canvasHeight)){e.fontCaches=null;var d=t.canvasContainer;d.style.width=i+"px",d.style.height=a+"px";for(var h=0;h<e.CANVAS_LAYERS;h++)c=t.canvases[h],c.width=u,c.height=l,c.style.width=i+"px",c.style.height=a+"px";for(var h=0;h<e.BUFFER_COUNT;h++)c=t.bufferCanvases[h],c.width=u,c.height=l,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,o<=1&&(c=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=u*e.textureMult,c.height=l*e.textureMult),e.canvasWidth=u,e.canvasHeight=l,e.pixelRatio=o}};gr.renderTo=function(r,e,t,n){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:n})};gr.clearCanvas=function(){var r=this,e=r.data;function t(n){n.clearRect(0,0,r.canvasWidth,r.canvasHeight)}t(e.contexts[r.NODE]),t(e.contexts[r.DRAG])};gr.render=function(r){var e=this;r=r||tf();var t=e.cy,n=r.forcedContext,i=r.drawAllLayers,a=r.drawOnlyNodeLayer,o=r.forcedZoom,s=r.forcedPan,u=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,l=e.data,c=l.canvasNeedsRedraw,d=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),h=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,f=e.motionBlurPxRatio,v=t.hasCompoundNodes(),p=e.hoverData.draggingEles,m=!!(e.hoverData.selecting||e.touchData.selecting);h=h&&!n&&e.motionBlurEnabled&&!m;var g=h;n||(e.prevPxRatio!==u&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=u),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),h&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(g=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var y=t.style(),b=t.zoom(),S=o!==void 0?o:b,A=t.pan(),P={x:A.x,y:A.y},O={zoom:b,pan:{x:A.x,y:A.y}},I=e.prevViewport,R=I===void 0||O.zoom!==I.zoom||O.pan.x!==I.pan.x||O.pan.y!==I.pan.y;!R&&!(p&&!v)&&(e.motionBlurPxRatio=1),s&&(P=s),S*=u,P.x*=u,P.y*=u;var L=e.getCachedZSortedEles();function B(H,k,G,W,te){var X=H.globalCompositeOperation;H.globalCompositeOperation="destination-out",e.colorFillStyle(H,255,255,255,e.motionBlurTransparency),H.fillRect(k,G,W,te),H.globalCompositeOperation=X}function w(H,k){var G,W,te,X;!e.clearingMotionBlur&&(H===l.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||H===l.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(G={x:A.x*f,y:A.y*f},W=b*f,te=e.canvasWidth*f,X=e.canvasHeight*f):(G=P,W=S,te=e.canvasWidth,X=e.canvasHeight),H.setTransform(1,0,0,1,0,0),k==="motionBlur"?B(H,0,0,te,X):!n&&(k===void 0||k)&&H.clearRect(0,0,te,X),i||(H.translate(G.x,G.y),H.scale(W,W)),s&&H.translate(s.x,s.y),o&&H.scale(o,o)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=t.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var _=e.data.bufferContexts[e.TEXTURE_BUFFER];_.setTransform(1,0,0,1,0,0),_.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:_,drawOnlyNodeLayer:!0,forcedPxRatio:u*e.textureMult});var O=e.textureCache.viewport={zoom:t.zoom(),pan:t.pan(),width:e.canvasWidth,height:e.canvasHeight};O.mpan={x:(0-O.pan.x)/O.zoom,y:(0-O.pan.y)/O.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var E=l.contexts[e.NODE],x=e.textureCache.texture,O=e.textureCache.viewport;E.setTransform(1,0,0,1,0,0),h?B(E,0,0,O.width,O.height):E.clearRect(0,0,O.width,O.height);var C=y.core("outside-texture-bg-color").value,T=y.core("outside-texture-bg-opacity").value;e.colorFillStyle(E,C[0],C[1],C[2],T),E.fillRect(0,0,O.width,O.height);var b=t.zoom();w(E,!1),E.clearRect(O.mpan.x,O.mpan.y,O.width/O.zoom/u,O.height/O.zoom/u),E.drawImage(x,O.mpan.x,O.mpan.y,O.width/O.zoom/u,O.height/O.zoom/u)}else e.textureOnViewport&&!n&&(e.textureCache=null);var M=t.extent(),D=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),F=e.hideEdgesOnViewport&&D,N=[];if(N[e.NODE]=!c[e.NODE]&&h&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,N[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),N[e.DRAG]=!c[e.DRAG]&&h&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,N[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||N[e.NODE]){var z=h&&!N[e.NODE]&&f!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:l.contexts[e.NODE]),q=h&&!z?"motionBlur":void 0;w(E,q),F?e.drawCachedNodes(E,L.nondrag,u,M):e.drawLayeredElements(E,L.nondrag,u,M),e.debug&&e.drawDebugPoints(E,L.nondrag),!i&&!h&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||N[e.DRAG])){var z=h&&!N[e.DRAG]&&f!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:l.contexts[e.DRAG]);w(E,h&&!z?"motionBlur":void 0),F?e.drawCachedNodes(E,L.drag,u,M):e.drawCachedElements(E,L.drag,u,M),e.debug&&e.drawDebugPoints(E,L.drag),!i&&!h&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,w),h&&f!==1){var $=l.contexts[e.NODE],ee=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],J=l.contexts[e.DRAG],j=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],Z=function(k,G,W){k.setTransform(1,0,0,1,0,0),W||!g?k.clearRect(0,0,e.canvasWidth,e.canvasHeight):B(k,0,0,e.canvasWidth,e.canvasHeight);var te=f;k.drawImage(G,0,0,e.canvasWidth*te,e.canvasHeight*te,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||N[e.NODE])&&(Z($,ee,N[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||N[e.DRAG])&&(Z(J,j,N[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=O,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),h&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},rx)),n||t.emit("render")};var Da;gr.drawSelectionRectangle=function(r,e){var t=this,n=t.cy,i=t.data,a=n.style(),o=r.drawOnlyNodeLayer,s=r.drawAllLayers,u=i.canvasNeedsRedraw,l=r.forcedContext;if(t.showFps||!o&&u[t.SELECT_BOX]&&!s){var c=l||i.contexts[t.SELECT_BOX];if(e(c),t.selection[4]==1&&(t.hoverData.selecting||t.touchData.selecting)){var d=t.cy.zoom(),h=a.core("selection-box-border-width").value/d;c.lineWidth=h,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]),h>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]))}if(i.bgActivePosistion&&!t.hoverData.selecting){var d=t.cy.zoom(),f=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(f.x,f.y,a.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var v=t.lastRedrawTime;if(t.showFps&&v){v=Math.round(v);var p=Math.round(1e3/v),m="1 frame = "+v+" ms = "+p+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!Da){var g=c.measureText(m);Da=g.actualBoundingBoxAscent}c.fillText(m,0,Da);var y=60;c.strokeRect(0,Da+10,250,20),c.fillRect(0,Da+10,250*Math.min(p/y,1),20)}s||(u[t.SELECT_BOX]=!1)}};function Ah(r,e,t){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(n));return n}function nx(r,e,t){var n=Ah(r,r.VERTEX_SHADER,e),i=Ah(r,r.FRAGMENT_SHADER,t),a=r.createProgram();if(r.attachShader(a,n),r.attachShader(a,i),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function ix(r,e,t){t===void 0&&(t=e);var n=r.makeOffscreenCanvas(e,t),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function Hu(r){var e=r.pixelRatio,t=r.cy.zoom(),n=r.cy.pan();return{zoom:t*e,pan:{x:n.x*e,y:n.y*e}}}function eu(r,e,t,n,i){var a=n*t+e.x,o=i*t+e.y;return o=Math.round(r.canvasHeight-o),[a,o]}function Ts(r,e,t){var n=r[0]/255,i=r[1]/255,a=r[2]/255,o=e,s=t||new Array(4);return s[0]=n*o,s[1]=i*o,s[2]=a*o,s[3]=o,s}function Ss(r,e){var t=e||new Array(4);return t[0]=(r>>0&255)/255,t[1]=(r>>8&255)/255,t[2]=(r>>16&255)/255,t[3]=(r>>24&255)/255,t}function ax(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function ox(r,e){var t=r.createTexture();return t.buffer=function(n){r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},t.deleteTexture=function(){r.deleteTexture(t)},t}function vv(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function pv(r,e,t){switch(e){case r.FLOAT:return new Float32Array(t);case r.INT:return new Int32Array(t)}}function sx(r,e,t,n,i,a){switch(e){case r.FLOAT:return new Float32Array(t.buffer,a*n,i);case r.INT:return new Int32Array(t.buffer,a*n,i)}}function lx(r,e,t,n){var i=vv(r,e),a=Bt(i,2),o=a[0],s=a[1],u=pv(r,s,n),l=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,u,r.STATIC_DRAW),s===r.FLOAT?r.vertexAttribPointer(t,o,s,!1,0,0):s===r.INT&&r.vertexAttribIPointer(t,o,s,0,0),r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,null),l}function Sr(r,e,t,n){var i=vv(r,t),a=Bt(i,3),o=a[0],s=a[1],u=a[2],l=pv(r,s,e*o),c=o*u,d=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,d),r.bufferData(r.ARRAY_BUFFER,e*c,r.DYNAMIC_DRAW),r.enableVertexAttribArray(n),s===r.FLOAT?r.vertexAttribPointer(n,o,s,!1,c,0):s===r.INT&&r.vertexAttribIPointer(n,o,s,c,0),r.vertexAttribDivisor(n,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var h=new Array(e),f=0;f<e;f++)h[f]=sx(r,s,l,c,o,f);return d.dataArray=l,d.stride=c,d.size=o,d.getView=function(v){return h[v]},d.setPoint=function(v,p,m){var g=h[v];g[0]=p,g[1]=m},d.bufferSubData=function(v){r.bindBuffer(r.ARRAY_BUFFER,d),v?r.bufferSubData(r.ARRAY_BUFFER,0,l,0,v*o):r.bufferSubData(r.ARRAY_BUFFER,0,l)},d}function ux(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,i,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var Dh=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function Ba(){var r=new Dh(9);return Dh!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function gv(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function cx(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=t[0],f=t[1],v=t[2],p=t[3],m=t[4],g=t[5],y=t[6],b=t[7],S=t[8];return r[0]=h*n+f*o+v*l,r[1]=h*i+f*s+v*c,r[2]=h*a+f*u+v*d,r[3]=p*n+m*o+g*l,r[4]=p*i+m*s+g*c,r[5]=p*a+m*u+g*d,r[6]=y*n+b*o+S*l,r[7]=y*i+b*s+S*c,r[8]=y*a+b*u+S*d,r}function Ys(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=t[0],f=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r[4]=s,r[5]=u,r[6]=h*n+f*o+l,r[7]=h*i+f*s+c,r[8]=h*a+f*u+d,r}function mv(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=Math.sin(t),f=Math.cos(t);return r[0]=f*n+h*o,r[1]=f*i+h*s,r[2]=f*a+h*u,r[3]=f*o-h*n,r[4]=f*s-h*i,r[5]=f*u-h*a,r[6]=l,r[7]=c,r[8]=d,r}function Uu(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function dx(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var Va={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},Pa=Jt({getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:null,getPadding:null}),hx=function(){function r(e,t){Un(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.atlasSize=t.webglTexSize,this.rows=t.webglTexRows,this.enableWrapping=t.enableWrapping,this.texHeight=Math.floor(this.atlasSize/this.rows),this.maxTexWidth=this.atlasSize,this.texture=null,this.canvas=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=t.createTextureCanvas(e,this.atlasSize,this.atlasSize),this.scratch=t.createTextureCanvas(e,this.atlasSize,this.texHeight,"scratch")}return $n(r,[{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(t){var n=t.w,i=t.h,a=this.texHeight,o=this.maxTexWidth,s=a/i,u=n*s,l=i*s;return u>o&&(s=o/n,u=n*s,l=i*s),{scale:s,texW:u,texH:l}}},{key:"draw",value:function(t,n,i){var a=this,o=this.atlasSize,s=this.rows,u=this.texHeight,l=this.getScale(n),c=l.scale,d=l.texW,h=l.texH,f=[null,null],v=function(b,S){if(i&&S){var A=S.context,P=b.x,O=b.row,I=P,R=u*O;A.save(),A.translate(I,R),A.scale(c,c),i(A,n),A.restore()}},p=function(){v(a.freePointer,a.canvas),f[0]={x:a.freePointer.x,y:a.freePointer.row*u,w:d,h},f[1]={x:a.freePointer.x+d,y:a.freePointer.row*u,w:0,h},a.freePointer.x+=d,a.freePointer.x==o&&(a.freePointer.x=0,a.freePointer.row++)},m=function(){var b=a.scratch,S=a.canvas;b.clear(),v({x:0,row:0},b);var A=o-a.freePointer.x,P=d-A,O=u;{var I=a.freePointer.x,R=a.freePointer.row*u,L=A;S.context.drawImage(b,0,0,L,O,I,R,L,O),f[0]={x:I,y:R,w:L,h}}{var B=A,w=(a.freePointer.row+1)*u,_=P;S&&S.context.drawImage(b,B,0,_,O,0,w,_,O),f[1]={x:0,y:w,w:_,h}}a.freePointer.x=P,a.freePointer.row++},g=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+d<=o)p();else{if(this.freePointer.row>=s-1)return!1;this.freePointer.x===o?(g(),p()):this.enableWrapping?m():(g(),p())}return this.keyToLocation.set(t,f),this.needsBuffer=!0,f}},{key:"getOffsets",value:function(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(t){var n=this.atlasSize,i=this.rows,a=this.getScale(t),o=a.texW;return this.freePointer.x+o>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(t){this.texture||(this.texture=ox(t,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1)}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null,this.needsBuffer=!0)}}]),r}(),fx=function(){function r(e,t){Un(this,r),this.r=e,this.opts=t,this.keyToIds=new Map,this.idToKey=new Map,this.atlases=[],this.styleKeyToAtlas=new Map,this.styleKeyNeedsRedraw=new Set,this.forceGC=!1}return $n(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"getIdsFor",value:function(t){var n=this.keyToIds.get(t);return n||(n=new Set,this.keyToIds.set(t,n)),n}},{key:"_createAtlas",value:function(){var t=this.r,n=this.opts;return new hx(t,n)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var t=this.r,n=this.opts,i=n.webglTexSize,a=Math.floor(i/n.webglTexRows);this.scratch=n.createTextureCanvas(t,i,a,"scratch")}return this.scratch}},{key:"draw",value:function(t,n,i,a){if(this.styleKeyNeedsRedraw.has(n)){this.styleKeyNeedsRedraw.delete(n),this.deleteKey(t,n);var o=this.styleKeyToAtlas.get(n);o&&(o.forceGC=!0),this.styleKeyToAtlas.delete(n)}var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s),this.getIdsFor(n).add(t),this.idToKey.set(t,n)),s}},{key:"getAtlas",value:function(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function(t){return this.styleKeyToAtlas.has(t)}},{key:"deleteKey",value:function(t,n){this.idToKey.delete(t),this.getIdsFor(n).delete(t)}},{key:"checkKeyIsInvalid",value:function(t,n){if(!this.idToKey.has(t))return!1;var i=this.idToKey.get(t);return i!=n?(this.deleteKey(t,i),!0):!1}},{key:"_getKeysToCollect",value:function(){var t=new Set,n=Mr(this.styleKeyToAtlas.keys()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;this.getIdsFor(a).size==0&&t.add(a)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"gc",value:function(){var t=this,n=this.atlases.some(function(h){return h.forceGC}),i=this._getKeysToCollect();if(i.size===0&&!n){console.log("nothing to garbage collect");return}var a=[],o=new Map,s=null,u=Mr(this.atlases),l;try{var c=function(){var f=l.value,v=f.getKeys(),p=vx(i,v);if(p.size===0&&!f.forceGC)return a.push(f),v.forEach(function(O){return o.set(O,f)}),"continue";s||(s=t._createAtlas(),a.push(s));var m=Mr(v),g;try{for(m.s();!(g=m.n()).done;){var y=g.value;if(!p.has(y)){var b=f.getOffsets(y),S=Bt(b,2),A=S[0],P=S[1];s.canFit({w:A.w+P.w,h:A.h})||(s=t._createAtlas(),a.push(s)),t._copyTextureToNewAtlas(y,f,s),o.set(y,s)}}}catch(O){m.e(O)}finally{m.f()}};for(u.s();!(l=u.n()).done;)var d=c()}catch(h){u.e(h)}finally{u.f()}this.atlases=a,this.styleKeyToAtlas=o}},{key:"_copyTextureToNewAtlas",value:function(t,n,i){var a=n.getOffsets(t),o=Bt(a,2),s=o[0],u=o[1];if(u.w===0)i.draw(t,s,function(h){h.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h)});else{var l=this._getScratchCanvas();l.clear(),l.context.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h),l.context.drawImage(n.canvas,u.x,u.y,u.w,u.h,s.w,0,u.w,u.h);var c=s.w+u.w,d=s.h;i.draw(t,{w:c,h:d},function(h){h.drawImage(l,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}]),r}();function vx(r,e){return r.intersection?r.intersection(e):new Set(Fh(r).filter(function(t){return e.has(t)}))}var px=function(){function r(e,t){Un(this,r),this.r=e;var n=t;this.globalOptions=n,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.renderTypes=new Map,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[],this._cacheScratchCanvas(n)}return $n(r,[{key:"_cacheScratchCanvas",value:function(t){var n=-1,i=-1,a=null,o=t.createTextureCanvas;t.createTextureCanvas=function(s,u,l,c){return c?((!a||u!=n||l!=i)&&(n=u,i=l,a=o(s,u,l)),a):o(s,u,l)}}},{key:"addRenderType",value:function(t,n){var i=new fx(this.r,this.globalOptions),a=n;this.renderTypes.set(t,Ye({type:t,atlasCollection:i},a))}},{key:"getRenderTypes",value:function(){return Fh(this.renderTypes.values())}},{key:"getRenderTypeOpts",value:function(t){return this.renderTypes.get(t)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.forceRedraw,a=i===void 0?!1:i,o=n.filterEle,s=o===void 0?function(){return!0}:o,u=n.filterType,l=u===void 0?function(){return!0}:u,c=!1,d=Mr(t),h;try{for(d.s();!(h=d.n()).done;){var f=h.value;if(s(f)){var v=f.id(),p=Mr(this.getRenderTypes()),m;try{for(p.s();!(m=p.n()).done;){var g=m.value;if(l(g.type)){var y=g.getKey(f);a?(g.atlasCollection.deleteKey(v,y),g.atlasCollection.styleKeyNeedsRedraw.add(y),c=!0):c|=g.atlasCollection.checkKeyIsInvalid(v,y)}}}catch(b){p.e(b)}finally{p.f()}}}}catch(b){d.e(b)}finally{d.f()}return c}},{key:"gc",value:function(){var t=Mr(this.getRenderTypes()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.atlasCollection.gc()}}catch(a){t.e(a)}finally{t.f()}}},{key:"isRenderable",value:function(t,n){var i=this.getRenderTypeOpts(n);return i&&i.isVisible(t)}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"getOrCreateAtlas",value:function(t,n,i){var a=this.renderTypes.get(i),o=a.getKey(t),s=t.id();return a.atlasCollection.draw(s,o,n,function(u){a.drawElement(u,t,n,!0,!0)})}},{key:"getAtlasIndexForBatch",value:function(t){var n=this.batchAtlases.indexOf(t);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(t),n=this.batchAtlases.length-1}return n}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlases},function(t,n){return n})}},{key:"getAtlasInfo",value:function(t,n){var i=this.renderTypes.get(n),a=i.getBoundingBox(t),o=this.getOrCreateAtlas(t,a,n),s=this.getAtlasIndexForBatch(o);if(s!==void 0){var u=i.getKey(t),l=o.getOffsets(u),c=Bt(l,2),d=c[0],h=c[1];return{atlasID:s,tex:d,tex1:d,tex2:h,bb:a,type:n,styleKey:u}}}},{key:"canAddToCurrentBatch",value:function(t,n){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var i=this.renderTypes.get(n),a=i.getKey(t),o=i.atlasCollection.getAtlas(a);return o&&this.batchAtlases.includes(o)}return!0}},{key:"setTransformMatrix",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=n.bb,s=n.type,u=n.tex1,l=n.tex2,c=this.getRenderTypeOpts(s),d=c.getPadding?c.getPadding(i):0,h=u.w/(u.w+l.w);a||(h=1-h);var f=this.getAdjustedBB(o,d,a,h),v,p;gv(t);var m=c.getRotation?c.getRotation(i):0;if(m!==0){var g=c.getRotationPoint(i),y=g.x,b=g.y;Ys(t,t,[y,b]),mv(t,t,m);var S=c.getRotationOffset(i);v=S.x+f.xOffset,p=S.y}else v=f.x1,p=f.y1;Ys(t,t,[v,p]),Uu(t,t,[f.w,f.h])}},{key:"getTransformMatrix",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Ba();return this.setTransformMatrix(a,t,n,i),a}},{key:"getAdjustedBB",value:function(t,n,i,a){var o=t.x1,s=t.y1,u=t.w,l=t.h;n&&(o-=n,s-=n,u+=2*n,l+=2*n);var c=0,d=u*a;return i&&a<1?u=d:!i&&a<1&&(c=u-d,o+=c,u=d),{x1:o,y1:s,w:u,h:l,xOffset:c}}},{key:"getDebugInfo",value:function(){var t=[],n=Mr(this.renderTypes),i;try{for(n.s();!(i=n.n()).done;){var a=Bt(i.value,2),o=a[0],s=a[1],u=s.atlasCollection.getCounts(),l=u.keyCount,c=u.atlasCount;t.push({type:o,keyCount:l,atlasCount:c})}}catch(d){n.e(d)}finally{n.f()}return t}}]),r}(),tu=0,Ph=1,Oh=2,ru=3,gx=function(){function r(e,t,n){Un(this,r),this.r=e,this.gl=t,this.maxInstances=n.webglBatchSize,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,n.enableWrapping=!0,n.createTextureCanvas=ix,this.atlasManager=new px(e,n),this.program=this.createShaderProgram(Va.SCREEN),this.pickingProgram=this.createShaderProgram(Va.PICKING),this.vao=this.createVAO(),this.debugInfo=[]}return $n(r,[{key:"addTextureRenderType",value:function(t,n){this.atlasManager.addRenderType(t,n)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(t,{filterType:function(s){return s===i},forceRedraw:!0}):a.invalidate(t)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function(t){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; 

      // what are we rendering?
      in int aVertType;

      // for picking
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex1; // x/y/w/h of texture in atlas
      in vec4 aTex2; 

      // for any transforms that are needed
      in vec4 aScaleRotate1;  // vectors use fewer attributes than matrices
      in vec2 aTranslate1;
      in vec4 aScaleRotate2;
      in vec2 aTranslate2;

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in float aLineWidth;
      in vec4 aEdgeColor;

      out vec2 vTexCoord;
      out vec4 vEdgeColor;
      flat out int vAtlasId;
      flat out vec4 vIndex;
      flat out int vVertType;

      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition;

        if(aVertType == `.concat(tu,`) {
          float texX;
          float texY;
          float texW;
          float texH;
          mat3  texMatrix;

          int vid = gl_VertexID;
          if(vid <= 5) {
            texX = aTex1.x;
            texY = aTex1.y;
            texW = aTex1.z;
            texH = aTex1.w;
            texMatrix = mat3(
              vec3(aScaleRotate1.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate1,      1.0)
            );
          } else {
            texX = aTex2.x;
            texY = aTex2.y;
            texW = aTex2.z;
            texH = aTex2.w;
            texMatrix = mat3(
              vec3(aScaleRotate2.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate2,      1.0)
            );
          }

          if(vid == 1 || vid == 2 || vid == 4 || vid == 7 || vid == 8 || vid == 10) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5 || vid == 8 || vid == 10 || vid == 11) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * texMatrix * vec3(position, 1.0), 1.0);
        } 
        else if(aVertType == `).concat(Ph,` && vid < 6) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(Oh,` && vid < 6) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0 = pointA;
          vec2 p1 = pointB;
          vec2 p2 = pointC;
          vec2 pos = position;
          if(position.x == 1.0) {
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth;

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(ru,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2( 0.0,   0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          mat3 transform = mat3(
            vec3(aScaleRotate1.xy, 0.0),
            vec3(aScaleRotate1.zw, 0.0),
            vec3(aTranslate1,      1.0)
          );
          gl_Position = vec4(uPanZoomMatrix * transform * vec3(position, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vIndex = aIndex;
        vVertType = aVertType;
      }
    `),a=this.atlasManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // define texture unit for each node in the batch
      `.concat(a.map(function(l){return"uniform sampler2D uTexture".concat(l,";")}).join(`
	`),`

      uniform vec4 uBGColor;

      in vec2 vTexCoord;
      in vec4 vEdgeColor;
      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;

      out vec4 outColor;

      void main(void) {
        if(vVertType == `).concat(tu,`) {
          `).concat(a.map(function(l){return"if(vAtlasId == ".concat(l,") outColor = texture(uTexture").concat(l,", vTexCoord);")}).join(`
	else `),`
        } else if(vVertType == `).concat(ru,`) {
          // blend arrow color with background (using premultiplied alpha)
          outColor.rgb = vEdgeColor.rgb + (uBGColor.rgb * (1.0 - vEdgeColor.a)); 
          outColor.a = 1.0; // make opaque, masks out line under arrow
        } else {
          outColor = vEdgeColor;
        }

        `).concat(t.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),s=nx(n,i,o);s.aPosition=n.getAttribLocation(s,"aPosition"),s.aIndex=n.getAttribLocation(s,"aIndex"),s.aVertType=n.getAttribLocation(s,"aVertType"),s.aAtlasId=n.getAttribLocation(s,"aAtlasId"),s.aTex1=n.getAttribLocation(s,"aTex1"),s.aTex2=n.getAttribLocation(s,"aTex2"),s.aScaleRotate1=n.getAttribLocation(s,"aScaleRotate1"),s.aTranslate1=n.getAttribLocation(s,"aTranslate1"),s.aScaleRotate2=n.getAttribLocation(s,"aScaleRotate2"),s.aTranslate2=n.getAttribLocation(s,"aTranslate2"),s.aPointAPointB=n.getAttribLocation(s,"aPointAPointB"),s.aPointCPointD=n.getAttribLocation(s,"aPointCPointD"),s.aLineWidth=n.getAttribLocation(s,"aLineWidth"),s.aEdgeColor=n.getAttribLocation(s,"aEdgeColor"),s.uPanZoomMatrix=n.getUniformLocation(s,"uPanZoomMatrix"),s.uAtlasSize=n.getUniformLocation(s,"uAtlasSize"),s.uBGColor=n.getUniformLocation(s,"uBGColor"),s.uTextures=[];for(var u=0;u<this.atlasManager.maxAtlases;u++)s.uTextures.push(n.getUniformLocation(s,"uTexture".concat(u)));return s}},{key:"createVAO",value:function(){var t=[0,0,1,0,1,1,0,0,1,1,0,1],n=[].concat(t,t);this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,o=this.program,s=a.createVertexArray();return a.bindVertexArray(s),lx(a,"vec2",o.aPosition,n),this.indexBuffer=Sr(a,i,"vec4",o.aIndex),this.vertTypeBuffer=Sr(a,i,"int",o.aVertType),this.atlasIdBuffer=Sr(a,i,"int",o.aAtlasId),this.tex1Buffer=Sr(a,i,"vec4",o.aTex1),this.tex2Buffer=Sr(a,i,"vec4",o.aTex2),this.scaleRotate1Buffer=Sr(a,i,"vec4",o.aScaleRotate1),this.translate1Buffer=Sr(a,i,"vec2",o.aTranslate1),this.scaleRotate2Buffer=Sr(a,i,"vec4",o.aScaleRotate2),this.translate2Buffer=Sr(a,i,"vec2",o.aTranslate2),this.pointAPointBBuffer=Sr(a,i,"vec4",o.aPointAPointB),this.pointCPointDBuffer=Sr(a,i,"vec4",o.aPointCPointD),this.lineWidthBuffer=Sr(a,i,"float",o.aLineWidth),this.edgeColorBuffer=Sr(a,i,"vec4",o.aEdgeColor),a.bindVertexArray(null),s}},{key:"buffers",get:function(){var t=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return t[n]})),this._buffers}},{key:"startFrame",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Va.SCREEN;this.panZoomMatrix=t,this.debugInfo=n,this.renderTarget=i,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.atlasManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"getTempMatrix",value:function(){return this.tempMatrix=this.tempMatrix||Ba()}},{key:"drawTexture",value:function(t,n,i){var a=this.atlasManager;if(a.isRenderable(t,i)){a.canAddToCurrentBatch(t,i)||this.endBatch();var o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=tu;var s=this.indexBuffer.getView(o);Ss(n,s);var u=a.getAtlasInfo(t,i,u),l=u.atlasID,c=u.tex1,d=u.tex2,h=this.atlasIdBuffer.getView(o);h[0]=l;var f=this.tex1Buffer.getView(o);f[0]=c.x,f[1]=c.y,f[2]=c.w,f[3]=c.h;var v=this.tex2Buffer.getView(o);v[0]=d.x,v[1]=d.y,v[2]=d.w,v[3]=d.h;for(var p=this.getTempMatrix(),m=0,g=[1,2];m<g.length;m++){var y=g[m];a.setTransformMatrix(p,u,t,y===1);var b=this["scaleRotate".concat(y,"Buffer")].getView(o);b[0]=p[0],b[1]=p[1],b[2]=p[3],b[3]=p[4];var S=this["translate".concat(y,"Buffer")].getView(o);S[0]=p[6],S[1]=p[7]}this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function(t,n,i){var a=t._private.rscratch,o,s,u;if(i==="source"?(o=a.arrowStartX,s=a.arrowStartY,u=a.srcArrowAngle):(o=a.arrowEndX,s=a.arrowEndY,u=a.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(s)||s==null||isNaN(u)||u==null)){var l=t.pstyle(i+"-arrow-shape").value;if(l!=="none"){var c=t.pstyle(i+"-arrow-color").value,d=t.pstyle("opacity").value,h=t.pstyle("line-opacity").value,f=d*h,v=t.pstyle("width").pfValue,p=t.pstyle("arrow-scale").value,m=this.r.getArrowWidth(v,p),g=this.getTempMatrix();gv(g),Ys(g,g,[o,s]),Uu(g,g,[m,m]),mv(g,g,u);var y=this.instanceCount;this.vertTypeBuffer.getView(y)[0]=ru;var b=this.indexBuffer.getView(y);Ss(n,b);var S=this.edgeColorBuffer.getView(y);Ts(c,f,S);var A=this.scaleRotate1Buffer.getView(y);A[0]=g[0],A[1]=g[1],A[2]=g[3],A[3]=g[4];var P=this.translate1Buffer.getView(y);P[0]=g[6],P[1]=g[7],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(t,n){var i=t.pstyle("opacity").value,a=t.pstyle("line-opacity").value,o=t.pstyle("width").pfValue,s=t.pstyle("line-color").value,u=i*a,l=this.getEdgePoints(t);if(l.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),l.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=Ph;var d=this.indexBuffer.getView(c);Ss(n,d);var h=this.edgeColorBuffer.getView(c);Ts(s,u,h);var f=this.lineWidthBuffer.getView(c);f[0]=o;var v=this.pointAPointBBuffer.getView(c);v[0]=l[0],v[1]=l[1],v[2]=l[2],v[3]=l[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var p=0;p<l.length-2;p+=2){var m=this.instanceCount;this.vertTypeBuffer.getView(m)[0]=Oh;var g=this.indexBuffer.getView(m);Ss(n,g);var y=this.edgeColorBuffer.getView(m);Ts(s,u,y);var b=this.lineWidthBuffer.getView(m);b[0]=o;var S=l[p-2],A=l[p-1],P=l[p],O=l[p+1],I=l[p+2],R=l[p+3],L=l[p+4],B=l[p+5];p==0&&(S=2*P-I+.001,A=2*O-R+.001),p==l.length-4&&(L=2*I-P+.001,B=2*R-O+.001);var w=this.pointAPointBBuffer.getView(m);w[0]=S,w[1]=A,w[2]=P,w[3]=O;var _=this.pointCPointDBuffer.getView(m);_[0]=I,_[1]=R,_[2]=L,_[3]=B,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"getEdgePoints",value:function(t){var n=t._private.rscratch,i=n.allpts;if(i.length==4)return i;var a=this.getNumSegments(t);return this.getCurveSegmentPoints(i,a)}},{key:"getNumSegments",value:function(t){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function(t,n){if(t.length==4)return t;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=t[0],i[1]=t[1];else if(a==n)i[a*2]=t[t.length-2],i[a*2+1]=t[t.length-1];else{var o=a/n;this.setCurvePoint(t,o,i,a*2)}return i}},{key:"setCurvePoint",value:function(t,n,i,a){if(t.length<=2)i[a]=t[0],i[a+1]=t[1];else{for(var o=Array(t.length-2),s=0;s<o.length;s+=2){var u=(1-n)*t[s]+n*t[s+2],l=(1-n)*t[s+1]+n*t[s+3];o[s]=u,o[s+1]=l}return this.setCurvePoint(o,n,i,a)}}},{key:"endBatch",value:function(){var t=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(o),t.bindVertexArray(n);var s=Mr(this.buffers),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;l.bufferSubData(a)}}catch(v){s.e(v)}finally{s.f()}for(var c=this.atlasManager.getAtlases(),d=0;d<c.length;d++)c[d].bufferIfNeeded(t);for(var h=0;h<c.length;h++)t.activeTexture(t.TEXTURE0+h),t.bindTexture(t.TEXTURE_2D,c[h].texture),t.uniform1i(o.uTextures[h],h);t.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),t.uniform1i(o.uAtlasSize,this.atlasManager.atlasSize);var f=Ts(this.bgColor,1);t.uniform4fv(o.uBGColor,f),t.drawArraysInstanced(t.TRIANGLES,0,i,a),t.bindVertexArray(null),t.bindTexture(t.TEXTURE_2D,null),this.debugInfo&&this.debugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){return this.debugInfo}},{key:"getAtlasDebugInfo",value:function(){return this.atlasManager.getDebugInfo()}}]),r}();function Rh(r,e){return"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(e,")")}var mx=function(){function r(e){Un(this,r),this.r=e}return $n(r,[{key:"getStyleKey",value:function(t,n){var i=this.getStyle(t,n),a=i.shape,o=i.opacity,s=i.color;if(!a)return null;var u=n.width(),l=n.height(),c=Rh(s,o);return Vn("".concat(a,"-").concat(u,"-").concat(l,"-").concat(c))}},{key:"isVisible",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value;return i>0}},{key:"getStyle",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value,a=n.pstyle("".concat(t,"-color")).value,o=n.pstyle("".concat(t,"-shape")).value;return{opacity:i,color:a,shape:o}}},{key:"getPadding",value:function(t,n){return n.pstyle("".concat(t,"-padding")).pfValue}},{key:"draw",value:function(t,n,i,a){if(this.isVisible(t,i)){var o=this.r,s=a.w,u=a.h,l=s/2,c=u/2,d=this.getStyle(t,i),h=d.shape,f=d.color,v=d.opacity;n.save(),n.fillStyle=Rh(f,v),h==="round-rectangle"||h==="roundrectangle"?o.drawRoundRectanglePath(n,l,c,s,u,"auto"):h==="ellipse"&&o.drawEllipsePath(n,l,c,s,u),n.fill(),n.restore()}}}]),r}();function yx(r){var e=r&&r.style&&r.style.backgroundColor||"white";return Hh(e)}var yv={};yv.initWebgl=function(r,e){var t=this,n=t.data.contexts[t.WEBGL],i=r.cy.container();r.bgColor=yx(i),r.webglTexSize=Math.min(r.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),t.webglDebug=r.webglDebug,t.webglDebugShowAtlases=r.webglDebugShowAtlases,console.log("max texture units",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),console.log("max texture size",n.getParameter(n.MAX_TEXTURE_SIZE)),console.log("webgl options",r),t.pickingFrameBuffer=ux(n),t.pickingFrameBuffer.needsDraw=!0;var a=function(c){return t.getTextAngle(c,null)},o=function(c){var d=c.pstyle("label");return d&&d.value};t.eleDrawing=new gx(t,n,r);var s=new mx(t);t.eleDrawing.addTextureRenderType("node-body",Pa({getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement,isVisible:function(c){return c.visible()}})),t.eleDrawing.addTextureRenderType("node-label",Pa({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o})),t.eleDrawing.addTextureRenderType("node-overlay",Pa({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("overlay",c)},drawElement:function(c,d,h){return s.draw("overlay",c,d,h)},isVisible:function(c){return s.isVisible("overlay",c)},getPadding:function(c){return s.getPadding("overlay",c)}})),t.eleDrawing.addTextureRenderType("node-underlay",Pa({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("underlay",c)},drawElement:function(c,d,h){return s.draw("underlay",c,d,h)},isVisible:function(c){return s.isVisible("underlay",c)},getPadding:function(c){return s.getPadding("underlay",c)}})),t.eleDrawing.addTextureRenderType("edge-label",Pa({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o}));var u=eo(function(){console.log("garbage collect flag set"),t.data.gc=!0},1e4);t.onUpdateEleCalcs(function(l,c){var d=!1;c&&c.length>0&&(d|=t.eleDrawing.invalidate(c)),d&&u()}),Cx(t)};function Cx(r){{var e=r.render;r.render=function(a){a=a||{};var o=r.cy;r.webgl&&(o.zoom()>uv?(wx(r),e.call(r,a)):(bx(r),wv(r,a,Va.SCREEN)))}}{var t=r.matchCanvasSize;r.matchCanvasSize=function(a){t.call(r,a),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(a,o,s,u){return Mx(r,a,o)};{var n=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){n.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var i=r.notify;r.notify=function(a,o){i.call(r,a,o),a==="viewport"||a==="bounds"?r.pickingFrameBuffer.needsDraw=!0:a==="background"&&r.eleDrawing.invalidate(o,{type:"node-body"})}}}function wx(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function bx(r){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.canvasWidth,r.canvasHeight),n.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function xx(r){var e=r.canvasWidth,t=r.canvasHeight,n=Hu(r),i=n.pan,a=n.zoom,o=Ba();Ys(o,o,[i.x,i.y]),Uu(o,o,[a,a]);var s=Ba();dx(s,e,t);var u=Ba();return cx(u,s,o),u}function Cv(r,e){var t=r.canvasWidth,n=r.canvasHeight,i=Hu(r),a=i.pan,o=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.translate(a.x,a.y),e.scale(o,o)}function Ex(r,e){r.drawSelectionRectangle(e,function(t){return Cv(r,t)})}function _x(r){var e=r.data.contexts[r.NODE];e.save(),Cv(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function Tx(r){var e=function(i,a,o){for(var s=i.atlasManager.getRenderTypeOpts(a),u=r.data.contexts[r.NODE],l=.125,c=s.atlasCollection.atlases,d=0;d<c.length;d++){var h=c[d],f=h.canvas,v=f.width,p=f.height,m=v*d,g=f.height*o;u.save(),u.scale(l,l),u.drawImage(f,m,g),u.strokeStyle="black",u.rect(m,g,v,p),u.stroke(),u.restore()}},t=0;e(r.eleDrawing,"node-body",t++),e(r.eleDrawing,"node-label",t++)}function Sx(r,e,t,n,i){var a,o,s,u,l=Hu(r),c=l.pan,d=l.zoom;if(n===void 0||i===void 0){var h=eu(r,c,d,e,t),f=Bt(h,2),v=f[0],p=f[1],m=6;a=v-m/2,o=p-m/2,s=m,u=m}else{var g=eu(r,c,d,e,t),y=Bt(g,2),b=y[0],S=y[1],A=eu(r,c,d,n,i),P=Bt(A,2),O=P[0],I=P[1];a=b,o=I,s=Math.abs(O-b),u=Math.abs(I-S)}if(s===0||u===0)return[];var R=r.data.contexts[r.WEBGL];R.bindFramebuffer(R.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(R.viewport(0,0,R.canvas.width,R.canvas.height),wv(r,null,Va.PICKING),r.pickingFrameBuffer.needsDraw=!1);var L=s*u,B=new Uint8Array(L*4);R.readPixels(a,o,s,u,R.RGBA,R.UNSIGNED_BYTE,B),R.bindFramebuffer(R.FRAMEBUFFER,null);for(var w=new Set,_=0;_<L;_++){var E=B.slice(_*4,_*4+4),x=ax(E)-1;x>=0&&w.add(x)}return w}function Mx(r,e,t){var n=Sx(r,e,t),i=r.getCachedZSortedEles(),a,o,s=Mr(n),u;try{for(s.s();!(u=s.n()).done;){var l=u.value,c=i[l];if(!a&&c.isNode()&&(a=c),!o&&c.isEdge()&&(o=c),a&&o)break}}catch(d){s.e(d)}finally{s.f()}return[a,o].filter(Boolean)}function wv(r,e,t){var n,i;r.webglDebug&&(i=[],n=performance.now());var a=r.eleDrawing,o=0;if(t.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&Ex(r,e),r.data.canvasNeedsRedraw[r.NODE]||t.picking){var s=function(w,_){_+=1,w.isNode()?(a.drawTexture(w,_,"node-underlay"),a.drawTexture(w,_,"node-body"),a.drawTexture(w,_,"node-label"),a.drawTexture(w,_,"node-overlay")):(a.drawEdgeLine(w,_),a.drawEdgeArrow(w,_,"source"),a.drawEdgeArrow(w,_,"target"),a.drawTexture(w,_,"edge-label"))},u=r.data.contexts[r.WEBGL];t.screen?(u.clearColor(0,0,0,0),u.enable(u.BLEND),u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA)):u.disable(u.BLEND),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),u.viewport(0,0,u.canvas.width,u.canvas.height);var l=xx(r),c=r.getCachedZSortedEles();if(o=c.length,a.startFrame(l,i,t),t.screen){for(var d=0;d<c.nondrag.length;d++)s(c.nondrag[d],d);for(var h=0;h<c.drag.length;h++)s(c.drag[h],-1)}else if(t.picking)for(var f=0;f<c.length;f++)s(c[f],f);a.endFrame(),r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc()),t.screen&&r.webglDebugShowAtlases&&(_x(r),Tx(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),p=!0,m=0,g=0,y=Mr(i),b;try{for(y.s();!(b=y.n()).done;){var S=b.value;m++,g+=S.count}}catch(B){y.e(B)}finally{y.f()}var A=Math.ceil(v-n),P="".concat(o," elements, ").concat(g," rectangles, ").concat(m," batches");if(p)console.log("WebGL (".concat(t.name,") - ").concat(P));else{console.log("WebGL render (".concat(t.name,") - frame time ").concat(A,"ms")),console.log("  ".concat(P)),console.log("Texture Atlases Used:");var O=a.getAtlasDebugInfo(),I=Mr(O),R;try{for(I.s();!(R=I.n()).done;){var L=R.value;console.log("  ".concat(L.type,": ").concat(L.keyCount," keys, ").concat(L.atlasCount," atlases"))}}catch(B){I.e(B)}finally{I.f()}console.log("")}}}var Yn={};Yn.drawPolygonPath=function(r,e,t,n,i,a){var o=n/2,s=i/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*a[0],t+s*a[1]);for(var u=1;u<a.length/2;u++)r.lineTo(e+o*a[u*2],t+s*a[u*2+1]);r.closePath()};Yn.drawRoundPolygonPath=function(r,e,t,n,i,a,o){o.forEach(function(s){return ev(r,s)}),r.closePath()};Yn.drawRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,u=a==="auto"?li(n,i):Math.min(a,s,o);r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.arcTo(e+o,t-s,e+o,t,u),r.arcTo(e+o,t+s,e,t+s,u),r.arcTo(e-o,t+s,e-o,t,u),r.arcTo(e-o,t-s,e,t-s,u),r.lineTo(e,t-s),r.closePath()};Yn.drawBottomRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,u=a==="auto"?li(n,i):a;r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.lineTo(e+o,t-s),r.lineTo(e+o,t),r.arcTo(e+o,t+s,e,t+s,u),r.arcTo(e-o,t+s,e-o,t,u),r.lineTo(e-o,t-s),r.lineTo(e,t-s),r.closePath()};Yn.drawCutRectanglePath=function(r,e,t,n,i,a,o){var s=n/2,u=i/2,l=o==="auto"?Au():o;r.beginPath&&r.beginPath(),r.moveTo(e-s+l,t-u),r.lineTo(e+s-l,t-u),r.lineTo(e+s,t-u+l),r.lineTo(e+s,t+u-l),r.lineTo(e+s-l,t+u),r.lineTo(e-s+l,t+u),r.lineTo(e-s,t+u-l),r.lineTo(e-s,t-u+l),r.closePath()};Yn.drawBarrelPath=function(r,e,t,n,i){var a=n/2,o=i/2,s=e-a,u=e+a,l=t-o,c=t+o,d=au(n,i),h=d.widthOffset,f=d.heightOffset,v=d.ctrlPtOffsetPct*h;r.beginPath&&r.beginPath(),r.moveTo(s,l+f),r.lineTo(s,c-f),r.quadraticCurveTo(s+v,c,s+h,c),r.lineTo(u-h,c),r.quadraticCurveTo(u-v,c,u,c-f),r.lineTo(u,l+f),r.quadraticCurveTo(u-v,l,u-h,l),r.lineTo(s+h,l),r.quadraticCurveTo(s+v,l,s,l+f),r.closePath()};var Ih=Math.sin(0),Lh=Math.cos(0),mu={},yu={},bv=Math.PI/40;for(ei=0*Math.PI;ei<2*Math.PI;ei+=bv)mu[ei]=Math.sin(ei),yu[ei]=Math.cos(ei);var ei;Yn.drawEllipsePath=function(r,e,t,n,i){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,n/2,i/2,0,0,2*Math.PI);else for(var a,o,s=n/2,u=i/2,l=0*Math.PI;l<2*Math.PI;l+=bv)a=e-s*mu[l]*Ih+s*yu[l]*Lh,o=t+u*yu[l]*Ih+u*mu[l]*Lh,l===0?r.moveTo(a,o):r.lineTo(a,o);r.closePath()};var oo={};oo.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};oo.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),n=t.boundingBox(),i=this.findContainerClientCoords(),a=r.full?Math.ceil(n.w):i[2],o=r.full?Math.ceil(n.h):i[3],s=Ne(r.maxWidth)||Ne(r.maxHeight),u=this.getPixelRatio(),l=1;if(r.scale!==void 0)a*=r.scale,o*=r.scale,l=r.scale;else if(s){var c=1/0,d=1/0;Ne(r.maxWidth)&&(c=l*r.maxWidth/a),Ne(r.maxHeight)&&(d=l*r.maxHeight/o),l=Math.min(c,d),a*=l,o*=l}s||(a*=u,o*=u,l*=u);var h=document.createElement("canvas");h.width=a,h.height=o,h.style.width=a+"px",h.style.height=o+"px";var f=h.getContext("2d");if(a>0&&o>0){f.clearRect(0,0,a,o),f.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(r.full)f.translate(-n.x1*l,-n.y1*l),f.scale(l,l),this.drawElements(f,v),f.scale(1/l,1/l),f.translate(n.x1*l,n.y1*l);else{var p=e.pan(),m={x:p.x*l,y:p.y*l};l*=e.zoom(),f.translate(m.x,m.y),f.scale(l,l),this.drawElements(f,v),f.scale(1/l,1/l),f.translate(-m.x,-m.y)}r.bg&&(f.globalCompositeOperation="destination-over",f.fillStyle=r.bg,f.rect(0,0,a,o),f.fill())}return h};function Ax(r,e){for(var t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function Nh(r){var e=r.indexOf(",");return r.substr(e+1)}function xv(r,e,t){var n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new ia(function(i,a){try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return Ax(Nh(n()),t);case"base64":return Nh(n());case"base64uri":default:return n()}}oo.png=function(r){return xv(r,this.bufferCanvasImage(r),"image/png")};oo.jpg=function(r){return xv(r,this.bufferCanvasImage(r),"image/jpeg")};var Ev={};Ev.nodeShapeImpl=function(r,e,t,n,i,a,o,s){switch(r){case"ellipse":return this.drawEllipsePath(e,t,n,i,a);case"polygon":return this.drawPolygonPath(e,t,n,i,a,o);case"round-polygon":return this.drawRoundPolygonPath(e,t,n,i,a,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,n,i,a,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,n,i,a,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,n,i,a,s);case"barrel":return this.drawBarrelPath(e,t,n,i,a)}};var Dx=_v,nt=_v.prototype;nt.CANVAS_LAYERS=3;nt.SELECT_BOX=0;nt.DRAG=1;nt.NODE=2;nt.WEBGL=3;nt.CANVAS_TYPES=["2d","2d","2d","webgl2"];nt.BUFFER_COUNT=3;nt.TEXTURE_BUFFER=0;nt.MOTIONBLUR_BUFFER_NODE=1;nt.MOTIONBLUR_BUFFER_DRAG=2;function _v(r){var e=this,t=e.cy.window(),n=t.document;r.webgl&&(nt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(nt.CANVAS_LAYERS),contexts:new Array(nt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(nt.CANVAS_LAYERS),bufferCanvases:new Array(nt.BUFFER_COUNT),bufferContexts:new Array(nt.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,o.position="relative",o.zIndex="0",o.overflow="hidden";var s=r.cy.container();s.appendChild(e.data.canvasContainer),s.style[i]=a;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};Yg()&&(u["-ms-touch-action"]="none",u["touch-action"]="none");for(var l=0;l<nt.CANVAS_LAYERS;l++){var c=e.data.canvases[l]=n.createElement("canvas"),d=nt.CANVAS_TYPES[l];e.data.contexts[l]=c.getContext(d),e.data.contexts[l]||St("Could not create canvas of type "+d),Object.keys(u).forEach(function(H){c.style[H]=u[H]}),c.style.position="absolute",c.setAttribute("data-id","layer"+l),c.style.zIndex=String(nt.CANVAS_LAYERS-l),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[l]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[nt.NODE].setAttribute("data-id","layer"+nt.NODE+"-node"),e.data.canvases[nt.SELECT_BOX].setAttribute("data-id","layer"+nt.SELECT_BOX+"-selectbox"),e.data.canvases[nt.DRAG].setAttribute("data-id","layer"+nt.DRAG+"-drag"),e.data.canvases[nt.WEBGL]&&e.data.canvases[nt.WEBGL].setAttribute("data-id","layer"+nt.WEBGL+"-webgl");for(var l=0;l<nt.BUFFER_COUNT;l++)e.data.bufferCanvases[l]=n.createElement("canvas"),e.data.bufferContexts[l]=e.data.bufferCanvases[l].getContext("2d"),e.data.bufferCanvases[l].style.position="absolute",e.data.bufferCanvases[l].setAttribute("data-id","buffer"+l),e.data.bufferCanvases[l].style.zIndex=String(-l-1),e.data.bufferCanvases[l].style.visibility="hidden";e.pathsEnabled=!0;var h=Er(),f=function(k){return{x:(k.x1+k.x2)/2,y:(k.y1+k.y2)/2}},v=function(k){return{x:-k.w/2,y:-k.h/2}},p=function(k){var G=k[0]._private,W=G.oldBackgroundTimestamp===G.backgroundTimestamp;return!W},m=function(k){return k[0]._private.nodeKey},g=function(k){return k[0]._private.labelStyleKey},y=function(k){return k[0]._private.sourceLabelStyleKey},b=function(k){return k[0]._private.targetLabelStyleKey},S=function(k,G,W,te,X){return e.drawElement(k,G,W,!1,!1,X)},A=function(k,G,W,te,X){return e.drawElementText(k,G,W,te,"main",X)},P=function(k,G,W,te,X){return e.drawElementText(k,G,W,te,"source",X)},O=function(k,G,W,te,X){return e.drawElementText(k,G,W,te,"target",X)},I=function(k){return k.boundingBox(),k[0]._private.bodyBounds},R=function(k){return k.boundingBox(),k[0]._private.labelBounds.main||h},L=function(k){return k.boundingBox(),k[0]._private.labelBounds.source||h},B=function(k){return k.boundingBox(),k[0]._private.labelBounds.target||h},w=function(k,G){return G},_=function(k){return f(I(k))},E=function(k,G,W){var te=k?k+"-":"";return{x:G.x+W.pstyle(te+"text-margin-x").pfValue,y:G.y+W.pstyle(te+"text-margin-y").pfValue}},x=function(k,G,W){var te=k[0]._private.rscratch;return{x:te[G],y:te[W]}},C=function(k){return E("",x(k,"labelX","labelY"),k)},T=function(k){return E("source",x(k,"sourceLabelX","sourceLabelY"),k)},M=function(k){return E("target",x(k,"targetLabelX","targetLabelY"),k)},D=function(k){return v(I(k))},F=function(k){return v(L(k))},N=function(k){return v(B(k))},z=function(k){var G=R(k),W=v(R(k));if(k.isNode()){switch(k.pstyle("text-halign").value){case"left":W.x=-G.w-(G.leftPad||0);break;case"right":W.x=-(G.rightPad||0);break}switch(k.pstyle("text-valign").value){case"top":W.y=-G.h-(G.topPad||0);break;case"bottom":W.y=-(G.botPad||0);break}}return W},q=e.data.eleTxrCache=new Na(e,{getKey:m,doesEleInvalidateKey:p,drawElement:S,getBoundingBox:I,getRotationPoint:_,getRotationOffset:D,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),$=e.data.lblTxrCache=new Na(e,{getKey:g,drawElement:A,getBoundingBox:R,getRotationPoint:C,getRotationOffset:z,isVisible:w}),ee=e.data.slbTxrCache=new Na(e,{getKey:y,drawElement:P,getBoundingBox:L,getRotationPoint:T,getRotationOffset:F,isVisible:w}),J=e.data.tlbTxrCache=new Na(e,{getKey:b,drawElement:O,getBoundingBox:B,getRotationPoint:M,getRotationOffset:N,isVisible:w}),j=e.data.lyrTxrCache=new cv(e);e.onUpdateEleCalcs(function(k,G){q.invalidateElements(G),$.invalidateElements(G),ee.invalidateElements(G),J.invalidateElements(G),j.invalidateElements(G);for(var W=0;W<G.length;W++){var te=G[W]._private;te.oldBackgroundTimestamp=te.backgroundTimestamp}});var Z=function(k){for(var G=0;G<k.length;G++)j.enqueueElementRefinement(k[G].ele)};q.onDequeue(Z),$.onDequeue(Z),ee.onDequeue(Z),J.onDequeue(Z),r.webgl&&e.initWebgl(r,{getStyleKey:m,getLabelKey:g,drawElement:S,drawLabel:A,getElementBox:I,getLabelBox:R,getElementRotationPoint:_,getElementRotationOffset:D,getLabelRotationPoint:C,getLabelRotationOffset:z})}nt.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[nt.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[nt.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[nt.SELECT_BOX]=e;break;case"gc":t.data.gc=!0;break}};var Px=typeof Path2D<"u";nt.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};nt.usePaths=function(){return Px&&this.pathsEnabled};nt.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};nt.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};nt.makeOffscreenCanvas=function(r,e){var t;if((typeof OffscreenCanvas>"u"?"undefined":Gt(OffscreenCanvas))!=="undefined")t=new OffscreenCanvas(r,e);else{var n=this.cy.window(),i=n.document;t=i.createElement("canvas"),t.width=r,t.height=e}return t};[dv,an,gn,ju,fi,ha,gr,yv,Yn,oo,Ev].forEach(function(r){Ye(nt,r)});var Ox=[{name:"null",impl:Zf},{name:"base",impl:sv},{name:"canvas",impl:Dx}],Rx=[{type:"layout",extensions:vb},{type:"renderer",extensions:Ox}],Tv={},Sv={};function Mv(r,e,t){var n=t,i=function(I){ft("Can not register `"+e+"` for `"+r+"` since `"+I+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(Ka.prototype[e])return i(e);Ka.prototype[e]=t}else if(r==="collection"){if(rr.prototype[e])return i(e);rr.prototype[e]=t}else if(r==="layout"){for(var a=function(I){this.options=I,t.call(this,I),ut(this._private)||(this._private={}),this._private.cy=I.cy,this._private.listeners=[],this.createEmitter()},o=a.prototype=Object.create(t.prototype),s=[],u=0;u<s.length;u++){var l=s[u];o[l]=o[l]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var c=t.prototype.stop;o.stop=function(){var O=this.options;if(O&&O.animate){var I=this.animations;if(I)for(var R=0;R<I.length;R++)I[R].stop()}return c?c.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(I){return I._private.cy},h={addEventFields:function(I,R){R.layout=I,R.cy=d(I),R.target=I},bubble:function(){return!0},parent:function(I){return d(I)}};Ye(o,{createEmitter:function(){return this._private.emitter=new nl(h,this),this},emitter:function(){return this._private.emitter},on:function(I,R){return this.emitter().on(I,R),this},one:function(I,R){return this.emitter().one(I,R),this},once:function(I,R){return this.emitter().one(I,R),this},removeListener:function(I,R){return this.emitter().removeListener(I,R),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(I,R){return this.emitter().emit(I,R),this}}),ht.eventAliasesOn(o),n=a}else if(r==="renderer"&&e!=="null"&&e!=="base"){var f=Av("renderer","base"),v=f.prototype,p=t,m=t.prototype,g=function(){f.apply(this,arguments),p.apply(this,arguments)},y=g.prototype;for(var b in v){var S=v[b],A=m[b]!=null;if(A)return i(b);y[b]=S}for(var P in m)y[P]=m[P];v.clientFunctions.forEach(function(O){y[O]=y[O]||function(){St("Renderer does not implement `renderer."+O+"()` on its prototype")}}),n=g}else if(r==="__proto__"||r==="constructor"||r==="prototype")return St(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return Uh({map:Tv,keys:[r,e],value:n})}function Av(r,e){return $h({map:Tv,keys:[r,e]})}function Ix(r,e,t,n,i){return Uh({map:Sv,keys:[r,e,t,n],value:i})}function Lx(r,e,t,n){return $h({map:Sv,keys:[r,e,t,n]})}var Cu=function(){if(arguments.length===2)return Av.apply(null,arguments);if(arguments.length===3)return Mv.apply(null,arguments);if(arguments.length===4)return Lx.apply(null,arguments);if(arguments.length===5)return Ix.apply(null,arguments);St("Invalid extension access syntax")};Ka.prototype.extension=Cu;Rx.forEach(function(r){r.extensions.forEach(function(e){Mv(r.type,e.name,e.impl)})});var Dv=function r(){if(!(this instanceof r))return new r;this.length=0},di=Dv.prototype;di.instanceString=function(){return"stylesheet"};di.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};di.css=function(r,e){var t=this.length-1;if(We(r))this[t].properties.push({name:r,value:e});else if(ut(r))for(var n=r,i=Object.keys(n),a=0;a<i.length;a++){var o=i[a],s=n[o];if(s!=null){var u=ur.properties[o]||ur.properties[qs(o)];if(u!=null){var l=u.name,c=s;this[t].properties.push({name:l,value:c})}}}return this};di.style=di.css;di.generateStyle=function(r){var e=new ur(r);return this.appendToStyle(e)};di.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],n=t.selector,i=t.properties;r.selector(n);for(var a=0;a<i.length;a++){var o=i[a];r.css(o.name,o.value)}}return r};var Nx="3.31.0",Hr=function(e){if(e===void 0&&(e={}),ut(e))return new Ka(e);if(We(e))return Cu.apply(Cu,arguments)};Hr.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Hr),r.apply(null,e),this};Hr.warnings=function(r){return Jh(r)};Hr.version=Nx;Hr.stylesheet=Hr.Stylesheet=Dv;var dp=Eo(Pv());var uo=Math.min,qn=Math.max,co=Math.round;var Ur=r=>({x:r,y:r}),kx={left:"right",right:"left",bottom:"top",top:"bottom"},Fx={start:"end",end:"start"};function Wu(r,e,t){return qn(r,uo(e,t))}function fa(r,e){return typeof r=="function"?r(e):r}function Xn(r){return r.split("-")[0]}function hl(r){return r.split("-")[1]}function fl(r){return r==="x"?"y":"x"}function Yu(r){return r==="y"?"height":"width"}function vi(r){return["top","bottom"].includes(Xn(r))?"y":"x"}function qu(r){return fl(vi(r))}function Ov(r,e,t){t===void 0&&(t=!1);let n=hl(r),i=qu(r),a=Yu(i),o=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=lo(o)),[o,lo(o)]}function Rv(r){let e=lo(r);return[dl(r),e,dl(e)]}function dl(r){return r.replace(/start|end/g,e=>Fx[e])}function Bx(r,e,t){let n=["left","right"],i=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return t?e?i:n:e?n:i;case"left":case"right":return e?a:o;default:return[]}}function Iv(r,e,t,n){let i=hl(r),a=Bx(Xn(r),t==="start",n);return i&&(a=a.map(o=>o+"-"+i),e&&(a=a.concat(a.map(dl)))),a}function lo(r){return r.replace(/left|right|bottom|top/g,e=>kx[e])}function Vx(r){return Lt({top:0,right:0,bottom:0,left:0},r)}function Lv(r){return typeof r!="number"?Vx(r):{top:r,right:r,bottom:r,left:r}}function pi(r){let{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function Nv(r,e,t){let{reference:n,floating:i}=r,a=vi(e),o=qu(e),s=Yu(o),u=Xn(e),l=a==="y",c=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,h=n[s]/2-i[s]/2,f;switch(u){case"top":f={x:c,y:n.y-i.height};break;case"bottom":f={x:c,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:d};break;case"left":f={x:n.x-i.width,y:d};break;default:f={x:n.x,y:n.y}}switch(hl(e)){case"start":f[o]-=h*(t&&l?-1:1);break;case"end":f[o]+=h*(t&&l?-1:1);break}return f}var kv=(r,e,t)=>_t(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:o}=t,s=a.filter(Boolean),u=yield o.isRTL==null?void 0:o.isRTL(e),l=yield o.getElementRects({reference:r,floating:e,strategy:i}),{x:c,y:d}=Nv(l,n,u),h=n,f={},v=0;for(let p=0;p<s.length;p++){let{name:m,fn:g}=s[p],{x:y,y:b,data:S,reset:A}=yield g({x:c,y:d,initialPlacement:n,placement:h,strategy:i,middlewareData:f,rects:l,platform:o,elements:{reference:r,floating:e}});c=y??c,d=b??d,f=qr(Lt({},f),{[m]:Lt(Lt({},f[m]),S)}),A&&v<=50&&(v++,typeof A=="object"&&(A.placement&&(h=A.placement),A.rects&&(l=A.rects===!0?yield o.getElementRects({reference:r,floating:e,strategy:i}):A.rects),{x:c,y:d}=Nv(l,h,u)),p=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:f}});function Xu(r,e){return _t(this,null,function*(){var t;e===void 0&&(e={});let{x:n,y:i,platform:a,rects:o,elements:s,strategy:u}=r,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=fa(e,r),v=Lv(f),m=s[h?d==="floating"?"reference":"floating":d],g=pi(yield a.getClippingRect({element:(t=yield a.isElement==null?void 0:a.isElement(m))==null||t?m:m.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,b=yield a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating),S=(yield a.isElement==null?void 0:a.isElement(b))?(yield a.getScale==null?void 0:a.getScale(b))||{x:1,y:1}:{x:1,y:1},A=pi(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:b,strategy:u}):y);return{top:(g.top-A.top+v.top)/S.y,bottom:(A.bottom-g.bottom+v.bottom)/S.y,left:(g.left-A.left+v.left)/S.x,right:(A.right-g.right+v.right)/S.x}})}var Fv=function(r){return r===void 0&&(r={}),{name:"flip",options:r,fn(t){return _t(this,null,function*(){var n,i;let{placement:a,middlewareData:o,rects:s,initialPlacement:u,platform:l,elements:c}=t,x=fa(r,t),{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0}=x,g=Ml(x,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};let y=Xn(a),b=vi(u),S=Xn(u)===u,A=yield l.isRTL==null?void 0:l.isRTL(c.floating),P=f||(S||!m?[lo(u)]:Rv(u)),O=p!=="none";!f&&O&&P.push(...Iv(u,m,p,A));let I=[u,...P],R=yield Xu(t,g),L=[],B=((i=o.flip)==null?void 0:i.overflows)||[];if(d&&L.push(R[y]),h){let C=Ov(a,s,A);L.push(R[C[0]],R[C[1]])}if(B=[...B,{placement:a,overflows:L}],!L.every(C=>C<=0)){var w,_;let C=(((w=o.flip)==null?void 0:w.index)||0)+1,T=I[C];if(T)return{data:{index:C,overflows:B},reset:{placement:T}};let M=(_=B.filter(D=>D.overflows[0]<=0).sort((D,F)=>D.overflows[1]-F.overflows[1])[0])==null?void 0:_.placement;if(!M)switch(v){case"bestFit":{var E;let D=(E=B.filter(F=>{if(O){let N=vi(F.placement);return N===b||N==="y"}return!0}).map(F=>[F.placement,F.overflows.filter(N=>N>0).reduce((N,z)=>N+z,0)]).sort((F,N)=>F[1]-N[1])[0])==null?void 0:E[0];D&&(M=D);break}case"initialPlacement":M=u;break}if(a!==M)return{reset:{placement:M}}}return{}})}}};var Bv=function(r){return r===void 0&&(r={}),{name:"shift",options:r,fn(t){return _t(this,null,function*(){let{x:n,y:i,placement:a}=t,g=fa(r,t),{mainAxis:o=!0,crossAxis:s=!1,limiter:u={fn:y=>{let{x:b,y:S}=y;return{x:b,y:S}}}}=g,l=Ml(g,["mainAxis","crossAxis","limiter"]),c={x:n,y:i},d=yield Xu(t,l),h=vi(Xn(a)),f=fl(h),v=c[f],p=c[h];if(o){let y=f==="y"?"top":"left",b=f==="y"?"bottom":"right",S=v+d[y],A=v-d[b];v=Wu(S,v,A)}if(s){let y=h==="y"?"top":"left",b=h==="y"?"bottom":"right",S=p+d[y],A=p-d[b];p=Wu(S,p,A)}let m=u.fn(qr(Lt({},t),{[f]:v,[h]:p}));return qr(Lt({},m),{data:{x:m.x-n,y:m.y-i,enabled:{[f]:o,[h]:s}}})})}}},Vv=function(r){return r===void 0&&(r={}),{options:r,fn(e){let{x:t,y:n,placement:i,rects:a,middlewareData:o}=e,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=fa(r,e),c={x:t,y:n},d=vi(i),h=fl(d),f=c[h],v=c[d],p=fa(s,e),m=typeof p=="number"?{mainAxis:p,crossAxis:0}:Lt({mainAxis:0,crossAxis:0},p);if(u){let b=h==="y"?"height":"width",S=a.reference[h]-a.floating[b]+m.mainAxis,A=a.reference[h]+a.reference[b]-m.mainAxis;f<S?f=S:f>A&&(f=A)}if(l){var g,y;let b=h==="y"?"width":"height",S=["top","left"].includes(Xn(i)),A=a.reference[d]-a.floating[b]+(S&&((g=o.offset)==null?void 0:g[d])||0)+(S?0:m.crossAxis),P=a.reference[d]+a.reference[b]+(S?0:((y=o.offset)==null?void 0:y[d])||0)-(S?m.crossAxis:0);v<A?v=A:v>P&&(v=P)}return{[h]:f,[d]:v}}}};function pl(){return typeof window<"u"}function gi(r){return Gv(r)?(r.nodeName||"").toLowerCase():"#document"}function _r(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function on(r){var e;return(e=(Gv(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function Gv(r){return pl()?r instanceof Node||r instanceof _r(r).Node:!1}function Nr(r){return pl()?r instanceof Element||r instanceof _r(r).Element:!1}function $r(r){return pl()?r instanceof HTMLElement||r instanceof _r(r).HTMLElement:!1}function zv(r){return!pl()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof _r(r).ShadowRoot}function va(r){let{overflow:e,overflowX:t,overflowY:n,display:i}=kr(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(i)}function jv(r){return["table","td","th"].includes(gi(r))}function ho(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function gl(r){let e=ml(),t=Nr(r)?kr(r):r;return["transform","translate","scale","rotate","perspective"].some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function Hv(r){let e=mn(r);for(;$r(e)&&!mi(e);){if(gl(e))return e;if(ho(e))return null;e=mn(e)}return null}function ml(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function mi(r){return["html","body","#document"].includes(gi(r))}function kr(r){return _r(r).getComputedStyle(r)}function fo(r){return Nr(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function mn(r){if(gi(r)==="html")return r;let e=r.assignedSlot||r.parentNode||zv(r)&&r.host||on(r);return zv(e)?e.host:e}function Uv(r){let e=mn(r);return mi(e)?r.ownerDocument?r.ownerDocument.body:r.body:$r(e)&&va(e)?e:Uv(e)}function vl(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);let i=Uv(r),a=i===((n=r.ownerDocument)==null?void 0:n.body),o=_r(i);if(a){let s=yl(o);return e.concat(o,o.visualViewport||[],va(i)?i:[],s&&t?vl(s):[])}return e.concat(i,vl(i,[],t))}function yl(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function Yv(r){let e=kr(r),t=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=$r(r),a=i?r.offsetWidth:t,o=i?r.offsetHeight:n,s=co(t)!==a||co(n)!==o;return s&&(t=a,n=o),{width:t,height:n,$:s}}function qv(r){return Nr(r)?r:r.contextElement}function pa(r){let e=qv(r);if(!$r(e))return Ur(1);let t=e.getBoundingClientRect(),{width:n,height:i,$:a}=Yv(e),o=(a?co(t.width):t.width)/n,s=(a?co(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!s||!Number.isFinite(s))&&(s=1),{x:o,y:s}}var zx=Ur(0);function Xv(r){let e=_r(r);return!ml()||!e.visualViewport?zx:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Gx(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==_r(r)?!1:e}function vo(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);let i=r.getBoundingClientRect(),a=qv(r),o=Ur(1);e&&(n?Nr(n)&&(o=pa(n)):o=pa(r));let s=Gx(a,t,n)?Xv(a):Ur(0),u=(i.left+s.x)/o.x,l=(i.top+s.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(a){let h=_r(a),f=n&&Nr(n)?_r(n):n,v=h,p=yl(v);for(;p&&n&&f!==v;){let m=pa(p),g=p.getBoundingClientRect(),y=kr(p),b=g.left+(p.clientLeft+parseFloat(y.paddingLeft))*m.x,S=g.top+(p.clientTop+parseFloat(y.paddingTop))*m.y;u*=m.x,l*=m.y,c*=m.x,d*=m.y,u+=b,l+=S,v=_r(p),p=yl(v)}}return pi({width:c,height:d,x:u,y:l})}function Zu(r,e){let t=fo(r).scrollLeft;return e?e.left+t:vo(on(r)).left+t}function Kv(r,e,t){t===void 0&&(t=!1);let n=r.getBoundingClientRect(),i=n.left+e.scrollLeft-(t?0:Zu(r,n)),a=n.top+e.scrollTop;return{x:i,y:a}}function jx(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r,a=i==="fixed",o=on(n),s=e?ho(e.floating):!1;if(n===o||s&&a)return t;let u={scrollLeft:0,scrollTop:0},l=Ur(1),c=Ur(0),d=$r(n);if((d||!d&&!a)&&((gi(n)!=="body"||va(o))&&(u=fo(n)),$r(n))){let f=vo(n);l=pa(n),c.x=f.x+n.clientLeft,c.y=f.y+n.clientTop}let h=o&&!d&&!a?Kv(o,u,!0):Ur(0);return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-u.scrollLeft*l.x+c.x+h.x,y:t.y*l.y-u.scrollTop*l.y+c.y+h.y}}function Hx(r){return Array.from(r.getClientRects())}function Ux(r){let e=on(r),t=fo(r),n=r.ownerDocument.body,i=qn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=qn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),o=-t.scrollLeft+Zu(r),s=-t.scrollTop;return kr(n).direction==="rtl"&&(o+=qn(e.clientWidth,n.clientWidth)-i),{width:i,height:a,x:o,y:s}}function $x(r,e){let t=_r(r),n=on(r),i=t.visualViewport,a=n.clientWidth,o=n.clientHeight,s=0,u=0;if(i){a=i.width,o=i.height;let l=ml();(!l||l&&e==="fixed")&&(s=i.offsetLeft,u=i.offsetTop)}return{width:a,height:o,x:s,y:u}}function Wx(r,e){let t=vo(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,a=$r(r)?pa(r):Ur(1),o=r.clientWidth*a.x,s=r.clientHeight*a.y,u=i*a.x,l=n*a.y;return{width:o,height:s,x:u,y:l}}function $v(r,e,t){let n;if(e==="viewport")n=$x(r,t);else if(e==="document")n=Ux(on(r));else if(Nr(e))n=Wx(e,t);else{let i=Xv(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return pi(n)}function Zv(r,e){let t=mn(r);return t===e||!Nr(t)||mi(t)?!1:kr(t).position==="fixed"||Zv(t,e)}function Yx(r,e){let t=e.get(r);if(t)return t;let n=vl(r,[],!1).filter(s=>Nr(s)&&gi(s)!=="body"),i=null,a=kr(r).position==="fixed",o=a?mn(r):r;for(;Nr(o)&&!mi(o);){let s=kr(o),u=gl(o);!u&&s.position==="fixed"&&(i=null),(a?!u&&!i:!u&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||va(o)&&!u&&Zv(r,o))?n=n.filter(c=>c!==o):i=s,o=mn(o)}return e.set(r,n),n}function qx(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r,o=[...t==="clippingAncestors"?ho(e)?[]:Yx(e,this._c):[].concat(t),n],s=o[0],u=o.reduce((l,c)=>{let d=$v(e,c,i);return l.top=qn(d.top,l.top),l.right=uo(d.right,l.right),l.bottom=uo(d.bottom,l.bottom),l.left=qn(d.left,l.left),l},$v(e,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Xx(r){let{width:e,height:t}=Yv(r);return{width:e,height:t}}function Kx(r,e,t){let n=$r(e),i=on(e),a=t==="fixed",o=vo(r,!0,a,e),s={scrollLeft:0,scrollTop:0},u=Ur(0);if(n||!n&&!a)if((gi(e)!=="body"||va(i))&&(s=fo(e)),n){let h=vo(e,!0,a,e);u.x=h.x+e.clientLeft,u.y=h.y+e.clientTop}else i&&(u.x=Zu(i));let l=i&&!n&&!a?Kv(i,s):Ur(0),c=o.left+s.scrollLeft-u.x-l.x,d=o.top+s.scrollTop-u.y-l.y;return{x:c,y:d,width:o.width,height:o.height}}function Ku(r){return kr(r).position==="static"}function Wv(r,e){if(!$r(r)||kr(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return on(r)===t&&(t=t.ownerDocument.body),t}function Qv(r,e){let t=_r(r);if(ho(r))return t;if(!$r(r)){let i=mn(r);for(;i&&!mi(i);){if(Nr(i)&&!Ku(i))return i;i=mn(i)}return t}let n=Wv(r,e);for(;n&&jv(n)&&Ku(n);)n=Wv(n,e);return n&&mi(n)&&Ku(n)&&!gl(n)?t:n||Hv(r)||t}var Zx=function(r){return _t(this,null,function*(){let e=this.getOffsetParent||Qv,t=this.getDimensions,n=yield t(r.floating);return{reference:Kx(r.reference,yield e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function Qx(r){return kr(r).direction==="rtl"}var Jx={convertOffsetParentRelativeRectToViewportRelativeRect:jx,getDocumentElement:on,getClippingRect:qx,getOffsetParent:Qv,getElementRects:Zx,getClientRects:Hx,getDimensions:Xx,getScale:pa,isElement:Nr,isRTL:Qx};var Jv=Bv,ep=Fv;var tp=Vv,rp=(r,e,t)=>{let n=new Map,i=Lt({platform:Jx},t),a=qr(Lt({},i.platform),{_c:n});return kv(r,e,qr(Lt({},i),{platform:a}))};var op={position:"absolute",left:"0",top:"0",userSelect:"none",outlineStyle:"none",width:"100%",height:"100%"};function Cl(r){r.stopPropagation()}function mo(r){r.addEventListener("click",Cl),r.addEventListener("mousedown",Cl),r.addEventListener("mouseup",Cl),r.addEventListener("mousemove",Cl)}var po=class{constructor(e){this.adapter=e,this.updateOnRenderEnabled=!1,this.updateOnRenderOnceEnabled=!1,this.updateOnRenderOnce=()=>{this.updateOnRenderOnceEnabled||(this.updateOnRenderOnceEnabled=!0,this.cy.one("render",()=>{this.updateOnRenderOnceEnabled=!1,this.update()}))}}inVisibleBounds(e){return this.adapter.inVisibleBounds(e)}supportsRender(){return!1}renderInto(e){}get updateOnRender(){return this.updateOnRenderEnabled}set updateOnRender(e){this.updateOnRenderEnabled!==e&&(this.updateOnRenderEnabled=e,e?this.cy.on("render",this.update):this.cy.off("render",this.update))}get cy(){return this.adapter.cy}moveUp(){this.adapter.move(this,-1)}moveDown(){this.adapter.move(this,1)}moveBack(){this.adapter.move(this,Number.NEGATIVE_INFINITY)}moveFront(){this.adapter.move(this,Number.POSITIVE_INFINITY)}insertBefore(e,t){return this.adapter.insert("before",this,e,t)}insertAfter(e,t){return this.adapter.insert("after",this,e,t)}},ga=class extends po{constructor(e,t){super(e),this.callbacks=[],this.update=()=>{for(let n of this.callbacks)n(this.node)},this.root=t,Object.assign(this.root.style,op)}get visible(){return this.root.style.display!=="none"}set visible(e){this.visible!==e&&(this.root.style.display=e?"":"none")}show(){this.visible=!0}hide(){this.visible=!1}callback(e){return this.callbacks.push(e),this.update(),this}resize(){}remove(){this.root.remove()}},go="http://www.w3.org/2000/svg",Qu=class extends ga{constructor(e,t,n={}){super(e,t.createElementNS(go,"svg")),this.type="svg",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElementNS(go,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&mo(this.node)}setViewport(e,t,n){this.node.setAttribute("transform",`translate(${e},${t})scale(${n})`),this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},Ju=class extends ga{constructor(e,t,n={}){super(e,t.createElementNS(go,"svg")),this.type="svg-static",this.root.__cy_layer=this,this.node=t.createElementNS(go,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&mo(this.node)}setViewport(){}},bl=class extends po{constructor(e,t,n={}){var i,a;super(e),this.callbacks=[],this.transform={tx:0,ty:0,zoom:1},this.update=()=>this.draw(),this.node=t.createElement("canvas"),Object.assign(this.node.style,op),n.stopClicks&&mo(this.node),this.pixelRatio=(a=(i=n.pixelRatio)!==null&&i!==void 0?i:(window??{}).devicePixelRatio)!==null&&a!==void 0?a:1,this.ctx=this.node.getContext("2d",n),this.ctx.resetTransform()}get visible(){return this.node.style.display!=="none"}set visible(e){this.node.style.display=e?"":"none"}show(){this.visible=!0}hide(){this.visible=!1}get root(){return this.node}callback(e){return this.callbacks.push(e),this.update(),this}clear(){let e=this.ctx,t=e.getTransform();e.resetTransform(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.setTransform(t)}draw(){this.clear(),this.drawImpl(this.ctx)}drawImpl(e,t=1){e.save(),e.resetTransform(),e.scale(this.pixelRatio,this.pixelRatio),e.translate(this.transform.tx*t,this.transform.ty*t),e.scale(this.transform.zoom*t,this.transform.zoom*t);for(let n of this.callbacks)n(e,{});e.restore()}supportsRender(){return!0}renderInto(e){for(let t of this.callbacks)t(e,{forExport:!0})}resize(e,t){this.node.width=e*this.pixelRatio,this.node.height=t*this.pixelRatio,this.update()}setViewport(e,t,n){}remove(){this.node.remove()}},xl=class extends bl{constructor(e,t,n={}){super(e,t,n),this.type="canvas",this.node.__cy_layer=this}setViewport(e,t,n){this.transform.tx=e,this.transform.ty=t,this.transform.zoom=n,this.update()}},ec=class extends bl{constructor(e,t,n={}){super(e,t,n),this.type="canvas-static",this.node.__cy_layer=this}},tc=class extends ga{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElement("div"),this.node.__cy_layer=this,this.node.style.position="absolute",this.node.style.left="0px",this.node.style.top="0px",this.root.appendChild(this.node),n.stopClicks&&mo(this.node)}setViewport(e,t,n){this.node.style.transform=`translate(${e}px,${t}px)scale(${n})`,this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},rc=class extends ga{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html-static",this.node.__cy_layer=this,n.stopClicks&&mo(this.node)}get node(){return this.root}setViewport(){}},ma=class extends po{constructor(e,t){super(e),this.update=()=>{},this.node=t}get root(){return this.node}resize(){}setViewport(){}remove(){}supportsRender(){return!0}},nc=class extends ma{constructor(e,t){super(e,t),this.type="node",this.node.__cy_layer=this}},ic=class extends ma{constructor(e,t){super(e,t),this.type="drag",this.node.__cy_layer=this}},ac=class extends ma{constructor(e,t){super(e,t),this.type="select-box",this.node.__cy_layer=this}};function np(r,e,t){let n=Array.from(r.children);if(!t.uniqueElements){e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(t.isVisible(s))if(n.length>0)t.update(n.shift(),o,s);else{let u=t.enter(o,s);r.appendChild(u),t.update(u,o,s)}});for(let o of n)o.remove();return}let i=new Map(n.map(o=>[o.dataset.id,o])),a=-1;e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(!t.isVisible(s))return;a++;let u=o.id(),l=n[a],c=i.get(u),d;if(c){if(t.update(c,o,s),i.delete(u),l===c)return;d=c}else d=t.enter(o,s),d.dataset.id=u,t.update(d,o,s);a===0?r.insertAdjacentElement("afterbegin",d):n[a-1].insertAdjacentElement("afterend",d),n.splice(a,0,d)}),i.forEach(o=>o.remove())}function wl(r,e){return r.callback(e),{remove:()=>{r.callbacks.splice(r.callbacks.indexOf(e),1)}}}function sp(r){return{selector:":visible",updateOn:r!=null&&r.queryEachTime?"render":"position",queryEachTime:!1,checkBounds:!0}}function e2(r,e,t){let n=Object.assign({checkBoundsPointCount:5,initCollection:()=>{}},sp(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=c=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(c.off(n.updateOn,void 0,r.updateOnRenderOnce),c.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),c.targets().off(n.updateOn,void 0,r.updateOnRenderOnce));let d=r.cy.edges(n.selector);return n.initCollection(d),n.updateOn!=="none"&&n.updateOn!=="render"&&(d.on(n.updateOn,r.updateOnRenderOnce),d.sources().on(n.updateOn,r.updateOnRenderOnce),d.targets().on(n.updateOn,r.updateOnRenderOnce)),r.updateOnRenderOnce(),d};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let l=wl(r,(c,d)=>{n.queryEachTime&&(i=s(i)),i.forEach(h=>{if(h.removed())return;let f=h._private.rscratch,v=f&&f.startX!=null&&f.startY!=null?{x:f.startX,y:f.startY}:h.sourceEndpoint(),p=f&&f.endX!=null&&f.endY!=null?{x:f.endX,y:f.endY}:h.targetEndpoint();if(!d.forExport&&n.checkBounds&&n.checkBoundsPointCount>0&&!t2(r,v,p,n.checkBoundsPointCount))return;if(f&&f.pathCache){e(c,h,f.pathCache,v,p);return}let m=new Path2D;m.moveTo(v.x,v.y),m.lineTo(p.x,p.y),e(c,h,m,v,p)})});return{layer:r,edges:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(i.off(n.updateOn,void 0,r.updateOnRenderOnce),i.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),i.targets().off(n.updateOn,void 0,r.updateOnRenderOnce)),r.cy.off("add remove",n.selector,o),l.remove()}}}function t2(r,e,t,n){let i=o=>({x:e.x*o+t.x*(1-o),y:e.y*o+t.y*(1-o)});if(n===1)return r.inVisibleBounds(i(.5));let a=1/n;for(let o=0;o<=n;o++)if(r.inVisibleBounds(i(o*a)))return!0;return!1}function r2(r,e,t={}){let n=Object.assign({transform:"",position:"top-left",boundingBox:{includeLabels:!1,includeOverlays:!1},uniqueElements:!1,initCollection:()=>{}},sp(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=f=>{n.updateOn!=="none"&&n.updateOn!=="render"&&f.off(n.updateOn,void 0,r.updateOnRenderOnce);let v=r.cy.nodes(n.selector);return n.initCollection(v),n.updateOn!=="none"&&n.updateOn!=="render"&&v.on(n.updateOn,r.updateOnRenderOnce),r.updateOnRenderOnce(),v};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let u=f=>({layer:r,nodes:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&i.off(n.updateOn,void 0,r.updateOnRenderOnce),r.cy.off("add remove",n.selector,o),f.remove()}});if(r.type==="canvas"){let f=n;return u(wl(r,(p,m)=>{let g=p.getTransform();n.queryEachTime&&(i=s(i)),i.forEach(y=>{if(y.removed())return;let b=y.boundingBox(n.boundingBox);if(!(!m.forExport&&f.checkBounds&&!r.inVisibleBounds(b))){if(f.position==="top-left")p.translate(b.x1,b.y1);else if(f.position==="center"){let S=y.position();p.translate(S.x,S.y)}e(p,y,b),f.position!=="none"&&p.setTransform(g)}})}))}let l=n,c={bb:f=>f.boundingBox(l.boundingBox),isVisible:l.checkBounds?f=>r.inVisibleBounds(f):()=>!0,uniqueElements:l.uniqueElements===!0};if(l.checkBounds&&(r.updateOnTransform=!0),r.type==="html"){let f=qr(Lt({},c),{enter:(p,m)=>{let g=r.node.ownerDocument.createElement("div");return g.style.position="absolute",l.init&&l.init(g,p,m),g},update:(p,m,g)=>{if(l.position==="top-left")p.style.transform=`${l.transform}translate3d(${g.x1}px,${g.y1}px,0)`;else if(l.position==="center"){let y=m.position();p.style.transform=`${l.transform}translate3d(${y.x}px,${y.y}px,0)`}e(p,m,g)}});return u(wl(r,p=>{n.queryEachTime&&(i=s(i)),np(p,i,f)}))}let d=qr(Lt({},c),{enter:(f,v)=>{let p=r.node.ownerDocument.createElementNS(go,"g");return l.init&&l.init(p,f,v),p},update:(f,v,p)=>{if(l.position==="top-left")f.setAttribute("transform",`${l.transform}translate3d(${p.x1},${p.y1},0)`);else if(l.position==="center"){let m=v.position();f.setAttribute("transform",`${l.transform}translate3d(${m.x},${m.y},0)`)}e(f,v,p)}});return u(wl(r,f=>{n.queryEachTime&&(i=s(i)),np(f,i,d)}))}function n2(r,e){let t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function ip(r){let e=r.indexOf(",");return r.substring(e+1)}function ap(r,e,t){let n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Promise((i,a)=>{try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return n2(ip(n()),t);case"base64":return ip(n());case"base64uri":default:return n()}}function i2(r){return r.x!=null}var El=class extends Error{},oc=class{constructor(e){this.bak={},this.resize=()=>{let o=this.cy.width(),s=this.cy.height();this.viewport.width=o,this.viewport.height=s;for(let u of this.layers)u.resize(o,s)},this.destroy=()=>{for(let o of this.layers)o.remove();this.cy.off("destroy",this.destroy),this.cy.off("viewport",this.zoomed),this.cy.off("resize",this.resize),this.cy.scratch("_layers",void 0),this.cy.png=this.bak.png,this.cy.jpg=this.bak.jpg,this.cy.jpeg=this.bak.jpeg,this.bak={}},this.zoomed=()=>{let o=this.cy.pan(),s=this.cy.zoom();this.viewport.tx=o.x,this.viewport.ty=o.y,this.viewport.zoom=s;for(let u of this.layers)u.setViewport(o.x,o.y,s)},this.renderPerEdge=e2,this.renderPerNode=r2,this.cy=e,this.adapter={cy:this.cy,insert:(o,s,u)=>this.insert(o,s,u),move:(o,s)=>this.move(o,s),inVisibleBounds:o=>{let s=this.viewport,u=c=>{let d=c*s.zoom+s.tx;return d>=0&&d<=s.width},l=c=>{let d=c*s.zoom+s.ty;return d>=0&&d<=s.height};return i2(o)?u(o.x)&&l(o.y):u(o.x1)&&l(o.y1)||u(o.x2)&&l(o.y1)||u(o.x2)&&l(o.y2)||u(o.x1)&&l(o.y2)||u((o.x1+o.x2)/2)&&l((o.y1+o.y2)/2)}};let t=e.container(),n=new nc(this.adapter,t.querySelector('[data-id="layer2-node"]'));this.nodeLayer=n;let i=new ic(this.adapter,t.querySelector('[data-id="layer1-drag"]'));this.dragLayer=i;let a=new ac(this.adapter,t.querySelector('[data-id="layer0-selectbox"]'));this.selectBoxLayer=a,n.root.style.zIndex="",i.root.style.zIndex="",a.root.style.zIndex="",n.root.insertAdjacentElement("afterend",i.root),i.root.insertAdjacentElement("afterend",a.root),e.on("viewport",this.zoomed),e.on("resize",this.resize),e.on("destroy",this.destroy),this.bak={png:e.png,jpg:e.jpg,jpeg:e.jpeg},e.png=this.png.bind(this),e.jpg=this.jpg.bind(this),e.jpeg=this.jpeg.bind(this),this.viewport={width:this.cy.width(),height:this.cy.height(),tx:this.cy.pan().x,ty:this.cy.pan().y,zoom:this.cy.zoom()}}move(e,t){let n=this.layers,i=n.indexOf(e),a=Math.max(Math.min(i+t,n.length,0));a!==i&&(i>=n.length-1?this.root.appendChild(e.root):this.root.insertBefore(e.root,n[a].root))}get document(){return this.cy.container().ownerDocument}get root(){return this.nodeLayer.node.parentElement}get layers(){return Array.from(this.root.children).map(e=>e.__cy_layer).filter(e=>e!=null)}getLayers(){return this.layers}init(e){return e.resize(this.viewport.width,this.viewport.height),e.setViewport(this.viewport.tx,this.viewport.ty,this.viewport.zoom),e}update(){this.zoomed();for(let e of this.layers)e instanceof xl&&e.draw()}createLayer(e,t){switch(e){case"svg":return this.init(new Qu(this.adapter,this.document,t));case"html":return this.init(new tc(this.adapter,this.document,t));case"canvas":return this.init(new xl(this.adapter,this.document,t));case"html-static":return this.init(new rc(this.adapter,this.document,t));case"svg-static":return this.init(new Ju(this.adapter,this.document,t));case"canvas-static":return this.init(new ec(this.adapter,this.document,t))}}append(e,t){let n=this.createLayer(e,t);return this.root.appendChild(n.root),n}insert(e,t,n,i){let a=this.createLayer(n,i);return t.root.insertAdjacentElement(e==="before"?"beforebegin":"afterend",a.root),a}getLast(){var e;let t=this.layers;return(e=t[t.length-1])!==null&&e!==void 0?e:null}getFirst(){var e;return(e=this.layers[0])!==null&&e!==void 0?e:null}hasCustomLayer(){return this.layers.some(e=>!(e instanceof ma))}toCanvas(e){let t=this.layers;if(t.some(d=>!d.supportsRender)&&!e.ignoreUnsupportedLayers)throw new El("some layer doesn't support exporting, use {ignoreUnsupportedLayers: true} option to ignore");let n=t.indexOf(this.nodeLayer),i=t.indexOf(this.dragLayer),a=t.indexOf(this.selectBoxLayer);if((n!==i-1||i!==a-1)&&!e.ignoreUnsupportedLayerOrder)throw new El("cytoscape layers are not in order, use {ignoreUnsupportedLayerOrder: true} option to ignore");let o=t.slice(0,n).reverse().filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),s=t.slice(n+1).filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),u=this.cy.renderer(),l=u.drawElements;u.drawElements=function(d,h){for(let f of o)f.renderInto(d);l.call(this,d,h);for(let f of s)f.renderInto(d)};let c=u.bufferCanvasImage(e);return u.drawElements=l,c}png(e){return this.hasCustomLayer()?ap(e??{},this.toCanvas(e??{}),"image/png"):this.bak.png.call(this.cy,e)}jpg(e){if(!this.hasCustomLayer())return this.bak.jpg.call(this.cy,e);let t=Lt({bg:"#fff"},e??{});return ap(t,this.toCanvas(t),"image/png")}jpeg(e){return this.hasCustomLayer()?this.jpg(e):this.bak.jpeg.call(this.cy,e)}};function a2(r=this){if(!r.container())throw new Error("layers plugin does not work in headless environments");let e=r.scratch("_layers");if(e)return e;let t=new oc(r);return r.scratch("_layers",t),t}function sc(r){r("core","layers",a2)}typeof window.cytoscape<"u"&&sc(window.cytoscape);var hp=Eo(lp());function o2(r,e){if(r&1&&(U(0,"mat-option",6),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ct(t)}}function s2(r,e){if(r&1&&(U(0,"mat-option",6),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ct(t)}}var up=(()=>{class r{constructor(t,n,i){this.dialogRef=t,this.fb=n,this.data=i,this.projects=[],this.analysisGroups=[],this.form=this.fb.group({log2fc:[0],pvalue:[0],projectNames:[[]],analysisGroupNames:[[]]}),this.filter=To,this.projects=i.projects,this.analysisGroups=i.analysisGroups,this.form.patchValue(i.currentFilter)}close(){this.dialogRef.close()}submit(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At),Oe(kt),Oe($c))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-cytoscape-plot-filter-dialog"]],decls:29,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","type","number","formControlName","log2fc"],["matInput","","type","number","formControlName","pvalue"],["formControlName","projectNames","multiple",""],[3,"value"],["formControlName","analysisGroupNames","multiple",""],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(U(0,"h5",0),ae(1,"Filter Cytoscape Plot"),K(),U(2,"div",1)(3,"form",2)(4,"mat-form-field"),Fe(5,"input",3),U(6,"mat-label"),ae(7,"Absolute Log2 Fold Change"),K()(),U(8,"mat-form-field"),Fe(9,"input",4),U(10,"mat-label"),ae(11,"-log10(P Value)"),K()(),U(12,"mat-form-field")(13,"mat-label"),ae(14,"Project Names"),K(),U(15,"mat-select",5),tt(16,o2,2,2,"mat-option",6,mr),K()(),U(18,"mat-form-field")(19,"mat-label"),ae(20,"Analysis Group Names"),K(),U(21,"mat-select",7),tt(22,s2,2,2,"mat-option",6,mr),K()()()(),U(24,"div",8)(25,"button",9),ge("click",function(){return i.close()}),ae(26,"Cancel"),K(),U(27,"button",9),ge("click",function(){return i.submit()}),ae(28,"Filter"),K()()),n&2&&(ie(3),Ee("formGroup",i.form),ie(13),rt(i.projects),ie(6),rt(i.analysisGroups))},dependencies:[Dt,Pt,Xt,qt,Wt,Ii,Et,Yt,or,sr,Ft,Kt,Ot,yt,lr,An,Pr],encapsulation:2})}}return r})();var l2=(r,e)=>e.id;function u2(r,e){if(r&1&&(U(0,"mat-option",13),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ct(t.official_name)}}function c2(r,e){r&1&&tt(0,u2,2,2,"mat-option",13,l2),r&2&&rt(e)}var cp=(()=>{class r{constructor(t,n,i){this.dialogRef=t,this.fb=n,this.webService=i,this.form=this.fb.group({organism:[""],score:[400],networkType:["functional"],addNodes:[0]}),this.filteredSpecies$=new Cc([]),this.form.controls.organism.valueChanges.pipe(xc(300),Ei(a=>a&&typeof a=="string"?this.webService.getSpecies(void 0,5,0,a):wc({results:[]}))).subscribe(a=>{a.results&&this.filteredSpecies$.next(a.results)})}displayFn(t){return t?`${t.official_name} (${t.code})`:""}selectOrganism(t){this.form.controls.organism.setValue(t)}close(){this.dialogRef.close()}submit(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At),Oe(kt),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-string-db-dialog"]],decls:33,vars:6,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","formControlName","organism",3,"matAutocomplete"],[3,"optionSelected","displayWith"],["matInput","","type","number","formControlName","score"],["formControlName","networkType"],["value","functional"],["value","physical"],["matInput","","type","number","formControlName","addNodes"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"value"]],template:function(n,i){if(n&1){let a=$e();U(0,"h5",1),ae(1,"Request STRING DB Interactions"),K(),U(2,"div",2)(3,"form",3)(4,"mat-form-field"),Fe(5,"input",4),U(6,"mat-label"),ae(7,"Organism"),K(),U(8,"mat-autocomplete",5,0),ge("optionSelected",function(s){return De(a),Pe(i.selectOrganism(s.option.value))}),ke(10,c2,2,0),Mi(11,"async"),K()(),U(12,"mat-form-field"),Fe(13,"input",6),U(14,"mat-label"),ae(15,"Score Cutoff"),K()(),U(16,"mat-form-field")(17,"mat-label"),ae(18,"Network Type"),K(),U(19,"mat-select",7)(20,"mat-option",8),ae(21,"Functional"),K(),U(22,"mat-option",9),ae(23,"Physical"),K()()(),U(24,"mat-form-field"),Fe(25,"input",10),U(26,"mat-label"),ae(27,"Additional Nodes"),K()()()(),U(28,"div",11)(29,"button",12),ge("click",function(){return De(a),Pe(i.close())}),ae(30,"Cancel"),K(),U(31,"button",12),ge("click",function(){return De(a),Pe(i.submit())}),ae(32,"Request"),K()()}if(n&2){let a,o=ir(9);ie(3),Ee("formGroup",i.form),ie(2),Ee("matAutocomplete",o),ie(3),Ee("displayWith",i.displayFn),ie(2),Ue((a=Ai(11,4,i.filteredSpecies$.asObservable()))?10:-1,a)}},dependencies:[lr,Kt,Ft,Xt,qt,Wt,Ii,Et,Yt,or,sr,Pt,Dt,Pr,An,Ot,yt,Ni,ki,Di],encapsulation:2})}}return r})();var qT=function(r,e){e===void 0&&(e=10);var t,n,i,a={},o="50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro".split(",");for(t=0;t<o.length;t+=2)n="&"+o[t+1]+";",i=parseInt(o[t],e),a[n]="&#"+i+";";return a["\\xa0"]="&#160;",a}(0,32);var d2=["cy"];function h2(r,e,t){let n=Lt({middleware:[ep(),Jv({limiter:tp()})]},t);function i(){let a=r.getBoundingClientRect();rp(r,e,n).then(({x:o,y:s})=>Object.assign(e.style,{left:`${a.left}px`,top:`${s}px`,position:"absolute",transform:"translate(-50%, -50%)","background-color":"#333",color:"#fff",padding:"5px 10px","border-radius":"4px","font-size":"12px","box-shadow":"0 2px 10px rgba(0, 0, 0, 0.2)","pointer-events":"none"}))}return i(),{update:i}}var fp=(()=>{class r{constructor(t,n,i,a){this.collateService=t,this.cdr=n,this.dialog=i,this.webService=a,this.showBarChart=!0,this.showCytoscapePlot=!1,this.projects=[],this.searchResultsMap={},this.renameCondition={},this.currentPopperRef=null,this.currentTooltip=null,this.barChartLayers=new Map,this.projectColorMap={},this.cytoscapeElements=[],this.currentFilter={log2fc:0,pvalue:0,projectNames:[],analysisGroupNames:[]}}ngAfterViewInit(){Hr.use(hp.default),Hr.use((0,dp.default)(h2)),Hr.use(sc),this.initCytoscape(),this.collateService.collateRedrawSubject.subscribe(()=>{this.updateCytoscape()})}updateCytoscape(){this.cdr.detectChanges(),this.cy.destroy(),this.initCytoscape()}initCytoscape(){if(this.cyElement){let t=this.buildGraphElements();this.cytoscapeElements=t,this.cy=Hr({container:this.cyElement.nativeElement,elements:t,style:[{selector:"node",style:{label:"data(label)","background-color":"#666",width:"data(size)",height:"data(size)"}},{selector:".protein",style:{"background-color":"#FF5733"}},{selector:".analysis",style:{"background-color":"#ba0000",label:""}},{selector:".comparison",style:{"background-color":"#33A1FF",label:""}},{selector:"edge[color]",style:{width:2,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"triangle","curve-style":"bezier","control-point-step-size":40}}],layout:{name:"fcose",animate:!0,animationDuration:1e3,padding:30,nodeSeparation:200,idealEdgeLength:100,nodeRepulsion:4500,edgeElasticity:.45,gravity:.25,numIter:2500,tile:!0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.5}}),this.cy.nodes(".comparison").forEach(i=>{i.on("mouseover",a=>{let s=a.target.data().label;this.currentPopperRef=a.target.popper({content:()=>{let u=document.createElement("div");return u.classList.add("cy-tooltip"),u.innerHTML=s,document.body.appendChild(u),this.currentTooltip=u,u},popper:{placement:"bottom",removeOnDestroy:!0}})}),i.on("mouseout",()=>{this.currentTooltip&&(document.body.removeChild(this.currentTooltip),this.currentTooltip=null)}),i.on("click",a=>{let o=a.target,s=o.style("label");o.style("label",s?"":o.data("label"))})});let n=this.cy.layers();this.cy.edges().forEach(i=>{i.on("click",s=>{let u=s.target,l=u.data("showBarChart");u.data("showBarChart",!l),this.drawBarChartOnEdges(n),this.cy.batch(()=>{this.cy.nodes().forEach(c=>{c.trigger("position")})})}),i.on("mouseover",s=>{let u=s.target.data(),l=`Comparison: ${u.conditionA} vs ${u.conditionB}<br>Project: ${u.project}<br>Analysis Group: ${u.analysis_group} <br>Log2FC: ${u.fc}<br>-Log10(p): ${u.p_value}<br> Intensity ${u.conditionA}: ${u.intensityA}<br>Intensity ${u.conditionB}: ${u.intensityB}`;this.currentPopperRef=s.target.popper({content:()=>{let c=document.createElement("div");return c.classList.add("cy-tooltip"),c.innerHTML=l,document.body.appendChild(c),this.currentTooltip=c,c},popper:{placement:"bottom",removeOnDestroy:!0}})}),i.on("mouseout",()=>{this.currentTooltip&&(document.body.removeChild(this.currentTooltip),this.currentTooltip=null)});let a=!1,o={x:0,y:0};i.on("mousedown",s=>{a=!0,o=s.position}),this.cy.on("mousemove",s=>{if(a){let u=s.position;i.data("barChartPos",u),this.cy.trigger("render")}}),this.cy.on("mouseup",()=>{a=!1})})}}drawBarChartOnEdges(t){t.renderPerEdge(t.nodeLayer.insertAfter("canvas"),(n,i,a,o,s)=>{!this.showBarChart||!i.data("showBarChart")||this.renderBarChart(i,o,s,n)})}renderBarChart(t,n,i,a){let o=t.data(),s=parseFloat(o.intensityA),u=parseFloat(o.intensityB),l=5,c=25,d=Math.max(s,u),h=s/d*c,f=u/d*c,v=o.barChartPos||{x:(n.x+i.x)/2,y:(n.y+i.y)/2},p=t.source().position(),m=t.target().position(),g=Math.sqrt(Math.pow(m.x-p.x,2)+Math.pow(m.y-p.y,2)),y=((v.x-p.x)*(m.x-p.x)+(v.y-p.y)*(m.y-p.y))/Math.pow(g,2),b=p.x+y*(m.x-p.x)-l,S=p.y+y*(m.y-p.y)+c;a.fillStyle="white",a.fillRect(b-l-2,S-c-3,l*2+6,c+5),a.strokeStyle="black",a.strokeRect(b-l-2,S-c-3,l*2+6,c+5),a.fillStyle="red",a.fillRect(b-l,S-h,l,h),a.fillStyle="blue",a.fillRect(b+2,S-f,l,f)}buildGraphElements(){let t=[],n=new Set,i={};return console.log(this.searchResultsMap),this.projects.forEach(a=>{let o=this.searchResultsMap[a.id]||[];i[a.id]||(i[a.id]=`#${Math.floor(Math.random()*16777215).toString(16)}`);let s=i[a.id];o.forEach(u=>{let l=u.gene_name||u.uniprot_id||u.primary_id;n.has(l)||(t.push({data:{id:l,label:l,size:25},classes:"protein"}),n.add(l));let c=u.condition_A,d=u.condition_B;this.renameCondition[a.id]&&(this.renameCondition[a.id][u.condition_A]&&(c=this.renameCondition[a.id][u.condition_A]),this.renameCondition[a.id][u.condition_B]&&(d=this.renameCondition[a.id][u.condition_B]));let h=`${c} vs ${d}`;n.has(h)||(t.push({data:{id:h,label:`${c} vs ${d}`,size:25},classes:"comparison"}),n.add(h));let f=u.searched_data.filter(b=>b.Condition===u.condition_A&&b.Value),v=u.searched_data.filter(b=>b.Condition===u.condition_B&&b.Value),p=0,m=0;f.length>0&&(p=f.reduce((b,S)=>b+S.Value,0)/f.length),v.length>0&&(m=v.reduce((b,S)=>b+S.Value,0)/v.length);let g=u.log2_fc>0?l:h,y=u.log2_fc>0?h:l;t.push({data:{id:`${l}-${h}-${a.id}-${u.analysis_group.id}`,source:g,target:y,color:s,conditionA:c,conditionB:d,intensityA:p,intensityB:m,analysis_group:u.analysis_group.name,project:a.name,fc:u.log2_fc,p_value:u.log10_p}})})}),this.projectColorMap=i,t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot}toggleBarChart(){this.showBarChart=!this.showBarChart,this.updateCytoscape()}getRandomColor(){return`#${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`}getProjectColor(t){return this.projectColorMap[t]||"#000000"}toggleAllComparisons(t,n){this.cy.nodes(n).forEach(i=>{t?i.style("label",i.data("label")):i.style("label","")})}resetZoomAndCenter(){this.cy.fit(),this.cy.center()}openFilterDialog(){let t=Array.from(new Set(this.cytoscapeElements.map(a=>a.data.project))),n=Array.from(new Set(this.cytoscapeElements.map(a=>a.data.analysis_group)));this.dialog.open(up,{data:{projects:t,analysisGroups:n,currentFilter:this.currentFilter}}).afterClosed().subscribe(a=>{a&&(this.applyFilter(a.log2fc,a.pvalue,a.projectNames,a.analysisGroupNames),this.currentFilter=a)})}applyFilter(t,n,i=[],a=[]){let o=this.cytoscapeElements.filter(h=>{if(h.data.fc!==void 0&&h.data.p_value!==void 0){let f=Math.abs(h.data.fc),v=Math.abs(t);return i.length>0&&!i.includes(h.data.project)||a.length>0&&!a.includes(h.data.analysis_group)?!1:f>=v&&h.data.p_value>=n}return!0}),s=o.filter(h=>h.data.source!==void 0&&h.data.target!==void 0),u=new Set(s.map(h=>h.data.source).concat(s.map(h=>h.data.target))),l=new Set(s.map(h=>h.data.id)),c=o.filter(h=>u.has(h.data.id)),d=new Set(c.map(h=>h.data.id));console.log(d),this.cy.batch(()=>{let h=[];this.cy.edges().forEach(f=>{let v=f.data();h.push(v.id),l.has(v.id)||f.remove()}),this.cy.nodes().forEach(f=>{let v=f.data();h.push(v.id),d.has(v.id)||f.remove()}),c.forEach(f=>{h.includes(f.data.id)||this.cy.add(f)}),s.forEach(f=>{h.includes(f.data.id)||this.cy.add(f)})}),this.cy.layout({name:"fcose",animate:!0,animationDuration:1e3}).run()}openStringDBDialog(){this.dialog.open(cp).afterClosed().subscribe(n=>{if(n){let i=this.cy.nodes("proteins").map(s=>s.data("id").split(";")),a=[].concat.apply([],i),o=Array.from(new Set(a));this.requestStringDBInteractions(o,n.organism.taxon,n.score,n.networkType,n.addNodes)}})}requestStringDBInteractions(t,n,i,a,o){this.webService.getStringDBInteractions(t,n,i,a,o).subscribe(s=>{let u=s;u&&this.addStringDBInteractions(u)})}addStringDBInteractions(t){let n=new Set,i=new Set;t.forEach(a=>{let{preferredName_A:o,preferredName_B:s,score:u}=a,l=o,c=s;this.cy.nodes().forEach(h=>{let f=h.data("id"),v=f.split(";");v.includes(o)&&(l=f),v.includes(s)&&(c=f)}),!this.cy.getElementById(l).length&&!n.has(l)&&(this.cy.add({data:{id:l,label:o,size:25},classes:"string-protein"}),n.add(l)),!this.cy.getElementById(c).length&&!n.has(c)&&(this.cy.add({data:{id:c,label:s,size:25},classes:"string-protein"}),n.add(c));let d=`${l}-${c}`;i.has(d)||(this.cy.add({data:{id:d,source:l,target:c,score:u},classes:"string-edge"}),i.add(d)),this.cy.nodes().forEach(h=>{let f=h.data("id"),v=f.split(";");if(v.includes(o)&&!v.includes(s)){let p=`${f}-${c}`;i.has(p)||(this.cy.add({data:{id:p,source:f,target:c,score:u},classes:"string-edge"}),i.add(p))}if(v.includes(s)&&!v.includes(o)){let p=`${f}-${l}`;i.has(p)||(this.cy.add({data:{id:p,source:f,target:l,score:u},classes:"string-edge"}),i.add(p))}})}),this.cy.style().selector(".string-protein").style({shape:"rectangle","background-color":"#FF5733",label:"data(label)",width:30,height:30}).selector(".string-edge").style({"line-color":"#FF5733",width:2,"line-style":"dashed","target-arrow-shape":"none"}).update(),this.cy.layout({name:"fcose",animate:!0,animationDuration:1e3}).run()}exportToSvg(){if(!this.cy||!this.cy.container())return;let t=this.cy.container().querySelector("canvas"),n=(void 0)(t),i=new Blob([n],{type:"image/svg+xml"}),a=URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download="cytoscape-plot.svg",o.click(),URL.revokeObjectURL(a)}static{this.\u0275fac=function(n){return new(n||r)(Oe(Kr),Oe(_n),Oe(Tn),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-cytoscape-plot"]],viewQuery:function(n,i){if(n&1&&_i(d2,5),n&2){let a;Ti(a=Si())&&(i.cyElement=a.first)}},inputs:{projects:"projects",searchResultsMap:"searchResultsMap",renameCondition:"renameCondition"},decls:31,vars:2,consts:[["labelOn",""],["labelOff",""],["cy",""],[2,"display","flex"],["matTooltip","Toggle on labels","mat-icon-button","",3,"matMenuTriggerFor"],["matTooltip","Toggle off labels","mat-icon-button","",3,"matMenuTriggerFor"],["matTooltip","Reset and center plot","mat-icon-button","",3,"click"],["matTooltip","Filter Cytoscape Plot","mat-icon-button","",3,"click"],["mat-icon-button","","matTooltip","Add STRING DB Interactions",3,"click"],["mat-icon-button","","matTooltip","Export to SVG",3,"click"],["mat-menu-item","",3,"click"],[1,"cy-container"]],template:function(n,i){if(n&1){let a=$e();U(0,"div",3)(1,"button",4)(2,"mat-icon"),ae(3,"label"),K()(),U(4,"button",5)(5,"mat-icon"),ae(6,"label_off"),K()(),U(7,"button",6),ge("click",function(){return De(a),Pe(i.resetZoomAndCenter())}),U(8,"mat-icon"),ae(9,"center_focus_strong"),K()(),U(10,"button",7),ge("click",function(){return De(a),Pe(i.openFilterDialog())}),U(11,"mat-icon"),ae(12,"filter_list"),K()(),U(13,"button",8),ge("click",function(){return De(a),Pe(i.openStringDBDialog())}),U(14,"mat-icon"),ae(15,"add_circle"),K()(),U(16,"button",9),ge("click",function(){return De(a),Pe(i.exportToSvg())}),U(17,"mat-icon"),ae(18,"save_alt"),K()()(),U(19,"mat-menu",null,0)(21,"button",10),ge("click",function(){return De(a),Pe(i.toggleAllComparisons(!0,".comparison"))}),U(22,"span"),ae(23,"Comparison"),K()()(),U(24,"mat-menu",null,1)(26,"button",10),ge("click",function(){return De(a),Pe(i.toggleAllComparisons(!1,".comparison"))}),U(27,"span"),ae(28,"Comparison"),K()()(),Fe(29,"div",11,2)}if(n&2){let a=ir(20),o=ir(25);ie(),Ee("matMenuTriggerFor",a),ie(3),Ee("matMenuTriggerFor",o)}},dependencies:[ar,Xr,Li,Bi,Fi,Vi],styles:[`.cy-container{width:100%;height:600px;border:1px solid #ccc}.edge-hover{transition:stroke-width .3s,stroke .3s;stroke-width:4px!important;stroke:red!important}.legend{position:absolute;bottom:10px;right:10px;background-color:#fffc;padding:10px;border-radius:5px;box-shadow:0 2px 10px #0003}.legend-color{display:inline-block;width:20px;height:20px;margin-right:5px;vertical-align:middle}
`],encapsulation:2})}}return r})();function f2(r,e){if(r&1&&(U(0,"mat-option",4),ae(1),K()),r&2){let t=e.$implicit;Ro("value",t),ie(),ct(t)}}var vp=(()=>{class r{set selectedSearchTerms(t){this.form.controls.searchTerms.setValue(t)}constructor(t,n){this.fb=t,this.dialogRef=n,this.searchTerms=[],this.form=this.fb.group({searchTerms:this.fb.control([])})}close(){this.dialogRef.close()}submit(){this.dialogRef.close(this.form.value)}static{this.\u0275fac=function(n){return new(n||r)(Oe(kt),Oe(At))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-cytoscape-term-result-filter-dialog"]],inputs:{searchTerms:"searchTerms",selectedSearchTerms:"selectedSearchTerms"},decls:15,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["formControlName","searchTerms",3,"multiple"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(U(0,"h5",0),ae(1,"Cytoscape Plot Search Term Filter"),K(),U(2,"div",1)(3,"form",2)(4,"mat-form-field")(5,"mat-select",3),tt(6,f2,2,2,"mat-option",4,mr),K(),U(8,"mat-label"),ae(9,"Search Terms"),K()()()(),U(10,"div",5)(11,"button",6),ge("click",function(){return i.close()}),ae(12,"Cancel"),K(),U(13,"button",6),ge("click",function(){return i.submit()}),ae(14,"Apply"),K()()),n&2&&(ie(3),Ee("formGroup",i.form),ie(2),Ee("multiple",!0),ie(),rt(i.searchTerms))},dependencies:[Dt,Pt,Xt,qt,Et,Yt,or,sr,Ft,An,Pr,Ot,yt,lr],encapsulation:2})}}return r})();var v2=r=>({"disabled-icon":r});function p2(r,e){r&1&&(U(0,"button",11),ae(1,"No previous searches"),K())}function g2(r,e){if(r&1){let t=$e();U(0,"button",13),ge("click",function(){De(t);let i=ce().$implicit,a=ce(3);return Pe(a.restoreSearches(i.searchQuery,i.searchID))}),ae(1),K()}if(r&2){let t=ce().$implicit;ie(),Ic("",t.searchID,". ",t.termFounds.join(","),"")}}function m2(r,e){if(r&1&&ke(0,g2,2,2,"button",12),r&2){let t=e.$implicit,n=ce(3);Ue(t.collate===n.collate.id?0:-1)}}function y2(r,e){if(r&1&&tt(0,m2,1,1,null,null,mr),r&2){let t=ce(2);rt(t.pastSearches)}}function C2(r,e){if(r&1&&(U(0,"button",10)(1,"mat-icon"),ae(2,"history"),K()(),U(3,"mat-menu",null,0),ke(5,p2,2,0,"button",11)(6,y2,2,0),K()),r&2){let t=ir(4),n=ce();Ee("matMenuTriggerFor",t),ie(5),Ue(n.pastSearches.length===0?5:6)}}function w2(r,e){if(r&1){let t=$e();U(0,"button",14),ge("click",function(){De(t);let i=ce();return Pe(i.navigateToEdit())}),U(1,"mat-icon"),ae(2,"edit"),K()()}}function b2(r,e){if(r&1&&Fe(0,"app-collate-header",7),r&2){let t=ce();Ee("collate",t.collate)}}function x2(r,e){if(r&1&&(U(0,"div",15),Fe(1,"app-collate-tags",16),K()),r&2){let t=ce(2);ie(),Ee("collageTags",t.collate.tags)}}function E2(r,e){if(r&1&&ke(0,x2,2,1,"div",15),r&2){let t=ce();Ue(t.collate.settings.showTags?0:-1)}}function _2(r,e){if(r&1){let t=$e();U(0,"button",25),ge("click",function(){De(t);let i=ce(2);return Pe(i.filterCytoscapePlot())}),U(1,"mat-icon"),ae(2,"filter_list"),K()()}}function T2(r,e){if(r&1&&Fe(0,"app-cytoscape-plot",21),r&2){let t=ce(2);Ee("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("searchResultsMap",t.cytoscapePlotFilteredResults)}}function S2(r,e){if(r&1){let t=$e();ae(0),U(1,"button",27),ge("click",function(){De(t);let i=ce().$implicit,a=ce(2);return Pe(a.exportData(i))}),U(2,"mat-icon"),ae(3,"download"),K()()}if(r&2){let t=ce().$implicit,n=ce(2);ot(" ",t," "),ie(),Ee("disabled",n.waitingForDownload)}}function M2(r,e){r&1&&(U(0,"mat-tab"),ke(1,S2,4,2,"ng-template",26),K())}function A2(r,e){if(r&1&&Fe(0,"app-collate-project-list",24),r&2){let t=ce(2);Ee("searchTerm",t.selectedSearchTerm)("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("filteredResults",t.filteredResults)}}function D2(r,e){if(r&1){let t=$e();U(0,"div",17)(1,"button",18),ge("click",function(){De(t);let i=ce();return Pe(i.toggleCytoscapePlot())}),U(2,"mat-icon",19),ae(3,"account_tree"),K()(),ke(4,_2,3,0,"button",20),K(),ke(5,T2,1,3,"app-cytoscape-plot",21),U(6,"div",22)(7,"mat-tab-group",23),ge("selectedTabChange",function(){De(t);let i=ce();return Pe(i.filterDataBySearchTerm())}),wr("selectedIndexChange",function(i){De(t);let a=ce();return Cr(a.selectedIndex,i)||(a.selectedIndex=i),Pe(i)}),tt(8,M2,2,0,"mat-tab",null,mr),K()(),ke(10,A2,1,4,"app-collate-project-list",24)}if(r&2){let t=ce();ie(2),Ee("ngClass",ba(6,v2,!t.showCytoscapePlot)),ie(2),Ue(t.showCytoscapePlot?4:-1),ie(),Ue(t.collate&&t.showCytoscapePlot&&t.cytoscapePlotFilteredResults?5:-1),ie(2),yr("selectedIndex",t.selectedIndex),Ee("mat-stretch-tabs",!1),ie(),rt(t.searchTerms),ie(2),Ue(t.collate?10:-1)}}var _l=(()=>{class r{set sessionId(t){t&&this.collate&&this.getSearchFromID(t),this._sessionId=t}get sessionId(){return this._sessionId}set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this.collate=n,this.title.setTitle(`${n.title} - C|nder`),this.projects=n.projects,n.settings||(n.settings={projectOrder:[],analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),n.settings.plotSettings||(n.settings.plotSettings={}),n.settings.projectOrder&&(this.projects=n.settings.projectOrder.map(i=>n.projects.find(a=>a.id===i))),!this.collate?.settings.projectAnalysisGroupVisibility){this.collate.settings.projectAnalysisGroupVisibility={};for(let i of this.projects)this.collate.settings.projectAnalysisGroupVisibility[i.id]={}}if(this.collate?.settings.renameSampleCondition)this.sessionId&&this.getSearchFromID(this.sessionId);else{this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)});this.sessionId&&this.getSearchFromID(this.sessionId)}console.log(this.projects)})}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot,console.log(this.cytoscapePlotFilteredResults)}constructor(t,n,i,a,o,s,u,l,c){this.cdr=t,this.title=n,this.ws=i,this.sb=a,this.dialog=o,this.collateService=s,this.web=u,this.accounts=l,this.router=c,this.selectedCytoscapePlotSearchTerm=[],this.showCytoscapePlot=!1,this._sessionId=null,this.collate=null,this.projects=[],this.filteredResults={},this.searchTerms=[],this.selectedIndex=0,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this._selectedSearchTerm="",this.pastSearches=[],this.waitingForDownload=!1,this.cytoscapePlotFilteredResults={};let d=localStorage.getItem("cinderPastSearches");d&&(this.pastSearches=JSON.parse(d)),this.ws.searchWSConnection?.subscribe(h=>{if(h&&h.type==="export_status"&&this.web.cinderInstanceID===h.instance_id&&this.waitingForDownload)switch(h.status){case"error":this.waitingForDownload=!1;break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.waitingForDownload=!1,this.sb.open("Export complete","Dismiss",{duration:2e3});let f=`${this.web.baseURL}/api/search/download_temp_file/?token=${h.file}`;window.open(f,"_blank");break}})}associateAnalysisGroupsWithProjects(){return _t(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return _t(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),console.log(this.searchResults),this.searchTerms.sort((n,i)=>n.localeCompare(i)),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(t){let n={};return console.log(t),Object.keys(this.searchResults).forEach(i=>{n[i]=this.searchResults[i].filter(a=>t.includes(a.search_term)),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let o=parseInt(a),s=this.collate?.settings.analysisGroupOrderMap[o];if(!n[o]||!s)return;let u=n[o].filter(l=>!s.includes(l.analysis_group.id));if(n[o]=n[o].filter(l=>s.includes(l.analysis_group.id)),n[o]=n[o].sort((l,c)=>s.indexOf(l.analysis_group.id)-s.indexOf(c.analysis_group.id)),n[o].concat(u),this.collate?.settings?.projectAnalysisGroupVisibility){let l=this.collate?.settings.projectAnalysisGroupVisibility[o];n[o]=n[o].filter(c=>!l||!(c.analysis_group.id in l)?!0:l[c.analysis_group.id])}})}),console.log(n),n}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults([this.selectedSearchTerm]),Object.keys(this.cytoscapePlotFilteredResults).length===0&&this.filteredResults&&(console.log(this.filteredResults),this.cytoscapePlotFilteredResults=Object.assign({},this.filteredResults))}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{this.searchSession=n}),this.web.getSearchResults(t,99999).subscribe(n=>{if(!this.collate)return;console.log(n.results);let i=Array.from(new Set(n.results.map(o=>o.search_term)));this.pastSearches.find(o=>o.searchID===t)||(this.pastSearches.push({searchQuery:null,termFounds:i,collate:this.collate.id,searchID:t}),this.pastSearches=this.pastSearches.slice(-20),localStorage.setItem("cinderPastSearches",JSON.stringify(this.pastSearches))),this.distributeSearchResults(n.results).then()})}restoreSearches(t,n){this.web.getSearchSession(n).subscribe(i=>{this.searchSession=i}),t?this.distributeSearchResults(t.results).then():this.web.getSearchResults(n,99999).subscribe(i=>{this.distributeSearchResults(i.results).then()})}navigateToEdit(){this.collate&&this.router.navigate([`/collate/edit/${this.collate.id}`])}openQRCodeDialog(){let t=window.location.href,n=this.dialog.open(pd);n.componentInstance.url=t}navigateToHome(){this.router.navigate(["/"])}exportData(t){this.web.exportSearchData(this.searchSession.id,t,1e-8,1e-8,this.web.searchSessionID).subscribe(n=>{this.waitingForDownload=!0})}openVisibilityDialog(){let t=this.dialog.open(hs);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),u=this.collate?.settings.analysisGroupOrderMap[s];if(!u||!i[s])return;let l=i[s].filter(c=>!u.includes(c.id));i[s]=i[s].filter(c=>u.includes(c.id)),i[s]=i[s].sort((c,d)=>u.indexOf(c.id)-u.indexOf(d.id)),i[s]=i[s].concat(l)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults([this.selectedSearchTerm]))})}filterCytoscapePlot(){let t=this.dialog.open(vp);t.componentInstance.searchTerms=this.searchTerms,t.componentInstance.selectedSearchTerms=this.selectedCytoscapePlotSearchTerm,t.afterClosed().subscribe(n=>{if(n){if(console.log(n),n.searchTerms.length>0){let i=this.getFilteredSearchResults(n.searchTerms);this.cytoscapePlotFilteredResults=Lt({},i)}else this.cytoscapePlotFilteredResults={};console.log(this.cytoscapePlotFilteredResults),this.cdr.detectChanges(),this.collateService.collateRedrawSubject.next(!0)}})}static{this.\u0275fac=function(n){return new(n||r)(Oe(_n),Oe(Bc),Oe(Ho),Oe(Vr),Oe(Tn),Oe(Kr),Oe(Zt),Oe(Zr),Oe(Pi))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-view"]],inputs:{sessionId:"sessionId",collateId:"collateId"},decls:18,vars:9,consts:[["previousSearch","matMenu"],["href","/#/home"],[3,"width","height","ngSrc"],[1,"spacer"],["mat-icon-button","","matTooltip","Open QR code dialog",3,"click"],["mat-icon-button","","matTooltip","Change analysis group visibility",3,"click"],["mat-icon-button","","matTooltip","Edit collate"],[3,"collate"],[2,"display","flex","justify-content","center"],[3,"searchResultID","projects"],["mat-icon-button","","matTooltip","View previous searches",3,"matMenuTriggerFor"],["mat-menu-item","","disabled",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Edit collate",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTags"],[2,"display","flex"],["mat-icon-button","","matTooltip","Toggle Cytoscape Plot",3,"click"],[3,"ngClass"],["mat-icon-button","","matTooltip","Filter Cytoscape Plot Search Terms"],[3,"renameCondition","projects","searchResultsMap"],[2,"padding","20px"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"searchTerm","renameCondition","projects","filteredResults"],["mat-icon-button","","matTooltip","Filter Cytoscape Plot Search Terms",3,"click"],["mat-tab-label",""],["mat-icon-button","","matTooltip","Export data",3,"click","disabled"]],template:function(n,i){n&1&&(U(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"a",1),Fe(3,"img",2),K(),Fe(4,"span",3),ke(5,C2,7,2),U(6,"button",4),ge("click",function(){return i.openQRCodeDialog()}),U(7,"mat-icon"),ae(8,"qr_code"),K()(),U(9,"button",5),ge("click",function(){return i.openVisibilityDialog()}),U(10,"mat-icon"),ae(11,"visibility"),K()(),ke(12,w2,3,0,"button",6),K()(),ke(13,b2,1,1,"app-collate-header",7)(14,E2,1,1),U(15,"div",8)(16,"app-collate-search",9),ge("searchResultID",function(o){return i._sessionId=o,i.getSearchFromID(o)}),K()(),ke(17,D2,11,8)),n&2&&(ie(3),Ee("width",25)("height",25)("ngSrc","/assets/logo.png"),ie(2),Ue(i.collate?5:-1),ie(7),Ue(i.accounts.loggedIn?12:-1),ie(),Ue(i.collate?13:-1),ie(),Ue(i.collate&&i.collate.settings?14:-1),ie(2),Ee("projects",i.projects),ie(),Ue(i.searchTerms.length>0?17:-1))},dependencies:[ud,ls,rs,ns,cs,ar,Xr,Uo,$o,ds,Fc,Bi,Fi,Vi,id,Li,fp,Nc],styles:[".disabled-icon[_ngcontent-%COMP%]{color:red}"]})}}return r})();var pp=(r,e)=>e.id;function P2(r,e){if(r&1){let t=$e();U(0,"mat-chip",2),ge("click",function(){let i=De(t).$implicit,a=ce(2);return Pe(a.removeProject(i))}),ae(1),K()}if(r&2){let t=e.$implicit;ie(),ot(" ",t.name," ")}}function O2(r,e){if(r&1&&(U(0,"div"),ae(1),U(2,"mat-chip-set"),tt(3,P2,2,1,"mat-chip",null,pp),K()()),r&2){let t=ce();ie(),ot(" Selected Projects: ",t.selectedMultipleProjects.length," "),ie(2),rt(t.selectedMultipleProjects)}}function R2(r,e){if(r&1&&(U(0,"mat-list-option",4),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ct(t.name)}}function I2(r,e){if(r&1){let t=$e();U(0,"div")(1,"mat-selection-list",3),tt(2,R2,2,2,"mat-list-option",4,pp),K(),U(4,"mat-paginator",5),ge("page",function(i){De(t);let a=ce(2);return Pe(a.handleProjectPageEvent(i))}),K()()}if(r&2){let t=ce(2);ie(),Ee("multiple",!1),ie(),rt(t.projectQuery.results),ie(2),Ee("pageSize",t.projectPageSize)("length",t.projectQuery.count)("pageIndex",t.projectPageIndex)}}function L2(r,e){r&1&&(U(0,"p"),ae(1,"No projects found."),K())}function N2(r,e){if(r&1&&ke(0,I2,5,4,"div")(1,L2,2,0,"p"),r&2){let t=ce();Ue(t.projectQuery.count>0?0:1)}}var gp=(()=>{class r{constructor(t,n){this.fb=t,this.web=n,this.multipleSelection=!1,this.selectedProjects=new xt,this.formProjectSearch=this.fb.group({searchTerm:new Br("",Fr.required),selectedProjects:new Br([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(i=>{i&&this.fetchProjects(i,this.projectPageSize,0)}),this.formProjectSearch.controls.selectedProjects.valueChanges.subscribe(i=>{if(i){for(let a of i)this.selectedMultipleProjects.includes(a)||this.selectedMultipleProjects.push(a);this.selectedProjects.emit(this.selectedMultipleProjects)}})}fetchProjects(t,n,i){let a=i*n;this.web.getProjects(void 0,n,a,t,void 0).subscribe(o=>{this.projectQuery=o})}handleProjectPageEvent(t){this.projectPageIndex=t.pageIndex,this.fetchProjects(this.formProjectSearch.controls.searchTerm.value||"",t.pageSize,t.pageIndex)}removeProject(t){this.selectedMultipleProjects=this.selectedMultipleProjects.filter(n=>n!==t),this.selectedProjects.emit(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(Oe(kt),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-search"]],inputs:{multipleSelection:"multipleSelection"},outputs:{selectedProjects:"selectedProjects"},decls:7,vars:3,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Project Name","type","search"],[3,"click"],["formControlName","selectedProjects",3,"multiple"],[3,"value"],[3,"page","pageSize","length","pageIndex"]],template:function(n,i){n&1&&(U(0,"form",0)(1,"mat-form-field"),Fe(2,"input",1),U(3,"mat-label"),ae(4,"Search For Specific Projects"),K()(),ke(5,O2,5,1,"div")(6,N2,2,1),K()),n&2&&(Ee("formGroup",i.formProjectSearch),ie(5),Ue(i.selectedMultipleProjects.length>0?5:-1),ie(),Ue(i.projectQuery?6:-1))},dependencies:[Xt,qt,Wt,Et,Yt,or,sr,Ft,Kt,lr,jo,Go,Bo,Fo,Vo],encapsulation:2})}}return r})();var mp=(()=>{class r{constructor(t,n,i){this.dialogRef=t,this.fb=n,this.web=i,this.formProjectSearch=this.fb.group({searchTerm:new Br("",Fr.required),selectedProjects:new Br([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.multipleSelection=!0,this.web.getProjects(void 0,this.projectPageSize,0,void 0).subscribe(a=>{this.projectQuery=a}),this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(a=>{a&&this.web.getProjects(void 0,this.projectPageSize,0,a).subscribe(o=>{this.projectQuery=o})})}handleSelectedProjects(t){this.selectedMultipleProjects=t}close(){this.dialogRef.close()}save(){this.dialogRef.close(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At),Oe(kt),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-project-add-dialog"]],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"selectedProjects"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(U(0,"h2",0),ae(1,"Project Add"),K(),U(2,"div",1)(3,"app-project-search",2),ge("selectedProjects",function(o){return i.handleSelectedProjects(o)}),K(),U(4,"small"),ae(5),K()(),U(6,"div",3)(7,"button",4),ge("click",function(){return i.save()}),ae(8,"Submit"),K(),U(9,"button",4),ge("click",function(){return i.close()}),ae(10,"Close"),K()()),n&2&&(ie(5),ot("Selected ",i.selectedMultipleProjects.length," Projects."))},dependencies:[gp,Dt,Pt,Ot,yt],encapsulation:2})}}return r})();var yp=(r,e)=>e.id;function k2(r,e){if(r&1&&(U(0,"mat-list-item",5)(1,"mat-icon",7),ae(2,"notes"),K(),U(3,"div",8),ae(4),K(),Fe(5,"div",9),K()),r&2){let t=e.$implicit;ie(4),ct(t.name)}}function F2(r,e){if(r&1){let t=$e();U(0,"div",5)(1,"div",6)(2,"b"),ae(3),K()(),U(4,"div",4),ge("cdkDropListDropped",function(i){let a=De(t).$implicit,o=ce(2);return Pe(o.drop(i,a.id))}),tt(5,k2,6,1,"mat-list-item",5,yp),K(),Fe(7,"mat-divider"),K()}if(r&2){let t=e.$implicit,n=ce(2);ie(3),ct(t.name),ie(2),rt(n.projectAnalysisGroupMap[t.id])}}function B2(r,e){if(r&1){let t=$e();U(0,"mat-list")(1,"div",4),ge("cdkDropListDropped",function(i){De(t);let a=ce();return Pe(a.dropProject(i))}),tt(2,F2,8,1,"div",5,yp),K()()}if(r&2){let t=ce();ie(2),rt(t.projects)}}var Cp=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}constructor(t){this.dialogRef=t,this._projectAnalysisGroupMap={},this._projects=[]}save(){this.dialogRef.close({projects:this.projects,projectAnalysisGroupMap:this.projectAnalysisGroupMap})}cancel(){this.dialogRef.close()}drop(t,n){Qn(this.projectAnalysisGroupMap[n],t.previousIndex,t.currentIndex)}dropProject(t){Qn(this.projects,t.previousIndex,t.currentIndex)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-project-analysis-group-reorder-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["mat-subheader","","cdkDragHandle",""],["cdkDragHandle","","matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""]],template:function(n,i){n&1&&(U(0,"h1",0),ae(1,"Analysis Group Reorder"),K(),U(2,"div",1),ke(3,B2,4,0,"mat-list"),K(),U(4,"div",2)(5,"button",3),ge("click",function(){return i.cancel()}),ae(6,"Close"),K(),U(7,"button",3),ge("click",function(){return i.save()}),ae(8,"Save"),K()()),n&2&&(ie(3),Ue(i.projects.length>0?3:-1))},dependencies:[Dt,Pt,Kc,Qc,Zc,ko,ar,Xc,as,Pn,Dn,Ot,yt],encapsulation:2})}}return r})();var V2=["hueSlider"],z2=["alphaSlider"];function G2(r,e){if(r&1){let t=$e();U(0,"div",10),ge("newValue",function(i){De(t);let a=ce();return Pe(a.onSliderChange("saturation-lightness",i))}),U(1,"div",11),Fe(2,"div"),K()()}if(r&2){let t=ce();En("background-color",t.hueSliderColor),Ee("rgX",1)("rgY",1),ie(),En("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function j2(r,e){if(r&1&&(U(0,"div",12),Fe(1,"div",13)(2,"div",14),K()),r&2){let t=ce();ie(2),En("background-color",t.selectedColor)}}function H2(r,e){if(r&1){let t=$e();U(0,"div",15,1),ge("newValue",function(i){De(t);let a=ce();return Pe(a.onSliderChange("hue",i))}),U(2,"div",16)(3,"div"),Fe(4,"div"),K()()()}if(r&2){let t=ce();Ee("rgX",1),ie(2),En("left",t.slider==null?null:t.slider.h,"px")}}function U2(r,e){if(r&1){let t=$e();U(0,"div",17,2),ge("newValue",function(i){De(t);let a=ce();return Pe(a.onSliderChange("alpha",i))}),Fe(2,"div",18),U(3,"div",16)(4,"div"),Fe(5,"div"),K()()()}if(r&2){let t=ce();Ee("rgX",1),ie(2),Ee("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),ie(),En("left",t.slider==null?null:t.slider.a,"px")}}var $2=["dialog"],xp=r=>({background:r});function W2(r,e){r&1&&Fe(0,"div",12)}function Y2(r,e){if(r&1){let t=$e();Ut(0),U(1,"div",9)(2,"div",10),ge("click",function(){let i=De(t).$implicit,a=ce(2);return Pe(a.onColorClick(i))}),ke(3,W2,1,0,"div",11),K()(),$t()}if(r&2){let t=e.$implicit,n=e.index,i=ce(2);ie(2),Oo("colornull",!t),Ee("ngStyle",i.getBackgroundColor(t)),ie(),Ee("ngIf",n==i.indexSeleccionado)}}function q2(r,e){if(r&1&&Fe(0,"div",18),r&2){let t=ce(3);Ee("ngStyle",t.getBackgroundColor(t.color))}}function X2(r,e){if(r&1){let t=$e();U(0,"div",13),ge("click",function(){De(t);let i=ce(2);return Pe(i.addColor())}),ke(1,q2,1,1,"div",14),Do(),U(2,"svg",15),Fe(3,"path",16)(4,"path",17),K()()}if(r&2){let t=ce(2);ie(),Ee("ngIf",t.indexSeleccionado===void 0)}}function K2(r,e){if(r&1){let t=$e();U(0,"color-picker",19),ge("colorChange",function(i){De(t);let a=ce(2);return Pe(a.onChangeColorPicker(i))})("onAlphaChange",function(i){De(t);let a=ce(2);return Pe(a.onAlphaChange(i))}),K()}if(r&2){let t=ce(2);Ee("controls",t.colorPickerControls)("color",t.hsva)}}function Z2(r,e){if(r&1&&(Ut(0),U(1,"div",5),ke(2,Y2,4,4,"ng-container",6)(3,X2,5,1,"div",7)(4,K2,1,2,"color-picker",8),K(),$t()),r&2){let t=ce();ie(),Ee("@colorsAnimation",t.colorsAnimationEffect),ie(),Ee("ngForOf",t.palette),ie(),Ee("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),ie(),Ee("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function Q2(r,e){r&1&&Fe(0,"div",12)}function J2(r,e){if(r&1){let t=$e();Ut(0),U(1,"div",9)(2,"div",25),ge("click",function(){let i=De(t).$implicit,a=ce(2);return Pe(a.changeColor(i))}),ke(3,Q2,1,0,"div",11),K()(),$t()}if(r&2){let t=e.$implicit,n=ce(2);ie(2),Oo("colornull",!t),Ee("ngStyle",ba(4,xp,t)),ie(),Ee("ngIf",n.isSelected(t))}}function eE(r,e){if(r&1){let t=$e();Ut(0),U(1,"div",5)(2,"div",20)(3,"div",21),ge("click",function(){De(t);let i=ce();return Pe(i.onClickBack())}),Do(),U(4,"svg",22),Fe(5,"path",23)(6,"path",24),K()()(),ke(7,J2,4,6,"ng-container",6),K(),$t()}if(r&2){let t=ce();ie(),Ee("@colorsAnimation",t.colorsAnimationEffect),ie(6),Ee("ngForOf",t.variants)}}function tE(r,e){if(r&1){let t=$e();Ut(0),U(1,"div",26)(2,"div",27),ge("click",function(){De(t);let i=ce();return Pe(i.onClickBack())}),Do(),U(3,"svg",22),Fe(4,"path",23)(5,"path",24),K()(),Tc(),U(6,"button",28),ge("click",function(){De(t);let i=ce();return Pe(i.emitClose("cancel"))}),ae(7),K(),U(8,"button",28),ge("click",function(){De(t);let i=ce();return Pe(i.emitClose("accept"))}),ae(9),K()(),U(10,"div",29)(11,"color-picker",30),ge("sliderChange",function(i){De(t);let a=ce();return Pe(a.onChangeColorPicker(i))}),K()(),$t()}if(r&2){let t=ce();ie(7),ot(" ",t.cancelLabel," "),ie(2),ot(" ",t.acceptLabel," "),ie(2),Ee("controls",t.colorPickerControls)("color",t.hsva)}}function rE(r,e){if(r&1){let t=$e();U(0,"div",31)(1,"p",32),ge("click",function(){De(t);let i=ce();return Pe(i.nextFormat())}),ae(2),K(),U(3,"div",33)(4,"input",34,1),ge("keyup",function(){De(t);let i=ir(5),a=ce();return Pe(a.changeColorManual(i.value))})("keydown.enter",function(){De(t);let i=ce();return Pe(i.emitClose("accept"))}),K()()()}if(r&2){let t=ce();ie(2),ct(t.colorFormats[t.format]),ie(2),En("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),Ee("placeholder",t.placeholder)("value",t.color)}}var vc=["hex","rgba","hsla","cmyk"],Tr=function(r){return r[r.HEX=0]="HEX",r[r.RGBA=1]="RGBA",r[r.HSLA=2]="HSLA",r[r.CMYK=3]="CMYK",r}(Tr||{}),wp=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],sn=class{constructor(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Wr=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i,this.onChange=new xt(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},yi=class{constructor(e,t,n,i){this.h=e,this.s=t,this.l=n,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Kn=class{constructor(e,t,n,i,a=1){this.c=e,this.m=t,this.y=n,this.k=i,this.a=a}denormalize(){return this.c=Math.round(this.c*100),this.m=Math.round(this.m*100),this.y=Math.round(this.y*100),this.k=Math.round(this.k*100),this}toString(){return this.denormalize(),"cmyk("+this.c+", "+this.m+", "+this.y+", "+this.k+")"}},pc=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},Sl=(()=>{class r{constructor(){}toFormat(t,n){var i="";if(t)switch(n){case Tr.HEX:var o=this.hsvaToRgba(t);o.denormalize();var i=this.rgbaToHex(o,!0);break;case Tr.HSLA:var a=this.hsva2hsla(t);a.denormalize();var i=a.toString();break;case Tr.RGBA:var o=this.hsvaToRgba(t),i=o.toString();break;case Tr.CMYK:var s=this.hsvaToCmyk(t),i=s.toString();break}return i}stringToFormat(t,n){var i=this.stringToHsva(t,!0);return this.toFormat(i,n)}hsva2hsla(t){let n=t.h,i=t.s,a=t.v,o=t.a;if(a===0)return new yi(n,0,0,o);if(i===0&&a===1)return new yi(n,1,1,o);{let s=a*(2-i)/2;return new yi(n,a*i/(1-Math.abs(2*s-1)),s,o)}}hsla2hsva(t){let n=Math.min(t.h,1),i=Math.min(t.s,1),a=Math.min(t.l,1),o=Math.min(t.a,1);if(a===0)return new Wr(n,0,0,o);{let s=a+i*(1-Math.abs(2*a-1))/2;return new Wr(n,2*(s-a)/s,s,o)}}hsvaToRgba(t){let n,i,a,o=t.h,s=t.s,u=t.v,l=t.a,c=Math.floor(o*6),d=o*6-c,h=u*(1-s),f=u*(1-d*s),v=u*(1-(1-d)*s);switch(c%6){case 0:n=u,i=v,a=h;break;case 1:n=f,i=u,a=h;break;case 2:n=h,i=u,a=v;break;case 3:n=h,i=f,a=u;break;case 4:n=v,i=h,a=u;break;case 5:n=u,i=h,a=f;break;default:n=0,i=0,a=0}return new sn(n,i,a,l)}cmykToRgb(t){let n=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),a=(1-t.y)*(1-t.k);return new sn(n,i,a,t.a)}rgbaToCmyk(t){let n=1-Math.max(t.r,t.g,t.b);if(n===1)return new Kn(0,0,0,1,t.a);{let i=(1-t.r-n)/(1-n),a=(1-t.g-n)/(1-n),o=(1-t.b-n)/(1-n);return new Kn(i,a,o,n,t.a)}}hsvaToCmyk(t){let n=this.hsvaToRgba(t);return this.rgbaToCmyk(n)}rgbaToHsva(t){let n,i,a=Math.min(t.r,1),o=Math.min(t.g,1),s=Math.min(t.b,1),u=Math.min(t.a,1),l=Math.max(a,o,s),c=Math.min(a,o,s),d=l,h=l-c;if(i=l===0?0:h/l,l===c)n=0;else{switch(l){case a:n=(o-s)/h+(o<s?6:0);break;case o:n=(s-a)/h+2;break;case s:n=(a-o)/h+4;break;default:n=0}n/=6}return new Wr(n,i,d,u)}rgbaToHex(t,n){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new Kn(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new Kn(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new sn(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",n=!0){let i=null;t=(t||"").toLowerCase();let a=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new sn(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new yi(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/cmyk?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new Kn(parseInt(o[1],10)/100,parseInt(o[2],10)/100,parseInt(o[3],10)/100,parseInt(o[4],10)/100)}}];n?a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new sn(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}):a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new sn(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),a.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new sn(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(let o in a)if(a.hasOwnProperty(o)){let s=a[o],u=s.re.exec(t),l=u&&s.parse(u);if(l){if(l instanceof sn)i=this.rgbaToHsva(l);else if(l instanceof yi)i=this.hsla2hsva(l);else if(l instanceof Kn){let c=this.cmykToRgb(l);i=this.rgbaToHsva(c)}return i}}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let n=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,a=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/,o=/(cmyk\(\d{1,3}(,\s?\d{1,3}){3}\))/;if(n.test(t))return"hex";if(i.test(t))return"rgba";if(a.test(t))return"hsla";if(o.test(t))return"cmyk"}return"hex"}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=Al({token:r,factory:r.\u0275fac}),r})(),Tl=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},gc=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},nE=(()=>{class r{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new xt,this.dragStart=new xt,this.newValue=new xt,this.listenerMove=n=>this.move(n),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-n.left-window.pageXOffset}getY(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-n.top-window.pageYOffset}setCursor(t){let n=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,a=Math.max(0,Math.min(this.getX(t),n)),o=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:a/n,v:1-o/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:o/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:a/n,rgX:this.rgX})}}return r.\u0275fac=function(t){return new(t||r)(Oe(Dl))},r.\u0275dir=Ol({type:r,selectors:[["","slider",""]],hostBindings:function(t,n){t&1&&ge("mousedown",function(a){return n.mouseDown(a)})("touchstart",function(a){return n.touchStart(a)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"},standalone:!1}),r})(),iE=(()=>{class r{constructor(t,n){this.service=t,this.cdr=n,this.color=new Wr(0,1,1,1),this.controls="default",this.sliderChange=new xt(!1),this.onAlphaChange=new xt(!1),this.hsva=new Wr(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new Wr(0,1,1,1)),this.slider=new Tl(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,n=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new gc(t,220,130,n),this.update()}onSliderChange(t,n){switch(t){case"saturation-lightness":this.hsva.onColorChange(n);break;case"hue":this.hsva.onHueChange(n);break;case"alpha":this.hsva.onAlphaChange(n),this.onAlphaChange.emit(n);break;case"value":this.hsva.onValueChange(n);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),n=this.service.hsvaToRgba(new Wr(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+n.r+","+n.g+","+n.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new Tl(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return r.\u0275fac=function(t){return new(t||r)(Oe(Sl),Oe(_n))},r.\u0275cmp=qe({type:r,selectors:[["color-picker"]],viewQuery:function(t,n){if(t&1&&(_i(V2,5),_i(z2,5)),t&2){let i;Ti(i=Si())&&(n.hueSlider=i.first),Ti(i=Si())&&(n.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},standalone:!1,features:[_c],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,n){if(t&1){let i=$e();U(0,"div",3,0),ge("click",function(o){return De(i),Pe(o.stopPropagation())}),ke(2,G2,3,8,"div",4),U(3,"div",5),ke(4,j2,3,2,"div",6),U(5,"div",7),ke(6,H2,5,3,"div",8)(7,U2,6,4,"div",9),K()()()}t&2&&(ie(2),Ee("ngIf",n.controls!="only-alpha"),ie(2),Ee("ngIf",n.controls!="only-alpha"),ie(2),Ee("ngIf",n.controls!="only-alpha"),ie(),Ee("ngIf",n.controls!="no-alpha"))},dependencies:[Il,Lo,nE],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),r})(),aE=(()=>{class r{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,n){this.service=t,this.cdr=n,this.color="#000000",this.previewColor="#000000",this.hsva=new Wr(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=wp,this.variants=[],this.userFormats=[],this.colorFormats=vc,this.format=Tr.HEX,this.formatMap={hex:Tr.HEX,rgba:Tr.RGBA,hsla:Tr.HSLA,cmyk:Tr.CMYK},this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let n;if(this.color)for(let i=0;i<t.length;i++){let a=t[i];typeof a=="string"?this.service.stringToFormat(this.color,Tr.HEX)==this.service.stringToFormat(a,Tr.HEX)&&(n=i):a===void 0?this.color=void 0:this.findIndexSelectedColor(a.variants)!=null&&(n=i)}return n}iniciate(t,n,i,a,o,s,u,l,c,d,h,f,v=[]){if(this.colorPickerControls=h,this.triggerInstance=t,this.TriggerBBox=n,this.color=i,this.hideColorPicker=l,this.hideTextInput=u,this.acceptLabel=c,this.cancelLabel=d,v.length&&v.every(m=>vc.includes(m))&&(this.colorFormats=v),s?this.colorFormats.includes(s)?(this.format=this.colorFormats.indexOf(s.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=s.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=Tr.HEX):(this.format=this.colorFormats.indexOf(this.service.getFormatByString(this.color)),this.format<0&&(this.format=0)),this.previewColor=this.color,this.palette=a??wp,this.colorsAnimationEffect=o,f=="top"){let p=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+p.height+"px ))"}}setPosition(){if(this.TriggerBBox){let n=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=n.top+n.height,n.left+250>window.innerWidth?this.left=n.right<250?window.innerWidth/2-250/2:n.right-250:this.left=n.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),n=this.panelRef.nativeElement.getBoundingClientRect(),i=n.height;t.bottom+i>window.innerHeight?this.positionString=t.top<n.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(n=>n.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,n){var i=[];for(let a=0;a<n.length;a++){let o=n[a];if(typeof o=="string"){let s=this.service.stringToHsva(o);s.onAlphaChange(t),i.push(this.service.toFormat(s,this.format))}else{let s=new pc,u=this.service.stringToHsva(o.preview);u.onAlphaChange(t),s.preview=this.service.toFormat(u,this.format),s.variants=this.ChangeAlphaOnPalette(t,o.variants),i.push(s)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.setPreviewColor(this.hsva),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color,this.previewColor)}setColor(t,n=-1){this.hsva=t;let i=this.colorFormats[this.format],a=n;a<0&&(a=this.formatMap[i]),this.color=this.service.toFormat(t,a),this.setPreviewColor(t),this.triggerInstance.setColor(this.color,this.previewColor)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){if(this.canChangeFormat){this.format=(this.format+1)%this.colorFormats.length;let t=this.colorFormats[this.format],n=this.formatMap[t];this.setColor(this.hsva,n),this.placeholder=this.service.toFormat(new Wr(0,0,1,1),n)}}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return r.\u0275fac=function(t){return new(t||r)(Oe(Sl),Oe(_n))},r.\u0275cmp=qe({type:r,selectors:[["ngx-colors-panel"]],viewQuery:function(t,n){if(t&1&&_i($2,5),t&2){let i;Ti(i=Si())&&(n.panelRef=i.first)}},hostVars:4,hostBindings:function(t,n){t&1&&ge("mousedown",function(a){return n.click(a)},!1,Pl)("scroll",function(){return n.onScroll()},!1,Pl)("resize",function(){return n.onResize()},!1,Ac),t&2&&En("top",n.top,"px")("left",n.left,"px")},standalone:!1,decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[2,"cursor","pointer",3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,n){t&1&&(U(0,"div",2,0),ke(2,Z2,5,4,"ng-container",3)(3,eE,8,2,"ng-container",3)(4,tE,12,4,"ng-container",3)(5,rE,6,7,"div",4),K()),t&2&&(Rc(n.positionString),ie(2),Ee("ngIf",n.menu==1),ie(),Ee("ngIf",n.menu==2),ie(),Ee("ngIf",n.menu==3),ie(),Ee("ngIf",!n.hideTextInput))},dependencies:[kc,Il,Lo,iE],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[Uc("colorsAnimation",[kl("void => slide-in",[xa(":enter",cn({opacity:0}),{optional:!0}),xa(":enter",Fl("10ms",[Ll(".3s ease-in",Nl([cn({opacity:0,transform:"translatex(-50%)",offset:0}),cn({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),cn({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),kl("void => popup",[xa(":enter",cn({opacity:0,transform:"scale(0)"}),{optional:!0}),xa(":enter",Fl("10ms",[Ll("500ms ease-out",Nl([cn({opacity:.5,transform:"scale(.5)",offset:.3}),cn({opacity:1,transform:"scale(1.1)",offset:.8}),cn({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),r})(),bp={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},Ep=(()=>{class r{constructor(t,n,i){this.resolver=t,this.applicationRef=n,this.injector=i}createPanel(t,n){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(aE);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let a=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(n),Object.keys(bp).forEach(o=>{this.overlay.style[o]=bp[o]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(a),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return r.\u0275fac=function(t){return new(t||r)(Ao(Dc),Ao(Pc),Ao(Sc))},r.\u0275prov=Al({token:r,factory:r.\u0275fac}),r})(),mc=(()=>{class r{onClick(){this.openPanel()}constructor(t,n,i){this.triggerRef=t,this.panelFactory=n,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new xt,this.input=new xt,this.slider=new xt,this.close=new xt,this.open=new xt,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position,this.formats)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t,n=""){this.writeValue(t,n),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t,n=""){if(t!==this.color){if(this.format){let a=vc.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,a)}this.color=t;let i=!1;t&&t.startsWith("cmyk")&&(i=!0,n||(n=this.service.stringToFormat(t,Tr.RGBA))),this.change.emit(i?n:t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return r.\u0275fac=function(t){return new(t||r)(Oe(Dl),Oe(Ep),Oe(Sl))},r.\u0275dir=Ol({type:r,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,n){t&1&&ge("click",function(){return n.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",formats:"formats",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},standalone:!1,features:[Lc([{provide:Wc,useExisting:Ec(()=>r),multi:!0}])]}),r})(),_p=(()=>{class r{constructor(t,n){this.cdRef=t,this.triggerDirective=n,this.triggerDirectiveColorChangeSubscription=null,this.color=this.triggerDirective.color}ngOnInit(){this.triggerDirectiveColorChangeSubscription=this.triggerDirective.change.subscribe(t=>{this.color=t,this.cdRef.markForCheck()})}ngOnDestroy(){this.triggerDirectiveColorChangeSubscription&&this.triggerDirectiveColorChangeSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(Oe(_n),Oe(mc,1))},r.\u0275cmp=qe({type:r,selectors:[["ngx-colors"]],standalone:!1,decls:4,vars:5,consts:[[1,"app-color-picker"],[1,"preview"],[1,"preview-background"],[1,"circle",3,"ngStyle"]],template:function(t,n){t&1&&(U(0,"div",0)(1,"div",1)(2,"div",2),Fe(3,"div",3),K()()()),t&2&&(ie(3),Oo("colornull",!n.color),Ee("ngStyle",ba(3,xp,n.color)))},dependencies:[Lo],styles:["[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]{line-height:1px;font-family:sans-serif}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin:2px;display:inline-block;box-sizing:border-box;border-radius:100%;background:white;cursor:pointer;padding:3px;box-shadow:0 1px 1px #0003,0 1px 1px 1px #00000024,0 1px 1px 1px #0000001f}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-background[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px;border-radius:100%}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:20px;width:20px;box-sizing:border-box;border-radius:100%;cursor:pointer}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .noselected[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}"]}),r})(),Tp=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Po({type:r}),r.\u0275inj=Mo({providers:[Sl,Ep],imports:[No]}),r})();var sE=(r,e)=>e.id;function lE(r,e){if(r&1){let t=$e();U(0,"div",4)(1,"ngx-colors",5),wr("ngModelChange",function(i){let a=De(t).$implicit,o=ce(2).$implicit,s=ce();return Cr(s.projectConditionColorMap[o.id][a],i)||(s.projectConditionColorMap[o.id][a]=i),Pe(i)}),K(),U(2,"div"),ae(3),K()()}if(r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();ie(),yr("ngModel",i.projectConditionColorMap[n.id][t]),ie(2),ct(t)}}function uE(r,e){if(r&1&&tt(0,lE,4,2,"div",4,mr),r&2){let t=ce().$implicit,n=ce();rt(n.projectConditionMap[t.id])}}function cE(r,e){if(r&1&&(U(0,"div")(1,"div")(2,"b"),ae(3),K()(),ke(4,uE,2,0),K()),r&2){let t=e.$implicit,n=ce();ie(3),ct(t.name),ie(),Ue(n.projectConditionMap[t.id]?4:-1)}}var Sp=(()=>{class r{set projects(t){this._projects=t;for(let n of t)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i)this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.projectConditionColorMap[a.AnalysisGroup.project]||(this.projectConditionColorMap[a.AnalysisGroup.project]={}),this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]||(this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]="")})}get projects(){return this._projects}set projectConditionColorMap(t){if(t==null){this._projectConditionColorMap={};return}this._projectConditionColorMap=Object.assign({},t)}get projectConditionColorMap(){return this._projectConditionColorMap}constructor(t,n){this.dialogRef=t,this.web=n,this._projects=[],this.projectConditionMap={},this._projectConditionColorMap={}}save(){this.dialogRef.close(this.projectConditionColorMap)}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(Oe(At),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-condition-color-editor-dialog"]],inputs:{projects:"projects",projectConditionColorMap:"projectConditionColorMap"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],[2,"display","flex","gap","5px","align-items","center"],["ngx-colors-trigger","",3,"ngModelChange","ngModel"]],template:function(n,i){n&1&&(U(0,"h1",0),ae(1,"Condition Color Editor"),K(),U(2,"div",1),tt(3,cE,5,2,"div",null,sE),K(),U(5,"div",2)(6,"button",3),ge("click",function(){return i.cancel()}),ae(7,"Close"),K(),U(8,"button",3),ge("click",function(){return i.save()}),ae(9,"Save"),K()()),n&2&&(ie(3),rt(i.projects))},dependencies:[Dt,Pt,Tp,_p,mc,Mn,Et,Sn,yt,Ot],encapsulation:2})}}return r})();function dE(r,e){if(r&1&&(U(0,"mat-option",6),ae(1),K()),r&2){let t=e.$implicit;Ee("value",t),ie(),ct(t)}}var Mp=(()=>{class r{_filter(t){let n=t.toLowerCase();return this.tags.filter(i=>i.toLowerCase().includes(n))}constructor(t,n,i){this.fb=t,this.dialogRef=n,this.collateService=i,this.form=this.fb.group({name:["",Fr.required],existing:[!1],id:[-1]}),this.tags=[]}ngOnInit(){this.filteredTags=this.form.controls.name.valueChanges.pipe(So(""),Ei(t=>this.collateService.getCollateTags(t).pipe(_o(n=>n.results.map(i=>i.name)))))}submit(){let t=this.form.controls.name.value;this.collateService.getCollateTags(t).subscribe(n=>{let i=n.results.find(o=>o.name.toLowerCase()===t.toLowerCase()),a=!!i;this.form.controls.existing.setValue(a),this.form.controls.id.setValue(a?i.id:null),this.dialogRef.close(this.form.value)})}cancel(){this.dialogRef.close()}onTagSelected(t){let n=t.option.value;this.form.controls.name.setValue(n),this.collateService.getCollateTags(n).subscribe(i=>{let a=i.results.find(o=>o.name.toLowerCase()===n.toLowerCase());this.form.controls.existing.setValue(!!a),this.form.controls.id.setValue(a?a.id:null)})}static{this.\u0275fac=function(n){return new(n||r)(Oe(kt),Oe(At),Oe(Kr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-tag-create-dialog"]],decls:18,vars:5,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["type","text","matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"]],template:function(n,i){if(n&1){let a=$e();U(0,"h1",1),ae(1,"Create/Add Tag"),K(),U(2,"div",2)(3,"form",3)(4,"mat-form-field")(5,"mat-label"),ae(6,"Tag Name"),K(),Fe(7,"input",4),U(8,"mat-autocomplete",5,0),ge("optionSelected",function(s){return De(a),Pe(i.onTagSelected(s))}),tt(10,dE,2,2,"mat-option",6,mr),Mi(12,"async"),K()()()(),U(13,"div",7)(14,"button",8),ge("click",function(){return De(a),Pe(i.cancel())}),ae(15,"Cancel"),K(),U(16,"button",9),ge("click",function(){return De(a),Pe(i.submit())}),ae(17,"Submit"),K()()}if(n&2){let a=ir(9);ie(3),Ee("formGroup",i.form),ie(4),Ee("matAutocomplete",a),ie(3),rt(Ai(12,3,i.filteredTags)),ie(6),Ee("disabled",i.form.invalid)}},dependencies:[Dt,Pt,Xt,qt,Wt,Et,Yt,or,sr,lr,Kt,Ft,yt,Ot,Pr,Di,Ni,ki],encapsulation:2})}}return r})();var hE=(r,e)=>e.id;function fE(r,e){r&1&&(U(0,"th",11),ae(1," Original Title "),K())}function vE(r,e){if(r&1&&(U(0,"td",12),ae(1),K()),r&2){let t=e.$implicit;ie(),ot(" ",t," ")}}function pE(r,e){r&1&&(U(0,"th",11),ae(1," Display Title "),K())}function gE(r,e){if(r&1&&(U(0,"td",12)(1,"form",13)(2,"mat-form-field"),Fe(3,"input",14),K()()()),r&2){let t=e.$implicit,n=ce(2).$implicit,i=ce();ie(),Ee("formGroup",i.formMap[n.id][t]),ie(2),Ro("formControlName",t)}}function mE(r,e){r&1&&Fe(0,"tr",15)}function yE(r,e){r&1&&Fe(0,"tr",16)}function CE(r,e){if(r&1&&(U(0,"h5"),ae(1),K(),U(2,"table",4),Ut(3,5),ke(4,fE,2,0,"th",6)(5,vE,2,1,"td",7),$t(),Ut(6,8),ke(7,pE,2,0,"th",6)(8,gE,4,2,"td",7),$t(),ke(9,mE,1,0,"tr",9)(10,yE,1,0,"tr",10),K()),r&2){let t=ce().$implicit,n=ce();ie(),ct(t.name),ie(),Ee("dataSource",n.projectConditionMap[t.id]),ie(7),Ee("matHeaderRowDef",n.displayedColumns),ie(),Ee("matRowDefColumns",n.displayedColumns)}}function wE(r,e){if(r&1&&ke(0,CE,11,4),r&2){let t=e.$implicit,n=ce();Ue(n.formMap[t.id]?0:-1)}}var Ap=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set renameSampleCondition(t){for(let n of this.projects)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i){if(this.formMap[a.AnalysisGroup.project]||(this.formMap[a.AnalysisGroup.project]={}),!this.formMap[a.AnalysisGroup.project][a.Condition]){let o={};o[a.Condition]=new Br(a.Condition,Fr.required),this.formMap[a.AnalysisGroup.project][a.Condition]=this.fb.group(o)}this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.renameSampleCondition[a.AnalysisGroup.project]||(this.renameSampleCondition[a.AnalysisGroup.project]={}),this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]||(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=a.Condition),t[a.AnalysisGroup.project]&&t[a.AnalysisGroup.project][a.Condition]&&(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=t[a.AnalysisGroup.project][a.Condition],this.formMap[a.AnalysisGroup.project][a.Condition].controls[a.Condition].setValue(t[a.AnalysisGroup.project][a.Condition]))}})}get renameSampleCondition(){return this._renameSampleCondition}constructor(t,n,i,a){this.dialog=t,this.web=n,this.fb=i,this.sb=a,this.displayedColumns=["original","display"],this.projectConditionMap={},this._projects=[],this._renameSampleCondition={},this.formMap={}}close(){this.dialog.close()}submit(){let t={};for(let n in this.formMap){t[n]={};for(let i in this.formMap[n])if(t[n][i]=this.formMap[n][i].value[i],!this.formMap[n][i].valid){this.sb.open(`${i} is invalid`);return}}this.dialog.close(t)}static{this.\u0275fac=function(n){return new(n||r)(Oe(At),Oe(Zt),Oe(kt),Oe(Vr))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-rename-sample-condition-dialog"]],inputs:{projects:"projects",renameSampleCondition:"renameSampleCondition"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","original"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","display"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"formGroup"],["matInput","",2,"border-radius","0",3,"formControlName"],["mat-header-row",""],["mat-row",""]],template:function(n,i){n&1&&(U(0,"h1",0),ae(1,"Rename Conditions"),K(),U(2,"div",1),tt(3,wE,1,1,null,null,hE),K(),U(5,"div",2)(6,"button",3),ge("click",function(){return i.submit()}),ae(7,"Submit"),K(),U(8,"button",3),ge("click",function(){return i.close()}),ae(9,"Close"),K()()),n&2&&(ie(3),rt(i.projects))},dependencies:[Dt,Pt,Xt,qt,Wt,Et,Yt,or,sr,Zo,Yo,Xo,Ko,es,Qo,ts,Jo,Wo,qo,Ot,yt,Ft,Kt],encapsulation:2})}}return r})();var Dp=(()=>{class r{set settings(t){for(let n in t)this._settings[n]=t[n];this._settings&&this.form.patchValue(this._settings)}get settings(){return this._settings}constructor(t,n){this.fb=t,this.dialog=n,this._settings={},this.form=this.fb.group({marginLeft:150,marginRight:100,marginTop:100,marginBottom:100,titleTextSize:14,showTitle:!0,height:500,barSize:50})}submit(){this.dialog.close(this.form.value)}close(){this.dialog.close()}static{this.\u0275fac=function(n){return new(n||r)(Oe(kt),Oe(At))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-plot-settings"]],inputs:{settings:"settings"},decls:46,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],[2,"display","flex","flex-direction","column","gap","5px"],["matInput","","formControlName","height","type","number"],["matInput","","formControlName","barSize","type","number"],["matInput","","formControlName","marginLeft","type","number"],["matInput","","formControlName","marginRight","type","number"],["matInput","","formControlName","marginTop","type","number"],["matInput","","formControlName","marginBottom","type","number"],["formControlName","showTitle"],["matInput","","formControlName","titleTextSize","type","number"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(U(0,"h5",0),ae(1,"Plot General Settings"),K(),U(2,"div",1)(3,"form",2)(4,"section",3)(5,"b"),ae(6,"Overall Size"),K(),U(7,"mat-form-field"),Fe(8,"input",4),U(9,"mat-label"),ae(10,"Height"),K()(),U(11,"mat-form-field"),Fe(12,"input",5),U(13,"mat-label"),ae(14,"Bar size"),K()(),U(15,"mat-form-field"),Fe(16,"input",6),U(17,"mat-label"),ae(18,"Margin Left"),K()(),U(19,"mat-form-field"),Fe(20,"input",7),U(21,"mat-label"),ae(22,"Margin Right"),K()(),U(23,"mat-form-field"),Fe(24,"input",8),U(25,"mat-label"),ae(26,"Margin Top"),K()(),U(27,"mat-form-field"),Fe(28,"input",9),U(29,"mat-label"),ae(30,"Margin Bottom"),K()()(),Fe(31,"mat-divider"),U(32,"section",3)(33,"b"),ae(34,"Title"),K(),U(35,"mat-checkbox",10),ae(36,"Show Title"),K(),U(37,"mat-form-field"),Fe(38,"input",11),U(39,"mat-label"),ae(40,"Title Text Size"),K()()()()(),U(41,"div",12)(42,"button",13),ge("click",function(){return i.close()}),ae(43,"Cancel"),K(),U(44,"button",13),ge("click",function(){return i.submit()}),ae(45,"Save"),K()()),n&2&&(ie(3),Ee("formGroup",i.form))},dependencies:[Dt,Pt,Xt,qt,Wt,Ii,Et,Yt,or,sr,Ft,Kt,lr,zi,Ot,yt,ko],encapsulation:2})}}return r})();function bE(r,e){if(r&1){let t=$e();U(0,"mat-checkbox",12),wr("ngModelChange",function(i){De(t);let a=ce(2);return Cr(a.collate.settings.showTags,i)||(a.collate.settings.showTags=i),Pe(i)}),ae(1,"Show Tags"),K()}if(r&2){let t=ce(2);yr("ngModel",t.collate.settings.showTags)}}function xE(r,e){if(r&1){let t=$e();U(0,"h1",15),ge("click",function(){De(t);let i=ce(3);return Pe(i.toggleEditTitle())}),ae(1),K(),Fe(2,"br")}if(r&2){let t=ce(3);ie(),ct(t.collate.title)}}function EE(r,e){if(r&1){let t=$e();U(0,"div")(1,"mat-form-field",16)(2,"input",17),ge("keydown.enter",function(){De(t);let i=ce(3);return Pe(i.toggleEditTitle())}),wr("ngModelChange",function(i){De(t);let a=ce(3);return Cr(a.collate.title,i)||(a.collate.title=i),Pe(i)}),K()(),U(3,"button",18),ge("click",function(){De(t);let i=ce(3);return Pe(i.toggleEditTitle())}),U(4,"mat-icon"),ae(5,"save"),K()()()}if(r&2){let t=ce(3);ie(2),yr("ngModel",t.collate.title)}}function _E(r,e){if(r&1){let t=$e();U(0,"div",19),ge("click",function(){De(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),ae(1),K()}if(r&2){let t=ce(3);ie(),ct(t.collate.greeting)}}function TE(r,e){if(r&1){let t=$e();U(0,"div")(1,"mat-form-field",20)(2,"input",17),ge("keydown.enter",function(){De(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),wr("ngModelChange",function(i){De(t);let a=ce(3);return Cr(a.collate.greeting,i)||(a.collate.greeting=i),Pe(i)}),K()(),U(3,"button",18),ge("click",function(){De(t);let i=ce(3);return Pe(i.toggleEditGreeting())}),U(4,"mat-icon"),ae(5,"save"),K()()()}if(r&2){let t=ce(3);ie(2),yr("ngModel",t.collate.greeting)}}function SE(r,e){if(r&1&&(U(0,"div",9)(1,"div",13),ke(2,xE,3,1)(3,EE,6,1,"div")(4,_E,2,1,"div",14)(5,TE,6,1,"div"),K()()),r&2){let t=ce(2);ie(2),Ue(t.editTitle?3:2),ie(2),Ue(t.editGreeting?5:4)}}function ME(r,e){if(r&1){let t=$e();U(0,"div",1)(1,"button",21),ge("click",function(){De(t);let i=ce(2);return Pe(i.openCollateTagCreateDialog())}),ae(2,"Add Tag +"),K()(),U(3,"div",22)(4,"app-collate-tags",23),ge("collageTagsChange",function(i){De(t);let a=ce(2);return Pe(a.handleCollageTagsChange(i))}),K()()}if(r&2){let t=ce(2);ie(4),Ee("collageTags",t.collate.tags)}}function AE(r,e){if(r&1&&Fe(0,"mat-tab",25),r&2){let t=e.$implicit;Ee("label",t)}}function DE(r,e){if(r&1){let t=$e();U(0,"div",11)(1,"mat-tab-group",24),ge("selectedTabChange",function(){De(t);let i=ce(2);return Pe(i.filterDataBySearchTerm())}),wr("selectedIndexChange",function(i){De(t);let a=ce(2);return Cr(a.selectedIndex,i)||(a.selectedIndex=i),Pe(i)}),tt(2,AE,1,1,"mat-tab",25,mr),K()()}if(r&2){let t=ce(2);ie(),yr("selectedIndex",t.selectedIndex),Ee("mat-stretch-tabs",!1),ie(),rt(t.searchTerms)}}function PE(r,e){if(r&1){let t=$e();U(0,"app-collate-project-list",27),ge("deleteProject",function(i){De(t);let a=ce(4);return Pe(a.deleteProject(i))})("projectOrderChanged",function(i){De(t);let a=ce(4);return Pe(a.onProjectOrderChanged(i))}),K()}if(r&2){let t=ce(4);Ee("searchTerm",t.selectedSearchTerm)("projectConditionColorMap",t.collate.settings.projectConditionColorMap)("projects",t.projects)("filteredResults",t.filteredResults)("renameCondition",t.collate.settings.renameSampleCondition)}}function OE(r,e){if(r&1&&ke(0,PE,1,5,"app-collate-project-list",26),r&2){let t=ce(3);Ue(t.collate.settings.projectConditionColorMap&&t.collate.settings.renameSampleCondition?0:-1)}}function RE(r,e){if(r&1&&ke(0,OE,1,1),r&2){let t=ce(2);Ue(t.collate.settings?0:-1)}}function IE(r,e){if(r&1){let t=$e();U(0,"mat-toolbar")(1,"mat-toolbar-row"),Fe(2,"span",2),ke(3,bE,2,1,"mat-checkbox",3),U(4,"button",4),ge("click",function(){De(t);let i=ce();return Pe(i.goToCollateView())}),U(5,"mat-icon"),ae(6,"visibility"),K()(),U(7,"button",5),ge("click",function(){De(t);let i=ce();return Pe(i.openProjectAddDialog())}),U(8,"mat-icon"),ae(9,"add"),K()(),U(10,"button",6),ge("click",function(){De(t);let i=ce();return Pe(i.updateCollate())}),U(11,"mat-icon"),ae(12,"save"),K()(),U(13,"button",7)(14,"mat-icon"),ae(15,"more_vert"),K()(),U(16,"mat-menu",null,0)(18,"button",8),ge("click",function(){De(t);let i=ce();return Pe(i.openReorderDialog())}),ae(19,"Reorder Analysis Groups"),K(),U(20,"button",8),ge("click",function(){De(t);let i=ce();return Pe(i.openVisibilityDialog())}),ae(21,"Change Analysis Group Visibility"),K(),U(22,"button",8),ge("click",function(){De(t);let i=ce();return Pe(i.openConditionColorEditorDialog())}),ae(23,"Set Condition Colors"),K(),U(24,"button",8),ge("click",function(){De(t);let i=ce();return Pe(i.openPlotSettings())}),ae(25,"Change Plot General Settings"),K(),U(26,"button",8),ge("click",function(){De(t);let i=ce();return Pe(i.openRenameConditionDialog())}),ae(27,"Rename Condition"),K()()()(),ke(28,SE,6,2,"div",9)(29,ME,5,1),U(30,"div",1)(31,"app-collate-search",10),ge("searchResultID",function(i){De(t);let a=ce();return Pe(a.getSearchFromID(i))}),K()(),ke(32,DE,4,2,"div",11)(33,RE,1,1)}if(r&2){let t=ir(17),n=ce();ie(3),Ue(n.collate?3:-1),ie(10),Ee("matMenuTriggerFor",t),ie(15),Ue(n.collate?28:-1),ie(),Ue(n.collate?29:-1),ie(2),Ee("projects",n.projects),ie(),Ue(n.searchTerms.length>0?32:-1),ie(),Ue(n.collate?33:-1)}}function LE(r,e){r&1&&(U(0,"div",1)(1,"p"),ae(2," You do not have permission to edit this collate. "),K()())}var yc=(()=>{class r{set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this._collate=n,this.accounts.getCollatePermissions(n.id).subscribe(i=>{this.canEdit=i.edit}),this.projects=n.projects,this._collate.settings||(this._collate.settings={projectOrder:this.projects.map(i=>i.id),analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),this._collate.settings.plotSettings||(this._collate.settings.plotSettings={}),n.settings.projectOrder){let i=this.projects.filter(a=>!n.settings.projectOrder.includes(a.id));this.projects=this.projects.filter(a=>n.settings.projectOrder.includes(a.id)),this.projects=this.projects.concat(i)}if(this.collate&&"showTags"in this.collate.settings&&(this.collate.settings.showTags=!1),this.collate?.settings.projectConditionColorMap)this.graph.projectConditionColorMap=this.collate.settings.projectConditionColorMap;else{this.collate.settings.projectConditionColorMap={};for(let i of this.projects)this.collate.settings.projectConditionColorMap[i.id]={}}if(!this.collate?.settings.renameSampleCondition){this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)})}})}get collate(){return this._collate}set collate(t){this._collate=t}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,n,i,a,o,s,u){this.accounts=t,this.graph=n,this.router=i,this.snackBar=a,this.dialog=o,this.collateService=s,this.web=u,this._collate=null,this.canEdit=!1,this.projects=[],this.selectedIndex=0,this.editTitle=!1,this.editGreeting=!1,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this.searchTerms=[],this._selectedSearchTerm="",this.filteredResults={},this.removedTags=[]}openProjectAddDialog(){this.dialog.open(mp).afterClosed().subscribe(n=>{n&&(this.projects=this.projects.concat(n),this.collate&&(this.collate.projects=this.projects,this.updateProjectOrder()))})}updateProjectOrder(){this._collate&&(this._collate.settings.projectOrder=this.projects.map(t=>t.id)),console.log(this.collate)}updateCollate(){this._collate&&this.collateService.updateCollate(this._collate.id,this._collate).subscribe(()=>{if(this.removedTags.length>0){let t=this.removedTags.map(n=>this.collateService.removeTagFromCollate(this._collate?.id,n.id));bc(t).subscribe(()=>{this.showSnackBar("Collate saved successfully"),this.removedTags=[]})}else this.showSnackBar("Collate saved successfully")})}toggleEditTitle(){this.editTitle=!this.editTitle}toggleEditGreeting(){this.editGreeting=!this.editGreeting}saveTitle(){this.toggleEditTitle(),this.updateCollate()}saveGreeting(){this.toggleEditGreeting(),this.updateCollate()}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{console.log(n)}),this.web.getSearchResults(t,99999).subscribe(n=>{console.log(n.results),this.distributeSearchResults(n.results).then()})}associateAnalysisGroupsWithProjects(){return _t(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return _t(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(i=>i.search_term===this.selectedSearchTerm)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(n=>{let i=parseInt(n),a=this.collate?.settings.analysisGroupOrderMap[i];if(!t[i]||!a)return;let o=t[i].filter(s=>!a.includes(s.analysis_group.id));if(t[i]=t[i].filter(s=>a.includes(s.analysis_group.id)),t[i]=t[i].sort((s,u)=>a.indexOf(s.analysis_group.id)-a.indexOf(u.analysis_group.id)),t[i]=t[i].concat(o),this.collate?.settings?.projectAnalysisGroupVisibility){let s=this.collate?.settings.projectAnalysisGroupVisibility[i];t[i]=t[i].filter(u=>!s||!(u.analysis_group.id in s)?!0:s[u.analysis_group.id])}}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults()}onProjectOrderChanged(t){this.projects=t,this.updateProjectOrder()}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}deleteProject(t){this.projects=this.projects.filter(n=>n.id!==t.id),this.updateProjectOrder()}goToCollateView(){this._collate&&this.router.navigate(["/collate/view",this._collate.id])}onSearchResultsChange(t,n){this.filteredResults[n]=t,this.collate&&(this.collate.settings.analysisGroupOrderMap||(this.collate.settings.analysisGroupOrderMap={}),this.collate.settings.analysisGroupOrderMap[n]=t.map(i=>i.analysis_group.id),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{this.collate.settings.analysisGroupOrderMap[i]=Array.from(new Set(this.collate.settings.analysisGroupOrderMap[i]))}))}openVisibilityDialog(){let t=this.dialog.open(hs);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),u=this.collate?.settings.analysisGroupOrderMap[s];if(!u||!i[s])return;let l=i[s].filter(c=>!u.includes(c.id));i[s]=i[s].filter(c=>u.includes(c.id)),i[s]=i[s].sort((c,d)=>u.indexOf(c.id)-u.indexOf(d.id)),i[s]=i[s].concat(l)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}openReorderDialog(){let t=this.dialog.open(Cp);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(a=>{i[a.project]||(i[a.project]=[]),i[a.project].push(a)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let o=parseInt(a),s=this.collate?.settings.analysisGroupOrderMap[o];if(!s||!i[o])return;let u=i[o].filter(l=>!s.includes(l.id));i[o]=i[o].filter(l=>s.includes(l.id)),i[o]=i[o].sort((l,c)=>s.indexOf(l.id)-s.indexOf(c.id)),i[o]=i[o].concat(u)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects}),t.afterClosed().subscribe(n=>{this.projects=n.projects,this.updateProjectOrder(),this.projectAnalysisGroups=n.projectAnalysisGroupMap;let i={};Object.keys(this.projectAnalysisGroups).forEach(a=>{i[a]=this.projectAnalysisGroups[a].map(o=>o.id)}),this.collate&&(this.collate.settings.analysisGroupOrderMap=i,this.filteredResults=this.getFilteredSearchResults())})}openConditionColorEditorDialog(){let t=this.dialog.open(Sp);t.componentInstance.projectConditionColorMap=this.collate?.settings?.projectConditionColorMap,t.componentInstance.projects=this.projects,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.projectConditionColorMap=n),this.graph.projectConditionColorMap=Object.assign({},n),this.filteredResults=this.getFilteredSearchResults(),this.graph.redrawTrigger.next(!0)})}openCollateTagCreateDialog(){this.dialog.open(Mp).afterClosed().subscribe(n=>{n&&n.name&&(n.existing&&n.id&&n.id!==-1?this.collateService.addTagToCollate(this.collate?.id,n.id).subscribe(i=>{this.collate&&this.collate.tags.push(i)}):this.collateService.createCollateTag(n.name).subscribe(i=>{this.collateService.addTagToCollate(this.collate?.id,i.id).subscribe(a=>{this.collate&&this.collate.tags.push(a)})}))})}handleCollageTagsChange(t){this.collate&&(this.removedTags=this.collate.tags.filter(n=>!t.includes(n)),this.collate.tags=t)}openRenameConditionDialog(){if(this.collate){let t=this.dialog.open(Ap);t.componentInstance.projects=this.collate.projects,t.componentInstance.renameSampleCondition=this.collate.settings.renameSampleCondition,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.renameSampleCondition=Object.assign({},n),console.log(this.collate.settings.renameSampleCondition))})}}openPlotSettings(){if(this.collate){let t=this.dialog.open(Dp);t.componentInstance.settings=this.collate.settings.plotSettings,t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.plotSettings=n,this.graph.plotSettings=n,this.graph.redrawTrigger.next(!0))})}}static{this.\u0275fac=function(n){return new(n||r)(Oe(Zr),Oe(is),Oe(Pi),Oe(Vr),Oe(Tn),Oe(Kr),Oe(Zt))}}static{this.\u0275cmp=qe({type:r,selectors:[["app-collate-editor"]],inputs:{collateId:"collateId"},decls:2,vars:1,consts:[["extraActionsMenu","matMenu"],[2,"display","flex","justify-content","center"],[1,"spacer"],[3,"ngModel"],["type","button","aria-label","View Collate","mat-icon-button","",3,"click"],["type","button","aria-label","Add Projects","mat-icon-button","",3,"click"],["type","button","aria-label","Update Collate","mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[3,"searchResultID","projects"],[2,"padding","20px"],[3,"ngModelChange","ngModel"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"],[3,"click"],[2,"font-size","2em","text-align","center","font-family","Roboto, Helvetica Neue, sans-serif","padding","5px"],["matInput","",3,"keydown.enter","ngModelChange","ngModel"],["mat-icon-button","",3,"click"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif",3,"click"],[2,"font-size","25px","text-align","center","font-family","'Roboto', 'Arial Narrow', sans-serif","padding","5px"],["mat-button","",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTagsChange","collageTags"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"label"],[3,"searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"],[3,"deleteProject","projectOrderChanged","searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"]],template:function(n,i){n&1&&ke(0,IE,34,7)(1,LE,3,0,"div",1),n&2&&Ue(i.canEdit?0:1)},dependencies:[$o,Xr,ar,Uo,Mn,Wt,Et,Sn,ls,ns,rs,Ft,Kt,cs,Bi,Fi,Vi,yt,ds,zi],styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();var NE=[{component:ld,path:""},{component:_l,path:"view"},{component:_l,path:"view/:collateId"},{component:_l,path:"view/:collateId/:sessionId"},{component:yc,path:"edit"},{component:yc,path:"edit/:collateId"}],xA=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=Po({type:r})}static{this.\u0275inj=Mo({imports:[No,Vc.forChild(NE)]})}}return r})();export{xA as CollateModule};
