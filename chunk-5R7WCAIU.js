import{a as Nc}from"./chunk-5FZDEB73.js";import{a as Oc}from"./chunk-LT5OS7KN.js";import{a as Fc,b as pp,c as Vc,d as yl,e as On,f as Fo,g as vn,h as pn,i as ci}from"./chunk-4PVRXQAO.js";import{a as Bo,b as Ro,c as Io,d as Oo}from"./chunk-YE4PZOJH.js";import{a as mo}from"./chunk-I7KSBDRZ.js";import{a as yo,b as Co}from"./chunk-ON4LJNYO.js";import{a as Nr}from"./chunk-GBHZXXOL.js";import{a as Lc,b as Po,c as Ao}from"./chunk-JZVXNH5J.js";import{a as wo,b as bo,c as xo,d as _o,e as Eo,f as So,g as To,h as ko,i as Mo,j as Do}from"./chunk-LE3F4ORG.js";import{a as si,b as yc,c as li,d as Cc,e as wc,f as bc,g as po,h as go}from"./chunk-YYO262FZ.js";import{a as fo,b as ho,c as Bc,d as vo,e as Rc,f as Ic}from"./chunk-GH6BASN2.js";import{a as Er}from"./chunk-DZJ2KETN.js";import{a as oo,c as kc,d as Mc,e as Dc,f as so,g as Pc,h as lo}from"./chunk-25CFQFJY.js";import{a as Bt,c as ui,d as Rt,e as It,f as Ot,g as zr}from"./chunk-NPOKFU2J.js";import{Aa as Tc,Ba as Fr,Ca as Lr,Da as Qt,Ea as hn,Fa as hr,Ha as Vr,Ma as Zt,Na as Jt,Oa as Ac,Pa as uo,Q as oi,Qa as co,Sa as er,V as Xt,W as ct,X as dn,oa as _c,pa as Yt,ra as xr,ta as Et,ua as dr,va as Ec,wa as _r,xa as fn,ya as fr,za as Sc}from"./chunk-G4XN575R.js";import{c as xc,d as vl,g as en,i as pl,j as gl,l as Wi,m as ml}from"./chunk-3CIC7QKD.js";import{h as gc,l as ai,p as mc}from"./chunk-OTVSX5VU.js";import{Aa as it,Cb as sc,Cc as ro,D as Zu,Db as lc,Ea as ul,Eb as pe,Fb as cn,Gb as Za,H as Ju,Hb as uc,Kb as Re,Lb as Jr,Mb as We,Nb as Ue,Ob as G,Pb as q,Qb as De,Rb as xt,Sb as _t,Ub as Oe,Xb as ue,Xc as hc,Yc as vc,Z as Wa,Zb as re,Zc as hl,_ as Ua,_c as no,a as vt,ac as cc,ad as io,b as Or,bb as ic,bc as fl,c as ol,cb as ac,cd as ao,d as sl,da as ec,db as cl,e as qa,ea as ll,eb as Z,ec as ri,f as ot,fa as Ka,fb as be,fc as ni,gc as ii,id as pc,ja as Xa,jb as oc,jc as br,kc as ae,lc as rt,mc as Ge,nc as dc,oc as Wt,pa as tc,pc as Ut,qa as ge,qc as Kt,ra as me,rb as je,rc as fc,sa as Ya,sb as Qa,sc as Ja,ta as rc,tb as dl,tc as Hi,va as nc,vc as eo,wc as to,x as Ha,xb as Se}from"./chunk-ZY3XLMOC.js";var Wc=sl((Ui,wl)=>{"use strict";(function(r,e){typeof Ui=="object"&&typeof wl=="object"?wl.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ui=="object"?Ui.QRCodeStyling=e():r.QRCodeStyling=e()})(Ui,()=>(()=>{var r={873:(i,a)=>{var o,s,l=function(){var u=function(T,B){var E=T,w=m[B],b=null,_=0,k=null,S=[],N={},V=function(L,j){b=function($){for(var U=new Array($),X=0;X<$;X+=1){U[X]=new Array($);for(var de=0;de<$;de+=1)U[X][de]=null}return U}(_=4*E+17),z(0,0),z(_-7,0),z(0,_-7),Y(),H(),J(L,j),E>=7&&ee(L),k==null&&(k=ie(E,w,S)),ne(k,j)},z=function(L,j){for(var $=-1;$<=7;$+=1)if(!(L+$<=-1||_<=L+$))for(var U=-1;U<=7;U+=1)j+U<=-1||_<=j+U||(b[L+$][j+U]=0<=$&&$<=6&&(U==0||U==6)||0<=U&&U<=6&&($==0||$==6)||2<=$&&$<=4&&2<=U&&U<=4)},H=function(){for(var L=8;L<_-8;L+=1)b[L][6]==null&&(b[L][6]=L%2==0);for(var j=8;j<_-8;j+=1)b[6][j]==null&&(b[6][j]=j%2==0)},Y=function(){for(var L=p.getPatternPosition(E),j=0;j<L.length;j+=1)for(var $=0;$<L.length;$+=1){var U=L[j],X=L[$];if(b[U][X]==null)for(var de=-2;de<=2;de+=1)for(var Te=-2;Te<=2;Te+=1)b[U+de][X+Te]=de==-2||de==2||Te==-2||Te==2||de==0&&Te==0}},ee=function(L){for(var j=p.getBCHTypeNumber(E),$=0;$<18;$+=1){var U=!L&&(j>>$&1)==1;b[Math.floor($/3)][$%3+_-8-3]=U}for($=0;$<18;$+=1)U=!L&&(j>>$&1)==1,b[$%3+_-8-3][Math.floor($/3)]=U},J=function(L,j){for(var $=w<<3|j,U=p.getBCHTypeInfo($),X=0;X<15;X+=1){var de=!L&&(U>>X&1)==1;X<6?b[X][8]=de:X<8?b[X+1][8]=de:b[_-15+X][8]=de}for(X=0;X<15;X+=1)de=!L&&(U>>X&1)==1,X<8?b[8][_-X-1]=de:X<9?b[8][15-X-1+1]=de:b[8][15-X-1]=de;b[_-8][8]=!L},ne=function(L,j){for(var $=-1,U=_-1,X=7,de=0,Te=p.getMaskFunction(j),_e=_-1;_e>0;_e-=2)for(_e==6&&(_e-=1);;){for(var fe=0;fe<2;fe+=1)if(b[U][_e-fe]==null){var ce=!1;de<L.length&&(ce=(L[de]>>>X&1)==1),Te(U,_e-fe)&&(ce=!ce),b[U][_e-fe]=ce,(X-=1)==-1&&(de+=1,X=7)}if((U+=$)<0||_<=U){U-=$,$=-$;break}}},ie=function(L,j,$){for(var U=C.getRSBlocks(L,j),X=x(),de=0;de<$.length;de+=1){var Te=$[de];X.put(Te.getMode(),4),X.put(Te.getLength(),p.getLengthInBits(Te.getMode(),L)),Te.write(X)}var _e=0;for(de=0;de<U.length;de+=1)_e+=U[de].dataCount;if(X.getLengthInBits()>8*_e)throw"code length overflow. ("+X.getLengthInBits()+">"+8*_e+")";for(X.getLengthInBits()+4<=8*_e&&X.put(0,4);X.getLengthInBits()%8!=0;)X.putBit(!1);for(;!(X.getLengthInBits()>=8*_e||(X.put(236,8),X.getLengthInBits()>=8*_e));)X.put(17,8);return function(fe,ce){for(var we=0,Me=0,ke=0,xe=new Array(ce.length),Ee=new Array(ce.length),ye=0;ye<ce.length;ye+=1){var se=ce[ye].dataCount,I=ce[ye].totalCount-se;Me=Math.max(Me,se),ke=Math.max(ke,I),xe[ye]=new Array(se);for(var W=0;W<xe[ye].length;W+=1)xe[ye][W]=255&fe.getBuffer()[W+we];we+=se;var oe=p.getErrorCorrectPolynomial(I),Q=y(xe[ye],oe.getLength()-1).mod(oe);for(Ee[ye]=new Array(oe.getLength()-1),W=0;W<Ee[ye].length;W+=1){var te=W+Q.getLength()-Ee[ye].length;Ee[ye][W]=te>=0?Q.getAt(te):0}}var he=0;for(W=0;W<ce.length;W+=1)he+=ce[W].totalCount;var le=new Array(he),ve=0;for(W=0;W<Me;W+=1)for(ye=0;ye<ce.length;ye+=1)W<xe[ye].length&&(le[ve]=xe[ye][W],ve+=1);for(W=0;W<ke;W+=1)for(ye=0;ye<ce.length;ye+=1)W<Ee[ye].length&&(le[ve]=Ee[ye][W],ve+=1);return le}(X,U)};N.addData=function(L,j){var $=null;switch(j=j||"Byte"){case"Numeric":$=M(L);break;case"Alphanumeric":$=P(L);break;case"Byte":$=D(L);break;case"Kanji":$=R(L);break;default:throw"mode:"+j}S.push($),k=null},N.isDark=function(L,j){if(L<0||_<=L||j<0||_<=j)throw L+","+j;return b[L][j]},N.getModuleCount=function(){return _},N.make=function(){if(E<1){for(var L=1;L<40;L++){for(var j=C.getRSBlocks(L,w),$=x(),U=0;U<S.length;U++){var X=S[U];$.put(X.getMode(),4),$.put(X.getLength(),p.getLengthInBits(X.getMode(),L)),X.write($)}var de=0;for(U=0;U<j.length;U++)de+=j[U].dataCount;if($.getLengthInBits()<=8*de)break}E=L}V(!1,function(){for(var Te=0,_e=0,fe=0;fe<8;fe+=1){V(!0,fe);var ce=p.getLostPoint(N);(fe==0||Te>ce)&&(Te=ce,_e=fe)}return _e}())},N.createTableTag=function(L,j){L=L||2;var $="";$+='<table style="',$+=" border-width: 0px; border-style: none;",$+=" border-collapse: collapse;",$+=" padding: 0px; margin: "+(j=j===void 0?4*L:j)+"px;",$+='">',$+="<tbody>";for(var U=0;U<N.getModuleCount();U+=1){$+="<tr>";for(var X=0;X<N.getModuleCount();X+=1)$+='<td style="',$+=" border-width: 0px; border-style: none;",$+=" border-collapse: collapse;",$+=" padding: 0px; margin: 0px;",$+=" width: "+L+"px;",$+=" height: "+L+"px;",$+=" background-color: ",$+=N.isDark(U,X)?"#000000":"#ffffff",$+=";",$+='"/>';$+="</tr>"}return($+="</tbody>")+"</table>"},N.createSvgTag=function(L,j,$,U){var X={};typeof arguments[0]=="object"&&(L=(X=arguments[0]).cellSize,j=X.margin,$=X.alt,U=X.title),L=L||2,j=j===void 0?4*L:j,($=typeof $=="string"?{text:$}:$||{}).text=$.text||null,$.id=$.text?$.id||"qrcode-description":null,(U=typeof U=="string"?{text:U}:U||{}).text=U.text||null,U.id=U.text?U.id||"qrcode-title":null;var de,Te,_e,fe,ce=N.getModuleCount()*L+2*j,we="";for(fe="l"+L+",0 0,"+L+" -"+L+",0 0,-"+L+"z ",we+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',we+=X.scalable?"":' width="'+ce+'px" height="'+ce+'px"',we+=' viewBox="0 0 '+ce+" "+ce+'" ',we+=' preserveAspectRatio="xMinYMin meet"',we+=U.text||$.text?' role="img" aria-labelledby="'+K([U.id,$.id].join(" ").trim())+'"':"",we+=">",we+=U.text?'<title id="'+K(U.id)+'">'+K(U.text)+"</title>":"",we+=$.text?'<description id="'+K($.id)+'">'+K($.text)+"</description>":"",we+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',we+='<path d="',Te=0;Te<N.getModuleCount();Te+=1)for(_e=Te*L+j,de=0;de<N.getModuleCount();de+=1)N.isDark(Te,de)&&(we+="M"+(de*L+j)+","+_e+fe);return(we+='" stroke="transparent" fill="black"/>')+"</svg>"},N.createDataURL=function(L,j){L=L||2,j=j===void 0?4*L:j;var $=N.getModuleCount()*L+2*j,U=j,X=$-j;return O($,$,function(de,Te){if(U<=de&&de<X&&U<=Te&&Te<X){var _e=Math.floor((de-U)/L),fe=Math.floor((Te-U)/L);return N.isDark(fe,_e)?0:1}return 1})},N.createImgTag=function(L,j,$){L=L||2,j=j===void 0?4*L:j;var U=N.getModuleCount()*L+2*j,X="";return X+="<img",X+=' src="',X+=N.createDataURL(L,j),X+='"',X+=' width="',X+=U,X+='"',X+=' height="',X+=U,X+='"',$&&(X+=' alt="',X+=K($),X+='"'),X+"/>"};var K=function(L){for(var j="",$=0;$<L.length;$+=1){var U=L.charAt($);switch(U){case"<":j+="&lt;";break;case">":j+="&gt;";break;case"&":j+="&amp;";break;case'"':j+="&quot;";break;default:j+=U}}return j};return N.createASCII=function(L,j){if((L=L||1)<2)return function(xe){xe=xe===void 0?2:xe;var Ee,ye,se,I,W,oe=1*N.getModuleCount()+2*xe,Q=xe,te=oe-xe,he={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},le={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},ve="";for(Ee=0;Ee<oe;Ee+=2){for(se=Math.floor((Ee-Q)/1),I=Math.floor((Ee+1-Q)/1),ye=0;ye<oe;ye+=1)W="\u2588",Q<=ye&&ye<te&&Q<=Ee&&Ee<te&&N.isDark(se,Math.floor((ye-Q)/1))&&(W=" "),Q<=ye&&ye<te&&Q<=Ee+1&&Ee+1<te&&N.isDark(I,Math.floor((ye-Q)/1))?W+=" ":W+="\u2588",ve+=xe<1&&Ee+1>=te?le[W]:he[W];ve+=`
`}return oe%2&&xe>0?ve.substring(0,ve.length-oe-1)+Array(oe+1).join("\u2580"):ve.substring(0,ve.length-1)}(j);L-=1,j=j===void 0?2*L:j;var $,U,X,de,Te=N.getModuleCount()*L+2*j,_e=j,fe=Te-j,ce=Array(L+1).join("\u2588\u2588"),we=Array(L+1).join("  "),Me="",ke="";for($=0;$<Te;$+=1){for(X=Math.floor(($-_e)/L),ke="",U=0;U<Te;U+=1)de=1,_e<=U&&U<fe&&_e<=$&&$<fe&&N.isDark(X,Math.floor((U-_e)/L))&&(de=0),ke+=de?ce:we;for(X=0;X<L;X+=1)Me+=ke+`
`}return Me.substring(0,Me.length-1)},N.renderTo2dContext=function(L,j){j=j||2;for(var $=N.getModuleCount(),U=0;U<$;U++)for(var X=0;X<$;X++)L.fillStyle=N.isDark(U,X)?"black":"white",L.fillRect(U*j,X*j,j,j)},N};u.stringToBytes=(u.stringToBytesFuncs={default:function(T){for(var B=[],E=0;E<T.length;E+=1){var w=T.charCodeAt(E);B.push(255&w)}return B}}).default,u.createStringToBytes=function(T,B){var E=function(){for(var b=F(T),_=function(){var H=b.read();if(H==-1)throw"eof";return H},k=0,S={};;){var N=b.read();if(N==-1)break;var V=_(),z=_()<<8|_();S[String.fromCharCode(N<<8|V)]=z,k+=1}if(k!=B)throw k+" != "+B;return S}(),w=63;return function(b){for(var _=[],k=0;k<b.length;k+=1){var S=b.charCodeAt(k);if(S<128)_.push(S);else{var N=E[b.charAt(k)];typeof N=="number"?(255&N)==N?_.push(N):(_.push(N>>>8),_.push(255&N)):_.push(w)}}return _}};var c,d,f,h,v,m={L:1,M:0,Q:3,H:2},p=(c=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d=1335,f=7973,v=function(T){for(var B=0;T!=0;)B+=1,T>>>=1;return B},(h={}).getBCHTypeInfo=function(T){for(var B=T<<10;v(B)-v(d)>=0;)B^=d<<v(B)-v(d);return 21522^(T<<10|B)},h.getBCHTypeNumber=function(T){for(var B=T<<12;v(B)-v(f)>=0;)B^=f<<v(B)-v(f);return T<<12|B},h.getPatternPosition=function(T){return c[T-1]},h.getMaskFunction=function(T){switch(T){case 0:return function(B,E){return(B+E)%2==0};case 1:return function(B,E){return B%2==0};case 2:return function(B,E){return E%3==0};case 3:return function(B,E){return(B+E)%3==0};case 4:return function(B,E){return(Math.floor(B/2)+Math.floor(E/3))%2==0};case 5:return function(B,E){return B*E%2+B*E%3==0};case 6:return function(B,E){return(B*E%2+B*E%3)%2==0};case 7:return function(B,E){return(B*E%3+(B+E)%2)%2==0};default:throw"bad maskPattern:"+T}},h.getErrorCorrectPolynomial=function(T){for(var B=y([1],0),E=0;E<T;E+=1)B=B.multiply(y([1,g.gexp(E)],0));return B},h.getLengthInBits=function(T,B){if(1<=B&&B<10)switch(T){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+T}else if(B<27)switch(T){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+T}else{if(!(B<41))throw"type:"+B;switch(T){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+T}}},h.getLostPoint=function(T){for(var B=T.getModuleCount(),E=0,w=0;w<B;w+=1)for(var b=0;b<B;b+=1){for(var _=0,k=T.isDark(w,b),S=-1;S<=1;S+=1)if(!(w+S<0||B<=w+S))for(var N=-1;N<=1;N+=1)b+N<0||B<=b+N||S==0&&N==0||k==T.isDark(w+S,b+N)&&(_+=1);_>5&&(E+=3+_-5)}for(w=0;w<B-1;w+=1)for(b=0;b<B-1;b+=1){var V=0;T.isDark(w,b)&&(V+=1),T.isDark(w+1,b)&&(V+=1),T.isDark(w,b+1)&&(V+=1),T.isDark(w+1,b+1)&&(V+=1),V!=0&&V!=4||(E+=3)}for(w=0;w<B;w+=1)for(b=0;b<B-6;b+=1)T.isDark(w,b)&&!T.isDark(w,b+1)&&T.isDark(w,b+2)&&T.isDark(w,b+3)&&T.isDark(w,b+4)&&!T.isDark(w,b+5)&&T.isDark(w,b+6)&&(E+=40);for(b=0;b<B;b+=1)for(w=0;w<B-6;w+=1)T.isDark(w,b)&&!T.isDark(w+1,b)&&T.isDark(w+2,b)&&T.isDark(w+3,b)&&T.isDark(w+4,b)&&!T.isDark(w+5,b)&&T.isDark(w+6,b)&&(E+=40);var z=0;for(b=0;b<B;b+=1)for(w=0;w<B;w+=1)T.isDark(w,b)&&(z+=1);return E+Math.abs(100*z/B/B-50)/5*10},h),g=function(){for(var T=new Array(256),B=new Array(256),E=0;E<8;E+=1)T[E]=1<<E;for(E=8;E<256;E+=1)T[E]=T[E-4]^T[E-5]^T[E-6]^T[E-8];for(E=0;E<255;E+=1)B[T[E]]=E;return{glog:function(w){if(w<1)throw"glog("+w+")";return B[w]},gexp:function(w){for(;w<0;)w+=255;for(;w>=256;)w-=255;return T[w]}}}();function y(T,B){if(T.length===void 0)throw T.length+"/"+B;var E=function(){for(var b=0;b<T.length&&T[b]==0;)b+=1;for(var _=new Array(T.length-b+B),k=0;k<T.length-b;k+=1)_[k]=T[k+b];return _}(),w={getAt:function(b){return E[b]},getLength:function(){return E.length},multiply:function(b){for(var _=new Array(w.getLength()+b.getLength()-1),k=0;k<w.getLength();k+=1)for(var S=0;S<b.getLength();S+=1)_[k+S]^=g.gexp(g.glog(w.getAt(k))+g.glog(b.getAt(S)));return y(_,0)},mod:function(b){if(w.getLength()-b.getLength()<0)return w;for(var _=g.glog(w.getAt(0))-g.glog(b.getAt(0)),k=new Array(w.getLength()),S=0;S<w.getLength();S+=1)k[S]=w.getAt(S);for(S=0;S<b.getLength();S+=1)k[S]^=g.gexp(g.glog(b.getAt(S))+_);return y(k,0).mod(b)}};return w}var C=function(){var T=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],B=function(w,b){var _={};return _.totalCount=w,_.dataCount=b,_},E={getRSBlocks:function(w,b){var _=function(ee,J){switch(J){case m.L:return T[4*(ee-1)+0];case m.M:return T[4*(ee-1)+1];case m.Q:return T[4*(ee-1)+2];case m.H:return T[4*(ee-1)+3];default:return}}(w,b);if(_===void 0)throw"bad rs block @ typeNumber:"+w+"/errorCorrectionLevel:"+b;for(var k=_.length/3,S=[],N=0;N<k;N+=1)for(var V=_[3*N+0],z=_[3*N+1],H=_[3*N+2],Y=0;Y<V;Y+=1)S.push(B(z,H));return S}};return E}(),x=function(){var T=[],B=0,E={getBuffer:function(){return T},getAt:function(w){var b=Math.floor(w/8);return(T[b]>>>7-w%8&1)==1},put:function(w,b){for(var _=0;_<b;_+=1)E.putBit((w>>>b-_-1&1)==1)},getLengthInBits:function(){return B},putBit:function(w){var b=Math.floor(B/8);T.length<=b&&T.push(0),w&&(T[b]|=128>>>B%8),B+=1}};return E},M=function(T){var B=T,E={getMode:function(){return 1},getLength:function(_){return B.length},write:function(_){for(var k=B,S=0;S+2<k.length;)_.put(w(k.substring(S,S+3)),10),S+=3;S<k.length&&(k.length-S==1?_.put(w(k.substring(S,S+1)),4):k.length-S==2&&_.put(w(k.substring(S,S+2)),7))}},w=function(_){for(var k=0,S=0;S<_.length;S+=1)k=10*k+b(_.charAt(S));return k},b=function(_){if("0"<=_&&_<="9")return _.charCodeAt(0)-48;throw"illegal char :"+_};return E},P=function(T){var B=T,E={getMode:function(){return 2},getLength:function(b){return B.length},write:function(b){for(var _=B,k=0;k+1<_.length;)b.put(45*w(_.charAt(k))+w(_.charAt(k+1)),11),k+=2;k<_.length&&b.put(w(_.charAt(k)),6)}},w=function(b){if("0"<=b&&b<="9")return b.charCodeAt(0)-48;if("A"<=b&&b<="Z")return b.charCodeAt(0)-65+10;switch(b){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+b}};return E},D=function(T){var B=u.stringToBytes(T);return{getMode:function(){return 4},getLength:function(E){return B.length},write:function(E){for(var w=0;w<B.length;w+=1)E.put(B[w],8)}}},R=function(T){var B=u.stringToBytesFuncs.SJIS;if(!B)throw"sjis not supported.";(function(){var b=B("\u53CB");if(b.length!=2||(b[0]<<8|b[1])!=38726)throw"sjis not supported."})();var E=B(T),w={getMode:function(){return 8},getLength:function(b){return~~(E.length/2)},write:function(b){for(var _=E,k=0;k+1<_.length;){var S=(255&_[k])<<8|255&_[k+1];if(33088<=S&&S<=40956)S-=33088;else{if(!(57408<=S&&S<=60351))throw"illegal char at "+(k+1)+"/"+S;S-=49472}S=192*(S>>>8&255)+(255&S),b.put(S,13),k+=2}if(k<_.length)throw"illegal char at "+(k+1)}};return w},A=function(){var T=[],B={writeByte:function(E){T.push(255&E)},writeShort:function(E){B.writeByte(E),B.writeByte(E>>>8)},writeBytes:function(E,w,b){w=w||0,b=b||E.length;for(var _=0;_<b;_+=1)B.writeByte(E[_+w])},writeString:function(E){for(var w=0;w<E.length;w+=1)B.writeByte(E.charCodeAt(w))},toByteArray:function(){return T},toString:function(){var E="";E+="[";for(var w=0;w<T.length;w+=1)w>0&&(E+=","),E+=T[w];return E+"]"}};return B},F=function(T){var B=T,E=0,w=0,b=0,_={read:function(){for(;b<8;){if(E>=B.length){if(b==0)return-1;throw"unexpected end of file./"+b}var S=B.charAt(E);if(E+=1,S=="=")return b=0,-1;S.match(/^\s$/)||(w=w<<6|k(S.charCodeAt(0)),b+=6)}var N=w>>>b-8&255;return b-=8,N}},k=function(S){if(65<=S&&S<=90)return S-65;if(97<=S&&S<=122)return S-97+26;if(48<=S&&S<=57)return S-48+52;if(S==43)return 62;if(S==47)return 63;throw"c:"+S};return _},O=function(T,B,E){for(var w=function(z,H){var Y=z,ee=H,J=new Array(z*H),ne={setPixel:function(L,j,$){J[j*Y+L]=$},write:function(L){L.writeString("GIF87a"),L.writeShort(Y),L.writeShort(ee),L.writeByte(128),L.writeByte(0),L.writeByte(0),L.writeByte(0),L.writeByte(0),L.writeByte(0),L.writeByte(255),L.writeByte(255),L.writeByte(255),L.writeString(","),L.writeShort(0),L.writeShort(0),L.writeShort(Y),L.writeShort(ee),L.writeByte(0);var j=ie(2);L.writeByte(2);for(var $=0;j.length-$>255;)L.writeByte(255),L.writeBytes(j,$,255),$+=255;L.writeByte(j.length-$),L.writeBytes(j,$,j.length-$),L.writeByte(0),L.writeString(";")}},ie=function(L){for(var j=1<<L,$=1+(1<<L),U=L+1,X=K(),de=0;de<j;de+=1)X.add(String.fromCharCode(de));X.add(String.fromCharCode(j)),X.add(String.fromCharCode($));var Te,_e,fe,ce=A(),we=(Te=ce,_e=0,fe=0,{write:function(Ee,ye){if(Ee>>>ye)throw"length over";for(;_e+ye>=8;)Te.writeByte(255&(Ee<<_e|fe)),ye-=8-_e,Ee>>>=8-_e,fe=0,_e=0;fe|=Ee<<_e,_e+=ye},flush:function(){_e>0&&Te.writeByte(fe)}});we.write(j,U);var Me=0,ke=String.fromCharCode(J[Me]);for(Me+=1;Me<J.length;){var xe=String.fromCharCode(J[Me]);Me+=1,X.contains(ke+xe)?ke+=xe:(we.write(X.indexOf(ke),U),X.size()<4095&&(X.size()==1<<U&&(U+=1),X.add(ke+xe)),ke=xe)}return we.write(X.indexOf(ke),U),we.write($,U),we.flush(),ce.toByteArray()},K=function(){var L={},j=0,$={add:function(U){if($.contains(U))throw"dup key:"+U;L[U]=j,j+=1},size:function(){return j},indexOf:function(U){return L[U]},contains:function(U){return L[U]!==void 0}};return $};return ne}(T,B),b=0;b<B;b+=1)for(var _=0;_<T;_+=1)w.setPixel(_,b,E(_,b));var k=A();w.write(k);for(var S=function(){var z=0,H=0,Y=0,ee="",J={},ne=function(K){ee+=String.fromCharCode(ie(63&K))},ie=function(K){if(!(K<0)){if(K<26)return 65+K;if(K<52)return K-26+97;if(K<62)return K-52+48;if(K==62)return 43;if(K==63)return 47}throw"n:"+K};return J.writeByte=function(K){for(z=z<<8|255&K,H+=8,Y+=1;H>=6;)ne(z>>>H-6),H-=6},J.flush=function(){if(H>0&&(ne(z<<6-H),z=0,H=0),Y%3!=0)for(var K=3-Y%3,L=0;L<K;L+=1)ee+="="},J.toString=function(){return ee},J}(),N=k.toByteArray(),V=0;V<N.length;V+=1)S.writeByte(N[V]);return S.flush(),"data:image/gif;base64,"+S};return u}();l.stringToBytesFuncs["UTF-8"]=function(u){return function(c){for(var d=[],f=0;f<c.length;f++){var h=c.charCodeAt(f);h<128?d.push(h):h<2048?d.push(192|h>>6,128|63&h):h<55296||h>=57344?d.push(224|h>>12,128|h>>6&63,128|63&h):(f++,h=65536+((1023&h)<<10|1023&c.charCodeAt(f)),d.push(240|h>>18,128|h>>12&63,128|h>>6&63,128|63&h))}return d}(u)},(s=typeof(o=function(){return l})=="function"?o.apply(a,[]):o)===void 0||(i.exports=s)}},e={};function t(i){var a=e[i];if(a!==void 0)return a.exports;var o=e[i]={exports:{}};return r[i](o,o.exports,t),o.exports}t.n=i=>{var a=i&&i.__esModule?()=>i.default:()=>i;return t.d(a,{a}),a},t.d=(i,a)=>{for(var o in a)t.o(a,o)&&!t.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:a[o]})},t.o=(i,a)=>Object.prototype.hasOwnProperty.call(i,a);var n={};return(()=>{"use strict";t.d(n,{default:()=>B});let i=E=>!!E&&typeof E=="object"&&!Array.isArray(E);function a(E,...w){if(!w.length)return E;let b=w.shift();return b!==void 0&&i(E)&&i(b)?(E=Object.assign({},E),Object.keys(b).forEach(_=>{let k=E[_],S=b[_];Array.isArray(k)&&Array.isArray(S)?E[_]=S:i(k)&&i(S)?E[_]=a(Object.assign({},k),S):E[_]=S}),a(E,...w)):E}function o(E,w){let b=document.createElement("a");b.download=w,b.href=E,document.body.appendChild(b),b.click(),document.body.removeChild(b)}let s={L:.07,M:.15,Q:.25,H:.3};class l{constructor({svg:w,type:b,window:_}){this._svg=w,this._type=b,this._window=_}draw(w,b,_,k){let S;switch(this._type){case"dots":S=this._drawDot;break;case"classy":S=this._drawClassy;break;case"classy-rounded":S=this._drawClassyRounded;break;case"rounded":S=this._drawRounded;break;case"extra-rounded":S=this._drawExtraRounded;break;default:S=this._drawSquare}S.call(this,{x:w,y:b,size:_,getNeighbor:k})}_rotateFigure({x:w,y:b,size:_,rotation:k=0,draw:S}){var N;let V=w+_/2,z=b+_/2;S(),(N=this._element)===null||N===void 0||N.setAttribute("transform",`rotate(${180*k/Math.PI},${V},${z})`)}_basicDot(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(_+b/2)),this._element.setAttribute("cy",String(k+b/2)),this._element.setAttribute("r",String(b/2))}}))}_basicSquare(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(_)),this._element.setAttribute("y",String(k)),this._element.setAttribute("width",String(b)),this._element.setAttribute("height",String(b))}}))}_basicSideRounded(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${k}v ${b}h `+b/2+`a ${b/2} ${b/2}, 0, 0, 0, 0 ${-b}`)}}))}_basicCornerRounded(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${k}v ${b}h ${b}v `+-b/2+`a ${b/2} ${b/2}, 0, 0, 0, ${-b/2} ${-b/2}`)}}))}_basicCornerExtraRounded(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${k}v ${b}h ${b}a ${b} ${b}, 0, 0, 0, ${-b} ${-b}`)}}))}_basicCornersRounded(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${_} ${k}v `+b/2+`a ${b/2} ${b/2}, 0, 0, 0, ${b/2} ${b/2}h `+b/2+"v "+-b/2+`a ${b/2} ${b/2}, 0, 0, 0, ${-b/2} ${-b/2}`)}}))}_drawDot({x:w,y:b,size:_}){this._basicDot({x:w,y:b,size:_,rotation:0})}_drawSquare({x:w,y:b,size:_}){this._basicSquare({x:w,y:b,size:_,rotation:0})}_drawRounded({x:w,y:b,size:_,getNeighbor:k}){let S=k?+k(-1,0):0,N=k?+k(1,0):0,V=k?+k(0,-1):0,z=k?+k(0,1):0,H=S+N+V+z;if(H!==0)if(H>2||S&&N||V&&z)this._basicSquare({x:w,y:b,size:_,rotation:0});else{if(H===2){let Y=0;return S&&V?Y=Math.PI/2:V&&N?Y=Math.PI:N&&z&&(Y=-Math.PI/2),void this._basicCornerRounded({x:w,y:b,size:_,rotation:Y})}if(H===1){let Y=0;return V?Y=Math.PI/2:N?Y=Math.PI:z&&(Y=-Math.PI/2),void this._basicSideRounded({x:w,y:b,size:_,rotation:Y})}}else this._basicDot({x:w,y:b,size:_,rotation:0})}_drawExtraRounded({x:w,y:b,size:_,getNeighbor:k}){let S=k?+k(-1,0):0,N=k?+k(1,0):0,V=k?+k(0,-1):0,z=k?+k(0,1):0,H=S+N+V+z;if(H!==0)if(H>2||S&&N||V&&z)this._basicSquare({x:w,y:b,size:_,rotation:0});else{if(H===2){let Y=0;return S&&V?Y=Math.PI/2:V&&N?Y=Math.PI:N&&z&&(Y=-Math.PI/2),void this._basicCornerExtraRounded({x:w,y:b,size:_,rotation:Y})}if(H===1){let Y=0;return V?Y=Math.PI/2:N?Y=Math.PI:z&&(Y=-Math.PI/2),void this._basicSideRounded({x:w,y:b,size:_,rotation:Y})}}else this._basicDot({x:w,y:b,size:_,rotation:0})}_drawClassy({x:w,y:b,size:_,getNeighbor:k}){let S=k?+k(-1,0):0,N=k?+k(1,0):0,V=k?+k(0,-1):0,z=k?+k(0,1):0;S+N+V+z!==0?S||V?N||z?this._basicSquare({x:w,y:b,size:_,rotation:0}):this._basicCornerRounded({x:w,y:b,size:_,rotation:Math.PI/2}):this._basicCornerRounded({x:w,y:b,size:_,rotation:-Math.PI/2}):this._basicCornersRounded({x:w,y:b,size:_,rotation:Math.PI/2})}_drawClassyRounded({x:w,y:b,size:_,getNeighbor:k}){let S=k?+k(-1,0):0,N=k?+k(1,0):0,V=k?+k(0,-1):0,z=k?+k(0,1):0;S+N+V+z!==0?S||V?N||z?this._basicSquare({x:w,y:b,size:_,rotation:0}):this._basicCornerExtraRounded({x:w,y:b,size:_,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:w,y:b,size:_,rotation:-Math.PI/2}):this._basicCornersRounded({x:w,y:b,size:_,rotation:Math.PI/2})}}let u={dot:"dot",square:"square",extraRounded:"extra-rounded"},c=Object.values(u);class d{constructor({svg:w,type:b,window:_}){this._svg=w,this._type=b,this._window=_}draw(w,b,_,k){let S;switch(this._type){case u.square:S=this._drawSquare;break;case u.extraRounded:S=this._drawExtraRounded;break;default:S=this._drawDot}S.call(this,{x:w,y:b,size:_,rotation:k})}_rotateFigure({x:w,y:b,size:_,rotation:k=0,draw:S}){var N;let V=w+_/2,z=b+_/2;S(),(N=this._element)===null||N===void 0||N.setAttribute("transform",`rotate(${180*k/Math.PI},${V},${z})`)}_basicDot(w){let{size:b,x:_,y:k}=w,S=b/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_+b/2} ${k}a ${b/2} ${b/2} 0 1 0 0.1 0zm 0 ${S}a ${b/2-S} ${b/2-S} 0 1 1 -0.1 0Z`)}}))}_basicSquare(w){let{size:b,x:_,y:k}=w,S=b/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_} ${k}v ${b}h ${b}v `+-b+`zM ${_+S} ${k+S}h `+(b-2*S)+"v "+(b-2*S)+"h "+(2*S-b)+"z")}}))}_basicExtraRounded(w){let{size:b,x:_,y:k}=w,S=b/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${_} ${k+2.5*S}v `+2*S+`a ${2.5*S} ${2.5*S}, 0, 0, 0, ${2.5*S} ${2.5*S}h `+2*S+`a ${2.5*S} ${2.5*S}, 0, 0, 0, ${2.5*S} ${2.5*-S}v `+-2*S+`a ${2.5*S} ${2.5*S}, 0, 0, 0, ${2.5*-S} ${2.5*-S}h `+-2*S+`a ${2.5*S} ${2.5*S}, 0, 0, 0, ${2.5*-S} ${2.5*S}M ${_+2.5*S} ${k+S}h `+2*S+`a ${1.5*S} ${1.5*S}, 0, 0, 1, ${1.5*S} ${1.5*S}v `+2*S+`a ${1.5*S} ${1.5*S}, 0, 0, 1, ${1.5*-S} ${1.5*S}h `+-2*S+`a ${1.5*S} ${1.5*S}, 0, 0, 1, ${1.5*-S} ${1.5*-S}v `+-2*S+`a ${1.5*S} ${1.5*S}, 0, 0, 1, ${1.5*S} ${1.5*-S}`)}}))}_drawDot({x:w,y:b,size:_,rotation:k}){this._basicDot({x:w,y:b,size:_,rotation:k})}_drawSquare({x:w,y:b,size:_,rotation:k}){this._basicSquare({x:w,y:b,size:_,rotation:k})}_drawExtraRounded({x:w,y:b,size:_,rotation:k}){this._basicExtraRounded({x:w,y:b,size:_,rotation:k})}}let f={dot:"dot",square:"square"},h=Object.values(f);class v{constructor({svg:w,type:b,window:_}){this._svg=w,this._type=b,this._window=_}draw(w,b,_,k){let S;S=this._type===f.square?this._drawSquare:this._drawDot,S.call(this,{x:w,y:b,size:_,rotation:k})}_rotateFigure({x:w,y:b,size:_,rotation:k=0,draw:S}){var N;let V=w+_/2,z=b+_/2;S(),(N=this._element)===null||N===void 0||N.setAttribute("transform",`rotate(${180*k/Math.PI},${V},${z})`)}_basicDot(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(_+b/2)),this._element.setAttribute("cy",String(k+b/2)),this._element.setAttribute("r",String(b/2))}}))}_basicSquare(w){let{size:b,x:_,y:k}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(_)),this._element.setAttribute("y",String(k)),this._element.setAttribute("width",String(b)),this._element.setAttribute("height",String(b))}}))}_drawDot({x:w,y:b,size:_,rotation:k}){this._basicDot({x:w,y:b,size:_,rotation:k})}_drawSquare({x:w,y:b,size:_,rotation:k}){this._basicSquare({x:w,y:b,size:_,rotation:k})}}let m="circle",p=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],g=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],C=(()=>{class E{constructor(b,_){this._roundSize=k=>this._options.dotsOptions.roundSize?Math.floor(k):k,this._window=_,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(b.width)),this._element.setAttribute("height",String(b.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),b.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${b.width} ${b.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=b.image,this._instanceId=E.instanceCount++,this._options=b}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}drawQR(b){return ot(this,null,function*(){let _=b.getModuleCount(),k=Math.min(this._options.width,this._options.height)-2*this._options.margin,S=this._options.shape===m?k/Math.sqrt(2):k,N=this._roundSize(S/_),V={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=b,this._options.image){if(yield this.loadImage(),!this._image)return;let{imageOptions:z,qrOptions:H}=this._options,Y=z.imageSize*s[H.errorCorrectionLevel],ee=Math.floor(Y*_*_);V=function({originalHeight:J,originalWidth:ne,maxHiddenDots:ie,maxHiddenAxisDots:K,dotSize:L}){let j={x:0,y:0},$={x:0,y:0};if(J<=0||ne<=0||ie<=0||L<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};let U=J/ne;return j.x=Math.floor(Math.sqrt(ie/U)),j.x<=0&&(j.x=1),K&&K<j.x&&(j.x=K),j.x%2==0&&j.x--,$.x=j.x*L,j.y=1+2*Math.ceil((j.x*U-1)/2),$.y=Math.round($.x*U),(j.y*j.x>ie||K&&K<j.y)&&(K&&K<j.y?(j.y=K,j.y%2==0&&j.x--):j.y-=2,$.y=j.y*L,j.x=1+2*Math.ceil((j.y/U-1)/2),$.x=Math.round($.y/U)),{height:$.y,width:$.x,hideYDots:j.y,hideXDots:j.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:ee,maxHiddenAxisDots:_-14,dotSize:N})}this.drawBackground(),this.drawDots((z,H)=>{var Y,ee,J,ne,ie,K;return!(this._options.imageOptions.hideBackgroundDots&&z>=(_-V.hideYDots)/2&&z<(_+V.hideYDots)/2&&H>=(_-V.hideXDots)/2&&H<(_+V.hideXDots)/2||!((Y=p[z])===null||Y===void 0)&&Y[H]||!((ee=p[z-_+7])===null||ee===void 0)&&ee[H]||!((J=p[z])===null||J===void 0)&&J[H-_+7]||!((ne=g[z])===null||ne===void 0)&&ne[H]||!((ie=g[z-_+7])===null||ie===void 0)&&ie[H]||!((K=g[z])===null||K===void 0)&&K[H-_+7])}),this.drawCorners(),this._options.image&&(yield this.drawImage({width:V.width,height:V.height,count:_,dotSize:N}))})}drawBackground(){var b,_,k;let S=this._element,N=this._options;if(S){let V=(b=N.backgroundOptions)===null||b===void 0?void 0:b.gradient,z=(_=N.backgroundOptions)===null||_===void 0?void 0:_.color,H=N.height,Y=N.width;if(V||z){let ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((k=N.backgroundOptions)===null||k===void 0)&&k.round&&(H=Y=Math.min(N.width,N.height),ee.setAttribute("rx",String(H/2*N.backgroundOptions.round))),ee.setAttribute("x",String(this._roundSize((N.width-Y)/2))),ee.setAttribute("y",String(this._roundSize((N.height-H)/2))),ee.setAttribute("width",String(Y)),ee.setAttribute("height",String(H)),this._backgroundClipPath.appendChild(ee),this._createColor({options:V,color:z,additionalRotation:0,x:0,y:0,height:N.height,width:N.width,name:`background-color-${this._instanceId}`})}}}drawDots(b){var _,k;if(!this._qr)throw"QR code is not defined";let S=this._options,N=this._qr.getModuleCount();if(N>S.width||N>S.height)throw"The canvas is too small.";let V=Math.min(S.width,S.height)-2*S.margin,z=S.shape===m?V/Math.sqrt(2):V,H=this._roundSize(z/N),Y=this._roundSize((S.width-N*H)/2),ee=this._roundSize((S.height-N*H)/2),J=new l({svg:this._element,type:S.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(_=S.dotsOptions)===null||_===void 0?void 0:_.gradient,color:S.dotsOptions.color,additionalRotation:0,x:0,y:0,height:S.height,width:S.width,name:`dot-color-${this._instanceId}`});for(let ne=0;ne<N;ne++)for(let ie=0;ie<N;ie++)b&&!b(ne,ie)||!((k=this._qr)===null||k===void 0)&&k.isDark(ne,ie)&&(J.draw(Y+ie*H,ee+ne*H,H,(K,L)=>!(ie+K<0||ne+L<0||ie+K>=N||ne+L>=N)&&!(b&&!b(ne+L,ie+K))&&!!this._qr&&this._qr.isDark(ne+L,ie+K)),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element));if(S.shape===m){let ne=this._roundSize((V/H-N)/2),ie=N+2*ne,K=Y-ne*H,L=ee-ne*H,j=[],$=this._roundSize(ie/2);for(let U=0;U<ie;U++){j[U]=[];for(let X=0;X<ie;X++)U>=ne-1&&U<=ie-ne&&X>=ne-1&&X<=ie-ne||Math.sqrt((U-$)*(U-$)+(X-$)*(X-$))>$?j[U][X]=0:j[U][X]=this._qr.isDark(X-2*ne<0?X:X>=N?X-2*ne:X-ne,U-2*ne<0?U:U>=N?U-2*ne:U-ne)?1:0}for(let U=0;U<ie;U++)for(let X=0;X<ie;X++)j[U][X]&&(J.draw(K+X*H,L+U*H,H,(de,Te)=>{var _e;return!!(!((_e=j[U+Te])===null||_e===void 0)&&_e[X+de])}),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";let b=this._element,_=this._options;if(!b)throw"Element code is not defined";let k=this._qr.getModuleCount(),S=Math.min(_.width,_.height)-2*_.margin,N=_.shape===m?S/Math.sqrt(2):S,V=this._roundSize(N/k),z=7*V,H=3*V,Y=this._roundSize((_.width-k*V)/2),ee=this._roundSize((_.height-k*V)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([J,ne,ie])=>{var K,L,j,$,U,X,de,Te,_e,fe,ce,we,Me,ke;let xe=Y+J*V*(k-7),Ee=ee+ne*V*(k-7),ye=this._dotsClipPath,se=this._dotsClipPath;if((!((K=_.cornersSquareOptions)===null||K===void 0)&&K.gradient||!((L=_.cornersSquareOptions)===null||L===void 0)&&L.color)&&(ye=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),ye.setAttribute("id",`clip-path-corners-square-color-${J}-${ne}-${this._instanceId}`),this._defs.appendChild(ye),this._cornersSquareClipPath=this._cornersDotClipPath=se=ye,this._createColor({options:(j=_.cornersSquareOptions)===null||j===void 0?void 0:j.gradient,color:($=_.cornersSquareOptions)===null||$===void 0?void 0:$.color,additionalRotation:ie,x:xe,y:Ee,height:z,width:z,name:`corners-square-color-${J}-${ne}-${this._instanceId}`})),((U=_.cornersSquareOptions)===null||U===void 0?void 0:U.type)&&c.includes(_.cornersSquareOptions.type)){let I=new d({svg:this._element,type:_.cornersSquareOptions.type,window:this._window});I.draw(xe,Ee,z,ie),I._element&&ye&&ye.appendChild(I._element)}else{let I=new l({svg:this._element,type:((X=_.cornersSquareOptions)===null||X===void 0?void 0:X.type)||_.dotsOptions.type,window:this._window});for(let W=0;W<p.length;W++)for(let oe=0;oe<p[W].length;oe++)!((de=p[W])===null||de===void 0)&&de[oe]&&(I.draw(xe+oe*V,Ee+W*V,V,(Q,te)=>{var he;return!!(!((he=p[W+te])===null||he===void 0)&&he[oe+Q])}),I._element&&ye&&ye.appendChild(I._element))}if((!((Te=_.cornersDotOptions)===null||Te===void 0)&&Te.gradient||!((_e=_.cornersDotOptions)===null||_e===void 0)&&_e.color)&&(se=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),se.setAttribute("id",`clip-path-corners-dot-color-${J}-${ne}-${this._instanceId}`),this._defs.appendChild(se),this._cornersDotClipPath=se,this._createColor({options:(fe=_.cornersDotOptions)===null||fe===void 0?void 0:fe.gradient,color:(ce=_.cornersDotOptions)===null||ce===void 0?void 0:ce.color,additionalRotation:ie,x:xe+2*V,y:Ee+2*V,height:H,width:H,name:`corners-dot-color-${J}-${ne}-${this._instanceId}`})),((we=_.cornersDotOptions)===null||we===void 0?void 0:we.type)&&h.includes(_.cornersDotOptions.type)){let I=new v({svg:this._element,type:_.cornersDotOptions.type,window:this._window});I.draw(xe+2*V,Ee+2*V,H,ie),I._element&&se&&se.appendChild(I._element)}else{let I=new l({svg:this._element,type:((Me=_.cornersDotOptions)===null||Me===void 0?void 0:Me.type)||_.dotsOptions.type,window:this._window});for(let W=0;W<g.length;W++)for(let oe=0;oe<g[W].length;oe++)!((ke=g[W])===null||ke===void 0)&&ke[oe]&&(I.draw(xe+oe*V,Ee+W*V,V,(Q,te)=>{var he;return!!(!((he=g[W+te])===null||he===void 0)&&he[oe+Q])}),I._element&&se&&se.appendChild(I._element))}})}loadImage(){return new Promise((b,_)=>{var k;let S=this._options;if(!S.image)return _("Image is not defined");if(!((k=S.nodeCanvas)===null||k===void 0)&&k.loadImage)S.nodeCanvas.loadImage(S.image).then(N=>{var V,z;if(this._image=N,this._options.imageOptions.saveAsBlob){let H=(V=S.nodeCanvas)===null||V===void 0?void 0:V.createCanvas(this._image.width,this._image.height);(z=H?.getContext("2d"))===null||z===void 0||z.drawImage(N,0,0),this._imageUri=H?.toDataURL()}b()}).catch(_);else{let N=new this._window.Image;typeof S.imageOptions.crossOrigin=="string"&&(N.crossOrigin=S.imageOptions.crossOrigin),this._image=N,N.onload=()=>ot(this,null,function*(){this._options.imageOptions.saveAsBlob&&(this._imageUri=yield function(V,z){return ot(this,null,function*(){return new Promise(H=>{let Y=new z.XMLHttpRequest;Y.onload=function(){let ee=new z.FileReader;ee.onloadend=function(){H(ee.result)},ee.readAsDataURL(Y.response)},Y.open("GET",V),Y.responseType="blob",Y.send()})})}(S.image||"",this._window)),b()}),N.src=S.image}})}drawImage(N){return ot(this,arguments,function*({width:b,height:_,count:k,dotSize:S}){let V=this._options,z=this._roundSize((V.width-k*S)/2),H=this._roundSize((V.height-k*S)/2),Y=z+this._roundSize(V.imageOptions.margin+(k*S-b)/2),ee=H+this._roundSize(V.imageOptions.margin+(k*S-_)/2),J=b-2*V.imageOptions.margin,ne=_-2*V.imageOptions.margin,ie=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");ie.setAttribute("href",this._imageUri||""),ie.setAttribute("x",String(Y)),ie.setAttribute("y",String(ee)),ie.setAttribute("width",`${J}px`),ie.setAttribute("height",`${ne}px`),this._element.appendChild(ie)})}_createColor({options:b,color:_,additionalRotation:k,x:S,y:N,height:V,width:z,name:H}){let Y=z>V?z:V,ee=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(ee.setAttribute("x",String(S)),ee.setAttribute("y",String(N)),ee.setAttribute("height",String(V)),ee.setAttribute("width",String(z)),ee.setAttribute("clip-path",`url('#clip-path-${H}')`),b){let J;if(b.type==="radial")J=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),J.setAttribute("id",H),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("fx",String(S+z/2)),J.setAttribute("fy",String(N+V/2)),J.setAttribute("cx",String(S+z/2)),J.setAttribute("cy",String(N+V/2)),J.setAttribute("r",String(Y/2));else{let ne=((b.rotation||0)+k)%(2*Math.PI),ie=(ne+2*Math.PI)%(2*Math.PI),K=S+z/2,L=N+V/2,j=S+z/2,$=N+V/2;ie>=0&&ie<=.25*Math.PI||ie>1.75*Math.PI&&ie<=2*Math.PI?(K-=z/2,L-=V/2*Math.tan(ne),j+=z/2,$+=V/2*Math.tan(ne)):ie>.25*Math.PI&&ie<=.75*Math.PI?(L-=V/2,K-=z/2/Math.tan(ne),$+=V/2,j+=z/2/Math.tan(ne)):ie>.75*Math.PI&&ie<=1.25*Math.PI?(K+=z/2,L+=V/2*Math.tan(ne),j-=z/2,$-=V/2*Math.tan(ne)):ie>1.25*Math.PI&&ie<=1.75*Math.PI&&(L+=V/2,K+=z/2/Math.tan(ne),$-=V/2,j-=z/2/Math.tan(ne)),J=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),J.setAttribute("id",H),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("x1",String(Math.round(K))),J.setAttribute("y1",String(Math.round(L))),J.setAttribute("x2",String(Math.round(j))),J.setAttribute("y2",String(Math.round($)))}b.colorStops.forEach(({offset:ne,color:ie})=>{let K=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");K.setAttribute("offset",100*ne+"%"),K.setAttribute("stop-color",ie),J.appendChild(K)}),ee.setAttribute("fill",`url('#${H}')`),this._defs.appendChild(J)}else _&&ee.setAttribute("fill",_);this._element.appendChild(ee)}}return E.instanceCount=0,E})(),x="canvas",M={};for(let E=0;E<=40;E++)M[E]=E;let P={type:x,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:M[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function D(E){let w=Object.assign({},E);if(!w.colorStops||!w.colorStops.length)throw"Field 'colorStops' is required in gradient";return w.rotation?w.rotation=Number(w.rotation):w.rotation=0,w.colorStops=w.colorStops.map(b=>Object.assign(Object.assign({},b),{offset:Number(b.offset)})),w}function R(E){let w=Object.assign({},E);return w.width=Number(w.width),w.height=Number(w.height),w.margin=Number(w.margin),w.imageOptions=Object.assign(Object.assign({},w.imageOptions),{hideBackgroundDots:!!w.imageOptions.hideBackgroundDots,imageSize:Number(w.imageOptions.imageSize),margin:Number(w.imageOptions.margin)}),w.margin>Math.min(w.width,w.height)&&(w.margin=Math.min(w.width,w.height)),w.dotsOptions=Object.assign({},w.dotsOptions),w.dotsOptions.gradient&&(w.dotsOptions.gradient=D(w.dotsOptions.gradient)),w.cornersSquareOptions&&(w.cornersSquareOptions=Object.assign({},w.cornersSquareOptions),w.cornersSquareOptions.gradient&&(w.cornersSquareOptions.gradient=D(w.cornersSquareOptions.gradient))),w.cornersDotOptions&&(w.cornersDotOptions=Object.assign({},w.cornersDotOptions),w.cornersDotOptions.gradient&&(w.cornersDotOptions.gradient=D(w.cornersDotOptions.gradient))),w.backgroundOptions&&(w.backgroundOptions=Object.assign({},w.backgroundOptions),w.backgroundOptions.gradient&&(w.backgroundOptions.gradient=D(w.backgroundOptions.gradient))),w}var A=t(873),F=t.n(A);function O(E){if(!E)throw new Error("Extension must be defined");E[0]==="."&&(E=E.substring(1));let w={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[E.toLowerCase()];if(!w)throw new Error(`Extension "${E}" is not supported`);return w}class T{constructor(w){w?.jsdom?this._window=new w.jsdom("",{resources:"usable"}).window:this._window=window,this._options=w?R(a(P,w)):P,this.update()}static _clearContainer(w){w&&(w.innerHTML="")}_setupSvg(){if(!this._qr)return;let w=new C(this._options,this._window);this._svg=w.getElement(),this._svgDrawingPromise=w.drawQR(this._qr).then(()=>{var b;this._svg&&((b=this._extension)===null||b===void 0||b.call(this,w.getElement(),this._options))})}_setupCanvas(){var w,b;this._qr&&(!((w=this._options.nodeCanvas)===null||w===void 0)&&w.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(b=this._svgDrawingPromise)===null||b===void 0?void 0:b.then(()=>{var _;if(!this._svg)return;let k=this._svg,S=new this._window.XMLSerializer().serializeToString(k),N=btoa(S),V=`data:${O("svg")};base64,${N}`;if(!((_=this._options.nodeCanvas)===null||_===void 0)&&_.loadImage)return this._options.nodeCanvas.loadImage(V).then(z=>{var H,Y;z.width=this._options.width,z.height=this._options.height,(Y=(H=this._nodeCanvas)===null||H===void 0?void 0:H.getContext("2d"))===null||Y===void 0||Y.drawImage(z,0,0)});{let z=new this._window.Image;return new Promise(H=>{z.onload=()=>{var Y,ee;(ee=(Y=this._domCanvas)===null||Y===void 0?void 0:Y.getContext("2d"))===null||ee===void 0||ee.drawImage(z,0,0),H()},z.src=V})}}))}_getElement(w="png"){return ot(this,null,function*(){if(!this._qr)throw"QR code is empty";return w.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),yield this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),yield this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)})}update(w){T._clearContainer(this._container),this._options=w?R(a(this._options,w)):this._options,this._options.data&&(this._qr=F()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(b){switch(!0){case/^[0-9]*$/.test(b):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(b):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===x?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(w){if(w){if(typeof w.appendChild!="function")throw"Container should be a single DOM node";this._options.type===x?this._domCanvas&&w.appendChild(this._domCanvas):this._svg&&w.appendChild(this._svg),this._container=w}}applyExtension(w){if(!w)throw"Extension function should be defined.";this._extension=w,this.update()}deleteExtension(){this._extension=void 0,this.update()}getRawData(w="png"){return ot(this,null,function*(){if(!this._qr)throw"QR code is empty";let b=yield this._getElement(w),_=O(w);if(!b)return null;if(w.toLowerCase()==="svg"){let k=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(b)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(k):new Blob([k],{type:_})}return new Promise(k=>{let S=b;if("toBuffer"in S)if(_==="image/png")k(S.toBuffer(_));else if(_==="image/jpeg")k(S.toBuffer(_));else{if(_!=="application/pdf")throw Error("Unsupported extension");k(S.toBuffer(_))}else"toBlob"in S&&S.toBlob(k,_,1)})})}download(w){return ot(this,null,function*(){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let b="png",_="qr";typeof w=="string"?(b=w,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof w=="object"&&w!==null&&(w.name&&(_=w.name),w.extension&&(b=w.extension));let k=yield this._getElement(b);if(k)if(b.toLowerCase()==="svg"){let S=new XMLSerializer().serializeToString(k);S=`<?xml version="1.0" standalone="no"?>\r
`+S,o(`data:${O(b)};charset=utf-8,${encodeURIComponent(S)}`,`${_}.svg`)}else o(k.toDataURL(O(b)),`${_}.${b}`)})}}let B=T})(),n.default})())});var uv=sl((Aa,Su)=>{"use strict";(function(e,t){typeof Aa=="object"&&typeof Su=="object"?Su.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Aa=="object"?Aa.cytoscapeEuler=t():e.cytoscapeEuler=t()})(Aa,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=11)}([function(r,e,t){"use strict";r.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return a.forEach(function(s){Object.keys(s).forEach(function(l){return n[l]=s[l]})}),n}},function(r,e,t){"use strict";var n=t(0),i=Object.freeze({source:null,target:null,length:80,coeff:2e-4,weight:1});function a(s){return n({},i,s)}function o(s){var l=s.source,u=s.target,c=s.length<0?i.length:s.length,d=u.pos.x-l.pos.x,f=u.pos.y-l.pos.y,h=Math.sqrt(d*d+f*f);h===0&&(d=(Math.random()-.5)/50,f=(Math.random()-.5)/50,h=Math.sqrt(d*d+f*f));var v=h-c,m=(!s.coeff||s.coeff<0?i.springCoeff:s.coeff)*v/h*s.weight;l.force.x+=m*d,l.force.y+=m*f,u.force.x-=m*d,u.force.y-=m*f}r.exports={makeSpring:a,applySpring:o}},function(r,e,t){"use strict";var n=function(){function E(w,b){for(var _=0;_<b.length;_++){var k=b[_];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(w,k.key,k)}}return function(w,b,_){return b&&E(w.prototype,b),_&&E(w,_),w}}();function i(E,w){if(!(E instanceof w))throw new TypeError("Cannot call a class as a function")}function a(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:E}function o(E,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);E.prototype=Object.create(w&&w.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(E,w):E.__proto__=w)}var s=t(13),l=t(0),u=t(4),c=t(10),d=c.tick,f=t(7),h=f.makeQuadtree,v=t(3),m=v.makeBody,p=t(1),g=p.makeSpring,y=function(w){return typeof w=="function"},C=function(w){return w.isParent()},x=function(w){return!C(w)},M=function(w){return w.locked()},P=function(w){return!M(w)},D=function(w){return C(w.source())||C(w.target())},R=function(w){return!D(w)},A=function(w){return w.scratch("euler").body},F=function(w){return C(w)?w.descendants().filter(x):w},O=function(w){var b=w.scratch("euler");return b||(b={},w.scratch("euler",b)),b},T=function(w,b){return y(w)?w(b):w},B=function(E){o(w,E);function w(b){return i(this,w),a(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,l({},u,b)))}return n(w,[{key:"prerun",value:function(_){var k=_;k.quadtree=h();var S=k.bodies=[];k.nodes.filter(function(V){return x(V)}).forEach(function(V){var z=O(V),H=m({pos:{x:z.x,y:z.y},mass:T(k.mass,V),locked:z.locked});H._cyNode=V,z.body=H,H._scratch=z,S.push(H)});var N=k.springs=[];k.edges.filter(R).forEach(function(V){var z=g({source:A(V.source()),target:A(V.target()),length:T(k.springLength,V),coeff:T(k.springCoeff,V)});z._cyEdge=V;var H=O(V);z._scratch=H,H.spring=z,N.push(z)}),k.edges.filter(D).forEach(function(V){var z=F(V.source()),H=F(V.target());z=[z[0]],H=[H[0]],z.forEach(function(Y){H.forEach(function(ee){N.push(g({source:A(Y),target:A(ee),length:T(k.springLength,V),coeff:T(k.springCoeff,V)}))})})})}},{key:"tick",value:function(_){var k=d(_),S=k<=_.movementThreshold;return S}}]),w}(s);r.exports=B},function(r,e,t){"use strict";var n=Object.freeze({pos:{x:0,y:0},prevPos:{x:0,y:0},force:{x:0,y:0},velocity:{x:0,y:0},mass:1}),i=function(u){return{x:u.x,y:u.y}},a=function(u,c){return u??c},o=function(u,c){return i(a(u,c))};function s(l){var u={};return u.pos=o(l.pos,n.pos),u.prevPos=o(l.prevPos,u.pos),u.force=o(l.force,n.force),u.velocity=o(l.velocity,n.velocity),u.mass=l.mass!=null?l.mass:n.mass,u.locked=l.locked,u}r.exports={makeBody:s}},function(r,e,t){"use strict";var n=Object.freeze({springLength:function(a){return 80},springCoeff:function(a){return 8e-4},mass:function(a){return 4},gravity:-1.2,pull:.001,theta:.666,dragCoeff:.02,movementThreshold:1,timeStep:20});r.exports=n},function(r,e,t){"use strict";var n=.02;function i(a,o){var s=void 0;o!=null?s=o:a.dragCoeff!=null?s=a.dragCoeff:s=n,a.force.x-=s*a.velocity.x,a.force.y-=s*a.velocity.y}r.exports={applyDrag:i}},function(r,e,t){"use strict";function n(i,a){var o=0,s=0,l=0,u=0,c,d=i.length;if(d===0)return 0;for(c=0;c<d;++c){var f=i[c],h=a/f.mass;if(!f.grabbed){f.locked?(f.velocity.x=0,f.velocity.y=0):(f.velocity.x+=h*f.force.x,f.velocity.y+=h*f.force.y);var v=f.velocity.x,m=f.velocity.y,p=Math.sqrt(v*v+m*m);p>1&&(f.velocity.x=v/p,f.velocity.y=m/p),o=a*f.velocity.x,l=a*f.velocity.y,f.pos.x+=o,f.pos.y+=l,s+=Math.abs(o),u+=Math.abs(l)}}return(s*s+u*u)/d}r.exports={integrate:n}},function(r,e,t){"use strict";var n=t(9),i=t(8),a=function(d){d.x=0,d.y=0},o=function(d,f){var h=1e-8,v=Math.abs(d.x-f.x),m=Math.abs(d.y-f.y);return v<h&&m<h};function s(){var c=[],d=new i,f=[],h=0,v=m();function m(){var C=f[h];return C?(C.quad0=null,C.quad1=null,C.quad2=null,C.quad3=null,C.body=null,C.mass=C.massX=C.massY=0,C.left=C.right=C.top=C.bottom=0):(C=new n,f[h]=C),++h,C}function p(C,x,M,P){var D=c,R=void 0,A=void 0,F=void 0,O=void 0,T=0,B=0,E=1,w=0,b=1;D[0]=v,a(C.force);var _=-C.pos.x,k=-C.pos.y,S=Math.sqrt(_*_+k*k),N=C.mass*P/S;for(T+=N*_,B+=N*k;E;){var V=D[w],z=V.body;E-=1,w+=1;var H=z!==C;z&&H?(A=z.pos.x-C.pos.x,F=z.pos.y-C.pos.y,O=Math.sqrt(A*A+F*F),O===0&&(A=(Math.random()-.5)/50,F=(Math.random()-.5)/50,O=Math.sqrt(A*A+F*F)),R=x*z.mass*C.mass/(O*O*O),T+=R*A,B+=R*F):H&&(A=V.massX/V.mass-C.pos.x,F=V.massY/V.mass-C.pos.y,O=Math.sqrt(A*A+F*F),O===0&&(A=(Math.random()-.5)/50,F=(Math.random()-.5)/50,O=Math.sqrt(A*A+F*F)),(V.right-V.left)/O<M?(R=x*V.mass*C.mass/(O*O*O),T+=R*A,B+=R*F):(V.quad0&&(D[b]=V.quad0,E+=1,b+=1),V.quad1&&(D[b]=V.quad1,E+=1,b+=1),V.quad2&&(D[b]=V.quad2,E+=1,b+=1),V.quad3&&(D[b]=V.quad3,E+=1,b+=1)))}C.force.x+=T,C.force.y+=B}function g(C){if(C.length!==0){var x=Number.MAX_VALUE,M=Number.MAX_VALUE,P=Number.MIN_VALUE,D=Number.MIN_VALUE,R=void 0,A=C.length;for(R=A;R--;){var F=C[R].pos.x,O=C[R].pos.y;F<x&&(x=F),F>P&&(P=F),O<M&&(M=O),O>D&&(D=O)}var T=P-x,B=D-M;for(T>B?D=M+T:P=x+B,h=0,v=m(),v.left=x,v.right=P,v.top=M,v.bottom=D,R=A-1,R>=0&&(v.body=C[R]);R--;)y(C[R],v)}}function y(C){for(d.reset(),d.push(v,C);!d.isEmpty();){var x=d.pop(),M=x.node,P=x.body;if(M.body){var w=M.body;if(M.body=null,o(w.pos,P.pos)){var b=3;do{var _=Math.random(),k=(M.right-M.left)*_,S=(M.bottom-M.top)*_;w.pos.x=M.left+k,w.pos.y=M.top+S,b-=1}while(b>0&&o(w.pos,P.pos));if(b===0&&o(w.pos,P.pos))return}d.push(M,w),d.push(M,P)}else{var D=P.pos.x,R=P.pos.y;M.mass=M.mass+P.mass,M.massX=M.massX+P.mass*D,M.massY=M.massY+P.mass*R;var A=0,F=M.left,O=(M.right+F)/2,T=M.top,B=(M.bottom+T)/2;D>O&&(A=A+1,F=O,O=M.right),R>B&&(A=A+2,T=B,B=M.bottom);var E=l(M,A);E?d.push(E,P):(E=m(),E.left=F,E.top=T,E.right=O,E.bottom=B,E.body=P,u(M,A,E))}}}return{insertBodies:g,updateBodyForce:p}}function l(c,d){return d===0?c.quad0:d===1?c.quad1:d===2?c.quad2:d===3?c.quad3:null}function u(c,d,f){d===0?c.quad0=f:d===1?c.quad1=f:d===2?c.quad2=f:d===3&&(c.quad3=f)}r.exports={makeQuadtree:s}},function(r,e,t){"use strict";r.exports=n;function n(){this.stack=[],this.popIdx=0}n.prototype={isEmpty:function(){return this.popIdx===0},push:function(o,s){var l=this.stack[this.popIdx];l?(l.node=o,l.body=s):this.stack[this.popIdx]=new i(o,s),++this.popIdx},pop:function(){if(this.popIdx>0)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}};function i(a,o){this.node=a,this.body=o}},function(r,e,t){"use strict";r.exports=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.mass=0,this.massX=0,this.massY=0,this.left=0,this.top=0,this.bottom=0,this.right=0}},function(r,e,t){"use strict";var n=t(6),i=n.integrate,a=t(5),o=a.applyDrag,s=t(1),l=s.applySpring;function u(c){var d=c.bodies,f=c.springs,h=c.quadtree,v=c.timeStep,m=c.gravity,p=c.theta,g=c.dragCoeff,y=c.pull;d.forEach(function(R){var A=R._scratch;A&&(R.locked=A.locked,R.grabbed=A.grabbed,R.pos.x=A.x,R.pos.y=A.y)}),h.insertBodies(d);for(var C=0;C<d.length;C++){var x=d[C];h.updateBodyForce(x,m,p,y),o(x,g)}for(var M=0;M<f.length;M++){var P=f[M];l(P)}var D=i(d,v);return d.forEach(function(R){var A=R._scratch;A&&(A.x=R.pos.x,A.y=R.pos.y)}),D}r.exports={tick:u}},function(r,e,t){"use strict";var n=t(2),i=function(o){o&&o("layout","euler",n)};typeof cytoscape<"u"&&i(cytoscape),r.exports=i},function(r,e,t){"use strict";r.exports=Object.freeze({animate:!0,refresh:10,maxIterations:1e3,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,ready:function(){},stop:function(){},randomize:!1,infinite:!1})},function(r,e,t){"use strict";var n=function(){function m(p,g){for(var y=0;y<g.length;y++){var C=g[y];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(p,C.key,C)}}return function(p,g,y){return g&&m(p.prototype,g),y&&m(p,y),p}}();function i(m,p){if(!(m instanceof p))throw new TypeError("Cannot call a class as a function")}var a=t(0),o=t(12),s=t(14),l=t(15),u=l.setInitialPositionState,c=l.refreshPositions,d=l.getNodePositionData,f=t(16),h=f.multitick,v=function(){function m(p){i(this,m);var g=this.options=a({},o,p),y=g.eles.nodes();if(!g.randomize){y=y.sort(function(P,D){return P.position().x-D.position().x});var C={x:0,y:0},x={};y.forEach(function(P){Object.assign(x,P.position()),Math.abs(C.x-x.x)<g.theta&&Math.abs(C.y-x.y)<g.theta&&P.position({x:Math.random()*100,y:Math.random()*100}),Object.assign(C,x)})}var M=this.state=a({},g,{layout:this,nodes:y,edges:g.eles.edges(),tickIndex:0,firstUpdate:!0});M.animateEnd=g.animate&&g.animate==="end",M.animateContinuously=g.animate&&!M.animateEnd}return n(m,[{key:"run",value:function(){var g=this,y=this.state;if(y.tickIndex=0,y.firstUpdate=!0,y.startTime=Date.now(),y.running=!0,y.currentBoundingBox=s(y.boundingBox,y.cy),y.ready&&g.one("ready",y.ready),y.stop&&g.one("stop",y.stop),y.nodes.forEach(function(k){return u(k,y)}),g.prerun(y),y.animateContinuously){var C=function(S){if(y.ungrabifyWhileSimulating){var N=d(S,y).grabbable=S.grabbable();N&&S.ungrabify()}},x=function(S){if(y.ungrabifyWhileSimulating){var N=d(S,y).grabbable;N&&S.grabify()}},M=function(S){return d(S,y).grabbed=S.grabbed()},P=function(S){var N=S.target;M(N)},D=P,R=function(S){var N=S.target,V=d(N,y),z=N.position();V.x=z.x,V.y=z.y},A=function(S){S.on("grab",P),S.on("free",D),S.on("drag",R)},F=function(S){S.removeListener("grab",P),S.removeListener("free",D),S.removeListener("drag",R)},O=function(){y.fit&&y.animateContinuously&&y.cy.fit(y.padding)},T=function(){c(y.nodes,y),O(),requestAnimationFrame(B)},B=function(){h(y,T,E)},E=function(){c(y.nodes,y),O(),y.nodes.forEach(function(S){x(S),F(S)}),y.running=!1,g.emit("layoutstop")};g.emit("layoutstart"),y.nodes.forEach(function(k){C(k),A(k)}),B()}else{for(var w=!1,b=function(){},_=function(){return w=!0};!w;)h(y,b,_);y.eles.layoutPositions(this,y,function(k){var S=d(k,y);return{x:S.x,y:S.y}})}return g.postrun(y),this}},{key:"prerun",value:function(){}},{key:"postrun",value:function(){}},{key:"tick",value:function(){}},{key:"stop",value:function(){return this.state.running=!1,this}},{key:"destroy",value:function(){return this}}]),m}();r.exports=v},function(r,e,t){"use strict";r.exports=function(n,i){return n==null?n={x1:0,y1:0,w:i.width(),h:i.height()}:n={x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2,w:n.w,h:n.h},n.x2==null&&(n.x2=n.x1+n.w),n.w==null&&(n.w=n.x2-n.x1),n.y2==null&&(n.y2=n.y1+n.h),n.h==null&&(n.h=n.y2-n.y1),n}},function(r,e,t){"use strict";var n=t(0),i=function(l,u){var c=l.position(),d=u.currentBoundingBox,f=l.scratch(u.name);f==null&&(f={},l.scratch(u.name,f)),n(f,u.randomize?{x:d.x1+Math.random()*d.w,y:d.y1+Math.random()*d.h}:{x:c.x,y:c.y}),f.locked=l.locked()},a=function(l,u){return l.scratch(u.name)},o=function(l,u){l.positions(function(c){var d=c.scratch(u.name);return{x:d.x,y:d.y}})};r.exports={setInitialPositionState:i,getNodePositionData:a,refreshPositions:o}},function(r,e,t){"use strict";var n=function(){},i=function(s){var l=s,u=s.layout,c=u.tick(l);l.firstUpdate&&(l.animateContinuously&&l.layout.emit("layoutready"),l.firstUpdate=!1),l.tickIndex++;var d=Date.now()-l.startTime;return!l.infinite&&(c||l.tickIndex>=l.maxIterations||d>=l.maxSimulationTime)},a=function(s){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n,c=!1,d=s,f=0;f<d.refresh&&(c=!d.running||i(d),!c);f++);c?u():l()};r.exports={tick:i,multitick:a}}])})});var cv=sl((Ba,Tu)=>{"use strict";(function(e,t){typeof Ba=="object"&&typeof Tu=="object"?Tu.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Ba=="object"?Ba.cytoscapePopper=t():e.cytoscapePopper=t()})(Ba,function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=r,t.c=e,t.i=function(n){return n},t.d=function(n,i,a){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:a})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},t.p="",t(t.s=7)}([function(r,e,t){"use strict";var n=t(5),i=n.getBoundingBox;function a(o,s){var l={getBoundingClientRect:function(){return i(o,s)}};return l}r.exports={getRef:a}},function(r,e,t){"use strict";r.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return a.forEach(function(s){s!=null&&Object.keys(s).forEach(function(l){return n[l]=s[l]})}),n}},function(r,e,t){"use strict";var n=t(0),i=n.getRef,a=t(6),o=a.getContent;function s(l,u){var c=i(l,u),d=o(l,u.content);return l.popperFactory(c,d,u.popper)}r.exports={getPopper:s}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function l(v){return h(this),a(this[0],c(this[0],v))}function u(v){return h(this),s(this[0],c(this[0],v))}function c(v,m){var p=function(P){return P.isNode()?{w:P.renderedWidth(),h:P.renderedHeight()}:{w:3,h:3}},g=function(P){return P.isNode()?d(P,p):f(P)},y={},C=v.cy(),x={renderedDimensions:p,renderedPosition:g,popper:y,cy:C};return n({},x,m)}function d(v,m){var p=v.renderedPosition(),g=m(v),y=g.w/2,C=g.h/2;return{x:p.x-y,y:p.y-C}}function f(v){var m=v.midpoint(),p=v.cy().pan(),g=v.cy().zoom();return{x:m.x*g+p.x,y:m.y*g+p.y}}function h(v){v.length>1&&(console.warn("Popper.js Extension should only be used on one element."),console.warn("Ignoring all subsequent elements"))}r.exports={popper:l,popperRef:u}},function(r,e,t){"use strict";var n=t(1),i=t(2),a=i.getPopper,o=t(0),s=o.getRef;function l(d){return a(this,c(this,d))}function u(d){return s(this,c(this,d))}function c(d,f){var h={boundingBox:{top:0,left:0,right:0,bottom:0,w:3,h:3},renderedDimensions:function(){return{w:3,h:3}},renderedPosition:function(){return{x:0,y:0}},popper:{},cy:d};return n({},h,f)}r.exports={popper:l,popperRef:u}},function(r,e,t){"use strict";function n(i,a){var o=a.renderedPosition,s=a.cy,l=a.renderedDimensions,u=s.container().getBoundingClientRect(),c=l(i),d=o(i);return{top:d.y+u.top,left:d.x+u.left,right:d.x+c.w+u.left,bottom:d.y+c.h+u.top,width:c.w,height:c.h}}r.exports={getBoundingBox:n}},function(r,e,t){"use strict";function n(i,a){var o=null;if(typeof a=="function")o=a(i);else{if(a instanceof HTMLElement)return a;throw new Error("Can not create popper from 'target' with unknown type")}if(o===null)throw new Error("No 'target' specified to create popper");return o}r.exports={getContent:n}},function(r,e,t){"use strict";var n=t(4),i=t(3),a=function(s){if(typeof s!="function")throw new Error("Provide 'popperFactory' before registering the module");return function(u){u&&(u("core","popperFactory",s),u("collection","popperFactory",s),u("core","popper",n.popper),u("collection","popper",i.popper),u("core","popperRef",n.popperRef),u("collection","popperRef",i.popperRef))}};r.exports=a}])})});var Cl=(r,e)=>e.id;function gp(r,e){if(r&1){let t=Oe();G(0,"mat-chip-row",15),ue("removed",function(){let i=ge(t).$implicit,a=re();return me(a.removeTag(i))}),ae(1),G(2,"button",16)(3,"mat-icon"),ae(4,"cancel"),q()()()}if(r&2){let t=e.$implicit;pe("removable",!0),Z(),Ge(" ",t.name," "),Z(),lc("aria-label","remove "+t.name)}}function mp(r,e){if(r&1&&(G(0,"mat-option",13),ae(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),Ge(" ",t.name," ")}}function yp(r,e){if(r&1&&(G(0,"mat-list-option",13),ae(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),Ge(" ",t.title," ")}}function Cp(r,e){if(r&1){let t=Oe();G(0,"mat-selection-list",17),Kt("ngModelChange",function(i){ge(t);let a=re();return Ut(a.selectedCollate,i)||(a.selectedCollate=i),me(i)}),ue("selectionChange",function(i){ge(t);let a=re();return me(a.onCollateSelect(i))}),We(1,yp,2,2,"mat-list-option",13,Cl),q(),G(3,"mat-paginator",18),ue("page",function(i){ge(t);let a=re();return me(a.handlePageEvent(i))}),q()}if(r&2){let t=re();Wt("ngModel",t.selectedCollate),pe("multiple",!1),Z(),Ue(t.collates),Z(2),pe("length",t.totalCount)("pageSize",t.limit)}}function wp(r,e){r&1&&(G(0,"p"),ae(1,"No collates could be found."),q())}var jc=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.fb=n,this.router=i,this.collateService=a,this.dialog=o,this.collates=[],this.searchTags=[],this.selectedCollate=null,this.searchTerm="",this.limit=5,this.offset=0,this.totalCount=0,this.separatorKeysCodes=[13,188],this.form=this.fb.group({tag:[""]}),this.loading=!1}ngOnInit(){this.searchCollates(),this.filteredTags=this.form.controls.tag.valueChanges.pipe(Wa(""),Ju(t=>t?t.length>=2:!1),Ua(t=>this.collateService.getCollateTags(t).pipe(Ha(n=>n.results))))}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,this.searchTerm,this.searchTags.map(t=>t.id)).subscribe({next:t=>{this.collates=t.results,this.totalCount=t.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onCollateSelect(t){this.selectedCollate=t.options[0].value,this.router.navigate([`/collate/view/${t.options[0].value.id}`]).then(n=>console.log(n))}openCreateCollateDialog(){this.dialog.open(Oc).afterClosed().subscribe(n=>{n&&this.collateService.createCollate(n.title,n.greeting).subscribe(i=>{this.router.navigate([`/collate/edit/${i.id}`]).then(a=>console.log(a))})})}handlePageEvent(t){this.limit=t.pageSize,this.offset=t.pageIndex*this.limit,this.searchCollates()}addTag(t){let n=t.option.value;n&&!this.searchTags.find(i=>i.id===n.id)&&this.searchTags.push(n),this.form.controls.tag.setValue(""),this.searchCollates()}removeTag(t){let n=this.searchTags.indexOf(t);n>=0&&this.searchTags.splice(n,1),this.searchCollates()}static{this.\u0275fac=function(n){return new(n||r)(be(Er),be(Qt),be(ai),be(Nr),be(ui))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate"]],decls:33,vars:8,consts:[["chipGrid",""],["auto","matAutocomplete"],[1,"collate-container"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[1,"search-box"],["mat-button","",2,"width","100%",3,"click"],["appearance","outlined",2,"width","500px"],[2,"width","100%"],["matInput","","placeholder","Search Collates",3,"ngModelChange","ngModel"],[3,"removable"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-raised-button","","color","primary",3,"click"],[3,"removed","removable"],["matChipRemove",""],[3,"ngModelChange","selectionChange","ngModel","multiple"],[3,"page","length","pageSize"]],template:function(n,i){if(n&1){let a=Oe();G(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),ae(4,"C|nder Collates"),q(),De(5,"br"),q()(),G(6,"div",5)(7,"div")(8,"button",6),ue("click",function(){return ge(a),me(i.openCreateCollateDialog())}),G(9,"h3"),ae(10,"+ Create Collate From Projects"),q()()(),De(11,"hr"),G(12,"mat-card",7)(13,"mat-card-content")(14,"mat-form-field",8)(15,"input",9),Kt("ngModelChange",function(s){return ge(a),Ut(i.searchTerm,s)||(i.searchTerm=s),me(s)}),ue("ngModelChange",function(){return ge(a),me(i.searchCollates())}),q()(),G(16,"mat-form-field",8)(17,"mat-label"),ae(18,"Search Tags"),q(),G(19,"mat-chip-grid",null,0),We(21,gp,5,3,"mat-chip-row",10,Cl),De(23,"input",11),q(),G(24,"mat-autocomplete",12,1),ue("optionSelected",function(s){return ge(a),me(i.addTag(s))}),We(26,mp,2,2,"mat-option",13,Cl),eo(28,"async"),q()(),G(29,"button",14),ue("click",function(){return ge(a),me(i.searchCollates())}),ae(30,"Search"),q(),Se(31,Cp,4,4)(32,wp,2,0,"p"),q()()()()}if(n&2){let a=br(20),o=br(25);Z(15),Wt("ngModel",i.searchTerm),Z(6),Ue(i.searchTags),Z(2),pe("matChipInputFor",a)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("formControl",i.form.controls.tag)("matAutocomplete",o),Z(3),Ue(to(28,6,i.filteredTags)),Z(5),Re(i.collates.length>0?31:32)}},dependencies:[Zt,hn,Yt,Et,fn,Jt,lo,so,Vr,li,si,ct,co,Xt,fo,Ic,Rc,Bc,oi,po,io,hr,Tc,go],styles:[".collate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:80vh}.search-box[_ngcontent-%COMP%]{width:500px}"]})}}return r})();var $c=(()=>{class r{constructor(){this.collate=null}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-header"]],inputs:{collate:"collate"},decls:7,vars:2,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(n,i){n&1&&(G(0,"div",0)(1,"div",1)(2,"h1"),ae(3),q(),De(4,"br"),G(5,"div",2),ae(6),q()()()),n&2&&(Z(3),rt(i.collate==null?null:i.collate.title),Z(3),rt(i.collate==null?null:i.collate.greeting))},styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();function xp(r,e){if(r&1&&(G(0,"p"),ae(1),De(2,"br"),ae(3),q(),De(4,"mat-progress-bar",8)),r&2){let t=re();Z(),Ge("Elapsed Time: ",t.elapsedTime," seconds"),Z(2),Ge(" ",t.progress," ")}}var No=(()=>{class r{constructor(t,n,i,a,o){this.snackBar=t,this.ws=n,this.fb=i,this.web=a,this.sb=o,this.projects=[],this.loading=!1,this.searchStartTime=null,this.elapsedTime="0.00",this.progress="",this.form=this.fb.group({searchQuery:new _r("",xr.required),searchMode:new _r("gene",xr.required)}),this.searchResultID=new it,this.ws.searchWSConnection?.subscribe(s=>{if(s&&s.type==="search_status")switch(s.status){case"complete":this.loading=!1,clearInterval(this.timerInterval);let l=this.calculateElapsedTime();this.progress="",this.showSnackBar(`Search complete in ${l} seconds`),this.searchResultID.emit(parseInt(s.id));break;case"in_progress":this.progress=`Current progress: ${s.current_progress}/${s.found_files}`;break;case"error":this.loading=!1,this.progress="Search error",this.showSnackBar("Search error");break}})}runSearch(){return ot(this,null,function*(){if(this.form.invalid)return;this.loading=!0,this.progress="Current progress: search initiated",this.searchStartTime=new Date,this.elapsedTime="0.00",this.timerInterval=setInterval(()=>{this.elapsedTime=this.calculateElapsedTime().toFixed(2)},200);let t=[];if(this.projects.length>0){let n=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();if(n)for(let i of n)t.push(i.id)}if(this.form.value.searchQuery&&this.form.value.searchMode){let i=this.form.value.searchQuery.toUpperCase().split("OR").map(a=>`"${a.trim().replace(/'/g,"").replace(/"/g,"")}"`);this.web.createSearch(t,i.join(" OR "),this.web.searchSessionID,1e-9,1e-9,this.form.value.searchMode).subscribe({next:()=>{this.sb.open("Search queued","Dismiss",{duration:2e3})},error:()=>{this.loading=!1,clearInterval(this.timerInterval),this.showSnackBar("Search error")}})}})}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}calculateElapsedTime(){return this.searchStartTime?(new Date().getTime()-this.searchStartTime.getTime())/1e3:0}static{this.\u0275fac=function(n){return new(n||r)(be(Er),be(mo),be(Qt),be(er),be(Er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-search"]],inputs:{projects:"projects"},outputs:{searchResultID:"searchResultID"},decls:22,vars:2,consts:[["appearance","outlined"],[2,"display","flex","gap","20px","align-items","center",3,"ngSubmit","formGroup"],[2,"width","500px"],["matInput","","placeholder","Search Query","formControlName","searchQuery"],["formControlName","searchMode"],["value","pi"],["value","gene"],["mat-icon-button","","color","primary","type","submit"],["mode","indeterminate"]],template:function(n,i){n&1&&(G(0,"mat-card",0)(1,"mat-card-content")(2,"form",1),ue("ngSubmit",function(){return i.runSearch()}),G(3,"mat-form-field",2),De(4,"input",3),q(),G(5,"mat-form-field")(6,"mat-label"),ae(7,"Search Mode"),q(),G(8,"mat-select",4)(9,"mat-option",5),ae(10,"Primary Ids"),q(),G(11,"mat-option",6),ae(12,"Gene Names"),q()()(),G(13,"button",7)(14,"mat-icon"),ae(15,"search"),q()()(),G(16,"p"),ae(17," For multiple search terms separate them with "),G(18,"b"),ae(19,"OR"),q(),ae(20,". "),q(),Se(21,xp,5,2),q()()),n&2&&(Z(2),pe("formGroup",i.form),Z(19),Re(i.loading?21:-1))},dependencies:[Jt,hr,fr,Yt,Et,dr,Fr,Lr,Zt,dn,Xt,li,si,oi,Ac,Vr,Fc],encapsulation:2})}}return r})();var Ep=qa(pp());yl.plotlyjs=Ep;var Gc=(()=>{class r{set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set renameCondition(t){t?this._renameCondition=t:this._renameCondition={}}get renameCondition(){return this._renameCondition}set data(t){this._data=t,this.graphLayout.title.text=t?.analysis_group?.name||"",this.graphLayout.yaxis.title=this.searchTerm||"",this.conditionA=t?.condition_A||"",this.conditionB=t?.condition_B||"",this.drawGraph()}get data(){return this._data}set expanded(t){this._expanded=t,this.data&&this.drawGraph()}get expanded(){return this._expanded}set colorMap(t){t&&(this._colorMap=t,this.data&&t&&this.drawGraph())}get colorMap(){return this._colorMap}constructor(t,n){this.graph=t,this.accounts=n,this._data=null,this._renameCondition={},this._searchTerm="",this._expanded=!1,this.graphData=[],this.graphLayout={title:{text:"",font:{size:16}},height:400,margin:{l:150,r:100,b:100,t:100},yaxis:{title:this.searchTerm,tickfont:{size:14}}},this.conditionA="",this.conditionB="",this.valueA=[],this.valueB=[],this.barSize=50,this.revision=0,this._colorMap={},this.currentColor=0,this.graph.redrawTrigger.subscribe(()=>{this.drawGraph()})}drawGraph(){this.loadPlotSettings(),this.graph.plotSettings.showTitle||(this.graphLayout.title.text="");let t=this.renameCondition[this.conditionA];t||(t=this.conditionA);let n=this.renameCondition[this.conditionB];n||(n=this.conditionB);let i=document.getElementsByTagName("body")[0],o=window.getComputedStyle(i).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=o,this.graphLayout.paper_bgcolor=o,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let s=0;if(this.data&&this.data.condition_A&&this.data.condition_B&&this.data.searched_data&&!this.expanded){this.conditionA=this.data.condition_A||"",this.conditionB=this.data.condition_B||"",this.valueA=this.data.searched_data.filter(v=>v.Condition===this.conditionA).map(v=>v.Value),this.valueB=this.data.searched_data.filter(v=>v.Condition===this.conditionB).map(v=>v.Value);let l=this.calculateMean(this.valueA),u=this.calculateMean(this.valueB);this.colorMap[this.conditionA]||(this.colorMap[this.conditionA]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let c={x:[t],y:[l],type:"bar",mode:"markers",name:t,error_y:{type:"data",array:[this.calculateWhisker(this.valueA)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionA]},showlegend:!1},d=this.drawTransparentBoxPlot(this.valueA,t);this.colorMap[this.conditionB]||(this.colorMap[this.conditionB]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let f={x:[n],y:[u],type:"bar",mode:"markers",name:n,error_y:{type:"data",array:[this.calculateWhisker(this.valueB)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionB]},showlegend:!1},h=this.drawTransparentBoxPlot(this.valueB,n);s=2,this.graphData=[c,d,f,h]}else if(this.data&&(this.expanded||this.data.condition_A==""||this.data.condition_B=="")){let l=Array.from(new Set(this.data.searched_data.map(h=>h.Condition))),u=l.map(h=>{let v=this.data.searched_data.filter(m=>m.Condition===h).map(m=>m.Value);return this.calculateMean(v)}),c=l.map(h=>{let v=this.data.searched_data.filter(m=>m.Condition===h).map(m=>m.Value);return this.calculateWhisker(v)}),d=l.map((h,v)=>{this.colorMap[h]||(this.colorMap[h]=this.graph.defaultColorList[this.currentColor],this.currentColor++,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0));let m=this.renameCondition[h];return m||(m=h),{x:[m],y:[u[v]],type:"bar",mode:"markers",name:m,error_y:{type:"data",array:[c[v]],visible:!0},line:{color:"black"},marker:{color:this.colorMap[h]},showlegend:!1}}),f=l.map((h,v)=>{let m=this.renameCondition[h];m||(m=h);let p=this.data.searched_data.filter(g=>g.Condition===h).map(g=>g.Value);return this.drawTransparentBoxPlot(p,m)});s=l.length,this.graphData=[...d,...f]}console.log(this.colorMap),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*s,this.revision++,console.log(this.graphData)}calculateMean(t){return t.reduce((i,a)=>i+a,0)/t.length}calculateWhisker(t){let n=this.calculateMean(t),i=t.reduce((a,o)=>a+Math.pow(o-n,2),0)/t.length;return Math.sqrt(i)}drawTransparentBoxPlot(t,n){return{x:n,y:t.filter(i=>!isNaN(i)),type:"box",boxpoints:"all",pointpos:0,jitter:.3,fillcolor:"rgba(255,255,255,0)",line:{color:"rgba(255,255,255,0)"},hoveron:"points",marker:{color:"#654949",opacity:.8},name:n,showlegend:!1}}loadPlotSettings(){this.graphLayout.height=this.graph.plotSettings.height,this.graphLayout.margin.l=this.graph.plotSettings.marginLeft,this.graphLayout.margin.r=this.graph.plotSettings.marginRight,this.graphLayout.margin.b=this.graph.plotSettings.marginBottom,this.graphLayout.margin.t=this.graph.plotSettings.marginTop,this.graphLayout.title.font.size=this.graph.plotSettings.titleTextSize,this.barSize=this.graph.plotSettings.barSize}static{this.\u0275fac=function(n){return new(n||r)(be(Bo),be(zr))}}static{this.\u0275cmp=je({type:r,selectors:[["app-bar-chart"]],inputs:{searchTerm:"searchTerm",renameCondition:"renameCondition",data:"data",expanded:"expanded",colorMap:"colorMap"},decls:1,vars:4,consts:[[3,"data","layout","revision","updateOnLayoutChange"]],template:function(n,i){n&1&&De(0,"plotly-plot",0),n&2&&pe("data",i.graphData)("layout",i.graphLayout)("revision",i.revision)("updateOnLayoutChange",!0)},dependencies:[yl,Vc],encapsulation:2})}}return r})();var Sp=(r,e)=>e.id;function Tp(r,e){if(r&1){let t=Oe();G(0,"div",3)(1,"mat-slide-toggle",8),ue("change",function(){ge(t);let i=re(2);return me(i.expanded=!i.expanded)}),ae(2," Expand Bar Chart "),q(),G(3,"mat-slide-toggle",8),ue("change",function(){ge(t);let i=re(2);return me(i.viewDifferentialAnalysis=!i.viewDifferentialAnalysis)}),ae(4," View Differential Analysis Stats "),q()()}r&2&&(Z(),pe("color","primary"),Z(2),pe("color","primary"))}function kp(r,e){if(r&1&&(G(0,"div"),De(1,"app-bar-chart",11),q()),r&2){let t=re().$implicit,n=re(3);Z(),pe("searchTerm",t.gene_name)("expanded",n.expanded)("renameCondition",n.renameCondition)("colorMap",n.colorMap)("data",t)}}function Mp(r,e){r&1&&(G(0,"div")(1,"p"),ae(2,"No data found for this search"),q()())}function Dp(r,e){if(r&1&&(G(0,"div",9),Se(1,kp,2,5,"div")(2,Mp,3,0,"div"),G(3,"div")(4,"button",10)(5,"mat-icon"),ae(6,"drag_handle"),q()(),G(7,"p"),ae(8),q()()()),r&2){let t=e.$implicit;Z(),Re(t.searched_data.length>0?1:2),Z(3),pe("matTooltip",t.analysis_group.name),Z(4),Ge(" ",t.analysis_group.name," ")}}function Pp(r,e){if(r&1&&We(0,Dp,9,3,"div",9,Sp),r&2){let t=re(2);Ue(t.searchResults)}}function Ap(r,e){r&1&&(G(0,"p"),ae(1,"No search results found in this project"),q())}function Bp(r,e){r&1&&(G(0,"th",24),ae(1," Primary ID "),q())}function Rp(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.primary_id," ")}}function Ip(r,e){r&1&&(G(0,"th",24),ae(1," UniProt ID "),q())}function Op(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.uniprot_id," ")}}function Fp(r,e){r&1&&(G(0,"th",24),ae(1," Gene Names "),q())}function Lp(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.gene_name," ")}}function Vp(r,e){r&1&&(G(0,"th",24),ae(1," log2FC "),q())}function Np(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.log2_fc," ")}}function zp(r,e){r&1&&(G(0,"th",24),ae(1," -log10(p) "),q())}function jp(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.log10_p," ")}}function $p(r,e){r&1&&(G(0,"th",24),ae(1," Condition A "),q())}function Gp(r,e){if(r&1&&ae(0),r&2){let t=re().$implicit,n=re(3);Ge(" ",n.renameCondition[t.condition_A]," ")}}function qp(r,e){if(r&1&&ae(0),r&2){let t=re().$implicit;Ge(" ",t.condition_A," ")}}function Hp(r,e){if(r&1&&(G(0,"td",25),Se(1,Gp,1,1)(2,qp,1,1),q()),r&2){let t=re(3);Z(),Re(t.renameCondition?1:2)}}function Wp(r,e){r&1&&(G(0,"th",24),ae(1," Condition B "),q())}function Up(r,e){if(r&1&&ae(0),r&2){let t=re().$implicit,n=re(3);Ge(" ",n.renameCondition[t.condition_B]," ")}}function Kp(r,e){if(r&1&&ae(0),r&2){let t=re().$implicit;Ge(" ",t.condition_B," ")}}function Xp(r,e){if(r&1&&(G(0,"td",25),Se(1,Up,1,1)(2,Kp,1,1),q()),r&2){let t=re(3);Z(),Re(t.renameCondition?1:2)}}function Yp(r,e){r&1&&(G(0,"th",24),ae(1," Comparison "),q())}function Qp(r,e){if(r&1&&(G(0,"td",25),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.comparison_label," ")}}function Zp(r,e){r&1&&De(0,"tr",26)}function Jp(r,e){r&1&&De(0,"tr",27)}function eg(r,e){if(r&1&&(G(0,"table",5),xt(1,12),Se(2,Bp,2,0,"th",13)(3,Rp,2,1,"td",14),_t(),xt(4,15),Se(5,Ip,2,0,"th",13)(6,Op,2,1,"td",14),_t(),xt(7,16),Se(8,Fp,2,0,"th",13)(9,Lp,2,1,"td",14),_t(),xt(10,17),Se(11,Vp,2,0,"th",13)(12,Np,2,1,"td",14),_t(),xt(13,18),Se(14,zp,2,0,"th",13)(15,jp,2,1,"td",14),_t(),xt(16,19),Se(17,$p,2,0,"th",13)(18,Hp,3,1,"td",14),_t(),xt(19,20),Se(20,Wp,2,0,"th",13)(21,Xp,3,1,"td",14),_t(),xt(22,21),Se(23,Yp,2,0,"th",13)(24,Qp,2,1,"td",14),_t(),Se(25,Zp,1,0,"tr",22)(26,Jp,1,0,"tr",23),q()),r&2){let t=re(2);pe("dataSource",t.searchResults),Z(25),pe("matHeaderRowDef",t.searchResultDisplayColumns),Z(),pe("matRowDefColumns",t.searchResultDisplayColumns)}}function tg(r,e){if(r&1){let t=Oe();G(0,"button",28),ue("click",function(){ge(t);let i=re(2);return me(i.deleteProject.emit(i.project))}),G(1,"mat-icon"),ae(2,"delete"),q()()}if(r&2){let t=re(2);fl("matTooltip","Delete Project ",t.project.name," from collate")}}function rg(r,e){if(r&1&&(G(0,"a",7)(1,"mat-icon"),ae(2,"link"),q()()),r&2){let t=re(2);fl("href","/#/project/",t.project.id,"",ic)}}function ng(r,e){if(r&1){let t=Oe();G(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"span",2),ae(4),q()(),G(5,"mat-card-subtitle"),ae(6),q()(),G(7,"mat-card-content"),Se(8,Tp,5,2,"div",3),G(9,"div",4),ue("cdkDropListDropped",function(i){ge(t);let a=re();return me(a.drop(i))}),Se(10,Pp,2,0)(11,Ap,2,0,"p"),q(),Se(12,eg,27,3,"table",5),q(),G(13,"mat-card-actions"),Se(14,tg,3,2,"button",6)(15,rg,3,2,"a",7),q()()}if(r&2){let t=re();Z(4),rt(t.project.name),Z(2),rt(t.project.description),Z(2),Re(t.searchResults.length>0?8:-1),Z(2),Re(t.searchResults.length>0?10:11),Z(2),Re(t.searchResults.length>0&&t.viewDifferentialAnalysis?12:-1),Z(2),Re(t.accounts.loggedIn?14:-1),Z(),Re(t.project?15:-1)}}var qc=(()=>{class r{set project(t){this._project=t}get project(){return this._project}set searchResults(t){this._searchResults=t,console.log(t)}get searchResults(){return this._searchResults}constructor(t){this.accounts=t,this._project=null,this.searchTerm="",this._searchResults=[],this.colorMap={},this.renameCondition={},this.deleteProject=new it,this.searchResultsChange=new it,this.searchResultDisplayColumns=["primary_id","uniprot_id","gene_name","condition_A","condition_B","log2_fc","log10_p","comparison_label"],this.expanded=!1,this.viewDifferentialAnalysis=!1}drop(t){let i=this._searchResults[t.previousIndex].analysis_group.id,a=this._searchResults.filter(o=>o.analysis_group.id===i);this._searchResults=this._searchResults.filter(o=>o.analysis_group.id!==i),this._searchResults.splice(t.currentIndex,0,...a),this.searchResultsChange.emit(this._searchResults)}static{this.\u0275fac=function(n){return new(n||r)(be(zr))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-card-viewer"]],inputs:{searchTerm:"searchTerm",project:"project",searchResults:"searchResults",colorMap:"colorMap",renameCondition:"renameCondition"},outputs:{deleteProject:"deleteProject",searchResultsChange:"searchResultsChange"},decls:1,vars:1,consts:[["appearance","outlined"],["cdkDragHandle",""],[2,"color","#ba0000"],[2,"display","flex","flex-direction","column","gap","20px"],["cdkDropList","",2,"display","flex","gap","20px","flex-wrap","wrap","justify-content","center",3,"cdkDropListDropped"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-icon-button","","color","primary",3,"matTooltip"],["target","_blank",3,"href"],[3,"change","color"],["cdkDrag",""],["mat-icon-button","","cdkDragHandle","",3,"matTooltip"],[3,"searchTerm","expanded","renameCondition","colorMap","data"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["matColumnDef","log10_p"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","comparison_label"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click","matTooltip"]],template:function(n,i){n&1&&Se(0,ng,16,7,"mat-card",0),n&2&&Re(i.project?0:-1)},dependencies:[Cc,yc,bc,si,li,Fo,Gc,wc,Xt,dn,vn,pn,So,bo,_o,Eo,Mo,To,Do,ko,wo,xo,Nc,uo],encapsulation:2})}}return r})();var ig=(r,e)=>e.id,ag=()=>[];function og(r,e){if(r&1){let t=Oe();G(0,"app-project-card-viewer",3),ue("deleteProject",function(i){ge(t);let a=re(2);return me(a.deleteProject.emit(i))}),q()}if(r&2){let t=re().$implicit,n=re();pe("searchTerm",n.searchTerm)("colorMap",n.projectConditionColorMap==null?null:n.projectConditionColorMap[t.id])("project",t)("searchResults",n.filteredResults[t.id]||Ja(5,ag))("renameCondition",n.renameCondition==null?null:n.renameCondition[t.id])}}function sg(r,e){if(r&1&&(G(0,"div",1),Se(1,og,1,6,"app-project-card-viewer",2),q()),r&2){let t=e.$implicit;Z(),Re(t&&t.id?1:-1)}}var jo=(()=>{class r{constructor(){this._searchTerm="",this.projects=[],this._filteredResults={},this.projectConditionColorMap={},this.renameCondition={},this.projectOrderChanged=new it,this.deleteProject=new it}set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set filteredResults(t){console.log(t),t?this._filteredResults=t:this._filteredResults={}}get filteredResults(){return this._filteredResults}drop(t){On(this.projects,t.previousIndex,t.currentIndex),this.projectOrderChanged.emit(this.projects)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-list"]],inputs:{searchTerm:"searchTerm",projects:"projects",filteredResults:"filteredResults",projectConditionColorMap:"projectConditionColorMap",renameCondition:"renameCondition"},outputs:{projectOrderChanged:"projectOrderChanged",deleteProject:"deleteProject"},decls:3,vars:0,consts:[["cdkDropList","",1,"project-list",3,"cdkDropListDropped"],[2,"margin","20px"],["cdkDrag","",3,"searchTerm","colorMap","project","searchResults","renameCondition"],["cdkDrag","",3,"deleteProject","searchTerm","colorMap","project","searchResults","renameCondition"]],template:function(n,i){n&1&&(G(0,"div",0),ue("cdkDropListDropped",function(o){return i.drop(o)}),We(1,sg,2,1,"div",1,ig),q()),n&2&&(Z(),Ue(i.projects))},dependencies:[pn,qc,vn],encapsulation:2})}}return r})();var Hc=(r,e)=>e.id;function lg(r,e){if(r&1){let t=Oe();G(0,"mat-chip",4),ue("removed",function(){let i=ge(t).$implicit,a=re(2);return me(a.removeTag(i))}),ae(1),G(2,"mat-icon",5),ae(3,"cancel"),q()()}if(r&2){let t=e.$implicit;Z(),Ge(" ",t.name," ")}}function ug(r,e){if(r&1){let t=Oe();G(0,"mat-chip-set",2),ue("cdkDropListDropped",function(i){ge(t);let a=re();return me(a.drop(i))}),We(1,lg,4,1,"mat-chip",3,Hc),q()}if(r&2){let t=re();Z(),Ue(t.collageTags)}}function cg(r,e){if(r&1&&(G(0,"mat-chip"),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t.name," ")}}function dg(r,e){if(r&1&&(G(0,"mat-chip-set"),We(1,cg,2,1,"mat-chip",null,Hc),q()),r&2){let t=re();Z(),Ue(t.collageTags)}}var $o=(()=>{class r{constructor(t){this.accounts=t,this.collageTags=[],this.collageTagsChange=new it}removeTag(t){this.collageTags=this.collageTags.filter(n=>n!==t),this.collageTagsChange.emit(this.collageTags)}drop(t){On(this.collageTags,t.previousIndex,t.currentIndex),this.collageTagsChange.emit(this.collageTags)}static{this.\u0275fac=function(n){return new(n||r)(be(zr))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-tags"]],inputs:{collageTags:"collageTags"},outputs:{collageTagsChange:"collageTagsChange"},decls:4,vars:1,consts:[[2,"display","flex","justify-content","center"],["cdkDropList",""],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["cdkDrag","",3,"removed"],["matChipRemove",""]],template:function(n,i){n&1&&(G(0,"div",0),Se(1,ug,3,0,"mat-chip-set",1)(2,dg,3,0,"mat-chip-set"),q(),De(3,"div",0)),n&2&&(Z(),Re(i.accounts.loggedIn?1:2))},dependencies:[pn,vo,fo,Xt,ho,vn],encapsulation:2})}}return r})();var Uc=qa(Wc());function fg(r,e){r&1&&(G(0,"div",2),De(1,"div",5),q())}var Kc=(()=>{class r{set url(t){this.config.data=t,this._url=t}constructor(t){this.dialogRef=t,this._url="",this.config={width:250,height:250,data:this.url,margin:5,dotsOptions:{color:"#780101",type:"dots"},backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0}}}ngAfterViewInit(){let t=new Uc.default(this.config),n=document.getElementById("canvas");n&&t.append(n),this.qrCode=t}close(){this.dialogRef.close()}download(){this.qrCode&&this.qrCode.download({name:"qrcode",extension:"svg"}).then(()=>{})}static{this.\u0275fac=function(n){return new(n||r)(be(Bt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-qr-code-dialog"]],inputs:{url:"url"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","justify-content","center","align-items","center"],["mat-dialog-actions",""],["mat-button","",3,"click"],["id","canvas"]],template:function(n,i){n&1&&(G(0,"h1",0),ae(1,"Collate QR Code"),q(),G(2,"div",1),Se(3,fg,2,0,"div",2),q(),G(4,"div",3)(5,"button",4),ue("click",function(){return i.close()}),ae(6,"Close"),q(),G(7,"button",4),ue("click",function(){return i.download()}),ae(8,"Download"),q()()),n&2&&(Z(3),Re(i.config.data&&i.config.data!==""?3:-1))},dependencies:[Rt,It,Ot,ct],encapsulation:2})}}return r})();var Xc=(r,e)=>e.id,hg=()=>({standalone:!0});function vg(r,e){if(r&1){let t=Oe();G(0,"mat-checkbox",6),Kt("ngModelChange",function(i){let a=ge(t).$implicit,o=re(2).$implicit,s=re();return Ut(s.projectAnalysisGroupVisibilityMap[o.id][a.id],i)||(s.projectAnalysisGroupVisibilityMap[o.id][a.id]=i),me(i)}),ae(1),q()}if(r&2){let t=e.$implicit,n=re(2).$implicit,i=re();Wt("ngModel",i.projectAnalysisGroupVisibilityMap[n.id][t.id]),pe("ngModelOptions",Ja(3,hg)),Z(),Ge(" ",t.name," ")}}function pg(r,e){if(r&1&&We(0,vg,2,4,"mat-checkbox",5,Xc),r&2){let t=re().$implicit,n=re();Ue(n.projectAnalysisGroupMap[t.id])}}function gg(r,e){if(r&1&&(G(0,"h2"),ae(1),q(),Se(2,pg,2,0)),r&2){let t=e.$implicit,n=re();Z(),rt(t.name),Z(),Re(n.projectAnalysisGroupMap[t.id]?2:-1)}}var Go=(()=>{class r{set projects(t){this._projects=t}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}set projectAnalysisGroupVisibilityMap(t){this._projectAnalysisGroupVisibilityMap={};for(let n in t){this._projectAnalysisGroupVisibilityMap[n]={};for(let i in t[n])this._projectAnalysisGroupVisibilityMap[n][i]=t[n][i]}}get projectAnalysisGroupVisibilityMap(){return this._projectAnalysisGroupVisibilityMap}constructor(t){this.dialog=t,this._projects=[],this._projectAnalysisGroupMap={},this._projectAnalysisGroupVisibilityMap={}}close(){this.dialog.close()}save(){this.dialog.close(this.projectAnalysisGroupVisibilityMap)}static{this.\u0275fac=function(n){return new(n||r)(be(Bt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-analysis-group-visibility-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap",projectAnalysisGroupVisibilityMap:"projectAnalysisGroupVisibilityMap"},decls:11,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"]],template:function(n,i){n&1&&(G(0,"h1",0),ae(1,"Analysis Group Visibility"),q(),G(2,"div",1)(3,"form",2),We(4,gg,3,2,null,null,Xc),q()(),G(6,"div",3)(7,"button",4),ue("click",function(){return i.close()}),ae(8,"Cancel"),q(),G(9,"button",4),ue("click",function(){return i.save()}),ae(10,"Submit"),q()()),n&2&&(Z(4),Ue(i.projects))},dependencies:[Rt,It,hn,fr,Et,dr,fn,Ec,ci,Ot,ct],encapsulation:2})}}return r})();function mt(r){"@babel/helpers - typeof";return mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(r)}function Mn(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Yc(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Dn(r,e,t){return e&&Yc(r.prototype,e),t&&Yc(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function gf(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ft(r,e){return yg(r)||wg(r,e)||eu(r,e)||xg()}function mf(r){return mg(r)||Cg(r)||eu(r)||bg()}function mg(r){if(Array.isArray(r))return Ll(r)}function yg(r){if(Array.isArray(r))return r}function Cg(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wg(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],i=!0,a=!1,o,s;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(l){a=!0,s=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(a)throw s}}return n}}function eu(r,e){if(r){if(typeof r=="string")return Ll(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ll(r,e)}}function Ll(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function bg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lr(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=eu(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=t.call(r)},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}var pt=typeof window>"u"?null:window,Qc=pt?pt.navigator:null;pt&&pt.document;var _g=mt(""),yf=mt({}),Eg=mt(function(){}),Sg=typeof HTMLElement>"u"?"undefined":mt(HTMLElement),ba=function(e){return e&&e.instanceString&&lt(e.instanceString)?e.instanceString():null},Be=function(e){return e!=null&&mt(e)==_g},lt=function(e){return e!=null&&mt(e)===Eg},Ze=function(e){return!ur(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},He=function(e){return e!=null&&mt(e)===yf&&!Ze(e)&&e.constructor===Object},Tg=function(e){return e!=null&&mt(e)===yf},Ce=function(e){return e!=null&&mt(e)===mt(1)&&!isNaN(e)},kg=function(e){return Ce(e)&&Math.floor(e)===e},hs=function(e){if(Sg!=="undefined")return e!=null&&e instanceof HTMLElement},ur=function(e){return xa(e)||Cf(e)},xa=function(e){return ba(e)==="collection"&&e._private.single},Cf=function(e){return ba(e)==="collection"&&!e._private.single},tu=function(e){return ba(e)==="core"},wf=function(e){return ba(e)==="stylesheet"},Mg=function(e){return ba(e)==="event"},xn=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},Dg=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},Pg=function(e){return He(e)&&Ce(e.x1)&&Ce(e.x2)&&Ce(e.y1)&&Ce(e.y2)},Ag=function(e){return Tg(e)&&lt(e.then)},Bg=function(){return Qc&&Qc.userAgent.match(/msie|trident|edge/i)},ca=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],o=0;o<arguments.length;o++)a.push(arguments[o]);return a.join("$")});var n=function i(){var a=this,o=arguments,s,l=t.apply(a,o),u=i.cache;return(s=u[l])||(s=u[l]=e.apply(a,o)),s};return n.cache={},n},ru=ca(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Ss=ca(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),bf=ca(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),Zc=function(e){return xn(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},gt="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",Rg="rgb[a]?\\(("+gt+"[%]?)\\s*,\\s*("+gt+"[%]?)\\s*,\\s*("+gt+"[%]?)(?:\\s*,\\s*("+gt+"))?\\)",Ig="rgb[a]?\\((?:"+gt+"[%]?)\\s*,\\s*(?:"+gt+"[%]?)\\s*,\\s*(?:"+gt+"[%]?)(?:\\s*,\\s*(?:"+gt+"))?\\)",Og="hsl[a]?\\(("+gt+")\\s*,\\s*("+gt+"[%])\\s*,\\s*("+gt+"[%])(?:\\s*,\\s*("+gt+"))?\\)",Fg="hsl[a]?\\((?:"+gt+")\\s*,\\s*(?:"+gt+"[%])\\s*,\\s*(?:"+gt+"[%])(?:\\s*,\\s*(?:"+gt+"))?\\)",Lg="\\#[0-9a-fA-F]{3}",Vg="\\#[0-9a-fA-F]{6}",xf=function(e,t){return e<t?-1:e>t?1:0},Ng=function(e,t){return-1*xf(e,t)},Fe=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var n=e[t];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var o=i[a];r[o]=n[o]}}return r},zg=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,n,i,a,o=16;return t?(n=parseInt(e[1]+e[1],o),i=parseInt(e[2]+e[2],o),a=parseInt(e[3]+e[3],o)):(n=parseInt(e[1]+e[2],o),i=parseInt(e[3]+e[4],o),a=parseInt(e[5]+e[6],o)),[n,i,a]}},jg=function(e){var t,n,i,a,o,s,l,u;function c(v,m,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?v+(m-v)*6*p:p<1/2?m:p<2/3?v+(m-v)*(2/3-p)*6:v}var d=new RegExp("^"+Og+"$").exec(e);if(d){if(n=parseInt(d[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(d[2]),i<0||i>100||(i=i/100,a=parseFloat(d[3]),a<0||a>100)||(a=a/100,o=d[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(i===0)s=l=u=Math.round(a*255);else{var f=a<.5?a*(1+i):a+i-a*i,h=2*a-f;s=Math.round(255*c(h,f,n+1/3)),l=Math.round(255*c(h,f,n)),u=Math.round(255*c(h,f,n-1/3))}t=[s,l,u,o]}return t},$g=function(e){var t,n=new RegExp("^"+Rg+"$").exec(e);if(n){t=[];for(var i=[],a=1;a<=3;a++){var o=n[a];if(o[o.length-1]==="%"&&(i[a]=!0),o=parseFloat(o),i[a]&&(o=o/100*255),o<0||o>255)return;t.push(Math.floor(o))}var s=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(s&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;t.push(u)}}return t},Gg=function(e){return qg[e.toLowerCase()]},_f=function(e){return(Ze(e)?e:null)||Gg(e)||zg(e)||$g(e)||jg(e)},qg={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ef=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(He(o))throw Error("Tried to set map with object key");a<n.length-1?(t[o]==null&&(t[o]={}),t=t[o]):t[o]=e.value}},Sf=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var o=n[a];if(He(o))throw Error("Tried to get map with object key");if(t=t[o],t==null)return t}return t};function Hg(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Gn=Hg,ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wg(r,e){return e={exports:{}},r(e,e.exports),e.exports}var Ug=typeof ta=="object"&&ta&&ta.Object===Object&&ta,Kg=Ug,Xg=typeof self=="object"&&self&&self.Object===Object&&self,Yg=Kg||Xg||Function("return this")(),Ts=Yg,Qg=function(){return Ts.Date.now()},bl=Qg,Zg=/\s/;function Jg(r){for(var e=r.length;e--&&Zg.test(r.charAt(e)););return e}var em=Jg,tm=/^\s+/;function rm(r){return r&&r.slice(0,em(r)+1).replace(tm,"")}var nm=rm,im=Ts.Symbol,Ei=im,Tf=Object.prototype,am=Tf.hasOwnProperty,om=Tf.toString,Ki=Ei?Ei.toStringTag:void 0;function sm(r){var e=am.call(r,Ki),t=r[Ki];try{r[Ki]=void 0;var n=!0}catch{}var i=om.call(r);return n&&(e?r[Ki]=t:delete r[Ki]),i}var lm=sm,um=Object.prototype,cm=um.toString;function dm(r){return cm.call(r)}var fm=dm,hm="[object Null]",vm="[object Undefined]",Jc=Ei?Ei.toStringTag:void 0;function pm(r){return r==null?r===void 0?vm:hm:Jc&&Jc in Object(r)?lm(r):fm(r)}var kf=pm;function gm(r){return r!=null&&typeof r=="object"}var mm=gm,ym="[object Symbol]";function Cm(r){return typeof r=="symbol"||mm(r)&&kf(r)==ym}var _a=Cm,ed=NaN,wm=/^[-+]0x[0-9a-f]+$/i,bm=/^0b[01]+$/i,xm=/^0o[0-7]+$/i,_m=parseInt;function Em(r){if(typeof r=="number")return r;if(_a(r))return ed;if(Gn(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Gn(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=nm(r);var t=bm.test(r);return t||xm.test(r)?_m(r.slice(2),t?2:8):wm.test(r)?ed:+r}var td=Em,Sm="Expected a function",Tm=Math.max,km=Math.min;function Mm(r,e,t){var n,i,a,o,s,l,u=0,c=!1,d=!1,f=!0;if(typeof r!="function")throw new TypeError(Sm);e=td(e)||0,Gn(t)&&(c=!!t.leading,d="maxWait"in t,a=d?Tm(td(t.maxWait)||0,e):a,f="trailing"in t?!!t.trailing:f);function h(P){var D=n,R=i;return n=i=void 0,u=P,o=r.apply(R,D),o}function v(P){return u=P,s=setTimeout(g,e),c?h(P):o}function m(P){var D=P-l,R=P-u,A=e-D;return d?km(A,a-R):A}function p(P){var D=P-l,R=P-u;return l===void 0||D>=e||D<0||d&&R>=a}function g(){var P=bl();if(p(P))return y(P);s=setTimeout(g,m(P))}function y(P){return s=void 0,f&&n?h(P):(n=i=void 0,o)}function C(){s!==void 0&&clearTimeout(s),u=0,n=l=i=s=void 0}function x(){return s===void 0?o:y(bl())}function M(){var P=bl(),D=p(P);if(n=arguments,i=this,l=P,D){if(s===void 0)return v(l);if(d)return clearTimeout(s),s=setTimeout(g,e),h(l)}return s===void 0&&(s=setTimeout(g,e)),o}return M.cancel=C,M.flush=x,M}var Ea=Mm,xl=pt?pt.performance:null,Mf=xl&&xl.now?function(){return xl.now()}:function(){return Date.now()},Dm=function(){if(pt){if(pt.requestAnimationFrame)return function(r){pt.requestAnimationFrame(r)};if(pt.mozRequestAnimationFrame)return function(r){pt.mozRequestAnimationFrame(r)};if(pt.webkitRequestAnimationFrame)return function(r){pt.webkitRequestAnimationFrame(r)};if(pt.msRequestAnimationFrame)return function(r){pt.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(Mf())},1e3/60)}}(),vs=function(e){return Dm(e)},nn=Mf,mi=9261,Df=65599,ra=5381,Pf=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mi,n=t,i;i=e.next(),!i.done;)n=n*Df+i.value|0;return n},da=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mi;return t*Df+e|0},fa=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ra;return(t<<5)+t+e|0},Pm=function(e,t){return e*2097152+t},gn=function(e){return e[0]*2097152+e[1]},qo=function(e,t){return[da(e[0],t[0]),fa(e[1],t[1])]},Am=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return Pf(o,t)},_n=function(e,t){var n={value:0,done:!1},i=0,a=e.length,o={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return Pf(o,t)},Af=function(){return Bm(arguments)},Bm=function(e){for(var t,n=0;n<e.length;n++){var i=e[n];n===0?t=_n(i):t=_n(i,t)}return t},rd=!0,Rm=console.warn!=null,Im=console.trace!=null,nu=Number.MAX_SAFE_INTEGER||9007199254740991,Bf=function(){return!0},ps=function(){return!1},nd=function(){return 0},iu=function(){},st=function(e){throw new Error(e)},Rf=function(e){if(e!==void 0)rd=!!e;else return rd},Ye=function(e){Rf()&&(Rm?console.warn(e):(console.log(e),Im&&console.trace()))},Om=function(e){return Fe({},e)},qr=function(e){return e==null?e:Ze(e)?e.slice():He(e)?Om(e):e},Fm=function(e){return e.slice()},If=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},Lm={},Of=function(){return Lm},Tt=function(e){var t=Object.keys(e);return function(n){for(var i={},a=0;a<t.length;a++){var o=t[a],s=n?.[o];i[o]=s===void 0?e[o]:s}return i}},En=function(e,t,n){for(var i=e.length-1;i>=0&&!(e[i]===t&&(e.splice(i,1),n));i--);},au=function(e){e.splice(0,e.length)},Vm=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.push(i)}},Tr=function(e,t,n){return n&&(t=bf(n,t)),e[t]},yn=function(e,t,n,i){n&&(t=bf(n,t)),e[t]=i},Nm=function(){function r(){Mn(this,r),this._obj={}}return Dn(r,[{key:"set",value:function(t,n){return this._obj[t]=n,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}]),r}(),Hr=typeof Map<"u"?Map:Nm,zm="undefined",jm=function(){function r(e){if(Mn(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var n=0;n<t.length;n++)this.add(t[n])}}return Dn(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var n=this._obj;n[t]!==1&&(n[t]=1,this.size++)}},{key:"delete",value:function(t){var n=this._obj;n[t]===1&&(n[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(n){return t.has(n)})}},{key:"forEach",value:function(t,n){return this.toArray().forEach(t,n)}}]),r}(),Mi=(typeof Set>"u"?"undefined":mt(Set))!==zm?Set:jm,ks=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!tu(e)){st("An element must have a core reference and parameters set");return}var i=t.group;if(i==null&&(t.data&&t.data.source!=null&&t.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){st("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?i==="edges":!!t.pannable,active:!1,classes:new Mi,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var o=t.renderedPosition,s=e.pan(),l=e.zoom();a.position={x:(o.x-s.x)/l,y:(o.y-s.y)/l}}var u=[];Ze(t.classes)?u=t.classes:Be(t.classes)&&(u=t.classes.split(/\s+/));for(var c=0,d=u.length;c<d;c++){var f=u[c];!f||f===""||a.classes.add(f)}this.createEmitter();var h=t.style||t.css;h&&(Ye("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(h)),(n===void 0||n)&&this.restore()},id=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var o;He(n)&&!ur(n)&&(o=n,n=o.roots||o.root,i=o.visit,a=o.directed),a=arguments.length===2&&!lt(i)?i:a,i=lt(i)?i:function(){};for(var s=this._private.cy,l=n=Be(n)?this.filter(n):n,u=[],c=[],d={},f={},h={},v=0,m,p=this.byGroup(),g=p.nodes,y=p.edges,C=0;C<l.length;C++){var x=l[C],M=x.id();x.isNode()&&(u.unshift(x),e.bfs&&(h[M]=!0,c.push(x)),f[M]=0)}for(var P=function(){var B=e.bfs?u.shift():u.pop(),E=B.id();if(e.dfs){if(h[E])return"continue";h[E]=!0,c.push(B)}var w=f[E],b=d[E],_=b!=null?b.source():null,k=b!=null?b.target():null,S=b==null?void 0:B.same(_)?k[0]:_[0],N=void 0;if(N=i(B,b,S,v++,w),N===!0)return m=B,"break";if(N===!1)return"break";for(var V=B.connectedEdges().filter(function(J){return(!a||J.source().same(B))&&y.has(J)}),z=0;z<V.length;z++){var H=V[z],Y=H.connectedNodes().filter(function(J){return!J.same(B)&&g.has(J)}),ee=Y.id();Y.length!==0&&!h[ee]&&(Y=Y[0],u.push(Y),e.bfs&&(h[ee]=!0,c.push(Y)),d[ee]=H,f[ee]=f[E]+1)}};u.length!==0;){var D=P();if(D!=="continue"&&D==="break")break}for(var R=s.collection(),A=0;A<c.length;A++){var F=c[A],O=d[F.id()];O!=null&&R.push(O),R.push(F)}return{path:s.collection(R),found:s.collection(m)}}},ha={breadthFirstSearch:id({bfs:!0}),depthFirstSearch:id({dfs:!0})};ha.bfs=ha.breadthFirstSearch;ha.dfs=ha.depthFirstSearch;var $m=Wg(function(r,e){(function(){var t,n,i,a,o,s,l,u,c,d,f,h,v,m,p;i=Math.floor,d=Math.min,n=function(g,y){return g<y?-1:g>y?1:0},c=function(g,y,C,x,M){var P;if(C==null&&(C=0),M==null&&(M=n),C<0)throw new Error("lo must be non-negative");for(x==null&&(x=g.length);C<x;)P=i((C+x)/2),M(y,g[P])<0?x=P:C=P+1;return[].splice.apply(g,[C,C-C].concat(y)),y},s=function(g,y,C){return C==null&&(C=n),g.push(y),m(g,0,g.length-1,C)},o=function(g,y){var C,x;return y==null&&(y=n),C=g.pop(),g.length?(x=g[0],g[0]=C,p(g,0,y)):x=C,x},u=function(g,y,C){var x;return C==null&&(C=n),x=g[0],g[0]=y,p(g,0,C),x},l=function(g,y,C){var x;return C==null&&(C=n),g.length&&C(g[0],y)<0&&(x=[g[0],y],y=x[0],g[0]=x[1],p(g,0,C)),y},a=function(g,y){var C,x,M,P,D,R;for(y==null&&(y=n),P=function(){R=[];for(var A=0,F=i(g.length/2);0<=F?A<F:A>F;0<=F?A++:A--)R.push(A);return R}.apply(this).reverse(),D=[],x=0,M=P.length;x<M;x++)C=P[x],D.push(p(g,C,y));return D},v=function(g,y,C){var x;if(C==null&&(C=n),x=g.indexOf(y),x!==-1)return m(g,0,x,C),p(g,x,C)},f=function(g,y,C){var x,M,P,D,R;if(C==null&&(C=n),M=g.slice(0,y),!M.length)return M;for(a(M,C),R=g.slice(y),P=0,D=R.length;P<D;P++)x=R[P],l(M,x,C);return M.sort(C).reverse()},h=function(g,y,C){var x,M,P,D,R,A,F,O,T;if(C==null&&(C=n),y*10<=g.length){if(P=g.slice(0,y).sort(C),!P.length)return P;for(M=P[P.length-1],F=g.slice(y),D=0,A=F.length;D<A;D++)x=F[D],C(x,M)<0&&(c(P,x,0,null,C),P.pop(),M=P[P.length-1]);return P}for(a(g,C),T=[],R=0,O=d(y,g.length);0<=O?R<O:R>O;0<=O?++R:--R)T.push(o(g,C));return T},m=function(g,y,C,x){var M,P,D;for(x==null&&(x=n),M=g[C];C>y;){if(D=C-1>>1,P=g[D],x(M,P)<0){g[C]=P,C=D;continue}break}return g[C]=M},p=function(g,y,C){var x,M,P,D,R;for(C==null&&(C=n),M=g.length,R=y,P=g[y],x=2*y+1;x<M;)D=x+1,D<M&&!(C(g[x],g[D])<0)&&(x=D),g[y]=g[x],y=x,x=2*y+1;return g[y]=P,m(g,R,y,C)},t=function(){g.push=s,g.pop=o,g.replace=u,g.pushpop=l,g.heapify=a,g.updateItem=v,g.nlargest=f,g.nsmallest=h;function g(y){this.cmp=y??n,this.nodes=[]}return g.prototype.push=function(y){return s(this.nodes,y,this.cmp)},g.prototype.pop=function(){return o(this.nodes,this.cmp)},g.prototype.peek=function(){return this.nodes[0]},g.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},g.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},g.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},g.prototype.heapify=function(){return a(this.nodes,this.cmp)},g.prototype.updateItem=function(y){return v(this.nodes,y,this.cmp)},g.prototype.clear=function(){return this.nodes=[]},g.prototype.empty=function(){return this.nodes.length===0},g.prototype.size=function(){return this.nodes.length},g.prototype.clone=function(){var y;return y=new g,y.nodes=this.nodes.slice(0),y},g.prototype.toArray=function(){return this.nodes.slice(0)},g.prototype.insert=g.prototype.push,g.prototype.top=g.prototype.peek,g.prototype.front=g.prototype.peek,g.prototype.has=g.prototype.contains,g.prototype.copy=g.prototype.clone,g}(),function(g,y){return r.exports=y()}(this,function(){return t})}).call(ta)}),Sa=$m,Gm=Tt({root:null,weight:function(e){return 1},directed:!1}),qm={dijkstra:function(e){if(!He(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=Gm(e),i=n.root,a=n.weight,o=n.directed,s=this,l=a,u=Be(i)?this.filter(i)[0]:i[0],c={},d={},f={},h=this.byGroup(),v=h.nodes,m=h.edges;m.unmergeBy(function(w){return w.isLoop()});for(var p=function(b){return c[b.id()]},g=function(b,_){c[b.id()]=_,y.updateItem(b)},y=new Sa(function(w,b){return p(w)-p(b)}),C=0;C<v.length;C++){var x=v[C];c[x.id()]=x.same(u)?0:1/0,y.push(x)}for(var M=function(b,_){for(var k=(o?b.edgesTo(_):b.edgesWith(_)).intersect(m),S=1/0,N,V=0;V<k.length;V++){var z=k[V],H=l(z);(H<S||!N)&&(S=H,N=z)}return{edge:N,dist:S}};y.size()>0;){var P=y.pop(),D=p(P),R=P.id();if(f[R]=D,D!==1/0)for(var A=P.neighborhood().intersect(v),F=0;F<A.length;F++){var O=A[F],T=O.id(),B=M(P,O),E=D+B.dist;E<p(O)&&(g(O,E),d[T]={node:P,edge:B.edge})}}return{distanceTo:function(b){var _=Be(b)?v.filter(b)[0]:b[0];return f[_.id()]},pathTo:function(b){var _=Be(b)?v.filter(b)[0]:b[0],k=[],S=_,N=S.id();if(_.length>0)for(k.unshift(_);d[N];){var V=d[N];k.unshift(V.edge),k.unshift(V.node),S=V.node,N=S.id()}return s.spawn(k)}}}},Hm={kruskal:function(e){e=e||function(C){return 1};for(var t=this.byGroup(),n=t.nodes,i=t.edges,a=n.length,o=new Array(a),s=n,l=function(x){for(var M=0;M<o.length;M++){var P=o[M];if(P.has(x))return M}},u=0;u<a;u++)o[u]=this.spawn(n[u]);for(var c=i.sort(function(C,x){return e(C)-e(x)}),d=0;d<c.length;d++){var f=c[d],h=f.source()[0],v=f.target()[0],m=l(h),p=l(v),g=o[m],y=o[p];m!==p&&(s.merge(f),g.merge(y),o.splice(p,1))}return s}},Wm=Tt({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),Um={aStar:function(e){var t=this.cy(),n=Wm(e),i=n.root,a=n.goal,o=n.heuristic,s=n.directed,l=n.weight;i=t.collection(i)[0],a=t.collection(a)[0];var u=i.id(),c=a.id(),d={},f={},h={},v=new Sa(function(N,V){return f[N.id()]-f[V.id()]}),m=new Mi,p={},g={},y=function(V,z){v.push(V),m.add(z)},C,x,M=function(){C=v.pop(),x=C.id(),m.delete(x)},P=function(V){return m.has(V)};y(i,u),d[u]=0,f[u]=o(i);for(var D=0;v.size()>0;){if(M(),D++,x===c){for(var R=[],A=a,F=c,O=g[F];R.unshift(A),O!=null&&R.unshift(O),A=p[F],A!=null;)F=A.id(),O=g[F];return{found:!0,distance:d[x],path:this.spawn(R),steps:D}}h[x]=!0;for(var T=C._private.edges,B=0;B<T.length;B++){var E=T[B];if(this.hasElementWithId(E.id())&&!(s&&E.data("source")!==x)){var w=E.source(),b=E.target(),_=w.id()!==x?w:b,k=_.id();if(this.hasElementWithId(k)&&!h[k]){var S=d[x]+l(E);if(!P(k)){d[k]=S,f[k]=S+o(_),y(_,k),p[k]=C,g[k]=E;continue}S<d[k]&&(d[k]=S,f[k]=S+o(_),p[k]=C,g[k]=E)}}}}return{found:!1,distance:void 0,path:void 0,steps:D}}},Km=Tt({weight:function(e){return 1},directed:!1}),Xm={floydWarshall:function(e){for(var t=this.cy(),n=Km(e),i=n.weight,a=n.directed,o=i,s=this.byGroup(),l=s.nodes,u=s.edges,c=l.length,d=c*c,f=function(H){return l.indexOf(H)},h=function(H){return l[H]},v=new Array(d),m=0;m<d;m++){var p=m%c,g=(m-p)/c;g===p?v[m]=0:v[m]=1/0}for(var y=new Array(d),C=new Array(d),x=0;x<u.length;x++){var M=u[x],P=M.source()[0],D=M.target()[0];if(P!==D){var R=f(P),A=f(D),F=R*c+A,O=o(M);if(v[F]>O&&(v[F]=O,y[F]=A,C[F]=M),!a){var T=A*c+R;!a&&v[T]>O&&(v[T]=O,y[T]=R,C[T]=M)}}}for(var B=0;B<c;B++)for(var E=0;E<c;E++)for(var w=E*c+B,b=0;b<c;b++){var _=E*c+b,k=B*c+b;v[w]+v[k]<v[_]&&(v[_]=v[w]+v[k],y[_]=y[w])}var S=function(H){return(Be(H)?t.filter(H):H)[0]},N=function(H){return f(S(H))},V={distance:function(H,Y){var ee=N(H),J=N(Y);return v[ee*c+J]},path:function(H,Y){var ee=N(H),J=N(Y),ne=h(ee);if(ee===J)return ne.collection();if(y[ee*c+J]==null)return t.collection();var ie=t.collection(),K=ee,L;for(ie.merge(ne);ee!==J;)K=ee,ee=y[ee*c+J],L=C[K*c+ee],ie.merge(L),ie.merge(h(ee));return ie}};return V}},Ym=Tt({weight:function(e){return 1},directed:!1,root:null}),Qm={bellmanFord:function(e){var t=this,n=Ym(e),i=n.weight,a=n.directed,o=n.root,s=i,l=this,u=this.cy(),c=this.byGroup(),d=c.edges,f=c.nodes,h=f.length,v=new Hr,m=!1,p=[];o=u.collection(o)[0],d.unmergeBy(function(_e){return _e.isLoop()});for(var g=d.length,y=function(fe){var ce=v.get(fe.id());return ce||(ce={},v.set(fe.id(),ce)),ce},C=function(fe){return(Be(fe)?u.$(fe):fe)[0]},x=function(fe){return y(C(fe)).dist},M=function(fe){for(var ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,we=C(fe),Me=[],ke=we;;){if(ke==null)return t.spawn();var xe=y(ke),Ee=xe.edge,ye=xe.pred;if(Me.unshift(ke[0]),ke.same(ce)&&Me.length>0)break;Ee!=null&&Me.unshift(Ee),ke=ye}return l.spawn(Me)},P=0;P<h;P++){var D=f[P],R=y(D);D.same(o)?R.dist=0:R.dist=1/0,R.pred=null,R.edge=null}for(var A=!1,F=function(fe,ce,we,Me,ke,xe){var Ee=Me.dist+xe;Ee<ke.dist&&!we.same(Me.edge)&&(ke.dist=Ee,ke.pred=fe,ke.edge=we,A=!0)},O=1;O<h;O++){A=!1;for(var T=0;T<g;T++){var B=d[T],E=B.source(),w=B.target(),b=s(B),_=y(E),k=y(w);F(E,w,B,_,k,b),a||F(w,E,B,k,_,b)}if(!A)break}if(A)for(var S=[],N=0;N<g;N++){var V=d[N],z=V.source(),H=V.target(),Y=s(V),ee=y(z).dist,J=y(H).dist;if(ee+Y<J||!a&&J+Y<ee)if(m||(Ye("Graph contains a negative weight cycle for Bellman-Ford"),m=!0),e.findNegativeWeightCycles!==!1){var ne=[];ee+Y<J&&ne.push(z),!a&&J+Y<ee&&ne.push(H);for(var ie=ne.length,K=0;K<ie;K++){var L=ne[K],j=[L];j.push(y(L).edge);for(var $=y(L).pred;j.indexOf($)===-1;)j.push($),j.push(y($).edge),$=y($).pred;j=j.slice(j.indexOf($));for(var U=j[0].id(),X=0,de=2;de<j.length;de+=2)j[de].id()<U&&(U=j[de].id(),X=de);j=j.slice(X).concat(j.slice(0,X)),j.push(j[0]);var Te=j.map(function(_e){return _e.id()}).join(",");S.indexOf(Te)===-1&&(p.push(l.spawn(j)),S.push(Te))}}else break}return{distanceTo:x,pathTo:M,hasNegativeWeightCycle:m,negativeWeightCycles:p}}},Zm=Math.sqrt(2),Jm=function(e,t,n){n.length===0&&st("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],o=i[2],s=t[a],l=t[o],u=n,c=u.length-1;c>=0;c--){var d=u[c],f=d[1],h=d[2];(t[f]===s&&t[h]===l||t[f]===l&&t[h]===s)&&u.splice(c,1)}for(var v=0;v<u.length;v++){var m=u[v];m[1]===l?(u[v]=m.slice(),u[v][1]=s):m[2]===l&&(u[v]=m.slice(),u[v][2]=s)}for(var p=0;p<t.length;p++)t[p]===l&&(t[p]=s);return u},_l=function(e,t,n,i){for(;n>i;){var a=Math.floor(Math.random()*t.length);t=Jm(a,e,t),n--}return t},e0={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,i=t.edges;i.unmergeBy(function(k){return k.isLoop()});var a=n.length,o=i.length,s=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/Zm);if(a<2){st("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<o;c++){var d=i[c];u.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var f=1/0,h=[],v=new Array(a),m=new Array(a),p=new Array(a),g=function(S,N){for(var V=0;V<a;V++)N[V]=S[V]},y=0;y<=s;y++){for(var C=0;C<a;C++)m[C]=C;var x=_l(m,u.slice(),a,l),M=x.slice();g(m,p);var P=_l(m,x,l,2),D=_l(p,M,l,2);P.length<=D.length&&P.length<f?(f=P.length,h=P,g(m,v)):D.length<=P.length&&D.length<f&&(f=D.length,h=D,g(p,v))}for(var R=this.spawn(h.map(function(k){return i[k[0]]})),A=this.spawn(),F=this.spawn(),O=v[0],T=0;T<v.length;T++){var B=v[T],E=n[T];B===O?A.merge(E):F.merge(E)}var w=function(S){var N=e.spawn();return S.forEach(function(V){N.merge(V),V.connectedEdges().forEach(function(z){e.contains(z)&&!R.contains(z)&&N.merge(z)})}),N},b=[w(A),w(F)],_={cut:R,components:b,partition1:A,partition2:F};return _}},t0=function(e){return{x:e.x,y:e.y}},Ms=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},Ff=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},yi=function(e){return{x:e[0],y:e[1]}},r0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.min(o,i))}return i},n0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=t;a<n;a++){var o=e[a];isFinite(o)&&(i=Math.max(o,i))}return i},i0=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,o=t;o<n;o++){var s=e[o];isFinite(s)&&(i+=s,a++)}return i/a},a0=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(t,n):(n<e.length&&e.splice(n,e.length-n),t>0&&e.splice(0,t));for(var s=0,l=e.length-1;l>=0;l--){var u=e[l];o?isFinite(u)||(e[l]=-1/0,s++):e.splice(l,1)}a&&e.sort(function(f,h){return f-h});var c=e.length,d=Math.floor(c/2);return c%2!==0?e[d+1+s]:(e[d-1+s]+e[d+s])/2},o0=function(e){return Math.PI*e/180},Ho=function(e,t){return Math.atan2(t,e)-Math.PI/2},ou=Math.log2||function(r){return Math.log(r)/Math.log(2)},Lf=function(e){return e>0?1:e<0?-1:0},qn=function(e,t){return Math.sqrt(Vn(e,t))},Vn=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},s0=function(e){for(var t=e.length,n=0,i=0;i<t;i++)n+=e[i];for(var a=0;a<t;a++)e[a]=e[a]/n;return e},St=function(e,t,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*n},wi=function(e,t,n,i){return{x:St(e.x,t.x,n.x,i),y:St(e.y,t.y,n.y,i)}},l0=function(e,t,n,i){var a={x:t.x-e.x,y:t.y-e.y},o=qn(e,t),s={x:a.x/o,y:a.y/o};return n=n??0,i=i??n*o,{x:e.x+s.x*i,y:e.y+s.y*i}},va=function(e,t,n){return Math.max(e,Math.min(n,t))},rr=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},u0=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},c0=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},d0=function(e,t,n){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},Vf=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},f0=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},is=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},as=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,o;if(t.length===1)n=i=a=o=t[0];else if(t.length===2)n=a=t[0],o=i=t[1];else if(t.length===4){var s=ft(t,4);n=s[0],i=s[1],a=s[2],o=s[3]}return e.x1-=o,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},ad=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},su=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},Si=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},h0=function(e,t){return Si(e,t.x,t.y)},Nf=function(e,t){return Si(e,t.x1,t.y1)&&Si(e,t.x2,t.y2)},zf=function(e,t,n,i,a,o,s){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?Hn(a,o):l,c=a/2,d=o/2;u=Math.min(u,c,d);var f=u!==c,h=u!==d,v;if(f){var m=n-c+u-s,p=i-d-s,g=n+c-u+s,y=p;if(v=Cn(e,t,n,i,m,p,g,y,!1),v.length>0)return v}if(h){var C=n+c+s,x=i-d+u-s,M=C,P=i+d-u+s;if(v=Cn(e,t,n,i,C,x,M,P,!1),v.length>0)return v}if(f){var D=n-c+u-s,R=i+d+s,A=n+c-u+s,F=R;if(v=Cn(e,t,n,i,D,R,A,F,!1),v.length>0)return v}if(h){var O=n-c-s,T=i-d+u-s,B=O,E=i+d-u+s;if(v=Cn(e,t,n,i,O,T,B,E,!1),v.length>0)return v}var w;{var b=n-c+u,_=i-d+u;if(w=na(e,t,n,i,b,_,u+s),w.length>0&&w[0]<=b&&w[1]<=_)return[w[0],w[1]]}{var k=n+c-u,S=i-d+u;if(w=na(e,t,n,i,k,S,u+s),w.length>0&&w[0]>=k&&w[1]<=S)return[w[0],w[1]]}{var N=n+c-u,V=i+d-u;if(w=na(e,t,n,i,N,V,u+s),w.length>0&&w[0]>=N&&w[1]>=V)return[w[0],w[1]]}{var z=n-c+u,H=i+d-u;if(w=na(e,t,n,i,z,H,u+s),w.length>0&&w[0]<=z&&w[1]>=H)return[w[0],w[1]]}return[]},v0=function(e,t,n,i,a,o,s){var l=s,u=Math.min(n,a),c=Math.max(n,a),d=Math.min(i,o),f=Math.max(i,o);return u-l<=e&&e<=c+l&&d-l<=t&&t<=f+l},p0=function(e,t,n,i,a,o,s,l,u){var c={x1:Math.min(n,s,a)-u,x2:Math.max(n,s,a)+u,y1:Math.min(i,l,o)-u,y2:Math.max(i,l,o)+u};return!(e<c.x1||e>c.x2||t<c.y1||t>c.y2)},g0=function(e,t,n,i){n-=i;var a=t*t-4*e*n;if(a<0)return[];var o=Math.sqrt(a),s=2*e,l=(-t+o)/s,u=(-t-o)/s;return[l,u]},m0=function(e,t,n,i,a){var o=1e-5;e===0&&(e=o),t/=e,n/=e,i/=e;var s,l,u,c,d,f,h,v;if(l=(3*n-t*t)/9,u=-(27*i)+t*(9*n-2*(t*t)),u/=54,s=l*l*l+u*u,a[1]=0,h=t/3,s>0){d=u+Math.sqrt(s),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),f=u-Math.sqrt(s),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),a[0]=-h+d+f,h+=(d+f)/2,a[4]=a[2]=-h,h=Math.sqrt(3)*(-f+d)/2,a[3]=h,a[5]=-h;return}if(a[5]=a[3]=0,s===0){v=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-h+2*v,a[4]=a[2]=-(v+h);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),v=2*Math.sqrt(l),a[0]=-h+v*Math.cos(c/3),a[2]=-h+v*Math.cos((c+2*Math.PI)/3),a[4]=-h+v*Math.cos((c+4*Math.PI)/3)},y0=function(e,t,n,i,a,o,s,l){var u=1*n*n-4*n*a+2*n*s+4*a*a-4*a*s+s*s+i*i-4*i*o+2*i*l+4*o*o-4*o*l+l*l,c=1*9*n*a-3*n*n-3*n*s-6*a*a+3*a*s+9*i*o-3*i*i-3*i*l-6*o*o+3*o*l,d=1*3*n*n-6*n*a+n*s-n*e+2*a*a+2*a*e-s*e+3*i*i-6*i*o+i*l-i*t+2*o*o+2*o*t-l*t,f=1*n*a-n*n+n*e-a*e+i*o-i*i+i*t-o*t,h=[];m0(u,c,d,f,h);for(var v=1e-7,m=[],p=0;p<6;p+=2)Math.abs(h[p+1])<v&&h[p]>=0&&h[p]<=1&&m.push(h[p]);m.push(1),m.push(0);for(var g=-1,y,C,x,M=0;M<m.length;M++)y=Math.pow(1-m[M],2)*n+2*(1-m[M])*m[M]*a+m[M]*m[M]*s,C=Math.pow(1-m[M],2)*i+2*(1-m[M])*m[M]*o+m[M]*m[M]*l,x=Math.pow(y-e,2)+Math.pow(C-t,2),g>=0?x<g&&(g=x):g=x;return g},C0=function(e,t,n,i,a,o){var s=[e-n,t-i],l=[a-n,o-i],u=l[0]*l[0]+l[1]*l[1],c=s[0]*s[0]+s[1]*s[1],d=s[0]*l[0]+s[1]*l[1],f=d*d/u;return d<0?c:f>u?(e-a)*(e-a)+(t-o)*(t-o):c-f},tr=function(e,t,n){for(var i,a,o,s,l,u=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(o=n[(c+1)*2],s=n[(c+1)*2+1]):(o=n[(c+1-n.length/2)*2],s=n[(c+1-n.length/2)*2+1]),!(i==e&&o==e))if(i>=e&&e>=o||i<=e&&e<=o)l=(e-i)/(o-i)*(s-a)+a,l>t&&u++;else continue;return u%2!==0},an=function(e,t,n,i,a,o,s,l,u){var c=new Array(n.length),d;l[0]!=null?(d=Math.atan(l[1]/l[0]),l[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=l;for(var f=Math.cos(-d),h=Math.sin(-d),v=0;v<c.length/2;v++)c[v*2]=o/2*(n[v*2]*f-n[v*2+1]*h),c[v*2+1]=s/2*(n[v*2+1]*f+n[v*2]*h),c[v*2]+=i,c[v*2+1]+=a;var m;if(u>0){var p=ms(c,-u);m=gs(p)}else m=c;return tr(e,t,m)},w0=function(e,t,n,i,a,o,s,l){for(var u=new Array(n.length*2),c=0;c<l.length;c++){var d=l[c];u[c*4+0]=d.startX,u[c*4+1]=d.startY,u[c*4+2]=d.stopX,u[c*4+3]=d.stopY;var f=Math.pow(d.cx-e,2)+Math.pow(d.cy-t,2);if(f<=Math.pow(d.radius,2))return!0}return tr(e,t,u)},gs=function(e){for(var t=new Array(e.length/2),n,i,a,o,s,l,u,c,d=0;d<e.length/4;d++){n=e[d*4],i=e[d*4+1],a=e[d*4+2],o=e[d*4+3],d<e.length/4-1?(s=e[(d+1)*4],l=e[(d+1)*4+1],u=e[(d+1)*4+2],c=e[(d+1)*4+3]):(s=e[0],l=e[1],u=e[2],c=e[3]);var f=Cn(n,i,a,o,s,l,u,c,!0);t[d*2]=f[0],t[d*2+1]=f[1]}return t},ms=function(e,t){for(var n=new Array(e.length*2),i,a,o,s,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(o=e[(l+1)*2],s=e[(l+1)*2+1]):(o=e[0],s=e[1]);var u=s-a,c=-(o-i),d=Math.sqrt(u*u+c*c),f=u/d,h=c/d;n[l*4]=i+f*t,n[l*4+1]=a+h*t,n[l*4+2]=o+f*t,n[l*4+3]=s+h*t}return n},b0=function(e,t,n,i,a,o){var s=n-e,l=i-t;s/=a,l/=o;var u=Math.sqrt(s*s+l*l),c=u-1;if(c<0)return[];var d=c/u;return[(n-e)*d+e,(i-t)*d+t]},$n=function(e,t,n,i,a,o,s){return e-=a,t-=o,e/=n/2+s,t/=i/2+s,e*e+t*t<=1},na=function(e,t,n,i,a,o,s){var l=[n-e,i-t],u=[e-a,t-o],c=l[0]*l[0]+l[1]*l[1],d=2*(u[0]*l[0]+u[1]*l[1]),f=u[0]*u[0]+u[1]*u[1]-s*s,h=d*d-4*c*f;if(h<0)return[];var v=(-d+Math.sqrt(h))/(2*c),m=(-d-Math.sqrt(h))/(2*c),p=Math.min(v,m),g=Math.max(v,m),y=[];if(p>=0&&p<=1&&y.push(p),g>=0&&g<=1&&y.push(g),y.length===0)return[];var C=y[0]*l[0]+e,x=y[0]*l[1]+t;if(y.length>1){if(y[0]==y[1])return[C,x];var M=y[1]*l[0]+e,P=y[1]*l[1]+t;return[C,x,M,P]}else return[C,x]},El=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},Cn=function(e,t,n,i,a,o,s,l,u){var c=e-a,d=n-e,f=s-a,h=t-o,v=i-t,m=l-o,p=f*h-m*c,g=d*h-v*c,y=m*d-f*v;if(y!==0){var C=p/y,x=g/y,M=.001,P=0-M,D=1+M;return P<=C&&C<=D&&P<=x&&x<=D?[e+C*d,t+C*v]:u?[e+C*d,t+C*v]:[]}else return p===0||g===0?El(e,n,s)===s?[s,l]:El(e,n,a)===a?[a,o]:El(a,s,n)===n?[n,i]:[]:[]},pa=function(e,t,n,i,a,o,s,l){var u=[],c,d=new Array(n.length),f=!0;o==null&&(f=!1);var h;if(f){for(var v=0;v<d.length/2;v++)d[v*2]=n[v*2]*o+i,d[v*2+1]=n[v*2+1]*s+a;if(l>0){var m=ms(d,-l);h=gs(m)}else h=d}else h=n;for(var p,g,y,C,x=0;x<h.length/2;x++)p=h[x*2],g=h[x*2+1],x<h.length/2-1?(y=h[(x+1)*2],C=h[(x+1)*2+1]):(y=h[0],C=h[1]),c=Cn(e,t,i,a,p,g,y,C),c.length!==0&&u.push(c[0],c[1]);return u},x0=function(e,t,n,i,a,o,s,l,u){var c=[],d,f=new Array(n.length*2);u.forEach(function(y,C){C===0?(f[f.length-2]=y.startX,f[f.length-1]=y.startY):(f[C*4-2]=y.startX,f[C*4-1]=y.startY),f[C*4]=y.stopX,f[C*4+1]=y.stopY,d=na(e,t,i,a,y.cx,y.cy,y.radius),d.length!==0&&c.push(d[0],d[1])});for(var h=0;h<f.length/4;h++)d=Cn(e,t,i,a,f[h*4],f[h*4+1],f[h*4+2],f[h*4+3],!1),d.length!==0&&c.push(d[0],d[1]);if(c.length>2){for(var v=[c[0],c[1]],m=Math.pow(v[0]-e,2)+Math.pow(v[1]-t,2),p=1;p<c.length/2;p++){var g=Math.pow(c[p*2]-e,2)+Math.pow(c[p*2+1]-t,2);g<=m&&(v[0]=c[p*2],v[1]=c[p*2+1],m=g)}return v}return c},Wo=function(e,t,n){var i=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),o=(a-n)/a;return o<0&&(o=1e-5),[t[0]+o*i[0],t[1]+o*i[1]]},Gt=function(e,t){var n=Vl(e,t);return n=jf(n),n},jf=function(e){for(var t,n,i=e.length/2,a=1/0,o=1/0,s=-1/0,l=-1/0,u=0;u<i;u++)t=e[2*u],n=e[2*u+1],a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),l=Math.max(l,n);for(var c=2/(s-a),d=2/(l-o),f=0;f<i;f++)t=e[2*f]=e[2*f]*c,n=e[2*f+1]=e[2*f+1]*d,a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,n),l=Math.max(l,n);if(o<-1)for(var h=0;h<i;h++)n=e[2*h+1]=e[2*h+1]+(-1-o);return e},Vl=function(e,t){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=t;for(var a=new Array(e*2),o,s=0;s<e;s++)o=s*n+i,a[2*s]=Math.cos(o),a[2*s+1]=Math.sin(-o);return a},Hn=function(e,t){return Math.min(e/4,t/4,8)},$f=function(e,t){return Math.min(e/10,t/10,8)},lu=function(){return 8},_0=function(e,t,n){return[e-2*t+n,2*(t-e),e]},Nl=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},E0=Tt({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),S0={pageRank:function(e){for(var t=E0(e),n=t.dampingFactor,i=t.precision,a=t.iterations,o=t.weight,s=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,d=u.length,f=d*d,h=c.length,v=new Array(f),m=new Array(d),p=(1-n)/d,g=0;g<d;g++){for(var y=0;y<d;y++){var C=g*d+y;v[C]=0}m[g]=0}for(var x=0;x<h;x++){var M=c[x],P=M.data("source"),D=M.data("target");if(P!==D){var R=u.indexOfId(P),A=u.indexOfId(D),F=o(M),O=A*d+R;v[O]+=F,m[R]+=F}}for(var T=1/d+p,B=0;B<d;B++)if(m[B]===0)for(var E=0;E<d;E++){var w=E*d+B;v[w]=T}else for(var b=0;b<d;b++){var _=b*d+B;v[_]=v[_]/m[B]+p}for(var k=new Array(d),S=new Array(d),N,V=0;V<d;V++)k[V]=1;for(var z=0;z<a;z++){for(var H=0;H<d;H++)S[H]=0;for(var Y=0;Y<d;Y++)for(var ee=0;ee<d;ee++){var J=Y*d+ee;S[Y]+=v[J]*k[ee]}s0(S),N=k,k=S,S=N;for(var ne=0,ie=0;ie<d;ie++){var K=N[ie]-k[ie];ne+=K*K}if(ne<i)break}var L={rank:function($){return $=s.collection($)[0],k[u.indexOf($)]}};return L}},od=Tt({root:null,weight:function(e){return 1},directed:!1,alpha:0}),bi={degreeCentralityNormalized:function(e){e=od(e);var t=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},d={},f=0,h=0,v=0;v<i;v++){var m=n[v],p=m.id();e.root=m;var g=this.degreeCentrality(e);f<g.indegree&&(f=g.indegree),h<g.outdegree&&(h=g.outdegree),c[p]=g.indegree,d[p]=g.outdegree}return{indegree:function(C){return f==0?0:(Be(C)&&(C=t.filter(C)),c[C.id()]/f)},outdegree:function(C){return h===0?0:(Be(C)&&(C=t.filter(C)),d[C.id()]/h)}}}else{for(var a={},o=0,s=0;s<i;s++){var l=n[s];e.root=l;var u=this.degreeCentrality(e);o<u.degree&&(o=u.degree),a[l.id()]=u.degree}return{degree:function(C){return o===0?0:(Be(C)&&(C=t.filter(C)),a[C.id()]/o)}}}},degreeCentrality:function(e){e=od(e);var t=this.cy(),n=this,i=e,a=i.root,o=i.weight,s=i.directed,l=i.alpha;if(a=t.collection(a)[0],s){for(var h=a.connectedEdges(),v=h.filter(function(P){return P.target().same(a)&&n.has(P)}),m=h.filter(function(P){return P.source().same(a)&&n.has(P)}),p=v.length,g=m.length,y=0,C=0,x=0;x<v.length;x++)y+=o(v[x]);for(var M=0;M<m.length;M++)C+=o(m[M]);return{indegree:Math.pow(p,1-l)*Math.pow(y,l),outdegree:Math.pow(g,1-l)*Math.pow(C,l)}}else{for(var u=a.connectedEdges().intersection(n),c=u.length,d=0,f=0;f<u.length;f++)d+=o(u[f]);return{degree:Math.pow(c,1-l)*Math.pow(d,l)}}}};bi.dc=bi.degreeCentrality;bi.dcn=bi.degreeCentralityNormalised=bi.degreeCentralityNormalized;var sd=Tt({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),xi={closenessCentralityNormalized:function(e){for(var t=sd(e),n=t.harmonic,i=t.weight,a=t.directed,o=this.cy(),s={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),d=0;d<u.length;d++){for(var f=0,h=u[d],v=0;v<u.length;v++)if(d!==v){var m=c.distance(h,u[v]);n?f+=1/m:f+=m}n||(f=1/f),l<f&&(l=f),s[h.id()]=f}return{closeness:function(g){return l==0?0:(Be(g)?g=o.filter(g)[0].id():g=g.id(),s[g]/l)}}},closenessCentrality:function(e){var t=sd(e),n=t.root,i=t.weight,a=t.directed,o=t.harmonic;n=this.filter(n)[0];for(var s=this.dijkstra({root:n,weight:i,directed:a}),l=0,u=this.nodes(),c=0;c<u.length;c++){var d=u[c];if(!d.same(n)){var f=s.distanceTo(d);o?l+=1/f:l+=f}}return o?l:1/l}};xi.cc=xi.closenessCentrality;xi.ccn=xi.closenessCentralityNormalised=xi.closenessCentralityNormalized;var T0=Tt({weight:null,directed:!1}),zl={betweennessCentrality:function(e){for(var t=T0(e),n=t.directed,i=t.weight,a=i!=null,o=this.cy(),s=this.nodes(),l={},u={},c=0,d={set:function(C,x){u[C]=x,x>c&&(c=x)},get:function(C){return u[C]}},f=0;f<s.length;f++){var h=s[f],v=h.id();n?l[v]=h.outgoers().nodes():l[v]=h.openNeighborhood().nodes(),d.set(v,0)}for(var m=function(C){for(var x=s[C].id(),M=[],P={},D={},R={},A=new Sa(function(ee,J){return R[ee]-R[J]}),F=0;F<s.length;F++){var O=s[F].id();P[O]=[],D[O]=0,R[O]=1/0}for(D[x]=1,R[x]=0,A.push(x);!A.empty();){var T=A.pop();if(M.push(T),a)for(var B=0;B<l[T].length;B++){var E=l[T][B],w=o.getElementById(T),b=void 0;w.edgesTo(E).length>0?b=w.edgesTo(E)[0]:b=E.edgesTo(w)[0];var _=i(b);E=E.id(),R[E]>R[T]+_&&(R[E]=R[T]+_,A.nodes.indexOf(E)<0?A.push(E):A.updateItem(E),D[E]=0,P[E]=[]),R[E]==R[T]+_&&(D[E]=D[E]+D[T],P[E].push(T))}else for(var k=0;k<l[T].length;k++){var S=l[T][k].id();R[S]==1/0&&(A.push(S),R[S]=R[T]+1),R[S]==R[T]+1&&(D[S]=D[S]+D[T],P[S].push(T))}}for(var N={},V=0;V<s.length;V++)N[s[V].id()]=0;for(;M.length>0;){for(var z=M.pop(),H=0;H<P[z].length;H++){var Y=P[z][H];N[Y]=N[Y]+D[Y]/D[z]*(1+N[z])}z!=s[C].id()&&d.set(z,d.get(z)+N[z])}},p=0;p<s.length;p++)m(p);var g={betweenness:function(C){var x=o.collection(C).id();return d.get(x)},betweennessNormalized:function(C){if(c==0)return 0;var x=o.collection(C).id();return d.get(x)/c}};return g.betweennessNormalised=g.betweennessNormalized,g}};zl.bc=zl.betweennessCentrality;var k0=Tt({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),M0=function(e){return k0(e)},D0=function(e,t){for(var n=0,i=0;i<t.length;i++)n+=t[i](e);return n},P0=function(e,t,n){for(var i=0;i<t;i++)e[i*t+i]=n},Gf=function(e,t){for(var n,i=0;i<t;i++){n=0;for(var a=0;a<t;a++)n+=e[a*t+i];for(var o=0;o<t;o++)e[o*t+i]=e[o*t+i]/n}},A0=function(e,t,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var o=0;o<n;o++)i[a*n+o]=0;for(var s=0;s<n;s++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+s]*t[s*n+l]}return i},B0=function(e,t,n){for(var i=e.slice(0),a=1;a<n;a++)e=A0(e,i,t);return e},R0=function(e,t,n){for(var i=new Array(t*t),a=0;a<t*t;a++)i[a]=Math.pow(e[a],n);return Gf(i,t),i},I0=function(e,t,n,i){for(var a=0;a<n;a++){var o=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),s=Math.round(t[a]*Math.pow(10,i))/Math.pow(10,i);if(o!==s)return!1}return!0},O0=function(e,t,n,i){for(var a=[],o=0;o<t;o++){for(var s=[],l=0;l<t;l++)Math.round(e[o*t+l]*1e3)/1e3>0&&s.push(n[l]);s.length!==0&&a.push(i.collection(s))}return a},F0=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},L0=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&F0(e[t],e[n])&&e.splice(n,1);return e},ld=function(e){for(var t=this.nodes(),n=this.edges(),i=this.cy(),a=M0(e),o={},s=0;s<t.length;s++)o[t[s].id()]=s;for(var l=t.length,u=l*l,c=new Array(u),d,f=0;f<u;f++)c[f]=0;for(var h=0;h<n.length;h++){var v=n[h],m=o[v.source().id()],p=o[v.target().id()],g=D0(v,a.attributes);c[m*l+p]+=g,c[p*l+m]+=g}P0(c,l,a.multFactor),Gf(c,l);for(var y=!0,C=0;y&&C<a.maxIterations;)y=!1,d=B0(c,l,a.expandFactor),c=R0(d,l,a.inflateFactor),I0(c,d,u,4)||(y=!0),C++;var x=O0(c,l,t,i);return x=L0(x),x},V0={markovClustering:ld,mcl:ld},N0=function(e){return e},qf=function(e,t){return Math.abs(t-e)},ud=function(e,t,n){return e+qf(t,n)},cd=function(e,t,n){return e+Math.pow(n-t,2)},z0=function(e){return Math.sqrt(e)},j0=function(e,t,n){return Math.max(e,qf(t,n))},Xi=function(e,t,n,i,a){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:N0,s=i,l,u,c=0;c<e;c++)l=t(c),u=n(c),s=a(s,l,u);return o(s)},Ti={euclidean:function(e,t,n){return e>=2?Xi(e,t,n,0,cd,z0):Xi(e,t,n,0,ud)},squaredEuclidean:function(e,t,n){return Xi(e,t,n,0,cd)},manhattan:function(e,t,n){return Xi(e,t,n,0,ud)},max:function(e,t,n){return Xi(e,t,n,-1/0,j0)}};Ti["squared-euclidean"]=Ti.squaredEuclidean;Ti.squaredeuclidean=Ti.squaredEuclidean;function Ds(r,e,t,n,i,a){var o;return lt(r)?o=r:o=Ti[r]||Ti.euclidean,e===0&&lt(r)?o(i,a):o(e,t,n,i,a)}var $0=Tt({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),uu=function(e){return $0(e)},ys=function(e,t,n,i,a){var o=a!=="kMedoids",s=o?function(d){return n[d]}:function(d){return i[d](n)},l=function(f){return i[f](t)},u=n,c=t;return Ds(e,i.length,s,l,u,c)},Sl=function(e,t,n){for(var i=n.length,a=new Array(i),o=new Array(i),s=new Array(t),l=null,u=0;u<i;u++)a[u]=e.min(n[u]).value,o[u]=e.max(n[u]).value;for(var c=0;c<t;c++){l=[];for(var d=0;d<i;d++)l[d]=Math.random()*(o[d]-a[d])+a[d];s[c]=l}return s},Hf=function(e,t,n,i,a){for(var o=1/0,s=0,l=0;l<t.length;l++){var u=ys(n,e,t[l],i,a);u<o&&(o=u,s=l)}return s},Wf=function(e,t,n){for(var i=[],a=null,o=0;o<t.length;o++)a=t[o],n[a.id()]===e&&i.push(a);return i},G0=function(e,t,n){return Math.abs(t-e)<=n},q0=function(e,t,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var o=Math.abs(e[i][a]-t[i][a]);if(o>n)return!1}return!0},H0=function(e,t,n){for(var i=0;i<n;i++)if(e===t[i])return!0;return!1},dd=function(e,t){var n=new Array(t);if(e.length<50)for(var i=0;i<t;i++){for(var a=e[Math.floor(Math.random()*e.length)];H0(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var o=0;o<t;o++)n[o]=e[Math.floor(Math.random()*e.length)];return n},fd=function(e,t,n){for(var i=0,a=0;a<t.length;a++)i+=ys("manhattan",t[a],e,n,"kMedoids");return i},W0=function(e){var t=this.cy(),n=this.nodes(),i=null,a=uu(e),o=new Array(a.k),s={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Sl(n,a.k,a.attributes)):mt(a.testCentroids)==="object"?l=a.testCentroids:l=Sl(n,a.k,a.attributes):l=Sl(n,a.k,a.attributes);for(var u=!0,c=0;u&&c<a.maxIterations;){for(var d=0;d<n.length;d++)i=n[d],s[i.id()]=Hf(i,l,a.distance,a.attributes,"kMeans");u=!1;for(var f=0;f<a.k;f++){var h=Wf(f,n,s);if(h.length!==0){for(var v=a.attributes.length,m=l[f],p=new Array(v),g=new Array(v),y=0;y<v;y++){g[y]=0;for(var C=0;C<h.length;C++)i=h[C],g[y]+=a.attributes[y](i);p[y]=g[y]/h.length,G0(p[y],m[y],a.sensitivityThreshold)||(u=!0)}l[f]=p,o[f]=t.collection(h)}}c++}return o},U0=function(e){var t=this.cy(),n=this.nodes(),i=null,a=uu(e),o=new Array(a.k),s,l={},u,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(mt(a.testCentroids)==="object"?s=a.testCentroids:s=dd(n,a.k)):s=dd(n,a.k);for(var d=!0,f=0;d&&f<a.maxIterations;){for(var h=0;h<n.length;h++)i=n[h],l[i.id()]=Hf(i,s,a.distance,a.attributes,"kMedoids");d=!1;for(var v=0;v<s.length;v++){var m=Wf(v,n,l);if(m.length!==0){c[v]=fd(s[v],m,a.attributes);for(var p=0;p<m.length;p++)u=fd(m[p],m,a.attributes),u<c[v]&&(c[v]=u,s[v]=m[p],d=!0);o[v]=t.collection(m)}}f++}return o},K0=function(e,t,n,i,a){for(var o,s,l=0;l<t.length;l++)for(var u=0;u<e.length;u++)i[l][u]=Math.pow(n[l][u],a.m);for(var c=0;c<e.length;c++)for(var d=0;d<a.attributes.length;d++){o=0,s=0;for(var f=0;f<t.length;f++)o+=i[f][c]*a.attributes[d](t[f]),s+=i[f][c];e[c][d]=o/s}},X0=function(e,t,n,i,a){for(var o=0;o<e.length;o++)t[o]=e[o].slice();for(var s,l,u,c=2/(a.m-1),d=0;d<n.length;d++)for(var f=0;f<i.length;f++){s=0;for(var h=0;h<n.length;h++)l=ys(a.distance,i[f],n[d],a.attributes,"cmeans"),u=ys(a.distance,i[f],n[h],a.attributes,"cmeans"),s+=Math.pow(l/u,c);e[f][d]=1/s}},Y0=function(e,t,n,i){for(var a=new Array(n.k),o=0;o<a.length;o++)a[o]=[];for(var s,l,u=0;u<t.length;u++){s=-1/0,l=-1;for(var c=0;c<t[0].length;c++)t[u][c]>s&&(s=t[u][c],l=c);a[l].push(e[u])}for(var d=0;d<a.length;d++)a[d]=i.collection(a[d]);return a},hd=function(e){var t=this.cy(),n=this.nodes(),i=uu(e),a,o,s,l,u;l=new Array(n.length);for(var c=0;c<n.length;c++)l[c]=new Array(i.k);s=new Array(n.length);for(var d=0;d<n.length;d++)s[d]=new Array(i.k);for(var f=0;f<n.length;f++){for(var h=0,v=0;v<i.k;v++)s[f][v]=Math.random(),h+=s[f][v];for(var m=0;m<i.k;m++)s[f][m]=s[f][m]/h}o=new Array(i.k);for(var p=0;p<i.k;p++)o[p]=new Array(i.attributes.length);u=new Array(n.length);for(var g=0;g<n.length;g++)u[g]=new Array(i.k);for(var y=!0,C=0;y&&C<i.maxIterations;)y=!1,K0(o,n,s,u,i),X0(s,l,o,n,i),q0(s,l,i.sensitivityThreshold)||(y=!0),C++;return a=Y0(n,s,i,t),{clusters:a,degreeOfMembership:s}},Q0={kMeans:W0,kMedoids:U0,fuzzyCMeans:hd,fcm:hd},Z0=Tt({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),J0={single:"min",complete:"max"},ey=function(e){var t=Z0(e),n=J0[t.linkage];return n!=null&&(t.linkage=n),t},vd=function(e,t,n,i,a){for(var o=0,s=1/0,l,u=a.attributes,c=function(A,F){return Ds(a.distance,u.length,function(O){return u[O](A)},function(O){return u[O](F)},A,F)},d=0;d<e.length;d++){var f=e[d].key,h=n[f][i[f]];h<s&&(o=f,s=h)}if(a.mode==="threshold"&&s>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=t[o],m=t[i[o]],p;a.mode==="dendrogram"?p={left:v,right:m,key:v.key}:p={value:v.value.concat(m.value),key:v.key},e[v.index]=p,e.splice(m.index,1),t[v.key]=p;for(var g=0;g<e.length;g++){var y=e[g];v.key===y.key?l=1/0:a.linkage==="min"?(l=n[v.key][y.key],n[v.key][y.key]>n[m.key][y.key]&&(l=n[m.key][y.key])):a.linkage==="max"?(l=n[v.key][y.key],n[v.key][y.key]<n[m.key][y.key]&&(l=n[m.key][y.key])):a.linkage==="mean"?l=(n[v.key][y.key]*v.size+n[m.key][y.key]*m.size)/(v.size+m.size):a.mode==="dendrogram"?l=c(y.value,v.value):l=c(y.value[0],v.value[0]),n[v.key][y.key]=n[y.key][v.key]=l}for(var C=0;C<e.length;C++){var x=e[C].key;if(i[x]===v.key||i[x]===m.key){for(var M=x,P=0;P<e.length;P++){var D=e[P].key;n[x][D]<n[x][M]&&(M=D)}i[x]=M}e[C].index=C}return v.key=m.key=v.index=m.index=null,!0},Uo=function r(e,t,n){e&&(e.value?t.push(e.value):(e.left&&r(e.left,t),e.right&&r(e.right,t)))},ty=function r(e,t){if(!e)return"";if(e.left&&e.right){var n=r(e.left,t),i=r(e.right,t),a=t.add({group:"nodes",data:{id:n+","+i}});return t.add({group:"edges",data:{source:n,target:a.id()}}),t.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},ry=function r(e,t,n){if(!e)return[];var i=[],a=[],o=[];return t===0?(e.left&&Uo(e.left,i),e.right&&Uo(e.right,a),o=i.concat(a),[n.collection(o)]):t===1?e.value?[n.collection(e.value)]:(e.left&&Uo(e.left,i),e.right&&Uo(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=r(e.left,t-1,n)),e.right&&(a=r(e.right,t-1,n)),i.concat(a))},pd=function(e){for(var t=this.cy(),n=this.nodes(),i=ey(e),a=i.attributes,o=function(C,x){return Ds(i.distance,a.length,function(M){return a[M](C)},function(M){return a[M](x)},C,x)},s=[],l=[],u=[],c=[],d=0;d<n.length;d++){var f={value:i.mode==="dendrogram"?n[d]:[n[d]],key:d,index:d};s[d]=f,c[d]=f,l[d]=[],u[d]=0}for(var h=0;h<s.length;h++)for(var v=0;v<=h;v++){var m=void 0;i.mode==="dendrogram"?m=h===v?1/0:o(s[h].value,s[v].value):m=h===v?1/0:o(s[h].value[0],s[v].value[0]),l[h][v]=m,l[v][h]=m,m<l[h][u[h]]&&(u[h]=v)}for(var p=vd(s,c,l,u,i);p;)p=vd(s,c,l,u,i);var g;return i.mode==="dendrogram"?(g=ry(s[0],i.dendrogramDepth,t),i.addDendrogram&&ty(s[0],t)):(g=new Array(s.length),s.forEach(function(y,C){y.key=y.index=null,g[C]=t.collection(y.value)})),g},ny={hierarchicalClustering:pd,hca:pd},iy=Tt({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),ay=function(e){var t=e.damping,n=e.preference;.5<=t&&t<1||st("Damping must range on [0.5, 1).  Got: ".concat(t));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Ce(n)||st("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),iy(e)},oy=function(e,t,n,i){var a=function(s,l){return i[l](s)};return-Ds(e,i.length,function(o){return a(t,o)},function(o){return a(n,o)},t,n)},sy=function(e,t){var n=null;return t==="median"?n=a0(e):t==="mean"?n=i0(e):t==="min"?n=r0(e):t==="max"?n=n0(e):n=t,n},ly=function(e,t,n){for(var i=[],a=0;a<e;a++)t[a*e+a]+n[a*e+a]>0&&i.push(a);return i},gd=function(e,t,n){for(var i=[],a=0;a<e;a++){for(var o=-1,s=-1/0,l=0;l<n.length;l++){var u=n[l];t[a*e+u]>s&&(o=u,s=t[a*e+u])}o>0&&i.push(o)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},uy=function(e,t,n){for(var i=gd(e,t,n),a=0;a<n.length;a++){for(var o=[],s=0;s<i.length;s++)i[s]===n[a]&&o.push(s);for(var l=-1,u=-1/0,c=0;c<o.length;c++){for(var d=0,f=0;f<o.length;f++)d+=t[o[f]*e+o[c]];d>u&&(l=c,u=d)}n[a]=o[l]}return i=gd(e,t,n),i},md=function(e){for(var t=this.cy(),n=this.nodes(),i=ay(e),a={},o=0;o<n.length;o++)a[n[o].id()]=o;var s,l,u,c,d,f;s=n.length,l=s*s,u=new Array(l);for(var h=0;h<l;h++)u[h]=-1/0;for(var v=0;v<s;v++)for(var m=0;m<s;m++)v!==m&&(u[v*s+m]=oy(i.distance,n[v],n[m],i.attributes));c=sy(u,i.preference);for(var p=0;p<s;p++)u[p*s+p]=c;d=new Array(l);for(var g=0;g<l;g++)d[g]=0;f=new Array(l);for(var y=0;y<l;y++)f[y]=0;for(var C=new Array(s),x=new Array(s),M=new Array(s),P=0;P<s;P++)C[P]=0,x[P]=0,M[P]=0;for(var D=new Array(s*i.minIterations),R=0;R<D.length;R++)D[R]=0;var A;for(A=0;A<i.maxIterations;A++){for(var F=0;F<s;F++){for(var O=-1/0,T=-1/0,B=-1,E=0,w=0;w<s;w++)C[w]=d[F*s+w],E=f[F*s+w]+u[F*s+w],E>=O?(T=O,O=E,B=w):E>T&&(T=E);for(var b=0;b<s;b++)d[F*s+b]=(1-i.damping)*(u[F*s+b]-O)+i.damping*C[b];d[F*s+B]=(1-i.damping)*(u[F*s+B]-T)+i.damping*C[B]}for(var _=0;_<s;_++){for(var k=0,S=0;S<s;S++)C[S]=f[S*s+_],x[S]=Math.max(0,d[S*s+_]),k+=x[S];k-=x[_],x[_]=d[_*s+_],k+=x[_];for(var N=0;N<s;N++)f[N*s+_]=(1-i.damping)*Math.min(0,k-x[N])+i.damping*C[N];f[_*s+_]=(1-i.damping)*(k-x[_])+i.damping*C[_]}for(var V=0,z=0;z<s;z++){var H=f[z*s+z]+d[z*s+z]>0?1:0;D[A%i.minIterations*s+z]=H,V+=H}if(V>0&&(A>=i.minIterations-1||A==i.maxIterations-1)){for(var Y=0,ee=0;ee<s;ee++){M[ee]=0;for(var J=0;J<i.minIterations;J++)M[ee]+=D[J*s+ee];(M[ee]===0||M[ee]===i.minIterations)&&Y++}if(Y===s)break}}for(var ne=ly(s,d,f),ie=uy(s,u,ne),K={},L=0;L<ne.length;L++)K[ne[L]]=[];for(var j=0;j<n.length;j++){var $=a[n[j].id()],U=ie[$];U!=null&&K[U].push(n[j])}for(var X=new Array(ne.length),de=0;de<ne.length;de++)X[de]=t.collection(K[ne[de]]);return X},cy={affinityPropagation:md,ap:md},dy=Tt({root:void 0,directed:!1}),fy={hierholzer:function(e){if(!He(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n=dy(e),i=n.root,a=n.directed,o=this,s=!1,l,u,c;i&&(c=Be(i)?this.filter(i)[0].id():i[0].id());var d={},f={};a?o.forEach(function(y){var C=y.id();if(y.isNode()){var x=y.indegree(!0),M=y.outdegree(!0),P=x-M,D=M-x;P==1?l?s=!0:l=C:D==1?u?s=!0:u=C:(D>1||P>1)&&(s=!0),d[C]=[],y.outgoers().forEach(function(R){R.isEdge()&&d[C].push(R.id())})}else f[C]=[void 0,y.target().id()]}):o.forEach(function(y){var C=y.id();if(y.isNode()){var x=y.degree(!0);x%2&&(l?u?s=!0:u=C:l=C),d[C]=[],y.connectedEdges().forEach(function(M){return d[C].push(M.id())})}else f[C]=[y.source().id(),y.target().id()]});var h={found:!1,trail:void 0};if(s)return h;if(u&&l)if(a){if(c&&u!=c)return h;c=u}else{if(c&&u!=c&&l!=c)return h;c||(c=u)}else c||(c=o[0].id());var v=function(C){for(var x=C,M=[C],P,D,R;d[x].length;)P=d[x].shift(),D=f[P][0],R=f[P][1],x!=R?(d[R]=d[R].filter(function(A){return A!=P}),x=R):!a&&x!=D&&(d[D]=d[D].filter(function(A){return A!=P}),x=D),M.unshift(P),M.unshift(x);return M},m=[],p=[];for(p=v(c);p.length!=1;)d[p[0]].length==0?(m.unshift(o.getElementById(p.shift())),m.unshift(o.getElementById(p.shift()))):p=v(p.shift()).concat(p);m.unshift(o.getElementById(p.shift()));for(var g in d)if(d[g].length)return h;return h.found=!0,h.trail=this.spawn(m,!0),h}},Ko=function(){var e=this,t={},n=0,i=0,a=[],o=[],s={},l=function(f,h){for(var v=o.length-1,m=[],p=e.spawn();o[v].x!=f||o[v].y!=h;)m.push(o.pop().edge),v--;m.push(o.pop().edge),m.forEach(function(g){var y=g.connectedNodes().intersection(e);p.merge(g),y.forEach(function(C){var x=C.id(),M=C.connectedEdges().intersection(e);p.merge(C),t[x].cutVertex?p.merge(M.filter(function(P){return P.isLoop()})):p.merge(M)})}),a.push(p)},u=function d(f,h,v){f===v&&(i+=1),t[h]={id:n,low:n++,cutVertex:!1};var m=e.getElementById(h).connectedEdges().intersection(e);if(m.size()===0)a.push(e.spawn(e.getElementById(h)));else{var p,g,y,C;m.forEach(function(x){p=x.source().id(),g=x.target().id(),y=p===h?g:p,y!==v&&(C=x.id(),s[C]||(s[C]=!0,o.push({x:h,y,edge:x})),y in t?t[h].low=Math.min(t[h].low,t[y].id):(d(f,y,h),t[h].low=Math.min(t[h].low,t[y].low),t[h].id<=t[y].low&&(t[h].cutVertex=!0,l(h,y))))})}};e.forEach(function(d){if(d.isNode()){var f=d.id();f in t||(i=0,u(f,f),t[f].cutVertex=i>1)}});var c=Object.keys(t).filter(function(d){return t[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(c),components:a}},hy={hopcroftTarjanBiconnected:Ko,htbc:Ko,htb:Ko,hopcroftTarjanBiconnectedComponents:Ko},Xo=function(){var e=this,t={},n=0,i=[],a=[],o=e.spawn(e),s=function l(u){a.push(u),t[u]={index:n,low:n++,explored:!1};var c=e.getElementById(u).connectedEdges().intersection(e);if(c.forEach(function(m){var p=m.target().id();p!==u&&(p in t||l(p),t[p].explored||(t[u].low=Math.min(t[u].low,t[p].low)))}),t[u].index===t[u].low){for(var d=e.spawn();;){var f=a.pop();if(d.merge(e.getElementById(f)),t[f].low=t[u].index,t[f].explored=!0,f===u)break}var h=d.edgesWith(d),v=d.merge(h);i.push(v),o=o.difference(v)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in t||s(u)}}),{cut:o,components:i}},vy={tarjanStronglyConnected:Xo,tsc:Xo,tscc:Xo,tarjanStronglyConnectedComponents:Xo},Uf={};[ha,qm,Hm,Um,Xm,Qm,e0,S0,bi,xi,zl,V0,Q0,ny,cy,fy,hy,vy].forEach(function(r){Fe(Uf,r)});var Kf=0,Xf=1,Yf=2,on=function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.7",this.state=Kf,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};on.prototype={fulfill:function(e){return yd(this,Xf,"fulfillValue",e)},reject:function(e){return yd(this,Yf,"rejectReason",e)},then:function(e,t){var n=this,i=new on;return n.onFulfilled.push(wd(e,i,"fulfill")),n.onRejected.push(wd(t,i,"reject")),Qf(n),i.proxy}};var yd=function(e,t,n,i){return e.state===Kf&&(e.state=t,e[n]=i,Qf(e)),e},Qf=function(e){e.state===Xf?Cd(e,"onFulfilled",e.fulfillValue):e.state===Yf&&Cd(e,"onRejected",e.rejectReason)},Cd=function(e,t,n){if(e[t].length!==0){var i=e[t];e[t]=[];var a=function(){for(var s=0;s<i.length;s++)i[s](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},wd=function(e,t,n){return function(i){if(typeof e!="function")t[n].call(t,i);else{var a;try{a=e(i)}catch(o){t.reject(o);return}py(t,a)}}},py=function r(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(mt(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(t,function(a){i||(i=!0,a===t?e.reject(new TypeError("circular thenable chain")):r(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(t)};on.all=function(r){return new on(function(e,t){for(var n=new Array(r.length),i=0,a=function(l,u){n[l]=u,i++,i===r.length&&e(n)},o=0;o<r.length;o++)(function(s){var l=r[s],u=l!=null&&l.then!=null;if(u)l.then(function(d){a(s,d)},function(d){t(d)});else{var c=l;a(s,c)}})(o)})};on.resolve=function(r){return new on(function(e,t){e(r)})};on.reject=function(r){return new on(function(e,t){t(r)})};var Di=typeof Promise<"u"?Promise:on,jl=function(e,t,n){var i=tu(e),a=!i,o=this._private=Fe({duration:1e3},t,n);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&lt(o.complete)&&o.completes.push(o.complete),a){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(i){var l=e.pan();o.startPan={x:l.x,y:l.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},Wn=jl.prototype;Fe(Wn,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,n=e.target._private.animation;e.queue?t=n.queue:t=n.current,t.push(this),ur(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,c){var d=e[u];d!=null&&(e[u]=e[c],e[c]=d)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],o=a.name,s=e.startStyle[o];e.startStyle[o]=a,e.style[i]=s}return t&&this.play(),this},promise:function(e){var t=this._private,n;switch(e){case"frame":n=t.frames;break;default:case"complete":case"completed":n=t.completes}return new Di(function(i,a){n.push(function(){i()})})}});Wn.complete=Wn.completed;Wn.run=Wn.play;Wn.running=Wn.playing;var gy={animated:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return!1;var o=i[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var o=0;o<i.length;o++){var s=i[o];s._private.animation.queue=[]}return this}},delay:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:t,duration:t,complete:n}):this}},delayAnimation:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:t,duration:t,complete:n}):this}},animation:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this,l=!a,u=!l;if(!s.styleEnabled())return this;var c=s.style();t=Fe({},t,n);var d=Object.keys(t).length===0;if(d)return new jl(o[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(u&&(t.style=c.getPropsList(t.style||t.css),t.css=void 0),u&&t.renderedPosition!=null){var f=t.renderedPosition,h=s.pan(),v=s.zoom();t.position=Ff(f,v,h)}if(l&&t.panBy!=null){var m=t.panBy,p=s.pan();t.pan={x:p.x+m.x,y:p.y+m.y}}var g=t.center||t.centre;if(l&&g!=null){var y=s.getCenterPan(g.eles,t.zoom);y!=null&&(t.pan=y)}if(l&&t.fit!=null){var C=t.fit,x=s.getFitViewport(C.eles||C.boundingBox,C.padding);x!=null&&(t.pan=x.pan,t.zoom=x.zoom)}if(l&&He(t.zoom)){var M=s.getZoomedViewport(t.zoom);M!=null?(M.zoomed&&(t.zoom=M.zoom),M.panned&&(t.pan=M.pan)):t.zoom=null}return new jl(o[0],t)}},animate:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;n&&(t=Fe({},t,n));for(var l=0;l<o.length;l++){var u=o[l],c=u.animated()&&(t.queue===void 0||t.queue),d=u.animation(t,c?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(t,n){var i=this,a=i.length!==void 0,o=a?i:[i],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var l=0;l<o.length;l++){for(var u=o[l],c=u._private,d=c.animation.current,f=0;f<d.length;f++){var h=d[f],v=h._private;n&&(v.duration=0)}t&&(c.animation.queue=[]),n||(c.animation.current=[])}return s.notify("draw"),this}}},my=Array.isArray,Ps=my,yy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cy=/^\w*$/;function wy(r,e){if(Ps(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||_a(r)?!0:Cy.test(r)||!yy.test(r)||e!=null&&r in Object(e)}var by=wy,xy="[object AsyncFunction]",_y="[object Function]",Ey="[object GeneratorFunction]",Sy="[object Proxy]";function Ty(r){if(!Gn(r))return!1;var e=kf(r);return e==_y||e==Ey||e==xy||e==Sy}var ky=Ty,My=Ts["__core-js_shared__"],Tl=My,bd=function(){var r=/[^.]+$/.exec(Tl&&Tl.keys&&Tl.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Dy(r){return!!bd&&bd in r}var Py=Dy,Ay=Function.prototype,By=Ay.toString;function Ry(r){if(r!=null){try{return By.call(r)}catch{}try{return r+""}catch{}}return""}var Iy=Ry,Oy=/[\\^$.*+?()[\]{}|]/g,Fy=/^\[object .+?Constructor\]$/,Ly=Function.prototype,Vy=Object.prototype,Ny=Ly.toString,zy=Vy.hasOwnProperty,jy=RegExp("^"+Ny.call(zy).replace(Oy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $y(r){if(!Gn(r)||Py(r))return!1;var e=ky(r)?jy:Fy;return e.test(Iy(r))}var Gy=$y;function qy(r,e){return r?.[e]}var Hy=qy;function Wy(r,e){var t=Hy(r,e);return Gy(t)?t:void 0}var cu=Wy,Uy=cu(Object,"create"),ga=Uy;function Ky(){this.__data__=ga?ga(null):{},this.size=0}var Xy=Ky;function Yy(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var Qy=Yy,Zy="__lodash_hash_undefined__",Jy=Object.prototype,e1=Jy.hasOwnProperty;function t1(r){var e=this.__data__;if(ga){var t=e[r];return t===Zy?void 0:t}return e1.call(e,r)?e[r]:void 0}var r1=t1,n1=Object.prototype,i1=n1.hasOwnProperty;function a1(r){var e=this.__data__;return ga?e[r]!==void 0:i1.call(e,r)}var o1=a1,s1="__lodash_hash_undefined__";function l1(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=ga&&e===void 0?s1:e,this}var u1=l1;function Pi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Pi.prototype.clear=Xy;Pi.prototype.delete=Qy;Pi.prototype.get=r1;Pi.prototype.has=o1;Pi.prototype.set=u1;var xd=Pi;function c1(){this.__data__=[],this.size=0}var d1=c1;function f1(r,e){return r===e||r!==r&&e!==e}var Zf=f1;function h1(r,e){for(var t=r.length;t--;)if(Zf(r[t][0],e))return t;return-1}var As=h1,v1=Array.prototype,p1=v1.splice;function g1(r){var e=this.__data__,t=As(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():p1.call(e,t,1),--this.size,!0}var m1=g1;function y1(r){var e=this.__data__,t=As(e,r);return t<0?void 0:e[t][1]}var C1=y1;function w1(r){return As(this.__data__,r)>-1}var b1=w1;function x1(r,e){var t=this.__data__,n=As(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var _1=x1;function Ai(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Ai.prototype.clear=d1;Ai.prototype.delete=m1;Ai.prototype.get=C1;Ai.prototype.has=b1;Ai.prototype.set=_1;var E1=Ai,S1=cu(Ts,"Map"),T1=S1;function k1(){this.size=0,this.__data__={hash:new xd,map:new(T1||E1),string:new xd}}var M1=k1;function D1(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var P1=D1;function A1(r,e){var t=r.__data__;return P1(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Bs=A1;function B1(r){var e=Bs(this,r).delete(r);return this.size-=e?1:0,e}var R1=B1;function I1(r){return Bs(this,r).get(r)}var O1=I1;function F1(r){return Bs(this,r).has(r)}var L1=F1;function V1(r,e){var t=Bs(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var N1=V1;function Bi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Bi.prototype.clear=M1;Bi.prototype.delete=R1;Bi.prototype.get=O1;Bi.prototype.has=L1;Bi.prototype.set=N1;var Jf=Bi,z1="Expected a function";function du(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(z1);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=r.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(du.Cache||Jf),t}du.Cache=Jf;var j1=du,$1=500;function G1(r){var e=j1(r,function(n){return t.size===$1&&t.clear(),n}),t=e.cache;return e}var q1=G1,H1=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W1=/\\(\\)?/g,U1=q1(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(H1,function(t,n,i,a){e.push(i?a.replace(W1,"$1"):n||t)}),e}),eh=U1;function K1(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var th=K1,X1=1/0,_d=Ei?Ei.prototype:void 0,Ed=_d?_d.toString:void 0;function rh(r){if(typeof r=="string")return r;if(Ps(r))return th(r,rh)+"";if(_a(r))return Ed?Ed.call(r):"";var e=r+"";return e=="0"&&1/r==-X1?"-0":e}var Y1=rh;function Q1(r){return r==null?"":Y1(r)}var nh=Q1;function Z1(r,e){return Ps(r)?r:by(r,e)?[r]:eh(nh(r))}var ih=Z1,J1=1/0;function eC(r){if(typeof r=="string"||_a(r))return r;var e=r+"";return e=="0"&&1/r==-J1?"-0":e}var fu=eC;function tC(r,e){e=ih(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[fu(e[t++])];return t&&t==n?r:void 0}var rC=tC;function nC(r,e,t){var n=r==null?void 0:rC(r,e);return n===void 0?t:n}var iC=nC,aC=function(){try{var r=cu(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Sd=aC;function oC(r,e,t){e=="__proto__"&&Sd?Sd(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var sC=oC,lC=Object.prototype,uC=lC.hasOwnProperty;function cC(r,e,t){var n=r[e];(!(uC.call(r,e)&&Zf(n,t))||t===void 0&&!(e in r))&&sC(r,e,t)}var dC=cC,fC=9007199254740991,hC=/^(?:0|[1-9]\d*)$/;function vC(r,e){var t=typeof r;return e=e??fC,!!e&&(t=="number"||t!="symbol"&&hC.test(r))&&r>-1&&r%1==0&&r<e}var pC=vC;function gC(r,e,t,n){if(!Gn(r))return r;e=ih(e,r);for(var i=-1,a=e.length,o=a-1,s=r;s!=null&&++i<a;){var l=fu(e[i]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return r;if(i!=o){var c=s[l];u=n?n(c,l,s):void 0,u===void 0&&(u=Gn(c)?c:pC(e[i+1])?[]:{})}dC(s,l,u),s=s[l]}return r}var mC=gC;function yC(r,e,t){return r==null?r:mC(r,e,t)}var CC=yC;function wC(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var bC=wC;function xC(r){return Ps(r)?th(r,fu):_a(r)?[r]:bC(eh(nh(r)))}var _C=xC,EC={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Fe({},t,e),function(i,a){var o=e,s=this,l=s.length!==void 0,u=l?s:[s],c=l?s[0]:s;if(Be(i)){var d=i.indexOf(".")!==-1,f=d&&_C(i);if(o.allowGetting&&a===void 0){var h;return c&&(o.beforeGet(c),f&&c._private[o.field][i]===void 0?h=iC(c._private[o.field],f):h=c._private[o.field][i]),h}else if(o.allowSetting&&a!==void 0){var v=!o.immutableKeys[i];if(v){var m=gf({},i,a);o.beforeSet(s,m);for(var p=0,g=u.length;p<g;p++){var y=u[p];o.canSet(y)&&(f&&c._private[o.field][i]===void 0?CC(y._private[o.field],f,a):y._private[o.field][i]=a)}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&He(i)){var C=i,x,M,P=Object.keys(C);o.beforeSet(s,C);for(var D=0;D<P.length;D++){x=P[D],M=C[x];var R=!o.immutableKeys[x];if(R)for(var A=0;A<u.length;A++){var F=u[A];o.canSet(F)&&(F._private[o.field][x]=M)}}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&lt(i)){var O=i;s.on(o.bindingEvent,O)}else if(o.allowGetting&&i===void 0){var T;return c&&(o.beforeGet(c),T=c._private[o.field]),T}return s}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Fe({},t,e),function(i){var a=e,o=this,s=o.length!==void 0,l=s?o:[o];if(Be(i)){for(var u=i.split(/\s+/),c=u.length,d=0;d<c;d++){var f=u[d];if(!xn(f)){var h=!a.immutableKeys[f];if(h)for(var v=0,m=l.length;v<m;v++)l[v]._private[a.field][f]=void 0}}a.triggerEvent&&o[a.triggerFnName](a.event)}else if(i===void 0){for(var p=0,g=l.length;p<g;p++)for(var y=l[p]._private[a.field],C=Object.keys(y),x=0;x<C.length;x++){var M=C[x],P=!a.immutableKeys[M];P&&(y[M]=void 0)}a.triggerEvent&&o[a.triggerFnName](a.event)}return o}}},SC={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,i){var a=this,o=Array.prototype.slice.call(arguments,0);return new Di(function(s,l){var u=function(h){a.off.apply(a,d),s(h)},c=o.concat([u]),d=c.concat([]);a.on.apply(a,c)})}}},Xe={};[gy,EC,SC].forEach(function(r){Fe(Xe,r)});var TC={animate:Xe.animate(),animation:Xe.animation(),animated:Xe.animated(),clearQueue:Xe.clearQueue(),delay:Xe.delay(),delayAnimation:Xe.delayAnimation(),stop:Xe.stop()},os={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(v){return n.push(v)}),n}else Ze(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new Mi(e),o=0;o<t.length;o++){for(var s=t[o],l=s._private,u=l.classes,c=!1,d=0;d<e.length;d++){var f=e[d],h=u.has(f);if(!h){c=!0;break}}c||(c=u.size!==e.length),c&&(l.classes=a,i.push(s))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){Ze(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=t===void 0,a=[],o=0,s=n.length;o<s;o++)for(var l=n[o],u=l._private.classes,c=!1,d=0;d<e.length;d++){var f=e[d],h=u.has(f),v=!1;t||i&&!h?(u.add(f),v=!0):(!t||i&&h)&&(u.delete(f),v=!0),!c&&v&&(a.push(l),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};os.className=os.classNames=os.classes;var qe={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:gt,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};qe.variable="(?:[\\w-.]|(?:\\\\"+qe.metaChar+"))+";qe.className="(?:[\\w-]|(?:\\\\"+qe.metaChar+"))+";qe.value=qe.string+"|"+qe.number;qe.id=qe.variable;(function(){var r,e,t;for(r=qe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],qe.comparatorOp+="|@"+e;for(r=qe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(qe.comparatorOp+="|\\!"+e)})();var Qe=function(){return{checks:[]}},Pe={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},$l=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return Ng(r.selector,e.selector)}),kC=function(){for(var r={},e,t=0;t<$l.length;t++)e=$l[t],r[e.selector]=e.matches;return r}(),MC=function(e,t){return kC[e](t)},DC="("+$l.map(function(r){return r.selector}).join("|")+")",fi=function(e){return e.replace(new RegExp("\\\\("+qe.metaChar+")","g"),function(t,n){return n})},mn=function(e,t,n){e[e.length-1]=n},Gl=[{name:"group",query:!0,regex:"("+qe.group+")",populate:function(e,t,n){var i=ft(n,1),a=i[0];t.checks.push({type:Pe.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:DC,populate:function(e,t,n){var i=ft(n,1),a=i[0];t.checks.push({type:Pe.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+qe.id+")",populate:function(e,t,n){var i=ft(n,1),a=i[0];t.checks.push({type:Pe.ID,value:fi(a)})}},{name:"className",query:!0,regex:"\\.("+qe.className+")",populate:function(e,t,n){var i=ft(n,1),a=i[0];t.checks.push({type:Pe.CLASS,value:fi(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+qe.variable+")\\s*\\]",populate:function(e,t,n){var i=ft(n,1),a=i[0];t.checks.push({type:Pe.DATA_EXIST,field:fi(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+qe.variable+")\\s*("+qe.comparatorOp+")\\s*("+qe.value+")\\s*\\]",populate:function(e,t,n){var i=ft(n,3),a=i[0],o=i[1],s=i[2],l=new RegExp("^"+qe.string+"$").exec(s)!=null;l?s=s.substring(1,s.length-1):s=parseFloat(s),t.checks.push({type:Pe.DATA_COMPARE,field:fi(a),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+qe.boolOp+")\\s*("+qe.variable+")\\s*\\]",populate:function(e,t,n){var i=ft(n,2),a=i[0],o=i[1];t.checks.push({type:Pe.DATA_BOOL,field:fi(o),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+qe.meta+")\\s*("+qe.comparatorOp+")\\s*("+qe.number+")\\s*\\]\\]",populate:function(e,t,n){var i=ft(n,3),a=i[0],o=i[1],s=i[2];t.checks.push({type:Pe.META_COMPARE,field:fi(a),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:qe.separator,populate:function(e,t){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,o=e[e.length-1];n!=null&&(o.subject=n,e.currentSubject=null),o.edgeCount=i,o.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var s=e[e.length++]=Qe();return s}},{name:"directedEdge",separator:!0,regex:qe.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),i=t,a=Qe();return n.checks.push({type:Pe.DIRECTED_EDGE,source:i,target:a}),mn(e,t,n),e.edgeCount++,a}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Pe.NODE_SOURCE,source:s,target:l}),mn(e,t,o),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:qe.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),i=t,a=Qe();return n.checks.push({type:Pe.UNDIRECTED_EDGE,nodes:[i,a]}),mn(e,t,n),e.edgeCount++,a}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Pe.NODE_NEIGHBOR,node:s,neighbor:l}),mn(e,t,o),l}}},{name:"child",separator:!0,regex:qe.child,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),i=Qe(),a=e[e.length-1];return n.checks.push({type:Pe.CHILD,parent:a,child:i}),mn(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),c=Qe(),d=Qe();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Pe.TRUE}],d.checks.push({type:Pe.TRUE}),l.checks.push({type:Pe.PARENT,parent:d,child:c}),mn(e,s,o),e.currentSubject=u,e.compoundCount++,c}else{var f=Qe(),h=Qe(),v=[{type:Pe.PARENT,parent:f,child:h}];return f.checks=t.checks,t.checks=v,e.compoundCount++,h}}},{name:"descendant",separator:!0,regex:qe.descendant,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),i=Qe(),a=e[e.length-1];return n.checks.push({type:Pe.DESCENDANT,ancestor:a,descendant:i}),mn(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),c=Qe(),d=Qe();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Pe.TRUE}],d.checks.push({type:Pe.TRUE}),l.checks.push({type:Pe.ANCESTOR,ancestor:d,descendant:c}),mn(e,s,o),e.currentSubject=u,e.compoundCount++,c}else{var f=Qe(),h=Qe(),v=[{type:Pe.ANCESTOR,ancestor:f,descendant:h}];return f.checks=t.checks,t.checks=v,e.compoundCount++,h}}},{name:"subject",modifier:!0,regex:qe.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return Ye("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===Pe.DIRECTED_EDGE?i.type=Pe.NODE_TARGET:a===Pe.UNDIRECTED_EDGE&&(i.type=Pe.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];Gl.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var PC=function(e){for(var t,n,i,a=0;a<Gl.length;a++){var o=Gl[a],s=o.name,l=e.match(o.regexObj);if(l!=null){n=l,t=o,i=s;var u=l[0];e=e.substring(u.length);break}}return{expr:t,match:n,name:i,remaining:e}},AC=function(e){var t=e.match(/^\s+/);if(t){var n=t[0];e=e.substring(n.length)}return e},BC=function(e){var t=this,n=t.inputText=e,i=t[0]=Qe();for(t.length=1,n=AC(n);;){var a=PC(n);if(a.expr==null)return Ye("The selector `"+e+"`is invalid"),!1;var o=a.match.slice(1),s=a.expr.populate(t,i,o);if(s===!1)return!1;if(s!=null&&(i=s),n=a.remaining,n.match(/^\s*$/))break}var l=t[t.length-1];t.currentSubject!=null&&(l.subject=t.currentSubject),l.edgeCount=t.edgeCount,l.compoundCount=t.compoundCount;for(var u=0;u<t.length;u++){var c=t[u];if(c.compoundCount>0&&c.edgeCount>0)return Ye("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Ye("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Ye("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},RC=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},t=function(c){return Be(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,d){var f=c.type,h=c.value;switch(f){case Pe.GROUP:{var v=e(h);return v.substring(0,v.length-1)}case Pe.DATA_COMPARE:{var m=c.field,p=c.operator;return"["+m+n(e(p))+t(h)+"]"}case Pe.DATA_BOOL:{var g=c.operator,y=c.field;return"["+e(g)+y+"]"}case Pe.DATA_EXIST:{var C=c.field;return"["+C+"]"}case Pe.META_COMPARE:{var x=c.operator,M=c.field;return"[["+M+n(e(x))+t(h)+"]]"}case Pe.STATE:return h;case Pe.ID:return"#"+h;case Pe.CLASS:return"."+h;case Pe.PARENT:case Pe.CHILD:return a(c.parent,d)+n(">")+a(c.child,d);case Pe.ANCESTOR:case Pe.DESCENDANT:return a(c.ancestor,d)+" "+a(c.descendant,d);case Pe.COMPOUND_SPLIT:{var P=a(c.left,d),D=a(c.subject,d),R=a(c.right,d);return P+(P.length>0?" ":"")+D+R}case Pe.TRUE:return""}},a=function(c,d){return c.checks.reduce(function(f,h,v){return f+(d===c&&v===0?"$":"")+i(h,d)},"")},o="",s=0;s<this.length;s++){var l=this[s];o+=a(l,l.subject),this.length>1&&s<this.length-1&&(o+=", ")}return this.toStringCache=o,o},IC={parse:BC,toString:RC},ah=function(e,t,n){var i,a=Be(e),o=Ce(e),s=Be(n),l,u,c=!1,d=!1,f=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(a||s||c)&&(l=!a&&!o?"":""+e,u=""+n),c&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),t){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=e===n;break;case">":f=!0,i=e>n;break;case">=":f=!0,i=e>=n;break;case"<":f=!0,i=e<n;break;case"<=":f=!0,i=e<=n;break;default:i=!1;break}return d&&(e!=null||!f)&&(i=!i),i},OC=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},FC=function(e){return e!==void 0},hu=function(e,t){return e.data(t)},LC=function(e,t){return e[t]()},ut=[],nt=function(e,t){return e.checks.every(function(n){return ut[n.type](n,t)})};ut[Pe.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};ut[Pe.STATE]=function(r,e){var t=r.value;return MC(t,e)};ut[Pe.ID]=function(r,e){var t=r.value;return e.id()===t};ut[Pe.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};ut[Pe.META_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return ah(LC(e,t),n,i)};ut[Pe.DATA_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return ah(hu(e,t),n,i)};ut[Pe.DATA_BOOL]=function(r,e){var t=r.field,n=r.operator;return OC(hu(e,t),n)};ut[Pe.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,FC(hu(e,t))};ut[Pe.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],n=r.nodes[1],i=e.source(),a=e.target();return nt(t,i)&&nt(n,a)||nt(n,i)&&nt(t,a)};ut[Pe.NODE_NEIGHBOR]=function(r,e){return nt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&nt(r.neighbor,t)})};ut[Pe.DIRECTED_EDGE]=function(r,e){return nt(r.source,e.source())&&nt(r.target,e.target())};ut[Pe.NODE_SOURCE]=function(r,e){return nt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&nt(r.target,t)})};ut[Pe.NODE_TARGET]=function(r,e){return nt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&nt(r.source,t)})};ut[Pe.CHILD]=function(r,e){return nt(r.child,e)&&nt(r.parent,e.parent())};ut[Pe.PARENT]=function(r,e){return nt(r.parent,e)&&e.children().some(function(t){return nt(r.child,t)})};ut[Pe.DESCENDANT]=function(r,e){return nt(r.descendant,e)&&e.ancestors().some(function(t){return nt(r.ancestor,t)})};ut[Pe.ANCESTOR]=function(r,e){return nt(r.ancestor,e)&&e.descendants().some(function(t){return nt(r.descendant,t)})};ut[Pe.COMPOUND_SPLIT]=function(r,e){return nt(r.subject,e)&&nt(r.left,e)&&nt(r.right,e)};ut[Pe.TRUE]=function(){return!0};ut[Pe.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};ut[Pe.FILTER]=function(r,e){var t=r.value;return t(e)};var VC=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===Pe.ID)return e.getElementById(t[0].checks[0].value).collection();var n=function(a){for(var o=0;o<t.length;o++){var s=t[o];if(nt(s,a))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)},NC=function(e){for(var t=this,n=0;n<t.length;n++){var i=t[n];if(nt(i,e))return!0}return!1},zC={matches:NC,filter:VC},Sn=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Be(e)&&e.match(/^\s*$/)||(ur(e)?this.addQuery({checks:[{type:Pe.COLLECTION,value:e.collection()}]}):lt(e)?this.addQuery({checks:[{type:Pe.FILTER,value:e}]}):Be(e)?this.parse(e)||(this.invalid=!0):st("A selector must be created from a string; found "))},Tn=Sn.prototype;[IC,zC].forEach(function(r){return Fe(Tn,r)});Tn.text=function(){return this.inputText};Tn.size=function(){return this.length};Tn.eq=function(r){return this[r]};Tn.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};Tn.addQuery=function(r){this[this.length++]=r};Tn.selector=Tn.toString;var wn={allAre:function(e){var t=new Sn(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new Sn(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,n=e.length;return t!==n?!1:t===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};wn.allAreNeighbours=wn.allAreNeighbors;wn.has=wn.contains;wn.equal=wn.equals=wn.same;var gr=function(e,t){return function(i,a,o,s){var l=i,u=this,c;if(l==null?c="":ur(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var d=u[0]._private,f=d.traversalCache=d.traversalCache||{},h=f[t]=f[t]||[],v=_n(c),m=h[v];return m||(h[v]=e.call(u,i,a,o,s))}else return e.call(u,i,a,o,s)}},ki={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],o=a._private.parent;o&&t.push(o)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];t.push(a)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var i=this[n],a=i.parents();t=t||a,t=t.intersect(a)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:gr(function(r){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function n(i){for(var a=0;a<i.length;a++){var o=i[a];t.push(o),o.children().nonempty()&&n(o.children())}}return n(this.children()),this.spawn(t,!0).filter(e)}};function vu(r,e,t,n){for(var i=[],a=new Mi,o=r.cy(),s=o.hasCompoundNodes(),l=0;l<r.length;l++){var u=r[l];t?i.push(u):s&&n(i,a,u)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),s&&n(i,a,c)}return r}function oh(r,e,t){if(t.isParent())for(var n=t._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||r.push(a)}}ki.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return vu(this,r,e,oh)};function sh(r,e,t){if(t.isChild()){var n=t._private.parent;e.has(n.id())||r.push(n)}}ki.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return vu(this,r,e,sh)};function jC(r,e,t){sh(r,e,t),oh(r,e,t)}ki.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return vu(this,r,e,jC)};ki.ancestors=ki.parents;var ma,lh;ma=lh={data:Xe.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Xe.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Xe.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Xe.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Xe.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Xe.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};ma.attr=ma.data;ma.removeAttr=ma.removeData;var $C=lh,Rs={};function kl(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var n=0,i=t[0],a=i._private.edges,o=0;o<a.length;o++){var s=a[o];!e&&s.isLoop()||(n+=r(i,s))}return n}else return}}Fe(Rs,{degree:kl(function(r,e){return e.source().same(e.target())?2:1}),indegree:kl(function(r,e){return e.target().same(r)?1:0}),outdegree:kl(function(r,e){return e.source().same(r)?1:0})});function hi(r,e){return function(t){for(var n,i=this.nodes(),a=0;a<i.length;a++){var o=i[a],s=o[r](t);s!==void 0&&(n===void 0||e(s,n))&&(n=s)}return n}}Fe(Rs,{minDegree:hi("degree",function(r,e){return r<e}),maxDegree:hi("degree",function(r,e){return r>e}),minIndegree:hi("indegree",function(r,e){return r<e}),maxIndegree:hi("indegree",function(r,e){return r>e}),minOutdegree:hi("outdegree",function(r,e){return r<e}),maxOutdegree:hi("outdegree",function(r,e){return r>e})});Fe(Rs,{totalDegree:function(e){for(var t=0,n=this.nodes(),i=0;i<n.length;i++)t+=n[i].degree(e);return t}});var kr,uh,ch=function(e,t,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var o=a._private.position,s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};a.isParent()&&!(s.x===0&&s.y===0)&&a.children().shift(s,n),a.dirtyBoundingBoxCache()}}},Td={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){ch(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};kr=uh={position:Xe.data(Td),silentPosition:Xe.data(Fe({},Td,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){ch(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(He(e))t?this.silentPosition(e):this.position(e);else if(lt(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var o=this[a],s=void 0;(s=n(o,a))&&(t?o.silentPosition(s):o.position(s))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var i;if(He(e)?(i={x:Ce(e.x)?e.x:0,y:Ce(e.y)?e.y:0},n=t):Be(e)&&Ce(t)&&(i={x:0,y:0},i[e]=t),i!=null){var a=this.cy();a.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(a.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var l=s.position(),u={x:l.x+i.x,y:l.y+i.y};n?s.silentPosition(u):s.position(u)}}a.endBatch()}return this},silentShift:function(e,t){return He(e)?this.shift(e,!0):Be(e)&&Ce(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],i=this.cy(),a=i.zoom(),o=i.pan(),s=He(e)?e:void 0,l=s!==void 0||t!==void 0&&Be(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];t!==void 0?c.position(e,(t-o[e])/a):s!==void 0&&c.position(Ff(s,a,o))}else{var d=n.position();return s=Ms(d,a,o),e===void 0?s:s[e]}else if(!l)return;return this},relativePosition:function(e,t){var n=this[0],i=this.cy(),a=He(e)?e:void 0,o=a!==void 0||t!==void 0&&Be(e),s=i.hasCompoundNodes();if(n&&n.isNode())if(o)for(var l=0;l<this.length;l++){var u=this[l],c=s?u.parent():null,d=c&&c.length>0,f=d;d&&(c=c[0]);var h=f?c.position():{x:0,y:0};t!==void 0?u.position(e,t+h[e]):a!==void 0&&u.position({x:a.x+h.x,y:a.y+h.y})}else{var v=n.position(),m=s?n.parent():null,p=m&&m.length>0,g=p;p&&(m=m[0]);var y=g?m.position():{x:0,y:0};return a={x:v.x-y.x,y:v.y-y.y},e===void 0?a:a[e]}else if(!o)return;return this}};kr.modelPosition=kr.point=kr.position;kr.modelPositions=kr.points=kr.positions;kr.renderedPoint=kr.renderedPosition;kr.relativePoint=kr.relativePosition;var GC=uh,_i,Pn;_i=Pn={};Pn.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),n=t.zoom(),i=t.pan(),a=e.x1*n+i.x,o=e.x2*n+i.x,s=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:o,y1:s,y2:l,w:o-a,h:l-s}};Pn.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var n=t._private;n.compoundBoundsClean=!1,n.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};Pn.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(o){if(!o.isParent())return;var s=o._private,l=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),f=s.position;(d.w===0||d.h===0)&&(d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},d.x1=f.x-d.w/2,d.x2=f.x+d.w/2,d.y1=f.y-d.h/2,d.y2=f.y+d.h/2);function h(A,F,O){var T=0,B=0,E=F+O;return A>0&&E>0&&(T=F/E*A,B=O/E*A),{biasDiff:T,biasComplementDiff:B}}function v(A,F,O,T){if(O.units==="%")switch(T){case"width":return A>0?O.pfValue*A:0;case"height":return F>0?O.pfValue*F:0;case"average":return A>0&&F>0?O.pfValue*(A+F)/2:0;case"min":return A>0&&F>0?A>F?O.pfValue*F:O.pfValue*A:0;case"max":return A>0&&F>0?A>F?O.pfValue*A:O.pfValue*F:0;default:return 0}else return O.units==="px"?O.pfValue:0}var m=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var p=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(p=p*100/c.width.val);var g=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(g=g*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var C=h(c.width.val-d.w,m,p),x=C.biasDiff,M=C.biasComplementDiff,P=h(c.height.val-d.h,g,y),D=P.biasDiff,R=P.biasComplementDiff;s.autoPadding=v(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(d.w,c.width.val),f.x=(-x+d.x1+d.x2+M)/2,s.autoHeight=Math.max(d.h,c.height.val),f.y=(-D+d.y1+d.y2+R)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||r)&&(t(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var pr=function(e){return e===1/0||e===-1/0?0:e},Sr=function(e,t,n,i,a){i-t===0||a-n===0||t==null||n==null||i==null||a==null||(e.x1=t<e.x1?t:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Nn=function(e,t){return t==null?e:Sr(e,t.x1,t.y1,t.x2,t.y2)},Yi=function(e,t,n){return Tr(e,t,n)},Yo=function(e,t,n){if(!t.cy().headless()){var i=t._private,a=i.rstyle,o=a.arrowWidth/2,s=t.pstyle(n+"-arrow-shape").value,l,u;if(s!=="none"){n==="source"?(l=a.srcX,u=a.srcY):n==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var c=i.arrowBounds=i.arrowBounds||{},d=c[n]=c[n]||{};d.x1=l-o,d.y1=u-o,d.x2=l+o,d.y2=u+o,d.w=d.x2-d.x1,d.h=d.y2-d.y1,is(d,1),Sr(e,d.x1,d.y1,d.x2,d.y2)}}},Ml=function(e,t,n){if(!t.cy().headless()){var i;n?i=n+"-":i="";var a=t._private,o=a.rstyle,s=t.pstyle(i+"label").strValue;if(s){var l=t.pstyle("text-halign"),u=t.pstyle("text-valign"),c=Yi(o,"labelWidth",n),d=Yi(o,"labelHeight",n),f=Yi(o,"labelX",n),h=Yi(o,"labelY",n),v=t.pstyle(i+"text-margin-x").pfValue,m=t.pstyle(i+"text-margin-y").pfValue,p=t.isEdge(),g=t.pstyle(i+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,C=t.pstyle("text-border-width").pfValue,x=C/2,M=t.pstyle("text-background-padding").pfValue,P=2,D=d,R=c,A=R/2,F=D/2,O,T,B,E;if(p)O=f-A,T=f+A,B=h-F,E=h+F;else{switch(l.value){case"left":O=f-R,T=f;break;case"center":O=f-A,T=f+A;break;case"right":O=f,T=f+R;break}switch(u.value){case"top":B=h-D,E=h;break;case"center":B=h-F,E=h+F;break;case"bottom":B=h,E=h+D;break}}var w=v-Math.max(y,x)-M-P,b=v+Math.max(y,x)+M+P,_=m-Math.max(y,x)-M-P,k=m+Math.max(y,x)+M+P;O+=w,T+=b,B+=_,E+=k;var S=n||"main",N=a.labelBounds,V=N[S]=N[S]||{};V.x1=O,V.y1=B,V.x2=T,V.y2=E,V.w=T-O,V.h=E-B,V.leftPad=w,V.rightPad=b,V.topPad=_,V.botPad=k;var z=p&&g.strValue==="autorotate",H=g.pfValue!=null&&g.pfValue!==0;if(z||H){var Y=z?Yi(a.rstyle,"labelAngle",n):g.pfValue,ee=Math.cos(Y),J=Math.sin(Y),ne=(O+T)/2,ie=(B+E)/2;if(!p){switch(l.value){case"left":ne=T;break;case"right":ne=O;break}switch(u.value){case"top":ie=E;break;case"bottom":ie=B;break}}var K=function(_e,fe){return _e=_e-ne,fe=fe-ie,{x:_e*ee-fe*J+ne,y:_e*J+fe*ee+ie}},L=K(O,B),j=K(O,E),$=K(T,B),U=K(T,E);O=Math.min(L.x,j.x,$.x,U.x),T=Math.max(L.x,j.x,$.x,U.x),B=Math.min(L.y,j.y,$.y,U.y),E=Math.max(L.y,j.y,$.y,U.y)}var X=S+"Rot",de=N[X]=N[X]||{};de.x1=O,de.y1=B,de.x2=T,de.y2=E,de.w=T-O,de.h=E-B,Sr(e,O,B,T,E),Sr(a.labelBounds.all,O,B,T,E)}return e}},qC=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,i=t.pstyle("outline-width").value;if(n>0&&i>0){var a=t.pstyle("outline-offset").value,o=t.pstyle("shape").value,s=i+a,l=(e.w+s*2)/e.w,u=(e.h+s*2)/e.h,c=0,d=0;["diamond","pentagon","round-triangle"].includes(o)?(l=(e.w+s*2.4)/e.w,d=-s/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(o)?l=(e.w+s*2.4)/e.w:o==="star"?(l=(e.w+s*2.8)/e.w,u=(e.h+s*2.6)/e.h,d=-s/3.8):o==="triangle"?(l=(e.w+s*2.8)/e.w,u=(e.h+s*2.4)/e.h,d=-s/1.4):o==="vee"&&(l=(e.w+s*4.4)/e.w,u=(e.h+s*3.8)/e.h,d=-s*.5);var f=e.h*u-e.h,h=e.w*l-e.w;if(as(e,[Math.ceil(f/2),Math.ceil(h/2)]),c!=0||d!==0){var v=d0(e,c,d);Vf(e,v)}}}},HC=function(e,t){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),o=rr(),s=e._private,l=e.isNode(),u=e.isEdge(),c,d,f,h,v,m,p=s.rstyle,g=l&&i?e.pstyle("bounds-expansion").pfValue:[0],y=function(Te){return Te.pstyle("display").value!=="none"},C=!i||y(e)&&(!u||y(e.source())&&y(e.target()));if(C){var x=0,M=0;i&&t.includeOverlays&&(x=e.pstyle("overlay-opacity").value,x!==0&&(M=e.pstyle("overlay-padding").value));var P=0,D=0;i&&t.includeUnderlays&&(P=e.pstyle("underlay-opacity").value,P!==0&&(D=e.pstyle("underlay-padding").value));var R=Math.max(M,D),A=0,F=0;if(i&&(A=e.pstyle("width").pfValue,F=A/2),l&&t.includeNodes){var O=e.position();v=O.x,m=O.y;var T=e.outerWidth(),B=T/2,E=e.outerHeight(),w=E/2;c=v-B,d=v+B,f=m-w,h=m+w,Sr(o,c,f,d,h),i&&t.includeOutlines&&qC(o,e)}else if(u&&t.includeEdges)if(i&&!a){var b=e.pstyle("curve-style").strValue;if(c=Math.min(p.srcX,p.midX,p.tgtX),d=Math.max(p.srcX,p.midX,p.tgtX),f=Math.min(p.srcY,p.midY,p.tgtY),h=Math.max(p.srcY,p.midY,p.tgtY),c-=F,d+=F,f-=F,h+=F,Sr(o,c,f,d,h),b==="haystack"){var _=p.haystackPts;if(_&&_.length===2){if(c=_[0].x,f=_[0].y,d=_[1].x,h=_[1].y,c>d){var k=c;c=d,d=k}if(f>h){var S=f;f=h,h=S}Sr(o,c-F,f-F,d+F,h+F)}}else if(b==="bezier"||b==="unbundled-bezier"||b.endsWith("segments")||b.endsWith("taxi")){var N;switch(b){case"bezier":case"unbundled-bezier":N=p.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":N=p.linePts;break}if(N!=null)for(var V=0;V<N.length;V++){var z=N[V];c=z.x-F,d=z.x+F,f=z.y-F,h=z.y+F,Sr(o,c,f,d,h)}}}else{var H=e.source(),Y=H.position(),ee=e.target(),J=ee.position();if(c=Y.x,d=J.x,f=Y.y,h=J.y,c>d){var ne=c;c=d,d=ne}if(f>h){var ie=f;f=h,h=ie}c-=F,d+=F,f-=F,h+=F,Sr(o,c,f,d,h)}if(i&&t.includeEdges&&u&&(Yo(o,e,"mid-source"),Yo(o,e,"mid-target"),Yo(o,e,"source"),Yo(o,e,"target")),i){var K=e.pstyle("ghost").value==="yes";if(K){var L=e.pstyle("ghost-offset-x").pfValue,j=e.pstyle("ghost-offset-y").pfValue;Sr(o,o.x1+L,o.y1+j,o.x2+L,o.y2+j)}}var $=s.bodyBounds=s.bodyBounds||{};ad($,o),as($,g),is($,1),i&&(c=o.x1,d=o.x2,f=o.y1,h=o.y2,Sr(o,c-R,f-R,d+R,h+R));var U=s.overlayBounds=s.overlayBounds||{};ad(U,o),as(U,g),is(U,1);var X=s.labelBounds=s.labelBounds||{};X.all!=null?c0(X.all):X.all=rr(),i&&t.includeLabels&&(t.includeMainLabels&&Ml(o,e,null),u&&(t.includeSourceLabels&&Ml(o,e,"source"),t.includeTargetLabels&&Ml(o,e,"target")))}return o.x1=pr(o.x1),o.y1=pr(o.y1),o.x2=pr(o.x2),o.y2=pr(o.y2),o.w=pr(o.x2-o.x1),o.h=pr(o.y2-o.y1),o.w>0&&o.h>0&&C&&(as(o,g),is(o,1)),o},dh=function(e){var t=0,n=function(o){return(o?1:0)<<t++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},fh=function(e){if(e.isEdge()){var t=e.source().position(),n=e.target().position(),i=function(o){return Math.round(o)};return Am([i(t.x),i(t.y),i(n.x),i(n.y)])}else return 0},kd=function(e,t){var n=e._private,i,a=e.isEdge(),o=t==null?Md:dh(t),s=o===Md,l=fh(e),u=n.bbCachePosKey===l,c=t.useCache&&u,d=function(m){return m._private.bbCache==null||m._private.styleDirty},f=!c||d(e)||a&&(d(e.source())||d(e.target()));if(f?(u||e.recalculateRenderedStyle(c),i=HC(e,ya),n.bbCache=i,n.bbCachePosKey=l):i=n.bbCache,!s){var h=e.isNode();i=rr(),(t.includeNodes&&h||t.includeEdges&&!h)&&(t.includeOverlays?Nn(i,n.overlayBounds):Nn(i,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?Nn(i,n.labelBounds.all):(t.includeMainLabels&&Nn(i,n.labelBounds.mainRot),t.includeSourceLabels&&Nn(i,n.labelBounds.sourceRot),t.includeTargetLabels&&Nn(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},ya={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},Md=dh(ya),Dd=Tt(ya);Pn.boundingBox=function(r){var e;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(r===void 0||r.useCache===void 0||r.useCache===!0))r===void 0?r=ya:r=Dd(r),e=kd(this[0],r);else{e=rr(),r=r||ya;var t=Dd(r),n=this,i=n.cy(),a=i.styleEnabled();if(a)for(var o=0;o<n.length;o++){var s=n[o],l=s._private,u=fh(s),c=l.bbCachePosKey===u,d=t.useCache&&c&&!l.styleDirty;s.recalculateRenderedStyle(d)}this.updateCompoundBounds(!r.useCache);for(var f=0;f<n.length;f++){var h=n[f];Nn(e,kd(h,t))}}return e.x1=pr(e.x1),e.y1=pr(e.y1),e.x2=pr(e.x2),e.y2=pr(e.y2),e.w=pr(e.x2-e.x1),e.h=pr(e.y2-e.y1),e};Pn.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Pn.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),n=t.hasCompoundNodes(),i=t.collection();if(n&&(i=e.filter(function(u){return u.isParent()}),e=e.not(i)),He(r)){var a=r;r=function(){return a}}var o=function(c,d){return c._private.bbAtOldPos=r(c,d)},s=function(c){return c._private.bbAtOldPos};t.startBatch(),e.forEach(o).silentPositions(r),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=u0(this.boundingBox({useCache:!1}));return e.silentPositions(s),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),t.endBatch(),l};_i.boundingbox=_i.bb=_i.boundingBox;_i.renderedBoundingbox=_i.renderedBoundingBox;var WC=Pn,ia,Ta;ia=Ta={};var hh=function(e){e.uppercaseName=Zc(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=Zc(e.outerName),ia[e.name]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var s=n.pstyle(e.name);switch(s.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return s.pfValue}}else return 1},ia["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,o=a._private.styleEnabled;if(n)if(o){var s=n[e.name](),l=n.pstyle("border-width").pfValue,u=2*n.padding();return s+l+u}else return 1},ia["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},ia["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};hh({name:"width"});hh({name:"height"});Ta.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};Ta.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};Ta.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var UC=Ta,KC=function(e,t){if(e.isEdge())return t(e)},XC=function(e,t){if(e.isEdge()){var n=e.cy();return Ms(t(e),n.zoom(),n.pan())}},YC=function(e,t){if(e.isEdge()){var n=e.cy(),i=n.pan(),a=n.zoom();return t(e).map(function(o){return Ms(o,a,i)})}},QC=function(e){return e.renderer().getControlPoints(e)},ZC=function(e){return e.renderer().getSegmentPoints(e)},JC=function(e){return e.renderer().getSourceEndpoint(e)},ew=function(e){return e.renderer().getTargetEndpoint(e)},tw=function(e){return e.renderer().getEdgeMidpoint(e)},Pd={controlPoints:{get:QC,mult:!0},segmentPoints:{get:ZC,mult:!0},sourceEndpoint:{get:JC},targetEndpoint:{get:ew},midpoint:{get:tw}},rw=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},nw=Object.keys(Pd).reduce(function(r,e){var t=Pd[e],n=rw(e);return r[e]=function(){return KC(this,t.get)},t.mult?r[n]=function(){return YC(this,t.get)}:r[n]=function(){return XC(this,t.get)},r},{}),iw=Fe({},GC,WC,UC,nw);var vh=function(e,t){this.recycle(e,t)};function Qi(){return!1}function Qo(){return!0}vh.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Qi,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Qo:Qi):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Qo;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Qo;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Qo,this.stopPropagation()},isDefaultPrevented:Qi,isPropagationStopped:Qi,isImmediatePropagationStopped:Qi};var ph=/^([^.]+)(\.(?:[^.]+))?$/,aw=".*",gh={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Ad=Object.keys(gh),ow={};function Is(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ow,e=arguments.length>1?arguments[1]:void 0,t=0;t<Ad.length;t++){var n=Ad[t];this[n]=r[n]||gh[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var kn=Is.prototype,mh=function(e,t,n,i,a,o,s){lt(i)&&(a=i,i=null),s&&(o==null?o=s:o=Fe({},o,s));for(var l=Ze(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!xn(c)){var d=c.match(ph);if(d){var f=d[1],h=d[2]?d[2]:null,v=t(e,c,f,h,i,a,o);if(v===!1)break}}}},Bd=function(e,t){return e.addEventFields(e.context,t),new vh(t.type,t)},sw=function(e,t,n){if(Mg(n)){t(e,n);return}else if(He(n)){t(e,Bd(e,n));return}for(var i=Ze(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var o=i[a];if(!xn(o)){var s=o.match(ph);if(s){var l=s[1],u=s[2]?s[2]:null,c=Bd(e,{type:l,namespace:u,target:e.context});t(e,c)}}}};kn.on=kn.addListener=function(r,e,t,n,i){return mh(this,function(a,o,s,l,u,c,d){lt(c)&&a.listeners.push({event:o,callback:c,type:s,namespace:l,qualifier:u,conf:d})},r,e,t,n,i),this};kn.one=function(r,e,t,n){return this.on(r,e,t,n,{one:!0})};kn.removeListener=kn.off=function(r,e,t,n){var i=this;this.emitting!==0&&(this.listeners=Fm(this.listeners));for(var a=this.listeners,o=function(u){var c=a[u];mh(i,function(d,f,h,v,m,p){if((c.type===h||r==="*")&&(!v&&c.namespace!==".*"||c.namespace===v)&&(!m||d.qualifierCompare(c.qualifier,m))&&(!p||c.callback===p))return a.splice(u,1),!1},r,e,t,n)},s=a.length-1;s>=0;s--)o(s);return this};kn.removeAllListeners=function(){return this.removeListener("*")};kn.emit=kn.trigger=function(r,e,t){var n=this.listeners,i=n.length;return this.emitting++,Ze(e)||(e=[e]),sw(this,function(a,o){t!=null&&(n=[{event:o.event,type:o.type,namespace:o.namespace,callback:t}],i=n.length);for(var s=function(c){var d=n[c];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===aw)&&a.eventMatches(a.context,d,o)){var f=[o];e!=null&&Vm(f,e),a.beforeEmit(a.context,d,o),d.conf&&d.conf.one&&(a.listeners=a.listeners.filter(function(m){return m!==d}));var h=a.callbackContext(a.context,d,o),v=d.callback.apply(h,f);a.afterEmit(a.context,d,o),v===!1&&(o.stopPropagation(),o.preventDefault())}},l=0;l<i;l++)s(l);a.bubble(a.context)&&!o.isPropagationStopped()&&a.parent(a.context).emit(o,e)},r),this.emitting--,this};var lw={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&xa(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Zo=function(e){return Be(e)?new Sn(e):e},yh={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new Is(lw,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var i=Zo(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n)}return this},removeListener:function(e,t,n){for(var i=Zo(t),a=0;a<this.length;a++){var o=this[a];o.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,n){for(var i=Zo(t),a=0;a<this.length;a++){var o=this[a];o.emitter().one(e,i,n)}return this},once:function(e,t,n){for(var i=Zo(t),a=0;a<this.length;a++){var o=this[a];o.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,t){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};Xe.eventAliasesOn(yh);var Ch={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):t.push(i)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(Be(e)||ur(e))return new Sn(e).filter(this);if(lt(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);s&&n.push(o)}return n}return this.spawn()},not:function(e){if(e){Be(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||t.push(i)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Be(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),i=this,a=e,o=this.length<e.length,s=o?i:a,l=o?a:i,u=0;u<s.length;u++){var c=s[u];l.has(c)&&n.push(c)}return n},xor:function(e){var t=this._private.cy;Be(e)&&(e=t.$(e));var n=this.spawn(),i=this,a=e,o=function(l,u){for(var c=0;c<l.length;c++){var d=l[c],f=d._private.data.id,h=u.hasElementWithId(f);h||n.push(d)}};return o(i,a),o(a,i),n},diff:function(e){var t=this._private.cy;Be(e)&&(e=t.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),o=this,s=e,l=function(c,d,f){for(var h=0;h<c.length;h++){var v=c[h],m=v._private.data.id,p=d.hasElementWithId(m);p?a.merge(v):f.push(v)}};return l(o,s,n),l(s,o,i),{left:n,right:i,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(Be(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var o=e[a],s=!this.has(o);s&&i.push(o)}return i},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&Be(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=t.map,o=0;o<e.length;o++){var s=e[o],l=s._private.data.id,u=!a.has(l);if(u){var c=this.length++;this[c]=s,a.set(l,{ele:s,index:c})}}return this},unmergeAt:function(e){var t=this[e],n=t.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1,l=this[s],u=l._private.data.id;this[s]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,i=t.map,a=i.get(n);if(!a)return this;var o=a.index;return this.unmergeAt(o),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&Be(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var n=this[t];e(n)&&this.unmergeAt(t)}return this},map:function(e,t){for(var n=[],i=this,a=0;a<i.length;a++){var o=i[a],s=t?e.apply(t,[o,a,i]):e(o,a,i);n.push(s)}return n},reduce:function(e,t){for(var n=t,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,t){for(var n=-1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],l=t?e.apply(t,[s,o,a]):e(s,o,a);l>n&&(n=l,i=s)}return{value:n,ele:i}},min:function(e,t){for(var n=1/0,i,a=this,o=0;o<a.length;o++){var s=a[o],l=t?e.apply(t,[s,o,a]):e(s,o,a);l<n&&(n=l,i=s)}return{value:n,ele:i}}},Ke=Ch;Ke.u=Ke["|"]=Ke["+"]=Ke.union=Ke.or=Ke.add;Ke["\\"]=Ke["!"]=Ke["-"]=Ke.difference=Ke.relativeComplement=Ke.subtract=Ke.not;Ke.n=Ke["&"]=Ke["."]=Ke.and=Ke.intersection=Ke.intersect;Ke["^"]=Ke["(+)"]=Ke["(-)"]=Ke.symmetricDifference=Ke.symdiff=Ke.xor;Ke.fnFilter=Ke.filterFn=Ke.stdFilter=Ke.filter;Ke.complement=Ke.abscomp=Ke.absoluteComplement;var uw={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},wh=function(e,t){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var d=c.pstyle("z-compound-depth");return d.value==="auto"?i?c.zDepth():0:d.value==="bottom"?-1:d.value==="top"?nu:0}var o=a(e)-a(t);if(o!==0)return o;function s(c){var d=c.pstyle("z-index-compare");return d.value==="auto"&&c.isNode()?1:0}var l=s(e)-s(t);if(l!==0)return l;var u=e.pstyle("z-index").value-t.pstyle("z-index").value;return u!==0?u:e.poolIndex()-t.poolIndex()},Cs={forEach:function(e,t){if(lt(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],o=t?e.apply(t,[a,i,this]):e(a,i,this);if(o===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],i=this.length;t==null&&(t=i),e==null&&(e=0),e<0&&(e=i+e),t<0&&(t=i+t);for(var a=e;a>=0&&a<t&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!lt(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(wh)},zDepth:function(){var e=this[0];if(e){var t=e._private,n=t.group;if(n==="nodes"){var i=t.data.parent?e.parents().size():0;return e.isParent()?i:nu-1}else{var a=t.source,o=t.target,s=a.zDepth(),l=o.zDepth();return Math.max(s,l,0)}}}};Cs.each=Cs.forEach;var cw=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":mt(Symbol))!=e&&mt(Symbol.iterator)!=e;t&&(Cs[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,o=this.length;return gf({next:function(){return a<o?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};cw();var dw=Tt({nodeDimensionsIncludeLabels:!1}),ss={layoutDimensions:function(e){e=dw(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,n){var i=this.nodes().filter(function(M){return!M.isParent()}),a=this.cy(),o=t.eles,s=function(P){return P.id()},l=ca(n,s);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(P,D,R){var A={x:D.x1+D.w/2,y:D.y1+D.h/2},F={x:(R.x-A.x)*P,y:(R.y-A.y)*P};return{x:A.x+F.x,y:A.y+F.y}},c=t.spacingFactor&&t.spacingFactor!==1,d=function(){if(!c)return null;for(var P=rr(),D=0;D<i.length;D++){var R=i[D],A=l(R,D);f0(P,A.x,A.y)}return P},f=d(),h=ca(function(M,P){var D=l(M,P);if(c){var R=Math.abs(t.spacingFactor);D=u(R,f,D)}return t.transform!=null&&(D=t.transform(M,D)),D},s);if(t.animate){for(var v=0;v<i.length;v++){var m=i[v],p=h(m,v),g=t.animateFilter==null||t.animateFilter(m,v);if(g){var y=m.animation({position:p,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else m.position(p)}if(t.fit){var C=a.animation({fit:{boundingBox:o.boundingBoxAt(h),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(C)}else if(t.zoom!==void 0&&t.pan!==void 0){var x=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(x)}e.animations.forEach(function(M){return M.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Di.all(e.animations.map(function(M){return M.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(h),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(Fe({},e,{eles:this}))}};ss.createLayout=ss.makeLayout=ss.layout;function bh(r,e,t){var n=t._private,i=n.styleCache=n.styleCache||[],a;return(a=i[r])!=null||(a=i[r]=e(t)),a}function Os(r,e){return r=_n(r),function(n){return bh(r,e,n)}}function Fs(r,e){r=_n(r);var t=function(i){return e.call(i)};return function(){var i=this[0];if(i)return bh(r,t,i)}}var Mt={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),i=t.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(t)}else this.forEach(function(i){t(i),i.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var n=t._private.batchStyleEles;return n.merge(this),this}var i=t.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=a;return e?o.emitAndNotify("style"):o.emit("style"),a.forEach(function(s){return s._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(t?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];if(n)return t.style().getRenderedStyle(n,e)},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(He(e)){var o=e;a.applyBypass(this,o,i),this.emitAndNotify("style")}else if(Be(e))if(t===void 0){var s=this[0];return s?a.getStylePropertyValue(s,e):void 0}else a.applyBypass(this,e,t,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,i=t.style(),a=this;if(e===void 0)for(var o=0;o<a.length;o++){var s=a[o];i.removeAllBypasses(s,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];i.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!t)return a;var o=i.data.parent?n.parents():null;if(o)for(var s=0;s<o.length;s++){var l=o[s],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],n=t.cy().hasCompoundNodes();if(t)return n?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function Dl(r,e){var t=r._private,n=t.data.parent?r.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function pu(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,n=r.parentOk||r.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],o=i.hasCompoundNodes();if(a){var s=a._private;if(!e(a))return!1;if(a.isNode())return!o||Dl(a,n);var l=s.source,u=s.target;return t(l)&&(!o||Dl(l,t))&&(l===u||t(u)&&(!o||Dl(u,t)))}}}var Ri=Os("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});Mt.takesUpSpace=Fs("takesUpSpace",pu({ok:Ri}));var fw=Os("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&Ri(r)}),hw=Os("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&Ri(r)});Mt.interactive=Fs("interactive",pu({ok:fw,parentOk:hw,edgeOkViaNode:Ri}));Mt.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var vw=Os("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&Ri(r)}),pw=Ri;Mt.visible=Fs("visible",pu({ok:vw,edgeOkViaNode:pw}));Mt.hidden=function(){var r=this[0];if(r)return!r.visible()};Mt.isBundledBezier=Fs("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});Mt.bypass=Mt.css=Mt.style;Mt.renderedCss=Mt.renderedStyle;Mt.removeBypass=Mt.removeCss=Mt.removeStyle;Mt.pstyle=Mt.parsedStyle;var bn={};function Rd(r){return function(){var e=arguments,t=[];if(e.length===2){var n=e[0],i=e[1];this.on(r.event,n,i)}else if(e.length===1&&lt(e[0])){var a=e[0];this.on(r.event,a)}else if(e.length===0||e.length===1&&Ze(e[0])){for(var o=e.length===1?e[0]:null,s=0;s<this.length;s++){var l=this[s],u=!r.ableField||l._private[r.ableField],c=l._private[r.field]!=r.value;if(r.overrideAble){var d=r.overrideAble(l);if(d!==void 0&&(u=d,!d))return this}u&&(l._private[r.field]=r.value,c&&t.push(l))}var f=this.spawn(t);f.updateStyle(),f.emit(r.event),o&&f.emit(o)}return this}}function Ii(r){bn[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},bn[r.on]=Rd({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),bn[r.off]=Rd({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Ii({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Ii({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Ii({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Ii({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});bn.deselect=bn.unselect;bn.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Ii({field:"active",on:"activate",off:"unactivate"});Ii({field:"pannable",on:"panify",off:"unpanify"});bn.inactive=function(){var r=this[0];if(r)return!r._private.active};var Lt={},Id=function(e){return function(n){for(var i=this,a=[],o=0;o<i.length;o++){var s=i[o];if(s.isNode()){for(var l=!1,u=s.connectedEdges(),c=0;c<u.length;c++){var d=u[c],f=d.source(),h=d.target();if(e.noIncomingEdges&&h===s&&f!==s||e.noOutgoingEdges&&f===s&&h!==s){l=!0;break}}l||a.push(s)}}return this.spawn(a,!0).filter(n)}},Od=function(e){return function(t){for(var n=this,i=[],a=0;a<n.length;a++){var o=n[a];if(o.isNode())for(var s=o.connectedEdges(),l=0;l<s.length;l++){var u=s[l],c=u.source(),d=u.target();e.outgoing&&c===o?(i.push(u),i.push(d)):e.incoming&&d===o&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(t)}},Fd=function(e){return function(t){for(var n=this,i=[],a={};;){var o=e.outgoing?n.outgoers():n.incomers();if(o.length===0)break;for(var s=!1,l=0;l<o.length;l++){var u=o[l],c=u.id();a[c]||(a[c]=!0,i.push(u),s=!0)}if(!s)break;n=o}return this.spawn(i,!0).filter(t)}};Lt.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Fe(Lt,{roots:Id({noIncomingEdges:!0}),leaves:Id({noOutgoingEdges:!0}),outgoers:gr(Od({outgoing:!0}),"outgoers"),successors:Fd({outgoing:!0}),incomers:gr(Od({incoming:!0}),"incomers"),predecessors:Fd({incoming:!0})});Fe(Lt,{neighborhood:gr(function(r){for(var e=[],t=this.nodes(),n=0;n<t.length;n++)for(var i=t[n],a=i.connectedEdges(),o=0;o<a.length;o++){var s=a[o],l=s.source(),u=s.target(),c=i===l?u:l;c.length>0&&e.push(c[0]),e.push(s[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Lt.neighbourhood=Lt.neighborhood;Lt.closedNeighbourhood=Lt.closedNeighborhood;Lt.openNeighbourhood=Lt.openNeighborhood;Fe(Lt,{source:gr(function(e){var t=this[0],n;return t&&(n=t._private.source||t.cy().collection()),n&&e?n.filter(e):n},"source"),target:gr(function(e){var t=this[0],n;return t&&(n=t._private.target||t.cy().collection()),n&&e?n.filter(e):n},"target"),sources:Ld({attr:"source"}),targets:Ld({attr:"target"})});function Ld(r){return function(t){for(var n=[],i=0;i<this.length;i++){var a=this[i],o=a._private[r.attr];o&&n.push(o)}return this.spawn(n,!0).filter(t)}}Fe(Lt,{edgesWith:gr(Vd(),"edgesWith"),edgesTo:gr(Vd({thisIsSrc:!0}),"edgesTo")});function Vd(r){return function(t){var n=[],i=this._private.cy,a=r||{};Be(t)&&(t=i.$(t));for(var o=0;o<t.length;o++)for(var s=t[o]._private.edges,l=0;l<s.length;l++){var u=s[l],c=u._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),f=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target),h=d||f;h&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!d||a.thisIsTgt&&!f)||n.push(u))}return this.spawn(n,!0)}}Fe(Lt,{connectedEdges:gr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];if(i.isNode())for(var a=i._private.edges,o=0;o<a.length;o++){var s=a[o];e.push(s)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:gr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:gr(Nd(),"parallelEdges"),codirectedEdges:gr(Nd({codirected:!0}),"codirectedEdges")});function Nd(r){var e={codirected:!1};return r=Fe({},e,r),function(n){for(var i=[],a=this.edges(),o=r,s=0;s<a.length;s++)for(var l=a[s],u=l._private,c=u.source,d=c._private.data.id,f=u.data.target,h=c._private.edges,v=0;v<h.length;v++){var m=h[v],p=m._private.data,g=p.target,y=p.source,C=g===f&&y===d,x=d===g&&f===y;(o.codirected&&C||!o.codirected&&(C||x))&&i.push(m)}return this.spawn(i,!0).filter(n)}}Fe(Lt,{components:function(e){var t=this,n=t.cy(),i=n.collection(),a=e==null?t.nodes():e.nodes(),o=[];e!=null&&a.empty()&&(a=e.sources());var s=function(c,d){i.merge(c),a.unmerge(c),d.merge(c)};if(a.empty())return t.spawn();var l=function(){var c=n.collection();o.push(c);var d=a[0];s(d,c),t.bfs({directed:!1,roots:d,visit:function(h){return s(h,c)}}),c.forEach(function(f){f.connectedEdges().forEach(function(h){t.has(h)&&c.has(h.source())&&c.has(h.target())&&c.merge(h)})})};do l();while(a.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Lt.componentsOf=Lt.components;var Dt=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){st("A collection must have a reference to the core");return}var a=new Hr,o=!1;if(!t)t=[];else if(t.length>0&&He(t[0])&&!xa(t[0])){o=!0;for(var s=[],l=new Mi,u=0,c=t.length;u<c;u++){var d=t[u];d.data==null&&(d.data={});var f=d.data;if(f.id==null)f.id=If();else if(e.hasElementWithId(f.id)||l.has(f.id))continue;var h=new ks(e,d,!1);s.push(h),l.add(f.id)}t=s}this.length=0;for(var v=0,m=t.length;v<m;v++){var p=t[v][0];if(p!=null){var g=p._private.data.id;(!n||!a.has(g))&&(n&&a.set(g,{index:this.length,ele:p}),this[this.length]=p,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var C=this.lazyMap=new Hr,x=this.eles,M=0;M<x.length;M++){var P=x[M];C.set(P.id(),{index:M,ele:P})}}},n&&(this._private.map=a),o&&!i&&this.restore()},tt=ks.prototype=Dt.prototype=Object.create(Array.prototype);tt.instanceString=function(){return"collection"};tt.spawn=function(r,e){return new Dt(this.cy(),r,e)};tt.spawnSelf=function(){return this.spawn(this)};tt.cy=function(){return this._private.cy};tt.renderer=function(){return this._private.cy.renderer()};tt.element=function(){return this[0]};tt.collection=function(){return Cf(this)?this:new Dt(this._private.cy,[this])};tt.unique=function(){return new Dt(this._private.cy,this,!0)};tt.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};tt.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new Dt(e)};tt.$id=tt.getElementById;tt.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};tt.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};tt.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};tt.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var n=e._private;if(He(r)){if(t.startBatch(),r.data){e.data(r.data);var i=n.data;if(e.isEdge()){var a=!1,o={},s=r.data.source,l=r.data.target;s!=null&&s!=i.source&&(o.source=""+s,a=!0),l!=null&&l!=i.target&&(o.target=""+l,a=!0),a&&(e=e.move(o))}else{var u="parent"in r.data,c=r.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}r.position&&e.position(r.position);var d=function(m,p,g){var y=r[m];y!=null&&y!==n[m]&&(y?e[p]():e[g]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var f={data:qr(n.data),position:qr(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};f.classes="";var h=0;return n.classes.forEach(function(v){return f.classes+=h++===0?v:" "+v}),f}}};tt.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],n=t.json();r.push(n)}return r};tt.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var n=this[t],i=n.json(),a=new ks(r,i,!1);e.push(a)}return new Dt(r,e)};tt.copy=tt.clone;tt.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=t.cy(),i=n._private,a=[],o=[],s,l=0,u=t.length;l<u;l++){var c=t[l];e&&!c.removed()||(c.isNode()?a.push(c):o.push(c))}s=a.concat(o);var d,f=function(){s.splice(d,1),d--};for(d=0;d<s.length;d++){var h=s[d],v=h._private,m=v.data;if(h.clearTraversalCache(),!(!e&&!v.removed)){if(m.id===void 0)m.id=If();else if(Ce(m.id))m.id=""+m.id;else if(xn(m.id)||!Be(m.id)){st("Can not create element with invalid string ID `"+m.id+"`"),f();continue}else if(n.hasElementWithId(m.id)){st("Can not create second element with ID `"+m.id+"`"),f();continue}}var p=m.id;if(h.isNode()){var g=v.position;g.x==null&&(g.x=0),g.y==null&&(g.y=0)}if(h.isEdge()){for(var y=h,C=["source","target"],x=C.length,M=!1,P=0;P<x;P++){var D=C[P],R=m[D];Ce(R)&&(R=m[D]=""+m[D]),R==null||R===""?(st("Can not create edge `"+p+"` with unspecified "+D),M=!0):n.hasElementWithId(R)||(st("Can not create edge `"+p+"` with nonexistant "+D+" `"+R+"`"),M=!0)}if(M){f();continue}var A=n.getElementById(m.source),F=n.getElementById(m.target);A.same(F)?A._private.edges.push(y):(A._private.edges.push(y),F._private.edges.push(y)),y._private.source=A,y._private.target=F}v.map=new Hr,v.map.set(p,{ele:h,index:0}),v.removed=!1,e&&n.addToPool(h)}for(var O=0;O<a.length;O++){var T=a[O],B=T._private.data;Ce(B.parent)&&(B.parent=""+B.parent);var E=B.parent,w=E!=null;if(w||T._private.parent){var b=T._private.parent?n.collection().merge(T._private.parent):n.getElementById(E);if(b.empty())B.parent=void 0;else if(b[0].removed())Ye("Node added with missing parent, reference to parent removed"),B.parent=void 0,T._private.parent=null;else{for(var _=!1,k=b;!k.empty();){if(T.same(k)){_=!0,B.parent=void 0;break}k=k.parent()}_||(b[0]._private.children.push(T),T._private.parent=b[0],i.hasCompoundNodes=!0)}}}if(s.length>0){for(var S=s.length===t.length?t:new Dt(n,s),N=0;N<S.length;N++){var V=S[N];V.isNode()||(V.parallelEdges().clearTraversalCache(),V.source().clearTraversalCache(),V.target().clearTraversalCache())}var z;i.hasCompoundNodes?z=n.collection().merge(S).merge(S.connectedNodes()).merge(S.parent()):z=S,z.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?S.emitAndNotify("add"):e&&S.emit("add")}return t};tt.removed=function(){var r=this[0];return r&&r._private.removed};tt.inside=function(){var r=this[0];return r&&!r._private.removed};tt.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=[],i={},a=t._private.cy;function o(E){for(var w=E._private.edges,b=0;b<w.length;b++)l(w[b])}function s(E){for(var w=E._private.children,b=0;b<w.length;b++)l(w[b])}function l(E){var w=i[E.id()];e&&E.removed()||w||(i[E.id()]=!0,E.isNode()?(n.push(E),o(E),s(E)):n.unshift(E))}for(var u=0,c=t.length;u<c;u++){var d=t[u];l(d)}function f(E,w){var b=E._private.edges;En(b,w),E.clearTraversalCache()}function h(E){E.clearTraversalCache()}var v=[];v.ids={};function m(E,w){w=w[0],E=E[0];var b=E._private.children,_=E.id();En(b,w),w._private.parent=null,v.ids[_]||(v.ids[_]=!0,v.push(E))}t.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var p=0;p<n.length;p++){var g=n[p];if(g.isEdge()){var y=g.source()[0],C=g.target()[0];f(y,g),f(C,g);for(var x=g.parallelEdges(),M=0;M<x.length;M++){var P=x[M];h(P),P.isBundledBezier()&&P.dirtyBoundingBoxCache()}}else{var D=g.parent();D.length!==0&&m(D,g)}e&&(g._private.removed=!0)}var R=a._private.elements;a._private.hasCompoundNodes=!1;for(var A=0;A<R.length;A++){var F=R[A];if(F.isParent()){a._private.hasCompoundNodes=!0;break}}var O=new Dt(this.cy(),n);O.size()>0&&(r?O.emitAndNotify("remove"):e&&O.emit("remove"));for(var T=0;T<v.length;T++){var B=v[T];(!e||!B.removed())&&B.updateStyle()}return O};tt.move=function(r){var e=this._private.cy,t=this,n=!1,i=!1,a=function(v){return v==null?v:""+v};if(r.source!==void 0||r.target!==void 0){var o=a(r.source),s=a(r.target),l=o!=null&&e.hasElementWithId(o),u=s!=null&&e.hasElementWithId(s);(l||u)&&(e.batch(function(){t.remove(n,i),t.emitAndNotify("moveout");for(var h=0;h<t.length;h++){var v=t[h],m=v._private.data;v.isEdge()&&(l&&(m.source=o),u&&(m.target=s))}t.restore(n,i)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var c=a(r.parent),d=c===null||e.hasElementWithId(c);if(d){var f=c===null?void 0:c;e.batch(function(){var h=t.remove(n,i);h.emitAndNotify("moveout");for(var v=0;v<t.length;v++){var m=t[v],p=m._private.data;m.isNode()&&(p.parent=f)}h.restore(n,i)}),t.emitAndNotify("move")}}return this};[Uf,TC,os,wn,ki,$C,Rs,iw,yh,Ch,uw,Cs,ss,Mt,bn,Lt].forEach(function(r){Fe(tt,r)});var gw={add:function(e){var t,n=this;if(ur(e)){var i=e;if(i._private.cy===n)t=i.restore();else{for(var a=[],o=0;o<i.length;o++){var s=i[o];a.push(s.json())}t=new Dt(n,a)}}else if(Ze(e)){var l=e;t=new Dt(n,l)}else if(He(e)&&(Ze(e.nodes)||Ze(e.edges))){for(var u=e,c=[],d=["nodes","edges"],f=0,h=d.length;f<h;f++){var v=d[f],m=u[v];if(Ze(m))for(var p=0,g=m.length;p<g;p++){var y=Fe({group:v},m[p]);c.push(y)}}t=new Dt(n,c)}else{var C=e;t=new ks(n,C).collection()}return t},remove:function(e){if(!ur(e)){if(Be(e)){var t=e;e=this.$(t)}}return e.remove()}};function mw(r,e,t,n){var i=4,a=.001,o=1e-7,s=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var f=c?new Float32Array(l):new Array(l);function h(F,O){return 1-3*O+3*F}function v(F,O){return 3*O-6*F}function m(F){return 3*F}function p(F,O,T){return((h(O,T)*F+v(O,T))*F+m(O))*F}function g(F,O,T){return 3*h(O,T)*F*F+2*v(O,T)*F+m(O)}function y(F,O){for(var T=0;T<i;++T){var B=g(O,r,t);if(B===0)return O;var E=p(O,r,t)-F;O-=E/B}return O}function C(){for(var F=0;F<l;++F)f[F]=p(F*u,r,t)}function x(F,O,T){var B,E,w=0;do E=O+(T-O)/2,B=p(E,r,t)-F,B>0?T=E:O=E;while(Math.abs(B)>o&&++w<s);return E}function M(F){for(var O=0,T=1,B=l-1;T!==B&&f[T]<=F;++T)O+=u;--T;var E=(F-f[T])/(f[T+1]-f[T]),w=O+E*u,b=g(w,r,t);return b>=a?y(F,w):b===0?w:x(F,O,O+u)}var P=!1;function D(){P=!0,(r!==e||t!==n)&&C()}var R=function(O){return P||D(),r===e&&t===n?O:O===0?0:O===1?1:p(M(O),e,n)};R.getControlPoints=function(){return[{x:r,y:e},{x:t,y:n}]};var A="generateBezier("+[r,e,t,n]+")";return R.toString=function(){return A},R}var yw=function(){function r(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var o={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:o.v,dv:r(o)}}function t(n,i){var a={dx:n.v,dv:r(n)},o=e(n,i*.5,a),s=e(n,i*.5,o),l=e(n,i,s),u=1/6*(a.dx+2*(o.dx+s.dx)+l.dx),c=1/6*(a.dv+2*(o.dv+s.dv)+l.dv);return n.x=n.x+u*i,n.v=n.v+c*i,n}return function n(i,a,o){var s={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,d=16/1e3,f,h,v;for(i=parseFloat(i)||500,a=parseFloat(a)||20,o=o||null,s.tension=i,s.friction=a,f=o!==null,f?(u=n(i,a),h=u/o*d):h=d;v=t(v||s,h),l.push(1+v.x),u+=16,Math.abs(v.x)>c&&Math.abs(v.v)>c;);return f?function(m){return l[m*(l.length-1)|0]}:u}}(),et=function(e,t,n,i){var a=mw(e,t,n,i);return function(o,s,l){return o+(s-o)*a(l)}},ls={linear:function(e,t,n){return e+(t-e)*n},ease:et(.25,.1,.25,1),"ease-in":et(.42,0,1,1),"ease-out":et(0,0,.58,1),"ease-in-out":et(.42,0,.58,1),"ease-in-sine":et(.47,0,.745,.715),"ease-out-sine":et(.39,.575,.565,1),"ease-in-out-sine":et(.445,.05,.55,.95),"ease-in-quad":et(.55,.085,.68,.53),"ease-out-quad":et(.25,.46,.45,.94),"ease-in-out-quad":et(.455,.03,.515,.955),"ease-in-cubic":et(.55,.055,.675,.19),"ease-out-cubic":et(.215,.61,.355,1),"ease-in-out-cubic":et(.645,.045,.355,1),"ease-in-quart":et(.895,.03,.685,.22),"ease-out-quart":et(.165,.84,.44,1),"ease-in-out-quart":et(.77,0,.175,1),"ease-in-quint":et(.755,.05,.855,.06),"ease-out-quint":et(.23,1,.32,1),"ease-in-out-quint":et(.86,0,.07,1),"ease-in-expo":et(.95,.05,.795,.035),"ease-out-expo":et(.19,1,.22,1),"ease-in-out-expo":et(1,0,0,1),"ease-in-circ":et(.6,.04,.98,.335),"ease-out-circ":et(.075,.82,.165,1),"ease-in-out-circ":et(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return ls.linear;var i=yw(e,t,n);return function(a,o,s){return a+(o-a)*i(s)}},"cubic-bezier":et};function zd(r,e,t,n,i){if(n===1||e===t)return t;var a=i(e,t,n);return r==null||((r.roundValue||r.color)&&(a=Math.round(a)),r.min!==void 0&&(a=Math.max(a,r.min)),r.max!==void 0&&(a=Math.min(a,r.max))),a}function jd(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function vi(r,e,t,n,i){var a=i!=null?i.type:null;t<0?t=0:t>1&&(t=1);var o=jd(r,i),s=jd(e,i);if(Ce(o)&&Ce(s))return zd(a,o,s,t,n);if(Ze(o)&&Ze(s)){for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u];if(c!=null&&d!=null){var f=zd(a,c,d,t,n);l.push(f)}else l.push(d)}return l}}function Cw(r,e,t,n){var i=!n,a=r._private,o=e._private,s=o.easing,l=o.startTime,u=n?r:r.cy(),c=u.style();if(!o.easingImpl)if(s==null)o.easingImpl=ls.linear;else{var d;if(Be(s)){var f=c.parse("transition-timing-function",s);d=f.value}else d=s;var h,v;Be(d)?(h=d,v=[]):(h=d[1],v=d.slice(2).map(function(S){return+S})),v.length>0?(h==="spring"&&v.push(o.duration),o.easingImpl=ls[h].apply(null,v)):o.easingImpl=ls[h]}var m=o.easingImpl,p;if(o.duration===0?p=1:p=(t-l)/o.duration,o.applying&&(p=o.progress),p<0?p=0:p>1&&(p=1),o.delay==null){var g=o.startPosition,y=o.position;if(y&&i&&!r.locked()){var C={};Zi(g.x,y.x)&&(C.x=vi(g.x,y.x,p,m)),Zi(g.y,y.y)&&(C.y=vi(g.y,y.y,p,m)),r.position(C)}var x=o.startPan,M=o.pan,P=a.pan,D=M!=null&&n;D&&(Zi(x.x,M.x)&&(P.x=vi(x.x,M.x,p,m)),Zi(x.y,M.y)&&(P.y=vi(x.y,M.y,p,m)),r.emit("pan"));var R=o.startZoom,A=o.zoom,F=A!=null&&n;F&&(Zi(R,A)&&(a.zoom=va(a.minZoom,vi(R,A,p,m),a.maxZoom)),r.emit("zoom")),(D||F)&&r.emit("viewport");var O=o.style;if(O&&O.length>0&&i){for(var T=0;T<O.length;T++){var B=O[T],E=B.name,w=B,b=o.startStyle[E],_=c.properties[b.name],k=vi(b,w,p,m,_);c.overrideBypass(r,E,k)}r.emit("style")}}return o.progress=p,p}function Zi(r,e){return r==null||e==null?!1:Ce(r)&&Ce(e)?!0:!!(r&&e)}function ww(r,e,t,n){var i=e._private;i.started=!0,i.startTime=t-i.progress*i.duration}function $d(r,e){var t=e._private.aniEles,n=[];function i(c,d){var f=c._private,h=f.animation.current,v=f.animation.queue,m=!1;if(h.length===0){var p=v.shift();p&&h.push(p)}for(var g=function(P){for(var D=P.length-1;D>=0;D--){var R=P[D];R()}P.splice(0,P.length)},y=h.length-1;y>=0;y--){var C=h[y],x=C._private;if(x.stopped){h.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,g(x.frames);continue}!x.playing&&!x.applying||(x.playing&&x.applying&&(x.applying=!1),x.started||ww(c,C,r),Cw(c,C,r,d),x.applying&&(x.applying=!1),g(x.frames),x.step!=null&&x.step(r),C.completed()&&(h.splice(y,1),x.hooked=!1,x.playing=!1,x.started=!1,g(x.completes)),m=!0)}return!d&&h.length===0&&v.length===0&&n.push(c),m}for(var a=!1,o=0;o<t.length;o++){var s=t[o],l=i(s);a=a||l}var u=i(e,!0);(a||u)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(n),e.emit("step")}var bw={animate:Xe.animate(),animation:Xe.animation(),animated:Xe.animated(),clearQueue:Xe.clearQueue(),delay:Xe.delay(),delayAnimation:Xe.delayAnimation(),stop:Xe.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){e._private.animationsRunning&&vs(function(a){$d(a,e),t()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,o){$d(o,e)},n.beforeRenderPriorities.animations):t()}},xw={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&xa(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},Jo=function(e){return Be(e)?new Sn(e):e},xh={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new Is(xw,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,Jo(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,Jo(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,Jo(t),n),this},once:function(e,t,n){return this.emitter().one(e,Jo(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Xe.eventAliasesOn(xh);var ql={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};ql.jpeg=ql.jpg;var us={layout:function(e){var t=this;if(e==null){st("Layout options must be specified to make a layout");return}if(e.name==null){st("A `name` must be specified to make a layout");return}var n=e.name,i=t.extension("layout",n);if(i==null){st("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Be(e.eles)?a=t.$(e.eles):a=e.eles!=null?e.eles:t.$();var o=new i(Fe({},e,{cy:t,eles:a}));return o}};us.createLayout=us.makeLayout=us.layout;var _w={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&i.merge(t);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?t.notify(n):t.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],o=e[a],s=t.getElementById(a);s.data(o)}})}},Ew=Tt({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:12,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),Hl={renderTo:function(e,t,n,i){var a=this._private.renderer;return a.renderTo(e,t,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n==null){st("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Ye("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=Ew(e);i.cy=t,t._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Hl.invalidateDimensions=Hl.resize;var cs={collection:function(e,t){return Be(e)?this.$(e):ur(e)?e.collection():Ze(e)?(t||(t={}),new Dt(this,e,t.unique,t.removed)):new Dt(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};cs.elements=cs.filter=cs.$;var Nt={},oa="t",Sw="f";Nt.apply=function(r){for(var e=this,t=e._private,n=t.cy,i=n.collection(),a=0;a<r.length;a++){var o=r[a],s=e.getContextMeta(o);if(!s.empty){var l=e.getContextStyle(s),u=e.applyContextStyle(s,l,o);o._private.appliedInitStyle?e.updateTransitions(o,u.diffProps):o._private.appliedInitStyle=!0;var c=e.updateStyleHints(o);c&&i.push(o)}}return i};Nt.getPropertiesDiff=function(r,e){var t=this,n=t._private.propDiffs=t._private.propDiffs||{},i=r+"-"+e,a=n[i];if(a)return a;for(var o=[],s={},l=0;l<t.length;l++){var u=t[l],c=r[l]===oa,d=e[l]===oa,f=c!==d,h=u.mappedProperties.length>0;if(f||d&&h){var v=void 0;f&&h||f?v=u.properties:h&&(v=u.mappedProperties);for(var m=0;m<v.length;m++){for(var p=v[m],g=p.name,y=!1,C=l+1;C<t.length;C++){var x=t[C],M=e[C]===oa;if(M&&(y=x.properties[p.name]!=null,y))break}!s[g]&&!y&&(s[g]=!0,o.push(g))}}}return n[i]=o,o};Nt.getContextMeta=function(r){for(var e=this,t="",n,i=r._private.styleCxtKey||"",a=0;a<e.length;a++){var o=e[a],s=o.selector&&o.selector.matches(r);s?t+=oa:t+=Sw}return n=e.getPropertiesDiff(i,t),r._private.styleCxtKey=t,{key:t,diffPropNames:n,empty:n.length===0}};Nt.getContextStyle=function(r){var e=r.key,t=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<t.length;a++){var o=t[a],s=e[a]===oa;if(s)for(var l=0;l<o.properties.length;l++){var u=o.properties[l];i[u.name]=u}}return n[e]=i,i};Nt.applyContextStyle=function(r,e,t){for(var n=this,i=r.diffPropNames,a={},o=n.types,s=0;s<i.length;s++){var l=i[s],u=e[l],c=t.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===o.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var d=c.mapping,f=d.fnValue=u.value(t);if(f===d.prevFnValue)continue}var h=a[l]={prev:c};n.applyParsedProperty(t,u),h.next=t.pstyle(l),h.next&&h.next.bypass&&(h.next=h.next.bypassed)}}return{diffProps:a}};Nt.updateStyleHints=function(r){var e=r._private,t=this,n=t.propertyGroupNames,i=t.propertyGroupKeys,a=function(j,$,U){return t.getPropertiesHash(j,$,U)},o=e.styleKey;if(r.removed())return!1;var s=e.group==="nodes",l=r._private.style;n=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];e.styleKeys[c]=[mi,ra]}for(var d=function(j,$){return e.styleKeys[$][0]=da(j,e.styleKeys[$][0])},f=function(j,$){return e.styleKeys[$][1]=fa(j,e.styleKeys[$][1])},h=function(j,$){d(j,$),f(j,$)},v=function(j,$){for(var U=0;U<j.length;U++){var X=j.charCodeAt(U);d(X,$),f(X,$)}},m=2e9,p=function(j){return-128<j&&j<128&&Math.floor(j)!==j?m-(j*1024|0):j},g=0;g<n.length;g++){var y=n[g],C=l[y];if(C!=null){var x=this.properties[y],M=x.type,P=x.groupKey,D=void 0;x.hashOverride!=null?D=x.hashOverride(r,C):C.pfValue!=null&&(D=C.pfValue);var R=x.enums==null?C.value:null,A=D!=null,F=R!=null,O=A||F,T=C.units;if(M.number&&O&&!M.multiple){var B=A?D:R;h(p(B),P),!A&&T!=null&&v(T,P)}else v(C.strValue,P)}}for(var E=[mi,ra],w=0;w<i.length;w++){var b=i[w],_=e.styleKeys[b];E[0]=da(_[0],E[0]),E[1]=fa(_[1],E[1])}e.styleKey=Pm(E[0],E[1]);var k=e.styleKeys;e.labelDimsKey=gn(k.labelDimensions);var S=a(r,["label"],k.labelDimensions);if(e.labelKey=gn(S),e.labelStyleKey=gn(qo(k.commonLabel,S)),!s){var N=a(r,["source-label"],k.labelDimensions);e.sourceLabelKey=gn(N),e.sourceLabelStyleKey=gn(qo(k.commonLabel,N));var V=a(r,["target-label"],k.labelDimensions);e.targetLabelKey=gn(V),e.targetLabelStyleKey=gn(qo(k.commonLabel,V))}if(s){var z=e.styleKeys,H=z.nodeBody,Y=z.nodeBorder,ee=z.nodeOutline,J=z.backgroundImage,ne=z.compound,ie=z.pie,K=[H,Y,ee,J,ne,ie].filter(function(L){return L!=null}).reduce(qo,[mi,ra]);e.nodeKey=gn(K),e.hasPie=ie!=null&&ie[0]!==mi&&ie[1]!==ra}return o!==e.styleKey};Nt.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null};Nt.applyParsedProperty=function(r,e){var t=this,n=e,i=r._private.style,a,o=t.types,s=t.properties[n.name].type,l=n.bypass,u=i[n.name],c=u&&u.bypass,d=r._private,f="mapping",h=function(H){return H==null?null:H.pfValue!=null?H.pfValue:H.value},v=function(){var H=h(u),Y=h(n);t.checkTriggers(r,n.name,H,Y)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,v(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,v(),!0):!1:(v(),!0);if(n.deleteBypass)return u?u.bypass?(i[n.name]=u.bypassed,v(),!0):!1:(v(),!0);var m=function(){Ye("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case o.mapData:{for(var p=n.field.split("."),g=d.data,y=0;y<p.length&&g;y++){var C=p[y];g=g[C]}if(g==null)return m(),!1;var x;if(Ce(g)){var M=n.fieldMax-n.fieldMin;M===0?x=0:x=(g-n.fieldMin)/M}else return Ye("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+g+"` for `"+r.id()+"` is non-numeric)"),!1;if(x<0?x=0:x>1&&(x=1),s.color){var P=n.valueMin[0],D=n.valueMax[0],R=n.valueMin[1],A=n.valueMax[1],F=n.valueMin[2],O=n.valueMax[2],T=n.valueMin[3]==null?1:n.valueMin[3],B=n.valueMax[3]==null?1:n.valueMax[3],E=[Math.round(P+(D-P)*x),Math.round(R+(A-R)*x),Math.round(F+(O-F)*x),Math.round(T+(B-T)*x)];a={bypass:n.bypass,name:n.name,value:E,strValue:"rgb("+E[0]+", "+E[1]+", "+E[2]+")"}}else if(s.number){var w=n.valueMin+(n.valueMax-n.valueMin)*x;a=this.parse(n.name,w,n.bypass,f)}else return!1;if(!a)return m(),!1;a.mapping=n,n=a;break}case o.data:{for(var b=n.field.split("."),_=d.data,k=0;k<b.length&&_;k++){var S=b[k];_=_[S]}if(_!=null&&(a=this.parse(n.name,_,n.bypass,f)),!a)return m(),!1;a.mapping=n,n=a;break}case o.fn:{var N=n.value,V=n.fnValue!=null?n.fnValue:N(r);if(n.prevFnValue=V,V==null)return Ye("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+r.id()+"` is null)"),!1;if(a=this.parse(n.name,V,n.bypass,f),!a)return Ye("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+r.id()+"` is invalid)"),!1;a.mapping=qr(n),n=a;break}case void 0:break;default:return!1}return l?(c?n.bypassed=u.bypassed:n.bypassed=u,i[n.name]=n):c?u.bypassed=n:i[n.name]=n,v(),!0};Nt.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),o=0;o<a.length;o++){var s=a[o],l=i[s];l!=null&&(l.bypass?l.bypassed=null:i[s]=null)}}};Nt.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};Nt.updateTransitions=function(r,e){var t=this,n=r._private,i=r.pstyle("transition-property").value,a=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var s={},l=!1,u=0;u<i.length;u++){var c=i[u],d=r.pstyle(c),f=e[c];if(f){var h=f.prev,v=h,m=f.next!=null?f.next:d,p=!1,g=void 0,y=1e-6;v&&(Ce(v.pfValue)&&Ce(m.pfValue)?(p=m.pfValue-v.pfValue,g=v.pfValue+y*p):Ce(v.value)&&Ce(m.value)?(p=m.value-v.value,g=v.value+y*p):Ze(v.value)&&Ze(m.value)&&(p=v.value[0]!==m.value[0]||v.value[1]!==m.value[1]||v.value[2]!==m.value[2],g=v.strValue),p&&(s[c]=m.strValue,this.applyBypass(r,c,g),l=!0))}}if(!l)return;n.transitioning=!0,new Di(function(C){o>0?r.delayAnimation(o).play().promise().then(C):C()}).then(function(){return r.animation({style:s,duration:a,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1)};Nt.checkTrigger=function(r,e,t,n,i,a){var o=this.properties[e],s=i(o);s!=null&&s(t,n)&&a(o)};Nt.checkZOrderTrigger=function(r,e,t,n){var i=this;this.checkTrigger(r,e,t,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",r)})};Nt.checkBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBounds},function(i){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),i.triggersBoundsOfParallelBeziers&&e==="curve-style"&&(t==="bezier"||n==="bezier")&&r.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()}),i.triggersBoundsOfConnectedEdges&&e==="display"&&(t==="none"||n==="none")&&r.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};Nt.checkTriggers=function(r,e,t,n){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,n),this.checkBoundsTrigger(r,e,t,n)};var ka={};ka.applyBypass=function(r,e,t,n){var i=this,a=[],o=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var s=0;s<i.properties.length;s++){var l=i.properties[s],u=l.name,c=this.parse(u,t,!0);c&&a.push(c)}}else if(Be(e)){var d=this.parse(e,t,!0);d&&a.push(d)}else if(He(e)){var f=e;n=t;for(var h=Object.keys(f),v=0;v<h.length;v++){var m=h[v],p=f[m];if(p===void 0&&(p=f[Ss(m)]),p!==void 0){var g=this.parse(m,p,!0);g&&a.push(g)}}}else return!1;if(a.length===0)return!1;for(var y=!1,C=0;C<r.length;C++){for(var x=r[C],M={},P=void 0,D=0;D<a.length;D++){var R=a[D];if(n){var A=x.pstyle(R.name);P=M[R.name]={prev:A}}y=this.applyParsedProperty(x,qr(R))||y,n&&(P.next=x.pstyle(R.name))}y&&this.updateStyleHints(x),n&&this.updateTransitions(x,M,o)}return y};ka.overrideBypass=function(r,e,t){e=ru(e);for(var n=0;n<r.length;n++){var i=r[n],a=i._private.style[e],o=this.properties[e].type,s=o.color,l=o.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,t):(a.value=t,a.pfValue!=null&&(a.pfValue=t),s?a.strValue="rgb("+t.join(",")+")":l?a.strValue=t.join(" "):a.strValue=""+t,this.updateStyleHints(i)),this.checkTriggers(i,e,u,t)}};ka.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};ka.removeBypasses=function(r,e,t){for(var n=!0,i=0;i<r.length;i++){for(var a=r[i],o={},s=0;s<e.length;s++){var l=e[s],u=this.properties[l],c=a.pstyle(u.name);if(!(!c||!c.bypass)){var d="",f=this.parse(l,d,!0),h=o[u.name]={prev:c};this.applyParsedProperty(a,f),h.next=a.pstyle(u.name)}}this.updateStyleHints(a),t&&this.updateTransitions(a,o,n)}};var gu={};gu.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};gu.containerCss=function(r){var e=this._private.cy,t=e.container(),n=e.window();if(n&&t&&n.getComputedStyle)return n.getComputedStyle(t).getPropertyValue(r)};var Wr={};Wr.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};Wr.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var n={},i=0;i<t.properties.length;i++){var a=t.properties[i],o=t.getStylePropertyValue(r,a.name,e);o!=null&&(n[a.name]=o,n[Ss(a.name)]=o)}return n}};Wr.getIndexedStyle=function(r,e,t,n){var i=r.pstyle(e)[t][n];return i??r.cy().style().getDefaultProperty(e)[t][0]};Wr.getStylePropertyValue=function(r,e,t){var n=this;if(r=r[0],r){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,o=r.pstyle(i.name);if(o){var s=o.value,l=o.units,u=o.strValue;if(t&&a.number&&s!=null&&Ce(s)){var c=r.cy().zoom(),d=function(p){return p*c},f=function(p,g){return d(p)+g},h=Ze(s),v=h?l.every(function(m){return m!=null}):l!=null;return v?h?s.map(function(m,p){return f(m,l[p])}).join(" "):f(s,l):h?s.map(function(m){return Be(m)?m:""+d(m)}).join(" "):""+d(s)}else if(u!=null)return u}return null}};Wr.getAnimationStartStyle=function(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],a=i.name,o=r.pstyle(a);o!==void 0&&(He(o)?o=this.parse(a,o.strValue):o=this.parse(a,o)),o&&(t[a]=o)}return t};Wr.getPropsList=function(r){var e=this,t=[],n=r,i=e.properties;if(n)for(var a=Object.keys(n),o=0;o<a.length;o++){var s=a[o],l=n[s],u=i[s]||i[ru(s)],c=this.parse(u.name,l);c&&t.push(c)}return t};Wr.getNonDefaultPropertiesHash=function(r,e,t){var n=t.slice(),i,a,o,s,l,u;for(l=0;l<e.length;l++)if(i=e[l],a=r.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=da(s,n[0]),n[1]=fa(s,n[1]);else for(o=a.strValue,u=0;u<o.length;u++)s=o.charCodeAt(u),n[0]=da(s,n[0]),n[1]=fa(s,n[1]);return n};Wr.getPropertiesHash=Wr.getNonDefaultPropertiesHash;var Ls={};Ls.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var n=r[t],i=n.selector,a=n.style||n.css,o=Object.keys(a);e.selector(i);for(var s=0;s<o.length;s++){var l=o[s],u=a[l];e.css(l,u)}}return e};Ls.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};Ls.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],n=t.selector,i=t.properties,a={},o=0;o<i.length;o++){var s=i[o];a[s.name]=s.strValue}r.push({selector:n?n.toString():"core",style:a})}return r};var mu={};mu.appendFromString=function(r){var e=this,t=this,n=""+r,i,a,o;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>o.length?a=a.substr(o.length):a=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Ye("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var d=c[1];if(d!=="core"){var f=new Sn(d);if(f.invalid){Ye("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),s();continue}}var h=c[2],v=!1;a=h;for(var m=[];;){var p=a.match(/^\s*$/);if(p)break;var g=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!g){Ye("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+h),v=!0;break}o=g[0];var y=g[1],C=g[2],x=e.properties[y];if(!x){Ye("Skipping property: Invalid property name in: "+o),l();continue}var M=t.parse(y,C);if(!M){Ye("Skipping property: Invalid property definition in: "+o),l();continue}m.push({name:y,val:C}),l()}if(v){s();break}t.selector(d);for(var P=0;P<m.length;P++){var D=m[P];t.css(D.name,D.val)}s()}return t};mu.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var kt={};(function(){var r=gt,e=Ig,t=Fg,n=Lg,i=Vg,a=function(K){return"^"+K+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(K){var L=r+"|\\w+|"+e+"|"+t+"|"+n+"|"+i;return"^"+K+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+L+")\\s*\\,\\s*("+L+")\\)$"},s=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];kt.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:s,singleRegexMatchValue:!0},urls:{regexes:s,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(K,L){switch(K.length){case 2:return L[0]!=="deg"&&L[0]!=="rad"&&L[1]!=="deg"&&L[1]!=="rad";case 1:return Be(K[0])||L[0]==="deg"||L[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(K){var L=K.length;return L===1||L===2||L===4}}};var l={zeroNonZero:function(K,L){return(K==null||L==null)&&K!==L||K==0&&L!=0?!0:K!=0&&L==0},any:function(K,L){return K!=L},emptyNonEmpty:function(K,L){var j=xn(K),$=xn(L);return j&&!$||!j&&$}},u=kt.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],d=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],f=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],h=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],v=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification}],m=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any}],p=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:!0},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],g=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],C=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],x=function(K,L){return L.value==="label"?-K.poolIndex():L.pfValue},M=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:x},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],P=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],D=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],R=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],A=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],F=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],O=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],T=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],B=[];kt.pieBackgroundN=16,B.push({name:"pie-size",type:u.sizeMaybePercent});for(var E=1;E<=kt.pieBackgroundN;E++)B.push({name:"pie-"+E+"-background-color",type:u.color}),B.push({name:"pie-"+E+"-background-size",type:u.percent}),B.push({name:"pie-"+E+"-background-opacity",type:u.zeroOneNumber});var w=[],b=kt.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(ie){b.forEach(function(K){var L=K+"-"+ie.name,j=ie.type,$=ie.triggersBounds;w.push({name:L,type:j,triggersBounds:$})})},{});var _=kt.properties=[].concat(m,C,p,g,y,O,v,h,c,d,f,M,P,D,R,B,A,F,w,T),k=kt.propertyGroups={behavior:m,transition:C,visibility:p,overlay:g,underlay:y,ghost:O,commonLabel:v,labelDimensions:h,mainLabel:c,sourceLabel:d,targetLabel:f,nodeBody:M,nodeBorder:P,nodeOutline:D,backgroundImage:R,pie:B,compound:A,edgeLine:F,edgeArrow:w,core:T},S=kt.propertyGroupNames={},N=kt.propertyGroupKeys=Object.keys(k);N.forEach(function(ie){S[ie]=k[ie].map(function(K){return K.name}),k[ie].forEach(function(K){return K.groupKey=ie})});var V=kt.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];kt.propertyNames=_.map(function(ie){return ie.name});for(var z=0;z<_.length;z++){var H=_[z];_[H.name]=H}for(var Y=0;Y<V.length;Y++){var ee=V[Y],J=_[ee.pointsTo],ne={name:ee.name,alias:!0,pointsTo:J};_.push(ne),_[ee.name]=ne}})();kt.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};kt.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Fe({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=kt.pieBackgroundN;c++){var d=u.name.replace("{{i}}",c),f=u.value;l[d]=f}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return kt.arrowPrefixes.forEach(function(c){var d=c+"-"+u.name,f=u.value;l[d]=f}),l},{})),t={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,o=e[a],s=this.parse(a,o);t[a]=s}}return r.defaultProperties=t,r.defaultProperties};kt.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Vs={};Vs.parse=function(r,e,t,n){var i=this;if(lt(e))return i.parseImplWarn(r,e,t,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,o=t?"t":"f",s=""+e,l=Af(r,s,o,a),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(r,e,t,n)),(t||n==="mapping")&&(c=qr(c),c&&(c.value=qr(c.value))),c};Vs.parseImplWarn=function(r,e,t,n){var i=this.parseImpl(r,e,t,n);return!i&&e!=null&&Ye("The style property `".concat(r,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&Ye("The style value of `label` is deprecated for `"+i.name+"`"),i};Vs.parseImpl=function(r,e,t,n){var i=this;r=ru(r);var a=i.properties[r],o=e,s=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,r=a.name);var l=Be(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(lt(e))return{name:r,value:e,strValue:"fn",mapped:s.fn,bypass:t};var c,d;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(s.data.regex).exec(e))){if(t)return!1;var f=s.data;return{name:r,value:c,strValue:""+e,mapped:f,field:c[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(s.mapData.regex).exec(e))){if(t||u.multiple)return!1;var h=s.mapData;if(!(u.color||u.number))return!1;var v=this.parse(r,d[4]);if(!v||v.mapped)return!1;var m=this.parse(r,d[5]);if(!m||m.mapped)return!1;if(v.pfValue===m.pfValue||v.strValue===m.strValue)return Ye("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+v.strValue+"`"),this.parse(r,v.strValue);if(u.color){var p=v.value,g=m.value,y=p[0]===g[0]&&p[1]===g[1]&&p[2]===g[2]&&(p[3]===g[3]||(p[3]==null||p[3]===1)&&(g[3]==null||g[3]===1));if(y)return!1}return{name:r,value:d,strValue:""+e,mapped:h,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:v.value,valueMax:m.value,bypass:t}}}if(u.multiple&&n!=="multiple"){var C;if(l?C=e.split(/\s+/):Ze(e)?C=e:C=[e],u.evenMultiple&&C.length%2!==0)return null;for(var x=[],M=[],P=[],D="",R=!1,A=0;A<C.length;A++){var F=i.parse(r,C[A],t,"multiple");R=R||Be(F.value),x.push(F.value),P.push(F.pfValue!=null?F.pfValue:F.value),M.push(F.units),D+=(A>0?" ":"")+F.strValue}return u.validate&&!u.validate(x,M)?null:u.singleEnum&&R?x.length===1&&Be(x[0])?{name:r,value:x[0],strValue:x[0],bypass:t}:null:{name:r,value:x,pfValue:P,strValue:D,bypass:t,units:M}}var O=function(){for(var K=0;K<u.enums.length;K++){var L=u.enums[K];if(L===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(u.number){var T,B="px";if(u.units&&(T=u.units),u.implicitUnits&&(B=u.implicitUnits),!u.unitless)if(l){var E="px|em"+(u.allowPercent?"|\\%":"");T&&(E=T);var w=e.match("^("+gt+")("+E+")?$");w&&(e=w[1],T=w[2]||B)}else(!T||u.implicitUnits)&&(T=B);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=o,O();if(u.integer&&!kg(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var b={name:r,value:e,strValue:""+e+(T||""),units:T,bypass:t};return u.unitless||T!=="px"&&T!=="em"?b.pfValue=e:b.pfValue=T==="px"||!T?e:this.getEmSizeInPixels()*e,(T==="ms"||T==="s")&&(b.pfValue=T==="ms"?e:1e3*e),(T==="deg"||T==="rad")&&(b.pfValue=T==="rad"?e:o0(e)),T==="%"&&(b.pfValue=e/100),b}else if(u.propList){var _=[],k=""+e;if(k!=="none"){for(var S=k.split(/\s*,\s*|\s+/),N=0;N<S.length;N++){var V=S[N].trim();i.properties[V]?_.push(V):Ye("`"+V+"` is not a valid property name")}if(_.length===0)return null}return{name:r,value:_,strValue:_.length===0?"none":_.join(" "),bypass:t}}else if(u.color){var z=_f(e);return z?{name:r,value:z,pfValue:z,strValue:"rgb("+z[0]+","+z[1]+","+z[2]+")",bypass:t}:null}else if(u.regex||u.regexes){if(u.enums){var H=O();if(H)return H}for(var Y=u.regexes?u.regexes:[u.regex],ee=0;ee<Y.length;ee++){var J=new RegExp(Y[ee]),ne=J.exec(e);if(ne)return{name:r,value:u.singleRegexMatchValue?ne[1]:ne,strValue:""+e,bypass:t}}return null}else return u.string?{name:r,value:""+e,strValue:""+e,bypass:t}:u.enums?O():null};var Ft=function r(e){if(!(this instanceof r))return new r(e);if(!tu(e)){st("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Vt=Ft.prototype;Vt.instanceString=function(){return"style"};Vt.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Vt.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Vt.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};Vt.selector=function(r){var e=r==="core"?null:new Sn(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};Vt.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],n=0;n<r.properties.length;n++){var i=r.properties[n],a=t[i.name];a===void 0&&(a=t[Ss(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Vt.style=Vt.css;Vt.cssRule=function(r,e){var t=this.parse(r,e);if(t){var n=this.length-1;this[n].properties.push(t),this[n].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.mapped&&this[n].mappedProperties.push(t);var i=!this[n].selector;i&&(this._private.coreStyle[t.name]=t)}return this};Vt.append=function(r){return wf(r)?r.appendToStyle(this):Ze(r)?this.appendFromJson(r):Be(r)&&this.appendFromString(r),this};Ft.fromJson=function(r,e){var t=new Ft(r);return t.fromJson(e),t};Ft.fromString=function(r,e){return new Ft(r).fromString(e)};[Nt,ka,gu,Wr,Ls,mu,kt,Vs].forEach(function(r){Fe(Vt,r)});Ft.types=Vt.types;Ft.properties=Vt.properties;Ft.propertyGroups=Vt.propertyGroups;Ft.propertyGroupNames=Vt.propertyGroupNames;Ft.propertyGroupKeys=Vt.propertyGroupKeys;var Tw={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return wf(e)?t.style=e.generateStyle(this):Ze(e)?t.style=Ft.fromJson(this,e):Be(e)?t.style=Ft.fromString(this,e):t.style=Ft(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},kw="single",Un={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=kw),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,n,i,a,o,s;switch(e.length){case 0:return t;case 1:if(Be(e[0]))return n=e[0],t[n];if(He(e[0])){if(!this._private.panningEnabled)return this;a=e[0],o=a.x,s=a.y,Ce(o)&&(t.x=o),Ce(s)&&(t.y=s),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Ce(i)&&(t[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var n=arguments,i=this._private.pan,a,o,s,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:He(e)&&(s=n[0],l=s.x,u=s.y,Ce(l)&&(i.x+=l),Ce(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:a=e,o=t,(a==="x"||a==="y")&&Ce(o)&&(i[a]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(Ce(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Be(e)){var i=e;e=this.$(i)}else if(Pg(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else ur(e)||(e=this.mutableElements());if(!(ur(e)&&e.empty())){n=n||e.boundingBox();var o=this.width(),s=this.height(),l;if(t=Ce(t)?t:0,!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((o-2*t)/n.w,(s-2*t)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(o-l*(n.x1+n.x2))/2,y:(s-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var i=e;e=i.min,t=i.max}return Ce(e)&&Ce(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):Ce(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:Ce(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,n=t.pan,i=t.zoom,a,o,s=!1;if(t.zoomingEnabled||(s=!0),Ce(e)?o=e:He(e)&&(o=e.level,e.position!=null?a=Ms(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!t.panningEnabled&&(s=!0)),o=o>t.maxZoom?t.maxZoom:o,o=o<t.minZoom?t.minZoom:o,s||!Ce(o)||o===i||a!=null&&(!Ce(a.x)||!Ce(a.y)))return null;if(a!=null){var l=n,u=i,c=o,d={x:-c/u*(a.x-l.x)+a.x,y:-c/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:d}}else return{zoomed:!0,panned:!1,zoom:o,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t==null||!t.zoomed?this:(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,n=!0,i=!0,a=[],o=!1,s=!1;if(!e)return this;if(Ce(e.zoom)||(n=!1),He(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<t.minZoom||l>t.maxZoom||!t.zoomingEnabled?o=!0:(t.zoom=l,a.push("zoom"))}if(i&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var u=e.pan;Ce(u.x)&&(t.pan.x=u.x,s=!1),Ce(u.y)&&(t.pan.y=u.y,s=!1),s||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(Be(e)){var n=e;e=this.mutableElements().filter(n)}else ur(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(a-t*(i.x1+i.x2))/2,y:(o-t*(i.y1+i.y2))/2};return s}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container,n=this;return e.sizeCache=e.sizeCache||(t?function(){var i=n.window().getComputedStyle(t),a=function(s){return parseFloat(i.getPropertyValue(s))};return{width:t.clientWidth-a("padding-left")-a("padding-right"),height:t.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Un.centre=Un.center;Un.autolockNodes=Un.autolock;Un.autoungrabifyNodes=Un.autoungrabify;var Ca={data:Xe.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Xe.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Xe.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Xe.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Ca.attr=Ca.data;Ca.removeAttr=Ca.removeData;var wa=function(e){var t=this;e=Fe({},e);var n=e.container;n&&!hs(n)&&hs(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=t;var o=pt!==void 0&&n!==void 0&&!e.headless,s=e;s.layout=Fe({name:o?"grid":"null"},s.layout),s.renderer=Fe({name:o?"canvas":"null"},s.renderer);var l=function(v,m,p){return m!==void 0?m:p!==void 0?p:v},u=this._private={container:n,ready:!1,options:s,elements:new Dt(this),listeners:[],aniEles:new Dt(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,s.zoomingEnabled),userZoomingEnabled:l(!0,s.userZoomingEnabled),panningEnabled:l(!0,s.panningEnabled),userPanningEnabled:l(!0,s.userPanningEnabled),boxSelectionEnabled:l(!0,s.boxSelectionEnabled),autolock:l(!1,s.autolock,s.autolockNodes),autoungrabify:l(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:l(!1,s.autounselectify),styleEnabled:s.styleEnabled===void 0?o:s.styleEnabled,zoom:Ce(s.zoom)?s.zoom:1,pan:{x:He(s.pan)&&Ce(s.pan.x)?s.pan.x:0,y:He(s.pan)&&Ce(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,s.multiClickDebounceTime)};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});var c=function(v,m){var p=v.some(Ag);if(p)return Di.all(v).then(m);m(v)};u.styleEnabled&&t.setStyle([]);var d=Fe({},s,s.renderer);t.initRenderer(d);var f=function(v,m,p){t.notifications(!1);var g=t.mutableElements();g.length>0&&g.remove(),v!=null&&(He(v)||Ze(v))&&t.add(v),t.one("layoutready",function(C){t.notifications(!0),t.emit(C),t.one("load",m),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",p),t.emit("done")});var y=Fe({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};c([s.style,s.elements],function(h){var v=h[0],m=h[1];u.styleEnabled&&t.style().append(v),f(m,function(){t.startAnimationLoop(),u.ready=!0,lt(s.ready)&&t.on("ready",s.ready);for(var p=0;p<a.length;p++){var g=a[p];t.on("ready",g)}i&&(i.readies=[]),t.emit("ready")},s.done)})},ws=wa.prototype;Fe(ws,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return pt;var t=this._private.container.ownerDocument;return t===void 0||t==null?pt:t.defaultView||pt},mount:function(e){if(e!=null){var t=this,n=t._private,i=n.options;return!hs(e)&&hs(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(Fe({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),t.startAnimationLoop(),t.style(i.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return qr(this._private.options)},json:function(e){var t=this,n=t._private,i=t.mutableElements(),a=function(x){return t.getElementById(x.id())};if(He(e)){if(t.startBatch(),e.elements){var o={},s=function(x,M){for(var P=[],D=[],R=0;R<x.length;R++){var A=x[R];if(!A.data.id){Ye("cy.json() cannot handle elements without an ID attribute");continue}var F=""+A.data.id,O=t.getElementById(F);o[F]=!0,O.length!==0?D.push({ele:O,json:A}):(M&&(A.group=M),P.push(A))}t.add(P);for(var T=0;T<D.length;T++){var B=D[T],E=B.ele,w=B.json;E.json(w)}};if(Ze(e.elements))s(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],d=e.elements[c];Ze(d)&&s(d,c)}var f=t.collection();i.filter(function(C){return!o[C.id()]}).forEach(function(C){C.isParent()?f.merge(C):C.remove()}),f.forEach(function(C){return C.children().move({parent:null})}),f.forEach(function(C){return a(C).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var h=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<h.length;v++){var m=h[v];e[m]!=null&&t[m](e[m])}return t.endBatch(),this}else{var p=!!e,g={};p?g.elements=this.elements().map(function(C){return C.json()}):(g.elements={},i.forEach(function(C){var x=C.group();g.elements[x]||(g.elements[x]=[]),g.elements[x].push(C.json())})),this._private.styleEnabled&&(g.style=t.style().json()),g.data=qr(t.data());var y=n.options;return g.zoomingEnabled=n.zoomingEnabled,g.userZoomingEnabled=n.userZoomingEnabled,g.zoom=n.zoom,g.minZoom=n.minZoom,g.maxZoom=n.maxZoom,g.panningEnabled=n.panningEnabled,g.userPanningEnabled=n.userPanningEnabled,g.pan=qr(n.pan),g.boxSelectionEnabled=n.boxSelectionEnabled,g.renderer=qr(y.renderer),g.hideEdgesOnViewport=y.hideEdgesOnViewport,g.textureOnViewport=y.textureOnViewport,g.wheelSensitivity=y.wheelSensitivity,g.motionBlur=y.motionBlur,g.multiClickDebounceTime=y.multiClickDebounceTime,g}}});ws.$id=ws.getElementById;[gw,bw,xh,ql,us,_w,Hl,cs,Tw,Un,Ca].forEach(function(r){Fe(ws,r)});var Mw={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Dw={maximal:!1,acyclic:!1},pi=function(e){return e.scratch("breadthfirst")},Gd=function(e,t){return e.scratch("breadthfirst",t)};function _h(r){this.options=Fe({},Mw,Dw,r)}_h.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=t.nodes().filter(function(fe){return fe.isChildless()}),i=t,a=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,s=!!r.boundingBox,l=e.extent(),u=rr(s?r.boundingBox:{x1:l.x1,y1:l.y1,w:l.w,h:l.h}),c;if(ur(r.roots))c=r.roots;else if(Ze(r.roots)){for(var d=[],f=0;f<r.roots.length;f++){var h=r.roots[f],v=e.getElementById(h);d.push(v)}c=e.collection(d)}else if(Be(r.roots))c=e.$(r.roots);else if(a)c=n.roots();else{var m=t.components();c=e.collection();for(var p=function(ce){var we=m[ce],Me=we.maxDegree(!1),ke=we.filter(function(xe){return xe.degree(!1)===Me});c=c.add(ke)},g=0;g<m.length;g++)p(g)}var y=[],C={},x=function(ce,we){y[we]==null&&(y[we]=[]);var Me=y[we].length;y[we].push(ce),Gd(ce,{index:Me,depth:we})},M=function(ce,we){var Me=pi(ce),ke=Me.depth,xe=Me.index;y[ke][xe]=null,ce.isChildless()&&x(ce,we)};i.bfs({roots:c,directed:r.directed,visit:function(ce,we,Me,ke,xe){var Ee=ce[0],ye=Ee.id();Ee.isChildless()&&x(Ee,xe),C[ye]=!0}});for(var P=[],D=0;D<n.length;D++){var R=n[D];C[R.id()]||P.push(R)}var A=function(ce){for(var we=y[ce],Me=0;Me<we.length;Me++){var ke=we[Me];if(ke==null){we.splice(Me,1),Me--;continue}Gd(ke,{depth:ce,index:Me})}},F=function(ce,we){for(var Me=pi(ce),ke=ce.incomers().filter(function(oe){return oe.isNode()&&t.has(oe)}),xe=-1,Ee=ce.id(),ye=0;ye<ke.length;ye++){var se=ke[ye],I=pi(se);xe=Math.max(xe,I.depth)}if(Me.depth<=xe){if(!r.acyclic&&we[Ee])return null;var W=xe+1;return M(ce,W),we[Ee]=W,!0}return!1};if(a&&o){var O=[],T={},B=function(ce){return O.push(ce)},E=function(){return O.shift()};for(n.forEach(function(fe){return O.push(fe)});O.length>0;){var w=E(),b=F(w,T);if(b)w.outgoers().filter(function(fe){return fe.isNode()&&t.has(fe)}).forEach(B);else if(b===null){Ye("Detected double maximal shift for node `"+w.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var _=0;if(r.avoidOverlap)for(var k=0;k<n.length;k++){var S=n[k],N=S.layoutDimensions(r),V=N.w,z=N.h;_=Math.max(_,V,z)}var H={},Y=function(ce){if(H[ce.id()])return H[ce.id()];for(var we=pi(ce).depth,Me=ce.neighborhood(),ke=0,xe=0,Ee=0;Ee<Me.length;Ee++){var ye=Me[Ee];if(!(ye.isEdge()||ye.isParent()||!n.has(ye))){var se=pi(ye);if(se!=null){var I=se.index,W=se.depth;if(!(I==null||W==null)){var oe=y[W].length;W<we&&(ke+=I/oe,xe++)}}}}return xe=Math.max(1,xe),ke=ke/xe,xe===0&&(ke=0),H[ce.id()]=ke,ke},ee=function(ce,we){var Me=Y(ce),ke=Y(we),xe=Me-ke;return xe===0?xf(ce.id(),we.id()):xe};r.depthSort!==void 0&&(ee=r.depthSort);for(var J=y.length,ne=0;ne<J;ne++)y[ne].sort(ee),A(ne);for(var ie=[],K=0;K<P.length;K++)ie.push(P[K]);var L=function(){for(var ce=0;ce<J;ce++)A(ce)};ie.length&&(y.unshift(ie),J=y.length,L());for(var j=0,$=0;$<J;$++)j=Math.max(y[$].length,j);var U={x:u.x1+u.w/2,y:u.y1+u.h/2},X=n.reduce(function(fe,ce){return function(we){return{w:fe.w===-1?we.w:(fe.w+we.w)/2,h:fe.h===-1?we.h:(fe.h+we.h)/2}}(ce.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),de=Math.max(J===1?0:s?(u.h-r.padding*2-X.h)/(J-1):(u.h-r.padding*2-X.h)/(J+1),_),Te=y.reduce(function(fe,ce){return Math.max(fe,ce.length)},0),_e=function(ce){var we=pi(ce),Me=we.depth,ke=we.index;if(r.circle){var xe=Math.min(u.w/2/J,u.h/2/J);xe=Math.max(xe,_);var Ee=xe*Me+xe-(J>0&&y[0].length<=3?xe/2:0),ye=2*Math.PI/y[Me].length*ke;return Me===0&&y[0].length===1&&(Ee=1),{x:U.x+Ee*Math.cos(ye),y:U.y+Ee*Math.sin(ye)}}else{var se=y[Me].length,I=Math.max(se===1?0:s?(u.w-r.padding*2-X.w)/((r.grid?Te:se)-1):(u.w-r.padding*2-X.w)/((r.grid?Te:se)+1),_),W={x:U.x+(ke+1-(se+1)/2)*I,y:U.y+(Me+1-(J+1)/2)*de};return W}};return t.nodes().layoutPositions(this,r,_e),this};var Pw={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Eh(r){this.options=Fe({},Pw,r)}Eh.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var o=rr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),c,d=0,f=0;f<a.length;f++){var h=a[f],v=h.layoutDimensions(e),m=v.w,p=v.h;d=Math.max(d,m,p)}if(Ce(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(o.h,o.w)/2-d,a.length>1&&e.avoidOverlap){d*=1.75;var g=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),C=Math.sqrt(d*d/(g*g+y*y));c=Math.max(C,c)}var x=function(P,D){var R=e.startAngle+D*u*(i?1:-1),A=c*Math.cos(R),F=c*Math.sin(R),O={x:s.x+A,y:s.y+F};return O};return n.nodes().layoutPositions(this,e,x),this};var Aw={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Sh(r){this.options=Fe({},Aw,r)}Sh.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=r.cy,i=e.eles,a=i.nodes().not(":parent"),o=rr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=[],u=0,c=0;c<a.length;c++){var d=a[c],f=void 0;f=e.concentric(d),l.push({value:f,node:d}),d._private.scratch.concentric=f}a.updateStyle();for(var h=0;h<a.length;h++){var v=a[h],m=v.layoutDimensions(e);u=Math.max(u,m.w,m.h)}l.sort(function(X,de){return de.value-X.value});for(var p=e.levelWidth(a),g=[[]],y=g[0],C=0;C<l.length;C++){var x=l[C];if(y.length>0){var M=Math.abs(y[0].value-x.value);M>=p&&(y=[],g.push(y))}y.push(x)}var P=u+e.minNodeSpacing;if(!e.avoidOverlap){var D=g.length>0&&g[0].length>1,R=Math.min(o.w,o.h)/2-P,A=R/(g.length+D?1:0);P=Math.min(P,A)}for(var F=0,O=0;O<g.length;O++){var T=g[O],B=e.sweep===void 0?2*Math.PI-2*Math.PI/T.length:e.sweep,E=T.dTheta=B/Math.max(1,T.length-1);if(T.length>1&&e.avoidOverlap){var w=Math.cos(E)-Math.cos(0),b=Math.sin(E)-Math.sin(0),_=Math.sqrt(P*P/(w*w+b*b));F=Math.max(_,F)}T.r=F,F+=P}if(e.equidistant){for(var k=0,S=0,N=0;N<g.length;N++){var V=g[N],z=V.r-S;k=Math.max(k,z)}S=0;for(var H=0;H<g.length;H++){var Y=g[H];H===0&&(S=Y.r),Y.r=S,S+=k}}for(var ee={},J=0;J<g.length;J++)for(var ne=g[J],ie=ne.dTheta,K=ne.r,L=0;L<ne.length;L++){var j=ne[L],$=e.startAngle+(t?1:-1)*ie*L,U={x:s.x+K*Math.cos($),y:s.y+K*Math.sin($)};ee[j.node.id()]=U}return i.nodes().layoutPositions(this,e,function(X){var de=X.id();return ee[de]}),this};var Pl,Bw={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Ns(r){this.options=Fe({},Bw,r),this.options.layout=this;var e=this.options.eles.nodes(),t=this.options.eles.edges(),n=t.filter(function(i){var a=i.source().data("id"),o=i.target().data("id"),s=e.some(function(u){return u.data("id")===a}),l=e.some(function(u){return u.data("id")===o});return!s||!l});this.options.eles=this.options.eles.not(n)}Ns.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Pl=!0:Pl=!1;var n=Rw(e,t,r);Pl&&Fw(n),r.randomize&&Lw(n);var i=nn(),a=function(){Vw(n,e,r),r.fit===!0&&e.fit(r.padding)},o=function(f){return!(t.stopped||f>=r.numIter||(Nw(n,r),n.temperature=n.temperature*r.coolingFactor,n.temperature<r.minTemp))},s=function(){if(r.animate===!0||r.animate===!1)a(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var f=r.eles.nodes(),h=Th(n,r,f);f.layoutPositions(t,r,h)}},l=0,u=!0;if(r.animate===!0){var c=function d(){for(var f=0;u&&f<r.refresh;)u=o(l),l++,f++;if(!u)Hd(n,r),s();else{var h=nn();h-i>=r.animationThreshold&&a(),vs(d)}};c()}else{for(;u;)u=o(l),l++;Hd(n,r),s()}return this};Ns.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Ns.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Rw=function(e,t,n){for(var i=n.eles.edges(),a=n.eles.nodes(),o=rr(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},l=n.eles.components(),u={},c=0;c<l.length;c++)for(var d=l[c],f=0;f<d.length;f++){var h=d[f];u[h.id()]=c}for(var c=0;c<s.nodeSize;c++){var v=a[c],m=v.layoutDimensions(n),p={};p.isLocked=v.locked(),p.id=v.data("id"),p.parentId=v.data("parent"),p.cmptId=u[v.id()],p.children=[],p.positionX=v.position("x"),p.positionY=v.position("y"),p.offsetX=0,p.offsetY=0,p.height=m.w,p.width=m.h,p.maxX=p.positionX+p.width/2,p.minX=p.positionX-p.width/2,p.maxY=p.positionY+p.height/2,p.minY=p.positionY-p.height/2,p.padLeft=parseFloat(v.style("padding")),p.padRight=parseFloat(v.style("padding")),p.padTop=parseFloat(v.style("padding")),p.padBottom=parseFloat(v.style("padding")),p.nodeRepulsion=lt(n.nodeRepulsion)?n.nodeRepulsion(v):n.nodeRepulsion,s.layoutNodes.push(p),s.idToIndex[p.id]=c}for(var g=[],y=0,C=-1,x=[],c=0;c<s.nodeSize;c++){var v=s.layoutNodes[c],M=v.parentId;M!=null?s.layoutNodes[s.idToIndex[M]].children.push(v.id):(g[++C]=v.id,x.push(v.id))}for(s.graphSet.push(x);y<=C;){var P=g[y++],D=s.idToIndex[P],h=s.layoutNodes[D],R=h.children;if(R.length>0){s.graphSet.push(R);for(var c=0;c<R.length;c++)g[++C]=R[c]}}for(var c=0;c<s.graphSet.length;c++)for(var A=s.graphSet[c],f=0;f<A.length;f++){var F=s.idToIndex[A[f]];s.indexToGraph[F]=c}for(var c=0;c<s.edgeSize;c++){var O=i[c],T={};T.id=O.data("id"),T.sourceId=O.data("source"),T.targetId=O.data("target");var B=lt(n.idealEdgeLength)?n.idealEdgeLength(O):n.idealEdgeLength,E=lt(n.edgeElasticity)?n.edgeElasticity(O):n.edgeElasticity,w=s.idToIndex[T.sourceId],b=s.idToIndex[T.targetId],_=s.indexToGraph[w],k=s.indexToGraph[b];if(_!=k){for(var S=Iw(T.sourceId,T.targetId,s),N=s.graphSet[S],V=0,p=s.layoutNodes[w];N.indexOf(p.id)===-1;)p=s.layoutNodes[s.idToIndex[p.parentId]],V++;for(p=s.layoutNodes[b];N.indexOf(p.id)===-1;)p=s.layoutNodes[s.idToIndex[p.parentId]],V++;B*=V*n.nestingFactor}T.idealLength=B,T.elasticity=E,s.layoutEdges.push(T)}return s},Iw=function(e,t,n){var i=Ow(e,t,0,n);return 2>i.count?0:i.graph},Ow=function r(e,t,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:n};for(var o=0,s=0;s<a.length;s++){var l=a[s],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var d=i.indexToGraph[i.idToIndex[c[0]]],f=r(e,t,d,i);if(f.count!==0)if(f.count===1){if(o++,o===2)break}else return f}}return{count:o,graph:n}},Fw,Lw=function(e,t){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var o=e.layoutNodes[a];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*n,o.positionY=Math.random()*i)}},Th=function(e,t,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(o){var s=e.layoutNodes[e.idToIndex[o.data("id")]];a.x1=Math.min(a.x1,s.positionX),a.x2=Math.max(a.x2,s.positionX),a.y1=Math.min(a.y1,s.positionY),a.y2=Math.max(a.y2,s.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(o,s){var l=e.layoutNodes[e.idToIndex[o.data("id")]];if(t.boundingBox){var u=(l.positionX-a.x1)/a.w,c=(l.positionY-a.y1)/a.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},Vw=function(e,t,n){var i=n.layout,a=n.eles.nodes(),o=Th(e,n,a);a.positions(o),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},Nw=function(e,t,n){zw(e,t),Gw(e),qw(e,t),Hw(e),Ww(e)},zw=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,o=0;o<a;o++)for(var s=e.layoutNodes[e.idToIndex[i[o]]],l=o+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[i[l]]];jw(s,u,e,t)}},qd=function(e){return-e+2*e*Math.random()},jw=function(e,t,n,i){var a=e.cmptId,o=t.cmptId;if(!(a!==o&&!n.isCompound)){var s=t.positionX-e.positionX,l=t.positionY-e.positionY,u=1;s===0&&l===0&&(s=qd(u),l=qd(u));var c=$w(e,t,s,l);if(c>0)var d=i.nodeOverlap*c,f=Math.sqrt(s*s+l*l),h=d*s/f,v=d*l/f;else var m=bs(e,s,l),p=bs(t,-1*s,-1*l),g=p.x-m.x,y=p.y-m.y,C=g*g+y*y,f=Math.sqrt(C),d=(e.nodeRepulsion+t.nodeRepulsion)/C,h=d*g/f,v=d*y/f;e.isLocked||(e.offsetX-=h,e.offsetY-=v),t.isLocked||(t.offsetX+=h,t.offsetY+=v)}},$w=function(e,t,n,i){if(n>0)var a=e.maxX-t.minX;else var a=t.maxX-e.minX;if(i>0)var o=e.maxY-t.minY;else var o=t.maxY-e.minY;return a>=0&&o>=0?Math.sqrt(a*a+o*o):0},bs=function(e,t,n){var i=e.positionX,a=e.positionY,o=e.height||1,s=e.width||1,l=n/t,u=o/s,c={};return t===0&&0<n||t===0&&0>n?(c.x=i,c.y=a+o/2,c):0<t&&-1*u<=l&&l<=u?(c.x=i+s/2,c.y=a+s*n/2/t,c):0>t&&-1*u<=l&&l<=u?(c.x=i-s/2,c.y=a-s*n/2/t,c):0<n&&(l<=-1*u||l>=u)?(c.x=i+o*t/2/n,c.y=a+o/2,c):(0>n&&(l<=-1*u||l>=u)&&(c.x=i-o*t/2/n,c.y=a-o/2),c)},Gw=function(e,t){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],o=e.layoutNodes[a],s=e.idToIndex[i.targetId],l=e.layoutNodes[s],u=l.positionX-o.positionX,c=l.positionY-o.positionY;if(!(u===0&&c===0)){var d=bs(o,u,c),f=bs(l,-1*u,-1*c),h=f.x-d.x,v=f.y-d.y,m=Math.sqrt(h*h+v*v),p=Math.pow(i.idealLength-m,2)/i.elasticity;if(m!==0)var g=p*h/m,y=p*v/m;else var g=0,y=0;o.isLocked||(o.offsetX+=g,o.offsetY+=y),l.isLocked||(l.offsetX-=g,l.offsetY-=y)}}},qw=function(e,t){if(t.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],o=a.length;if(i===0)var s=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[u.parentId]],s=c.positionX,l=c.positionY;for(var d=0;d<o;d++){var f=e.layoutNodes[e.idToIndex[a[d]]];if(!f.isLocked){var h=s-f.positionX,v=l-f.positionY,m=Math.sqrt(h*h+v*v);if(m>n){var p=t.gravity*h/m,g=t.gravity*v/m;f.offsetX+=p,f.offsetY+=g}}}}},Hw=function(e,t){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var o=n[i++],s=e.idToIndex[o],l=e.layoutNodes[s],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,d=l.offsetY,f=0;f<u.length;f++){var h=e.layoutNodes[e.idToIndex[u[f]]];h.offsetX+=c,h.offsetY+=d,n[++a]=u[f]}l.offsetX=0,l.offsetY=0}}},Ww=function(e,t){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=Uw(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,Kw(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},Uw=function(e,t,n){var i=Math.sqrt(e*e+t*t);if(i>n)var a={x:n*e/i,y:n*t/i};else var a={x:e,y:t};return a},Kw=function r(e,t){var n=e.parentId;if(n!=null){var i=t.layoutNodes[t.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return r(i,t)}},Hd=function(e,t){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var o=n[a],s=o.cmptId,l=i[s]=i[s]||[];l.push(o)}for(var u=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var d=0;d<c.length;d++){var f=c[d];c.x1=Math.min(c.x1,f.positionX-f.width/2),c.x2=Math.max(c.x2,f.positionX+f.width/2),c.y1=Math.min(c.y1,f.positionY-f.height/2),c.y2=Math.max(c.y2,f.positionY+f.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(y,C){return C.w*C.h-y.w*y.h});for(var h=0,v=0,m=0,p=0,g=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var d=0;d<c.length;d++){var f=c[d];f.isLocked||(f.positionX+=h-c.x1,f.positionY+=v-c.y1)}h+=c.w+t.componentSpacing,m+=c.w+t.componentSpacing,p=Math.max(p,c.h),m>g&&(v+=p+t.componentSpacing,h=0,m=0,p=0)}}},Xw={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function kh(r){this.options=Fe({},Xw,r)}kh.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=rr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(H){return{x:a.x1,y:a.y1}});else{var o=i.size(),s=Math.sqrt(o*a.h/a.w),l=Math.round(s),u=Math.round(a.w/a.h*s),c=function(Y){if(Y==null)return Math.min(l,u);var ee=Math.min(l,u);ee==l?l=Y:u=Y},d=function(Y){if(Y==null)return Math.max(l,u);var ee=Math.max(l,u);ee==l?l=Y:u=Y},f=e.rows,h=e.cols!=null?e.cols:e.columns;if(f!=null&&h!=null)l=f,u=h;else if(f!=null&&h==null)l=f,u=Math.ceil(o/l);else if(f==null&&h!=null)u=h,l=Math.ceil(o/u);else if(u*l>o){var v=c(),m=d();(v-1)*m>=o?c(v-1):(m-1)*v>=o&&d(m-1)}else for(;u*l<o;){var p=c(),g=d();(g+1)*p>=o?d(g+1):c(p+1)}var y=a.w/u,C=a.h/l;if(e.condense&&(y=0,C=0),e.avoidOverlap)for(var x=0;x<i.length;x++){var M=i[x],P=M._private.position;(P.x==null||P.y==null)&&(P.x=0,P.y=0);var D=M.layoutDimensions(e),R=e.avoidOverlapPadding,A=D.w+R,F=D.h+R;y=Math.max(y,A),C=Math.max(C,F)}for(var O={},T=function(Y,ee){return!!O["c-"+Y+"-"+ee]},B=function(Y,ee){O["c-"+Y+"-"+ee]=!0},E=0,w=0,b=function(){w++,w>=u&&(w=0,E++)},_={},k=0;k<i.length;k++){var S=i[k],N=e.position(S);if(N&&(N.row!==void 0||N.col!==void 0)){var V={row:N.row,col:N.col};if(V.col===void 0)for(V.col=0;T(V.row,V.col);)V.col++;else if(V.row===void 0)for(V.row=0;T(V.row,V.col);)V.row++;_[S.id()]=V,B(V.row,V.col)}}var z=function(Y,ee){var J,ne;if(Y.locked()||Y.isParent())return!1;var ie=_[Y.id()];if(ie)J=ie.col*y+y/2+a.x1,ne=ie.row*C+C/2+a.y1;else{for(;T(E,w);)b();J=w*y+y/2+a.x1,ne=E*C+C/2+a.y1,B(E,w),b()}return{x:J,y:ne}};i.layoutPositions(this,e,z)}return this};var Yw={ready:function(){},stop:function(){}};function yu(r){this.options=Fe({},Yw,r)}yu.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};yu.prototype.stop=function(){return this};var Qw={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Mh(r){this.options=Fe({},Qw,r)}Mh.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),n=lt(r.positions);function i(a){if(r.positions==null)return t0(a.position());if(n)return r.positions(a);var o=r.positions[a._private.data.id];return o??null}return t.layoutPositions(this,r,function(a,o){var s=i(a);return a.locked()||s==null?!1:s}),this};var Zw={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Dh(r){this.options=Fe({},Zw,r)}Dh.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=rr(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(o,s){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return t.nodes().layoutPositions(this,r,i),this};var Jw=[{name:"breadthfirst",impl:_h},{name:"circle",impl:Eh},{name:"concentric",impl:Sh},{name:"cose",impl:Ns},{name:"grid",impl:kh},{name:"null",impl:yu},{name:"preset",impl:Mh},{name:"random",impl:Dh}];function Ph(r){this.options=r,this.notifications=0}var Wd=function(){},Ud=function(){throw new Error("A headless instance can not render images")};Ph.prototype={recalculateRenderedStyle:Wd,notify:function(){this.notifications++},init:Wd,isHeadless:function(){return!0},png:Ud,jpg:Ud};var Cu={};Cu.arrowShapeWidth=.3;Cu.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(u,c,d,f,h,v,m){var p=h.x-d/2-m,g=h.x+d/2+m,y=h.y-d/2-m,C=h.y+d/2+m,x=p<=u&&u<=g&&y<=c&&c<=C;return x},n=function(u,c,d,f,h){var v=u*Math.cos(f)-c*Math.sin(f),m=u*Math.sin(f)+c*Math.cos(f),p=v*d,g=m*d,y=p+h.x,C=g+h.y;return{x:y,y:C}},i=function(u,c,d,f){for(var h=[],v=0;v<u.length;v+=2){var m=u[v],p=u[v+1];h.push(n(m,p,c,d,f))}return h},a=function(u){for(var c=[],d=0;d<u.length;d++){var f=u[d];c.push(f.x,f.y)}return c},o=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},s=function(u,c){Be(c)&&(c=r[c]),r[u]=Fe({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(f,h,v,m,p,g){var y=a(i(this.points,v+2*g,m,p)),C=tr(f,h,y);return C},roughCollide:t,draw:function(f,h,v,m){var p=i(this.points,h,v,m);e.arrowShapeImpl("polygon")(f,p)},spacing:function(f){return 0},gap:o},c)};s("none",{collide:ps,roughCollide:ps,draw:iu,spacing:nd,gap:nd}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(u,c,d,f,h){var v=i(this.points,c,d,f),m=this.controlPoint,p=n(m[0],m[1],c,d,f);e.arrowShapeImpl(this.name)(u,v,p)},gap:function(u){return o(u)*.8}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,d,f,h,v,m){var p=a(i(this.points,d+2*m,f,h)),g=a(i(this.pointsTee,d+2*m,f,h)),y=tr(u,c,p)||tr(u,c,g);return y},draw:function(u,c,d,f,h){var v=i(this.points,c,d,f),m=i(this.pointsTee,c,d,f);e.arrowShapeImpl(this.name)(u,v,m)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,d,f,h,v,m){var p=h,g=Math.pow(p.x-u,2)+Math.pow(p.y-c,2)<=Math.pow((d+2*m)*this.radius,2),y=a(i(this.points,d+2*m,f,h));return tr(u,c,y)||g},draw:function(u,c,d,f,h){var v=i(this.pointsTr,c,d,f);e.arrowShapeImpl(this.name)(u,v,f.x,f.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var d=this.baseCrossLinePts.slice(),f=c/u,h=3,v=5;return d[h]=d[h]-f,d[v]=d[v]-f,d},collide:function(u,c,d,f,h,v,m){var p=a(i(this.points,d+2*m,f,h)),g=a(i(this.crossLinePts(d,v),d+2*m,f,h)),y=tr(u,c,p)||tr(u,c,g);return y},draw:function(u,c,d,f,h){var v=i(this.points,c,d,f),m=i(this.crossLinePts(c,h),c,d,f);e.arrowShapeImpl(this.name)(u,v,m)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return o(u)*.525}}),s("circle",{radius:.15,collide:function(u,c,d,f,h,v,m){var p=h,g=Math.pow(p.x-u,2)+Math.pow(p.y-c,2)<=Math.pow((d+2*m)*this.radius,2);return g},draw:function(u,c,d,f,h){e.arrowShapeImpl(this.name)(u,f.x,f.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Xn={};Xn.projectIntoViewport=function(r,e){var t=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],o=n[4],s=t.pan(),l=t.zoom(),u=((r-i)/o-s.x)/l,c=((e-a)/o-s.y)/l;return[u,c]};Xn.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=this.cy.window().getComputedStyle(r),n=function(g){return parseFloat(t.getPropertyValue(g))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},o=r.clientWidth,s=r.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=a.left+a.right,d=e.width/(o+c),f=o-l,h=s-u,v=e.left+i.left+a.left,m=e.top+i.top+a.top;return this.containerBB=[v,m,f,h,d]};Xn.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Xn.findNearestElement=function(r,e,t,n){return this.findNearestElements(r,e,t,n)[0]};Xn.findNearestElements=function(r,e,t,n){var i=this,a=this,o=a.getCachedZSortedEles(),s=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),c=(n?24:8)/l,d=(n?8:2)/l,f=(n?8:2)/l,h=1/0,v,m;t&&(o=o.interactive);function p(D,R){if(D.isNode()){if(m)return;m=D,s.push(D)}if(D.isEdge()&&(R==null||R<h))if(v){if(v.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value){for(var A=0;A<s.length;A++)if(s[A].isEdge()){s[A]=D,v=D,h=R??h;break}}}else s.push(D),v=D,h=R??h}function g(D){var R=D.outerWidth()+2*d,A=D.outerHeight()+2*d,F=R/2,O=A/2,T=D.position(),B=D.pstyle("corner-radius").value==="auto"?"auto":D.pstyle("corner-radius").pfValue,E=D._private.rscratch;if(T.x-F<=r&&r<=T.x+F&&T.y-O<=e&&e<=T.y+O){var w=a.nodeShapes[i.getNodeShape(D)];if(w.checkPoint(r,e,0,R,A,T.x,T.y,B,E))return p(D,0),!0}}function y(D){var R=D._private,A=R.rscratch,F=D.pstyle("width").pfValue,O=D.pstyle("arrow-scale").value,T=F/2+c,B=T*T,E=T*2,k=R.source,S=R.target,w;if(A.edgeType==="segments"||A.edgeType==="straight"||A.edgeType==="haystack"){for(var b=A.allpts,_=0;_+3<b.length;_+=2)if(v0(r,e,b[_],b[_+1],b[_+2],b[_+3],E)&&B>(w=C0(r,e,b[_],b[_+1],b[_+2],b[_+3])))return p(D,w),!0}else if(A.edgeType==="bezier"||A.edgeType==="multibezier"||A.edgeType==="self"||A.edgeType==="compound"){for(var b=A.allpts,_=0;_+5<A.allpts.length;_+=4)if(p0(r,e,b[_],b[_+1],b[_+2],b[_+3],b[_+4],b[_+5],E)&&B>(w=y0(r,e,b[_],b[_+1],b[_+2],b[_+3],b[_+4],b[_+5])))return p(D,w),!0}for(var k=k||R.source,S=S||R.target,N=i.getArrowWidth(F,O),V=[{name:"source",x:A.arrowStartX,y:A.arrowStartY,angle:A.srcArrowAngle},{name:"target",x:A.arrowEndX,y:A.arrowEndY,angle:A.tgtArrowAngle},{name:"mid-source",x:A.midX,y:A.midY,angle:A.midsrcArrowAngle},{name:"mid-target",x:A.midX,y:A.midY,angle:A.midtgtArrowAngle}],_=0;_<V.length;_++){var z=V[_],H=a.arrowShapes[D.pstyle(z.name+"-arrow-shape").value],Y=D.pstyle("width").pfValue;if(H.roughCollide(r,e,N,z.angle,{x:z.x,y:z.y},Y,c)&&H.collide(r,e,N,z.angle,{x:z.x,y:z.y},Y,c))return p(D),!0}u&&s.length>0&&(g(k),g(S))}function C(D,R,A){return Tr(D,R,A)}function x(D,R){var A=D._private,F=f,O;R?O=R+"-":O="",D.boundingBox();var T=A.labelBounds[R||"main"],B=D.pstyle(O+"label").value,E=D.pstyle("text-events").strValue==="yes";if(!(!E||!B)){var w=C(A.rscratch,"labelX",R),b=C(A.rscratch,"labelY",R),_=C(A.rscratch,"labelAngle",R),k=D.pstyle(O+"text-margin-x").pfValue,S=D.pstyle(O+"text-margin-y").pfValue,N=T.x1-F-k,V=T.x2+F-k,z=T.y1-F-S,H=T.y2+F-S;if(_){var Y=Math.cos(_),ee=Math.sin(_),J=function(U,X){return U=U-w,X=X-b,{x:U*Y-X*ee+w,y:U*ee+X*Y+b}},ne=J(N,z),ie=J(N,H),K=J(V,z),L=J(V,H),j=[ne.x+k,ne.y+S,K.x+k,K.y+S,L.x+k,L.y+S,ie.x+k,ie.y+S];if(tr(r,e,j))return p(D),!0}else if(Si(T,r,e))return p(D),!0}}for(var M=o.length-1;M>=0;M--){var P=o[M];P.isNode()?g(P)||x(P):y(P)||x(P)||x(P,"source")||x(P,"target")}return s};Xn.getAllInBox=function(r,e,t,n){var i=this.getCachedZSortedEles().interactive,a=[],o=Math.min(r,t),s=Math.max(r,t),l=Math.min(e,n),u=Math.max(e,n);r=o,t=s,e=l,n=u;for(var c=rr({x1:r,y1:e,x2:t,y2:n}),d=0;d<i.length;d++){var f=i[d];if(f.isNode()){var h=f,v=h.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});su(c,v)&&!Nf(v,c)&&a.push(h)}else{var m=f,p=m._private,g=p.rscratch;if(g.startX!=null&&g.startY!=null&&!Si(c,g.startX,g.startY)||g.endX!=null&&g.endY!=null&&!Si(c,g.endX,g.endY))continue;if(g.edgeType==="bezier"||g.edgeType==="multibezier"||g.edgeType==="self"||g.edgeType==="compound"||g.edgeType==="segments"||g.edgeType==="haystack"){for(var y=p.rstyle.bezierPts||p.rstyle.linePts||p.rstyle.haystackPts,C=!0,x=0;x<y.length;x++)if(!h0(c,y[x])){C=!1;break}C&&a.push(m)}else(g.edgeType==="haystack"||g.edgeType==="straight")&&a.push(m)}}return a};var xs={};xs.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",o=e.edgeType==="compound",s=e.edgeType==="self",l,u,c,d,f,h,g,y;if(t?(c=e.haystackPts[0],d=e.haystackPts[1],f=e.haystackPts[2],h=e.haystackPts[3]):(c=e.arrowStartX,d=e.arrowStartY,f=e.arrowEndX,h=e.arrowEndY),g=e.midX,y=e.midY,a)l=c-e.segpts[0],u=d-e.segpts[1];else if(i||o||s||n){var v=e.allpts,m=St(v[0],v[2],v[4],.1),p=St(v[1],v[3],v[5],.1);l=c-m,u=d-p}else l=c-g,u=d-y;e.srcArrowAngle=Ho(l,u);var g=e.midX,y=e.midY;if(t&&(g=(c+f)/2,y=(d+h)/2),l=f-c,u=h-d,a){var v=e.allpts;if(v.length/2%2===0){var C=v.length/2,x=C-2;l=v[C]-v[x],u=v[C+1]-v[x+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var C=v.length/2-1,x=C-2;l=v[C]-v[x],u=v[C+1]-v[x+1]}}else if(i||o||s){var v=e.allpts,M=e.ctrlpts,P,D,R,A;if(M.length/2%2===0){var F=v.length/2-1,O=F+2,T=O+2;P=St(v[F],v[O],v[T],0),D=St(v[F+1],v[O+1],v[T+1],0),R=St(v[F],v[O],v[T],1e-4),A=St(v[F+1],v[O+1],v[T+1],1e-4)}else{var O=v.length/2-1,F=O-2,T=O+2;P=St(v[F],v[O],v[T],.4999),D=St(v[F+1],v[O+1],v[T+1],.4999),R=St(v[F],v[O],v[T],.5),A=St(v[F+1],v[O+1],v[T+1],.5)}l=R-P,u=A-D}if(e.midtgtArrowAngle=Ho(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var v=e.allpts;if(v.length/2%2!==0){if(!e.isRound){var C=v.length/2-1,B=C+2;l=-(v[B]-v[C]),u=-(v[B+1]-v[C+1])}}}if(e.midsrcArrowAngle=Ho(l,u),a)l=f-e.segpts[e.segpts.length-2],u=h-e.segpts[e.segpts.length-1];else if(i||o||s||n){var v=e.allpts,E=v.length,m=St(v[E-6],v[E-4],v[E-2],.9),p=St(v[E-5],v[E-3],v[E-1],.9);l=f-m,u=h-p}else l=f-g,u=h-y;e.tgtArrowAngle=Ho(l,u)};xs.getArrowWidth=xs.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[r+", "+e];return n||(n=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=n,n)};var Wl,Ul,Gr={},vr={},Kd,Xd,jn,ds,rn,Fn,zn,$r,gi,es,Ah,Bh,Kl,Xl,Yd,Qd=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},eb=function(e,t){t.x=e.x*-1,t.y=e.y*-1,t.nx=e.nx*-1,t.ny=e.ny*-1,t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},tb=function(e,t,n,i,a){if(e!==Yd?Qd(t,e,Gr):eb(vr,Gr),Qd(t,n,vr),Kd=Gr.nx*vr.ny-Gr.ny*vr.nx,Xd=Gr.nx*vr.nx-Gr.ny*-vr.ny,rn=Math.asin(Math.max(-1,Math.min(1,Kd))),Math.abs(rn)<1e-6){Wl=t.x,Ul=t.y,zn=gi=0;return}jn=1,ds=!1,Xd<0?rn<0?rn=Math.PI+rn:(rn=Math.PI-rn,jn=-1,ds=!0):rn>0&&(jn=-1,ds=!0),t.radius!==void 0?gi=t.radius:gi=i,Fn=rn/2,es=Math.min(Gr.len/2,vr.len/2),a?($r=Math.abs(Math.cos(Fn)*gi/Math.sin(Fn)),$r>es?($r=es,zn=Math.abs($r*Math.sin(Fn)/Math.cos(Fn))):zn=gi):($r=Math.min(es,gi),zn=Math.abs($r*Math.sin(Fn)/Math.cos(Fn))),Kl=t.x+vr.nx*$r,Xl=t.y+vr.ny*$r,Wl=Kl-vr.ny*zn*jn,Ul=Xl+vr.nx*zn*jn,Ah=t.x+Gr.nx*$r,Bh=t.y+Gr.ny*$r,Yd=t};function Rh(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function wu(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(tb(r,e,t,n,i),{cx:Wl,cy:Ul,radius:zn,startX:Ah,startY:Bh,stopX:Kl,stopY:Xl,startAngle:Gr.ang+Math.PI/2*jn,endAngle:vr.ang-Math.PI/2*jn,counterClockwise:ds})}var zt={};zt.findMidptPtsEtc=function(r,e){var t=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,o=r.pstyle("source-endpoint"),s=r.pstyle("target-endpoint"),l=o.units!=null&&s.units!=null,u=function(M,P,D,R){var A=R-P,F=D-M,O=Math.sqrt(F*F+A*A);return{x:-A/O,y:F/O}},c=r.pstyle("edge-distances").value;switch(c){case"node-position":a=t;break;case"intersection":a=n;break;case"endpoints":{if(l){var d=this.manualEndptToPx(r.source()[0],o),f=ft(d,2),h=f[0],v=f[1],m=this.manualEndptToPx(r.target()[0],s),p=ft(m,2),g=p[0],y=p[1],C={x1:h,y1:v,x2:g,y2:y};i=u(h,v,g,y),a=C}else Ye("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};zt.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],n=t._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var o=n.source,s=n.target,l=o.position(),u=s.position(),c=o.width(),d=s.width(),f=o.height(),h=s.height(),v=t.pstyle("haystack-radius").value,m=v/2;i.haystackPts=i.allpts=[i.source.x*c*m+l.x,i.source.y*f*m+l.y,i.target.x*d*m+u.x,i.target.y*h*m+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};zt.findSegmentsPoints=function(r,e){var t=r._private.rscratch,n=r.pstyle("segment-weights"),i=r.pstyle("segment-distances"),a=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),s=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],u=o.pfValue[o.pfValue.length-1];t.edgeType="segments",t.segpts=[],t.radii=[],t.isArcRadius=[];for(var c=0;c<s;c++){var d=n.pfValue[c],f=i.pfValue[c],h=1-d,v=d,m=this.findMidptPtsEtc(r,e),p=m.midptPts,g=m.vectorNormInverse,y={x:p.x1*h+p.x2*v,y:p.y1*h+p.y2*v};t.segpts.push(y.x+g.x*f,y.y+g.y*f),t.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:l),t.isArcRadius.push((o.pfValue[c]!==void 0?o.pfValue[c]:u)==="arc-radius")}};zt.findLoopPoints=function(r,e,t,n){var i=r._private.rscratch,a=e.dirCounts,o=e.srcPos,s=r.pstyle("control-point-distances"),l=s?s.pfValue[0]:void 0,u=r.pstyle("loop-direction").pfValue,c=r.pstyle("loop-sweep").pfValue,d=r.pstyle("control-point-step-size").pfValue;i.edgeType="self";var f=t,h=d;n&&(f=0,h=l);var v=u-Math.PI/2,m=v-c/2,p=v+c/2,g=u+"_"+c;f=a[g]===void 0?a[g]=0:++a[g],i.ctrlpts=[o.x+Math.cos(m)*1.4*h*(f/3+1),o.y+Math.sin(m)*1.4*h*(f/3+1),o.x+Math.cos(p)*1.4*h*(f/3+1),o.y+Math.sin(p)*1.4*h*(f/3+1)]};zt.findCompoundLoopPoints=function(r,e,t,n){var i=r._private.rscratch;i.edgeType="compound";var a=e.srcPos,o=e.tgtPos,s=e.srcW,l=e.srcH,u=e.tgtW,c=e.tgtH,d=r.pstyle("control-point-step-size").pfValue,f=r.pstyle("control-point-distances"),h=f?f.pfValue[0]:void 0,v=t,m=d;n&&(v=0,m=h);var p=50,g={x:a.x-s/2,y:a.y-l/2},y={x:o.x-u/2,y:o.y-c/2},C={x:Math.min(g.x,y.x),y:Math.min(g.y,y.y)},x=.5,M=Math.max(x,Math.log(s*.01)),P=Math.max(x,Math.log(u*.01));i.ctrlpts=[C.x,C.y-(1+Math.pow(p,1.12)/100)*m*(v/3+1)*M,C.x-(1+Math.pow(p,1.12)/100)*m*(v/3+1)*P,C.y]};zt.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};zt.findBezierPoints=function(r,e,t,n,i){var a=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,s=r.pstyle("control-point-distances"),l=r.pstyle("control-point-weights"),u=s&&l?Math.min(s.value.length,l.value.length):1,c=s?s.pfValue[0]:void 0,d=l.value[0],f=n;a.edgeType=f?"multibezier":"bezier",a.ctrlpts=[];for(var h=0;h<u;h++){var v=(.5-e.eles.length/2+t)*o*(i?-1:1),m=void 0,p=Lf(v);f&&(c=s?s.pfValue[h]:o,d=l.value[h]),n?m=c:m=c!==void 0?p*c:void 0;var g=m!==void 0?m:v,y=1-d,C=d,x=this.findMidptPtsEtc(r,e),M=x.midptPts,P=x.vectorNormInverse,D={x:M.x1*y+M.x2*C,y:M.y1*y+M.y2*C};a.ctrlpts.push(D.x+P.x*g,D.y+P.y*g)}};zt.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var n="vertical",i="horizontal",a="leftward",o="rightward",s="downward",l="upward",u="auto",c=e.posPts,d=e.srcW,f=e.srcH,h=e.tgtW,v=e.tgtH,m=r.pstyle("edge-distances").value,p=m!=="node-position",g=r.pstyle("taxi-direction").value,y=g,C=r.pstyle("taxi-turn"),x=C.units==="%",M=C.pfValue,P=M<0,D=r.pstyle("taxi-turn-min-distance").pfValue,R=p?(d+h)/2:0,A=p?(f+v)/2:0,F=c.x2-c.x1,O=c.y2-c.y1,T=function(le,ve){return le>0?Math.max(le-ve,0):Math.min(le+ve,0)},B=T(F,R),E=T(O,A),w=!1;y===u?g=Math.abs(B)>Math.abs(E)?i:n:y===l||y===s?(g=n,w=!0):(y===a||y===o)&&(g=i,w=!0);var b=g===n,_=b?E:B,k=b?O:F,S=Lf(k),N=!1;!(w&&(x||P))&&(y===s&&k<0||y===l&&k>0||y===a&&k>0||y===o&&k<0)&&(S*=-1,_=S*Math.abs(_),N=!0);var V;if(x){var z=M<0?1+M:M;V=z*_}else{var H=M<0?_:0;V=H+M*S}var Y=function(le){return Math.abs(le)<D||Math.abs(le)>=Math.abs(_)},ee=Y(V),J=Y(Math.abs(_)-Math.abs(V)),ne=ee||J;if(ne&&!N)if(b){var ie=Math.abs(k)<=f/2,K=Math.abs(F)<=h/2;if(ie){var L=(c.x1+c.x2)/2,j=c.y1,$=c.y2;t.segpts=[L,j,L,$]}else if(K){var U=(c.y1+c.y2)/2,X=c.x1,de=c.x2;t.segpts=[X,U,de,U]}else t.segpts=[c.x1,c.y2]}else{var Te=Math.abs(k)<=d/2,_e=Math.abs(O)<=v/2;if(Te){var fe=(c.y1+c.y2)/2,ce=c.x1,we=c.x2;t.segpts=[ce,fe,we,fe]}else if(_e){var Me=(c.x1+c.x2)/2,ke=c.y1,xe=c.y2;t.segpts=[Me,ke,Me,xe]}else t.segpts=[c.x2,c.y1]}else if(b){var Ee=c.y1+V+(p?f/2*S:0),ye=c.x1,se=c.x2;t.segpts=[ye,Ee,se,Ee]}else{var I=c.x1+V+(p?d/2*S:0),W=c.y1,oe=c.y2;t.segpts=[I,W,I,oe]}if(t.isRound){var Q=r.pstyle("taxi-radius").value,te=r.pstyle("radius-type").value[0]==="arc-radius";t.radii=new Array(t.segpts.length/2).fill(Q),t.isArcRadius=new Array(t.segpts.length/2).fill(te)}};zt.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,o=e.srcH,s=e.tgtW,l=e.tgtH,u=e.srcShape,c=e.tgtShape,d=e.srcCornerRadius,f=e.tgtCornerRadius,h=e.srcRs,v=e.tgtRs,m=!Ce(t.startX)||!Ce(t.startY),p=!Ce(t.arrowStartX)||!Ce(t.arrowStartY),g=!Ce(t.endX)||!Ce(t.endY),y=!Ce(t.arrowEndX)||!Ce(t.arrowEndY),C=3,x=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,M=C*x,P=qn({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),D=P<M,R=qn({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),A=R<M,F=!1;if(m||p||D){F=!0;var O={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},T=Math.sqrt(O.x*O.x+O.y*O.y),B={x:O.x/T,y:O.y/T},E=Math.max(a,o),w={x:t.ctrlpts[0]+B.x*2*E,y:t.ctrlpts[1]+B.y*2*E},b=u.intersectLine(n.x,n.y,a,o,w.x,w.y,0,d,h);D?(t.ctrlpts[0]=t.ctrlpts[0]+B.x*(M-P),t.ctrlpts[1]=t.ctrlpts[1]+B.y*(M-P)):(t.ctrlpts[0]=b[0]+B.x*M,t.ctrlpts[1]=b[1]+B.y*M)}if(g||y||A){F=!0;var _={x:t.ctrlpts[0]-i.x,y:t.ctrlpts[1]-i.y},k=Math.sqrt(_.x*_.x+_.y*_.y),S={x:_.x/k,y:_.y/k},N=Math.max(a,o),V={x:t.ctrlpts[0]+S.x*2*N,y:t.ctrlpts[1]+S.y*2*N},z=c.intersectLine(i.x,i.y,s,l,V.x,V.y,0,f,v);A?(t.ctrlpts[0]=t.ctrlpts[0]+S.x*(M-R),t.ctrlpts[1]=t.ctrlpts[1]+S.y*(M-R)):(t.ctrlpts[0]=z[0]+S.x*M,t.ctrlpts[1]=z[1]+S.y*M)}F&&this.findEndpoints(r)}};zt.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=St(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=St(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var o=e.radii[a/2-1],s=e.isArcRadius[a/2-1];e.roundCorners.push(wu({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:o},{x:e.allpts[a+2],y:e.allpts[a+3]},o,s))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var d={x:e.segpts[c],y:e.segpts[c+1]},f=e.roundCorners[c/2],h=[d.x-f.cx,d.y-f.cy],v=f.radius/Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2));h=h.map(function(m){return m*v}),e.midX=f.cx+h[0],e.midY=f.cy+h[1],e.midVector=h}}}};zt.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Ce(e.startX)&&Ce(e.startY)&&Ce(e.endX)&&Ce(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Ye("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};zt.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,n=t.cy,i=n.hasCompoundNodes(),a={map:new Hr,get:function(D){var R=this.map.get(D[0]);return R!=null?R.get(D[1]):null},set:function(D,R){var A=this.map.get(D[0]);A==null&&(A=new Hr,this.map.set(D[0],A)),A.set(D[1],R)}},o=[],s=[],l=0;l<r.length;l++){var u=r[l],c=u._private,d=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(d==="haystack"){s.push(u);continue}var f=d==="unbundled-bezier"||d.endsWith("segments")||d==="straight"||d==="straight-triangle"||d.endsWith("taxi"),h=d==="unbundled-bezier"||d==="bezier",v=c.source,m=c.target,p=v.poolIndex(),g=m.poolIndex(),y=[p,g].sort(),C=a.get(y);C==null&&(C={eles:[]},a.set(y,C),o.push(y)),C.eles.push(u),f&&(C.hasUnbundled=!0),h&&(C.hasBezier=!0)}}for(var x=function(D){var R=o[D],A=a.get(R),F=void 0;if(!A.hasUnbundled){var O=A.eles[0].parallelEdges().filter(function(I){return I.isBundledBezier()});au(A.eles),O.forEach(function(I){return A.eles.push(I)}),A.eles.sort(function(I,W){return I.poolIndex()-W.poolIndex()})}var T=A.eles[0],B=T.source(),E=T.target();if(B.poolIndex()>E.poolIndex()){var w=B;B=E,E=w}var b=A.srcPos=B.position(),_=A.tgtPos=E.position(),k=A.srcW=B.outerWidth(),S=A.srcH=B.outerHeight(),N=A.tgtW=E.outerWidth(),V=A.tgtH=E.outerHeight(),z=A.srcShape=t.nodeShapes[e.getNodeShape(B)],H=A.tgtShape=t.nodeShapes[e.getNodeShape(E)],Y=A.srcCornerRadius=B.pstyle("corner-radius").value==="auto"?"auto":B.pstyle("corner-radius").pfValue,ee=A.tgtCornerRadius=E.pstyle("corner-radius").value==="auto"?"auto":E.pstyle("corner-radius").pfValue,J=A.tgtRs=E._private.rscratch,ne=A.srcRs=B._private.rscratch;A.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var ie=0;ie<A.eles.length;ie++){var K=A.eles[ie],L=K[0]._private.rscratch,j=K.pstyle("curve-style").value,$=j==="unbundled-bezier"||j.endsWith("segments")||j.endsWith("taxi"),U=!B.same(K.source());if(!A.calculatedIntersection&&B!==E&&(A.hasBezier||A.hasUnbundled)){A.calculatedIntersection=!0;var X=z.intersectLine(b.x,b.y,k,S,_.x,_.y,0,Y,ne),de=A.srcIntn=X,Te=H.intersectLine(_.x,_.y,N,V,b.x,b.y,0,ee,J),_e=A.tgtIntn=Te,fe=A.intersectionPts={x1:X[0],x2:Te[0],y1:X[1],y2:Te[1]},ce=A.posPts={x1:b.x,x2:_.x,y1:b.y,y2:_.y},we=Te[1]-X[1],Me=Te[0]-X[0],ke=Math.sqrt(Me*Me+we*we),xe=A.vector={x:Me,y:we},Ee=A.vectorNorm={x:xe.x/ke,y:xe.y/ke},ye={x:-Ee.y,y:Ee.x};A.nodesOverlap=!Ce(ke)||H.checkPoint(X[0],X[1],0,N,V,_.x,_.y,ee,J)||z.checkPoint(Te[0],Te[1],0,k,S,b.x,b.y,Y,ne),A.vectorNormInverse=ye,F={nodesOverlap:A.nodesOverlap,dirCounts:A.dirCounts,calculatedIntersection:!0,hasBezier:A.hasBezier,hasUnbundled:A.hasUnbundled,eles:A.eles,srcPos:_,srcRs:J,tgtPos:b,tgtRs:ne,srcW:N,srcH:V,tgtW:k,tgtH:S,srcIntn:_e,tgtIntn:de,srcShape:H,tgtShape:z,posPts:{x1:ce.x2,y1:ce.y2,x2:ce.x1,y2:ce.y1},intersectionPts:{x1:fe.x2,y1:fe.y2,x2:fe.x1,y2:fe.y1},vector:{x:-xe.x,y:-xe.y},vectorNorm:{x:-Ee.x,y:-Ee.y},vectorNormInverse:{x:-ye.x,y:-ye.y}}}var se=U?F:A;L.nodesOverlap=se.nodesOverlap,L.srcIntn=se.srcIntn,L.tgtIntn=se.tgtIntn,L.isRound=j.startsWith("round"),i&&(B.isParent()||B.isChild()||E.isParent()||E.isChild())&&(B.parents().anySame(E)||E.parents().anySame(B)||B.same(E)&&B.isParent())?e.findCompoundLoopPoints(K,se,ie,$):B===E?e.findLoopPoints(K,se,ie,$):j.endsWith("segments")?e.findSegmentsPoints(K,se):j.endsWith("taxi")?e.findTaxiPoints(K,se):j==="straight"||!$&&A.eles.length%2===1&&ie===Math.floor(A.eles.length/2)?e.findStraightEdgePoints(K):e.findBezierPoints(K,se,ie,$,U),e.findEndpoints(K),e.tryToCorrectInvalidPoints(K,se),e.checkForInvalidEdgeWarning(K),e.storeAllpts(K),e.storeEdgeProjections(K),e.calculateArrowAngles(K),e.recalculateEdgeLabelProjections(K),e.calculateLabelAngles(K)}},M=0;M<o.length;M++)x(M);this.findHaystackPoints(s)}};function Ih(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var n=r[t],i=r[t+1];e.push({x:n,y:i})}return e}}zt.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="segments")return Ih(e.segpts)};zt.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return Ih(e.ctrlpts)};zt.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var Ma={};Ma.manualEndptToPx=function(r,e){var t=this,n=r.position(),i=r.outerWidth(),a=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var s=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(s[0]=s[0]*i),e.units[1]==="%"&&(s[1]=s[1]*a),s[0]+=n.x,s[1]+=n.y,s}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(i,a),c=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return t.nodeShapes[this.getNodeShape(r)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};Ma.findEndpoints=function(r){var e=this,t,n=r.source()[0],i=r.target()[0],a=n.position(),o=i.position(),s=r.pstyle("target-arrow-shape").value,l=r.pstyle("source-arrow-shape").value,u=r.pstyle("target-distance-from-node").pfValue,c=r.pstyle("source-distance-from-node").pfValue,d=n._private.rscratch,f=i._private.rscratch,h=r.pstyle("curve-style").value,v=r._private.rscratch,m=v.edgeType,p=h==="taxi",g=m==="self"||m==="compound",y=m==="bezier"||m==="multibezier"||g,C=m!=="bezier",x=m==="straight"||m==="segments",M=m==="segments",P=y||C||x,D=g||p,R=r.pstyle("source-endpoint"),A=D?"outside-to-node":R.value,F=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,O=r.pstyle("target-endpoint"),T=D?"outside-to-node":O.value,B=i.pstyle("corner-radius").value==="auto"?"auto":i.pstyle("corner-radius").pfValue;v.srcManEndpt=R,v.tgtManEndpt=O;var E,w,b,_;if(y){var k=[v.ctrlpts[0],v.ctrlpts[1]],S=C?[v.ctrlpts[v.ctrlpts.length-2],v.ctrlpts[v.ctrlpts.length-1]]:k;E=S,w=k}else if(x){var N=M?v.segpts.slice(0,2):[o.x,o.y],V=M?v.segpts.slice(v.segpts.length-2):[a.x,a.y];E=V,w=N}if(T==="inside-to-node")t=[o.x,o.y];else if(O.units)t=this.manualEndptToPx(i,O);else if(T==="outside-to-line")t=v.tgtIntn;else if(T==="outside-to-node"||T==="outside-to-node-or-label"?b=E:(T==="outside-to-line"||T==="outside-to-line-or-label")&&(b=[a.x,a.y]),t=e.nodeShapes[this.getNodeShape(i)].intersectLine(o.x,o.y,i.outerWidth(),i.outerHeight(),b[0],b[1],0,B,f),T==="outside-to-node-or-label"||T==="outside-to-line-or-label"){var z=i._private.rscratch,H=z.labelWidth,Y=z.labelHeight,ee=z.labelX,J=z.labelY,ne=H/2,ie=Y/2,K=i.pstyle("text-valign").value;K==="top"?J-=ie:K==="bottom"&&(J+=ie);var L=i.pstyle("text-halign").value;L==="left"?ee-=ne:L==="right"&&(ee+=ne);var j=pa(b[0],b[1],[ee-ne,J-ie,ee+ne,J-ie,ee+ne,J+ie,ee-ne,J+ie],o.x,o.y);if(j.length>0){var $=a,U=Vn($,yi(t)),X=Vn($,yi(j)),de=U;if(X<U&&(t=j,de=X),j.length>2){var Te=Vn($,{x:j[2],y:j[3]});Te<de&&(t=[j[2],j[3]])}}}var _e=Wo(t,E,e.arrowShapes[s].spacing(r)+u),fe=Wo(t,E,e.arrowShapes[s].gap(r)+u);if(v.endX=fe[0],v.endY=fe[1],v.arrowEndX=_e[0],v.arrowEndY=_e[1],A==="inside-to-node")t=[a.x,a.y];else if(R.units)t=this.manualEndptToPx(n,R);else if(A==="outside-to-line")t=v.srcIntn;else if(A==="outside-to-node"||A==="outside-to-node-or-label"?_=w:(A==="outside-to-line"||A==="outside-to-line-or-label")&&(_=[o.x,o.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(a.x,a.y,n.outerWidth(),n.outerHeight(),_[0],_[1],0,F,d),A==="outside-to-node-or-label"||A==="outside-to-line-or-label"){var ce=n._private.rscratch,we=ce.labelWidth,Me=ce.labelHeight,ke=ce.labelX,xe=ce.labelY,Ee=we/2,ye=Me/2,se=n.pstyle("text-valign").value;se==="top"?xe-=ye:se==="bottom"&&(xe+=ye);var I=n.pstyle("text-halign").value;I==="left"?ke-=Ee:I==="right"&&(ke+=Ee);var W=pa(_[0],_[1],[ke-Ee,xe-ye,ke+Ee,xe-ye,ke+Ee,xe+ye,ke-Ee,xe+ye],a.x,a.y);if(W.length>0){var oe=o,Q=Vn(oe,yi(t)),te=Vn(oe,yi(W)),he=Q;if(te<Q&&(t=[W[0],W[1]],he=te),W.length>2){var le=Vn(oe,{x:W[2],y:W[3]});le<he&&(t=[W[2],W[3]])}}}var ve=Wo(t,w,e.arrowShapes[l].spacing(r)+c),Ie=Wo(t,w,e.arrowShapes[l].gap(r)+c);v.startX=Ie[0],v.startY=Ie[1],v.arrowStartX=ve[0],v.arrowStartY=ve[1],P&&(!Ce(v.startX)||!Ce(v.startY)||!Ce(v.endX)||!Ce(v.endY)?v.badLine=!0:v.badLine=!1)};Ma.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};Ma.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var bu={};function rb(r,e,t){for(var n=function(u,c,d,f){return St(u,c,d,f)},i=e._private,a=i.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var s=r.bezierProjPcts[o];a.push({x:n(t[0],t[2],t[4],s),y:n(t[1],t[3],t[5],s)})}}bu.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,n=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<t.allpts.length;i+=4)rb(this,r,t.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<t.allpts.length;i+=2)a.push({x:t.allpts[i],y:t.allpts[i+1]});else if(n==="haystack"){var o=t.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};bu.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var Ur={};Ur.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!xn(e)){var t,n,i=r._private,a=r.width(),o=r.height(),s=r.padding(),l=r.position(),u=r.pstyle("text-halign").strValue,c=r.pstyle("text-valign").strValue,d=i.rscratch,f=i.rstyle;switch(u){case"left":t=l.x-a/2-s;break;case"right":t=l.x+a/2+s;break;default:t=l.x}switch(c){case"top":n=l.y-o/2-s;break;case"bottom":n=l.y+o/2+s;break;default:n=l.y}d.labelX=t,d.labelY=n,f.labelX=t,f.labelY=n,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var Oh=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n=n*-1),n},Fh=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Oh(n,i)},nb=function(e,t,n,i){var a=va(0,i-.001,1),o=va(0,i+.001,1),s=wi(e,t,n,a),l=wi(e,t,n,o);return Fh(s,l)};Ur.recalculateEdgeLabelProjections=function(r){var e,t=r._private,n=t.rscratch,i=this,a={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var o=function(d,f,h){yn(t.rscratch,d,f,h),yn(t.rstyle,d,f,h)};o("labelX",null,e.x),o("labelY",null,e.y);var s=Oh(n.midDispX,n.midDispY);o("labelAutoAngle",null,s);var l=function c(){if(c.cache)return c.cache;for(var d=[],f=0;f+5<n.allpts.length;f+=4){var h={x:n.allpts[f],y:n.allpts[f+1]},v={x:n.allpts[f+2],y:n.allpts[f+3]},m={x:n.allpts[f+4],y:n.allpts[f+5]};d.push({p0:h,p1:v,p2:m,startDist:0,length:0,segments:[]})}var p=t.rstyle.bezierPts,g=i.bezierProjPcts.length;function y(D,R,A,F,O){var T=qn(R,A),B=D.segments[D.segments.length-1],E={p0:R,p1:A,t0:F,t1:O,startDist:B?B.startDist+B.length:0,length:T};D.segments.push(E),D.length+=T}for(var C=0;C<d.length;C++){var x=d[C],M=d[C-1];M&&(x.startDist=M.startDist+M.length),y(x,x.p0,p[C*g],0,i.bezierProjPcts[0]);for(var P=0;P<g-1;P++)y(x,p[C*g+P],p[C*g+P+1],i.bezierProjPcts[P],i.bezierProjPcts[P+1]);y(x,p[C*g+g-1],x.p2,i.bezierProjPcts[g-1],1)}return c.cache=d},u=function(d){var f,h=d==="source";if(a[d]){var v=r.pstyle(d+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var m=l(),p,g=0,y=0,C=0;C<m.length;C++){for(var x=m[h?C:m.length-1-C],M=0;M<x.segments.length;M++){var P=x.segments[h?M:x.segments.length-1-M],D=C===m.length-1&&M===x.segments.length-1;if(g=y,y+=P.length,y>=v||D){p={cp:x,segment:P};break}}if(p)break}var R=p.cp,A=p.segment,F=(v-g)/A.length,O=A.t1-A.t0,T=h?A.t0+O*F:A.t1-O*F;T=va(0,T,1),e=wi(R.p0,R.p1,R.p2,T),f=nb(R.p0,R.p1,R.p2,T);break}case"straight":case"segments":case"haystack":{for(var B=0,E,w,b,_,k=n.allpts.length,S=0;S+3<k&&(h?(b={x:n.allpts[S],y:n.allpts[S+1]},_={x:n.allpts[S+2],y:n.allpts[S+3]}):(b={x:n.allpts[k-2-S],y:n.allpts[k-1-S]},_={x:n.allpts[k-4-S],y:n.allpts[k-3-S]}),E=qn(b,_),w=B,B+=E,!(B>=v));S+=2);var N=v-w,V=N/E;V=va(0,V,1),e=l0(b,_,V),f=Fh(b,_);break}}o("labelX",d,e.x),o("labelY",d,e.y),o("labelAutoAngle",d,f)}};u("source"),u("target"),this.applyLabelDimensions(r)}};Ur.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};Ur.applyPrefixedLabelDimensions=function(r,e){var t=r._private,n=this.getLabelText(r,e),i=this.calculateLabelDimensions(r,n),a=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,s=Tr(t.rscratch,"labelWrapCachedLines",e)||[],l=o!=="wrap"?1:Math.max(s.length,1),u=i.height/l,c=u*a,d=i.width,f=i.height+(l-1)*(a-1)*u;yn(t.rstyle,"labelWidth",e,d),yn(t.rscratch,"labelWidth",e,d),yn(t.rstyle,"labelHeight",e,f),yn(t.rscratch,"labelHeight",e,f),yn(t.rscratch,"labelLineHeight",e,c)};Ur.getLabelText=function(r,e){var t=r._private,n=e?e+"-":"",i=r.pstyle(n+"label").strValue,a=r.pstyle("text-transform").value,o=function(H,Y){return Y?(yn(t.rscratch,H,e,Y),Y):Tr(t.rscratch,H,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var s=r.pstyle("text-wrap").value;if(s==="wrap"){var l=o("labelKey");if(l!=null&&o("labelWrapKey")===l)return o("labelWrapCachedText");for(var u="\u200B",c=i.split(`
`),d=r.pstyle("text-max-width").pfValue,f=r.pstyle("text-overflow-wrap").value,h=f==="anywhere",v=[],m=/[\s\u200b]+|$/g,p=0;p<c.length;p++){var g=c[p],y=this.calculateLabelDimensions(r,g),C=y.width;if(h){var x=g.split("").join(u);g=x}if(C>d){var M=g.matchAll(m),P="",D=0,R=lr(M),A;try{for(R.s();!(A=R.n()).done;){var F=A.value,O=F[0],T=g.substring(D,F.index);D=F.index+O.length;var B=P.length===0?T:P+T+O,E=this.calculateLabelDimensions(r,B),w=E.width;w<=d?P+=T+O:(P&&v.push(P),P=T+O)}}catch(z){R.e(z)}finally{R.f()}P.match(/^[\s\u200b]+$/)||v.push(P)}else v.push(g)}o("labelWrapCachedLines",v),i=o("labelWrapCachedText",v.join(`
`)),o("labelWrapKey",l)}else if(s==="ellipsis"){var b=r.pstyle("text-max-width").pfValue,_="",k="\u2026",S=!1;if(this.calculateLabelDimensions(r,i).width<b)return i;for(var N=0;N<i.length;N++){var V=this.calculateLabelDimensions(r,_+i[N]+k).width;if(V>b)break;_+=i[N],N===i.length-1&&(S=!0)}return S||(_+=k),_}return i};Ur.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Ur.calculateLabelDimensions=function(r,e){var t=this,n=t.cy.window(),i=n.document,a=_n(e,r._private.labelDimsKey),o=t.labelDimCache||(t.labelDimCache=[]),s=o[a];if(s!=null)return s;var l=0,u=r.pstyle("font-style").strValue,c=r.pstyle("font-size").pfValue,d=r.pstyle("font-family").strValue,f=r.pstyle("font-weight").strValue,h=this.labelCalcCanvas,v=this.labelCalcCanvasContext;if(!h){h=this.labelCalcCanvas=i.createElement("canvas"),v=this.labelCalcCanvasContext=h.getContext("2d");var m=h.style;m.position="absolute",m.left="-9999px",m.top="-9999px",m.zIndex="-1",m.visibility="hidden",m.pointerEvents="none"}v.font="".concat(u," ").concat(f," ").concat(c,"px ").concat(d);for(var p=0,g=0,y=e.split(`
`),C=0;C<y.length;C++){var x=y[C],M=v.measureText(x),P=Math.ceil(M.width),D=c;p=Math.max(P,p),g+=D}return p+=l,g+=l,o[a]={width:p,height:g}};Ur.calculateLabelAngle=function(r,e){var t=r._private,n=t.rscratch,i=r.isEdge(),a=e?e+"-":"",o=r.pstyle(a+"text-rotation"),s=o.strValue;return s==="none"?0:i&&s==="autorotate"?n.labelAutoAngle:s==="autorotate"?0:o.pfValue};Ur.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),n=r._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(r),t&&(i.sourceLabelAngle=e.calculateLabelAngle(r,"source"),i.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var Lh={},Zd=28,Jd=!1;Lh.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<Zd||r.height()<Zd))return Jd||(Ye("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Jd=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return t};var zs={};zs.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,n=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),s)for(var l=0;l<o.length;l++){var u=o[l],c=u._private,d=c.rstyle;d.clean=!1,d.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(o){var s=o.target;n(s)}).on("style.* background.*",function(o){var s=o.target;n(s,!1)});var i=function(o){if(o){var s=t.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(n(u.connectedEdges()),c.cleanConnected=!0)}if(s)for(var d=0;d<s.length;d++){var f=s[d];f(o,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){i(!0)},t.beforeRender(i,t.beforeRenderPriorities.eleCalcs)};zs.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};zs.recalculateRenderedStyle=function(r,e){var t=function(x){return x._private.rstyle.cleanConnected},n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<r.length;a++){var o=r[a],s=o._private,l=s.rstyle;o.isEdge()&&(!t(o.source())||!t(o.target()))&&(l.clean=!1),!(e&&l.clean||o.removed())&&o.pstyle("display").value!=="none"&&(s.group==="nodes"?i.push(o):n.push(o),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],d=c._private,f=d.rstyle,h=c.position();this.recalculateNodeLabelProjection(c),f.nodeX=h.x,f.nodeY=h.y,f.nodeW=c.pstyle("width").pfValue,f.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var v=0;v<n.length;v++){var m=n[v],p=m._private,g=p.rstyle,y=p.rscratch;g.srcX=y.arrowStartX,g.srcY=y.arrowStartY,g.tgtX=y.arrowEndX,g.tgtY=y.arrowEndY,g.midX=y.midX,g.midY=y.midY,g.labelAngle=y.labelAngle,g.sourceLabelAngle=y.sourceLabelAngle,g.targetLabelAngle=y.targetLabelAngle}}};var js={};js.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var n=r[t],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?r.drag.push(n):r.nondrag.push(n)}for(var t=0;t<e.length;t++){var n=e[t];r.drag.push(n)}}};js.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};js.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(wh),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var Vh={};[Xn,xs,zt,Ma,bu,Ur,Lh,zs,js].forEach(function(r){Fe(Vh,r)});var Nh={};Nh.getCachedImage=function(r,e,t){var n=this,i=n.imageCache=n.imageCache||{},a=i[r];if(a)return a.image.complete||a.image.addEventListener("load",t),a.image;a=i[r]=i[r]||{};var o=a.image=new Image;o.addEventListener("load",t),o.addEventListener("error",function(){o.error=!0});var s="data:",l=r.substring(0,s.length).toLowerCase()===s;return l||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var Oi={};Oi.registerBinding=function(r,e,t,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var a=[],o=0;o<r.length;o++){var s=r[o];if(s!==void 0){var l=this.binder(s);a.push(l.on.apply(l,i))}}return a}var l=this.binder(r);return l.on.apply(l,i)};Oi.binder=function(r){var e=this,t=e.cy.window(),n=r===t||r===t.document||r===t.document.body||Dg(r);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});t.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var o=function(l,u,c){var d=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(d[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:d}),(r.addEventListener||r.on).apply(r,d),this};return{on:o,addEventListener:o,addListener:o,bind:o}};Oi.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};Oi.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};Oi.load=function(){var r=this,e=r.cy.window(),t=function(I){return I.selected()},n=function(I){var W=I.getRootNode();if(W&&W.nodeType===11&&W.host!==void 0)return W},i=function(I,W,oe,Q){I==null&&(I=r.cy);for(var te=0;te<W.length;te++){var he=W[te];I.emit({originalEvent:oe,type:he,position:Q})}},a=function(I){return I.shiftKey||I.metaKey||I.ctrlKey},o=function(I,W){var oe=!0;if(r.cy.hasCompoundNodes()&&I&&I.pannable())for(var Q=0;W&&Q<W.length;Q++){var I=W[Q];if(I.isNode()&&I.isParent()&&!I.pannable()){oe=!1;break}}else oe=!0;return oe},s=function(I){I[0]._private.grabbed=!0},l=function(I){I[0]._private.grabbed=!1},u=function(I){I[0]._private.rscratch.inDragLayer=!0},c=function(I){I[0]._private.rscratch.inDragLayer=!1},d=function(I){I[0]._private.rscratch.isGrabTarget=!0},f=function(I){I[0]._private.rscratch.isGrabTarget=!1},h=function(I,W){var oe=W.addToList,Q=oe.has(I);!Q&&I.grabbable()&&!I.locked()&&(oe.merge(I),s(I))},v=function(I,W){if(I.cy().hasCompoundNodes()&&!(W.inDragLayer==null&&W.addToList==null)){var oe=I.descendants();W.inDragLayer&&(oe.forEach(u),oe.connectedEdges().forEach(u)),W.addToList&&h(oe,W)}},m=function(I,W){W=W||{};var oe=I.cy().hasCompoundNodes();W.inDragLayer&&(I.forEach(u),I.neighborhood().stdFilter(function(Q){return!oe||Q.isEdge()}).forEach(u)),W.addToList&&I.forEach(function(Q){h(Q,W)}),v(I,W),y(I,{inDragLayer:W.inDragLayer}),r.updateCachedGrabbedEles()},p=m,g=function(I){I&&(r.getCachedZSortedEles().forEach(function(W){l(W),c(W),f(W)}),r.updateCachedGrabbedEles())},y=function(I,W){if(!(W.inDragLayer==null&&W.addToList==null)&&I.cy().hasCompoundNodes()){var oe=I.ancestors().orphans();if(!oe.same(I)){var Q=oe.descendants().spawnSelf().merge(oe).unmerge(I).unmerge(I.descendants()),te=Q.connectedEdges();W.inDragLayer&&(te.forEach(u),Q.forEach(u)),W.addToList&&Q.forEach(function(he){h(he,W)})}}},C=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},x=typeof MutationObserver<"u",M=typeof ResizeObserver<"u";x?(r.removeObserver=new MutationObserver(function(se){for(var I=0;I<se.length;I++){var W=se[I],oe=W.removedNodes;if(oe)for(var Q=0;Q<oe.length;Q++){var te=oe[Q];if(te===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(se){r.destroy()});var P=Ea(function(){r.cy.resize()},100);x&&(r.styleObserver=new MutationObserver(P),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",P),M&&(r.resizeObserver=new ResizeObserver(P),r.resizeObserver.observe(r.container));var D=function(I,W){for(;I!=null;)W(I),I=I.parentNode},R=function(){r.invalidateContainerClientCoordsCache()};D(r.container,function(se){r.registerBinding(se,"transitionend",R),r.registerBinding(se,"animationend",R),r.registerBinding(se,"scroll",R)}),r.registerBinding(r.container,"contextmenu",function(se){se.preventDefault()});var A=function(){return r.selection[4]!==0},F=function(I){for(var W=r.findContainerClientCoords(),oe=W[0],Q=W[1],te=W[2],he=W[3],le=I.touches?I.touches:[I],ve=!1,Ie=0;Ie<le.length;Ie++){var ze=le[Ie];if(oe<=ze.clientX&&ze.clientX<=oe+te&&Q<=ze.clientY&&ze.clientY<=Q+he){ve=!0;break}}if(!ve)return!1;for(var Ae=r.container,Ve=I.target,Ne=Ve.parentNode,Le=!1;Ne;){if(Ne===Ae){Le=!0;break}Ne=Ne.parentNode}return!!Le};r.registerBinding(r.container,"mousedown",function(I){if(F(I)&&!(r.hoverData.which===1&&I.which!==1)){I.preventDefault(),C(),r.hoverData.capture=!0,r.hoverData.which=I.which;var W=r.cy,oe=[I.clientX,I.clientY],Q=r.projectIntoViewport(oe[0],oe[1]),te=r.selection,he=r.findNearestElements(Q[0],Q[1],!0,!1),le=he[0],ve=r.dragData.possibleDragElements;r.hoverData.mdownPos=Q,r.hoverData.mdownGPos=oe;var Ie=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var Je=r.hoverData.down;Je?Je.emit({originalEvent:I,type:"taphold",position:{x:Q[0],y:Q[1]}}):W.emit({originalEvent:I,type:"taphold",position:{x:Q[0],y:Q[1]}})}},r.tapholdDuration)};if(I.which==3){r.hoverData.cxtStarted=!0;var ze={originalEvent:I,type:"cxttapstart",position:{x:Q[0],y:Q[1]}};le?(le.activate(),le.emit(ze),r.hoverData.down=le):W.emit(ze),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(I.which==1){le&&le.activate();{if(le!=null&&r.nodeIsGrabbable(le)){var Ae=function(Je){return{originalEvent:I,type:Je,position:{x:Q[0],y:Q[1]}}},Ve=function(Je){Je.emit(Ae("grab"))};if(d(le),!le.selected())ve=r.dragData.possibleDragElements=W.collection(),p(le,{addToList:ve}),le.emit(Ae("grabon")).emit(Ae("grab"));else{ve=r.dragData.possibleDragElements=W.collection();var Ne=W.$(function(Le){return Le.isNode()&&Le.selected()&&r.nodeIsGrabbable(Le)});m(Ne,{addToList:ve}),le.emit(Ae("grabon")),Ne.forEach(Ve)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=le,r.hoverData.downs=he,r.hoverData.downTime=new Date().getTime()}i(le,["mousedown","tapstart","vmousedown"],I,{x:Q[0],y:Q[1]}),le==null?(te[4]=1,r.data.bgActivePosistion={x:Q[0],y:Q[1]},r.redrawHint("select",!0),r.redraw()):le.pannable()&&(te[4]=1),Ie()}te[0]=te[2]=Q[0],te[1]=te[3]=Q[1]}},!1);var O=n(r.container);r.registerBinding([e,O],"mousemove",function(I){var W=r.hoverData.capture;if(!(!W&&!F(I))){var oe=!1,Q=r.cy,te=Q.zoom(),he=[I.clientX,I.clientY],le=r.projectIntoViewport(he[0],he[1]),ve=r.hoverData.mdownPos,Ie=r.hoverData.mdownGPos,ze=r.selection,Ae=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(Ae=r.findNearestElement(le[0],le[1],!0,!1));var Ve=r.hoverData.last,Ne=r.hoverData.down,Le=[le[0]-ze[2],le[1]-ze[3]],Je=r.dragData.possibleDragElements,at;if(Ie){var ar=he[0]-Ie[0],or=ar*ar,ht=he[1]-Ie[1],Ct=ht*ht,wt=or+Ct;r.hoverData.isOverThresholdDrag=at=wt>=r.desktopTapThreshold2}var jt=a(I);at&&(r.hoverData.tapholdCancelled=!0);var $t=function(){var Ir=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Ir.length===0?(Ir.push(Le[0]),Ir.push(Le[1])):(Ir[0]+=Le[0],Ir[1]+=Le[1])};oe=!0,i(Ae,["mousemove","vmousemove","tapdrag"],I,{x:le[0],y:le[1]});var Br=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||Q.emit({originalEvent:I,type:"boxstart",position:{x:le[0],y:le[1]}}),ze[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(at){var cr={originalEvent:I,type:"cxtdrag",position:{x:le[0],y:le[1]}};Ne?Ne.emit(cr):Q.emit(cr),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||Ae!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:I,type:"cxtdragout",position:{x:le[0],y:le[1]}}),r.hoverData.cxtOver=Ae,Ae&&Ae.emit({originalEvent:I,type:"cxtdragover",position:{x:le[0],y:le[1]}}))}}else if(r.hoverData.dragging){if(oe=!0,Q.panningEnabled()&&Q.userPanningEnabled()){var Rr;if(r.hoverData.justStartedPan){var Qr=r.hoverData.mdownPos;Rr={x:(le[0]-Qr[0])*te,y:(le[1]-Qr[1])*te},r.hoverData.justStartedPan=!1}else Rr={x:Le[0]*te,y:Le[1]*te};Q.panBy(Rr),Q.emit("dragpan"),r.hoverData.dragged=!0}le=r.projectIntoViewport(I.clientX,I.clientY)}else if(ze[4]==1&&(Ne==null||Ne.pannable())){if(at){if(!r.hoverData.dragging&&Q.boxSelectionEnabled()&&(jt||!Q.panningEnabled()||!Q.userPanningEnabled()))Br();else if(!r.hoverData.selecting&&Q.panningEnabled()&&Q.userPanningEnabled()){var Zr=o(Ne,r.hoverData.downs);Zr&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,ze[4]=0,r.data.bgActivePosistion=yi(ve),r.redrawHint("select",!0),r.redraw())}Ne&&Ne.pannable()&&Ne.active()&&Ne.unactivate()}}else{if(Ne&&Ne.pannable()&&Ne.active()&&Ne.unactivate(),(!Ne||!Ne.grabbed())&&Ae!=Ve&&(Ve&&i(Ve,["mouseout","tapdragout"],I,{x:le[0],y:le[1]}),Ae&&i(Ae,["mouseover","tapdragover"],I,{x:le[0],y:le[1]}),r.hoverData.last=Ae),Ne)if(at){if(Q.boxSelectionEnabled()&&jt)Ne&&Ne.grabbed()&&(g(Je),Ne.emit("freeon"),Je.emit("free"),r.dragData.didDrag&&(Ne.emit("dragfreeon"),Je.emit("dragfree"))),Br();else if(Ne&&Ne.grabbed()&&r.nodeIsDraggable(Ne)){var At=!r.dragData.didDrag;At&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||m(Je,{inDragLayer:!0});var bt={x:0,y:0};if(Ce(Le[0])&&Ce(Le[1])&&(bt.x+=Le[0],bt.y+=Le[1],At)){var Ht=r.hoverData.dragDelta;Ht&&Ce(Ht[0])&&Ce(Ht[1])&&(bt.x+=Ht[0],bt.y+=Ht[1])}r.hoverData.draggingEles=!0,Je.silentShift(bt).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else $t();oe=!0}if(ze[2]=le[0],ze[3]=le[1],oe)return I.stopPropagation&&I.stopPropagation(),I.preventDefault&&I.preventDefault(),!1}},!1);var T,B,E;r.registerBinding(e,"mouseup",function(I){if(!(r.hoverData.which===1&&I.which!==1&&r.hoverData.capture)){var W=r.hoverData.capture;if(W){r.hoverData.capture=!1;var oe=r.cy,Q=r.projectIntoViewport(I.clientX,I.clientY),te=r.selection,he=r.findNearestElement(Q[0],Q[1],!0,!1),le=r.dragData.possibleDragElements,ve=r.hoverData.down,Ie=a(I);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,ve&&ve.unactivate(),r.hoverData.which===3){var ze={originalEvent:I,type:"cxttapend",position:{x:Q[0],y:Q[1]}};if(ve?ve.emit(ze):oe.emit(ze),!r.hoverData.cxtDragged){var Ae={originalEvent:I,type:"cxttap",position:{x:Q[0],y:Q[1]}};ve?ve.emit(Ae):oe.emit(Ae)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(i(he,["mouseup","tapend","vmouseup"],I,{x:Q[0],y:Q[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(i(ve,["click","tap","vclick"],I,{x:Q[0],y:Q[1]}),B=!1,I.timeStamp-E<=oe.multiClickDebounceTime()?(T&&clearTimeout(T),B=!0,E=null,i(ve,["dblclick","dbltap","vdblclick"],I,{x:Q[0],y:Q[1]})):(T=setTimeout(function(){B||i(ve,["oneclick","onetap","voneclick"],I,{x:Q[0],y:Q[1]})},oe.multiClickDebounceTime()),E=I.timeStamp)),ve==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!a(I)&&(oe.$(t).unselect(["tapunselect"]),le.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=le=oe.collection()),he==ve&&!r.dragData.didDrag&&!r.hoverData.selecting&&he!=null&&he._private.selectable&&(r.hoverData.dragging||(oe.selectionType()==="additive"||Ie?he.selected()?he.unselect(["tapunselect"]):he.select(["tapselect"]):Ie||(oe.$(t).unmerge(he).unselect(["tapunselect"]),he.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var Ve=oe.collection(r.getAllInBox(te[0],te[1],te[2],te[3]));r.redrawHint("select",!0),Ve.length>0&&r.redrawHint("eles",!0),oe.emit({type:"boxend",originalEvent:I,position:{x:Q[0],y:Q[1]}});var Ne=function(at){return at.selectable()&&!at.selected()};oe.selectionType()==="additive"||Ie||oe.$(t).unmerge(Ve).unselect(),Ve.emit("box").stdFilter(Ne).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!te[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Le=ve&&ve.grabbed();g(le),Le&&(ve.emit("freeon"),le.emit("free"),r.dragData.didDrag&&(ve.emit("dragfreeon"),le.emit("dragfree")))}}te[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var w=function(I){if(!r.scrollingPage){var W=r.cy,oe=W.zoom(),Q=W.pan(),te=r.projectIntoViewport(I.clientX,I.clientY),he=[te[0]*oe+Q.x,te[1]*oe+Q.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||A()){I.preventDefault();return}if(W.panningEnabled()&&W.userPanningEnabled()&&W.zoomingEnabled()&&W.userZoomingEnabled()){I.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var le;I.deltaY!=null?le=I.deltaY/-250:I.wheelDeltaY!=null?le=I.wheelDeltaY/1e3:le=I.wheelDelta/1e3,le=le*r.wheelSensitivity;var ve=I.deltaMode===1;ve&&(le*=33);var Ie=W.zoom()*Math.pow(10,le);I.type==="gesturechange"&&(Ie=r.gestureStartZoom*I.scale),W.zoom({level:Ie,renderedPosition:{x:he[0],y:he[1]}}),W.emit(I.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",w,!0),r.registerBinding(e,"scroll",function(I){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(I){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||I.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(se){r.hasTouchStarted||w(se)},!0),r.registerBinding(r.container,"mouseout",function(I){var W=r.projectIntoViewport(I.clientX,I.clientY);r.cy.emit({originalEvent:I,type:"mouseout",position:{x:W[0],y:W[1]}})},!1),r.registerBinding(r.container,"mouseover",function(I){var W=r.projectIntoViewport(I.clientX,I.clientY);r.cy.emit({originalEvent:I,type:"mouseover",position:{x:W[0],y:W[1]}})},!1);var b,_,k,S,N,V,z,H,Y,ee,J,ne,ie,K=function(I,W,oe,Q){return Math.sqrt((oe-I)*(oe-I)+(Q-W)*(Q-W))},L=function(I,W,oe,Q){return(oe-I)*(oe-I)+(Q-W)*(Q-W)},j;r.registerBinding(r.container,"touchstart",j=function(I){if(r.hasTouchStarted=!0,!!F(I)){C(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var W=r.cy,oe=r.touchData.now,Q=r.touchData.earlier;if(I.touches[0]){var te=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);oe[0]=te[0],oe[1]=te[1]}if(I.touches[1]){var te=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);oe[2]=te[0],oe[3]=te[1]}if(I.touches[2]){var te=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);oe[4]=te[0],oe[5]=te[1]}if(I.touches[1]){r.touchData.singleTouchMoved=!0,g(r.dragData.touchDragEles);var he=r.findContainerClientCoords();Y=he[0],ee=he[1],J=he[2],ne=he[3],b=I.touches[0].clientX-Y,_=I.touches[0].clientY-ee,k=I.touches[1].clientX-Y,S=I.touches[1].clientY-ee,ie=0<=b&&b<=J&&0<=k&&k<=J&&0<=_&&_<=ne&&0<=S&&S<=ne;var le=W.pan(),ve=W.zoom();N=K(b,_,k,S),V=L(b,_,k,S),z=[(b+k)/2,(_+S)/2],H=[(z[0]-le.x)/ve,(z[1]-le.y)/ve];var Ie=200,ze=Ie*Ie;if(V<ze&&!I.touches[2]){var Ae=r.findNearestElement(oe[0],oe[1],!0,!0),Ve=r.findNearestElement(oe[2],oe[3],!0,!0);Ae&&Ae.isNode()?(Ae.activate().emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start=Ae):Ve&&Ve.isNode()?(Ve.activate().emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start=Ve):W.emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(I.touches[2])W.boxSelectionEnabled()&&I.preventDefault();else if(!I.touches[1]){if(I.touches[0]){var Ne=r.findNearestElements(oe[0],oe[1],!0,!0),Le=Ne[0];if(Le!=null&&(Le.activate(),r.touchData.start=Le,r.touchData.starts=Ne,r.nodeIsGrabbable(Le))){var Je=r.dragData.touchDragEles=W.collection(),at=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Le.selected()?(at=W.$(function(wt){return wt.selected()&&r.nodeIsGrabbable(wt)}),m(at,{addToList:Je})):p(Le,{addToList:Je}),d(Le);var ar=function(jt){return{originalEvent:I,type:jt,position:{x:oe[0],y:oe[1]}}};Le.emit(ar("grabon")),at?at.forEach(function(wt){wt.emit(ar("grab"))}):Le.emit(ar("grab"))}i(Le,["touchstart","tapstart","vmousedown"],I,{x:oe[0],y:oe[1]}),Le==null&&(r.data.bgActivePosistion={x:te[0],y:te[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&i(r.touchData.start,["taphold"],I,{x:oe[0],y:oe[1]})},r.tapholdDuration)}}if(I.touches.length>=1){for(var or=r.touchData.startPosition=[null,null,null,null,null,null],ht=0;ht<oe.length;ht++)or[ht]=Q[ht]=oe[ht];var Ct=I.touches[0];r.touchData.startGPosition=[Ct.clientX,Ct.clientY]}}},!1);var $;r.registerBinding(e,"touchmove",$=function(I){var W=r.touchData.capture;if(!(!W&&!F(I))){var oe=r.selection,Q=r.cy,te=r.touchData.now,he=r.touchData.earlier,le=Q.zoom();if(I.touches[0]){var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);te[0]=ve[0],te[1]=ve[1]}if(I.touches[1]){var ve=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);te[2]=ve[0],te[3]=ve[1]}if(I.touches[2]){var ve=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);te[4]=ve[0],te[5]=ve[1]}var Ie=r.touchData.startGPosition,ze;if(W&&I.touches[0]&&Ie){for(var Ae=[],Ve=0;Ve<te.length;Ve++)Ae[Ve]=te[Ve]-he[Ve];var Ne=I.touches[0].clientX-Ie[0],Le=Ne*Ne,Je=I.touches[0].clientY-Ie[1],at=Je*Je,ar=Le+at;ze=ar>=r.touchTapThreshold2}if(W&&r.touchData.cxt){I.preventDefault();var or=I.touches[0].clientX-Y,ht=I.touches[0].clientY-ee,Ct=I.touches[1].clientX-Y,wt=I.touches[1].clientY-ee,jt=L(or,ht,Ct,wt),$t=jt/V,Br=150,cr=Br*Br,Rr=1.5,Qr=Rr*Rr;if($t>=Qr||jt>=cr){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Zr={originalEvent:I,type:"cxttapend",position:{x:te[0],y:te[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(Zr),r.touchData.start=null):Q.emit(Zr)}}if(W&&r.touchData.cxt){var Zr={originalEvent:I,type:"cxtdrag",position:{x:te[0],y:te[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(Zr):Q.emit(Zr),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var At=r.findNearestElement(te[0],te[1],!0,!0);(!r.touchData.cxtOver||At!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:I,type:"cxtdragout",position:{x:te[0],y:te[1]}}),r.touchData.cxtOver=At,At&&At.emit({originalEvent:I,type:"cxtdragover",position:{x:te[0],y:te[1]}}))}else if(W&&I.touches[2]&&Q.boxSelectionEnabled())I.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||Q.emit({originalEvent:I,type:"boxstart",position:{x:te[0],y:te[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,oe[4]=1,!oe||oe.length===0||oe[0]===void 0?(oe[0]=(te[0]+te[2]+te[4])/3,oe[1]=(te[1]+te[3]+te[5])/3,oe[2]=(te[0]+te[2]+te[4])/3+1,oe[3]=(te[1]+te[3]+te[5])/3+1):(oe[2]=(te[0]+te[2]+te[4])/3,oe[3]=(te[1]+te[3]+te[5])/3),r.redrawHint("select",!0),r.redraw();else if(W&&I.touches[1]&&!r.touchData.didSelect&&Q.zoomingEnabled()&&Q.panningEnabled()&&Q.userZoomingEnabled()&&Q.userPanningEnabled()){I.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var bt=r.dragData.touchDragEles;if(bt){r.redrawHint("drag",!0);for(var Ht=0;Ht<bt.length;Ht++){var $a=bt[Ht]._private;$a.grabbed=!1,$a.rscratch.inDragLayer=!1}}var Ir=r.touchData.start,or=I.touches[0].clientX-Y,ht=I.touches[0].clientY-ee,Ct=I.touches[1].clientX-Y,wt=I.touches[1].clientY-ee,Ku=K(or,ht,Ct,wt),op=Ku/N;if(ie){var sp=or-b,lp=ht-_,up=Ct-k,cp=wt-S,dp=(sp+up)/2,fp=(lp+cp)/2,Gi=Q.zoom(),il=Gi*op,Ga=Q.pan(),Xu=H[0]*Gi+Ga.x,Yu=H[1]*Gi+Ga.y,hp={x:-il/Gi*(Xu-Ga.x-dp)+Xu,y:-il/Gi*(Yu-Ga.y-fp)+Yu};if(Ir&&Ir.active()){var bt=r.dragData.touchDragEles;g(bt),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Ir.unactivate().emit("freeon"),bt.emit("free"),r.dragData.didDrag&&(Ir.emit("dragfreeon"),bt.emit("dragfree"))}Q.viewport({zoom:il,pan:hp,cancelOnFailedZoom:!0}),Q.emit("pinchzoom"),N=Ku,b=or,_=ht,k=Ct,S=wt,r.pinching=!0}if(I.touches[0]){var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);te[0]=ve[0],te[1]=ve[1]}if(I.touches[1]){var ve=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);te[2]=ve[0],te[3]=ve[1]}if(I.touches[2]){var ve=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);te[4]=ve[0],te[5]=ve[1]}}else if(I.touches[0]&&!r.touchData.didSelect){var Cr=r.touchData.start,al=r.touchData.last,At;if(!r.hoverData.draggingEles&&!r.swipePanning&&(At=r.findNearestElement(te[0],te[1],!0,!0)),W&&Cr!=null&&I.preventDefault(),W&&Cr!=null&&r.nodeIsDraggable(Cr))if(ze){var bt=r.dragData.touchDragEles,Qu=!r.dragData.didDrag;Qu&&m(bt,{inDragLayer:!0}),r.dragData.didDrag=!0;var qi={x:0,y:0};if(Ce(Ae[0])&&Ce(Ae[1])&&(qi.x+=Ae[0],qi.y+=Ae[1],Qu)){r.redrawHint("eles",!0);var wr=r.touchData.dragDelta;wr&&Ce(wr[0])&&Ce(wr[1])&&(qi.x+=wr[0],qi.y+=wr[1])}r.hoverData.draggingEles=!0,bt.silentShift(qi).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==he[0]&&r.touchData.startPosition[1]==he[1]&&r.redrawHint("eles",!0),r.redraw()}else{var wr=r.touchData.dragDelta=r.touchData.dragDelta||[];wr.length===0?(wr.push(Ae[0]),wr.push(Ae[1])):(wr[0]+=Ae[0],wr[1]+=Ae[1])}if(i(Cr||At,["touchmove","tapdrag","vmousemove"],I,{x:te[0],y:te[1]}),(!Cr||!Cr.grabbed())&&At!=al&&(al&&al.emit({originalEvent:I,type:"tapdragout",position:{x:te[0],y:te[1]}}),At&&At.emit({originalEvent:I,type:"tapdragover",position:{x:te[0],y:te[1]}})),r.touchData.last=At,W)for(var Ht=0;Ht<te.length;Ht++)te[Ht]&&r.touchData.startPosition[Ht]&&ze&&(r.touchData.singleTouchMoved=!0);if(W&&(Cr==null||Cr.pannable())&&Q.panningEnabled()&&Q.userPanningEnabled()){var vp=o(Cr,r.touchData.starts);vp&&(I.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=yi(r.touchData.startPosition)),r.swipePanning?(Q.panBy({x:Ae[0]*le,y:Ae[1]*le}),Q.emit("dragpan")):ze&&(r.swipePanning=!0,Q.panBy({x:Ne*le,y:Je*le}),Q.emit("dragpan"),Cr&&(Cr.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);te[0]=ve[0],te[1]=ve[1]}}for(var Ve=0;Ve<te.length;Ve++)he[Ve]=te[Ve];W&&I.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var U;r.registerBinding(e,"touchcancel",U=function(I){var W=r.touchData.start;r.touchData.capture=!1,W&&W.unactivate()});var X,de,Te,_e;if(r.registerBinding(e,"touchend",X=function(I){var W=r.touchData.start,oe=r.touchData.capture;if(oe)I.touches.length===0&&(r.touchData.capture=!1),I.preventDefault();else return;var Q=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var te=r.cy,he=te.zoom(),le=r.touchData.now,ve=r.touchData.earlier;if(I.touches[0]){var Ie=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);le[0]=Ie[0],le[1]=Ie[1]}if(I.touches[1]){var Ie=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);le[2]=Ie[0],le[3]=Ie[1]}if(I.touches[2]){var Ie=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);le[4]=Ie[0],le[5]=Ie[1]}W&&W.unactivate();var ze;if(r.touchData.cxt){if(ze={originalEvent:I,type:"cxttapend",position:{x:le[0],y:le[1]}},W?W.emit(ze):te.emit(ze),!r.touchData.cxtDragged){var Ae={originalEvent:I,type:"cxttap",position:{x:le[0],y:le[1]}};W?W.emit(Ae):te.emit(Ae)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!I.touches[2]&&te.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var Ve=te.collection(r.getAllInBox(Q[0],Q[1],Q[2],Q[3]));Q[0]=void 0,Q[1]=void 0,Q[2]=void 0,Q[3]=void 0,Q[4]=0,r.redrawHint("select",!0),te.emit({type:"boxend",originalEvent:I,position:{x:le[0],y:le[1]}});var Ne=function(cr){return cr.selectable()&&!cr.selected()};Ve.emit("box").stdFilter(Ne).select().emit("boxselect"),Ve.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(W?.unactivate(),I.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!I.touches[1]){if(!I.touches[0]){if(!I.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Le=r.dragData.touchDragEles;if(W!=null){var Je=W._private.grabbed;g(Le),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Je&&(W.emit("freeon"),Le.emit("free"),r.dragData.didDrag&&(W.emit("dragfreeon"),Le.emit("dragfree"))),i(W,["touchend","tapend","vmouseup","tapdragout"],I,{x:le[0],y:le[1]}),W.unactivate(),r.touchData.start=null}else{var at=r.findNearestElement(le[0],le[1],!0,!0);i(at,["touchend","tapend","vmouseup","tapdragout"],I,{x:le[0],y:le[1]})}var ar=r.touchData.startPosition[0]-le[0],or=ar*ar,ht=r.touchData.startPosition[1]-le[1],Ct=ht*ht,wt=or+Ct,jt=wt*he*he;r.touchData.singleTouchMoved||(W||te.$(":selected").unselect(["tapunselect"]),i(W,["tap","vclick"],I,{x:le[0],y:le[1]}),de=!1,I.timeStamp-_e<=te.multiClickDebounceTime()?(Te&&clearTimeout(Te),de=!0,_e=null,i(W,["dbltap","vdblclick"],I,{x:le[0],y:le[1]})):(Te=setTimeout(function(){de||i(W,["onetap","voneclick"],I,{x:le[0],y:le[1]})},te.multiClickDebounceTime()),_e=I.timeStamp)),W!=null&&!r.dragData.didDrag&&W._private.selectable&&jt<r.touchTapThreshold2&&!r.pinching&&(te.selectionType()==="single"?(te.$(t).unmerge(W).unselect(["tapunselect"]),W.select(["tapselect"])):W.selected()?W.unselect(["tapunselect"]):W.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var $t=0;$t<le.length;$t++)ve[$t]=le[$t];r.dragData.didDrag=!1,I.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),I.touches.length<2&&(I.touches.length===1&&(r.touchData.startGPosition=[I.touches[0].clientX,I.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var fe=[],ce=function(I){return{clientX:I.clientX,clientY:I.clientY,force:1,identifier:I.pointerId,pageX:I.pageX,pageY:I.pageY,radiusX:I.width/2,radiusY:I.height/2,screenX:I.screenX,screenY:I.screenY,target:I.target}},we=function(I){return{event:I,touch:ce(I)}},Me=function(I){fe.push(we(I))},ke=function(I){for(var W=0;W<fe.length;W++){var oe=fe[W];if(oe.event.pointerId===I.pointerId){fe.splice(W,1);return}}},xe=function(I){var W=fe.filter(function(oe){return oe.event.pointerId===I.pointerId})[0];W.event=I,W.touch=ce(I)},Ee=function(I){I.touches=fe.map(function(W){return W.touch})},ye=function(I){return I.pointerType==="mouse"||I.pointerType===4};r.registerBinding(r.container,"pointerdown",function(se){ye(se)||(se.preventDefault(),Me(se),Ee(se),j(se))}),r.registerBinding(r.container,"pointerup",function(se){ye(se)||(ke(se),Ee(se),X(se))}),r.registerBinding(r.container,"pointercancel",function(se){ye(se)||(ke(se),Ee(se),U(se))}),r.registerBinding(r.container,"pointermove",function(se){ye(se)||(se.preventDefault(),xe(se),Ee(se),$(se))})}};var sn={};sn.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(n,i,a,o,s,l){this.renderer.nodeShapeImpl("polygon",n,i,a,o,s,this.points)},intersectLine:function(n,i,a,o,s,l,u,c){return pa(s,l,this.points,n,i,a/2,o/2,u)},checkPoint:function(n,i,a,o,s,l,u,c){return an(n,i,this.points,l,u,o,s,[0,-1],a)}}};sn.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,l){return b0(a,o,e,t,n/2+s,i/2+s)},checkPoint:function(e,t,n,i,a,o,s,l){return $n(e,t,i,a,o,s,n)}}};sn.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(n,i,a,o,s,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===i)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=i;var c=a/2,d=o/2;s=s==="auto"?$f(a,o):s;for(var f=new Array(e.length/2),h=0;h<e.length/2;h++)f[h]={x:n+c*e[h*2],y:i+d*e[h*2+1]};var v,m,p,g,y=f.length;for(m=f[y-1],v=0;v<y;v++)p=f[v%y],g=f[(v+1)%y],l[u][v]=wu(m,p,g,s),m=p,p=g;return l[u]},draw:function(n,i,a,o,s,l,u){this.renderer.nodeShapeImpl("round-polygon",n,i,a,o,s,this.points,this.getOrCreateCorners(i,a,o,s,l,u,"drawCorners"))},intersectLine:function(n,i,a,o,s,l,u,c,d){return x0(s,l,this.points,n,i,a,o,u,this.getOrCreateCorners(n,i,a,o,c,d,"corners"))},checkPoint:function(n,i,a,o,s,l,u,c,d){return w0(n,i,this.points,l,u,o,s,this.getOrCreateCorners(l,u,o,s,c,d,"corners"))}}};sn.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Gt(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,l){return zf(a,o,e,t,n,i,s,l)},checkPoint:function(e,t,n,i,a,o,s,l){var u=i/2,c=a/2;l=l==="auto"?Hn(i,a):l,l=Math.min(u,c,l);var d=l*2;return!!(an(e,t,this.points,o,s,i,a-d,[0,-1],n)||an(e,t,this.points,o,s,i-d,a,[0,-1],n)||$n(e,t,d,d,o-u+l,s-c+l,n)||$n(e,t,d,d,o+u-l,s-c+l,n)||$n(e,t,d,d,o+u-l,s+c-l,n)||$n(e,t,d,d,o-u+l,s+c-l,n))}}};sn.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:lu(),points:Gt(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,null,o)},generateCutTrianglePts:function(e,t,n,i,a){var o=a==="auto"?this.cornerLength:a,s=t/2,l=e/2,u=n-l,c=n+l,d=i-s,f=i+s;return{topLeft:[u,d+o,u+o,d,u+o,d+o],topRight:[c-o,d,c,d+o,c-o,d+o],bottomRight:[c,f-o,c-o,f,c-o,f-o],bottomLeft:[u+o,f,u,f-o,u+o,f-o]}},intersectLine:function(e,t,n,i,a,o,s,l){var u=this.generateCutTrianglePts(n+2*s,i+2*s,e,t,l),c=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return pa(a,o,c,e,t)},checkPoint:function(e,t,n,i,a,o,s,l){var u=l==="auto"?this.cornerLength:l;if(an(e,t,this.points,o,s,i,a-2*u,[0,-1],n)||an(e,t,this.points,o,s,i-2*u,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,o,s);return tr(e,t,c.topLeft)||tr(e,t,c.topRight)||tr(e,t,c.bottomRight)||tr(e,t,c.bottomLeft)}}};sn.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Gt(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,o,s,l){var u=.15,c=.5,d=.85,f=this.generateBarrelBezierPts(n+2*s,i+2*s,e,t),h=function(p){var g=wi({x:p[0],y:p[1]},{x:p[2],y:p[3]},{x:p[4],y:p[5]},u),y=wi({x:p[0],y:p[1]},{x:p[2],y:p[3]},{x:p[4],y:p[5]},c),C=wi({x:p[0],y:p[1]},{x:p[2],y:p[3]},{x:p[4],y:p[5]},d);return[p[0],p[1],g.x,g.y,y.x,y.y,C.x,C.y,p[4],p[5]]},v=[].concat(h(f.topLeft),h(f.topRight),h(f.bottomRight),h(f.bottomLeft));return pa(a,o,v,e,t)},generateBarrelBezierPts:function(e,t,n,i){var a=t/2,o=e/2,s=n-o,l=n+o,u=i-a,c=i+a,d=Nl(e,t),f=d.heightOffset,h=d.widthOffset,v=d.ctrlPtOffsetPct*e,m={topLeft:[s,u+f,s+v,u,s+h,u],topRight:[l-h,u,l-v,u,l,u+f],bottomRight:[l,c-f,l-v,c,l-h,c],bottomLeft:[s+h,c,s+v,c,s,c-f]};return m.topLeft.isTop=!0,m.topRight.isTop=!0,m.bottomLeft.isBottom=!0,m.bottomRight.isBottom=!0,m},checkPoint:function(e,t,n,i,a,o,s,l){var u=Nl(i,a),c=u.heightOffset,d=u.widthOffset;if(an(e,t,this.points,o,s,i,a-2*c,[0,-1],n)||an(e,t,this.points,o,s,i-2*d,a,[0,-1],n))return!0;for(var f=this.generateBarrelBezierPts(i,a,o,s),h=function(R,A,F){var O=F[4],T=F[2],B=F[0],E=F[5],w=F[1],b=Math.min(O,B),_=Math.max(O,B),k=Math.min(E,w),S=Math.max(E,w);if(b<=R&&R<=_&&k<=A&&A<=S){var N=_0(O,T,B),V=g0(N[0],N[1],N[2],R),z=V.filter(function(H){return 0<=H&&H<=1});if(z.length>0)return z[0]}return null},v=Object.keys(f),m=0;m<v.length;m++){var p=v[m],g=f[p],y=h(e,t,g);if(y!=null){var C=g[5],x=g[3],M=g[1],P=St(C,x,M,y);if(g.isTop&&P<=t||g.isBottom&&t<=P)return!0}}return!1}}};sn.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Gt(4,0),draw:function(e,t,n,i,a,o){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,o)},intersectLine:function(e,t,n,i,a,o,s,l){var u=e-(n/2+s),c=t-(i/2+s),d=c,f=e+(n/2+s),h=Cn(a,o,e,t,u,c,f,d,!1);return h.length>0?h:zf(a,o,e,t,n,i,s,l)},checkPoint:function(e,t,n,i,a,o,s,l){l=l==="auto"?Hn(i,a):l;var u=2*l;if(an(e,t,this.points,o,s,i,a-u,[0,-1],n)||an(e,t,this.points,o,s,i-u,a,[0,-1],n))return!0;var c=i/2+2*n,d=a/2+2*n,f=[o-c,s-d,o-c,s,o+c,s,o+c,s-d];return!!(tr(e,t,f)||$n(e,t,u,u,o+i/2-l,s+a/2-l,n)||$n(e,t,u,u,o-i/2+l,s+a/2-l,n))}}};sn.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Gt(3,0)),this.generateRoundPolygon("round-triangle",Gt(3,0)),this.generatePolygon("rectangle",Gt(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",Gt(5,0)),this.generateRoundPolygon("round-pentagon",Gt(5,0)),this.generatePolygon("hexagon",Gt(6,0)),this.generateRoundPolygon("round-hexagon",Gt(6,0)),this.generatePolygon("heptagon",Gt(7,0)),this.generateRoundPolygon("round-heptagon",Gt(7,0)),this.generatePolygon("octagon",Gt(8,0)),this.generateRoundPolygon("round-octagon",Gt(8,0));var n=new Array(20);{var i=Vl(5,0),a=Vl(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<a.length/2;s++)a[s*2]*=o,a[s*2+1]*=o;for(var s=0;s<20/4;s++)n[s*4]=i[s*2],n[s*4+1]=i[s*2+1],n[s*4+2]=a[s*2],n[s*4+3]=a[s*2+1]}n=jf(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}r.makePolygon=function(u){var c=u.join("$"),d="polygon-"+c,f;return(f=this[d])?f:e.generatePolygon(d,u)}};var Da={};Da.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};Da.redraw=function(r){r=r||Of();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};Da.beforeRender=function(r,e){if(!this.destroyed){e==null&&st("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(n,i){return i.priority-n.priority})}};var ef=function(e,t,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(t,n)};Da.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function n(i){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){ef(r,!0,i);var a=nn();r.render(r.renderOptions);var o=r.lastDrawTime=nn();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-a),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var s=o-a;r.redrawTotalTime+=s,r.lastRedrawTime=s,r.averageRedrawTime=r.averageRedrawTime/2+s/2,r.requestedFrame=!1}else ef(r,!1,i);r.skipFrame=!1,vs(n)}};vs(t)}};var ib=function(e){this.init(e)},zh=ib,Fi=zh.prototype;Fi.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Fi.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,o="__________cytoscape_stylesheet",s="__________cytoscape_container",l=i.getElementById(o)!=null;if(t.className.indexOf(s)<0&&(t.className=(t.className||"")+" "+s),!l){var u=i.createElement("style");u.id=o,u.textContent="."+s+" { position: relative; }",a.insertBefore(u,a.children[0])}var c=n.getComputedStyle(t),d=c.getPropertyValue("position");d==="static"&&Ye("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Ce(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Fi.notify=function(r,e){var t=this,n=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&n.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),r==="gc"&&t.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Fi.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],n=t,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};Fi.isHeadless=function(){return!1};[Cu,Vh,Nh,Oi,sn,Da].forEach(function(r){Fe(Fi,r)});var Al=1e3/60,jh={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=Ea(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),o=function(u,c){var d=nn(),f=i.averageRedrawTime,h=i.lastRedrawTime,v=[],m=i.cy.extent(),p=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var g=nn(),y=g-d,C=g-c;if(h<Al){var x=Al-(u?f:0);if(C>=e.deqFastCost*x)break}else if(u){if(y>=e.deqCost*h||y>=e.deqAvgCost*f)break}else if(C>=e.deqNoDrawCost*Al)break;var M=e.deq(n,p,m);if(M.length>0)for(var P=0;P<M.length;P++)v.push(M[P]);else break}v.length>0&&(e.onDeqd(n,v),!u&&e.shouldRedraw(n,v,p,m)&&a())},s=e.priority||iu;i.beforeRender(o,s(n))}}}},ab=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ps;Mn(this,r),this.idsByKey=new Hr,this.keyForId=new Hr,this.cachesByLvl=new Hr,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return Dn(r,[{key:"getIdsFor",value:function(t){t==null&&st("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(t);return i||(i=new Mi,n.set(t,i)),i}},{key:"addIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).add(n)}},{key:"deleteIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).delete(n)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);return i!==a}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var n=this.cachesByLvl,i=this.lvls,a=n.get(t);return a||(a=new Hr,n.set(t,a),i.push(t)),a}},{key:"getCache",value:function(t,n){return this.getCachesAt(n).get(t)}},{key:"get",value:function(t,n){var i=this.getKey(t),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(t),a}},{key:"getForCachedKey",value:function(t,n){var i=this.keyForId.get(t.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(t,n){return this.getCachesAt(n).has(t)}},{key:"has",value:function(t,n){var i=this.getKey(t);return this.hasCache(i,n)}},{key:"setCache",value:function(t,n,i){i.key=t,this.getCachesAt(n).set(t,i)}},{key:"set",value:function(t,n,i){var a=this.getKey(t);this.setCache(a,n,i),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,n){this.getCachesAt(n).delete(t)}},{key:"delete",value:function(t,n){var i=this.getKey(t);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(t){var n=this;this.lvls.forEach(function(i){return n.deleteCache(t,i)})}},{key:"invalidate",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(t);var a=this.doesEleInvalidateKey(t);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}]),r}(),tf=25,ts=50,fs=-4,Yl=3,$h=7.99,ob=8,sb=1024,lb=1024,ub=1024,cb=.2,db=.8,fb=10,hb=.15,vb=.1,pb=.9,gb=.9,mb=100,yb=1,Ci={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Cb=Tt({getKey:null,doesEleInvalidateKey:ps,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Bf,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),aa=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var i=Cb(t);Fe(n,i),n.lookup=new ab(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},yt=aa.prototype;yt.reasons=Ci;yt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};yt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=t[r]=t[r]||[];return n};yt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new Sa(function(t,n){return n.reqs-t.reqs});return e};yt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};yt.getElement=function(r,e,t,n,i){var a=this,o=this.renderer,s=o.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!a.allowEdgeTxrCaching&&r.isEdge()||!a.allowParentTxrCaching&&r.isParent())return null;if(n==null&&(n=Math.ceil(ou(s*t))),n<fs)n=fs;else if(s>=$h||n>Yl)return null;var u=Math.pow(2,n),c=e.h*u,d=e.w*u,f=o.eleTextBiggerThanMin(r,u);if(!this.isVisible(r,f))return null;var h=l.get(r,n);if(h&&h.invalidated&&(h.invalidated=!1,h.texture.invalidatedWidth-=h.width),h)return h;var v;if(c<=tf?v=tf:c<=ts?v=ts:v=Math.ceil(c/ts)*ts,c>ub||d>lb)return null;var m=a.getTextureQueue(v),p=m[m.length-2],g=function(){return a.recycleTexture(v,d)||a.addTexture(v,d)};p||(p=m[m.length-1]),p||(p=g()),p.width-p.usedWidth<d&&(p=g());for(var y=function(b){return b&&b.scaledLabelShown===f},C=i&&i===Ci.dequeue,x=i&&i===Ci.highQuality,M=i&&i===Ci.downscale,P,D=n+1;D<=Yl;D++){var R=l.get(r,D);if(R){P=R;break}}var A=P&&P.level===n+1?P:null,F=function(){p.context.drawImage(A.texture.canvas,A.x,0,A.width,A.height,p.usedWidth,0,d,c)};if(p.context.setTransform(1,0,0,1,0,0),p.context.clearRect(p.usedWidth,0,d,v),y(A))F();else if(y(P))if(x){for(var O=P.level;O>n;O--)A=a.getElement(r,e,t,O,Ci.downscale);F()}else return a.queueElement(r,P.level-1),P;else{var T;if(!C&&!x&&!M)for(var B=n-1;B>=fs;B--){var E=l.get(r,B);if(E){T=E;break}}if(y(T))return a.queueElement(r,n),T;p.context.translate(p.usedWidth,0),p.context.scale(u,u),this.drawElement(p.context,r,e,f,!1),p.context.scale(1/u,1/u),p.context.translate(-p.usedWidth,0)}return h={x:p.usedWidth,texture:p,level:n,scale:u,width:d,height:c,scaledLabelShown:f},p.usedWidth+=Math.ceil(d+ob),p.eleCaches.push(h),l.set(r,n,h),a.checkTextureFullness(p),h};yt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};yt.invalidateElement=function(r){var e=this,t=e.lookup,n=[],i=t.isInvalid(r);if(i){for(var a=fs;a<=Yl;a++){var o=t.getForCachedKey(r,a);o&&n.push(o)}var s=t.invalidate(r);if(s)for(var l=0;l<n.length;l++){var u=n[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(r)}};yt.checkTextureUtility=function(r){r.invalidatedWidth>=cb*r.width&&this.retireTexture(r)};yt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>db&&r.fullnessChecks>=fb?En(t,r):r.fullnessChecks++};yt.retireTexture=function(r){var e=this,t=r.height,n=e.getTextureQueue(t),i=this.lookup;En(n,r),r.retired=!0;for(var a=r.eleCaches,o=0;o<a.length;o++){var s=a[o];i.deleteCache(s.key,s.level)}au(a);var l=e.getRetiredTextureQueue(t);l.push(r)};yt.addTexture=function(r,e){var t=this,n=t.getTextureQueue(r),i={};return n.push(i),i.eleCaches=[],i.height=r,i.width=Math.max(sb,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=t.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};yt.recycleTexture=function(r,e){for(var t=this,n=t.getTextureQueue(r),i=t.getRetiredTextureQueue(r),a=0;a<i.length;a++){var o=i[a];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,au(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),En(i,o),n.push(o),o}};yt.queueElement=function(r,e){var t=this,n=t.getElementQueue(),i=t.getElementKeyToQueue(),a=this.getKey(r),o=i[a];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,n.updateItem(o);else{var s={eles:r.spawn().merge(r),level:e,reqs:1,key:a};n.push(s),i[a]=s}};yt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,o=0;o<yb&&t.size()>0;o++){var s=t.pop(),l=s.key,u=s.eles[0],c=a.hasCache(u,s.level);if(n[l]=null,c)continue;i.push(s);var d=e.getBoundingBox(u);e.getElement(u,d,r,s.level,Ci.dequeue)}return i};yt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(r),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=nu,t.updateItem(a),t.pop(),n[i]=null):a.eles.unmerge(r))};yt.onDequeue=function(r){this.onDequeues.push(r)};yt.offDequeue=function(r){En(this.onDequeues,r)};yt.setupDequeueing=jh.setupDequeueing({deqRedrawThreshold:mb,deqCost:hb,deqAvgCost:vb,deqNoDrawCost:pb,deqFastCost:gb,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(t)}},shouldRedraw:function(e,t,n,i){for(var a=0;a<t.length;a++)for(var o=t[a].eles,s=0;s<o.length;s++){var l=o[s].boundingBox();if(su(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var wb=1,sa=-4,_s=2,bb=3.99,xb=50,_b=50,Eb=.15,Sb=.1,Tb=.9,kb=.9,Mb=1,rf=250,Db=4e3*4e3,nf=32767,Pb=!0,Gh=function(e){var t=this,n=t.renderer=e,i=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=nn()-2*rf,t.skipping=!1,t.eleTxrDeqs=i.collection(),t.scheduleElementRefinement=Ea(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},_b),n.beforeRender(function(o,s){s-t.lastInvalidationTime<=rf?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(s,l){return l.reqs-s.reqs};t.layersQueue=new Sa(a),t.setupDequeueing()},Pt=Gh.prototype,af=0,Ab=Math.pow(2,53)-1;Pt.makeLayer=function(r,e){var t=Math.pow(2,e),n=Math.ceil(r.w*t),i=Math.ceil(r.h*t),a=this.renderer.makeOffscreenCanvas(n,i),o={id:af=++af%Ab,bb:r,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,l=-o.bb.x1,u=-o.bb.y1;return s.scale(t,t),s.translate(l,u),o};Pt.getLayers=function(r,e,t){var n=this,i=n.renderer,a=i.cy,o=a.zoom(),s=n.firstGet;if(n.firstGet=!1,t==null){if(t=Math.ceil(ou(o*e)),t<sa)t=sa;else if(o>=bb||t>_s)return null}n.validateLayersElesOrdering(t,r);var l=n.layersByLevel,u=Math.pow(2,t),c=l[t]=l[t]||[],d,f=n.levelIsComplete(t,r),h,v=function(){var F=function(w){if(n.validateLayersElesOrdering(w,r),n.levelIsComplete(w,r))return h=l[w],!0},O=function(w){if(!h)for(var b=t+w;sa<=b&&b<=_s&&!F(b);b+=w);};O(1),O(-1);for(var T=c.length-1;T>=0;T--){var B=c[T];B.invalid&&En(c,B)}};if(!f)v();else return c;var m=function(){if(!d){d=rr();for(var F=0;F<r.length;F++)Vf(d,r[F].boundingBox())}return d},p=function(F){F=F||{};var O=F.after;m();var T=Math.ceil(d.w*u),B=Math.ceil(d.h*u);if(T>nf||B>nf)return null;var E=T*B;if(E>Db)return null;var w=n.makeLayer(d,t);if(O!=null){var b=c.indexOf(O)+1;c.splice(b,0,w)}else(F.insert===void 0||F.insert)&&c.unshift(w);return w};if(n.skipping&&!s)return null;for(var g=null,y=r.length/wb,C=!s,x=0;x<r.length;x++){var M=r[x],P=M._private.rscratch,D=P.imgLayerCaches=P.imgLayerCaches||{},R=D[t];if(R){g=R;continue}if((!g||g.eles.length>=y||!Nf(g.bb,M.boundingBox()))&&(g=p({insert:!0,after:g}),!g))return null;h||C?n.queueLayer(g,M):n.drawEleInLayer(g,M,t,e),g.eles.push(M),D[t]=g}return h||(C?null:c)};Pt.getEleLevelForLayerLevel=function(r,e){return r};Pt.drawEleInLayer=function(r,e,t,n){var i=this,a=this.renderer,o=r.context,s=e.boundingBox();s.w===0||s.h===0||!e.visible()||(t=i.getEleLevelForLayerLevel(t,n),a.setImgSmoothing(o,!1),a.drawCachedElement(o,e,null,null,t,Pb),a.setImgSmoothing(o,!0))};Pt.levelIsComplete=function(r,e){var t=this,n=t.layersByLevel[r];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var o=n[a];if(o.reqs>0||o.invalid)return!1;i+=o.eles.length}return i===e.length};Pt.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(t)for(var n=0;n<t.length;n++){for(var i=t[n],a=-1,o=0;o<e.length;o++)if(i.eles[0]===e[o]){a=o;break}if(a<0){this.invalidateLayer(i);continue}for(var s=a,o=0;o<i.eles.length;o++)if(i.eles[o]!==e[s+o]){this.invalidateLayer(i);break}}};Pt.updateElementsInLayers=function(r,e){for(var t=this,n=xa(r[0]),i=0;i<r.length;i++)for(var a=n?null:r[i],o=n?r[i]:r[i].ele,s=o._private.rscratch,l=s.imgLayerCaches=s.imgLayerCaches||{},u=sa;u<=_s;u++){var c=l[u];c&&(a&&t.getEleLevelForLayerLevel(c.level)!==a.level||e(c,o,a))}};Pt.haveLayers=function(){for(var r=this,e=!1,t=sa;t<=_s;t++){var n=r.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e};Pt.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=nn(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(n,i,a){e.invalidateLayer(n)}))};Pt.invalidateLayer=function(r){if(this.lastInvalidationTime=nn(),!r.invalid){var e=r.level,t=r.eles,n=this.layersByLevel[e];En(n,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var i=0;i<t.length;i++){var a=t[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};Pt.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(n,i,a){var o=n.replacement;if(o||(o=n.replacement=e.makeLayer(n.bb,n.level),o.replaces=n,o.eles=n.eles),!o.reqs)for(var s=0;s<o.eles.length;s++)e.queueLayer(o,o.eles[s])})};Pt.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};Pt.queueLayer=function(r,e){var t=this,n=t.layersQueue,i=r.elesQueue,a=i.hasId=i.hasId||{};if(!r.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}r.reqs?(r.reqs++,n.updateItem(r)):(r.reqs=1,n.push(r))}};Pt.dequeue=function(r){for(var e=this,t=e.layersQueue,n=[],i=0;i<Mb&&t.size()!==0;){var a=t.peek();if(a.replacement){t.pop();continue}if(a.replaces&&a!==a.replaces.replacement){t.pop();continue}if(a.invalid){t.pop();continue}var o=a.elesQueue.shift();o&&(e.drawEleInLayer(a,o,a.level,r),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(t.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};Pt.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],n=r.replaces,i=t.indexOf(n);if(!(i<0||n.invalid)){t[i]=r;for(var a=0;a<r.eles.length;a++){var o=r.eles[a]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[r.level]=r)}e.requestRedraw()}};Pt.requestRedraw=Ea(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);Pt.setupDequeueing=jh.setupDequeueing({deqRedrawThreshold:xb,deqCost:Eb,deqAvgCost:Sb,deqNoDrawCost:Tb,deqFastCost:kb,deq:function(e,t){return e.dequeue(t)},onDeqd:iu,shouldRedraw:Bf,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var qh={},of;function Bb(r,e){for(var t=0;t<e.length;t++){var n=e[t];r.lineTo(n.x,n.y)}}function Rb(r,e,t){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),r.lineTo(a.x,a.y)}r.quadraticCurveTo(t.x,t.y,n.x,n.y)}function sf(r,e,t){r.beginPath&&r.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];r.lineTo(a.x,a.y)}var o=t,s=t[0];r.moveTo(s.x,s.y);for(var i=1;i<o.length;i++){var a=o[i];r.lineTo(a.x,a.y)}r.closePath&&r.closePath()}function Ib(r,e,t,n,i){r.beginPath&&r.beginPath(),r.arc(t,n,i,0,Math.PI*2,!1);var a=e,o=a[0];r.moveTo(o.x,o.y);for(var s=0;s<a.length;s++){var l=a[s];r.lineTo(l.x,l.y)}r.closePath&&r.closePath()}function Ob(r,e,t,n){r.arc(e,t,n,0,Math.PI*2,!1)}qh.arrowShapeImpl=function(r){return(of||(of={polygon:Bb,"triangle-backcurve":Rb,"triangle-tee":sf,"circle-triangle":Ib,"triangle-cross":sf,circle:Ob}))[r]};var Kr={};Kr.drawElement=function(r,e,t,n,i,a){var o=this;e.isNode()?o.drawNode(r,e,t,n,i,a):o.drawEdge(r,e,t,n,i,a)};Kr.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};Kr.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};Kr.drawCachedElementPortion=function(r,e,t,n,i,a,o,s){var l=this,u=t.getBoundingBox(e);if(!(u.w===0||u.h===0)){var c=t.getElement(e,u,n,i,a);if(c!=null){var d=s(l,e);if(d===0)return;var f=o(l,e),h=u.x1,v=u.y1,m=u.w,p=u.h,g,y,C,x,M;if(f!==0){var P=t.getRotationPoint(e);C=P.x,x=P.y,r.translate(C,x),r.rotate(f),M=l.getImgSmoothing(r),M||l.setImgSmoothing(r,!0);var D=t.getRotationOffset(e);g=D.x,y=D.y}else g=h,y=v;var R;d!==1&&(R=r.globalAlpha,r.globalAlpha=R*d),r.drawImage(c.texture.canvas,c.x,0,c.width,c.height,g,y,m,p),d!==1&&(r.globalAlpha=R),f!==0&&(r.rotate(-f),r.translate(-C,-x),M||l.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var Fb=function(){return 0},Lb=function(e,t){return e.getTextAngle(t,null)},Vb=function(e,t){return e.getTextAngle(t,"source")},Nb=function(e,t){return e.getTextAngle(t,"target")},zb=function(e,t){return t.effectiveOpacity()},Bl=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};Kr.drawCachedElement=function(r,e,t,n,i,a){var o=this,s=o.data,l=s.eleTxrCache,u=s.lblTxrCache,c=s.slbTxrCache,d=s.tlbTxrCache,f=e.boundingBox(),h=a===!0?l.reasons.highQuality:null;if(!(f.w===0||f.h===0||!e.visible())&&(!n||su(f,n))){var v=e.isEdge(),m=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,l,t,i,h,Fb,zb),(!v||!m)&&o.drawCachedElementPortion(r,e,u,t,i,h,Lb,Bl),v&&!m&&(o.drawCachedElementPortion(r,e,c,t,i,h,Vb,Bl),o.drawCachedElementPortion(r,e,d,t,i,h,Nb,Bl)),o.drawElementOverlay(r,e)}};Kr.drawElements=function(r,e){for(var t=this,n=0;n<e.length;n++){var i=e[n];t.drawElement(r,i)}};Kr.drawCachedElements=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];i.drawCachedElement(r,o,t,n)}};Kr.drawCachedNodes=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var o=e[a];o.isNode()&&i.drawCachedElement(r,o,t,n)}};Kr.drawLayeredElements=function(r,e,t,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,t);if(a)for(var o=0;o<a.length;o++){var s=a[o],l=s.bb;l.w===0||l.h===0||r.drawImage(s.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(r,e,t,n)};var ln={};ln.drawEdge=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s=e._private.rscratch;if(!(a&&!e.visible())&&!(s.badLine||s.allpts==null||isNaN(s.allpts[0]))){var l;t&&(l=t,r.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,f=e.pstyle("line-style").value,h=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,m=e.pstyle("line-outline-width").value,p=e.pstyle("line-outline-color").value,g=u*c,y=u*c,C=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;d==="straight-triangle"?(o.eleStrokeStyle(r,e,w),o.drawEdgeTrianglePath(e,r,s.allpts)):(r.lineWidth=h,r.lineCap=v,o.eleStrokeStyle(r,e,w),o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},x=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g;if(r.lineWidth=h+m,r.lineCap=v,m>0)o.colorStrokeStyle(r,p[0],p[1],p[2],w);else{r.lineCap="butt";return}d==="straight-triangle"?o.drawEdgeTrianglePath(e,r,s.allpts):(o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},M=function(){i&&o.drawEdgeOverlay(r,e)},P=function(){i&&o.drawEdgeUnderlay(r,e)},D=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;o.drawArrowheads(r,e,w)},R=function(){o.drawElementText(r,e,null,n)};r.lineJoin="round";var A=e.pstyle("ghost").value==="yes";if(A){var F=e.pstyle("ghost-offset-x").pfValue,O=e.pstyle("ghost-offset-y").pfValue,T=e.pstyle("ghost-opacity").value,B=g*T;r.translate(F,O),C(B),D(B),r.translate(-F,-O)}else x();P(),C(),D(),M(),R(),t&&r.translate(l.x1,l.y1)}};var Hh=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,o=a.usePaths(),s=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,c=n.pstyle("".concat(e,"-color")).value;t.lineWidth=u,s.edgeType==="self"&&!o?t.lineCap="butt":t.lineCap="round",a.colorStrokeStyle(t,c[0],c[1],c[2],i),a.drawEdgePath(n,t,s.allpts,"solid")}}}};ln.drawEdgeOverlay=Hh("overlay");ln.drawEdgeUnderlay=Hh("underlay");ln.drawEdgePath=function(r,e,t,n){var i=r._private.rscratch,a=e,o,s=!1,l=this.usePaths(),u=r.pstyle("line-dash-pattern").pfValue,c=r.pstyle("line-dash-offset").pfValue;if(l){var d=t.join("$"),f=i.pathCacheKey&&i.pathCacheKey===d;f?(o=e=i.pathCache,s=!0):(o=e=new Path2D,i.pathCacheKey=d,i.pathCache=o)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!s&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var h=2;h+3<t.length;h+=4)e.quadraticCurveTo(t[h],t[h+1],t[h+2],t[h+3]);break;case"straight":case"haystack":for(var v=2;v+1<t.length;v+=2)e.lineTo(t[v],t[v+1]);break;case"segments":if(i.isRound){var m=lr(i.roundCorners),p;try{for(m.s();!(p=m.n()).done;){var g=p.value;Rh(e,g)}}catch(C){m.e(C)}finally{m.f()}e.lineTo(t[t.length-2],t[t.length-1])}else for(var y=2;y+1<t.length;y+=2)e.lineTo(t[y],t[y+1]);break}e=a,l?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};ln.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var n=r.pstyle("width").pfValue,i=0;i+1<t.length;i+=2){var a=[t[i+2]-t[i],t[i+3]-t[i+1]],o=Math.sqrt(a[0]*a[0]+a[1]*a[1]),s=[a[1]/o,-a[0]/o],l=[s[0]*n/2,s[1]*n/2];e.beginPath(),e.moveTo(t[i]-l[0],t[i+1]-l[1]),e.lineTo(t[i]+l[0],t[i+1]+l[1]),e.lineTo(t[i+2],t[i+3]),e.closePath(),e.fill()}};ln.drawArrowheads=function(r,e,t){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(r,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,t),i||this.drawArrowhead(r,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,t)};ln.drawArrowhead=function(r,e,t,n,i,a,o){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var s=this,l=e.pstyle(t+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(t+"-arrow-fill").value,d=e.pstyle("width").pfValue,f=e.pstyle(t+"-arrow-width"),h=f.value==="match-line"?d:f.pfValue;f.units==="%"&&(h*=d);var v=e.pstyle("opacity").value;o===void 0&&(o=v);var m=r.globalCompositeOperation;(o!==1||c==="hollow")&&(r.globalCompositeOperation="destination-out",s.colorFillStyle(r,255,255,255,1),s.colorStrokeStyle(r,255,255,255,1),s.drawArrowShape(e,r,u,d,l,h,n,i,a),r.globalCompositeOperation=m);var p=e.pstyle(t+"-arrow-color").value;s.colorFillStyle(r,p[0],p[1],p[2],o),s.colorStrokeStyle(r,p[0],p[1],p[2],o),s.drawArrowShape(e,r,c,d,l,h,n,i,a)}}};ln.drawArrowShape=function(r,e,t,n,i,a,o,s,l){var u=this,c=this.usePaths()&&i!=="triangle-cross",d=!1,f,h=e,v={x:o,y:s},m=r.pstyle("arrow-scale").value,p=this.getArrowWidth(n,m),g=u.arrowShapes[i];if(c){var y=u.arrowPathCache=u.arrowPathCache||[],C=_n(i),x=y[C];x!=null?(f=e=x,d=!0):(f=e=new Path2D,y[C]=f)}d||(e.beginPath&&e.beginPath(),c?g.draw(e,1,0,{x:0,y:0},1):g.draw(e,p,l,v,n),e.closePath&&e.closePath()),e=h,c&&(e.translate(o,s),e.rotate(l),e.scale(p,p)),(t==="filled"||t==="both")&&(c?e.fill(f):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=a/(c?p:1),e.lineJoin="miter",c?e.stroke(f):e.stroke()),c&&(e.scale(1/p,1/p),e.rotate(-l),e.translate(-o,-s))};var xu={};xu.safeDrawImage=function(r,e,t,n,i,a,o,s,l,u){if(!(i<=0||a<=0||l<=0||u<=0))try{r.drawImage(e,t,n,i,a,o,s,l,u)}catch(c){Ye(c)}};xu.drawInscribedImage=function(r,e,t,n,i){var a=this,o=t.position(),s=o.x,l=o.y,u=t.cy().style(),c=u.getIndexedStyle.bind(u),d=c(t,"background-fit","value",n),f=c(t,"background-repeat","value",n),h=t.width(),v=t.height(),m=t.padding()*2,p=h+(c(t,"background-width-relative-to","value",n)==="inner"?0:m),g=v+(c(t,"background-height-relative-to","value",n)==="inner"?0:m),y=t._private.rscratch,C=c(t,"background-clip","value",n),x=C==="node",M=c(t,"background-image-opacity","value",n)*i,P=c(t,"background-image-smoothing","value",n),D=t.pstyle("corner-radius").value;D!=="auto"&&(D=t.pstyle("corner-radius").pfValue);var R=e.width||e.cachedW,A=e.height||e.cachedH;(R==null||A==null)&&(document.body.appendChild(e),R=e.cachedW=e.width||e.offsetWidth,A=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var F=R,O=A;if(c(t,"background-width","value",n)!=="auto"&&(c(t,"background-width","units",n)==="%"?F=c(t,"background-width","pfValue",n)*p:F=c(t,"background-width","pfValue",n)),c(t,"background-height","value",n)!=="auto"&&(c(t,"background-height","units",n)==="%"?O=c(t,"background-height","pfValue",n)*g:O=c(t,"background-height","pfValue",n)),!(F===0||O===0)){if(d==="contain"){var T=Math.min(p/F,g/O);F*=T,O*=T}else if(d==="cover"){var T=Math.max(p/F,g/O);F*=T,O*=T}var B=s-p/2,E=c(t,"background-position-x","units",n),w=c(t,"background-position-x","pfValue",n);E==="%"?B+=(p-F)*w:B+=w;var b=c(t,"background-offset-x","units",n),_=c(t,"background-offset-x","pfValue",n);b==="%"?B+=(p-F)*_:B+=_;var k=l-g/2,S=c(t,"background-position-y","units",n),N=c(t,"background-position-y","pfValue",n);S==="%"?k+=(g-O)*N:k+=N;var V=c(t,"background-offset-y","units",n),z=c(t,"background-offset-y","pfValue",n);V==="%"?k+=(g-O)*z:k+=z,y.pathCache&&(B-=s,k-=l,s=0,l=0);var H=r.globalAlpha;r.globalAlpha=M;var Y=a.getImgSmoothing(r),ee=!1;if(P==="no"&&Y?(a.setImgSmoothing(r,!1),ee=!0):P==="yes"&&!Y&&(a.setImgSmoothing(r,!0),ee=!0),f==="no-repeat")x&&(r.save(),y.pathCache?r.clip(y.pathCache):(a.nodeShapes[a.getNodeShape(t)].draw(r,s,l,p,g,D,y),r.clip())),a.safeDrawImage(r,e,0,0,R,A,B,k,F,O),x&&r.restore();else{var J=r.createPattern(e,f);r.fillStyle=J,a.nodeShapes[a.getNodeShape(t)].draw(r,s,l,p,g,D,y),r.translate(B,k),r.fill(),r.translate(-B,-k)}r.globalAlpha=H,ee&&a.setImgSmoothing(r,Y)}};var Yn={};Yn.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(ou(t*n));e=Math.pow(2,i)}var a=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(a<o)};Yn.drawElementText=function(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(n==null){if(a&&!o.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var s=e.pstyle("label");if(!s||!s.value)return;var l=o.getLabelJustification(e);r.textAlign=l,r.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,c=e.pstyle("label"),d=e.pstyle("source-label"),f=e.pstyle("target-label");if(u||(!c||!c.value)&&(!d||!d.value)&&(!f||!f.value))return;r.textAlign="center",r.textBaseline="bottom"}var h=!t,v;t&&(v=t,r.translate(-v.x1,-v.y1)),i==null?(o.drawText(r,e,null,h,a),e.isEdge()&&(o.drawText(r,e,"source",h,a),o.drawText(r,e,"target",h,a))):o.drawText(r,e,i,h,a),t&&r.translate(v.x1,v.y1)};Yn.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};Yn.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*s,u=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;r.font=n+" "+o+" "+i+" "+a,r.lineJoin="round",this.colorFillStyle(r,u[0],u[1],u[2],s),this.colorStrokeStyle(r,c[0],c[1],c[2],l)};function Rl(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0;r.beginPath(),r.moveTo(e+a,t),r.lineTo(e+n-a,t),r.quadraticCurveTo(e+n,t,e+n,t+a),r.lineTo(e+n,t+i-a),r.quadraticCurveTo(e+n,t+i,e+n-a,t+i),r.lineTo(e+a,t+i),r.quadraticCurveTo(e,t+i,e,t+i-a),r.lineTo(e,t+a),r.quadraticCurveTo(e,t,e+a,t),r.closePath(),o?r.stroke():r.fill()}Yn.getTextAngle=function(r,e){var t,n=r._private,i=n.rscratch,a=e?e+"-":"",o=r.pstyle(a+"text-rotation");if(o.strValue==="autorotate"){var s=Tr(i,"labelAngle",e);t=r.isEdge()?s:0}else o.strValue==="none"?t=0:t=o.pfValue;return t};Yn.drawText=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,o=a.rscratch,s=i?e.effectiveOpacity():1;if(!(i&&(s===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var l=Tr(o,"labelX",t),u=Tr(o,"labelY",t),c,d,f=this.getLabelText(e,t);if(f!=null&&f!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(r,e,i);var h=t?t+"-":"",v=Tr(o,"labelWidth",t),m=Tr(o,"labelHeight",t),p=e.pstyle(h+"text-margin-x").pfValue,g=e.pstyle(h+"text-margin-y").pfValue,y=e.isEdge(),C=e.pstyle("text-halign").value,x=e.pstyle("text-valign").value;y&&(C="center",x="center"),l+=p,u+=g;var M;switch(n?M=this.getTextAngle(e,t):M=0,M!==0&&(c=l,d=u,r.translate(c,d),r.rotate(M),l=0,u=0),x){case"top":break;case"center":u+=m/2;break;case"bottom":u+=m;break}var P=e.pstyle("text-background-opacity").value,D=e.pstyle("text-border-opacity").value,R=e.pstyle("text-border-width").pfValue,A=e.pstyle("text-background-padding").pfValue,F=e.pstyle("text-background-shape").strValue,O=F.indexOf("round")===0,T=2;if(P>0||R>0&&D>0){var B=l-A;switch(C){case"left":B-=v;break;case"center":B-=v/2;break}var E=u-m-A,w=v+2*A,b=m+2*A;if(P>0){var _=r.fillStyle,k=e.pstyle("text-background-color").value;r.fillStyle="rgba("+k[0]+","+k[1]+","+k[2]+","+P*s+")",O?Rl(r,B,E,w,b,T):r.fillRect(B,E,w,b),r.fillStyle=_}if(R>0&&D>0){var S=r.strokeStyle,N=r.lineWidth,V=e.pstyle("text-border-color").value,z=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+V[0]+","+V[1]+","+V[2]+","+D*s+")",r.lineWidth=R,r.setLineDash)switch(z){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=R/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(O?Rl(r,B,E,w,b,T,"stroke"):r.strokeRect(B,E,w,b),z==="double"){var H=R/2;O?Rl(r,B+H,E+H,w-H*2,b-H*2,T,"stroke"):r.strokeRect(B+H,E+H,w-H*2,b-H*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=N,r.strokeStyle=S}}var Y=2*e.pstyle("text-outline-width").pfValue;if(Y>0&&(r.lineWidth=Y),e.pstyle("text-wrap").value==="wrap"){var ee=Tr(o,"labelWrapCachedLines",t),J=Tr(o,"labelLineHeight",t),ne=v/2,ie=this.getLabelJustification(e);switch(ie==="auto"||(C==="left"?ie==="left"?l+=-v:ie==="center"&&(l+=-ne):C==="center"?ie==="left"?l+=-ne:ie==="right"&&(l+=ne):C==="right"&&(ie==="center"?l+=ne:ie==="right"&&(l+=v))),x){case"top":u-=(ee.length-1)*J;break;case"center":case"bottom":u-=(ee.length-1)*J;break}for(var K=0;K<ee.length;K++)Y>0&&r.strokeText(ee[K],l,u),r.fillText(ee[K],l,u),u+=J}else Y>0&&r.strokeText(f,l,u),r.fillText(f,l,u);M!==0&&(r.rotate(-M),r.translate(-c,-d))}}};var Li={};Li.drawNode=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s,l,u=e._private,c=u.rscratch,d=e.position();if(!(!Ce(d.x)||!Ce(d.y))&&!(a&&!e.visible())){var f=a?e.effectiveOpacity():1,h=o.usePaths(),v,m=!1,p=e.padding();s=e.width()+2*p,l=e.height()+2*p;var g;t&&(g=t,r.translate(-g.x1,-g.y1));for(var y=e.pstyle("background-image"),C=y.value,x=new Array(C.length),M=new Array(C.length),P=0,D=0;D<C.length;D++){var R=C[D],A=x[D]=R!=null&&R!=="none";if(A){var F=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",D);P++,M[D]=o.getCachedImage(R,F,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var O=e.pstyle("background-blacken").value,T=e.pstyle("border-width").pfValue,B=e.pstyle("background-opacity").value*f,E=e.pstyle("border-color").value,w=e.pstyle("border-style").value,b=e.pstyle("border-join").value,_=e.pstyle("border-cap").value,k=e.pstyle("border-position").value,S=e.pstyle("border-dash-pattern").pfValue,N=e.pstyle("border-dash-offset").pfValue,V=e.pstyle("border-opacity").value*f,z=e.pstyle("outline-width").pfValue,H=e.pstyle("outline-color").value,Y=e.pstyle("outline-style").value,ee=e.pstyle("outline-opacity").value*f,J=e.pstyle("outline-offset").value,ne=e.pstyle("corner-radius").value;ne!=="auto"&&(ne=e.pstyle("corner-radius").pfValue);var ie=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B;o.eleFillStyle(r,e,Q)},K=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:V;o.colorStrokeStyle(r,E[0],E[1],E[2],Q)},L=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ee;o.colorStrokeStyle(r,H[0],H[1],H[2],Q)},j=function(Q,te,he,le){var ve=o.nodePathCache=o.nodePathCache||[],Ie=Af(he==="polygon"?he+","+le.join(","):he,""+te,""+Q,""+ne),ze=ve[Ie],Ae,Ve=!1;return ze!=null?(Ae=ze,Ve=!0,c.pathCache=Ae):(Ae=new Path2D,ve[Ie]=c.pathCache=Ae),{path:Ae,cacheHit:Ve}},$=e.pstyle("shape").strValue,U=e.pstyle("shape-polygon-points").pfValue;if(h){r.translate(d.x,d.y);var X=j(s,l,$,U);v=X.path,m=X.cacheHit}var de=function(){if(!m){var Q=d;h&&(Q={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(v||r,Q.x,Q.y,s,l,ne,c)}h?r.fill(v):r.fill()},Te=function(){for(var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,he=u.backgrounding,le=0,ve=0;ve<M.length;ve++){var Ie=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ve);if(te&&Ie==="over"||!te&&Ie==="inside"){le++;continue}x[ve]&&M[ve].complete&&!M[ve].error&&(le++,o.drawInscribedImage(r,M[ve],e,ve,Q))}u.backgrounding=le!==P,he!==u.backgrounding&&e.updateStyle(!1)},_e=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;o.hasPie(e)&&(o.drawPie(r,e,te),Q&&(h||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,s,l,ne,c)))},fe=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,te=(O>0?O:-O)*Q,he=O>0?0:255;O!==0&&(o.colorFillStyle(r,he,he,he,te),h?r.fill(v):r.fill())},ce=function(){if(T>0){if(r.lineWidth=T,r.lineCap=_,r.lineJoin=b,r.setLineDash)switch(w){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(S),r.lineDashOffset=N;break;case"solid":case"double":r.setLineDash([]);break}if(k!=="center"){if(r.save(),r.lineWidth*=2,k==="inside")h?r.clip(v):r.clip();else{var Q=new Path2D;Q.rect(-s/2-T,-l/2-T,s+2*T,l+2*T),Q.addPath(v),r.clip(Q,"evenodd")}h?r.stroke(v):r.stroke(),r.restore()}else h?r.stroke(v):r.stroke();if(w==="double"){r.lineWidth=T/3;var te=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",h?r.stroke(v):r.stroke(),r.globalCompositeOperation=te}r.setLineDash&&r.setLineDash([])}},we=function(){if(z>0){if(r.lineWidth=z,r.lineCap="butt",r.setLineDash)switch(Y){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var Q=d;h&&(Q={x:0,y:0});var te=o.getNodeShape(e),he=T;k==="inside"&&(he=0),k==="outside"&&(he*=2);var le=(s+he+(z+J))/s,ve=(l+he+(z+J))/l,Ie=s*le,ze=l*ve,Ae=o.nodeShapes[te].points,Ve;if(h){var Ne=j(Ie,ze,te,Ae);Ve=Ne.path}if(te==="ellipse")o.drawEllipsePath(Ve||r,Q.x,Q.y,Ie,ze);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(te)){var Le=0,Je=0,at=0;te==="round-diamond"?Le=(he+J+z)*1.4:te==="round-heptagon"?(Le=(he+J+z)*1.075,at=-(he/2+J+z)/35):te==="round-hexagon"?Le=(he+J+z)*1.12:te==="round-pentagon"?(Le=(he+J+z)*1.13,at=-(he/2+J+z)/15):te==="round-tag"?(Le=(he+J+z)*1.12,Je=(he/2+z+J)*.07):te==="round-triangle"&&(Le=(he+J+z)*(Math.PI/2),at=-(he+J/2+z)/Math.PI),Le!==0&&(le=(s+Le)/s,Ie=s*le,["round-hexagon","round-tag"].includes(te)||(ve=(l+Le)/l,ze=l*ve)),ne=ne==="auto"?$f(Ie,ze):ne;for(var ar=Ie/2,or=ze/2,ht=ne+(he+z+J)/2,Ct=new Array(Ae.length/2),wt=new Array(Ae.length/2),jt=0;jt<Ae.length/2;jt++)Ct[jt]={x:Q.x+Je+ar*Ae[jt*2],y:Q.y+at+or*Ae[jt*2+1]};var $t,Br,cr,Rr,Qr=Ct.length;for(Br=Ct[Qr-1],$t=0;$t<Qr;$t++)cr=Ct[$t%Qr],Rr=Ct[($t+1)%Qr],wt[$t]=wu(Br,cr,Rr,ht),Br=cr,cr=Rr;o.drawRoundPolygonPath(Ve||r,Q.x+Je,Q.y+at,s*le,l*ve,Ae,wt)}else if(["roundrectangle","round-rectangle"].includes(te))ne=ne==="auto"?Hn(Ie,ze):ne,o.drawRoundRectanglePath(Ve||r,Q.x,Q.y,Ie,ze,ne+(he+z+J)/2);else if(["cutrectangle","cut-rectangle"].includes(te))ne=ne==="auto"?lu():ne,o.drawCutRectanglePath(Ve||r,Q.x,Q.y,Ie,ze,null,ne+(he+z+J)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(te))ne=ne==="auto"?Hn(Ie,ze):ne,o.drawBottomRoundRectanglePath(Ve||r,Q.x,Q.y,Ie,ze,ne+(he+z+J)/2);else if(te==="barrel")o.drawBarrelPath(Ve||r,Q.x,Q.y,Ie,ze);else if(te.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(te)){var Zr=(he+z+J)/s;Ae=gs(ms(Ae,Zr)),o.drawPolygonPath(Ve||r,Q.x,Q.y,s,l,Ae)}else{var At=(he+z+J)/s;Ae=gs(ms(Ae,-At)),o.drawPolygonPath(Ve||r,Q.x,Q.y,s,l,Ae)}if(h?r.stroke(Ve):r.stroke(),Y==="double"){r.lineWidth=he/3;var bt=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",h?r.stroke(Ve):r.stroke(),r.globalCompositeOperation=bt}r.setLineDash&&r.setLineDash([])}},Me=function(){i&&o.drawNodeOverlay(r,e,d,s,l)},ke=function(){i&&o.drawNodeUnderlay(r,e,d,s,l)},xe=function(){o.drawElementText(r,e,null,n)},Ee=e.pstyle("ghost").value==="yes";if(Ee){var ye=e.pstyle("ghost-offset-x").pfValue,se=e.pstyle("ghost-offset-y").pfValue,I=e.pstyle("ghost-opacity").value,W=I*f;r.translate(ye,se),L(),we(),ie(I*B),de(),Te(W,!0),K(I*V),ce(),_e(O!==0||T!==0),Te(W,!1),fe(W),r.translate(-ye,-se)}h&&r.translate(-d.x,-d.y),ke(),h&&r.translate(d.x,d.y),L(),we(),ie(),de(),Te(f,!0),K(),ce(),_e(O!==0||T!==0),Te(f,!1),fe(),h&&r.translate(-d.x,-d.y),xe(),Me(),t&&r.translate(g.x1,g.y1)}};var Wh=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,i,a,o){var s=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,d=n.pstyle("".concat(e,"-shape")).value,f=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(i=i||n.position(),a==null||o==null){var h=n.padding();a=n.width()+2*h,o=n.height()+2*h}s.colorFillStyle(t,c[0],c[1],c[2],u),s.nodeShapes[d].draw(t,i.x,i.y,a+l*2,o+l*2,f),t.fill()}}}};Li.drawNodeOverlay=Wh("overlay");Li.drawNodeUnderlay=Wh("underlay");Li.hasPie=function(r){return r=r[0],r._private.hasPie};Li.drawPie=function(r,e,t,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),o=n.x,s=n.y,l=e.width(),u=e.height(),c=Math.min(l,u)/2,d=0,f=this.usePaths();f&&(o=0,s=0),a.units==="%"?c=c*a.pfValue:a.pfValue!==void 0&&(c=a.pfValue/2);for(var h=1;h<=i.pieBackgroundN;h++){var v=e.pstyle("pie-"+h+"-background-size").value,m=e.pstyle("pie-"+h+"-background-color").value,p=e.pstyle("pie-"+h+"-background-opacity").value*t,g=v/100;g+d>1&&(g=1-d);var y=1.5*Math.PI+2*Math.PI*d,C=2*Math.PI*g,x=y+C;v===0||d>=1||d+g>1||(r.beginPath(),r.moveTo(o,s),r.arc(o,s,c,y,x),r.closePath(),this.colorFillStyle(r,m[0],m[1],m[2],p),r.fill(),d+=g)}};var qt={},jb=100;qt.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),t=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/t};qt.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===r){t=!1;break}return t&&(n={context:r},e.push(n)),n};qt.createGradientStyleFor=function(r,e,t,n,i){var a,o=this.usePaths(),s=t.pstyle(e+"-gradient-stop-colors").value,l=t.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(t.isEdge()){var u=t.sourceEndpoint(),c=t.targetEndpoint(),d=t.midpoint(),f=qn(u,d),h=qn(c,d);a=r.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(f,h))}else{var v=o?{x:0,y:0}:t.position(),m=t.paddedWidth(),p=t.paddedHeight();a=r.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(m,p))}else if(t.isEdge()){var g=t.sourceEndpoint(),y=t.targetEndpoint();a=r.createLinearGradient(g.x,g.y,y.x,y.y)}else{var C=o?{x:0,y:0}:t.position(),x=t.paddedWidth(),M=t.paddedHeight(),P=x/2,D=M/2,R=t.pstyle("background-gradient-direction").value;switch(R){case"to-bottom":a=r.createLinearGradient(C.x,C.y-D,C.x,C.y+D);break;case"to-top":a=r.createLinearGradient(C.x,C.y+D,C.x,C.y-D);break;case"to-left":a=r.createLinearGradient(C.x+P,C.y,C.x-P,C.y);break;case"to-right":a=r.createLinearGradient(C.x-P,C.y,C.x+P,C.y);break;case"to-bottom-right":case"to-right-bottom":a=r.createLinearGradient(C.x-P,C.y-D,C.x+P,C.y+D);break;case"to-top-right":case"to-right-top":a=r.createLinearGradient(C.x-P,C.y+D,C.x+P,C.y-D);break;case"to-bottom-left":case"to-left-bottom":a=r.createLinearGradient(C.x+P,C.y-D,C.x-P,C.y+D);break;case"to-top-left":case"to-left-top":a=r.createLinearGradient(C.x+P,C.y+D,C.x-P,C.y-D);break}}if(!a)return null;for(var A=l.length===s.length,F=s.length,O=0;O<F;O++)a.addColorStop(A?l[O]:O/(F-1),"rgba("+s[O][0]+","+s[O][1]+","+s[O][2]+","+i+")");return a};qt.gradientFillStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"background",e,t,n);if(!i)return null;r.fillStyle=i};qt.colorFillStyle=function(r,e,t,n,i){r.fillStyle="rgba("+e+","+t+","+n+","+i+")"};qt.eleFillStyle=function(r,e,t){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(r,e,n,t);else{var i=e.pstyle("background-color").value;this.colorFillStyle(r,i[0],i[1],i[2],t)}};qt.gradientStrokeStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"line",e,t,n);if(!i)return null;r.strokeStyle=i};qt.colorStrokeStyle=function(r,e,t,n,i){r.strokeStyle="rgba("+e+","+t+","+n+","+i+")"};qt.eleStrokeStyle=function(r,e,t){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(r,e,n,t);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(r,i[0],i[1],i[2],t)}};qt.matchCanvasSize=function(r){var e=this,t=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],o=e.getPixelRatio(),s=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var l=i*o,u=a*o,c;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var d=t.canvasContainer;d.style.width=i+"px",d.style.height=a+"px";for(var f=0;f<e.CANVAS_LAYERS;f++)c=t.canvases[f],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";for(var f=0;f<e.BUFFER_COUNT;f++)c=t.bufferCanvases[f],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,o<=1&&(c=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=l*e.textureMult,c.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=o}};qt.renderTo=function(r,e,t,n){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:n})};qt.clearCanvas=function(){var r=this,e=r.data;function t(n){n.clearRect(0,0,r.canvasWidth,r.canvasHeight)}t(e.contexts[r.NODE]),t(e.contexts[r.DRAG])};qt.render=function(r){var e=this;r=r||Of();var t=e.cy,n=r.forcedContext,i=r.drawAllLayers,a=r.drawOnlyNodeLayer,o=r.forcedZoom,s=r.forcedPan,l=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,u=e.data,c=u.canvasNeedsRedraw,d=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),f=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,h=e.motionBlurPxRatio,v=t.hasCompoundNodes(),m=e.hoverData.draggingEles,p=!!(e.hoverData.selecting||e.touchData.selecting);f=f&&!n&&e.motionBlurEnabled&&!p;var g=f;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),f&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(g=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var y=t.style(),C=t.zoom(),x=o!==void 0?o:C,M=t.pan(),P={x:M.x,y:M.y},D={zoom:C,pan:{x:M.x,y:M.y}},R=e.prevViewport,A=R===void 0||D.zoom!==R.zoom||D.pan.x!==R.pan.x||D.pan.y!==R.pan.y;!A&&!(m&&!v)&&(e.motionBlurPxRatio=1),s&&(P=s),x*=l,P.x*=l,P.y*=l;var F=e.getCachedZSortedEles();function O(K,L,j,$,U){var X=K.globalCompositeOperation;K.globalCompositeOperation="destination-out",e.colorFillStyle(K,255,255,255,e.motionBlurTransparency),K.fillRect(L,j,$,U),K.globalCompositeOperation=X}function T(K,L){var j,$,U,X;!e.clearingMotionBlur&&(K===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||K===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(j={x:M.x*h,y:M.y*h},$=C*h,U=e.canvasWidth*h,X=e.canvasHeight*h):(j=P,$=x,U=e.canvasWidth,X=e.canvasHeight),K.setTransform(1,0,0,1,0,0),L==="motionBlur"?O(K,0,0,U,X):!n&&(L===void 0||L)&&K.clearRect(0,0,U,X),i||(K.translate(j.x,j.y),K.scale($,$)),s&&K.translate(s.x,s.y),o&&K.scale(o,o)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=t.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var B=e.data.bufferContexts[e.TEXTURE_BUFFER];B.setTransform(1,0,0,1,0,0),B.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:B,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var D=e.textureCache.viewport={zoom:t.zoom(),pan:t.pan(),width:e.canvasWidth,height:e.canvasHeight};D.mpan={x:(0-D.pan.x)/D.zoom,y:(0-D.pan.y)/D.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var E=u.contexts[e.NODE],w=e.textureCache.texture,D=e.textureCache.viewport;E.setTransform(1,0,0,1,0,0),f?O(E,0,0,D.width,D.height):E.clearRect(0,0,D.width,D.height);var b=y.core("outside-texture-bg-color").value,_=y.core("outside-texture-bg-opacity").value;e.colorFillStyle(E,b[0],b[1],b[2],_),E.fillRect(0,0,D.width,D.height);var C=t.zoom();T(E,!1),E.clearRect(D.mpan.x,D.mpan.y,D.width/D.zoom/l,D.height/D.zoom/l),E.drawImage(w,D.mpan.x,D.mpan.y,D.width/D.zoom/l,D.height/D.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var k=t.extent(),S=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),N=e.hideEdgesOnViewport&&S,V=[];if(V[e.NODE]=!c[e.NODE]&&f&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,V[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),V[e.DRAG]=!c[e.DRAG]&&f&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,V[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||V[e.NODE]){var z=f&&!V[e.NODE]&&h!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),H=f&&!z?"motionBlur":void 0;T(E,H),N?e.drawCachedNodes(E,F.nondrag,l,k):e.drawLayeredElements(E,F.nondrag,l,k),e.debug&&e.drawDebugPoints(E,F.nondrag),!i&&!f&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||V[e.DRAG])){var z=f&&!V[e.DRAG]&&h!==1,E=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);T(E,f&&!z?"motionBlur":void 0),N?e.drawCachedNodes(E,F.drag,l,k):e.drawCachedElements(E,F.drag,l,k),e.debug&&e.drawDebugPoints(E,F.drag),!i&&!f&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,T),f&&h!==1){var Y=u.contexts[e.NODE],ee=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],J=u.contexts[e.DRAG],ne=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ie=function(L,j,$){L.setTransform(1,0,0,1,0,0),$||!g?L.clearRect(0,0,e.canvasWidth,e.canvasHeight):O(L,0,0,e.canvasWidth,e.canvasHeight);var U=h;L.drawImage(j,0,0,e.canvasWidth*U,e.canvasHeight*U,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||V[e.NODE])&&(ie(Y,ee,V[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||V[e.DRAG])&&(ie(J,ne,V[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=D,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),f&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},jb)),n||t.emit("render")};var Ji;qt.drawSelectionRectangle=function(r,e){var t=this,n=t.cy,i=t.data,a=n.style(),o=r.drawOnlyNodeLayer,s=r.drawAllLayers,l=i.canvasNeedsRedraw,u=r.forcedContext;if(t.showFps||!o&&l[t.SELECT_BOX]&&!s){var c=u||i.contexts[t.SELECT_BOX];if(e(c),t.selection[4]==1&&(t.hoverData.selecting||t.touchData.selecting)){var d=t.cy.zoom(),f=a.core("selection-box-border-width").value/d;c.lineWidth=f,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]),f>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]))}if(i.bgActivePosistion&&!t.hoverData.selecting){var d=t.cy.zoom(),h=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(h.x,h.y,a.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var v=t.lastRedrawTime;if(t.showFps&&v){v=Math.round(v);var m=Math.round(1e3/v),p="1 frame = "+v+" ms = "+m+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!Ji){var g=c.measureText(p);Ji=g.actualBoundingBoxAscent}c.fillText(p,0,Ji);var y=60;c.strokeRect(0,Ji+10,250,20),c.fillRect(0,Ji+10,250*Math.min(m/y,1),20)}s||(l[t.SELECT_BOX]=!1)}};function lf(r,e,t){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(n));return n}function $b(r,e,t){var n=lf(r,r.VERTEX_SHADER,e),i=lf(r,r.FRAGMENT_SHADER,t),a=r.createProgram();if(r.attachShader(a,n),r.attachShader(a,i),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function Gb(r,e,t){t===void 0&&(t=e);var n=r.makeOffscreenCanvas(e,t),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function _u(r){var e=r.pixelRatio,t=r.cy.zoom(),n=r.cy.pan();return{zoom:t*e,pan:{x:n.x*e,y:n.y*e}}}function Il(r,e,t,n,i){var a=n*t+e.x,o=i*t+e.y;return o=Math.round(r.canvasHeight-o),[a,o]}function rs(r,e,t){var n=r[0]/255,i=r[1]/255,a=r[2]/255,o=e,s=t||new Array(4);return s[0]=n*o,s[1]=i*o,s[2]=a*o,s[3]=o,s}function ns(r,e){var t=e||new Array(4);return t[0]=(r>>0&255)/255,t[1]=(r>>8&255)/255,t[2]=(r>>16&255)/255,t[3]=(r>>24&255)/255,t}function qb(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function Hb(r,e){var t=r.createTexture();return t.buffer=function(n){r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},t.deleteTexture=function(){r.deleteTexture(t)},t}function Uh(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function Kh(r,e,t){switch(e){case r.FLOAT:return new Float32Array(t);case r.INT:return new Int32Array(t)}}function Wb(r,e,t,n,i,a){switch(e){case r.FLOAT:return new Float32Array(t.buffer,a*n,i);case r.INT:return new Int32Array(t.buffer,a*n,i)}}function Ub(r,e,t,n){var i=Uh(r,e),a=ft(i,2),o=a[0],s=a[1],l=Kh(r,s,n),u=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,l,r.STATIC_DRAW),s===r.FLOAT?r.vertexAttribPointer(t,o,s,!1,0,0):s===r.INT&&r.vertexAttribIPointer(t,o,s,0,0),r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,null),u}function sr(r,e,t,n){var i=Uh(r,t),a=ft(i,3),o=a[0],s=a[1],l=a[2],u=Kh(r,s,e*o),c=o*l,d=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,d),r.bufferData(r.ARRAY_BUFFER,e*c,r.DYNAMIC_DRAW),r.enableVertexAttribArray(n),s===r.FLOAT?r.vertexAttribPointer(n,o,s,!1,c,0):s===r.INT&&r.vertexAttribIPointer(n,o,s,c,0),r.vertexAttribDivisor(n,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var f=new Array(e),h=0;h<e;h++)f[h]=Wb(r,s,u,c,o,h);return d.dataArray=u,d.stride=c,d.size=o,d.getView=function(v){return f[v]},d.setPoint=function(v,m,p){var g=f[v];g[0]=m,g[1]=p},d.bufferSubData=function(v){r.bindBuffer(r.ARRAY_BUFFER,d),v?r.bufferSubData(r.ARRAY_BUFFER,0,u,0,v*o):r.bufferSubData(r.ARRAY_BUFFER,0,u)},d}function Kb(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,i,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var uf=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function la(){var r=new uf(9);return uf!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Xh(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function Xb(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=t[0],h=t[1],v=t[2],m=t[3],p=t[4],g=t[5],y=t[6],C=t[7],x=t[8];return r[0]=f*n+h*o+v*u,r[1]=f*i+h*s+v*c,r[2]=f*a+h*l+v*d,r[3]=m*n+p*o+g*u,r[4]=m*i+p*s+g*c,r[5]=m*a+p*l+g*d,r[6]=y*n+C*o+x*u,r[7]=y*i+C*s+x*c,r[8]=y*a+C*l+x*d,r}function Es(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=t[0],h=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r[4]=s,r[5]=l,r[6]=f*n+h*o+u,r[7]=f*i+h*s+c,r[8]=f*a+h*l+d,r}function Yh(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=Math.sin(t),h=Math.cos(t);return r[0]=h*n+f*o,r[1]=h*i+f*s,r[2]=h*a+f*l,r[3]=h*o-f*n,r[4]=h*s-f*i,r[5]=h*l-f*a,r[6]=u,r[7]=c,r[8]=d,r}function Eu(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Yb(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var ua={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},ea=Tt({getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:null,getPadding:null}),Qb=function(){function r(e,t){Mn(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.atlasSize=t.webglTexSize,this.rows=t.webglTexRows,this.enableWrapping=t.enableWrapping,this.texHeight=Math.floor(this.atlasSize/this.rows),this.maxTexWidth=this.atlasSize,this.texture=null,this.canvas=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=t.createTextureCanvas(e,this.atlasSize,this.atlasSize),this.scratch=t.createTextureCanvas(e,this.atlasSize,this.texHeight,"scratch")}return Dn(r,[{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(t){var n=t.w,i=t.h,a=this.texHeight,o=this.maxTexWidth,s=a/i,l=n*s,u=i*s;return l>o&&(s=o/n,l=n*s,u=i*s),{scale:s,texW:l,texH:u}}},{key:"draw",value:function(t,n,i){var a=this,o=this.atlasSize,s=this.rows,l=this.texHeight,u=this.getScale(n),c=u.scale,d=u.texW,f=u.texH,h=[null,null],v=function(C,x){if(i&&x){var M=x.context,P=C.x,D=C.row,R=P,A=l*D;M.save(),M.translate(R,A),M.scale(c,c),i(M,n),M.restore()}},m=function(){v(a.freePointer,a.canvas),h[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:d,h:f},h[1]={x:a.freePointer.x+d,y:a.freePointer.row*l,w:0,h:f},a.freePointer.x+=d,a.freePointer.x==o&&(a.freePointer.x=0,a.freePointer.row++)},p=function(){var C=a.scratch,x=a.canvas;C.clear(),v({x:0,row:0},C);var M=o-a.freePointer.x,P=d-M,D=l;{var R=a.freePointer.x,A=a.freePointer.row*l,F=M;x.context.drawImage(C,0,0,F,D,R,A,F,D),h[0]={x:R,y:A,w:F,h:f}}{var O=M,T=(a.freePointer.row+1)*l,B=P;x&&x.context.drawImage(C,O,0,B,D,0,T,B,D),h[1]={x:0,y:T,w:B,h:f}}a.freePointer.x=P,a.freePointer.row++},g=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+d<=o)m();else{if(this.freePointer.row>=s-1)return!1;this.freePointer.x===o?(g(),m()):this.enableWrapping?p():(g(),m())}return this.keyToLocation.set(t,h),this.needsBuffer=!0,h}},{key:"getOffsets",value:function(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(t){var n=this.atlasSize,i=this.rows,a=this.getScale(t),o=a.texW;return this.freePointer.x+o>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(t){this.texture||(this.texture=Hb(t,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1)}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null,this.needsBuffer=!0)}}]),r}(),Zb=function(){function r(e,t){Mn(this,r),this.r=e,this.opts=t,this.keyToIds=new Map,this.idToKey=new Map,this.atlases=[],this.styleKeyToAtlas=new Map,this.styleKeyNeedsRedraw=new Set,this.forceGC=!1}return Dn(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"getIdsFor",value:function(t){var n=this.keyToIds.get(t);return n||(n=new Set,this.keyToIds.set(t,n)),n}},{key:"_createAtlas",value:function(){var t=this.r,n=this.opts;return new Qb(t,n)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var t=this.r,n=this.opts,i=n.webglTexSize,a=Math.floor(i/n.webglTexRows);this.scratch=n.createTextureCanvas(t,i,a,"scratch")}return this.scratch}},{key:"draw",value:function(t,n,i,a){if(this.styleKeyNeedsRedraw.has(n)){this.styleKeyNeedsRedraw.delete(n),this.deleteKey(t,n);var o=this.styleKeyToAtlas.get(n);o&&(o.forceGC=!0),this.styleKeyToAtlas.delete(n)}var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s),this.getIdsFor(n).add(t),this.idToKey.set(t,n)),s}},{key:"getAtlas",value:function(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function(t){return this.styleKeyToAtlas.has(t)}},{key:"deleteKey",value:function(t,n){this.idToKey.delete(t),this.getIdsFor(n).delete(t)}},{key:"checkKeyIsInvalid",value:function(t,n){if(!this.idToKey.has(t))return!1;var i=this.idToKey.get(t);return i!=n?(this.deleteKey(t,i),!0):!1}},{key:"_getKeysToCollect",value:function(){var t=new Set,n=lr(this.styleKeyToAtlas.keys()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;this.getIdsFor(a).size==0&&t.add(a)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"gc",value:function(){var t=this,n=this.atlases.some(function(f){return f.forceGC}),i=this._getKeysToCollect();if(i.size===0&&!n){console.log("nothing to garbage collect");return}var a=[],o=new Map,s=null,l=lr(this.atlases),u;try{var c=function(){var h=u.value,v=h.getKeys(),m=Jb(i,v);if(m.size===0&&!h.forceGC)return a.push(h),v.forEach(function(D){return o.set(D,h)}),"continue";s||(s=t._createAtlas(),a.push(s));var p=lr(v),g;try{for(p.s();!(g=p.n()).done;){var y=g.value;if(!m.has(y)){var C=h.getOffsets(y),x=ft(C,2),M=x[0],P=x[1];s.canFit({w:M.w+P.w,h:M.h})||(s=t._createAtlas(),a.push(s)),t._copyTextureToNewAtlas(y,h,s),o.set(y,s)}}}catch(D){p.e(D)}finally{p.f()}};for(l.s();!(u=l.n()).done;)var d=c()}catch(f){l.e(f)}finally{l.f()}this.atlases=a,this.styleKeyToAtlas=o}},{key:"_copyTextureToNewAtlas",value:function(t,n,i){var a=n.getOffsets(t),o=ft(a,2),s=o[0],l=o[1];if(l.w===0)i.draw(t,s,function(f){f.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,s.w,0,l.w,l.h);var c=s.w+l.w,d=s.h;i.draw(t,{w:c,h:d},function(f){f.drawImage(u,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}]),r}();function Jb(r,e){return r.intersection?r.intersection(e):new Set(mf(r).filter(function(t){return e.has(t)}))}var ex=function(){function r(e,t){Mn(this,r),this.r=e;var n=t;this.globalOptions=n,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.renderTypes=new Map,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[],this._cacheScratchCanvas(n)}return Dn(r,[{key:"_cacheScratchCanvas",value:function(t){var n=-1,i=-1,a=null,o=t.createTextureCanvas;t.createTextureCanvas=function(s,l,u,c){return c?((!a||l!=n||u!=i)&&(n=l,i=u,a=o(s,l,u)),a):o(s,l,u)}}},{key:"addRenderType",value:function(t,n){var i=new Zb(this.r,this.globalOptions),a=n;this.renderTypes.set(t,Fe({type:t,atlasCollection:i},a))}},{key:"getRenderTypes",value:function(){return mf(this.renderTypes.values())}},{key:"getRenderTypeOpts",value:function(t){return this.renderTypes.get(t)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.forceRedraw,a=i===void 0?!1:i,o=n.filterEle,s=o===void 0?function(){return!0}:o,l=n.filterType,u=l===void 0?function(){return!0}:l,c=!1,d=lr(t),f;try{for(d.s();!(f=d.n()).done;){var h=f.value;if(s(h)){var v=h.id(),m=lr(this.getRenderTypes()),p;try{for(m.s();!(p=m.n()).done;){var g=p.value;if(u(g.type)){var y=g.getKey(h);a?(g.atlasCollection.deleteKey(v,y),g.atlasCollection.styleKeyNeedsRedraw.add(y),c=!0):c|=g.atlasCollection.checkKeyIsInvalid(v,y)}}}catch(C){m.e(C)}finally{m.f()}}}}catch(C){d.e(C)}finally{d.f()}return c}},{key:"gc",value:function(){var t=lr(this.getRenderTypes()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.atlasCollection.gc()}}catch(a){t.e(a)}finally{t.f()}}},{key:"isRenderable",value:function(t,n){var i=this.getRenderTypeOpts(n);return i&&i.isVisible(t)}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"getOrCreateAtlas",value:function(t,n,i){var a=this.renderTypes.get(i),o=a.getKey(t),s=t.id();return a.atlasCollection.draw(s,o,n,function(l){a.drawElement(l,t,n,!0,!0)})}},{key:"getAtlasIndexForBatch",value:function(t){var n=this.batchAtlases.indexOf(t);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(t),n=this.batchAtlases.length-1}return n}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlases},function(t,n){return n})}},{key:"getAtlasInfo",value:function(t,n){var i=this.renderTypes.get(n),a=i.getBoundingBox(t),o=this.getOrCreateAtlas(t,a,n),s=this.getAtlasIndexForBatch(o);if(s!==void 0){var l=i.getKey(t),u=o.getOffsets(l),c=ft(u,2),d=c[0],f=c[1];return{atlasID:s,tex:d,tex1:d,tex2:f,bb:a,type:n,styleKey:l}}}},{key:"canAddToCurrentBatch",value:function(t,n){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var i=this.renderTypes.get(n),a=i.getKey(t),o=i.atlasCollection.getAtlas(a);return o&&this.batchAtlases.includes(o)}return!0}},{key:"setTransformMatrix",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=n.bb,s=n.type,l=n.tex1,u=n.tex2,c=this.getRenderTypeOpts(s),d=c.getPadding?c.getPadding(i):0,f=l.w/(l.w+u.w);a||(f=1-f);var h=this.getAdjustedBB(o,d,a,f),v,m;Xh(t);var p=c.getRotation?c.getRotation(i):0;if(p!==0){var g=c.getRotationPoint(i),y=g.x,C=g.y;Es(t,t,[y,C]),Yh(t,t,p);var x=c.getRotationOffset(i);v=x.x+h.xOffset,m=x.y}else v=h.x1,m=h.y1;Es(t,t,[v,m]),Eu(t,t,[h.w,h.h])}},{key:"getTransformMatrix",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=la();return this.setTransformMatrix(a,t,n,i),a}},{key:"getAdjustedBB",value:function(t,n,i,a){var o=t.x1,s=t.y1,l=t.w,u=t.h;n&&(o-=n,s-=n,l+=2*n,u+=2*n);var c=0,d=l*a;return i&&a<1?l=d:!i&&a<1&&(c=l-d,o+=c,l=d),{x1:o,y1:s,w:l,h:u,xOffset:c}}},{key:"getDebugInfo",value:function(){var t=[],n=lr(this.renderTypes),i;try{for(n.s();!(i=n.n()).done;){var a=ft(i.value,2),o=a[0],s=a[1],l=s.atlasCollection.getCounts(),u=l.keyCount,c=l.atlasCount;t.push({type:o,keyCount:u,atlasCount:c})}}catch(d){n.e(d)}finally{n.f()}return t}}]),r}(),Ol=0,cf=1,df=2,Fl=3,tx=function(){function r(e,t,n){Mn(this,r),this.r=e,this.gl=t,this.maxInstances=n.webglBatchSize,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,n.enableWrapping=!0,n.createTextureCanvas=Gb,this.atlasManager=new ex(e,n),this.program=this.createShaderProgram(ua.SCREEN),this.pickingProgram=this.createShaderProgram(ua.PICKING),this.vao=this.createVAO(),this.debugInfo=[]}return Dn(r,[{key:"addTextureRenderType",value:function(t,n){this.atlasManager.addRenderType(t,n)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(t,{filterType:function(s){return s===i},forceRedraw:!0}):a.invalidate(t)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function(t){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; 

      // what are we rendering?
      in int aVertType;

      // for picking
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex1; // x/y/w/h of texture in atlas
      in vec4 aTex2; 

      // for any transforms that are needed
      in vec4 aScaleRotate1;  // vectors use fewer attributes than matrices
      in vec2 aTranslate1;
      in vec4 aScaleRotate2;
      in vec2 aTranslate2;

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in float aLineWidth;
      in vec4 aEdgeColor;

      out vec2 vTexCoord;
      out vec4 vEdgeColor;
      flat out int vAtlasId;
      flat out vec4 vIndex;
      flat out int vVertType;

      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition;

        if(aVertType == `.concat(Ol,`) {
          float texX;
          float texY;
          float texW;
          float texH;
          mat3  texMatrix;

          int vid = gl_VertexID;
          if(vid <= 5) {
            texX = aTex1.x;
            texY = aTex1.y;
            texW = aTex1.z;
            texH = aTex1.w;
            texMatrix = mat3(
              vec3(aScaleRotate1.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate1,      1.0)
            );
          } else {
            texX = aTex2.x;
            texY = aTex2.y;
            texW = aTex2.z;
            texH = aTex2.w;
            texMatrix = mat3(
              vec3(aScaleRotate2.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate2,      1.0)
            );
          }

          if(vid == 1 || vid == 2 || vid == 4 || vid == 7 || vid == 8 || vid == 10) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5 || vid == 8 || vid == 10 || vid == 11) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * texMatrix * vec3(position, 1.0), 1.0);
        } 
        else if(aVertType == `).concat(cf,` && vid < 6) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(df,` && vid < 6) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0 = pointA;
          vec2 p1 = pointB;
          vec2 p2 = pointC;
          vec2 pos = position;
          if(position.x == 1.0) {
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth;

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(Fl,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2( 0.0,   0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          mat3 transform = mat3(
            vec3(aScaleRotate1.xy, 0.0),
            vec3(aScaleRotate1.zw, 0.0),
            vec3(aTranslate1,      1.0)
          );
          gl_Position = vec4(uPanZoomMatrix * transform * vec3(position, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vIndex = aIndex;
        vVertType = aVertType;
      }
    `),a=this.atlasManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // define texture unit for each node in the batch
      `.concat(a.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;

      in vec2 vTexCoord;
      in vec4 vEdgeColor;
      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;

      out vec4 outColor;

      void main(void) {
        if(vVertType == `).concat(Ol,`) {
          `).concat(a.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } else if(vVertType == `).concat(Fl,`) {
          // blend arrow color with background (using premultiplied alpha)
          outColor.rgb = vEdgeColor.rgb + (uBGColor.rgb * (1.0 - vEdgeColor.a)); 
          outColor.a = 1.0; // make opaque, masks out line under arrow
        } else {
          outColor = vEdgeColor;
        }

        `).concat(t.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),s=$b(n,i,o);s.aPosition=n.getAttribLocation(s,"aPosition"),s.aIndex=n.getAttribLocation(s,"aIndex"),s.aVertType=n.getAttribLocation(s,"aVertType"),s.aAtlasId=n.getAttribLocation(s,"aAtlasId"),s.aTex1=n.getAttribLocation(s,"aTex1"),s.aTex2=n.getAttribLocation(s,"aTex2"),s.aScaleRotate1=n.getAttribLocation(s,"aScaleRotate1"),s.aTranslate1=n.getAttribLocation(s,"aTranslate1"),s.aScaleRotate2=n.getAttribLocation(s,"aScaleRotate2"),s.aTranslate2=n.getAttribLocation(s,"aTranslate2"),s.aPointAPointB=n.getAttribLocation(s,"aPointAPointB"),s.aPointCPointD=n.getAttribLocation(s,"aPointCPointD"),s.aLineWidth=n.getAttribLocation(s,"aLineWidth"),s.aEdgeColor=n.getAttribLocation(s,"aEdgeColor"),s.uPanZoomMatrix=n.getUniformLocation(s,"uPanZoomMatrix"),s.uAtlasSize=n.getUniformLocation(s,"uAtlasSize"),s.uBGColor=n.getUniformLocation(s,"uBGColor"),s.uTextures=[];for(var l=0;l<this.atlasManager.maxAtlases;l++)s.uTextures.push(n.getUniformLocation(s,"uTexture".concat(l)));return s}},{key:"createVAO",value:function(){var t=[0,0,1,0,1,1,0,0,1,1,0,1],n=[].concat(t,t);this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,o=this.program,s=a.createVertexArray();return a.bindVertexArray(s),Ub(a,"vec2",o.aPosition,n),this.indexBuffer=sr(a,i,"vec4",o.aIndex),this.vertTypeBuffer=sr(a,i,"int",o.aVertType),this.atlasIdBuffer=sr(a,i,"int",o.aAtlasId),this.tex1Buffer=sr(a,i,"vec4",o.aTex1),this.tex2Buffer=sr(a,i,"vec4",o.aTex2),this.scaleRotate1Buffer=sr(a,i,"vec4",o.aScaleRotate1),this.translate1Buffer=sr(a,i,"vec2",o.aTranslate1),this.scaleRotate2Buffer=sr(a,i,"vec4",o.aScaleRotate2),this.translate2Buffer=sr(a,i,"vec2",o.aTranslate2),this.pointAPointBBuffer=sr(a,i,"vec4",o.aPointAPointB),this.pointCPointDBuffer=sr(a,i,"vec4",o.aPointCPointD),this.lineWidthBuffer=sr(a,i,"float",o.aLineWidth),this.edgeColorBuffer=sr(a,i,"vec4",o.aEdgeColor),a.bindVertexArray(null),s}},{key:"buffers",get:function(){var t=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return t[n]})),this._buffers}},{key:"startFrame",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ua.SCREEN;this.panZoomMatrix=t,this.debugInfo=n,this.renderTarget=i,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.atlasManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"getTempMatrix",value:function(){return this.tempMatrix=this.tempMatrix||la()}},{key:"drawTexture",value:function(t,n,i){var a=this.atlasManager;if(a.isRenderable(t,i)){a.canAddToCurrentBatch(t,i)||this.endBatch();var o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=Ol;var s=this.indexBuffer.getView(o);ns(n,s);var l=a.getAtlasInfo(t,i,l),u=l.atlasID,c=l.tex1,d=l.tex2,f=this.atlasIdBuffer.getView(o);f[0]=u;var h=this.tex1Buffer.getView(o);h[0]=c.x,h[1]=c.y,h[2]=c.w,h[3]=c.h;var v=this.tex2Buffer.getView(o);v[0]=d.x,v[1]=d.y,v[2]=d.w,v[3]=d.h;for(var m=this.getTempMatrix(),p=0,g=[1,2];p<g.length;p++){var y=g[p];a.setTransformMatrix(m,l,t,y===1);var C=this["scaleRotate".concat(y,"Buffer")].getView(o);C[0]=m[0],C[1]=m[1],C[2]=m[3],C[3]=m[4];var x=this["translate".concat(y,"Buffer")].getView(o);x[0]=m[6],x[1]=m[7]}this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function(t,n,i){var a=t._private.rscratch,o,s,l;if(i==="source"?(o=a.arrowStartX,s=a.arrowStartY,l=a.srcArrowAngle):(o=a.arrowEndX,s=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(s)||s==null||isNaN(l)||l==null)){var u=t.pstyle(i+"-arrow-shape").value;if(u!=="none"){var c=t.pstyle(i+"-arrow-color").value,d=t.pstyle("opacity").value,f=t.pstyle("line-opacity").value,h=d*f,v=t.pstyle("width").pfValue,m=t.pstyle("arrow-scale").value,p=this.r.getArrowWidth(v,m),g=this.getTempMatrix();Xh(g),Es(g,g,[o,s]),Eu(g,g,[p,p]),Yh(g,g,l);var y=this.instanceCount;this.vertTypeBuffer.getView(y)[0]=Fl;var C=this.indexBuffer.getView(y);ns(n,C);var x=this.edgeColorBuffer.getView(y);rs(c,h,x);var M=this.scaleRotate1Buffer.getView(y);M[0]=g[0],M[1]=g[1],M[2]=g[3],M[3]=g[4];var P=this.translate1Buffer.getView(y);P[0]=g[6],P[1]=g[7],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(t,n){var i=t.pstyle("opacity").value,a=t.pstyle("line-opacity").value,o=t.pstyle("width").pfValue,s=t.pstyle("line-color").value,l=i*a,u=this.getEdgePoints(t);if(u.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),u.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=cf;var d=this.indexBuffer.getView(c);ns(n,d);var f=this.edgeColorBuffer.getView(c);rs(s,l,f);var h=this.lineWidthBuffer.getView(c);h[0]=o;var v=this.pointAPointBBuffer.getView(c);v[0]=u[0],v[1]=u[1],v[2]=u[2],v[3]=u[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var m=0;m<u.length-2;m+=2){var p=this.instanceCount;this.vertTypeBuffer.getView(p)[0]=df;var g=this.indexBuffer.getView(p);ns(n,g);var y=this.edgeColorBuffer.getView(p);rs(s,l,y);var C=this.lineWidthBuffer.getView(p);C[0]=o;var x=u[m-2],M=u[m-1],P=u[m],D=u[m+1],R=u[m+2],A=u[m+3],F=u[m+4],O=u[m+5];m==0&&(x=2*P-R+.001,M=2*D-A+.001),m==u.length-4&&(F=2*R-P+.001,O=2*A-D+.001);var T=this.pointAPointBBuffer.getView(p);T[0]=x,T[1]=M,T[2]=P,T[3]=D;var B=this.pointCPointDBuffer.getView(p);B[0]=R,B[1]=A,B[2]=F,B[3]=O,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"getEdgePoints",value:function(t){var n=t._private.rscratch,i=n.allpts;if(i.length==4)return i;var a=this.getNumSegments(t);return this.getCurveSegmentPoints(i,a)}},{key:"getNumSegments",value:function(t){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function(t,n){if(t.length==4)return t;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=t[0],i[1]=t[1];else if(a==n)i[a*2]=t[t.length-2],i[a*2+1]=t[t.length-1];else{var o=a/n;this.setCurvePoint(t,o,i,a*2)}return i}},{key:"setCurvePoint",value:function(t,n,i,a){if(t.length<=2)i[a]=t[0],i[a+1]=t[1];else{for(var o=Array(t.length-2),s=0;s<o.length;s+=2){var l=(1-n)*t[s]+n*t[s+2],u=(1-n)*t[s+1]+n*t[s+3];o[s]=l,o[s+1]=u}return this.setCurvePoint(o,n,i,a)}}},{key:"endBatch",value:function(){var t=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(o),t.bindVertexArray(n);var s=lr(this.buffers),l;try{for(s.s();!(l=s.n()).done;){var u=l.value;u.bufferSubData(a)}}catch(v){s.e(v)}finally{s.f()}for(var c=this.atlasManager.getAtlases(),d=0;d<c.length;d++)c[d].bufferIfNeeded(t);for(var f=0;f<c.length;f++)t.activeTexture(t.TEXTURE0+f),t.bindTexture(t.TEXTURE_2D,c[f].texture),t.uniform1i(o.uTextures[f],f);t.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),t.uniform1i(o.uAtlasSize,this.atlasManager.atlasSize);var h=rs(this.bgColor,1);t.uniform4fv(o.uBGColor,h),t.drawArraysInstanced(t.TRIANGLES,0,i,a),t.bindVertexArray(null),t.bindTexture(t.TEXTURE_2D,null),this.debugInfo&&this.debugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){return this.debugInfo}},{key:"getAtlasDebugInfo",value:function(){return this.atlasManager.getDebugInfo()}}]),r}();function ff(r,e){return"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(e,")")}var rx=function(){function r(e){Mn(this,r),this.r=e}return Dn(r,[{key:"getStyleKey",value:function(t,n){var i=this.getStyle(t,n),a=i.shape,o=i.opacity,s=i.color;if(!a)return null;var l=n.width(),u=n.height(),c=ff(s,o);return _n("".concat(a,"-").concat(l,"-").concat(u,"-").concat(c))}},{key:"isVisible",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value;return i>0}},{key:"getStyle",value:function(t,n){var i=n.pstyle("".concat(t,"-opacity")).value,a=n.pstyle("".concat(t,"-color")).value,o=n.pstyle("".concat(t,"-shape")).value;return{opacity:i,color:a,shape:o}}},{key:"getPadding",value:function(t,n){return n.pstyle("".concat(t,"-padding")).pfValue}},{key:"draw",value:function(t,n,i,a){if(this.isVisible(t,i)){var o=this.r,s=a.w,l=a.h,u=s/2,c=l/2,d=this.getStyle(t,i),f=d.shape,h=d.color,v=d.opacity;n.save(),n.fillStyle=ff(h,v),f==="round-rectangle"||f==="roundrectangle"?o.drawRoundRectanglePath(n,u,c,s,l,"auto"):f==="ellipse"&&o.drawEllipsePath(n,u,c,s,l),n.fill(),n.restore()}}}]),r}();function nx(r){var e=r&&r.style&&r.style.backgroundColor||"white";return _f(e)}var Qh={};Qh.initWebgl=function(r,e){var t=this,n=t.data.contexts[t.WEBGL],i=r.cy.container();r.bgColor=nx(i),r.webglTexSize=Math.min(r.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),t.webglDebug=r.webglDebug,t.webglDebugShowAtlases=r.webglDebugShowAtlases,console.log("max texture units",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),console.log("max texture size",n.getParameter(n.MAX_TEXTURE_SIZE)),console.log("webgl options",r),t.pickingFrameBuffer=Kb(n),t.pickingFrameBuffer.needsDraw=!0;var a=function(c){return t.getTextAngle(c,null)},o=function(c){var d=c.pstyle("label");return d&&d.value};t.eleDrawing=new tx(t,n,r);var s=new rx(t);t.eleDrawing.addTextureRenderType("node-body",ea({getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement,isVisible:function(c){return c.visible()}})),t.eleDrawing.addTextureRenderType("node-label",ea({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o})),t.eleDrawing.addTextureRenderType("node-overlay",ea({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("overlay",c)},drawElement:function(c,d,f){return s.draw("overlay",c,d,f)},isVisible:function(c){return s.isVisible("overlay",c)},getPadding:function(c){return s.getPadding("overlay",c)}})),t.eleDrawing.addTextureRenderType("node-underlay",ea({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("underlay",c)},drawElement:function(c,d,f){return s.draw("underlay",c,d,f)},isVisible:function(c){return s.isVisible("underlay",c)},getPadding:function(c){return s.getPadding("underlay",c)}})),t.eleDrawing.addTextureRenderType("edge-label",ea({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:a,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o}));var l=Ea(function(){console.log("garbage collect flag set"),t.data.gc=!0},1e4);t.onUpdateEleCalcs(function(u,c){var d=!1;c&&c.length>0&&(d|=t.eleDrawing.invalidate(c)),d&&l()}),ix(t)};function ix(r){{var e=r.render;r.render=function(a){a=a||{};var o=r.cy;r.webgl&&(o.zoom()>$h?(ax(r),e.call(r,a)):(ox(r),Jh(r,a,ua.SCREEN)))}}{var t=r.matchCanvasSize;r.matchCanvasSize=function(a){t.call(r,a),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(a,o,s,l){return fx(r,a,o)};{var n=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){n.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var i=r.notify;r.notify=function(a,o){i.call(r,a,o),a==="viewport"||a==="bounds"?r.pickingFrameBuffer.needsDraw=!0:a==="background"&&r.eleDrawing.invalidate(o,{type:"node-body"})}}}function ax(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function ox(r){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.canvasWidth,r.canvasHeight),n.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function sx(r){var e=r.canvasWidth,t=r.canvasHeight,n=_u(r),i=n.pan,a=n.zoom,o=la();Es(o,o,[i.x,i.y]),Eu(o,o,[a,a]);var s=la();Yb(s,e,t);var l=la();return Xb(l,s,o),l}function Zh(r,e){var t=r.canvasWidth,n=r.canvasHeight,i=_u(r),a=i.pan,o=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.translate(a.x,a.y),e.scale(o,o)}function lx(r,e){r.drawSelectionRectangle(e,function(t){return Zh(r,t)})}function ux(r){var e=r.data.contexts[r.NODE];e.save(),Zh(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function cx(r){var e=function(i,a,o){for(var s=i.atlasManager.getRenderTypeOpts(a),l=r.data.contexts[r.NODE],u=.125,c=s.atlasCollection.atlases,d=0;d<c.length;d++){var f=c[d],h=f.canvas,v=h.width,m=h.height,p=v*d,g=h.height*o;l.save(),l.scale(u,u),l.drawImage(h,p,g),l.strokeStyle="black",l.rect(p,g,v,m),l.stroke(),l.restore()}},t=0;e(r.eleDrawing,"node-body",t++),e(r.eleDrawing,"node-label",t++)}function dx(r,e,t,n,i){var a,o,s,l,u=_u(r),c=u.pan,d=u.zoom;if(n===void 0||i===void 0){var f=Il(r,c,d,e,t),h=ft(f,2),v=h[0],m=h[1],p=6;a=v-p/2,o=m-p/2,s=p,l=p}else{var g=Il(r,c,d,e,t),y=ft(g,2),C=y[0],x=y[1],M=Il(r,c,d,n,i),P=ft(M,2),D=P[0],R=P[1];a=C,o=R,s=Math.abs(D-C),l=Math.abs(R-x)}if(s===0||l===0)return[];var A=r.data.contexts[r.WEBGL];A.bindFramebuffer(A.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(A.viewport(0,0,A.canvas.width,A.canvas.height),Jh(r,null,ua.PICKING),r.pickingFrameBuffer.needsDraw=!1);var F=s*l,O=new Uint8Array(F*4);A.readPixels(a,o,s,l,A.RGBA,A.UNSIGNED_BYTE,O),A.bindFramebuffer(A.FRAMEBUFFER,null);for(var T=new Set,B=0;B<F;B++){var E=O.slice(B*4,B*4+4),w=qb(E)-1;w>=0&&T.add(w)}return T}function fx(r,e,t){var n=dx(r,e,t),i=r.getCachedZSortedEles(),a,o,s=lr(n),l;try{for(s.s();!(l=s.n()).done;){var u=l.value,c=i[u];if(!a&&c.isNode()&&(a=c),!o&&c.isEdge()&&(o=c),a&&o)break}}catch(d){s.e(d)}finally{s.f()}return[a,o].filter(Boolean)}function Jh(r,e,t){var n,i;r.webglDebug&&(i=[],n=performance.now());var a=r.eleDrawing,o=0;if(t.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&lx(r,e),r.data.canvasNeedsRedraw[r.NODE]||t.picking){var s=function(T,B){B+=1,T.isNode()?(a.drawTexture(T,B,"node-underlay"),a.drawTexture(T,B,"node-body"),a.drawTexture(T,B,"node-label"),a.drawTexture(T,B,"node-overlay")):(a.drawEdgeLine(T,B),a.drawEdgeArrow(T,B,"source"),a.drawEdgeArrow(T,B,"target"),a.drawTexture(T,B,"edge-label"))},l=r.data.contexts[r.WEBGL];t.screen?(l.clearColor(0,0,0,0),l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA)):l.disable(l.BLEND),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.viewport(0,0,l.canvas.width,l.canvas.height);var u=sx(r),c=r.getCachedZSortedEles();if(o=c.length,a.startFrame(u,i,t),t.screen){for(var d=0;d<c.nondrag.length;d++)s(c.nondrag[d],d);for(var f=0;f<c.drag.length;f++)s(c.drag[f],-1)}else if(t.picking)for(var h=0;h<c.length;h++)s(c[h],h);a.endFrame(),r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc()),t.screen&&r.webglDebugShowAtlases&&(ux(r),cx(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),m=!0,p=0,g=0,y=lr(i),C;try{for(y.s();!(C=y.n()).done;){var x=C.value;p++,g+=x.count}}catch(O){y.e(O)}finally{y.f()}var M=Math.ceil(v-n),P="".concat(o," elements, ").concat(g," rectangles, ").concat(p," batches");if(m)console.log("WebGL (".concat(t.name,") - ").concat(P));else{console.log("WebGL render (".concat(t.name,") - frame time ").concat(M,"ms")),console.log("  ".concat(P)),console.log("Texture Atlases Used:");var D=a.getAtlasDebugInfo(),R=lr(D),A;try{for(R.s();!(A=R.n()).done;){var F=A.value;console.log("  ".concat(F.type,": ").concat(F.keyCount," keys, ").concat(F.atlasCount," atlases"))}}catch(O){R.e(O)}finally{R.f()}console.log("")}}}var An={};An.drawPolygonPath=function(r,e,t,n,i,a){var o=n/2,s=i/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*a[0],t+s*a[1]);for(var l=1;l<a.length/2;l++)r.lineTo(e+o*a[l*2],t+s*a[l*2+1]);r.closePath()};An.drawRoundPolygonPath=function(r,e,t,n,i,a,o){o.forEach(function(s){return Rh(r,s)}),r.closePath()};An.drawRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,l=a==="auto"?Hn(n,i):Math.min(a,s,o);r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.arcTo(e+o,t-s,e+o,t,l),r.arcTo(e+o,t+s,e,t+s,l),r.arcTo(e-o,t+s,e-o,t,l),r.arcTo(e-o,t-s,e,t-s,l),r.lineTo(e,t-s),r.closePath()};An.drawBottomRoundRectanglePath=function(r,e,t,n,i,a){var o=n/2,s=i/2,l=a==="auto"?Hn(n,i):a;r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.lineTo(e+o,t-s),r.lineTo(e+o,t),r.arcTo(e+o,t+s,e,t+s,l),r.arcTo(e-o,t+s,e-o,t,l),r.lineTo(e-o,t-s),r.lineTo(e,t-s),r.closePath()};An.drawCutRectanglePath=function(r,e,t,n,i,a,o){var s=n/2,l=i/2,u=o==="auto"?lu():o;r.beginPath&&r.beginPath(),r.moveTo(e-s+u,t-l),r.lineTo(e+s-u,t-l),r.lineTo(e+s,t-l+u),r.lineTo(e+s,t+l-u),r.lineTo(e+s-u,t+l),r.lineTo(e-s+u,t+l),r.lineTo(e-s,t+l-u),r.lineTo(e-s,t-l+u),r.closePath()};An.drawBarrelPath=function(r,e,t,n,i){var a=n/2,o=i/2,s=e-a,l=e+a,u=t-o,c=t+o,d=Nl(n,i),f=d.widthOffset,h=d.heightOffset,v=d.ctrlPtOffsetPct*f;r.beginPath&&r.beginPath(),r.moveTo(s,u+h),r.lineTo(s,c-h),r.quadraticCurveTo(s+v,c,s+f,c),r.lineTo(l-f,c),r.quadraticCurveTo(l-v,c,l,c-h),r.lineTo(l,u+h),r.quadraticCurveTo(l-v,u,l-f,u),r.lineTo(s+f,u),r.quadraticCurveTo(s+v,u,s,u+h),r.closePath()};var hf=Math.sin(0),vf=Math.cos(0),Ql={},Zl={},ev=Math.PI/40;for(Ln=0*Math.PI;Ln<2*Math.PI;Ln+=ev)Ql[Ln]=Math.sin(Ln),Zl[Ln]=Math.cos(Ln);var Ln;An.drawEllipsePath=function(r,e,t,n,i){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,n/2,i/2,0,0,2*Math.PI);else for(var a,o,s=n/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=ev)a=e-s*Ql[u]*hf+s*Zl[u]*vf,o=t+l*Zl[u]*hf+l*Ql[u]*vf,u===0?r.moveTo(a,o):r.lineTo(a,o);r.closePath()};var Pa={};Pa.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};Pa.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),n=t.boundingBox(),i=this.findContainerClientCoords(),a=r.full?Math.ceil(n.w):i[2],o=r.full?Math.ceil(n.h):i[3],s=Ce(r.maxWidth)||Ce(r.maxHeight),l=this.getPixelRatio(),u=1;if(r.scale!==void 0)a*=r.scale,o*=r.scale,u=r.scale;else if(s){var c=1/0,d=1/0;Ce(r.maxWidth)&&(c=u*r.maxWidth/a),Ce(r.maxHeight)&&(d=u*r.maxHeight/o),u=Math.min(c,d),a*=u,o*=u}s||(a*=l,o*=l,u*=l);var f=document.createElement("canvas");f.width=a,f.height=o,f.style.width=a+"px",f.style.height=o+"px";var h=f.getContext("2d");if(a>0&&o>0){h.clearRect(0,0,a,o),h.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(r.full)h.translate(-n.x1*u,-n.y1*u),h.scale(u,u),this.drawElements(h,v),h.scale(1/u,1/u),h.translate(n.x1*u,n.y1*u);else{var m=e.pan(),p={x:m.x*u,y:m.y*u};u*=e.zoom(),h.translate(p.x,p.y),h.scale(u,u),this.drawElements(h,v),h.scale(1/u,1/u),h.translate(-p.x,-p.y)}r.bg&&(h.globalCompositeOperation="destination-over",h.fillStyle=r.bg,h.rect(0,0,a,o),h.fill())}return f};function hx(r,e){for(var t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function pf(r){var e=r.indexOf(",");return r.substr(e+1)}function tv(r,e,t){var n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Di(function(i,a){try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return hx(pf(n()),t);case"base64":return pf(n());case"base64uri":default:return n()}}Pa.png=function(r){return tv(r,this.bufferCanvasImage(r),"image/png")};Pa.jpg=function(r){return tv(r,this.bufferCanvasImage(r),"image/jpeg")};var rv={};rv.nodeShapeImpl=function(r,e,t,n,i,a,o,s){switch(r){case"ellipse":return this.drawEllipsePath(e,t,n,i,a);case"polygon":return this.drawPolygonPath(e,t,n,i,a,o);case"round-polygon":return this.drawRoundPolygonPath(e,t,n,i,a,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,n,i,a,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,n,i,a,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,n,i,a,s);case"barrel":return this.drawBarrelPath(e,t,n,i,a)}};var vx=nv,$e=nv.prototype;$e.CANVAS_LAYERS=3;$e.SELECT_BOX=0;$e.DRAG=1;$e.NODE=2;$e.WEBGL=3;$e.CANVAS_TYPES=["2d","2d","2d","webgl2"];$e.BUFFER_COUNT=3;$e.TEXTURE_BUFFER=0;$e.MOTIONBLUR_BUFFER_NODE=1;$e.MOTIONBLUR_BUFFER_DRAG=2;function nv(r){var e=this,t=e.cy.window(),n=t.document;r.webgl&&($e.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array($e.CANVAS_LAYERS),contexts:new Array($e.CANVAS_LAYERS),canvasNeedsRedraw:new Array($e.CANVAS_LAYERS),bufferCanvases:new Array($e.BUFFER_COUNT),bufferContexts:new Array($e.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,o.position="relative",o.zIndex="0",o.overflow="hidden";var s=r.cy.container();s.appendChild(e.data.canvasContainer),s.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};Bg()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<$e.CANVAS_LAYERS;u++){var c=e.data.canvases[u]=n.createElement("canvas"),d=$e.CANVAS_TYPES[u];e.data.contexts[u]=c.getContext(d),e.data.contexts[u]||st("Could not create canvas of type "+d),Object.keys(l).forEach(function(K){c.style[K]=l[K]}),c.style.position="absolute",c.setAttribute("data-id","layer"+u),c.style.zIndex=String($e.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[$e.NODE].setAttribute("data-id","layer"+$e.NODE+"-node"),e.data.canvases[$e.SELECT_BOX].setAttribute("data-id","layer"+$e.SELECT_BOX+"-selectbox"),e.data.canvases[$e.DRAG].setAttribute("data-id","layer"+$e.DRAG+"-drag"),e.data.canvases[$e.WEBGL]&&e.data.canvases[$e.WEBGL].setAttribute("data-id","layer"+$e.WEBGL+"-webgl");for(var u=0;u<$e.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var f=rr(),h=function(L){return{x:(L.x1+L.x2)/2,y:(L.y1+L.y2)/2}},v=function(L){return{x:-L.w/2,y:-L.h/2}},m=function(L){var j=L[0]._private,$=j.oldBackgroundTimestamp===j.backgroundTimestamp;return!$},p=function(L){return L[0]._private.nodeKey},g=function(L){return L[0]._private.labelStyleKey},y=function(L){return L[0]._private.sourceLabelStyleKey},C=function(L){return L[0]._private.targetLabelStyleKey},x=function(L,j,$,U,X){return e.drawElement(L,j,$,!1,!1,X)},M=function(L,j,$,U,X){return e.drawElementText(L,j,$,U,"main",X)},P=function(L,j,$,U,X){return e.drawElementText(L,j,$,U,"source",X)},D=function(L,j,$,U,X){return e.drawElementText(L,j,$,U,"target",X)},R=function(L){return L.boundingBox(),L[0]._private.bodyBounds},A=function(L){return L.boundingBox(),L[0]._private.labelBounds.main||f},F=function(L){return L.boundingBox(),L[0]._private.labelBounds.source||f},O=function(L){return L.boundingBox(),L[0]._private.labelBounds.target||f},T=function(L,j){return j},B=function(L){return h(R(L))},E=function(L,j,$){var U=L?L+"-":"";return{x:j.x+$.pstyle(U+"text-margin-x").pfValue,y:j.y+$.pstyle(U+"text-margin-y").pfValue}},w=function(L,j,$){var U=L[0]._private.rscratch;return{x:U[j],y:U[$]}},b=function(L){return E("",w(L,"labelX","labelY"),L)},_=function(L){return E("source",w(L,"sourceLabelX","sourceLabelY"),L)},k=function(L){return E("target",w(L,"targetLabelX","targetLabelY"),L)},S=function(L){return v(R(L))},N=function(L){return v(F(L))},V=function(L){return v(O(L))},z=function(L){var j=A(L),$=v(A(L));if(L.isNode()){switch(L.pstyle("text-halign").value){case"left":$.x=-j.w-(j.leftPad||0);break;case"right":$.x=-(j.rightPad||0);break}switch(L.pstyle("text-valign").value){case"top":$.y=-j.h-(j.topPad||0);break;case"bottom":$.y=-(j.botPad||0);break}}return $},H=e.data.eleTxrCache=new aa(e,{getKey:p,doesEleInvalidateKey:m,drawElement:x,getBoundingBox:R,getRotationPoint:B,getRotationOffset:S,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),Y=e.data.lblTxrCache=new aa(e,{getKey:g,drawElement:M,getBoundingBox:A,getRotationPoint:b,getRotationOffset:z,isVisible:T}),ee=e.data.slbTxrCache=new aa(e,{getKey:y,drawElement:P,getBoundingBox:F,getRotationPoint:_,getRotationOffset:N,isVisible:T}),J=e.data.tlbTxrCache=new aa(e,{getKey:C,drawElement:D,getBoundingBox:O,getRotationPoint:k,getRotationOffset:V,isVisible:T}),ne=e.data.lyrTxrCache=new Gh(e);e.onUpdateEleCalcs(function(L,j){H.invalidateElements(j),Y.invalidateElements(j),ee.invalidateElements(j),J.invalidateElements(j),ne.invalidateElements(j);for(var $=0;$<j.length;$++){var U=j[$]._private;U.oldBackgroundTimestamp=U.backgroundTimestamp}});var ie=function(L){for(var j=0;j<L.length;j++)ne.enqueueElementRefinement(L[j].ele)};H.onDequeue(ie),Y.onDequeue(ie),ee.onDequeue(ie),J.onDequeue(ie),r.webgl&&e.initWebgl(r,{getStyleKey:p,getLabelKey:g,drawElement:x,drawLabel:M,getElementBox:R,getLabelBox:A,getElementRotationPoint:B,getElementRotationOffset:S,getLabelRotationPoint:b,getLabelRotationOffset:z})}$e.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[$e.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[$e.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[$e.SELECT_BOX]=e;break;case"gc":t.data.gc=!0;break}};var px=typeof Path2D<"u";$e.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};$e.usePaths=function(){return px&&this.pathsEnabled};$e.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};$e.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};$e.makeOffscreenCanvas=function(r,e){var t;if((typeof OffscreenCanvas>"u"?"undefined":mt(OffscreenCanvas))!=="undefined")t=new OffscreenCanvas(r,e);else{var n=this.cy.window(),i=n.document;t=i.createElement("canvas"),t.width=r,t.height=e}return t};[qh,Kr,ln,xu,Yn,Li,qt,Qh,An,Pa,rv].forEach(function(r){Fe($e,r)});var gx=[{name:"null",impl:Ph},{name:"base",impl:zh},{name:"canvas",impl:vx}],mx=[{type:"layout",extensions:Jw},{type:"renderer",extensions:gx}],iv={},av={};function ov(r,e,t){var n=t,i=function(R){Ye("Can not register `"+e+"` for `"+r+"` since `"+R+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(wa.prototype[e])return i(e);wa.prototype[e]=t}else if(r==="collection"){if(Dt.prototype[e])return i(e);Dt.prototype[e]=t}else if(r==="layout"){for(var a=function(R){this.options=R,t.call(this,R),He(this._private)||(this._private={}),this._private.cy=R.cy,this._private.listeners=[],this.createEmitter()},o=a.prototype=Object.create(t.prototype),s=[],l=0;l<s.length;l++){var u=s[l];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var c=t.prototype.stop;o.stop=function(){var D=this.options;if(D&&D.animate){var R=this.animations;if(R)for(var A=0;A<R.length;A++)R[A].stop()}return c?c.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(R){return R._private.cy},f={addEventFields:function(R,A){A.layout=R,A.cy=d(R),A.target=R},bubble:function(){return!0},parent:function(R){return d(R)}};Fe(o,{createEmitter:function(){return this._private.emitter=new Is(f,this),this},emitter:function(){return this._private.emitter},on:function(R,A){return this.emitter().on(R,A),this},one:function(R,A){return this.emitter().one(R,A),this},once:function(R,A){return this.emitter().one(R,A),this},removeListener:function(R,A){return this.emitter().removeListener(R,A),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(R,A){return this.emitter().emit(R,A),this}}),Xe.eventAliasesOn(o),n=a}else if(r==="renderer"&&e!=="null"&&e!=="base"){var h=sv("renderer","base"),v=h.prototype,m=t,p=t.prototype,g=function(){h.apply(this,arguments),m.apply(this,arguments)},y=g.prototype;for(var C in v){var x=v[C],M=p[C]!=null;if(M)return i(C);y[C]=x}for(var P in p)y[P]=p[P];v.clientFunctions.forEach(function(D){y[D]=y[D]||function(){st("Renderer does not implement `renderer."+D+"()` on its prototype")}}),n=g}else if(r==="__proto__"||r==="constructor"||r==="prototype")return st(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return Ef({map:iv,keys:[r,e],value:n})}function sv(r,e){return Sf({map:iv,keys:[r,e]})}function yx(r,e,t,n,i){return Ef({map:av,keys:[r,e,t,n],value:i})}function Cx(r,e,t,n){return Sf({map:av,keys:[r,e,t,n]})}var Jl=function(){if(arguments.length===2)return sv.apply(null,arguments);if(arguments.length===3)return ov.apply(null,arguments);if(arguments.length===4)return Cx.apply(null,arguments);if(arguments.length===5)return yx.apply(null,arguments);st("Invalid extension access syntax")};wa.prototype.extension=Jl;mx.forEach(function(r){r.extensions.forEach(function(e){ov(r.type,e.name,e.impl)})});var lv=function r(){if(!(this instanceof r))return new r;this.length=0},Kn=lv.prototype;Kn.instanceString=function(){return"stylesheet"};Kn.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};Kn.css=function(r,e){var t=this.length-1;if(Be(r))this[t].properties.push({name:r,value:e});else if(He(r))for(var n=r,i=Object.keys(n),a=0;a<i.length;a++){var o=i[a],s=n[o];if(s!=null){var l=Ft.properties[o]||Ft.properties[Ss(o)];if(l!=null){var u=l.name,c=s;this[t].properties.push({name:u,value:c})}}}return this};Kn.style=Kn.css;Kn.generateStyle=function(r){var e=new Ft(r);return this.appendToStyle(e)};Kn.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],n=t.selector,i=t.properties;r.selector(n);for(var a=0;a<i.length;a++){var o=i[a];r.css(o.name,o.value)}}return r};var wx="3.31.0",Mr=function(e){if(e===void 0&&(e={}),He(e))return new wa(e);if(Be(e))return Jl.apply(Jl,arguments)};Mr.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Mr),r.apply(null,e),this};Mr.warnings=function(r){return Rf(r)};Mr.version=wx;Mr.stylesheet=Mr.Stylesheet=lv;var $v=qa(uv()),Gv=qa(cv());var Ia=Math.min,Bn=Math.max,Oa=Math.round;var Dr=r=>({x:r,y:r}),bx={left:"right",right:"left",bottom:"top",top:"bottom"},xx={start:"end",end:"start"};function ku(r,e,t){return Bn(r,Ia(e,t))}function Vi(r,e){return typeof r=="function"?r(e):r}function Rn(r){return r.split("-")[0]}function Gs(r){return r.split("-")[1]}function qs(r){return r==="x"?"y":"x"}function Mu(r){return r==="y"?"height":"width"}function Qn(r){return["top","bottom"].includes(Rn(r))?"y":"x"}function Du(r){return qs(Qn(r))}function dv(r,e,t){t===void 0&&(t=!1);let n=Gs(r),i=Du(r),a=Mu(i),o=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=Ra(o)),[o,Ra(o)]}function fv(r){let e=Ra(r);return[$s(r),e,$s(e)]}function $s(r){return r.replace(/start|end/g,e=>xx[e])}function _x(r,e,t){let n=["left","right"],i=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return t?e?i:n:e?n:i;case"left":case"right":return e?a:o;default:return[]}}function hv(r,e,t,n){let i=Gs(r),a=_x(Rn(r),t==="start",n);return i&&(a=a.map(o=>o+"-"+i),e&&(a=a.concat(a.map($s)))),a}function Ra(r){return r.replace(/left|right|bottom|top/g,e=>bx[e])}function Ex(r){return vt({top:0,right:0,bottom:0,left:0},r)}function vv(r){return typeof r!="number"?Ex(r):{top:r,right:r,bottom:r,left:r}}function Zn(r){let{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function pv(r,e,t){let{reference:n,floating:i}=r,a=Qn(e),o=Du(e),s=Mu(o),l=Rn(e),u=a==="y",c=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,f=n[s]/2-i[s]/2,h;switch(l){case"top":h={x:c,y:n.y-i.height};break;case"bottom":h={x:c,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-i.width,y:d};break;default:h={x:n.x,y:n.y}}switch(Gs(e)){case"start":h[o]-=f*(t&&u?-1:1);break;case"end":h[o]+=f*(t&&u?-1:1);break}return h}var gv=(r,e,t)=>ot(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:o}=t,s=a.filter(Boolean),l=yield o.isRTL==null?void 0:o.isRTL(e),u=yield o.getElementRects({reference:r,floating:e,strategy:i}),{x:c,y:d}=pv(u,n,l),f=n,h={},v=0;for(let m=0;m<s.length;m++){let{name:p,fn:g}=s[m],{x:y,y:C,data:x,reset:M}=yield g({x:c,y:d,initialPlacement:n,placement:f,strategy:i,middlewareData:h,rects:u,platform:o,elements:{reference:r,floating:e}});c=y??c,d=C??d,h=Or(vt({},h),{[p]:vt(vt({},h[p]),x)}),M&&v<=50&&(v++,typeof M=="object"&&(M.placement&&(f=M.placement),M.rects&&(u=M.rects===!0?yield o.getElementRects({reference:r,floating:e,strategy:i}):M.rects),{x:c,y:d}=pv(u,f,l)),m=-1)}return{x:c,y:d,placement:f,strategy:i,middlewareData:h}});function Pu(r,e){return ot(this,null,function*(){var t;e===void 0&&(e={});let{x:n,y:i,platform:a,rects:o,elements:s,strategy:l}=r,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Vi(e,r),v=vv(h),p=s[f?d==="floating"?"reference":"floating":d],g=Zn(yield a.getClippingRect({element:(t=yield a.isElement==null?void 0:a.isElement(p))==null||t?p:p.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,C=yield a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating),x=(yield a.isElement==null?void 0:a.isElement(C))?(yield a.getScale==null?void 0:a.getScale(C))||{x:1,y:1}:{x:1,y:1},M=Zn(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:C,strategy:l}):y);return{top:(g.top-M.top+v.top)/x.y,bottom:(M.bottom-g.bottom+v.bottom)/x.y,left:(g.left-M.left+v.left)/x.x,right:(M.right-g.right+v.right)/x.x}})}var mv=function(r){return r===void 0&&(r={}),{name:"flip",options:r,fn(t){return ot(this,null,function*(){var n,i;let{placement:a,middlewareData:o,rects:s,initialPlacement:l,platform:u,elements:c}=t,w=Vi(r,t),{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0}=w,g=ol(w,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((n=o.arrow)!=null&&n.alignmentOffset)return{};let y=Rn(a),C=Qn(l),x=Rn(l)===l,M=yield u.isRTL==null?void 0:u.isRTL(c.floating),P=h||(x||!p?[Ra(l)]:fv(l)),D=m!=="none";!h&&D&&P.push(...hv(l,p,m,M));let R=[l,...P],A=yield Pu(t,g),F=[],O=((i=o.flip)==null?void 0:i.overflows)||[];if(d&&F.push(A[y]),f){let b=dv(a,s,M);F.push(A[b[0]],A[b[1]])}if(O=[...O,{placement:a,overflows:F}],!F.every(b=>b<=0)){var T,B;let b=(((T=o.flip)==null?void 0:T.index)||0)+1,_=R[b];if(_)return{data:{index:b,overflows:O},reset:{placement:_}};let k=(B=O.filter(S=>S.overflows[0]<=0).sort((S,N)=>S.overflows[1]-N.overflows[1])[0])==null?void 0:B.placement;if(!k)switch(v){case"bestFit":{var E;let S=(E=O.filter(N=>{if(D){let V=Qn(N.placement);return V===C||V==="y"}return!0}).map(N=>[N.placement,N.overflows.filter(V=>V>0).reduce((V,z)=>V+z,0)]).sort((N,V)=>N[1]-V[1])[0])==null?void 0:E[0];S&&(k=S);break}case"initialPlacement":k=l;break}if(a!==k)return{reset:{placement:k}}}return{}})}}};var yv=function(r){return r===void 0&&(r={}),{name:"shift",options:r,fn(t){return ot(this,null,function*(){let{x:n,y:i,placement:a}=t,g=Vi(r,t),{mainAxis:o=!0,crossAxis:s=!1,limiter:l={fn:y=>{let{x:C,y:x}=y;return{x:C,y:x}}}}=g,u=ol(g,["mainAxis","crossAxis","limiter"]),c={x:n,y:i},d=yield Pu(t,u),f=Qn(Rn(a)),h=qs(f),v=c[h],m=c[f];if(o){let y=h==="y"?"top":"left",C=h==="y"?"bottom":"right",x=v+d[y],M=v-d[C];v=ku(x,v,M)}if(s){let y=f==="y"?"top":"left",C=f==="y"?"bottom":"right",x=m+d[y],M=m-d[C];m=ku(x,m,M)}let p=l.fn(Or(vt({},t),{[h]:v,[f]:m}));return Or(vt({},p),{data:{x:p.x-n,y:p.y-i,enabled:{[h]:o,[f]:s}}})})}}},Cv=function(r){return r===void 0&&(r={}),{options:r,fn(e){let{x:t,y:n,placement:i,rects:a,middlewareData:o}=e,{offset:s=0,mainAxis:l=!0,crossAxis:u=!0}=Vi(r,e),c={x:t,y:n},d=Qn(i),f=qs(d),h=c[f],v=c[d],m=Vi(s,e),p=typeof m=="number"?{mainAxis:m,crossAxis:0}:vt({mainAxis:0,crossAxis:0},m);if(l){let C=f==="y"?"height":"width",x=a.reference[f]-a.floating[C]+p.mainAxis,M=a.reference[f]+a.reference[C]-p.mainAxis;h<x?h=x:h>M&&(h=M)}if(u){var g,y;let C=f==="y"?"width":"height",x=["top","left"].includes(Rn(i)),M=a.reference[d]-a.floating[C]+(x&&((g=o.offset)==null?void 0:g[d])||0)+(x?0:p.crossAxis),P=a.reference[d]+a.reference[C]+(x?0:((y=o.offset)==null?void 0:y[d])||0)-(x?p.crossAxis:0);v<M?v=M:v>P&&(v=P)}return{[f]:h,[d]:v}}}};function Ws(){return typeof window<"u"}function Jn(r){return bv(r)?(r.nodeName||"").toLowerCase():"#document"}function nr(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Xr(r){var e;return(e=(bv(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function bv(r){return Ws()?r instanceof Node||r instanceof nr(r).Node:!1}function mr(r){return Ws()?r instanceof Element||r instanceof nr(r).Element:!1}function Pr(r){return Ws()?r instanceof HTMLElement||r instanceof nr(r).HTMLElement:!1}function wv(r){return!Ws()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof nr(r).ShadowRoot}function Ni(r){let{overflow:e,overflowX:t,overflowY:n,display:i}=yr(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(i)}function xv(r){return["table","td","th"].includes(Jn(r))}function Fa(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function Us(r){let e=Ks(),t=mr(r)?yr(r):r;return["transform","translate","scale","rotate","perspective"].some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function _v(r){let e=un(r);for(;Pr(e)&&!ei(e);){if(Us(e))return e;if(Fa(e))return null;e=un(e)}return null}function Ks(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ei(r){return["html","body","#document"].includes(Jn(r))}function yr(r){return nr(r).getComputedStyle(r)}function La(r){return mr(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function un(r){if(Jn(r)==="html")return r;let e=r.assignedSlot||r.parentNode||wv(r)&&r.host||Xr(r);return wv(e)?e.host:e}function Ev(r){let e=un(r);return ei(e)?r.ownerDocument?r.ownerDocument.body:r.body:Pr(e)&&Ni(e)?e:Ev(e)}function Hs(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);let i=Ev(r),a=i===((n=r.ownerDocument)==null?void 0:n.body),o=nr(i);if(a){let s=Xs(o);return e.concat(o,o.visualViewport||[],Ni(i)?i:[],s&&t?Hs(s):[])}return e.concat(i,Hs(i,[],t))}function Xs(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function kv(r){let e=yr(r),t=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=Pr(r),a=i?r.offsetWidth:t,o=i?r.offsetHeight:n,s=Oa(t)!==a||Oa(n)!==o;return s&&(t=a,n=o),{width:t,height:n,$:s}}function Mv(r){return mr(r)?r:r.contextElement}function zi(r){let e=Mv(r);if(!Pr(e))return Dr(1);let t=e.getBoundingClientRect(),{width:n,height:i,$:a}=kv(e),o=(a?Oa(t.width):t.width)/n,s=(a?Oa(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!s||!Number.isFinite(s))&&(s=1),{x:o,y:s}}var Sx=Dr(0);function Dv(r){let e=nr(r);return!Ks()||!e.visualViewport?Sx:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Tx(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==nr(r)?!1:e}function Va(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);let i=r.getBoundingClientRect(),a=Mv(r),o=Dr(1);e&&(n?mr(n)&&(o=zi(n)):o=zi(r));let s=Tx(a,t,n)?Dv(a):Dr(0),l=(i.left+s.x)/o.x,u=(i.top+s.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(a){let f=nr(a),h=n&&mr(n)?nr(n):n,v=f,m=Xs(v);for(;m&&n&&h!==v;){let p=zi(m),g=m.getBoundingClientRect(),y=yr(m),C=g.left+(m.clientLeft+parseFloat(y.paddingLeft))*p.x,x=g.top+(m.clientTop+parseFloat(y.paddingTop))*p.y;l*=p.x,u*=p.y,c*=p.x,d*=p.y,l+=C,u+=x,v=nr(m),m=Xs(v)}}return Zn({width:c,height:d,x:l,y:u})}function Bu(r,e){let t=La(r).scrollLeft;return e?e.left+t:Va(Xr(r)).left+t}function Pv(r,e,t){t===void 0&&(t=!1);let n=r.getBoundingClientRect(),i=n.left+e.scrollLeft-(t?0:Bu(r,n)),a=n.top+e.scrollTop;return{x:i,y:a}}function kx(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r,a=i==="fixed",o=Xr(n),s=e?Fa(e.floating):!1;if(n===o||s&&a)return t;let l={scrollLeft:0,scrollTop:0},u=Dr(1),c=Dr(0),d=Pr(n);if((d||!d&&!a)&&((Jn(n)!=="body"||Ni(o))&&(l=La(n)),Pr(n))){let h=Va(n);u=zi(n),c.x=h.x+n.clientLeft,c.y=h.y+n.clientTop}let f=o&&!d&&!a?Pv(o,l,!0):Dr(0);return{width:t.width*u.x,height:t.height*u.y,x:t.x*u.x-l.scrollLeft*u.x+c.x+f.x,y:t.y*u.y-l.scrollTop*u.y+c.y+f.y}}function Mx(r){return Array.from(r.getClientRects())}function Dx(r){let e=Xr(r),t=La(r),n=r.ownerDocument.body,i=Bn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=Bn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),o=-t.scrollLeft+Bu(r),s=-t.scrollTop;return yr(n).direction==="rtl"&&(o+=Bn(e.clientWidth,n.clientWidth)-i),{width:i,height:a,x:o,y:s}}function Px(r,e){let t=nr(r),n=Xr(r),i=t.visualViewport,a=n.clientWidth,o=n.clientHeight,s=0,l=0;if(i){a=i.width,o=i.height;let u=Ks();(!u||u&&e==="fixed")&&(s=i.offsetLeft,l=i.offsetTop)}return{width:a,height:o,x:s,y:l}}function Ax(r,e){let t=Va(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,a=Pr(r)?zi(r):Dr(1),o=r.clientWidth*a.x,s=r.clientHeight*a.y,l=i*a.x,u=n*a.y;return{width:o,height:s,x:l,y:u}}function Sv(r,e,t){let n;if(e==="viewport")n=Px(r,t);else if(e==="document")n=Dx(Xr(r));else if(mr(e))n=Ax(e,t);else{let i=Dv(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Zn(n)}function Av(r,e){let t=un(r);return t===e||!mr(t)||ei(t)?!1:yr(t).position==="fixed"||Av(t,e)}function Bx(r,e){let t=e.get(r);if(t)return t;let n=Hs(r,[],!1).filter(s=>mr(s)&&Jn(s)!=="body"),i=null,a=yr(r).position==="fixed",o=a?un(r):r;for(;mr(o)&&!ei(o);){let s=yr(o),l=Us(o);!l&&s.position==="fixed"&&(i=null),(a?!l&&!i:!l&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Ni(o)&&!l&&Av(r,o))?n=n.filter(c=>c!==o):i=s,o=un(o)}return e.set(r,n),n}function Rx(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r,o=[...t==="clippingAncestors"?Fa(e)?[]:Bx(e,this._c):[].concat(t),n],s=o[0],l=o.reduce((u,c)=>{let d=Sv(e,c,i);return u.top=Bn(d.top,u.top),u.right=Ia(d.right,u.right),u.bottom=Ia(d.bottom,u.bottom),u.left=Bn(d.left,u.left),u},Sv(e,s,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Ix(r){let{width:e,height:t}=kv(r);return{width:e,height:t}}function Ox(r,e,t){let n=Pr(e),i=Xr(e),a=t==="fixed",o=Va(r,!0,a,e),s={scrollLeft:0,scrollTop:0},l=Dr(0);if(n||!n&&!a)if((Jn(e)!=="body"||Ni(i))&&(s=La(e)),n){let f=Va(e,!0,a,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=Bu(i));let u=i&&!n&&!a?Pv(i,s):Dr(0),c=o.left+s.scrollLeft-l.x-u.x,d=o.top+s.scrollTop-l.y-u.y;return{x:c,y:d,width:o.width,height:o.height}}function Au(r){return yr(r).position==="static"}function Tv(r,e){if(!Pr(r)||yr(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Xr(r)===t&&(t=t.ownerDocument.body),t}function Bv(r,e){let t=nr(r);if(Fa(r))return t;if(!Pr(r)){let i=un(r);for(;i&&!ei(i);){if(mr(i)&&!Au(i))return i;i=un(i)}return t}let n=Tv(r,e);for(;n&&xv(n)&&Au(n);)n=Tv(n,e);return n&&ei(n)&&Au(n)&&!Us(n)?t:n||_v(r)||t}var Fx=function(r){return ot(this,null,function*(){let e=this.getOffsetParent||Bv,t=this.getDimensions,n=yield t(r.floating);return{reference:Ox(r.reference,yield e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}})};function Lx(r){return yr(r).direction==="rtl"}var Vx={convertOffsetParentRelativeRectToViewportRelativeRect:kx,getDocumentElement:Xr,getClippingRect:Rx,getOffsetParent:Bv,getElementRects:Fx,getClientRects:Mx,getDimensions:Ix,getScale:zi,isElement:mr,isRTL:Lx};var Rv=yv,Iv=mv;var Ov=Cv,Fv=(r,e,t)=>{let n=new Map,i=vt({platform:Vx},t),a=Or(vt({},i.platform),{_c:n});return gv(r,e,Or(vt({},i),{platform:a}))};var zv={position:"absolute",left:"0",top:"0",userSelect:"none",outlineStyle:"none",width:"100%",height:"100%"};function Ys(r){r.stopPropagation()}function ja(r){r.addEventListener("click",Ys),r.addEventListener("mousedown",Ys),r.addEventListener("mouseup",Ys),r.addEventListener("mousemove",Ys)}var Na=class{constructor(e){this.adapter=e,this.updateOnRenderEnabled=!1,this.updateOnRenderOnceEnabled=!1,this.updateOnRenderOnce=()=>{this.updateOnRenderOnceEnabled||(this.updateOnRenderOnceEnabled=!0,this.cy.one("render",()=>{this.updateOnRenderOnceEnabled=!1,this.update()}))}}inVisibleBounds(e){return this.adapter.inVisibleBounds(e)}supportsRender(){return!1}renderInto(e){}get updateOnRender(){return this.updateOnRenderEnabled}set updateOnRender(e){this.updateOnRenderEnabled!==e&&(this.updateOnRenderEnabled=e,e?this.cy.on("render",this.update):this.cy.off("render",this.update))}get cy(){return this.adapter.cy}moveUp(){this.adapter.move(this,-1)}moveDown(){this.adapter.move(this,1)}moveBack(){this.adapter.move(this,Number.NEGATIVE_INFINITY)}moveFront(){this.adapter.move(this,Number.POSITIVE_INFINITY)}insertBefore(e,t){return this.adapter.insert("before",this,e,t)}insertAfter(e,t){return this.adapter.insert("after",this,e,t)}},ji=class extends Na{constructor(e,t){super(e),this.callbacks=[],this.update=()=>{for(let n of this.callbacks)n(this.node)},this.root=t,Object.assign(this.root.style,zv)}get visible(){return this.root.style.display!=="none"}set visible(e){this.visible!==e&&(this.root.style.display=e?"":"none")}show(){this.visible=!0}hide(){this.visible=!1}callback(e){return this.callbacks.push(e),this.update(),this}resize(){}remove(){this.root.remove()}},za="http://www.w3.org/2000/svg",Ru=class extends ji{constructor(e,t,n={}){super(e,t.createElementNS(za,"svg")),this.type="svg",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElementNS(za,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&ja(this.node)}setViewport(e,t,n){this.node.setAttribute("transform",`translate(${e},${t})scale(${n})`),this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},Iu=class extends ji{constructor(e,t,n={}){super(e,t.createElementNS(za,"svg")),this.type="svg-static",this.root.__cy_layer=this,this.node=t.createElementNS(za,"g"),this.node.__cy_layer=this,this.root.appendChild(this.node),n.stopClicks&&ja(this.node)}setViewport(){}},Zs=class extends Na{constructor(e,t,n={}){var i,a;super(e),this.callbacks=[],this.transform={tx:0,ty:0,zoom:1},this.update=()=>this.draw(),this.node=t.createElement("canvas"),Object.assign(this.node.style,zv),n.stopClicks&&ja(this.node),this.pixelRatio=(a=(i=n.pixelRatio)!==null&&i!==void 0?i:(window??{}).devicePixelRatio)!==null&&a!==void 0?a:1,this.ctx=this.node.getContext("2d",n),this.ctx.resetTransform()}get visible(){return this.node.style.display!=="none"}set visible(e){this.node.style.display=e?"":"none"}show(){this.visible=!0}hide(){this.visible=!1}get root(){return this.node}callback(e){return this.callbacks.push(e),this.update(),this}clear(){let e=this.ctx,t=e.getTransform();e.resetTransform(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.setTransform(t)}draw(){this.clear(),this.drawImpl(this.ctx)}drawImpl(e,t=1){e.save(),e.resetTransform(),e.scale(this.pixelRatio,this.pixelRatio),e.translate(this.transform.tx*t,this.transform.ty*t),e.scale(this.transform.zoom*t,this.transform.zoom*t);for(let n of this.callbacks)n(e,{});e.restore()}supportsRender(){return!0}renderInto(e){for(let t of this.callbacks)t(e,{forExport:!0})}resize(e,t){this.node.width=e*this.pixelRatio,this.node.height=t*this.pixelRatio,this.update()}setViewport(e,t,n){}remove(){this.node.remove()}},Js=class extends Zs{constructor(e,t,n={}){super(e,t,n),this.type="canvas",this.node.__cy_layer=this}setViewport(e,t,n){this.transform.tx=e,this.transform.ty=t,this.transform.zoom=n,this.update()}},Ou=class extends Zs{constructor(e,t,n={}){super(e,t,n),this.type="canvas-static",this.node.__cy_layer=this}},Fu=class extends ji{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html",this.updateOnTransform=!1,this.root.__cy_layer=this,this.node=t.createElement("div"),this.node.__cy_layer=this,this.node.style.position="absolute",this.node.style.left="0px",this.node.style.top="0px",this.root.appendChild(this.node),n.stopClicks&&ja(this.node)}setViewport(e,t,n){this.node.style.transform=`translate(${e}px,${t}px)scale(${n})`,this.updateOnTransform&&this.update()}supportsRender(){return this.node.childElementCount===0}},Lu=class extends ji{constructor(e,t,n={}){super(e,t.createElement("div")),this.type="html-static",this.node.__cy_layer=this,n.stopClicks&&ja(this.node)}get node(){return this.root}setViewport(){}},$i=class extends Na{constructor(e,t){super(e),this.update=()=>{},this.node=t}get root(){return this.node}resize(){}setViewport(){}remove(){}supportsRender(){return!0}},Vu=class extends $i{constructor(e,t){super(e,t),this.type="node",this.node.__cy_layer=this}},Nu=class extends $i{constructor(e,t){super(e,t),this.type="drag",this.node.__cy_layer=this}},zu=class extends $i{constructor(e,t){super(e,t),this.type="select-box",this.node.__cy_layer=this}};function Lv(r,e,t){let n=Array.from(r.children);if(!t.uniqueElements){e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(t.isVisible(s))if(n.length>0)t.update(n.shift(),o,s);else{let l=t.enter(o,s);r.appendChild(l),t.update(l,o,s)}});for(let o of n)o.remove();return}let i=new Map(n.map(o=>[o.dataset.id,o])),a=-1;e.forEach(o=>{if(o.removed())return;let s=t.bb(o);if(!t.isVisible(s))return;a++;let l=o.id(),u=n[a],c=i.get(l),d;if(c){if(t.update(c,o,s),i.delete(l),u===c)return;d=c}else d=t.enter(o,s),d.dataset.id=l,t.update(d,o,s);a===0?r.insertAdjacentElement("afterbegin",d):n[a-1].insertAdjacentElement("afterend",d),n.splice(a,0,d)}),i.forEach(o=>o.remove())}function Qs(r,e){return r.callback(e),{remove:()=>{r.callbacks.splice(r.callbacks.indexOf(e),1)}}}function jv(r){return{selector:":visible",updateOn:r!=null&&r.queryEachTime?"render":"position",queryEachTime:!1,checkBounds:!0}}function Nx(r,e,t){let n=Object.assign({checkBoundsPointCount:5,initCollection:()=>{}},jv(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=c=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(c.off(n.updateOn,void 0,r.updateOnRenderOnce),c.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),c.targets().off(n.updateOn,void 0,r.updateOnRenderOnce));let d=r.cy.edges(n.selector);return n.initCollection(d),n.updateOn!=="none"&&n.updateOn!=="render"&&(d.on(n.updateOn,r.updateOnRenderOnce),d.sources().on(n.updateOn,r.updateOnRenderOnce),d.targets().on(n.updateOn,r.updateOnRenderOnce)),r.updateOnRenderOnce(),d};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let u=Qs(r,(c,d)=>{n.queryEachTime&&(i=s(i)),i.forEach(f=>{if(f.removed())return;let h=f._private.rscratch,v=h&&h.startX!=null&&h.startY!=null?{x:h.startX,y:h.startY}:f.sourceEndpoint(),m=h&&h.endX!=null&&h.endY!=null?{x:h.endX,y:h.endY}:f.targetEndpoint();if(!d.forExport&&n.checkBounds&&n.checkBoundsPointCount>0&&!zx(r,v,m,n.checkBoundsPointCount))return;if(h&&h.pathCache){e(c,f,h.pathCache,v,m);return}let p=new Path2D;p.moveTo(v.x,v.y),p.lineTo(m.x,m.y),e(c,f,p,v,m)})});return{layer:r,edges:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&(i.off(n.updateOn,void 0,r.updateOnRenderOnce),i.sources().off(n.updateOn,void 0,r.updateOnRenderOnce),i.targets().off(n.updateOn,void 0,r.updateOnRenderOnce)),r.cy.off("add remove",n.selector,o),u.remove()}}}function zx(r,e,t,n){let i=o=>({x:e.x*o+t.x*(1-o),y:e.y*o+t.y*(1-o)});if(n===1)return r.inVisibleBounds(i(.5));let a=1/n;for(let o=0;o<=n;o++)if(r.inVisibleBounds(i(o*a)))return!0;return!1}function jx(r,e,t={}){let n=Object.assign({transform:"",position:"top-left",boundingBox:{includeLabels:!1,includeOverlays:!1},uniqueElements:!1,initCollection:()=>{}},jv(t),t),i=r.cy.collection(),a=!1,o=()=>{a||(a=!0,r.cy.one("render",()=>{a=!1,i=s(i),r.update()}))},s=h=>{n.updateOn!=="none"&&n.updateOn!=="render"&&h.off(n.updateOn,void 0,r.updateOnRenderOnce);let v=r.cy.nodes(n.selector);return n.initCollection(v),n.updateOn!=="none"&&n.updateOn!=="render"&&v.on(n.updateOn,r.updateOnRenderOnce),r.updateOnRenderOnce(),v};n.updateOn==="render"&&(r.updateOnRender=!0),n.queryEachTime||(i=s(i),r.cy.on("add remove",n.selector,o));let l=h=>({layer:r,nodes:i,remove:()=>{n.updateOn!=="none"&&n.updateOn!=="render"&&i.off(n.updateOn,void 0,r.updateOnRenderOnce),r.cy.off("add remove",n.selector,o),h.remove()}});if(r.type==="canvas"){let h=n;return l(Qs(r,(m,p)=>{let g=m.getTransform();n.queryEachTime&&(i=s(i)),i.forEach(y=>{if(y.removed())return;let C=y.boundingBox(n.boundingBox);if(!(!p.forExport&&h.checkBounds&&!r.inVisibleBounds(C))){if(h.position==="top-left")m.translate(C.x1,C.y1);else if(h.position==="center"){let x=y.position();m.translate(x.x,x.y)}e(m,y,C),h.position!=="none"&&m.setTransform(g)}})}))}let u=n,c={bb:h=>h.boundingBox(u.boundingBox),isVisible:u.checkBounds?h=>r.inVisibleBounds(h):()=>!0,uniqueElements:u.uniqueElements===!0};if(u.checkBounds&&(r.updateOnTransform=!0),r.type==="html"){let h=Or(vt({},c),{enter:(m,p)=>{let g=r.node.ownerDocument.createElement("div");return g.style.position="absolute",u.init&&u.init(g,m,p),g},update:(m,p,g)=>{if(u.position==="top-left")m.style.transform=`${u.transform}translate3d(${g.x1}px,${g.y1}px,0)`;else if(u.position==="center"){let y=p.position();m.style.transform=`${u.transform}translate3d(${y.x}px,${y.y}px,0)`}e(m,p,g)}});return l(Qs(r,m=>{n.queryEachTime&&(i=s(i)),Lv(m,i,h)}))}let d=Or(vt({},c),{enter:(h,v)=>{let m=r.node.ownerDocument.createElementNS(za,"g");return u.init&&u.init(m,h,v),m},update:(h,v,m)=>{if(u.position==="top-left")h.setAttribute("transform",`${u.transform}translate3d(${m.x1},${m.y1},0)`);else if(u.position==="center"){let p=v.position();h.setAttribute("transform",`${u.transform}translate3d(${p.x},${p.y},0)`)}e(h,v,m)}});return l(Qs(r,h=>{n.queryEachTime&&(i=s(i)),Lv(h,i,d)}))}function $x(r,e){let t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function Vv(r){let e=r.indexOf(",");return r.substring(e+1)}function Nv(r,e,t){let n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new Promise((i,a)=>{try{e.toBlob(function(o){o!=null?i(o):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){a(o)}});case"blob":return $x(Vv(n()),t);case"base64":return Vv(n());case"base64uri":default:return n()}}function Gx(r){return r.x!=null}var el=class extends Error{},ju=class{constructor(e){this.bak={},this.resize=()=>{let o=this.cy.width(),s=this.cy.height();this.viewport.width=o,this.viewport.height=s;for(let l of this.layers)l.resize(o,s)},this.destroy=()=>{for(let o of this.layers)o.remove();this.cy.off("destroy",this.destroy),this.cy.off("viewport",this.zoomed),this.cy.off("resize",this.resize),this.cy.scratch("_layers",void 0),this.cy.png=this.bak.png,this.cy.jpg=this.bak.jpg,this.cy.jpeg=this.bak.jpeg,this.bak={}},this.zoomed=()=>{let o=this.cy.pan(),s=this.cy.zoom();this.viewport.tx=o.x,this.viewport.ty=o.y,this.viewport.zoom=s;for(let l of this.layers)l.setViewport(o.x,o.y,s)},this.renderPerEdge=Nx,this.renderPerNode=jx,this.cy=e,this.adapter={cy:this.cy,insert:(o,s,l)=>this.insert(o,s,l),move:(o,s)=>this.move(o,s),inVisibleBounds:o=>{let s=this.viewport,l=c=>{let d=c*s.zoom+s.tx;return d>=0&&d<=s.width},u=c=>{let d=c*s.zoom+s.ty;return d>=0&&d<=s.height};return Gx(o)?l(o.x)&&u(o.y):l(o.x1)&&u(o.y1)||l(o.x2)&&u(o.y1)||l(o.x2)&&u(o.y2)||l(o.x1)&&u(o.y2)||l((o.x1+o.x2)/2)&&u((o.y1+o.y2)/2)}};let t=e.container(),n=new Vu(this.adapter,t.querySelector('[data-id="layer2-node"]'));this.nodeLayer=n;let i=new Nu(this.adapter,t.querySelector('[data-id="layer1-drag"]'));this.dragLayer=i;let a=new zu(this.adapter,t.querySelector('[data-id="layer0-selectbox"]'));this.selectBoxLayer=a,n.root.style.zIndex="",i.root.style.zIndex="",a.root.style.zIndex="",n.root.insertAdjacentElement("afterend",i.root),i.root.insertAdjacentElement("afterend",a.root),e.on("viewport",this.zoomed),e.on("resize",this.resize),e.on("destroy",this.destroy),this.bak={png:e.png,jpg:e.jpg,jpeg:e.jpeg},e.png=this.png.bind(this),e.jpg=this.jpg.bind(this),e.jpeg=this.jpeg.bind(this),this.viewport={width:this.cy.width(),height:this.cy.height(),tx:this.cy.pan().x,ty:this.cy.pan().y,zoom:this.cy.zoom()}}move(e,t){let n=this.layers,i=n.indexOf(e),a=Math.max(Math.min(i+t,n.length,0));a!==i&&(i>=n.length-1?this.root.appendChild(e.root):this.root.insertBefore(e.root,n[a].root))}get document(){return this.cy.container().ownerDocument}get root(){return this.nodeLayer.node.parentElement}get layers(){return Array.from(this.root.children).map(e=>e.__cy_layer).filter(e=>e!=null)}getLayers(){return this.layers}init(e){return e.resize(this.viewport.width,this.viewport.height),e.setViewport(this.viewport.tx,this.viewport.ty,this.viewport.zoom),e}update(){this.zoomed();for(let e of this.layers)e instanceof Js&&e.draw()}createLayer(e,t){switch(e){case"svg":return this.init(new Ru(this.adapter,this.document,t));case"html":return this.init(new Fu(this.adapter,this.document,t));case"canvas":return this.init(new Js(this.adapter,this.document,t));case"html-static":return this.init(new Lu(this.adapter,this.document,t));case"svg-static":return this.init(new Iu(this.adapter,this.document,t));case"canvas-static":return this.init(new Ou(this.adapter,this.document,t))}}append(e,t){let n=this.createLayer(e,t);return this.root.appendChild(n.root),n}insert(e,t,n,i){let a=this.createLayer(n,i);return t.root.insertAdjacentElement(e==="before"?"beforebegin":"afterend",a.root),a}getLast(){var e;let t=this.layers;return(e=t[t.length-1])!==null&&e!==void 0?e:null}getFirst(){var e;return(e=this.layers[0])!==null&&e!==void 0?e:null}hasCustomLayer(){return this.layers.some(e=>!(e instanceof $i))}toCanvas(e){let t=this.layers;if(t.some(d=>!d.supportsRender)&&!e.ignoreUnsupportedLayers)throw new el("some layer doesn't support exporting, use {ignoreUnsupportedLayers: true} option to ignore");let n=t.indexOf(this.nodeLayer),i=t.indexOf(this.dragLayer),a=t.indexOf(this.selectBoxLayer);if((n!==i-1||i!==a-1)&&!e.ignoreUnsupportedLayerOrder)throw new el("cytoscape layers are not in order, use {ignoreUnsupportedLayerOrder: true} option to ignore");let o=t.slice(0,n).reverse().filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),s=t.slice(n+1).filter(d=>d.supportsRender()&&d!==this.dragLayer&&d!==this.selectBoxLayer),l=this.cy.renderer(),u=l.drawElements;l.drawElements=function(d,f){for(let h of o)h.renderInto(d);u.call(this,d,f);for(let h of s)h.renderInto(d)};let c=l.bufferCanvasImage(e);return l.drawElements=u,c}png(e){return this.hasCustomLayer()?Nv(e??{},this.toCanvas(e??{}),"image/png"):this.bak.png.call(this.cy,e)}jpg(e){if(!this.hasCustomLayer())return this.bak.jpg.call(this.cy,e);let t=vt({bg:"#fff"},e??{});return Nv(t,this.toCanvas(t),"image/png")}jpeg(e){return this.hasCustomLayer()?this.jpg(e):this.bak.jpeg.call(this.cy,e)}};function qx(r=this){if(!r.container())throw new Error("layers plugin does not work in headless environments");let e=r.scratch("_layers");if(e)return e;let t=new ju(r);return r.scratch("_layers",t),t}function $u(r){r("core","layers",qx)}typeof window.cytoscape<"u"&&$u(window.cytoscape);var Hx=["cy"];function Wx(r,e,t){let n=vt({middleware:[Iv(),Rv({limiter:Ov()})]},t);console.log(e),console.log(t);function i(){let a=r.getBoundingClientRect();Fv(r,e,n).then(({x:o,y:s})=>{console.log(o,s);let l=Object.assign(e.style,{left:`${a.left}px`,top:`${s}px`,position:"absolute",transform:"translate(-50%, -50%)","background-color":"#333",color:"#fff",padding:"5px 10px","border-radius":"4px","font-size":"12px","box-shadow":"0 2px 10px rgba(0, 0, 0, 0.2)","pointer-events":"none"});return console.log(l),l})}return i(),{update:i}}var qv=(()=>{class r{constructor(t){this.collateService=t,this.showCytoscapePlot=!1,this.projects=[],this.searchResultsMap={},this.renameCondition={},this.currentPopperRef=null,this.currentTooltip=null}ngAfterViewInit(){Mr.use($v.default),Mr.use((0,Gv.default)(Wx)),Mr.use($u),this.initCytoscape(),this.collateService.collateRedrawSubject.subscribe(()=>{this.updateCytoscape()})}updateCytoscape(){this.cy.destroy(),this.initCytoscape()}renderBar(t,n,i,a,o){t.fillRect(0,i,a*n,o),t.strokeRect(0,i,a,o)}initCytoscape(){if(this.cyElement){let t=this.buildGraphElements();this.cy=Mr({container:this.cyElement.nativeElement,elements:t,style:[{selector:"node",style:{label:"data(label)","background-color":"#666",width:"data(size)",height:"data(size)"}},{selector:".protein",style:{"background-color":"#FF5733"}},{selector:".analysis",style:{"background-color":"#ba0000",label:""}},{selector:".comparison",style:{"background-color":"#33A1FF"}},{selector:"edge[color]",style:{width:2,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"triangle"}}],layout:{name:"euler",animate:!0,avoidOverlap:!0,minDist:400,avoidOverlapPadding:50}});let n=this.cy.layers();console.log(n),this.cy.edges().forEach(i=>{i.on("mouseover",a=>{let o=a.target.data(),s=`Comparison: ${o.conditionA} vs ${o.conditionB}<br>Intensity ${o.conditionA}: ${o.intensityA}<br>Intensity ${o.conditionB}: ${o.intensityB}`;this.currentPopperRef=a.target.popper({content:()=>{let l=document.createElement("div");return l.classList.add("cy-tooltip"),l.innerHTML=s,document.body.appendChild(l),this.currentTooltip=l,l},popper:{placement:"bottom",removeOnDestroy:!0}})}),i.on("mouseout",()=>{this.currentTooltip&&(document.body.removeChild(this.currentTooltip),this.currentTooltip=null)})}),n.renderPerEdge(n.nodeLayer.insertAfter("canvas"),(i,a,o,s,l)=>{let u=a.data(),c=parseFloat(u.intensityA),d=parseFloat(u.intensityB),f=10,h=50,v=Math.max(c,d),m=c/v*h,p=d/v*h,g=(s.x+l.x)/2-f,y=(s.y+l.y)/2+h;i.fillStyle="white",i.fillRect(g-f-2,y-h-3,f*2+4,h+3),i.strokeStyle="black",i.strokeRect(g-f-2,y-h-3,f*2+4,h+3),i.fillStyle="red",i.fillRect(g-f,y-m,f,m),i.fillStyle="blue",i.fillRect(g+2,y-p,f,p)})}}buildGraphElements(){let t=[],n=new Set,i={};return this.projects.forEach(a=>{let o=this.searchResultsMap[a.id]||[];i[a.id]||(i[a.id]=`#${Math.floor(Math.random()*16777215).toString(16)}`);let s=i[a.id];o.forEach(l=>{let u=l.gene_name||l.uniprot_id||l.primary_id;n.has(u)||(t.push({data:{id:u,label:u,size:25},classes:"protein"}),n.add(u));let c=l.condition_A,d=l.condition_B;this.renameCondition[a.id]&&(this.renameCondition[a.id][l.condition_A]&&(c=this.renameCondition[a.id][l.condition_A]),this.renameCondition[a.id][l.condition_B]&&(d=this.renameCondition[a.id][l.condition_B]));let f=`${c} vs ${d}`;n.has(f)||(t.push({data:{id:f,label:`${c} vs ${d}`,size:25},classes:"comparison"}),n.add(f)),t.push({data:{id:`${u}-${f}-${a.id}`,source:u,target:f,color:s,conditionA:c,conditionB:d,intensityA:l.searched_data.find(h=>h.Condition===l.condition_A)?.Value,intensityB:l.searched_data.find(h=>h.Condition===l.condition_B)?.Value}})})}),t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot}getRandomColor(){return`#${Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}`}static{this.\u0275fac=function(n){return new(n||r)(be(Nr))}}static{this.\u0275cmp=je({type:r,selectors:[["app-cytoscape-plot"]],viewQuery:function(n,i){if(n&1&&ri(Hx,5),n&2){let a;ni(a=ii())&&(i.cyElement=a.first)}},inputs:{projects:"projects",searchResultsMap:"searchResultsMap",renameCondition:"renameCondition"},decls:2,vars:0,consts:[["cy",""],[1,"cy-container"]],template:function(n,i){n&1&&De(0,"div",1,0)},styles:[`.cy-container{width:100%;height:600px;border:1px solid #ccc}.edge-hover{transition:stroke-width .3s,stroke .3s;stroke-width:4px!important;stroke:red!important}
`],encapsulation:2})}}return r})();var Ux=r=>({"disabled-icon":r});function Kx(r,e){r&1&&(G(0,"button",11),ae(1,"No previous searches"),q())}function Xx(r,e){if(r&1){let t=Oe();G(0,"button",13),ue("click",function(){ge(t);let i=re().$implicit,a=re(3);return me(a.restoreSearches(i.searchQuery,i.searchID))}),ae(1),q()}if(r&2){let t=re().$implicit;Z(),dc("",t.searchID,". ",t.termFounds.join(","),"")}}function Yx(r,e){if(r&1&&Se(0,Xx,2,2,"button",12),r&2){let t=e.$implicit,n=re(3);Re(t.collate===n.collate.id?0:-1)}}function Qx(r,e){if(r&1&&We(0,Yx,1,1,null,null,Jr),r&2){let t=re(2);Ue(t.pastSearches)}}function Zx(r,e){if(r&1&&(G(0,"button",10)(1,"mat-icon"),ae(2,"history"),q()(),G(3,"mat-menu",null,0),Se(5,Kx,2,0,"button",11)(6,Qx,2,0),q()),r&2){let t=br(4),n=re();pe("matMenuTriggerFor",t),Z(5),Re(n.pastSearches.length===0?5:6)}}function Jx(r,e){if(r&1){let t=Oe();G(0,"button",14),ue("click",function(){ge(t);let i=re();return me(i.navigateToEdit())}),G(1,"mat-icon"),ae(2,"edit"),q()()}}function e2(r,e){if(r&1&&De(0,"app-collate-header",7),r&2){let t=re();pe("collate",t.collate)}}function t2(r,e){if(r&1&&(G(0,"div",15),De(1,"app-collate-tags",16),q()),r&2){let t=re(2);Z(),pe("collageTags",t.collate.tags)}}function r2(r,e){if(r&1&&Se(0,t2,2,1,"div",15),r&2){let t=re();Re(t.collate.settings.showTags?0:-1)}}function n2(r,e){if(r&1&&De(0,"app-cytoscape-plot",19),r&2){let t=re(2);pe("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("searchResultsMap",t.filteredResults)}}function i2(r,e){if(r&1){let t=Oe();ae(0),G(1,"button",24),ue("click",function(){ge(t);let i=re().$implicit,a=re(2);return me(a.exportData(i))}),G(2,"mat-icon"),ae(3,"download"),q()()}if(r&2){let t=re().$implicit,n=re(2);Ge(" ",t," "),Z(),pe("disabled",n.waitingForDownload)}}function a2(r,e){r&1&&(G(0,"mat-tab"),Se(1,i2,4,2,"ng-template",23),q())}function o2(r,e){if(r&1&&De(0,"app-collate-project-list",22),r&2){let t=re(2);pe("searchTerm",t.selectedSearchTerm)("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("filteredResults",t.filteredResults)}}function s2(r,e){if(r&1){let t=Oe();G(0,"button",17),ue("click",function(){ge(t);let i=re();return me(i.toggleCytoscapePlot())}),G(1,"mat-icon",18),ae(2,"account_tree"),q()(),Se(3,n2,1,3,"app-cytoscape-plot",19),G(4,"div",20)(5,"mat-tab-group",21),ue("selectedTabChange",function(){ge(t);let i=re();return me(i.filterDataBySearchTerm())}),Kt("selectedIndexChange",function(i){ge(t);let a=re();return Ut(a.selectedIndex,i)||(a.selectedIndex=i),me(i)}),We(6,a2,2,0,"mat-tab",null,Jr),q()(),Se(8,o2,1,4,"app-collate-project-list",22)}if(r&2){let t=re();Z(),pe("ngClass",Hi(5,Ux,!t.showCytoscapePlot)),Z(2),Re(t.collate&&t.showCytoscapePlot?3:-1),Z(2),Wt("selectedIndex",t.selectedIndex),pe("mat-stretch-tabs",!1),Z(),Ue(t.searchTerms),Z(2),Re(t.collate?8:-1)}}var tl=(()=>{class r{set sessionId(t){t&&this.collate&&this.getSearchFromID(t),this._sessionId=t}get sessionId(){return this._sessionId}set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this.collate=n,this.title.setTitle(`${n.title} - C|nder`),this.projects=n.projects,n.settings||(n.settings={projectOrder:[],analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),n.settings.plotSettings||(n.settings.plotSettings={}),n.settings.projectOrder&&(this.projects=n.settings.projectOrder.map(i=>n.projects.find(a=>a.id===i))),!this.collate?.settings.projectAnalysisGroupVisibility){this.collate.settings.projectAnalysisGroupVisibility={};for(let i of this.projects)this.collate.settings.projectAnalysisGroupVisibility[i.id]={}}if(this.collate?.settings.renameSampleCondition)this.sessionId&&this.getSearchFromID(this.sessionId);else{this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)});this.sessionId&&this.getSearchFromID(this.sessionId)}console.log(this.projects)})}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot}constructor(t,n,i,a,o,s,l,u){this.title=t,this.ws=n,this.sb=i,this.dialog=a,this.collateService=o,this.web=s,this.accounts=l,this.router=u,this.showCytoscapePlot=!1,this._sessionId=null,this.collate=null,this.projects=[],this.filteredResults={},this.searchTerms=[],this.selectedIndex=0,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this._selectedSearchTerm="",this.pastSearches=[],this.waitingForDownload=!1;let c=localStorage.getItem("cinderPastSearches");c&&(this.pastSearches=JSON.parse(c)),this.ws.searchWSConnection?.subscribe(d=>{if(d&&d.type==="export_status"&&this.web.cinderInstanceID===d.instance_id&&this.waitingForDownload)switch(d.status){case"error":this.waitingForDownload=!1;break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.waitingForDownload=!1,this.sb.open("Export complete","Dismiss",{duration:2e3});let f=`${this.web.baseURL}/api/search/download_temp_file/?token=${d.file}`;window.open(f,"_blank");break}})}associateAnalysisGroupsWithProjects(){return ot(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return ot(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),console.log(this.searchResults),this.searchTerms.sort((n,i)=>n.localeCompare(i)),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(i=>i.search_term===this.selectedSearchTerm),this.collate?.settings?.analysisGroupOrderMap&&(console.log(this.collate.settings.analysisGroupOrderMap),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{let a=parseInt(i),o=this.collate?.settings.analysisGroupOrderMap[a];if(!t[a]||!o)return;console.log(o);let s=t[a].filter(l=>!o.includes(l.analysis_group.id));if(t[a]=t[a].filter(l=>o.includes(l.analysis_group.id)),t[a]=t[a].sort((l,u)=>o.indexOf(l.analysis_group.id)-o.indexOf(u.analysis_group.id)),t[a].concat(s),this.collate?.settings?.projectAnalysisGroupVisibility){let l=this.collate?.settings.projectAnalysisGroupVisibility[a];t[a]=t[a].filter(u=>!l||!(u.analysis_group.id in l)?!0:l[u.analysis_group.id])}}))}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults(),this.collateService.collateRedrawSubject.next(!0)}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{this.searchSession=n}),this.web.getSearchResults(t,99999).subscribe(n=>{if(!this.collate)return;console.log(n.results);let i=Array.from(new Set(n.results.map(o=>o.search_term)));this.pastSearches.find(o=>o.searchID===t)||(this.pastSearches.push({searchQuery:null,termFounds:i,collate:this.collate.id,searchID:t}),this.pastSearches=this.pastSearches.slice(-20),localStorage.setItem("cinderPastSearches",JSON.stringify(this.pastSearches))),this.distributeSearchResults(n.results).then()})}restoreSearches(t,n){this.web.getSearchSession(n).subscribe(i=>{this.searchSession=i}),t?this.distributeSearchResults(t.results).then():this.web.getSearchResults(n,99999).subscribe(i=>{this.distributeSearchResults(i.results).then()})}navigateToEdit(){this.collate&&this.router.navigate([`/collate/edit/${this.collate.id}`])}openQRCodeDialog(){let t=window.location.href,n=this.dialog.open(Kc);n.componentInstance.url=t}navigateToHome(){this.router.navigate(["/"])}exportData(t){this.web.exportSearchData(this.searchSession.id,t,1e-8,1e-8,this.web.searchSessionID).subscribe(n=>{this.waitingForDownload=!0})}openVisibilityDialog(){let t=this.dialog.open(Go);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),l=this.collate?.settings.analysisGroupOrderMap[s];if(!l||!i[s])return;let u=i[s].filter(c=>!l.includes(c.id));i[s]=i[s].filter(c=>l.includes(c.id)),i[s]=i[s].sort((c,d)=>l.indexOf(c.id)-l.indexOf(d.id)),i[s]=i[s].concat(u)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}static{this.\u0275fac=function(n){return new(n||r)(be(gc),be(mo),be(Er),be(ui),be(Nr),be(er),be(zr),be(ai))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-view"]],inputs:{sessionId:"sessionId",collateId:"collateId"},decls:18,vars:9,consts:[["previousSearch","matMenu"],["href","/#/home"],[3,"width","height","ngSrc"],[1,"spacer"],["mat-icon-button","","matTooltip","Open QR code dialog",3,"click"],["mat-icon-button","","matTooltip","Change analysis group visibility",3,"click"],["mat-icon-button","","matTooltip","Edit collate"],[3,"collate"],[2,"display","flex","justify-content","center"],[3,"searchResultID","projects"],["mat-icon-button","","matTooltip","View previous searches",3,"matMenuTriggerFor"],["mat-menu-item","","disabled",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Edit collate",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTags"],["mat-icon-button","","matTooltip","Toggle Cytoscape Plot",3,"click"],[3,"ngClass"],[3,"renameCondition","projects","searchResultsMap"],[2,"padding","20px"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"searchTerm","renameCondition","projects","filteredResults"],["mat-tab-label",""],["mat-icon-button","","matTooltip","Export data",3,"click","disabled"]],template:function(n,i){n&1&&(G(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"a",1),De(3,"img",2),q(),De(4,"span",3),Se(5,Zx,7,2),G(6,"button",4),ue("click",function(){return i.openQRCodeDialog()}),G(7,"mat-icon"),ae(8,"qr_code"),q()(),G(9,"button",5),ue("click",function(){return i.openVisibilityDialog()}),G(10,"mat-icon"),ae(11,"visibility"),q()(),Se(12,Jx,3,0,"button",6),q()(),Se(13,e2,1,1,"app-collate-header",7)(14,r2,1,1),G(15,"div",8)(16,"app-collate-search",9),ue("searchResultID",function(o){return i._sessionId=o,i.getSearchFromID(o)}),q()(),Se(17,s2,9,7)),n&2&&(Z(3),pe("width",25)("height",25)("ngSrc","/assets/logo.png"),Z(2),Re(i.collate?5:-1),Z(7),Re(i.accounts.loggedIn?12:-1),Z(),Re(i.collate?13:-1),Z(),Re(i.collate&&i.collate.settings?14:-1),Z(2),pe("projects",i.projects),Z(),Re(i.searchTerms.length>0?17:-1))},dependencies:[$c,No,Po,Ao,jo,Xt,dn,yo,Co,$o,pc,Io,Ro,Oo,Lc,uo,qv,hc],styles:[".disabled-icon[_ngcontent-%COMP%]{color:red}"]})}}return r})();var Hv=(r,e)=>e.id;function l2(r,e){if(r&1){let t=Oe();G(0,"mat-chip",2),ue("click",function(){let i=ge(t).$implicit,a=re(2);return me(a.removeProject(i))}),ae(1),q()}if(r&2){let t=e.$implicit;Z(),Ge(" ",t.name," ")}}function u2(r,e){if(r&1&&(G(0,"div"),ae(1),G(2,"mat-chip-set"),We(3,l2,2,1,"mat-chip",null,Hv),q()()),r&2){let t=re();Z(),Ge(" Selected Projects: ",t.selectedMultipleProjects.length," "),Z(2),Ue(t.selectedMultipleProjects)}}function c2(r,e){if(r&1&&(G(0,"mat-list-option",4),ae(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),rt(t.name)}}function d2(r,e){if(r&1){let t=Oe();G(0,"div")(1,"mat-selection-list",3),We(2,c2,2,2,"mat-list-option",4,Hv),q(),G(4,"mat-paginator",5),ue("page",function(i){ge(t);let a=re(2);return me(a.handleProjectPageEvent(i))}),q()()}if(r&2){let t=re(2);Z(),pe("multiple",!1),Z(),Ue(t.projectQuery.results),Z(2),pe("pageSize",t.projectPageSize)("length",t.projectQuery.count)("pageIndex",t.projectPageIndex)}}function f2(r,e){r&1&&(G(0,"p"),ae(1,"No projects found."),q())}function h2(r,e){if(r&1&&Se(0,d2,5,4,"div")(1,f2,2,0,"p"),r&2){let t=re();Re(t.projectQuery.count>0?0:1)}}var Wv=(()=>{class r{constructor(t,n){this.fb=t,this.web=n,this.multipleSelection=!1,this.selectedProjects=new it,this.formProjectSearch=this.fb.group({searchTerm:new _r("",xr.required),selectedProjects:new _r([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(i=>{i&&this.fetchProjects(i,this.projectPageSize,0)}),this.formProjectSearch.controls.selectedProjects.valueChanges.subscribe(i=>{if(i){for(let a of i)this.selectedMultipleProjects.includes(a)||this.selectedMultipleProjects.push(a);this.selectedProjects.emit(this.selectedMultipleProjects)}})}fetchProjects(t,n,i){let a=i*n;this.web.getProjects(void 0,n,a,t,void 0).subscribe(o=>{this.projectQuery=o})}handleProjectPageEvent(t){this.projectPageIndex=t.pageIndex,this.fetchProjects(this.formProjectSearch.controls.searchTerm.value||"",t.pageSize,t.pageIndex)}removeProject(t){this.selectedMultipleProjects=this.selectedMultipleProjects.filter(n=>n!==t),this.selectedProjects.emit(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(be(Qt),be(er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-search"]],inputs:{multipleSelection:"multipleSelection"},outputs:{selectedProjects:"selectedProjects"},decls:7,vars:3,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Project Name","type","search"],[3,"click"],["formControlName","selectedProjects",3,"multiple"],[3,"value"],[3,"page","pageSize","length","pageIndex"]],template:function(n,i){n&1&&(G(0,"form",0)(1,"mat-form-field"),De(2,"input",1),G(3,"mat-label"),ae(4,"Search For Specific Projects"),q()(),Se(5,u2,5,1,"div")(6,h2,2,1),q()),n&2&&(pe("formGroup",i.formProjectSearch),Z(5),Re(i.selectedMultipleProjects.length>0?5:-1),Z(),Re(i.projectQuery?6:-1))},dependencies:[hr,fr,Yt,Et,dr,Fr,Lr,Zt,Jt,Vr,vo,ho,lo,so,co],encapsulation:2})}}return r})();var Uv=(()=>{class r{constructor(t,n,i){this.dialogRef=t,this.fb=n,this.web=i,this.formProjectSearch=this.fb.group({searchTerm:new _r("",xr.required),selectedProjects:new _r([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.multipleSelection=!0,this.web.getProjects(void 0,this.projectPageSize,0,void 0).subscribe(a=>{this.projectQuery=a}),this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(a=>{a&&this.web.getProjects(void 0,this.projectPageSize,0,a).subscribe(o=>{this.projectQuery=o})})}handleSelectedProjects(t){this.selectedMultipleProjects=t}close(){this.dialogRef.close()}save(){this.dialogRef.close(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(be(Bt),be(Qt),be(er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-add-dialog"]],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"selectedProjects"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(G(0,"h2",0),ae(1,"Project Add"),q(),G(2,"div",1)(3,"app-project-search",2),ue("selectedProjects",function(o){return i.handleSelectedProjects(o)}),q(),G(4,"small"),ae(5),q()(),G(6,"div",3)(7,"button",4),ue("click",function(){return i.save()}),ae(8,"Submit"),q(),G(9,"button",4),ue("click",function(){return i.close()}),ae(10,"Close"),q()()),n&2&&(Z(5),Ge("Selected ",i.selectedMultipleProjects.length," Projects."))},dependencies:[Wv,Rt,It,Ot,ct],encapsulation:2})}}return r})();var Kv=(r,e)=>e.id;function v2(r,e){if(r&1&&(G(0,"mat-list-item",5)(1,"mat-icon",7),ae(2,"notes"),q(),G(3,"div",8),ae(4),q(),De(5,"div",9),q()),r&2){let t=e.$implicit;Z(4),rt(t.name)}}function p2(r,e){if(r&1){let t=Oe();G(0,"div",5)(1,"div",6)(2,"b"),ae(3),q()(),G(4,"div",4),ue("cdkDropListDropped",function(i){let a=ge(t).$implicit,o=re(2);return me(o.drop(i,a.id))}),We(5,v2,6,1,"mat-list-item",5,Kv),q(),De(7,"mat-divider"),q()}if(r&2){let t=e.$implicit,n=re(2);Z(3),rt(t.name),Z(2),Ue(n.projectAnalysisGroupMap[t.id])}}function g2(r,e){if(r&1){let t=Oe();G(0,"mat-list")(1,"div",4),ue("cdkDropListDropped",function(i){ge(t);let a=re();return me(a.dropProject(i))}),We(2,p2,8,1,"div",5,Kv),q()()}if(r&2){let t=re();Z(2),Ue(t.projects)}}var Xv=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}constructor(t){this.dialogRef=t,this._projectAnalysisGroupMap={},this._projects=[]}save(){this.dialogRef.close({projects:this.projects,projectAnalysisGroupMap:this.projectAnalysisGroupMap})}cancel(){this.dialogRef.close()}drop(t,n){On(this.projectAnalysisGroupMap[n],t.previousIndex,t.currentIndex)}dropProject(t){On(this.projects,t.previousIndex,t.currentIndex)}static{this.\u0275fac=function(n){return new(n||r)(be(Bt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-analysis-group-reorder-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["mat-subheader","","cdkDragHandle",""],["cdkDragHandle","","matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""]],template:function(n,i){n&1&&(G(0,"h1",0),ae(1,"Analysis Group Reorder"),q(),G(2,"div",1),Se(3,g2,4,0,"mat-list"),q(),G(4,"div",2)(5,"button",3),ue("click",function(){return i.cancel()}),ae(6,"Close"),q(),G(7,"button",3),ue("click",function(){return i.save()}),ae(8,"Save"),q()()),n&2&&(Z(3),Re(i.projects.length>0?3:-1))},dependencies:[Rt,It,Mc,Pc,Dc,oo,Xt,kc,Fo,pn,vn,Ot,ct],encapsulation:2})}}return r})();var m2=["hueSlider"],y2=["alphaSlider"];function C2(r,e){if(r&1){let t=Oe();G(0,"div",10),ue("newValue",function(i){ge(t);let a=re();return me(a.onSliderChange("saturation-lightness",i))}),G(1,"div",11),De(2,"div"),q()()}if(r&2){let t=re();cn("background-color",t.hueSliderColor),pe("rgX",1)("rgY",1),Z(),cn("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function w2(r,e){if(r&1&&(G(0,"div",12),De(1,"div",13)(2,"div",14),q()),r&2){let t=re();Z(2),cn("background-color",t.selectedColor)}}function b2(r,e){if(r&1){let t=Oe();G(0,"div",15,1),ue("newValue",function(i){ge(t);let a=re();return me(a.onSliderChange("hue",i))}),G(2,"div",16)(3,"div"),De(4,"div"),q()()()}if(r&2){let t=re();pe("rgX",1),Z(2),cn("left",t.slider==null?null:t.slider.h,"px")}}function x2(r,e){if(r&1){let t=Oe();G(0,"div",17,2),ue("newValue",function(i){ge(t);let a=re();return me(a.onSliderChange("alpha",i))}),De(2,"div",18),G(3,"div",16)(4,"div"),De(5,"div"),q()()()}if(r&2){let t=re();pe("rgX",1),Z(2),pe("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),Z(),cn("left",t.slider==null?null:t.slider.a,"px")}}var _2=["dialog"],Zv=r=>({background:r});function E2(r,e){r&1&&De(0,"div",12)}function S2(r,e){if(r&1){let t=Oe();xt(0),G(1,"div",9)(2,"div",10),ue("click",function(){let i=ge(t).$implicit,a=re(2);return me(a.onColorClick(i))}),Se(3,E2,1,0,"div",11),q()(),_t()}if(r&2){let t=e.$implicit,n=e.index,i=re(2);Z(2),Za("colornull",!t),pe("ngStyle",i.getBackgroundColor(t)),Z(),pe("ngIf",n==i.indexSeleccionado)}}function T2(r,e){if(r&1&&De(0,"div",18),r&2){let t=re(3);pe("ngStyle",t.getBackgroundColor(t.color))}}function k2(r,e){if(r&1){let t=Oe();G(0,"div",13),ue("click",function(){ge(t);let i=re(2);return me(i.addColor())}),Se(1,T2,1,1,"div",14),Ya(),G(2,"svg",15),De(3,"path",16)(4,"path",17),q()()}if(r&2){let t=re(2);Z(),pe("ngIf",t.indexSeleccionado===void 0)}}function M2(r,e){if(r&1){let t=Oe();G(0,"color-picker",19),ue("colorChange",function(i){ge(t);let a=re(2);return me(a.onChangeColorPicker(i))})("onAlphaChange",function(i){ge(t);let a=re(2);return me(a.onAlphaChange(i))}),q()}if(r&2){let t=re(2);pe("controls",t.colorPickerControls)("color",t.hsva)}}function D2(r,e){if(r&1&&(xt(0),G(1,"div",5),Se(2,S2,4,4,"ng-container",6)(3,k2,5,1,"div",7)(4,M2,1,2,"color-picker",8),q(),_t()),r&2){let t=re();Z(),pe("@colorsAnimation",t.colorsAnimationEffect),Z(),pe("ngForOf",t.palette),Z(),pe("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),Z(),pe("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function P2(r,e){r&1&&De(0,"div",12)}function A2(r,e){if(r&1){let t=Oe();xt(0),G(1,"div",9)(2,"div",25),ue("click",function(){let i=ge(t).$implicit,a=re(2);return me(a.changeColor(i))}),Se(3,P2,1,0,"div",11),q()(),_t()}if(r&2){let t=e.$implicit,n=re(2);Z(2),Za("colornull",!t),pe("ngStyle",Hi(4,Zv,t)),Z(),pe("ngIf",n.isSelected(t))}}function B2(r,e){if(r&1){let t=Oe();xt(0),G(1,"div",5)(2,"div",20)(3,"div",21),ue("click",function(){ge(t);let i=re();return me(i.onClickBack())}),Ya(),G(4,"svg",22),De(5,"path",23)(6,"path",24),q()()(),Se(7,A2,4,6,"ng-container",6),q(),_t()}if(r&2){let t=re();Z(),pe("@colorsAnimation",t.colorsAnimationEffect),Z(6),pe("ngForOf",t.variants)}}function R2(r,e){if(r&1){let t=Oe();xt(0),G(1,"div",26)(2,"div",27),ue("click",function(){ge(t);let i=re();return me(i.onClickBack())}),Ya(),G(3,"svg",22),De(4,"path",23)(5,"path",24),q()(),rc(),G(6,"button",28),ue("click",function(){ge(t);let i=re();return me(i.emitClose("cancel"))}),ae(7),q(),G(8,"button",28),ue("click",function(){ge(t);let i=re();return me(i.emitClose("accept"))}),ae(9),q()(),G(10,"div",29)(11,"color-picker",30),ue("sliderChange",function(i){ge(t);let a=re();return me(a.onChangeColorPicker(i))}),q()(),_t()}if(r&2){let t=re();Z(7),Ge(" ",t.cancelLabel," "),Z(2),Ge(" ",t.acceptLabel," "),Z(2),pe("controls",t.colorPickerControls)("color",t.hsva)}}function I2(r,e){if(r&1){let t=Oe();G(0,"div",31)(1,"p",32),ue("click",function(){ge(t);let i=re();return me(i.nextFormat())}),ae(2),q(),G(3,"div",33)(4,"input",34,1),ue("keyup",function(){ge(t);let i=br(5),a=re();return me(a.changeColorManual(i.value))})("keydown.enter",function(){ge(t);let i=re();return me(i.emitClose("accept"))}),q()()()}if(r&2){let t=re();Z(2),rt(t.colorFormats[t.format]),Z(2),cn("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),pe("placeholder",t.placeholder)("value",t.color)}}var Gu=["hex","rgba","hsla","cmyk"],ir=function(r){return r[r.HEX=0]="HEX",r[r.RGBA=1]="RGBA",r[r.HSLA=2]="HSLA",r[r.CMYK=3]="CMYK",r}(ir||{}),Yv=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],Yr=class{constructor(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Ar=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i,this.onChange=new it(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},ti=class{constructor(e,t,n,i){this.h=e,this.s=t,this.l=n,this.a=i}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},In=class{constructor(e,t,n,i,a=1){this.c=e,this.m=t,this.y=n,this.k=i,this.a=a}denormalize(){return this.c=Math.round(this.c*100),this.m=Math.round(this.m*100),this.y=Math.round(this.y*100),this.k=Math.round(this.k*100),this}toString(){return this.denormalize(),"cmyk("+this.c+", "+this.m+", "+this.y+", "+this.k+")"}},qu=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},nl=(()=>{class r{constructor(){}toFormat(t,n){var i="";if(t)switch(n){case ir.HEX:var o=this.hsvaToRgba(t);o.denormalize();var i=this.rgbaToHex(o,!0);break;case ir.HSLA:var a=this.hsva2hsla(t);a.denormalize();var i=a.toString();break;case ir.RGBA:var o=this.hsvaToRgba(t),i=o.toString();break;case ir.CMYK:var s=this.hsvaToCmyk(t),i=s.toString();break}return i}stringToFormat(t,n){var i=this.stringToHsva(t,!0);return this.toFormat(i,n)}hsva2hsla(t){let n=t.h,i=t.s,a=t.v,o=t.a;if(a===0)return new ti(n,0,0,o);if(i===0&&a===1)return new ti(n,1,1,o);{let s=a*(2-i)/2;return new ti(n,a*i/(1-Math.abs(2*s-1)),s,o)}}hsla2hsva(t){let n=Math.min(t.h,1),i=Math.min(t.s,1),a=Math.min(t.l,1),o=Math.min(t.a,1);if(a===0)return new Ar(n,0,0,o);{let s=a+i*(1-Math.abs(2*a-1))/2;return new Ar(n,2*(s-a)/s,s,o)}}hsvaToRgba(t){let n,i,a,o=t.h,s=t.s,l=t.v,u=t.a,c=Math.floor(o*6),d=o*6-c,f=l*(1-s),h=l*(1-d*s),v=l*(1-(1-d)*s);switch(c%6){case 0:n=l,i=v,a=f;break;case 1:n=h,i=l,a=f;break;case 2:n=f,i=l,a=v;break;case 3:n=f,i=h,a=l;break;case 4:n=v,i=f,a=l;break;case 5:n=l,i=f,a=h;break;default:n=0,i=0,a=0}return new Yr(n,i,a,u)}cmykToRgb(t){let n=(1-t.c)*(1-t.k),i=(1-t.m)*(1-t.k),a=(1-t.y)*(1-t.k);return new Yr(n,i,a,t.a)}rgbaToCmyk(t){let n=1-Math.max(t.r,t.g,t.b);if(n===1)return new In(0,0,0,1,t.a);{let i=(1-t.r-n)/(1-n),a=(1-t.g-n)/(1-n),o=(1-t.b-n)/(1-n);return new In(i,a,o,n,t.a)}}hsvaToCmyk(t){let n=this.hsvaToRgba(t);return this.rgbaToCmyk(n)}rgbaToHsva(t){let n,i,a=Math.min(t.r,1),o=Math.min(t.g,1),s=Math.min(t.b,1),l=Math.min(t.a,1),u=Math.max(a,o,s),c=Math.min(a,o,s),d=u,f=u-c;if(i=u===0?0:f/u,u===c)n=0;else{switch(u){case a:n=(o-s)/f+(o<s?6:0);break;case o:n=(s-a)/f+2;break;case s:n=(a-o)/f+4;break;default:n=0}n/=6}return new Ar(n,i,d,l)}rgbaToHex(t,n){let i="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(i+=(256|Math.round(t.a*255)).toString(16).substr(1)),i}normalizeCMYK(t){return new In(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new In(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new Yr(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",n=!0){let i=null;t=(t||"").toLowerCase();let a=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new Yr(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new ti(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/cmyk?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new In(parseInt(o[1],10)/100,parseInt(o[2],10)/100,parseInt(o[3],10)/100,parseInt(o[4],10)/100)}}];n?a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new Yr(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}):a.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new Yr(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),a.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new Yr(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(let o in a)if(a.hasOwnProperty(o)){let s=a[o],l=s.re.exec(t),u=l&&s.parse(l);if(u){if(u instanceof Yr)i=this.rgbaToHsva(u);else if(u instanceof ti)i=this.hsla2hsva(u);else if(u instanceof In){let c=this.cmykToRgb(u);i=this.rgbaToHsva(c)}return i}}return i}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let n=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,i=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,a=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/,o=/(cmyk\(\d{1,3}(,\s?\d{1,3}){3}\))/;if(n.test(t))return"hex";if(i.test(t))return"rgba";if(a.test(t))return"hsla";if(o.test(t))return"cmyk"}return"hex"}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=ll({token:r,factory:r.\u0275fac}),r})(),rl=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},Hu=class{constructor(e,t,n,i){this.h=e,this.s=t,this.v=n,this.a=i}},O2=(()=>{class r{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new it,this.dragStart=new it,this.newValue=new it,this.listenerMove=n=>this.move(n),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-n.left-window.pageXOffset}getY(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-n.top-window.pageYOffset}setCursor(t){let n=this.elRef.nativeElement.offsetWidth,i=this.elRef.nativeElement.offsetHeight,a=Math.max(0,Math.min(this.getX(t),n)),o=Math.max(0,Math.min(this.getY(t),i));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:a/n,v:1-o/i,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:o/i,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:a/n,rgX:this.rgX})}}return r.\u0275fac=function(t){return new(t||r)(be(ul))},r.\u0275dir=dl({type:r,selectors:[["","slider",""]],hostBindings:function(t,n){t&1&&ue("mousedown",function(a){return n.mouseDown(a)})("touchstart",function(a){return n.touchStart(a)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"},standalone:!1}),r})(),F2=(()=>{class r{constructor(t,n){this.service=t,this.cdr=n,this.color=new Ar(0,1,1,1),this.controls="default",this.sliderChange=new it(!1),this.onAlphaChange=new it(!1),this.hsva=new Ar(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new Ar(0,1,1,1)),this.slider=new rl(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,n=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new Hu(t,220,130,n),this.update()}onSliderChange(t,n){switch(t){case"saturation-lightness":this.hsva.onColorChange(n);break;case"hue":this.hsva.onHueChange(n);break;case"alpha":this.hsva.onAlphaChange(n),this.onAlphaChange.emit(n);break;case"value":this.hsva.onValueChange(n);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),n=this.service.hsvaToRgba(new Ar(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+n.r+","+n.g+","+n.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new rl(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return r.\u0275fac=function(t){return new(t||r)(be(nl),be(ro))},r.\u0275cmp=je({type:r,selectors:[["color-picker"]],viewQuery:function(t,n){if(t&1&&(ri(m2,5),ri(y2,5)),t&2){let i;ni(i=ii())&&(n.hueSlider=i.first),ni(i=ii())&&(n.alphaSlider=i.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},standalone:!1,features:[tc],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,n){if(t&1){let i=Oe();G(0,"div",3,0),ue("click",function(o){return ge(i),me(o.stopPropagation())}),Se(2,C2,3,8,"div",4),G(3,"div",5),Se(4,w2,3,2,"div",6),G(5,"div",7),Se(6,b2,5,3,"div",8)(7,x2,6,4,"div",9),q()()()}t&2&&(Z(2),pe("ngIf",n.controls!="only-alpha"),Z(2),pe("ngIf",n.controls!="only-alpha"),Z(2),pe("ngIf",n.controls!="only-alpha"),Z(),pe("ngIf",n.controls!="no-alpha"))},dependencies:[hl,no,O2],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),r})(),L2=(()=>{class r{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,n){this.service=t,this.cdr=n,this.color="#000000",this.previewColor="#000000",this.hsva=new Ar(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=Yv,this.variants=[],this.userFormats=[],this.colorFormats=Gu,this.format=ir.HEX,this.formatMap={hex:ir.HEX,rgba:ir.RGBA,hsla:ir.HSLA,cmyk:ir.CMYK},this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let n;if(this.color)for(let i=0;i<t.length;i++){let a=t[i];typeof a=="string"?this.service.stringToFormat(this.color,ir.HEX)==this.service.stringToFormat(a,ir.HEX)&&(n=i):a===void 0?this.color=void 0:this.findIndexSelectedColor(a.variants)!=null&&(n=i)}return n}iniciate(t,n,i,a,o,s,l,u,c,d,f,h,v=[]){if(this.colorPickerControls=f,this.triggerInstance=t,this.TriggerBBox=n,this.color=i,this.hideColorPicker=u,this.hideTextInput=l,this.acceptLabel=c,this.cancelLabel=d,v.length&&v.every(p=>Gu.includes(p))&&(this.colorFormats=v),s?this.colorFormats.includes(s)?(this.format=this.colorFormats.indexOf(s.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=s.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=ir.HEX):(this.format=this.colorFormats.indexOf(this.service.getFormatByString(this.color)),this.format<0&&(this.format=0)),this.previewColor=this.color,this.palette=a??Yv,this.colorsAnimationEffect=o,h=="top"){let m=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+m.height+"px ))"}}setPosition(){if(this.TriggerBBox){let n=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=n.top+n.height,n.left+250>window.innerWidth?this.left=n.right<250?window.innerWidth/2-250/2:n.right-250:this.left=n.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),n=this.panelRef.nativeElement.getBoundingClientRect(),i=n.height;t.bottom+i>window.innerHeight?this.positionString=t.top<n.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(n=>n.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,n){var i=[];for(let a=0;a<n.length;a++){let o=n[a];if(typeof o=="string"){let s=this.service.stringToHsva(o);s.onAlphaChange(t),i.push(this.service.toFormat(s,this.format))}else{let s=new qu,l=this.service.stringToHsva(o.preview);l.onAlphaChange(t),s.preview=this.service.toFormat(l,this.format),s.variants=this.ChangeAlphaOnPalette(t,o.variants),i.push(s)}}return i}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.setPreviewColor(this.hsva),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color,this.previewColor)}setColor(t,n=-1){this.hsva=t;let i=this.colorFormats[this.format],a=n;a<0&&(a=this.formatMap[i]),this.color=this.service.toFormat(t,a),this.setPreviewColor(t),this.triggerInstance.setColor(this.color,this.previewColor)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){if(this.canChangeFormat){this.format=(this.format+1)%this.colorFormats.length;let t=this.colorFormats[this.format],n=this.formatMap[t];this.setColor(this.hsva,n),this.placeholder=this.service.toFormat(new Ar(0,0,1,1),n)}}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return r.\u0275fac=function(t){return new(t||r)(be(nl),be(ro))},r.\u0275cmp=je({type:r,selectors:[["ngx-colors-panel"]],viewQuery:function(t,n){if(t&1&&ri(_2,5),t&2){let i;ni(i=ii())&&(n.panelRef=i.first)}},hostVars:4,hostBindings:function(t,n){t&1&&ue("mousedown",function(a){return n.click(a)},!1,cl)("scroll",function(){return n.onScroll()},!1,cl)("resize",function(){return n.onResize()},!1,ac),t&2&&cn("top",n.top,"px")("left",n.left,"px")},standalone:!1,decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[2,"cursor","pointer",3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,n){t&1&&(G(0,"div",2,0),Se(2,D2,5,4,"ng-container",3)(3,B2,8,2,"ng-container",3)(4,R2,12,4,"ng-container",3)(5,I2,6,7,"div",4),q()),t&2&&(uc(n.positionString),Z(2),pe("ngIf",n.menu==1),Z(),pe("ngIf",n.menu==2),Z(),pe("ngIf",n.menu==3),Z(),pe("ngIf",!n.hideTextInput))},dependencies:[vc,hl,no,F2],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[xc("colorsAnimation",[gl("void => slide-in",[Wi(":enter",en({opacity:0}),{optional:!0}),Wi(":enter",ml("10ms",[vl(".3s ease-in",pl([en({opacity:0,transform:"translatex(-50%)",offset:0}),en({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),en({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),gl("void => popup",[Wi(":enter",en({opacity:0,transform:"scale(0)"}),{optional:!0}),Wi(":enter",ml("10ms",[vl("500ms ease-out",pl([en({opacity:.5,transform:"scale(.5)",offset:.3}),en({opacity:1,transform:"scale(1.1)",offset:.8}),en({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),r})(),Qv={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},Jv=(()=>{class r{constructor(t,n,i){this.resolver=t,this.applicationRef=n,this.injector=i}createPanel(t,n){this.componentRef!=null&&this.removePanel();let i=this.resolver.resolveComponentFactory(L2);this.componentRef=i.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let a=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(n),Object.keys(Qv).forEach(o=>{this.overlay.style[o]=Qv[o]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(a),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return r.\u0275fac=function(t){return new(t||r)(Xa(oc),Xa(sc),Xa(nc))},r.\u0275prov=ll({token:r,factory:r.\u0275fac}),r})(),Wu=(()=>{class r{onClick(){this.openPanel()}constructor(t,n,i){this.triggerRef=t,this.panelFactory=n,this.service=i,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new it,this.input=new it,this.slider=new it,this.close=new it,this.open=new it,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position,this.formats)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t,n=""){this.writeValue(t,n),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t,n=""){if(t!==this.color){if(this.format){let a=Gu.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,a)}this.color=t;let i=!1;t&&t.startsWith("cmyk")&&(i=!0,n||(n=this.service.stringToFormat(t,ir.RGBA))),this.change.emit(i?n:t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return r.\u0275fac=function(t){return new(t||r)(be(ul),be(Jv),be(nl))},r.\u0275dir=dl({type:r,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,n){t&1&&ue("click",function(){return n.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",formats:"formats",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},standalone:!1,features:[fc([{provide:_c,useExisting:ec(()=>r),multi:!0}])]}),r})(),ep=(()=>{class r{constructor(t,n){this.cdRef=t,this.triggerDirective=n,this.triggerDirectiveColorChangeSubscription=null,this.color=this.triggerDirective.color}ngOnInit(){this.triggerDirectiveColorChangeSubscription=this.triggerDirective.change.subscribe(t=>{this.color=t,this.cdRef.markForCheck()})}ngOnDestroy(){this.triggerDirectiveColorChangeSubscription&&this.triggerDirectiveColorChangeSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(be(ro),be(Wu,1))},r.\u0275cmp=je({type:r,selectors:[["ngx-colors"]],standalone:!1,decls:4,vars:5,consts:[[1,"app-color-picker"],[1,"preview"],[1,"preview-background"],[1,"circle",3,"ngStyle"]],template:function(t,n){t&1&&(G(0,"div",0)(1,"div",1)(2,"div",2),De(3,"div",3),q()()()),t&2&&(Z(3),Za("colornull",!n.color),pe("ngStyle",Hi(3,Zv,n.color)))},dependencies:[no],styles:["[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]{line-height:1px;font-family:sans-serif}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin:2px;display:inline-block;box-sizing:border-box;border-radius:100%;background:white;cursor:pointer;padding:3px;box-shadow:0 1px 1px #0003,0 1px 1px 1px #00000024,0 1px 1px 1px #0000001f}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-background[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px;border-radius:100%}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:20px;width:20px;box-sizing:border-box;border-radius:100%;cursor:pointer}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .noselected[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}"]}),r})(),tp=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Qa({type:r}),r.\u0275inj=Ka({providers:[nl,Jv],imports:[ao]}),r})();var N2=(r,e)=>e.id;function z2(r,e){if(r&1){let t=Oe();G(0,"div",4)(1,"ngx-colors",5),Kt("ngModelChange",function(i){let a=ge(t).$implicit,o=re(2).$implicit,s=re();return Ut(s.projectConditionColorMap[o.id][a],i)||(s.projectConditionColorMap[o.id][a]=i),me(i)}),q(),G(2,"div"),ae(3),q()()}if(r&2){let t=e.$implicit,n=re(2).$implicit,i=re();Z(),Wt("ngModel",i.projectConditionColorMap[n.id][t]),Z(2),rt(t)}}function j2(r,e){if(r&1&&We(0,z2,4,2,"div",4,Jr),r&2){let t=re().$implicit,n=re();Ue(n.projectConditionMap[t.id])}}function $2(r,e){if(r&1&&(G(0,"div")(1,"div")(2,"b"),ae(3),q()(),Se(4,j2,2,0),q()),r&2){let t=e.$implicit,n=re();Z(3),rt(t.name),Z(),Re(n.projectConditionMap[t.id]?4:-1)}}var rp=(()=>{class r{set projects(t){this._projects=t;for(let n of t)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i)this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.projectConditionColorMap[a.AnalysisGroup.project]||(this.projectConditionColorMap[a.AnalysisGroup.project]={}),this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]||(this.projectConditionColorMap[a.AnalysisGroup.project][a.Condition]="")})}get projects(){return this._projects}set projectConditionColorMap(t){if(t==null){this._projectConditionColorMap={};return}this._projectConditionColorMap=Object.assign({},t)}get projectConditionColorMap(){return this._projectConditionColorMap}constructor(t,n){this.dialogRef=t,this.web=n,this._projects=[],this.projectConditionMap={},this._projectConditionColorMap={}}save(){this.dialogRef.close(this.projectConditionColorMap)}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(be(Bt),be(er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-condition-color-editor-dialog"]],inputs:{projects:"projects",projectConditionColorMap:"projectConditionColorMap"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],[2,"display","flex","gap","5px","align-items","center"],["ngx-colors-trigger","",3,"ngModelChange","ngModel"]],template:function(n,i){n&1&&(G(0,"h1",0),ae(1,"Condition Color Editor"),q(),G(2,"div",1),We(3,$2,5,2,"div",null,N2),q(),G(5,"div",2)(6,"button",3),ue("click",function(){return i.cancel()}),ae(7,"Close"),q(),G(8,"button",3),ue("click",function(){return i.save()}),ae(9,"Save"),q()()),n&2&&(Z(3),Ue(i.projects))},dependencies:[Rt,It,tp,ep,Wu,hn,Et,fn,ct,Ot],encapsulation:2})}}return r})();function G2(r,e){if(r&1&&(G(0,"mat-option",6),ae(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),rt(t)}}var np=(()=>{class r{_filter(t){let n=t.toLowerCase();return this.tags.filter(i=>i.toLowerCase().includes(n))}constructor(t,n,i){this.fb=t,this.dialogRef=n,this.collateService=i,this.form=this.fb.group({name:["",xr.required],existing:[!1],id:[-1]}),this.tags=[]}ngOnInit(){this.filteredTags=this.form.controls.name.valueChanges.pipe(Wa(""),Ua(t=>this.collateService.getCollateTags(t).pipe(Ha(n=>n.results.map(i=>i.name)))))}submit(){let t=this.form.controls.name.value;this.collateService.getCollateTags(t).subscribe(n=>{let i=n.results.find(o=>o.name.toLowerCase()===t.toLowerCase()),a=!!i;this.form.controls.existing.setValue(a),this.form.controls.id.setValue(a?i.id:null),this.dialogRef.close(this.form.value)})}cancel(){this.dialogRef.close()}onTagSelected(t){let n=t.option.value;this.form.controls.name.setValue(n),this.collateService.getCollateTags(n).subscribe(i=>{let a=i.results.find(o=>o.name.toLowerCase()===n.toLowerCase());this.form.controls.existing.setValue(!!a),this.form.controls.id.setValue(a?a.id:null)})}static{this.\u0275fac=function(n){return new(n||r)(be(Qt),be(Bt),be(Nr))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-tag-create-dialog"]],decls:18,vars:5,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["type","text","matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"]],template:function(n,i){if(n&1){let a=Oe();G(0,"h1",1),ae(1,"Create/Add Tag"),q(),G(2,"div",2)(3,"form",3)(4,"mat-form-field")(5,"mat-label"),ae(6,"Tag Name"),q(),De(7,"input",4),G(8,"mat-autocomplete",5,0),ue("optionSelected",function(s){return ge(a),me(i.onTagSelected(s))}),We(10,G2,2,2,"mat-option",6,Jr),eo(12,"async"),q()()()(),G(13,"div",7)(14,"button",8),ue("click",function(){return ge(a),me(i.cancel())}),ae(15,"Cancel"),q(),G(16,"button",9),ue("click",function(){return ge(a),me(i.submit())}),ae(17,"Submit"),q()()}if(n&2){let a=br(9);Z(3),pe("formGroup",i.form),Z(4),pe("matAutocomplete",a),Z(3),Ue(to(12,3,i.filteredTags)),Z(6),pe("disabled",i.form.invalid)}},dependencies:[Rt,It,hr,fr,Yt,Et,dr,Fr,Lr,Vr,Jt,Zt,ct,Ot,oi,io,po,go],encapsulation:2})}}return r})();var q2=(r,e)=>e.id;function H2(r,e){r&1&&(G(0,"th",11),ae(1," Original Title "),q())}function W2(r,e){if(r&1&&(G(0,"td",12),ae(1),q()),r&2){let t=e.$implicit;Z(),Ge(" ",t," ")}}function U2(r,e){r&1&&(G(0,"th",11),ae(1," Display Title "),q())}function K2(r,e){if(r&1&&(G(0,"td",12)(1,"form",13)(2,"mat-form-field"),De(3,"input",14),q()()()),r&2){let t=e.$implicit,n=re(2).$implicit,i=re();Z(),pe("formGroup",i.formMap[n.id][t]),Z(2),cc("formControlName",t)}}function X2(r,e){r&1&&De(0,"tr",15)}function Y2(r,e){r&1&&De(0,"tr",16)}function Q2(r,e){if(r&1&&(G(0,"h5"),ae(1),q(),G(2,"table",4),xt(3,5),Se(4,H2,2,0,"th",6)(5,W2,2,1,"td",7),_t(),xt(6,8),Se(7,U2,2,0,"th",6)(8,K2,4,2,"td",7),_t(),Se(9,X2,1,0,"tr",9)(10,Y2,1,0,"tr",10),q()),r&2){let t=re().$implicit,n=re();Z(),rt(t.name),Z(),pe("dataSource",n.projectConditionMap[t.id]),Z(7),pe("matHeaderRowDef",n.displayedColumns),Z(),pe("matRowDefColumns",n.displayedColumns)}}function Z2(r,e){if(r&1&&Se(0,Q2,11,4),r&2){let t=e.$implicit,n=re();Re(n.formMap[t.id]?0:-1)}}var ip=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set renameSampleCondition(t){for(let n of this.projects)this.web.getProjectUniqueConditions(n.id).subscribe(i=>{for(let a of i){if(this.formMap[a.AnalysisGroup.project]||(this.formMap[a.AnalysisGroup.project]={}),!this.formMap[a.AnalysisGroup.project][a.Condition]){let o={};o[a.Condition]=new _r(a.Condition,xr.required),this.formMap[a.AnalysisGroup.project][a.Condition]=this.fb.group(o)}this.projectConditionMap[a.AnalysisGroup.project]||(this.projectConditionMap[a.AnalysisGroup.project]=[]),this.projectConditionMap[a.AnalysisGroup.project].includes(a.Condition)||this.projectConditionMap[a.AnalysisGroup.project].push(a.Condition),this.renameSampleCondition[a.AnalysisGroup.project]||(this.renameSampleCondition[a.AnalysisGroup.project]={}),this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]||(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=a.Condition),t[a.AnalysisGroup.project]&&t[a.AnalysisGroup.project][a.Condition]&&(this.renameSampleCondition[a.AnalysisGroup.project][a.Condition]=t[a.AnalysisGroup.project][a.Condition],this.formMap[a.AnalysisGroup.project][a.Condition].controls[a.Condition].setValue(t[a.AnalysisGroup.project][a.Condition]))}})}get renameSampleCondition(){return this._renameSampleCondition}constructor(t,n,i,a){this.dialog=t,this.web=n,this.fb=i,this.sb=a,this.displayedColumns=["original","display"],this.projectConditionMap={},this._projects=[],this._renameSampleCondition={},this.formMap={}}close(){this.dialog.close()}submit(){let t={};for(let n in this.formMap){t[n]={};for(let i in this.formMap[n])if(t[n][i]=this.formMap[n][i].value[i],!this.formMap[n][i].valid){this.sb.open(`${i} is invalid`);return}}this.dialog.close(t)}static{this.\u0275fac=function(n){return new(n||r)(be(Bt),be(er),be(Qt),be(Er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-rename-sample-condition-dialog"]],inputs:{projects:"projects",renameSampleCondition:"renameSampleCondition"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","original"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","display"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"formGroup"],["matInput","",2,"border-radius","0",3,"formControlName"],["mat-header-row",""],["mat-row",""]],template:function(n,i){n&1&&(G(0,"h1",0),ae(1,"Rename Conditions"),q(),G(2,"div",1),We(3,Z2,1,1,null,null,q2),q(),G(5,"div",2)(6,"button",3),ue("click",function(){return i.submit()}),ae(7,"Submit"),q(),G(8,"button",3),ue("click",function(){return i.close()}),ae(9,"Close"),q()()),n&2&&(Z(3),Ue(i.projects))},dependencies:[Rt,It,hr,fr,Yt,Et,dr,Fr,Lr,So,bo,_o,Eo,Mo,To,Do,ko,wo,xo,Ot,ct,Zt,Jt],encapsulation:2})}}return r})();var ap=(()=>{class r{set settings(t){for(let n in t)this._settings[n]=t[n];this._settings&&this.form.patchValue(this._settings)}get settings(){return this._settings}constructor(t,n){this.fb=t,this.dialog=n,this._settings={},this.form=this.fb.group({marginLeft:150,marginRight:100,marginTop:100,marginBottom:100,titleTextSize:14,showTitle:!0,height:500,barSize:50})}submit(){this.dialog.close(this.form.value)}close(){this.dialog.close()}static{this.\u0275fac=function(n){return new(n||r)(be(Qt),be(Bt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-plot-settings"]],inputs:{settings:"settings"},decls:46,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],[2,"display","flex","flex-direction","column","gap","5px"],["matInput","","formControlName","height","type","number"],["matInput","","formControlName","barSize","type","number"],["matInput","","formControlName","marginLeft","type","number"],["matInput","","formControlName","marginRight","type","number"],["matInput","","formControlName","marginTop","type","number"],["matInput","","formControlName","marginBottom","type","number"],["formControlName","showTitle"],["matInput","","formControlName","titleTextSize","type","number"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,i){n&1&&(G(0,"h5",0),ae(1,"Plot General Settings"),q(),G(2,"div",1)(3,"form",2)(4,"section",3)(5,"b"),ae(6,"Overall Size"),q(),G(7,"mat-form-field"),De(8,"input",4),G(9,"mat-label"),ae(10,"Height"),q()(),G(11,"mat-form-field"),De(12,"input",5),G(13,"mat-label"),ae(14,"Bar size"),q()(),G(15,"mat-form-field"),De(16,"input",6),G(17,"mat-label"),ae(18,"Margin Left"),q()(),G(19,"mat-form-field"),De(20,"input",7),G(21,"mat-label"),ae(22,"Margin Right"),q()(),G(23,"mat-form-field"),De(24,"input",8),G(25,"mat-label"),ae(26,"Margin Top"),q()(),G(27,"mat-form-field"),De(28,"input",9),G(29,"mat-label"),ae(30,"Margin Bottom"),q()()(),De(31,"mat-divider"),G(32,"section",3)(33,"b"),ae(34,"Title"),q(),G(35,"mat-checkbox",10),ae(36,"Show Title"),q(),G(37,"mat-form-field"),De(38,"input",11),G(39,"mat-label"),ae(40,"Title Text Size"),q()()()()(),G(41,"div",12)(42,"button",13),ue("click",function(){return i.close()}),ae(43,"Cancel"),q(),G(44,"button",13),ue("click",function(){return i.submit()}),ae(45,"Save"),q()()),n&2&&(Z(3),pe("formGroup",i.form))},dependencies:[Rt,It,hr,fr,Yt,Sc,Et,dr,Fr,Lr,Zt,Jt,Vr,ci,Ot,ct,oo],encapsulation:2})}}return r})();function J2(r,e){if(r&1){let t=Oe();G(0,"mat-checkbox",12),Kt("ngModelChange",function(i){ge(t);let a=re(2);return Ut(a.collate.settings.showTags,i)||(a.collate.settings.showTags=i),me(i)}),ae(1,"Show Tags"),q()}if(r&2){let t=re(2);Wt("ngModel",t.collate.settings.showTags)}}function e_(r,e){if(r&1){let t=Oe();G(0,"h1",15),ue("click",function(){ge(t);let i=re(3);return me(i.toggleEditTitle())}),ae(1),q(),De(2,"br")}if(r&2){let t=re(3);Z(),rt(t.collate.title)}}function t_(r,e){if(r&1){let t=Oe();G(0,"div")(1,"mat-form-field",16)(2,"input",17),ue("keydown.enter",function(){ge(t);let i=re(3);return me(i.toggleEditTitle())}),Kt("ngModelChange",function(i){ge(t);let a=re(3);return Ut(a.collate.title,i)||(a.collate.title=i),me(i)}),q()(),G(3,"button",18),ue("click",function(){ge(t);let i=re(3);return me(i.toggleEditTitle())}),G(4,"mat-icon"),ae(5,"save"),q()()()}if(r&2){let t=re(3);Z(2),Wt("ngModel",t.collate.title)}}function r_(r,e){if(r&1){let t=Oe();G(0,"div",19),ue("click",function(){ge(t);let i=re(3);return me(i.toggleEditGreeting())}),ae(1),q()}if(r&2){let t=re(3);Z(),rt(t.collate.greeting)}}function n_(r,e){if(r&1){let t=Oe();G(0,"div")(1,"mat-form-field",20)(2,"input",17),ue("keydown.enter",function(){ge(t);let i=re(3);return me(i.toggleEditGreeting())}),Kt("ngModelChange",function(i){ge(t);let a=re(3);return Ut(a.collate.greeting,i)||(a.collate.greeting=i),me(i)}),q()(),G(3,"button",18),ue("click",function(){ge(t);let i=re(3);return me(i.toggleEditGreeting())}),G(4,"mat-icon"),ae(5,"save"),q()()()}if(r&2){let t=re(3);Z(2),Wt("ngModel",t.collate.greeting)}}function i_(r,e){if(r&1&&(G(0,"div",9)(1,"div",13),Se(2,e_,3,1)(3,t_,6,1,"div")(4,r_,2,1,"div",14)(5,n_,6,1,"div"),q()()),r&2){let t=re(2);Z(2),Re(t.editTitle?3:2),Z(2),Re(t.editGreeting?5:4)}}function a_(r,e){if(r&1){let t=Oe();G(0,"div",1)(1,"button",21),ue("click",function(){ge(t);let i=re(2);return me(i.openCollateTagCreateDialog())}),ae(2,"Add Tag +"),q()(),G(3,"div",22)(4,"app-collate-tags",23),ue("collageTagsChange",function(i){ge(t);let a=re(2);return me(a.handleCollageTagsChange(i))}),q()()}if(r&2){let t=re(2);Z(4),pe("collageTags",t.collate.tags)}}function o_(r,e){if(r&1&&De(0,"mat-tab",25),r&2){let t=e.$implicit;pe("label",t)}}function s_(r,e){if(r&1){let t=Oe();G(0,"div",11)(1,"mat-tab-group",24),ue("selectedTabChange",function(){ge(t);let i=re(2);return me(i.filterDataBySearchTerm())}),Kt("selectedIndexChange",function(i){ge(t);let a=re(2);return Ut(a.selectedIndex,i)||(a.selectedIndex=i),me(i)}),We(2,o_,1,1,"mat-tab",25,Jr),q()()}if(r&2){let t=re(2);Z(),Wt("selectedIndex",t.selectedIndex),pe("mat-stretch-tabs",!1),Z(),Ue(t.searchTerms)}}function l_(r,e){if(r&1){let t=Oe();G(0,"app-collate-project-list",27),ue("deleteProject",function(i){ge(t);let a=re(4);return me(a.deleteProject(i))})("projectOrderChanged",function(i){ge(t);let a=re(4);return me(a.onProjectOrderChanged(i))}),q()}if(r&2){let t=re(4);pe("searchTerm",t.selectedSearchTerm)("projectConditionColorMap",t.collate.settings.projectConditionColorMap)("projects",t.projects)("filteredResults",t.filteredResults)("renameCondition",t.collate.settings.renameSampleCondition)}}function u_(r,e){if(r&1&&Se(0,l_,1,5,"app-collate-project-list",26),r&2){let t=re(3);Re(t.collate.settings.projectConditionColorMap&&t.collate.settings.renameSampleCondition?0:-1)}}function c_(r,e){if(r&1&&Se(0,u_,1,1),r&2){let t=re(2);Re(t.collate.settings?0:-1)}}function d_(r,e){if(r&1){let t=Oe();G(0,"mat-toolbar")(1,"mat-toolbar-row"),De(2,"span",2),Se(3,J2,2,1,"mat-checkbox",3),G(4,"button",4),ue("click",function(){ge(t);let i=re();return me(i.goToCollateView())}),G(5,"mat-icon"),ae(6,"visibility"),q()(),G(7,"button",5),ue("click",function(){ge(t);let i=re();return me(i.openProjectAddDialog())}),G(8,"mat-icon"),ae(9,"add"),q()(),G(10,"button",6),ue("click",function(){ge(t);let i=re();return me(i.updateCollate())}),G(11,"mat-icon"),ae(12,"save"),q()(),G(13,"button",7)(14,"mat-icon"),ae(15,"more_vert"),q()(),G(16,"mat-menu",null,0)(18,"button",8),ue("click",function(){ge(t);let i=re();return me(i.openReorderDialog())}),ae(19,"Reorder Analysis Groups"),q(),G(20,"button",8),ue("click",function(){ge(t);let i=re();return me(i.openVisibilityDialog())}),ae(21,"Change Analysis Group Visibility"),q(),G(22,"button",8),ue("click",function(){ge(t);let i=re();return me(i.openConditionColorEditorDialog())}),ae(23,"Set Condition Colors"),q(),G(24,"button",8),ue("click",function(){ge(t);let i=re();return me(i.openPlotSettings())}),ae(25,"Change Plot General Settings"),q(),G(26,"button",8),ue("click",function(){ge(t);let i=re();return me(i.openRenameConditionDialog())}),ae(27,"Rename Condition"),q()()()(),Se(28,i_,6,2,"div",9)(29,a_,5,1),G(30,"div",1)(31,"app-collate-search",10),ue("searchResultID",function(i){ge(t);let a=re();return me(a.getSearchFromID(i))}),q()(),Se(32,s_,4,2,"div",11)(33,c_,1,1)}if(r&2){let t=br(17),n=re();Z(3),Re(n.collate?3:-1),Z(10),pe("matMenuTriggerFor",t),Z(15),Re(n.collate?28:-1),Z(),Re(n.collate?29:-1),Z(2),pe("projects",n.projects),Z(),Re(n.searchTerms.length>0?32:-1),Z(),Re(n.collate?33:-1)}}function f_(r,e){r&1&&(G(0,"div",1)(1,"p"),ae(2," You do not have permission to edit this collate. "),q()())}var Uu=(()=>{class r{set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this._collate=n,this.accounts.getCollatePermissions(n.id).subscribe(i=>{this.canEdit=i.edit}),this.projects=n.projects,this._collate.settings||(this._collate.settings={projectOrder:this.projects.map(i=>i.id),analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),this._collate.settings.plotSettings||(this._collate.settings.plotSettings={}),n.settings.projectOrder){let i=this.projects.filter(a=>!n.settings.projectOrder.includes(a.id));this.projects=this.projects.filter(a=>n.settings.projectOrder.includes(a.id)),this.projects=this.projects.concat(i)}if(this.collate&&"showTags"in this.collate.settings&&(this.collate.settings.showTags=!1),this.collate?.settings.projectConditionColorMap)this.graph.projectConditionColorMap=this.collate.settings.projectConditionColorMap;else{this.collate.settings.projectConditionColorMap={};for(let i of this.projects)this.collate.settings.projectConditionColorMap[i.id]={}}if(!this.collate?.settings.renameSampleCondition){this.collate.settings.renameSampleCondition={};for(let i of this.projects)this.collate.settings.renameSampleCondition[i.id]={},this.web.getProjectUniqueConditions(i.id).subscribe(a=>{for(let o of a)this.collate.settings.renameSampleCondition[i.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)})}})}get collate(){return this._collate}set collate(t){this._collate=t}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,n,i,a,o,s,l){this.accounts=t,this.graph=n,this.router=i,this.snackBar=a,this.dialog=o,this.collateService=s,this.web=l,this._collate=null,this.canEdit=!1,this.projects=[],this.selectedIndex=0,this.editTitle=!1,this.editGreeting=!1,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this.searchTerms=[],this._selectedSearchTerm="",this.filteredResults={},this.removedTags=[]}openProjectAddDialog(){this.dialog.open(Uv).afterClosed().subscribe(n=>{n&&(this.projects=this.projects.concat(n),this.collate&&(this.collate.projects=this.projects,this.updateProjectOrder()))})}updateProjectOrder(){this._collate&&(this._collate.settings.projectOrder=this.projects.map(t=>t.id)),console.log(this.collate)}updateCollate(){this._collate&&this.collateService.updateCollate(this._collate.id,this._collate).subscribe(()=>{if(this.removedTags.length>0){let t=this.removedTags.map(n=>this.collateService.removeTagFromCollate(this._collate?.id,n.id));Zu(t).subscribe(()=>{this.showSnackBar("Collate saved successfully"),this.removedTags=[]})}else this.showSnackBar("Collate saved successfully")})}toggleEditTitle(){this.editTitle=!this.editTitle}toggleEditGreeting(){this.editGreeting=!this.editGreeting}saveTitle(){this.toggleEditTitle(),this.updateCollate()}saveGreeting(){this.toggleEditGreeting(),this.updateCollate()}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{console.log(n)}),this.web.getSearchResults(t,99999).subscribe(n=>{console.log(n.results),this.distributeSearchResults(n.results).then()})}associateAnalysisGroupsWithProjects(){return ot(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let i=n.project;this.projectAnalysisGroups[i]||(this.projectAnalysisGroups[i]=[]),this.projectAnalysisGroups[i].push(n),this.analysisGroupProjects[n.id]=this.projects.find(a=>a.id===i)})})}distributeSearchResults(t){return ot(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let i=n.analysis_group.id,a=this.analysisGroupProjects[i];a&&(this.searchResults[a.id]||(this.searchResults[a.id]=[]),this.searchResults[a.id].push(n))}),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(i=>i.search_term===this.selectedSearchTerm)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(n=>{let i=parseInt(n),a=this.collate?.settings.analysisGroupOrderMap[i];if(!t[i]||!a)return;let o=t[i].filter(s=>!a.includes(s.analysis_group.id));if(t[i]=t[i].filter(s=>a.includes(s.analysis_group.id)),t[i]=t[i].sort((s,l)=>a.indexOf(s.analysis_group.id)-a.indexOf(l.analysis_group.id)),t[i]=t[i].concat(o),this.collate?.settings?.projectAnalysisGroupVisibility){let s=this.collate?.settings.projectAnalysisGroupVisibility[i];t[i]=t[i].filter(l=>!s||!(l.analysis_group.id in s)?!0:s[l.analysis_group.id])}}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults()}onProjectOrderChanged(t){this.projects=t,this.updateProjectOrder()}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}deleteProject(t){this.projects=this.projects.filter(n=>n.id!==t.id),this.updateProjectOrder()}goToCollateView(){this._collate&&this.router.navigate(["/collate/view",this._collate.id])}onSearchResultsChange(t,n){this.filteredResults[n]=t,this.collate&&(this.collate.settings.analysisGroupOrderMap||(this.collate.settings.analysisGroupOrderMap={}),this.collate.settings.analysisGroupOrderMap[n]=t.map(i=>i.analysis_group.id),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{this.collate.settings.analysisGroupOrderMap[i]=Array.from(new Set(this.collate.settings.analysisGroupOrderMap[i]))}))}openVisibilityDialog(){let t=this.dialog.open(Go);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(o=>{i[o.project]||(i[o.project]=[]),i[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),l=this.collate?.settings.analysisGroupOrderMap[s];if(!l||!i[s])return;let u=i[s].filter(c=>!l.includes(c.id));i[s]=i[s].filter(c=>l.includes(c.id)),i[s]=i[s].sort((c,d)=>l.indexOf(c.id)-l.indexOf(d.id)),i[s]=i[s].concat(u)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects;let a={};this.collate?.settings?.projectAnalysisGroupVisibility&&(a=this.collate.settings.projectAnalysisGroupVisibility);for(let o in i){a[o]||(a[o]={});for(let s of i[o])s.id in a[o]||(a[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},a)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}openReorderDialog(){let t=this.dialog.open(Xv);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let i={};n.forEach(a=>{i[a.project]||(i[a.project]=[]),i[a.project].push(a)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let o=parseInt(a),s=this.collate?.settings.analysisGroupOrderMap[o];if(!s||!i[o])return;let l=i[o].filter(u=>!s.includes(u.id));i[o]=i[o].filter(u=>s.includes(u.id)),i[o]=i[o].sort((u,c)=>s.indexOf(u.id)-s.indexOf(c.id)),i[o]=i[o].concat(l)}),t.componentInstance.projectAnalysisGroupMap=i,t.componentInstance.projects=this.projects}),t.afterClosed().subscribe(n=>{this.projects=n.projects,this.updateProjectOrder(),this.projectAnalysisGroups=n.projectAnalysisGroupMap;let i={};Object.keys(this.projectAnalysisGroups).forEach(a=>{i[a]=this.projectAnalysisGroups[a].map(o=>o.id)}),this.collate&&(this.collate.settings.analysisGroupOrderMap=i,this.filteredResults=this.getFilteredSearchResults())})}openConditionColorEditorDialog(){let t=this.dialog.open(rp);t.componentInstance.projectConditionColorMap=this.collate?.settings?.projectConditionColorMap,t.componentInstance.projects=this.projects,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.projectConditionColorMap=n),this.graph.projectConditionColorMap=Object.assign({},n),this.filteredResults=this.getFilteredSearchResults(),this.graph.redrawTrigger.next(!0)})}openCollateTagCreateDialog(){this.dialog.open(np).afterClosed().subscribe(n=>{n&&n.name&&(n.existing&&n.id&&n.id!==-1?this.collateService.addTagToCollate(this.collate?.id,n.id).subscribe(i=>{this.collate&&this.collate.tags.push(i)}):this.collateService.createCollateTag(n.name).subscribe(i=>{this.collateService.addTagToCollate(this.collate?.id,i.id).subscribe(a=>{this.collate&&this.collate.tags.push(a)})}))})}handleCollageTagsChange(t){this.collate&&(this.removedTags=this.collate.tags.filter(n=>!t.includes(n)),this.collate.tags=t)}openRenameConditionDialog(){if(this.collate){let t=this.dialog.open(ip);t.componentInstance.projects=this.collate.projects,t.componentInstance.renameSampleCondition=this.collate.settings.renameSampleCondition,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.renameSampleCondition=Object.assign({},n),console.log(this.collate.settings.renameSampleCondition))})}}openPlotSettings(){if(this.collate){let t=this.dialog.open(ap);t.componentInstance.settings=this.collate.settings.plotSettings,t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.plotSettings=n,this.graph.plotSettings=n,this.graph.redrawTrigger.next(!0))})}}static{this.\u0275fac=function(n){return new(n||r)(be(zr),be(Bo),be(ai),be(Er),be(ui),be(Nr),be(er))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-editor"]],inputs:{collateId:"collateId"},decls:2,vars:1,consts:[["extraActionsMenu","matMenu"],[2,"display","flex","justify-content","center"],[1,"spacer"],[3,"ngModel"],["type","button","aria-label","View Collate","mat-icon-button","",3,"click"],["type","button","aria-label","Add Projects","mat-icon-button","",3,"click"],["type","button","aria-label","Update Collate","mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[3,"searchResultID","projects"],[2,"padding","20px"],[3,"ngModelChange","ngModel"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"],[3,"click"],[2,"font-size","2em","text-align","center","font-family","Roboto, Helvetica Neue, sans-serif","padding","5px"],["matInput","",3,"keydown.enter","ngModelChange","ngModel"],["mat-icon-button","",3,"click"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif",3,"click"],[2,"font-size","25px","text-align","center","font-family","'Roboto', 'Arial Narrow', sans-serif","padding","5px"],["mat-button","",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTagsChange","collageTags"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"label"],[3,"searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"],[3,"deleteProject","projectOrderChanged","searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"]],template:function(n,i){n&1&&Se(0,d_,34,7)(1,f_,3,0,"div",1),n&2&&Re(i.canEdit?0:1)},dependencies:[Co,dn,Xt,yo,hn,Yt,Et,fn,No,Ao,Po,Zt,Jt,jo,Io,Ro,Oo,ct,$o,ci],styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();var h_=[{component:jc,path:""},{component:tl,path:"view"},{component:tl,path:"view/:collateId"},{component:tl,path:"view/:collateId/:sessionId"},{component:Uu,path:"edit"},{component:Uu,path:"edit/:collateId"}],bk=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=Qa({type:r})}static{this.\u0275inj=Ka({imports:[ao,mc.forChild(h_)]})}}return r})();export{bk as CollateModule};
