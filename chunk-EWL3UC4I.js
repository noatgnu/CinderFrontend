import{a as be}from"./chunk-KC5VF5DP.js";import{a as xe}from"./chunk-2YSJ2WKS.js";import{a as we,b as Me,c as Ge,d as je,e as Ee,f as Pe}from"./chunk-WTPJFG62.js";import"./chunk-ZDUQ6FEO.js";import{a as X,b as Ae}from"./chunk-57D7YRBM.js";import"./chunk-DESBYMIC.js";import"./chunk-W7QCYLEC.js";import{a as Fe}from"./chunk-7ZXK4O3N.js";import{e as z,g as L}from"./chunk-WV7MVBY3.js";import{a as de,b as ue,c as fe,d as he,e as Ce,f as ge}from"./chunk-TR6UWPUI.js";import{a as K}from"./chunk-J77SK4ZO.js";import"./chunk-CPT4DPP3.js";import{c as U,g as Ie}from"./chunk-JZ4NOBN5.js";import{Aa as V,Ca as B,Ha as k,Ia as O,Ja as ve,Ka as J,L as pe,Ma as R,Q as Se,R as _e,ka as P,ma as M,oa as A,pa as I,ra as h,ta as F,ua as ye,wa as D,xa as T,ya as N}from"./chunk-75XGRW5Y.js";import"./chunk-HX3ESI56.js";import{l as W,p as me}from"./chunk-QJ2HU2ZW.js";import{Aa as v,Ba as x,Bb as c,Hb as b,Ia as ne,Jb as j,Kb as E,Lb as t,Mb as i,Nb as d,Rb as w,Ub as f,Wb as S,cd as le,ed as ce,f as Z,fb as s,gb as p,gc as r,hc as oe,ic as Q,ja as te,jc as ae,oc as _,p as ee,sa as g,sc as re,ta as ie,tc as se,xb as y}from"./chunk-TUTLJQZA.js";var ze=(n,m)=>m.id;function Le(n,m){if(n&1&&(t(0,"mat-list-option",5),r(1),i()),n&2){let e=m.$implicit;c("value",e),s(),oe(e.name)}}function Re(n,m){if(n&1&&(t(0,"mat-selection-list",3),j(1,Le,2,2,"mat-list-option",5,ze),i()),n&2){let e=S(2);c("multiple",!1),s(),E(e.analysisGroupQuery.results)}}function $e(n,m){if(n&1){let e=w();y(0,Re,3,1,"mat-selection-list",3),t(1,"mat-paginator",4),f("page",function(o){v(e);let l=S();return x(l.handlePageEvent(o))}),i()}if(n&2){let e=S();b(e.analysisGroupQuery.results.length>0?0:-1),s(),c("pageSize",e.analysisGroupPageSize)("length",e.analysisGroupQuery.count)("pageIndex",e.analysisGroupPageIndex)}}var Ne=(()=>{class n{constructor(e,a){this.fb=e,this.web=a,this.formAnalysisGroupSearch=this.fb.group({searchTerm:new h("",M.required),selectedAnalysisGroups:new h([])}),this.analysisGroupPageSize=5,this.analysisGroupPageIndex=0,this.analysisGroupQuery=void 0,this.selectedAnalysisGroups=new ne,this.formAnalysisGroupSearch.controls.searchTerm.valueChanges.subscribe(o=>{o&&this.web.getAnalysisGroups(void 0,this.analysisGroupPageSize,0,o).subscribe(l=>{this.analysisGroupQuery=l})}),this.formAnalysisGroupSearch.controls.selectedAnalysisGroups.valueChanges.subscribe(o=>{o&&this.selectedAnalysisGroups.emit(o)}),this.web.getAnalysisGroups(void 0,this.analysisGroupPageSize,0).subscribe(o=>{this.analysisGroupQuery=o})}handlePageEvent(e){let a=e.pageIndex*e.pageSize;this.analysisGroupPageIndex=e.pageIndex,this.web.getAnalysisGroups(void 0,this.analysisGroupPageSize,a,this.formAnalysisGroupSearch.value.searchTerm).subscribe(o=>{this.analysisGroupQuery=o})}static{this.\u0275fac=function(a){return new(a||n)(p(N),p(R))}}static{this.\u0275cmp=g({type:n,selectors:[["app-analysis-search"]],outputs:{selectedAnalysisGroups:"selectedAnalysisGroups"},standalone:!0,features:[_],decls:6,vars:2,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Analysis Group Name","type","search"],[3,"pageSize","length","pageIndex"],["formControlName","selectedAnalysisGroups",3,"multiple"],[3,"page","pageSize","length","pageIndex"],[3,"value"]],template:function(a,o){a&1&&(t(0,"form",0)(1,"mat-form-field"),d(2,"input",1),t(3,"mat-label"),r(4,"Search For Specific Analysis Groups"),i()(),y(5,$e,2,4,"mat-paginator",2),i()),a&2&&(c("formGroup",o.formAnalysisGroupSearch),s(5),b(o.analysisGroupQuery?5:-1))},dependencies:[V,F,P,A,I,D,T,L,z,J,B,k,O]})}}return n})();var Ue=(n,m)=>m.id;function Je(n,m){if(n&1&&(t(0,"mat-list-option",3),r(1),i()),n&2){let e=m.$implicit;c("value",e),s(),Q(" ",e.title," ")}}var Ve=(()=>{class n{constructor(e,a,o,l,C,Y){this.web=e,this.fb=a,this.snackBar=o,this.router=l,this.collateService=C,this.dialog=Y,this.collates=[],this.selectedCollate=null,this.limit=5,this.offset=0,this.totalCount=0,this.loading=!1,this.form=this.fb.group({query:[""],selected:new h(null)}),this.form.controls.selected.valueChanges.subscribe(G=>{G&&this.router.navigate([`/collate/view/${G[0].id}`]).then()}),this.web.updateFromLabGroupSelection.subscribe(G=>{G&&this.collateService.getCollates(this.limit,this.offset,this.form.controls.query.value,[]).subscribe(H=>{this.collates=H.results,this.totalCount=H.count})})}ngOnInit(){this.searchCollates()}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,"",[]).subscribe({next:e=>{this.collates=e.results,this.totalCount=e.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onSearchResults(e){this.collates=e.results,this.totalCount=e.count}onCollateSelect(e){this.selectedCollate=e.options[0].value}handlePageEvent(e){this.limit=e.pageSize,this.offset=e.pageIndex*this.limit,this.searchCollates()}static{this.\u0275fac=function(a){return new(a||n)(p(R),p(N),p(K),p(W),p(X),p(U))}}static{this.\u0275cmp=g({type:n,selectors:[["app-collate-search-main"]],standalone:!0,features:[_],decls:9,vars:4,consts:[[2,"display","flex","flex-direction","column",3,"formGroup"],["matInput","","placeholder","Search","type","search","formControlName","query"],["formControlName","selected",3,"multiple"],[3,"value"],[3,"page","length","pageSize"]],template:function(a,o){a&1&&(t(0,"form",0)(1,"mat-form-field"),d(2,"input",1),t(3,"mat-label"),r(4,"Search Term"),i()(),t(5,"mat-selection-list",2),j(6,Je,2,2,"mat-list-option",3,Ue),i(),t(8,"mat-paginator",4),f("page",function(C){return o.handlePageEvent(C)}),i()()),a&2&&(c("formGroup",o.form),s(5),c("multiple",!1),s(),E(o.collates),s(2),c("length",o.totalCount)("pageSize",o.limit))},dependencies:[z,L,J,k,V,F,P,A,I,D,T,O,B]})}}return n})();var Ke=(n,m)=>m.id;function Xe(n,m){if(n&1){let e=w();t(0,"mat-card-actions")(1,"button",20),f("click",function(){v(e);let o=S();return x(o.openCreateCollateDialog())}),r(2,"Create Collate"),i()()}}function Ye(n,m){if(n&1){let e=w();t(0,"mat-card-actions")(1,"button",20),f("click",function(){v(e);let o=S();return x(o.openProjectCreateDialog())}),r(2,"Create Project"),i()()}}function Ze(n,m){if(n&1){let e=w();t(0,"mat-card-actions")(1,"button",20),f("click",function(){v(e);let o=S();return x(o.openAnalysisGroupCreateDialog())}),r(2,"Create Analysis Group"),i()()}}function et(n,m){if(n&1){let e=w();t(0,"mat-list-option",22),f("click",function(){let o=v(e).$implicit,l=S(3);return x(l.selectSpecies(o))}),r(1),i()}if(n&2){let e=m.$implicit;c("value",e),s(),ae(" ",e.official_name," (",e.code,") ")}}function tt(n,m){if(n&1&&(t(0,"p"),r(1," Select an option from below: "),i(),t(2,"mat-selection-list",21),j(3,et,2,3,"mat-list-option",15,Ke),i()),n&2){let e=S();s(2),c("multiple",!1),s(),E(e)}}function it(n,m){n&1&&y(0,tt,5,1),n&2&&b(m.length>0?0:-1)}var Be=(()=>{class n{constructor(e,a,o,l,C,Y,G,H){this.collateService=e,this.router=a,this.accounts=o,this.web=l,this.dialog=C,this.fb=Y,this.sb=G,this.ws=H,this.projectCount=0,this.analysisGroupCount=0,this.form=this.fb.group({search:new h("",M.required),searchMode:new h("gene",M.required),foldChange:new h(.6,M.required),pValue:new h(1.31,M.required),projects:new h([]),species_name:new h("")}),this.pageSize=10,this.currentPage=0,this.speciesQueryBehaviorSubject=new ee([]),this.selectedSpecies=void 0,this.web.getProjectCount().subscribe(u=>{this.projectCount=u.count}),this.web.getAnalysisGroupCount().subscribe(u=>{this.analysisGroupCount=u.count}),this.form.controls.species_name.valueChanges.subscribe(u=>{u&&this.web.getSpecies(void 0,20,0,u).subscribe($=>{this.speciesQueryBehaviorSubject.next($.results)})}),this.ws.searchWSConnection?.subscribe(u=>{if(u&&u.type==="search_status")switch(u.status){case"complete":if(this.router.url.includes("collate"))return;this.router.navigate([`/search-session/${u.id}`]).then();break}}),this.web.updateFromLabGroupSelection.subscribe(u=>{u&&(this.web.getProjectCount().subscribe($=>{this.projectCount=$.count}),this.web.getAnalysisGroupCount().subscribe($=>{this.analysisGroupCount=$.count}))})}openProjectCreateDialog(){this.dialog.open(be).afterClosed().subscribe(a=>{a&&this.web.createProject(a.name,a.description).subscribe(o=>{this.web.getProjectCount().subscribe(l=>{this.projectCount=l.count}),window.open(`/#/project/${o.id}`,"_blank")})})}openAnalysisGroupCreateDialog(){let e=this.dialog.open(xe);e.componentInstance.enableProjectSelection=!0,e.afterClosed().subscribe(a=>{a&&(this.web.getAnalysisGroupCount().subscribe(o=>{this.analysisGroupCount=o.count}),window.open(`/#/analysis-group/${a.id}`,"_blank"))})}handleProjectSelection(e){e.length!==0&&this.router.navigate([`/project/${e[0].id}`]).then()}handleMultipleProjectSelection(e){this.form.controls.projects.setValue(e)}searchDatabase(){return Z(this,null,function*(){if(this.form.invalid)return;let e=[];if(this.form.value.projects){let a=yield this.web.getAnalysisGroupsFromProjects(this.form.value.projects).toPromise();if(a)for(let o of a)e.push(o.id)}this.form.value.search&&this.form.value.foldChange&&this.form.value.pValue&&this.form.value.searchMode&&this.web.createSearch(e,this.form.value.search,this.web.searchSessionID,this.form.value.foldChange,this.form.value.pValue,this.form.value.searchMode,this.selectedSpecies).subscribe(a=>{this.sb.open("Search queued","Dismiss",{duration:2e3})})})}handleAGSelection(e){e.length>0&&this.router.navigate([`/analysis-group/${e[0].id}`]).then()}selectSpecies(e){if(this.selectedSpecies===e){this.selectedSpecies=void 0;return}this.selectedSpecies=e}openCreateCollateDialog(){this.dialog.open(Ae).afterClosed().subscribe(a=>{a&&this.collateService.createCollate(a.title,a.greeting).subscribe(o=>{this.router.navigate([`/collate/edit/${o.id}`]).then(l=>console.log(l))})})}static{this.\u0275fac=function(a){return new(a||n)(p(X),p(W),p(Ie),p(R),p(U),p(N),p(K),p(Fe))}}static{this.\u0275cmp=g({type:n,selectors:[["app-banner"]],standalone:!0,features:[_],decls:112,vars:16,consts:[[2,"display","flex","flex-direction","row","justify-content","center","gap","20px","padding","20px","flex-wrap","wrap"],[2,"display","flex","flex-direction","column","gap","20px"],["appearance","outlined",2,"width","350px"],[2,"color","#ba0000"],["href","/#/collate"],["href","/#/project"],[3,"selectedProjects","multipleSelection"],["href","/#/analysis-group"],[3,"selectedAnalysisGroups"],[2,"display","flex","flex-direction","row","justify-content","center"],["appearance","outlined",2,"min-width","350px","width","100%"],["href","/#/search-session"],[2,"display","flex","flex-direction","column","gap","5px",3,"formGroup"],["matInput","","formControlName","search","placeholder","Search","type","search"],["formControlName","searchMode"],[3,"value"],["matInput","","formControlName","foldChange","type","number","placeholder","Log2 Fold Change"],["matInput","","formControlName","pValue","type","number","placeholder","P-Value"],["matInput","","type","search","formControlName","species_name","placeholder","Species Name"],[3,"selectedProjects","species","multipleSelection"],["mat-button","","type","button",3,"click"],[3,"multiple"],[3,"click","value"]],template:function(a,o){if(a&1&&(t(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-header")(4,"mat-card-title")(5,"span",3)(6,"mat-icon"),r(7,"lock"),i()(),t(8,"a",4)(9,"span",3),r(10,"Collate"),i()()(),t(11,"mat-card-subtitle"),r(12," Cinder Data Collate "),i()(),t(13,"mat-card-content"),d(14,"app-collate-search-main"),i(),y(15,Xe,3,0,"mat-card-actions"),i(),t(16,"mat-card",2)(17,"mat-card-header")(18,"mat-card-title")(19,"span",3)(20,"mat-icon"),r(21,"lock"),i()(),t(22,"a",5)(23,"span",3),r(24,"Project"),i()()(),t(25,"mat-card-subtitle"),r(26," Cinder Project Data "),i()(),t(27,"mat-card-content")(28,"p"),r(29),i(),t(30,"app-project-search",6),f("selectedProjects",function(C){return o.handleProjectSelection(C)}),i()(),y(31,Ye,3,0,"mat-card-actions"),i(),t(32,"mat-card",2)(33,"mat-card-header")(34,"mat-card-title")(35,"span",3)(36,"mat-icon"),r(37,"lock"),i()(),t(38,"a",7)(39,"span",3),r(40,"Analysis Groups"),i()()(),t(41,"mat-card-subtitle"),r(42," Project Assigned Analysis Groups "),i()(),t(43,"mat-card-content")(44,"p"),r(45),i(),t(46,"app-analysis-search",8),f("selectedAnalysisGroups",function(C){return o.handleAGSelection(C)}),i()(),y(47,Ze,3,0,"mat-card-actions"),i()(),t(48,"div",9)(49,"div")(50,"mat-card",10)(51,"mat-card-header")(52,"mat-card-title")(53,"span",3)(54,"mat-icon"),r(55,"lock_open"),i()(),t(56,"a",11)(57,"span",3),r(58,"Search"),i()()(),t(59,"mat-card-subtitle"),r(60," Search through the Cinder Database "),i()(),t(61,"mat-card-content")(62,"form",12)(63,"mat-form-field"),d(64,"input",13),t(65,"mat-label"),r(66,"Database Search Term"),i()(),t(67,"p")(68,"b"),r(69,"Search Multiple Terms"),i(),d(70,"br"),r(71," In order to search with multiple terms, enclose each term in single quotes and separate them with "),t(72,"b"),r(73,"OR"),i(),r(74,". "),i(),t(75,"mat-form-field")(76,"mat-select",14)(77,"mat-option",15),r(78," Full Text "),i(),t(79,"mat-option",15),r(80," UniProt Accession ID "),i(),t(81,"mat-option",15),r(82," Gene Names "),i(),t(83,"mat-option",15),r(84," Primary IDs "),i()(),t(85,"mat-label"),r(86,"Search Mode"),i()(),t(87,"mat-form-field"),d(88,"input",16),t(89,"mat-label"),r(90,"Log2 Fold Change Cutoff"),i()(),t(91,"mat-form-field"),d(92,"input",17),t(93,"mat-label"),r(94,"-Log10(P-Value) Cutoff"),i()(),t(95,"mat-form-field"),d(96,"input",18),t(97,"mat-label"),r(98,"Species Name Search"),i()(),y(99,it,1,1),re(100,"async"),i(),t(101,"mat-accordion")(102,"mat-expansion-panel")(103,"mat-expansion-panel-header")(104,"mat-panel-title"),r(105," Filter by Project "),i(),t(106,"mat-panel-description"),r(107," Optional "),i()(),t(108,"app-project-search",19),f("selectedProjects",function(C){return o.handleMultipleProjectSelection(C)}),i()()()(),t(109,"mat-card-actions")(110,"button",20),f("click",function(){return o.searchDatabase()}),r(111,"Search"),i()()()()()()),a&2){let l;s(15),b(o.accounts.loggedIn?15:-1),s(14),Q(" # of Projects: ",o.projectCount," "),s(),c("multipleSelection",!1),s(),b(o.accounts.loggedIn?31:-1),s(14),Q(" # of Analysis Groups: ",o.analysisGroupCount," "),s(2),b(o.accounts.loggedIn?47:-1),s(15),c("formGroup",o.form),s(15),c("value","full"),s(2),c("value","uniprot"),s(2),c("value","gene"),s(2),c("value","pi"),s(16),b((l=se(100,14,o.speciesQueryBehaviorSubject.asObservable()))?99:-1,l),s(9),c("species",o.selectedSpecies)("multipleSelection",!0)}},dependencies:[de,he,ue,ge,fe,Se,Ce,_e,we,V,F,P,ye,A,I,D,T,k,O,ve,B,pe,Pe,Me,Ee,je,Ge,Ne,le,L,z,Ve],styles:[".banner[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap;gap:20px;padding:20px}"]})}}return n})();var ke=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-footer"]],standalone:!0,features:[_],decls:4,vars:0,consts:[[1,"footer",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","20px"]],template:function(a,o){a&1&&(t(0,"div",0)(1,"div",1)(2,"p",2),r(3," MRC-PPU, University of Dundee. ASAP. "),i()()())}})}}return n})();var Oe=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-home"]],standalone:!0,features:[_],decls:9,vars:0,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(a,o){a&1&&(t(0,"div",0)(1,"div",1)(2,"h1"),r(3,"C|nder"),i(),d(4,"br"),t(5,"div",2),r(6,"Proteomics Data Indexer"),i()()(),d(7,"app-banner")(8,"app-footer"))},dependencies:[Be,ke],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return n})();var nt=[{path:"",component:Oe}],Ut=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=ie({type:n})}static{this.\u0275inj=te({imports:[ce,me.forChild(nt)]})}}return n})();export{Ut as HomeModule};
