import{a as Ge,b as Yt,c as Xt,d as Wt,e as Qt,f as Jt}from"./chunk-WIWBEIXQ.js";import{a as Ot}from"./chunk-ZDUQ6FEO.js";import{a as oe,b as Di,c as $e,d as me}from"./chunk-AO6VYA3B.js";import{a as Ke,b as qe,c as ze,d as Oe}from"./chunk-WQPCJQXQ.js";import{a as ne}from"./chunk-B35LYVIL.js";import{a as ce}from"./chunk-CXPDAQ4M.js";import{b as Ue,c as He}from"./chunk-5N7ML3KA.js";import{a as Ie,b as Te,c as ke,d as Ne,e as Ve,f as Le,g as Pe,h as Re,i as Be,j as je}from"./chunk-7ED5K4PA.js";import{a as Zt,b as te}from"./chunk-55HL7PJI.js";import{a as ee}from"./chunk-RFPKUZCU.js";import{a as zt,c as De,f as Ae,h as Fe}from"./chunk-EAYBXCPI.js";import{a as st,c as qt,d as ct,e as mt,f as pt,g as ie}from"./chunk-GGGOX3M6.js";import{Aa as W,Ca as Q,Ha as J,Ia as at,Ja as vt,Ka as Ee,L as lt,Na as Z,Q as bt,R as z,S as wt,ka as et,ma as N,oa as O,pa as Y,ra as M,sa as Se,ta as X,ua as Me,wa as it,xa as nt,ya as ot,za as Et}from"./chunk-W4VPRTPA.js";import{h as ve}from"./chunk-QJ2HU2ZW.js";import{A as xt,Aa as D,Ba as A,Bb as g,Hb as E,Ia as rt,Ib as V,Jb as I,Kb as T,L as de,Lb as r,Mb as l,Nb as R,Ob as Nt,Pb as Vt,Rb as B,Ub as w,Wb as _,Zb as Ut,_b as _e,ac as Ce,ba as fe,bb as se,bc as ye,ca as he,cc as ge,cd as Kt,e as Mi,f as kt,fb as p,fc as dt,gb as F,gc as s,hc as L,ic as K,kc as xe,lc as be,mc as we,oc as H,sa as U,sc as Ht,tc as $t,w as Dt,xb as G}from"./chunk-TUTLJQZA.js";var Fi=(e,o)=>o.id;function Ei(e,o){if(e&1){let t=B();r(0,"mat-list-option",1),w("click",function(){let n=D(t).$implicit,a=_(2);return A(a.selectAnalysisGroup(n))}),r(1,"b"),s(2),l(),r(3,"span",2),s(4),l()(),R(5,"mat-divider")}if(e&2){let t=o.$implicit,i=_(2);g("value",t),p(2),L(t.name),p(2),K(" ",i.dataService.getAnalysisGroupTypeLabel(t.analysis_group_type)," ")}}function Gi(e,o){if(e&1&&(r(0,"mat-selection-list",0),I(1,Ei,6,3,null,null,Fi),l()),e&2){let t=_();g("multiple",!1),p(),T(t.analysisGroupQuery.results)}}var Ro=(()=>{class e{constructor(t){this.dataService=t,this.selectedAnalysisGroup=new rt}selectAnalysisGroup(t){this.selectedAnalysisGroup.emit(t)}static{this.\u0275fac=function(i){return new(i||e)(F(Ot))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-list"]],inputs:{analysisGroupQuery:"analysisGroupQuery"},outputs:{selectedAnalysisGroup:"selectedAnalysisGroup"},standalone:!0,features:[H],decls:1,vars:1,consts:[[3,"multiple"],[3,"click","value"],["matListItemLine",""]],template:function(i,n){i&1&&G(0,Gi,3,1,"mat-selection-list",0),i&2&&E(n.analysisGroupQuery?0:-1)},dependencies:[zt,Ae,Fe,De]})}}return e})();var oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ai="ARRAYBUFFER not supported by this environment",ri="UINT8ARRAY not supported by this environment";function Ye(e,o,t,i){let n,a,c,f=o||[0],u=(t=t||0)>>>3,h=i===-1?3:0;for(n=0;n<e.length;n+=1)c=n+u,a=c>>>2,f.length<=a&&f.push(0),f[a]|=e[n]<<8*(h+i*(c%4));return{value:f,binLen:8*e.length+t}}function Tt(e,o,t){switch(o){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(i,n,a){return function(c,f,u,h){let C,d,y,v;if(c.length%2!=0)throw new Error("String of HEX type must be in byte increments");let S=f||[0],k=(u=u||0)>>>3,P=h===-1?3:0;for(C=0;C<c.length;C+=2){if(d=parseInt(c.substr(C,2),16),isNaN(d))throw new Error("String of HEX type contains invalid characters");for(v=(C>>>1)+k,y=v>>>2;S.length<=y;)S.push(0);S[y]|=d<<8*(P+h*(v%4))}return{value:S,binLen:4*c.length+u}}(i,n,a,t)};case"TEXT":return function(i,n,a){return function(c,f,u,h,C){let d,y,v,S,k,P,x,$,j=0,q=u||[0],ut=(h=h||0)>>>3;if(f==="UTF8")for(x=C===-1?3:0,v=0;v<c.length;v+=1)for(d=c.charCodeAt(v),y=[],128>d?y.push(d):2048>d?(y.push(192|d>>>6),y.push(128|63&d)):55296>d||57344<=d?y.push(224|d>>>12,128|d>>>6&63,128|63&d):(v+=1,d=65536+((1023&d)<<10|1023&c.charCodeAt(v)),y.push(240|d>>>18,128|d>>>12&63,128|d>>>6&63,128|63&d)),S=0;S<y.length;S+=1){for(P=j+ut,k=P>>>2;q.length<=k;)q.push(0);q[k]|=y[S]<<8*(x+C*(P%4)),j+=1}else for(x=C===-1?2:0,$=f==="UTF16LE"&&C!==1||f!=="UTF16LE"&&C===1,v=0;v<c.length;v+=1){for(d=c.charCodeAt(v),$===!0&&(S=255&d,d=S<<8|d>>>8),P=j+ut,k=P>>>2;q.length<=k;)q.push(0);q[k]|=d<<8*(x+C*(P%4)),j+=2}return{value:q,binLen:8*j+h}}(i,o,n,a,t)};case"B64":return function(i,n,a){return function(c,f,u,h){let C,d,y,v,S,k,P,x=0,$=f||[0],j=(u=u||0)>>>3,q=h===-1?3:0,ut=c.indexOf("=");if(c.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(c=c.replace(/=/g,""),ut!==-1&&ut<c.length)throw new Error("Invalid '=' found in base-64 string");for(d=0;d<c.length;d+=4){for(S=c.substr(d,4),v=0,y=0;y<S.length;y+=1)C=oi.indexOf(S.charAt(y)),v|=C<<18-6*y;for(y=0;y<S.length-1;y+=1){for(P=x+j,k=P>>>2;$.length<=k;)$.push(0);$[k]|=(v>>>16-8*y&255)<<8*(q+h*(P%4)),x+=1}}return{value:$,binLen:8*x+u}}(i,n,a,t)};case"BYTES":return function(i,n,a){return function(c,f,u,h){let C,d,y,v,S=f||[0],k=(u=u||0)>>>3,P=h===-1?3:0;for(d=0;d<c.length;d+=1)C=c.charCodeAt(d),v=d+k,y=v>>>2,S.length<=y&&S.push(0),S[y]|=C<<8*(P+h*(v%4));return{value:S,binLen:8*c.length+u}}(i,n,a,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ai)}return function(i,n,a){return function(c,f,u,h){return Ye(new Uint8Array(c),f,u,h)}(i,n,a,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ri)}return function(i,n,a){return Ye(i,n,a,t)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function Xe(e,o,t,i){switch(e){case"HEX":return function(n){return function(a,c,f,u){let h="0123456789abcdef",C,d,y="",v=c/8,S=f===-1?3:0;for(C=0;C<v;C+=1)d=a[C>>>2]>>>8*(S+f*(C%4)),y+=h.charAt(d>>>4&15)+h.charAt(15&d);return u.outputUpper?y.toUpperCase():y}(n,o,t,i)};case"B64":return function(n){return function(a,c,f,u){let h,C,d,y,v,S="",k=c/8,P=f===-1?3:0;for(h=0;h<k;h+=3)for(y=h+1<k?a[h+1>>>2]:0,v=h+2<k?a[h+2>>>2]:0,d=(a[h>>>2]>>>8*(P+f*(h%4))&255)<<16|(y>>>8*(P+f*((h+1)%4))&255)<<8|v>>>8*(P+f*((h+2)%4))&255,C=0;C<4;C+=1)S+=8*h+6*C<=c?oi.charAt(d>>>6*(3-C)&63):u.b64Pad;return S}(n,o,t,i)};case"BYTES":return function(n){return function(a,c,f){let u,h,C="",d=c/8,y=f===-1?3:0;for(u=0;u<d;u+=1)h=a[u>>>2]>>>8*(y+f*(u%4))&255,C+=String.fromCharCode(h);return C}(n,o,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(ai)}return function(n){return function(a,c,f){let u,h=c/8,C=new ArrayBuffer(h),d=new Uint8Array(C),y=f===-1?3:0;for(u=0;u<h;u+=1)d[u]=a[u>>>2]>>>8*(y+f*(u%4))&255;return C}(n,o,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(ri)}return function(n){return function(a,c,f){let u,h=c/8,C=f===-1?3:0,d=new Uint8Array(h);for(u=0;u<h;u+=1)d[u]=a[u>>>2]>>>8*(C+f*(u%4))&255;return d}(n,o,t)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var Rt=4294967296,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],yt=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],gt=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Bt="Chosen SHA variant is not supported",li="Cannot set numRounds with MAC";function re(e,o){let t,i,n=e.binLen>>>3,a=o.binLen>>>3,c=n<<3,f=4-n<<3;if(n%4!=0){for(t=0;t<a;t+=4)i=n+t>>>2,e.value[i]|=o.value[t>>>2]<<c,e.value.push(0),e.value[i+1]|=o.value[t>>>2]>>>f;return(e.value.length<<2)-4>=a+n&&e.value.pop(),{value:e.value,binLen:e.binLen+o.binLen}}return{value:e.value.concat(o.value),binLen:e.binLen+o.binLen}}function We(e){let o={outputUpper:!1,b64Pad:"=",outputLen:-1},t=e||{},i="Output length must be a multiple of 8";if(o.outputUpper=t.outputUpper||!1,t.b64Pad&&(o.b64Pad=t.b64Pad),t.outputLen){if(t.outputLen%8!=0)throw new Error(i);o.outputLen=t.outputLen}else if(t.shakeLen){if(t.shakeLen%8!=0)throw new Error(i);o.outputLen=t.shakeLen}if(typeof o.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof o.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return o}function St(e,o,t,i){let n=e+" must include a value and format";if(!o){if(!i)throw new Error(n);return i}if(o.value===void 0||!o.format)throw new Error(n);return Tt(o.format,o.encoding||"UTF8",t)(o.value)}var It=class{constructor(o,t,i){let n=i||{};if(this.t=t,this.i=n.encoding||"UTF8",this.numRounds=n.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=o,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(o){let t,i=0,n=this.m>>>5,a=this.C(o,this.h,this.u),c=a.binLen,f=a.value,u=c>>>5;for(t=0;t<u;t+=n)i+this.m<=c&&(this.U=this.v(f.slice(t,t+n),this.U),i+=this.m);return this.A+=i,this.h=f.slice(i>>>5),this.u=c%this.m,this.l=!0,this}getHash(o,t){let i,n,a=this.R,c=We(t);if(this.K){if(c.outputLen===-1)throw new Error("Output length must be specified in options");a=c.outputLen}let f=Xe(o,a,this.T,c);if(this.H&&this.g)return f(this.g(c));for(n=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),i=1;i<this.numRounds;i+=1)this.K&&a%32!=0&&(n[n.length-1]&=16777215>>>24-a%32),n=this.F(n,a,0,this.B(this.o),a);return f(n)}setHMACKey(o,t,i){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");let n=Tt(t,(i||{}).encoding||"UTF8",this.T);this.k(n(o))}k(o){let t=this.m>>>3,i=t/4-1,n;if(this.numRounds!==1)throw new Error(li);if(this.H)throw new Error("MAC key already set");for(t<o.binLen/8&&(o.value=this.F(o.value,o.binLen,0,this.B(this.o),this.R));o.value.length<=i;)o.value.push(0);for(n=0;n<=i;n+=1)this.S[n]=909522486^o.value[n],this.p[n]=1549556828^o.value[n];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(o,t){let i=We(t);return Xe(o,this.R,this.T,i)(this.Y())}Y(){let o;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");let t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return o=this.v(this.p,this.B(this.o)),o=this.F(t,this.R,this.m,o,this.R),o}};function Gt(e,o){return e<<o|e>>>32-o}function _t(e,o){return e>>>o|e<<32-o}function si(e,o){return e>>>o}function Qe(e,o,t){return e^o^t}function ci(e,o,t){return e&o^~e&t}function mi(e,o,t){return e&o^e&t^o&t}function Ii(e){return _t(e,2)^_t(e,13)^_t(e,22)}function tt(e,o){let t=(65535&e)+(65535&o);return(65535&(e>>>16)+(o>>>16)+(t>>>16))<<16|65535&t}function Ti(e,o,t,i){let n=(65535&e)+(65535&o)+(65535&t)+(65535&i);return(65535&(e>>>16)+(o>>>16)+(t>>>16)+(i>>>16)+(n>>>16))<<16|65535&n}function Pt(e,o,t,i,n){let a=(65535&e)+(65535&o)+(65535&t)+(65535&i)+(65535&n);return(65535&(e>>>16)+(o>>>16)+(t>>>16)+(i>>>16)+(n>>>16)+(a>>>16))<<16|65535&a}function ki(e){return _t(e,7)^_t(e,18)^si(e,3)}function Ni(e){return _t(e,6)^_t(e,11)^_t(e,25)}function Vi(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function pi(e,o){let t,i,n,a,c,f,u,h=[];for(t=o[0],i=o[1],n=o[2],a=o[3],c=o[4],u=0;u<80;u+=1)h[u]=u<16?e[u]:Gt(h[u-3]^h[u-8]^h[u-14]^h[u-16],1),f=u<20?Pt(Gt(t,5),ci(i,n,a),c,1518500249,h[u]):u<40?Pt(Gt(t,5),Qe(i,n,a),c,1859775393,h[u]):u<60?Pt(Gt(t,5),mi(i,n,a),c,2400959708,h[u]):Pt(Gt(t,5),Qe(i,n,a),c,3395469782,h[u]),c=a,a=n,n=Gt(i,30),i=t,t=f;return o[0]=tt(t,o[0]),o[1]=tt(i,o[1]),o[2]=tt(n,o[2]),o[3]=tt(a,o[3]),o[4]=tt(c,o[4]),o}function Li(e,o,t,i){let n,a=15+(o+65>>>9<<4),c=o+t;for(;e.length<=a;)e.push(0);for(e[o>>>5]|=128<<24-o%32,e[a]=4294967295&c,e[a-1]=c/Rt|0,n=0;n<e.length;n+=16)i=pi(e.slice(n,n+16),i);return i}var Pi=class extends It{constructor(e,o,t){if(e!=="SHA-1")throw new Error(Bt);super(e,o,t);let i=t||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=Tt(this.t,this.i,this.T),this.v=pi,this.L=function(n){return n.slice()},this.B=Vi,this.F=Li,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,i.hmacKey&&this.k(St("hmacKey",i.hmacKey,this.T))}};function Je(e){let o;return o=e=="SHA-224"?yt.slice():gt.slice(),o}function Ze(e,o){let t,i,n,a,c,f,u,h,C,d,y,v=[];for(t=o[0],i=o[1],n=o[2],a=o[3],c=o[4],f=o[5],u=o[6],h=o[7],y=0;y<64;y+=1)v[y]=y<16?e[y]:Ti(_t(S=v[y-2],17)^_t(S,19)^si(S,10),v[y-7],ki(v[y-15]),v[y-16]),C=Pt(h,Ni(c),ci(c,f,u),b[y],v[y]),d=tt(Ii(t),mi(t,i,n)),h=u,u=f,f=c,c=tt(a,C),a=n,n=i,i=t,t=tt(C,d);var S;return o[0]=tt(t,o[0]),o[1]=tt(i,o[1]),o[2]=tt(n,o[2]),o[3]=tt(a,o[3]),o[4]=tt(c,o[4]),o[5]=tt(f,o[5]),o[6]=tt(u,o[6]),o[7]=tt(h,o[7]),o}var Ri=class extends It{constructor(e,o,t){if(e!=="SHA-224"&&e!=="SHA-256")throw new Error(Bt);super(e,o,t);let i=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Tt(this.t,this.i,this.T),this.v=Ze,this.L=function(n){return n.slice()},this.B=Je,this.F=function(n,a,c,f){return function(u,h,C,d,y){let v,S,k=15+(h+65>>>9<<4),P=h+C;for(;u.length<=k;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[k]=4294967295&P,u[k-1]=P/Rt|0,v=0;v<u.length;v+=16)d=Ze(u.slice(v,v+16),d);return S=y==="SHA-224"?[d[0],d[1],d[2],d[3],d[4],d[5],d[6]]:d,S}(n,a,c,f,e)},this.U=Je(e),this.m=512,this.R=e==="SHA-224"?224:256,this.K=!1,i.hmacKey&&this.k(St("hmacKey",i.hmacKey,this.T))}},m=class{constructor(o,t){this.N=o,this.I=t}};function ti(e,o){let t;return o>32?(t=64-o,new m(e.I<<o|e.N>>>t,e.N<<o|e.I>>>t)):o!==0?(t=32-o,new m(e.N<<o|e.I>>>t,e.I<<o|e.N>>>t)):e}function Ct(e,o){let t;return o<32?(t=32-o,new m(e.N>>>o|e.I<<t,e.I>>>o|e.N<<t)):(t=64-o,new m(e.I>>>o|e.N<<t,e.N>>>o|e.I<<t))}function ui(e,o){return new m(e.N>>>o,e.I>>>o|e.N<<32-o)}function Bi(e,o,t){return new m(e.N&o.N^e.N&t.N^o.N&t.N,e.I&o.I^e.I&t.I^o.I&t.I)}function ji(e){let o=Ct(e,28),t=Ct(e,34),i=Ct(e,39);return new m(o.N^t.N^i.N,o.I^t.I^i.I)}function ft(e,o){let t,i;t=(65535&e.I)+(65535&o.I),i=(e.I>>>16)+(o.I>>>16)+(t>>>16);let n=(65535&i)<<16|65535&t;return t=(65535&e.N)+(65535&o.N)+(i>>>16),i=(e.N>>>16)+(o.N>>>16)+(t>>>16),new m((65535&i)<<16|65535&t,n)}function Ui(e,o,t,i){let n,a;n=(65535&e.I)+(65535&o.I)+(65535&t.I)+(65535&i.I),a=(e.I>>>16)+(o.I>>>16)+(t.I>>>16)+(i.I>>>16)+(n>>>16);let c=(65535&a)<<16|65535&n;return n=(65535&e.N)+(65535&o.N)+(65535&t.N)+(65535&i.N)+(a>>>16),a=(e.N>>>16)+(o.N>>>16)+(t.N>>>16)+(i.N>>>16)+(n>>>16),new m((65535&a)<<16|65535&n,c)}function Hi(e,o,t,i,n){let a,c;a=(65535&e.I)+(65535&o.I)+(65535&t.I)+(65535&i.I)+(65535&n.I),c=(e.I>>>16)+(o.I>>>16)+(t.I>>>16)+(i.I>>>16)+(n.I>>>16)+(a>>>16);let f=(65535&c)<<16|65535&a;return a=(65535&e.N)+(65535&o.N)+(65535&t.N)+(65535&i.N)+(65535&n.N)+(c>>>16),c=(e.N>>>16)+(o.N>>>16)+(t.N>>>16)+(i.N>>>16)+(n.N>>>16)+(a>>>16),new m((65535&c)<<16|65535&a,f)}function Lt(e,o){return new m(e.N^o.N,e.I^o.I)}function $i(e){let o=Ct(e,19),t=Ct(e,61),i=ui(e,6);return new m(o.N^t.N^i.N,o.I^t.I^i.I)}function Ki(e){let o=Ct(e,1),t=Ct(e,8),i=ui(e,7);return new m(o.N^t.N^i.N,o.I^t.I^i.I)}function qi(e){let o=Ct(e,14),t=Ct(e,18),i=Ct(e,41);return new m(o.N^t.N^i.N,o.I^t.I^i.I)}var zi=[new m(b[0],3609767458),new m(b[1],602891725),new m(b[2],3964484399),new m(b[3],2173295548),new m(b[4],4081628472),new m(b[5],3053834265),new m(b[6],2937671579),new m(b[7],3664609560),new m(b[8],2734883394),new m(b[9],1164996542),new m(b[10],1323610764),new m(b[11],3590304994),new m(b[12],4068182383),new m(b[13],991336113),new m(b[14],633803317),new m(b[15],3479774868),new m(b[16],2666613458),new m(b[17],944711139),new m(b[18],2341262773),new m(b[19],2007800933),new m(b[20],1495990901),new m(b[21],1856431235),new m(b[22],3175218132),new m(b[23],2198950837),new m(b[24],3999719339),new m(b[25],766784016),new m(b[26],2566594879),new m(b[27],3203337956),new m(b[28],1034457026),new m(b[29],2466948901),new m(b[30],3758326383),new m(b[31],168717936),new m(b[32],1188179964),new m(b[33],1546045734),new m(b[34],1522805485),new m(b[35],2643833823),new m(b[36],2343527390),new m(b[37],1014477480),new m(b[38],1206759142),new m(b[39],344077627),new m(b[40],1290863460),new m(b[41],3158454273),new m(b[42],3505952657),new m(b[43],106217008),new m(b[44],3606008344),new m(b[45],1432725776),new m(b[46],1467031594),new m(b[47],851169720),new m(b[48],3100823752),new m(b[49],1363258195),new m(b[50],3750685593),new m(b[51],3785050280),new m(b[52],3318307427),new m(b[53],3812723403),new m(b[54],2003034995),new m(b[55],3602036899),new m(b[56],1575990012),new m(b[57],1125592928),new m(b[58],2716904306),new m(b[59],442776044),new m(b[60],593698344),new m(b[61],3733110249),new m(b[62],2999351573),new m(b[63],3815920427),new m(3391569614,3928383900),new m(3515267271,566280711),new m(3940187606,3454069534),new m(4118630271,4000239992),new m(116418474,1914138554),new m(174292421,2731055270),new m(289380356,3203993006),new m(460393269,320620315),new m(685471733,587496836),new m(852142971,1086792851),new m(1017036298,365543100),new m(1126000580,2618297676),new m(1288033470,3409855158),new m(1501505948,4234509866),new m(1607167915,987167468),new m(1816402316,1246189591)];function ei(e){return e==="SHA-384"?[new m(3418070365,yt[0]),new m(1654270250,yt[1]),new m(2438529370,yt[2]),new m(355462360,yt[3]),new m(1731405415,yt[4]),new m(41048885895,yt[5]),new m(3675008525,yt[6]),new m(1203062813,yt[7])]:[new m(gt[0],4089235720),new m(gt[1],2227873595),new m(gt[2],4271175723),new m(gt[3],1595750129),new m(gt[4],2917565137),new m(gt[5],725511199),new m(gt[6],4215389547),new m(gt[7],327033209)]}function ii(e,o){let t,i,n,a,c,f,u,h,C,d,y,v,S=[];for(t=o[0],i=o[1],n=o[2],a=o[3],c=o[4],f=o[5],u=o[6],h=o[7],y=0;y<80;y+=1)y<16?(v=2*y,S[y]=new m(e[v],e[v+1])):S[y]=Ui($i(S[y-2]),S[y-7],Ki(S[y-15]),S[y-16]),C=Hi(h,qi(c),(P=f,x=u,new m((k=c).N&P.N^~k.N&x.N,k.I&P.I^~k.I&x.I)),zi[y],S[y]),d=ft(ji(t),Bi(t,i,n)),h=u,u=f,f=c,c=ft(a,C),a=n,n=i,i=t,t=ft(C,d);var k,P,x;return o[0]=ft(t,o[0]),o[1]=ft(i,o[1]),o[2]=ft(n,o[2]),o[3]=ft(a,o[3]),o[4]=ft(c,o[4]),o[5]=ft(f,o[5]),o[6]=ft(u,o[6]),o[7]=ft(h,o[7]),o}var Oi=class extends It{constructor(e,o,t){if(e!=="SHA-384"&&e!=="SHA-512")throw new Error(Bt);super(e,o,t);let i=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Tt(this.t,this.i,this.T),this.v=ii,this.L=function(n){return n.slice()},this.B=ei,this.F=function(n,a,c,f){return function(u,h,C,d,y){let v,S,k=31+(h+129>>>10<<5),P=h+C;for(;u.length<=k;)u.push(0);for(u[h>>>5]|=128<<24-h%32,u[k]=4294967295&P,u[k-1]=P/Rt|0,v=0;v<u.length;v+=32)d=ii(u.slice(v,v+32),d);return S=y==="SHA-384"?[d[0].N,d[0].I,d[1].N,d[1].I,d[2].N,d[2].I,d[3].N,d[3].I,d[4].N,d[4].I,d[5].N,d[5].I]:[d[0].N,d[0].I,d[1].N,d[1].I,d[2].N,d[2].I,d[3].N,d[3].I,d[4].N,d[4].I,d[5].N,d[5].I,d[6].N,d[6].I,d[7].N,d[7].I],S}(n,a,c,f,e)},this.U=ei(e),this.m=1024,this.R=e==="SHA-384"?384:512,this.K=!1,i.hmacKey&&this.k(St("hmacKey",i.hmacKey,this.T))}},Yi=[new m(0,1),new m(0,32898),new m(2147483648,32906),new m(2147483648,2147516416),new m(0,32907),new m(0,2147483649),new m(2147483648,2147516545),new m(2147483648,32777),new m(0,138),new m(0,136),new m(0,2147516425),new m(0,2147483658),new m(0,2147516555),new m(2147483648,139),new m(2147483648,32905),new m(2147483648,32771),new m(2147483648,32770),new m(2147483648,128),new m(0,32778),new m(2147483648,2147483658),new m(2147483648,2147516545),new m(2147483648,32896),new m(0,2147483649),new m(2147483648,2147516424)],Xi=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function ue(e){let o,t=[];for(o=0;o<5;o+=1)t[o]=[new m(0,0),new m(0,0),new m(0,0),new m(0,0),new m(0,0)];return t}function Wi(e){let o,t=[];for(o=0;o<5;o+=1)t[o]=e[o].slice();return t}function ae(e,o){let t,i,n,a,c=[],f=[];if(e!==null)for(i=0;i<e.length;i+=2)o[(i>>>1)%5][(i>>>1)/5|0]=Lt(o[(i>>>1)%5][(i>>>1)/5|0],new m(e[i+1],e[i]));for(t=0;t<24;t+=1){for(a=ue(),i=0;i<5;i+=1)c[i]=(u=o[i][0],h=o[i][1],C=o[i][2],d=o[i][3],y=o[i][4],new m(u.N^h.N^C.N^d.N^y.N,u.I^h.I^C.I^d.I^y.I));for(i=0;i<5;i+=1)f[i]=Lt(c[(i+4)%5],ti(c[(i+1)%5],1));for(i=0;i<5;i+=1)for(n=0;n<5;n+=1)o[i][n]=Lt(o[i][n],f[i]);for(i=0;i<5;i+=1)for(n=0;n<5;n+=1)a[n][(2*i+3*n)%5]=ti(o[i][n],Xi[i][n]);for(i=0;i<5;i+=1)for(n=0;n<5;n+=1)o[i][n]=Lt(a[i][n],new m(~a[(i+1)%5][n].N&a[(i+2)%5][n].N,~a[(i+1)%5][n].I&a[(i+2)%5][n].I));o[0][0]=Lt(o[0][0],Yi[t])}var u,h,C,d,y;return o}function di(e){let o,t,i=0,n=[0,0],a=[4294967295&e,e/Rt&2097151];for(o=6;o>=0;o--)t=a[o>>2]>>>8*o&255,t===0&&i===0||(n[i+1>>2]|=t<<8*(i+1),i+=1);return i=i!==0?i:1,n[0]|=i,{value:i+1>4?n:[n[0]],binLen:8+8*i}}function pe(e){return re(di(e.binLen),e)}function ni(e,o){let t,i=di(o);i=re(i,e);let n=o>>>2,a=(n-i.value.length%n)%n;for(t=0;t<a;t++)i.value.push(0);return i.value}var Qi=class extends It{constructor(e,o,t){let i=6,n=0;super(e,o,t);let a=t||{};if(this.numRounds!==1){if(a.kmacKey||a.hmacKey)throw new Error(li);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=Tt(this.t,this.i,this.T),this.v=ae,this.L=Wi,this.B=ue,this.U=ue(),this.K=!1,e){case"SHA3-224":this.m=n=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=n=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=n=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=n=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":i=31,this.m=n=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":i=31,this.m=n=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":i=4,this.m=n=1344,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":i=4,this.m=n=1088,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=n=1344,i=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=n=1088,i=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(Bt)}this.F=function(c,f,u,h,C){return function(d,y,v,S,k,P,x){let $,j,q=0,ut=[],jt=k>>>5,Si=y>>>5;for($=0;$<Si&&y>=k;$+=jt)S=ae(d.slice($,$+jt),S),y-=k;for(d=d.slice($),y%=k;d.length<jt;)d.push(0);for($=y>>>3,d[$>>2]^=P<<$%4*8,d[jt-1]^=2147483648,S=ae(d,S);32*ut.length<x&&(j=S[q%5][q/5|0],ut.push(j.I),!(32*ut.length>=x));)ut.push(j.N),q+=1,64*q%k==0&&(ae(null,S),q=0);return ut}(c,f,0,h,n,i,C)},a.hmacKey&&this.k(St("hmacKey",a.hmacKey,this.T))}O(e,o){let t=function(n){let a=n||{};return{funcName:St("funcName",a.funcName,1,{value:[],binLen:0}),customization:St("Customization",a.customization,1,{value:[],binLen:0})}}(e||{});o&&(t.funcName=o);let i=re(pe(t.funcName),pe(t.customization));if(t.customization.binLen!==0||t.funcName.binLen!==0){let n=ni(i,this.m>>>3);for(let a=0;a<n.length;a+=this.m>>>5)this.U=this.v(n.slice(a,a+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(e){let o=function(i){let n=i||{};return{kmacKey:St("kmacKey",n.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:St("Customization",n.customization,1,{value:[],binLen:0})}}(e||{});this.O(e,o.funcName);let t=ni(pe(o.kmacKey),this.m>>>3);for(let i=0;i<t.length;i+=this.m>>>5)this.U=this.v(t.slice(i,i+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(e){let o=re({value:this.h.slice(),binLen:this.u},function(t){let i,n,a=0,c=[0,0],f=[4294967295&t,t/Rt&2097151];for(i=6;i>=0;i--)n=f[i>>2]>>>8*i&255,n===0&&a===0||(c[a>>2]|=n<<8*a,a+=1);return a=a!==0?a:1,c[a>>2]|=a<<8*a,{value:a+1>4?c:[c[0]],binLen:8+8*a}}(e.outputLen));return this.F(o.value,o.binLen,this.A,this.L(this.U),e.outputLen)}},le=class{constructor(o,t,i){if(o=="SHA-1")this.P=new Pi(o,t,i);else if(o=="SHA-224"||o=="SHA-256")this.P=new Ri(o,t,i);else if(o=="SHA-384"||o=="SHA-512")this.P=new Oi(o,t,i);else{if(o!="SHA3-224"&&o!="SHA3-256"&&o!="SHA3-384"&&o!="SHA3-512"&&o!="SHAKE128"&&o!="SHAKE256"&&o!="CSHAKE128"&&o!="CSHAKE256"&&o!="KMAC128"&&o!="KMAC256")throw new Error(Bt);this.P=new Qi(o,t,i)}}update(o){return this.P.update(o),this}getHash(o,t){return this.P.getHash(o,t)}setHMACKey(o,t,i){this.P.setHMACKey(o,t,i)}getHMAC(o,t){return this.P.getHMAC(o,t)}};var Ji=(e,o)=>o.name;function Zi(e,o){if(e&1&&R(0,"mat-progress-bar",3),e&2){let t=o.$implicit,i=_();g("value",i.fileProgressMap[t.name].progress/i.fileProgressMap[t.name].total*100)("mode","determinate")}}var fi=(()=>{class e{constructor(t){this.web=t,this.fileProgressMap={},this.fileList=[],this.fileType="",this.fileCategory="",this.analysisGroupId=0,this.fileUploaded=new rt,this.allowFileType=["csv","tsv","txt"]}uploadData(t){return kt(this,null,function*(){let i=t.target.files;if(i){this.fileList=[];for(let n=0;n<i.length;n++)this.fileList.push(i[n]),this.fileProgressMap[i[n].name]={progress:0,total:i[n].size};for(let n=0;n<i.length;n++)yield this.uploadFile(i[n])}})}getFileExntension(t){let i=t.name.split(".");return i.length>1?i[i.length-1]:""}uploadFile(t){return kt(this,null,function*(){let n=t.size,a=new le("SHA-256","ARRAYBUFFER");if(this.fileType=this.getFileExntension(t),this.allowFileType.indexOf(this.fileType)!==-1)if(1048576>n){let c=yield t.arrayBuffer();a.update(c);let f=a.getHash("HEX"),u=yield this.web.uploadDataChunkComplete("",f,t,t.name).toPromise();this.fileProgressMap[t.name].progress=n,u?.completed_at&&this.web.bindUploadedFile(this.analysisGroupId,this.fileType,this.fileCategory,t.name,u?.id).subscribe(h=>{this.fileUploaded.emit(h)})}else{let c="",f=0;for(;n>f;){let u=f+1048576;u>=n&&(u=n);let h=yield t.slice(f,u).arrayBuffer();a.update(h);let C=new File([h],t.name,{type:t.type});console.log(C.size);let d=`bytes ${f}-${u-1}/${n}`;console.log(d);let y=yield this.web.uploadDataChunk(c,C,t.name,d).toPromise();y&&(c=y.url,f=y.offset,this.fileProgressMap[t.name].progress=f)}if(c!==""){let u=a.getHash("HEX"),h=yield this.web.uploadDataChunkComplete(c,u).toPromise();h?.completed_at&&this.web.bindUploadedFile(this.analysisGroupId,this.fileType,this.fileCategory,t.name,h?.id).subscribe(C=>{this.fileProgressMap[t.name].progress=n,this.fileUploaded.emit(C)})}}})}static{this.\u0275fac=function(i){return new(i||e)(F(Z))}}static{this.\u0275cmp=U({type:e,selectors:[["app-upload-file"]],inputs:{fileType:"fileType",fileCategory:"fileCategory",analysisGroupId:"analysisGroupId"},outputs:{fileUploaded:"fileUploaded"},standalone:!0,features:[H],decls:8,vars:0,consts:[["file",""],["mat-icon-button","","type","button",3,"click"],["type","file","hidden","",3,"change"],[3,"value","mode"]],template:function(i,n){if(i&1){let a=B();r(0,"form")(1,"button",1),w("click",function(){D(a);let f=dt(5);return A(f.click())}),r(2,"mat-icon"),s(3,"upload"),l()(),r(4,"input",2,0),w("change",function(f){return D(a),A(n.uploadData(f))}),l()(),I(6,Zi,1,2,"mat-progress-bar",3,Ji)}i&2&&(p(6),T(n.fileList))},dependencies:[wt,bt,oe,W,X,Y]})}}return e})();var tn=["table"];function en(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function nn(e,o){e&1&&(r(0,"th",16),s(1," Sample "),l())}function on(e,o){if(e&1&&(r(0,"td",17),s(1),l()),e&2){let t=o.$implicit;p(),K(" ",t.value.Sample," ")}}function an(e,o){e&1&&(r(0,"th",16),s(1," Condition "),l())}function rn(e,o){if(e&1){let t=B();r(0,"td",17)(1,"form",4)(2,"mat-form-field")(3,"input",18,1),w("change",function(n){D(t);let a=dt(4),c=_(2);return A(c.handleAutoCompleteChange(n,a.value))}),l(),r(5,"mat-label"),s(6),l()()()()}if(e&2){let t=o.$implicit;p(),g("formGroup",t),p(2),Ut("placeholder",t.value.Sample),p(3),L(t.value.Sample)}}function ln(e,o){e&1&&R(0,"tr",19)}function sn(e,o){e&1&&R(0,"tr",20)}function cn(e,o){if(e&1&&(r(0,"table",8,0),Nt(2,10),G(3,nn,2,0,"th",11)(4,on,2,1,"td",12),Vt(),Nt(5,13),G(6,an,2,0,"th",11)(7,rn,7,3,"td",12),Vt(),G(8,ln,1,0,"tr",14)(9,sn,1,0,"tr",15),l()),e&2){let t=_();g("dataSource",t.annotationData),p(8),g("matHeaderRowDef",t.displayedColumns),p(),g("matRowDefColumns",t.displayedColumns)}}var hi=(()=>{class e{set annotation(t){t&&(this._annotation=t,this.annotationData=t.annotations.map(i=>this.fb.group({Sample:new M(i.Sample,N.required),Condition:new M(i.Condition,N.required)})),this.form.patchValue({columns:this.annotationData.map(i=>i.value.Sample)}))}get annotation(){return this._annotation}set projectFile(t){this._projectFile=t,this.web.getProjectFileColumns(t.id).subscribe(i=>{let n=[];i.forEach(a=>{n.includes(a)||n.push(a)}),this.columns=n})}get projectFile(){return this._projectFile}onSelectionChange(t){let i=t.source,n=-1,a=i.selected,c;for(let u=0;u<a.length;u++)if(!this.lastSelection.find(h=>h===a[u].value)){c=a[u];break}let f=i.options.toArray();n=f.indexOf(c),this.shiftPressed&&this.lastSelectedIndex>-1&&f.forEach((u,h)=>{this.isBetween(h,this.lastSelectedIndex,n)&&(console.log(u),u.select())}),this.lastSelection=this.form.value.columns?.slice(),this.lastSelectedIndex=n,this.table?.renderRows()}constructor(t,i,n){this.fb=t,this.web=i,this.dialogRef=n,this.columns=[],this.shiftPressed=!1,this.displayedColumns=["Sample","Condition"],this.form=this.fb.group({columns:new M([])}),this.annotationData=[],this.lastSelectedIndex=-1,this.lastSelection=[],window.addEventListener("keydown",a=>{a.key==="Shift"&&(this.shiftPressed=!0)}),window.addEventListener("keyup",a=>{a.key==="Shift"&&(this.shiftPressed=!1)}),this.form.controls.columns.valueChanges.subscribe(a=>{if(a){let c=a.map(f=>{let u=f.split(/\./g);return console.log(u),u.length>2?{Sample:f,Condition:u.slice(0,u.length-1).join(".")}:u.length===2?{Sample:f,Condition:u[0]}:{Sample:f,Condition:""}});for(let f=0;f<c.length;f++)this.annotationData.find(u=>u.value.Sample===c[f].Sample)||this.annotationData.push(this.fb.group({Sample:new M(c[f].Sample,N.required),Condition:new M(c[f].Condition,N.required)}));for(let f=0;f<this.annotationData.length;f++)this.annotationData[f].value.Sample&&(a.includes(this.annotationData[f].value.Sample)||this.annotationData.splice(f,1))}})}cancel(){this.dialogRef.close()}save(){let t=!0,i=this.annotationData.map(n=>(n.valid||(t=!1),n.value));t&&this.dialogRef.close(i)}handleAutoCompleteChange(t,i){console.log(t,i)}isBetween(t,i,n){return i<n?t>=i&&t<=n:t>=n&&t<=i}static{this.\u0275fac=function(i){return new(i||e)(F(ot),F(Z),F(st))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-sample-annotation-modal"]],viewQuery:function(i,n){if(i&1&&Ce(tn,5),i&2){let a;ye(a=ge())&&(n.table=a.first)}},inputs:{annotation:"annotation",projectFile:"projectFile"},standalone:!0,features:[H],decls:16,vars:3,consts:[["table",""],["optionCondition",""],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[2,"width","300px"],["formControlName","columns",3,"selectionChange","multiple"],[3,"value"],["mat-table","",3,"dataSource"],["mat-button","",3,"click"],["matColumnDef","Sample"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Condition"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["matInput","","formControlName","Condition",2,"border-radius","0",3,"change","placeholder"],["mat-header-row",""],["mat-row",""]],template:function(i,n){i&1&&(r(0,"h2",2),s(1,"Sample Annotation"),l(),r(2,"div",3)(3,"form",4)(4,"mat-form-field",5)(5,"mat-select",6),w("selectionChange",function(c){return n.onSelectionChange(c)}),I(6,en,2,2,"mat-option",7,V),l(),r(8,"mat-label"),s(9,"Columns"),l()()(),G(10,cn,10,3,"table",8),l(),r(11,"mat-dialog-actions")(12,"button",9),w("click",function(){return n.save()}),s(13,"Submit"),l(),r(14,"button",9),w("click",function(){return n.cancel()}),s(15,"Close"),l()()),i&2&&(p(3),g("formGroup",n.form),p(2),g("multiple",!0),p(),T(n.columns),p(4),E(n.annotationData.length>0?10:-1))},dependencies:[ct,mt,W,X,et,O,Y,it,nt,J,vt,lt,Q,at,Et,pt,z,Ie,Ne,Ve,Le,Be,je,Re,Pe,Te,ke]})}}return e})();function mn(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function pn(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function un(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function dn(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function fn(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function hn(e,o){if(e&1&&(r(0,"mat-option",7),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function _n(e,o){if(e&1&&(r(0,"mat-form-field")(1,"mat-select",14),I(2,hn,2,2,"mat-option",7,V),l(),r(4,"mat-label"),s(5,"Comparison Label"),l()()),e&2){let t=_(2).$implicit,i=_(2);p(2),T(i.comparison_labels_map[t.value.comparison_col])}}function Cn(e,o){e&1&&(r(0,"mat-form-field"),R(1,"input",15),r(2,"mat-label"),s(3,"Comparison Label"),l()())}function yn(e,o){if(e&1){let t=B();r(0,"mat-tab",4),Nt(1),r(2,"div")(3,"form",5)(4,"div")(5,"mat-form-field")(6,"mat-select",6),I(7,mn,2,2,"mat-option",7,V),l(),r(9,"mat-label"),s(10,"Condition A"),l()()(),r(11,"div")(12,"mat-form-field")(13,"mat-select",8),I(14,pn,2,2,"mat-option",7,V),l(),r(16,"mat-label"),s(17,"Condition B"),l()()(),r(18,"div")(19,"mat-form-field")(20,"mat-select",9),I(21,un,2,2,"mat-option",7,V),l(),r(23,"mat-label"),s(24,"Fold Change Column"),l()()(),r(25,"div")(26,"mat-form-field")(27,"mat-select",10),I(28,dn,2,2,"mat-option",7,V),l(),r(30,"mat-label"),s(31,"P-Value Column"),l()()(),r(32,"div")(33,"mat-form-field")(34,"mat-select",11),I(35,fn,2,2,"mat-option",7,V),l(),r(37,"mat-label"),s(38,"Comparison Column"),l()()(),s(39," If the comparison column has been selected, please select the comparison label column below. If not, please write the comparison label in the text box below. "),r(40,"div"),G(41,_n,6,0,"mat-form-field")(42,Cn,4,0,"mat-form-field"),l()()(),r(43,"div",12)(44,"button",13),w("click",function(){D(t);let n=_().$implicit,a=_(2);return A(a.copyComparison(n))}),r(45,"mat-icon"),s(46,"content_copy"),l()(),r(47,"button",13),w("click",function(){D(t);let n=_().$index,a=_(2);return A(a.removeComparison(n))}),r(48,"mat-icon"),s(49,"remove"),l()()(),Vt(),l()}if(e&2){let t=_().$implicit,i=_(2);g("label",t.value.comparison_label),p(3),g("formGroup",t),p(4),T(i.conditions),p(7),T(i.conditions),p(7),T(i.columns),p(7),T(i.columns),p(7),T(i.columns),p(6),E(t.value.comparison_col?41:42)}}function gn(e,o){if(e&1&&G(0,yn,50,3,"mat-tab",4),e&2){let t=o.$implicit;E(t.value.comparison_label?0:-1)}}function xn(e,o){if(e&1&&(r(0,"mat-tab-group",2),I(1,gn,1,1,null,null,V),l()),e&2){let t=_();p(),T(t.form)}}var _i=(()=>{class e{set comparisonMatrix(t){this._comparisonMatrix=t,this.form=t.matrix.map(i=>this.fb.group({condition_A:new M(i.condition_A,N.required),condition_B:new M(i.condition_B,N.required),fold_change_col:new M(i.fold_change_col,N.required),p_value_col:new M(i.p_value_col,N.required),comparison_label:new M(i.comparison_label,N.required),comparison_col:new M(i.comparison_col)}));for(let i of this.form)i.controls.comparison_col.value&&this.web.getUniqueComparisonLabel(t.file,i.controls.comparison_col.value).subscribe(n=>{this.comparison_labels_map[i.controls.comparison_col.value]=n}),i.controls.comparison_col.valueChanges.subscribe(n=>{n&&this.web.getUniqueComparisonLabel(t.file,n).subscribe(a=>{this.comparison_labels_map[n]=a})}),i.controls.comparison_label.valueChanges.subscribe(n=>{n||i.controls.comparison_label.setValue("temp_title")})}set projectFile(t){this._projectFile=t,this.web.getProjectFileColumns(t.id).subscribe(i=>{let n=[];i.forEach(a=>{n.includes(a)||n.push(a)}),this.columns=n})}get projectFile(){return this._projectFile}set sampleAnnotations(t){this._sampleAnnotations=t,t&&(this.conditions=[],t.annotations.forEach(i=>{console.log(i.Condition),this.conditions.includes(i.Condition)||this.conditions.push(i.Condition)}))}get sampleAnnotations(){return this._sampleAnnotations}constructor(t,i,n){this.web=t,this.fb=i,this.dialogRef=n,this.comparison_labels=[],this.comparison_labels_map={},this.columns=[],this.conditions=[],this.form=[]}addComparison(){let t=this.fb.group({condition_A:new M(null,N.required),condition_B:new M(null,N.required),fold_change_col:new M(null,N.required),p_value_col:new M(null,N.required),comparison_label:new M(`comparison_${this.form.length+1}`,N.required),comparison_col:new M(null)});this.form.push(t),t.controls.comparison_col.valueChanges.subscribe(i=>{i&&this.web.getUniqueComparisonLabel(this.comparisonMatrix.file,i).subscribe(n=>{this.comparison_labels=n})}),t.controls.comparison_label.valueChanges.subscribe(i=>{i||t.controls.comparison_label.setValue("temp_title")})}removeComparison(t){this.form.splice(t,1)}copyComparison(t){let i=this.fb.group({condition_A:new M(t.value.condition_A,N.required),condition_B:new M(t.value.condition_B,N.required),fold_change_col:new M(t.value.fold_change_col,N.required),p_value_col:new M(t.value.p_value_col,N.required),comparison_label:new M(`comparison_${this.form.length+1}`,N.required),comparison_col:new M(t.value.comparison_col)});this.form.push(i),i.controls.comparison_col.valueChanges.subscribe(n=>{n&&this.web.getUniqueComparisonLabel(this.comparisonMatrix.file,n).subscribe(a=>{this.comparison_labels=a})}),i.controls.comparison_label.valueChanges.subscribe(n=>{n||i.controls.comparison_label.setValue("temp_title")})}save(){let t=!0;this.form.forEach(i=>{i.valid||(t=!1)}),t&&this.dialogRef.close(this.form.map(i=>i.value))}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||e)(F(Z),F(ot),F(st))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-comparison-matrix-modal"]],inputs:{comparisonMatrix:"comparisonMatrix",projectFile:"projectFile",sampleAnnotations:"sampleAnnotations"},standalone:!0,features:[H],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-stretch-tabs","false"],["mat-button","",3,"click"],[3,"label"],[2,"display","flex","flex-direction","column","gap","10px","overflow-y","hidden",3,"formGroup"],["formControlName","condition_A"],[3,"value"],["formControlName","condition_B"],["formControlName","fold_change_col"],["formControlName","p_value_col"],["formControlName","comparison_col"],[2,"display","flex","flex-direction","row","gap","10px"],["mat-icon-button","","color","warn",3,"click"],["formControlName","comparison_label"],["matInput","","type","text","formControlName","comparison_label"]],template:function(i,n){i&1&&(r(0,"h2",0),s(1,"Analysis Group Comparison Matrix"),l(),r(2,"div",1),G(3,xn,3,0,"mat-tab-group",2),l(),r(4,"mat-dialog-actions")(5,"button",3),w("click",function(){return n.addComparison()}),s(6," Add Comparison "),l(),r(7,"button",3),w("click",function(){return n.save()}),s(8," Submit "),l(),r(9,"button",3),w("click",function(){return n.cancel()}),s(10," Close "),l()()),i&2&&(p(3),E(n.form.length>0?3:-1))},dependencies:[ct,mt,wt,bt,W,X,et,O,Y,it,nt,J,vt,lt,Q,at,He,Ue,pt,z],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]})}}return e})();var Ci=(()=>{class e{constructor(t,i,n,a,c){this.fb=t,this.dialogRef=i,this.web=n,this.ws=a,this.sb=c,this.analysisGroupIDs=[],this.form=this.fb.group({search:new M("",N.required),searchMode:new M("full",N.required),foldChange:new M(.6,N.required),pValue:new M(1.31,N.required)}),this.selectedProjects=[],this.ws.searchWSConnection?.subscribe(f=>{if(f&&f.type==="search_status")switch(f.status){case"complete":this.sb.open(`${location.host}/#/search-session/${f.id}`,"Dismiss",{duration:1e4}),this.dialogRef.close(f.id);break}})}search(){this.form.invalid||(this.selectedProjects.length===0?this.form.value.search&&this.form.value.foldChange&&this.form.value.pValue&&this.form.value.searchMode&&this.web.createSearch(this.analysisGroupIDs,this.form.value.search,this.web.searchSessionID,this.form.value.foldChange,this.form.value.pValue,this.form.value.searchMode).subscribe(t=>{this.sb.open("Search queued","Dismiss",{duration:2e3})}):this.web.getAnalysisGroupsFromProjects(this.selectedProjects).subscribe(t=>{t&&this.form.value.search&&this.form.value.foldChange&&this.form.value.pValue&&this.form.value.searchMode&&this.web.createSearch(t.map(i=>i.id),this.form.value.search,this.web.searchSessionID,this.form.value.foldChange,this.form.value.pValue,this.form.value.searchMode).subscribe(i=>{this.sb.open("Search queued","Dismiss",{duration:2e3})})}))}cancel(){this.dialogRef.close()}handleMultipleProjectSelection(t){this.selectedProjects=t}static{this.\u0275fac=function(i){return new(i||e)(F(ot),F(st),F(Z),F(ne),F(ee))}}static{this.\u0275cmp=U({type:e,selectors:[["app-search-modal"]],inputs:{analysisGroupIDs:"analysisGroupIDs"},standalone:!0,features:[H],decls:56,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","1px",3,"formGroup"],["matInput","","formControlName","search","id","search","type","text","placeholder","Search Term"],["formControlName","searchMode"],["value","gene"],["value","uniprot"],["value","pi"],["value","full"],["matInput","","type","number","formControlName","foldChange","placeholder","Log2 Fold Change"],["matInput","","type","number","formControlName","pValue","placeholder","P-Value"],[3,"selectedProjects","multipleSelection"],["mat-button","",3,"click"]],template:function(i,n){i&1&&(r(0,"h2",0),s(1,"Data Search"),l(),r(2,"div",1)(3,"form",2)(4,"mat-form-field"),R(5,"input",3),r(6,"mat-label"),s(7,"Search Term"),l()(),r(8,"p")(9,"b"),s(10,"Search Multiple Terms"),l(),R(11,"br"),s(12," In order to search with multiple terms, enclose each term in single quotes and separate them with "),r(13,"b"),s(14,"OR"),l(),s(15,". "),l(),r(16,"mat-form-field")(17,"mat-select",4)(18,"mat-option",5),s(19,"Gene Name"),l(),r(20,"mat-option",6),s(21,"UniProt Accession ID"),l(),r(22,"mat-option",7),s(23,"Primary IDs"),l(),r(24,"mat-option",8),s(25,"Full Text"),l()(),r(26,"mat-label"),s(27,"Search Mode"),l()(),r(28,"mat-form-field"),R(29,"input",9),r(30,"mat-label"),s(31,"Log2 Fold Change"),l()(),r(32,"mat-form-field"),R(33,"input",10),r(34,"mat-label"),s(35,"-Log10(P-Value)"),l()()(),R(36,"hr"),r(37,"p")(38,"b"),s(39,"Search by currently selected analysis groups or by selected projects below"),l(),R(40,"br"),s(41," By selecting the one or more projects below, the currently selected analysis groups will be ignored. "),l(),r(42,"mat-accordion")(43,"mat-expansion-panel")(44,"mat-expansion-panel-header")(45,"mat-panel-title"),s(46," Filter by Project "),l(),r(47,"mat-panel-description"),s(48," Optional "),l()(),r(49,"app-project-search",11),w("selectedProjects",function(c){return n.handleMultipleProjectSelection(c)}),l()()(),R(50,"hr"),l(),r(51,"mat-dialog-actions")(52,"button",12),w("click",function(){return n.search()}),s(53,"Search"),l(),r(54,"button",12),w("click",function(){return n.cancel()}),s(55,"Close"),l()()),i&2&&(p(3),g("formGroup",n.form),p(46),g("multipleSelection",!0))},dependencies:[ct,mt,Q,at,J,W,X,et,Me,O,Y,it,nt,pt,z,vt,lt,Jt,Yt,Wt,Xt,Qt,Ge]})}}return e})();function vn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Sn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Mn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Dn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function An(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Fn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function En(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Gn(e,o){if(e&1&&(r(0,"mat-form-field")(1,"mat-select",8),I(2,Dn,2,2,"mat-option",5,V),l(),r(4,"mat-label"),s(5,"Mod Position in Peptide Column"),l()(),r(6,"mat-form-field")(7,"mat-select",9),I(8,An,2,2,"mat-option",5,V),l(),r(10,"mat-label"),s(11,"Mod Position in Protein Column"),l()(),r(12,"mat-form-field")(13,"mat-select",10),I(14,Fn,2,2,"mat-option",5,V),l(),r(16,"mat-label"),s(17,"Localization Probability Column"),l()(),r(18,"mat-form-field")(19,"mat-select",11),I(20,En,2,2,"mat-option",5,V),l(),r(22,"mat-label"),s(23,"Peptide Sequence Column"),l()()),e&2){let t=_(3);p(2),T(t.columns),p(6),T(t.columns),p(6),T(t.columns),p(6),T(t.columns)}}function In(e,o){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),I(3,vn,2,2,"mat-option",5,V),l(),r(5,"mat-label"),s(6,"Primary ID Column"),l()(),r(7,"mat-form-field")(8,"mat-select",6),I(9,Sn,2,2,"mat-option",5,V),l(),r(11,"mat-label"),s(12,"Gene Name Column"),l()(),r(13,"mat-form-field")(14,"mat-select",7),I(15,Mn,2,2,"mat-option",5,V),l(),r(17,"mat-label"),s(18,"UniProt Accession ID Column"),l()(),G(19,Gn,24,0),l()),e&2){let t=_(2);g("formGroup",t.formDFColumn),p(3),T(t.columns),p(6),T(t.columns),p(6),T(t.columns),p(4),E(t.analysisGroupType&&t.analysisGroupType==="ptm"?19:-1)}}function Tn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function kn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Nn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Vn(e,o){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),I(3,Tn,2,2,"mat-option",5,V),l(),r(5,"mat-label"),s(6,"Primary ID Column"),l()(),r(7,"mat-form-field")(8,"mat-select",6),I(9,kn,2,2,"mat-option",5,V),l(),r(11,"mat-label"),s(12,"Gene Name Column"),l()(),r(13,"mat-form-field")(14,"mat-select",7),I(15,Nn,2,2,"mat-option",5,V),l(),r(17,"mat-label"),s(18,"UniProt Accession ID Column"),l()()()),e&2){let t=_(2);g("formGroup",t.formSearchedColumn),p(3),T(t.columns),p(6),T(t.columns),p(6),T(t.columns)}}function Ln(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Pn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Rn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Bn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function jn(e,o){if(e&1&&(r(0,"mat-option",5),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),L(t)}}function Un(e,o){if(e&1&&(r(0,"form",3)(1,"mat-form-field")(2,"mat-select",4),I(3,Ln,2,2,"mat-option",5,V),l(),r(5,"mat-label"),s(6,"Primary ID Column"),l()(),r(7,"mat-form-field")(8,"mat-select",6),I(9,Pn,2,2,"mat-option",5,V),l(),r(11,"mat-label"),s(12,"Gene Name Column"),l()(),r(13,"mat-form-field")(14,"mat-select",7),I(15,Rn,2,2,"mat-option",5,V),l(),r(17,"mat-label"),s(18,"UniProt Accession ID Column"),l()(),r(19,"mat-form-field")(20,"mat-select",12),I(21,Bn,2,2,"mat-option",5,V),l(),r(23,"mat-label"),s(24,"Copy Number Rank Column"),l()(),r(25,"mat-form-field")(26,"mat-select",13),I(27,jn,2,2,"mat-option",5,V),l(),r(29,"mat-label"),s(30,"Copy Number Column"),l()()()),e&2){let t=_(2);g("formGroup",t.formSearchedColumn),p(3),T(t.columns),p(6),T(t.columns),p(6),T(t.columns),p(6),T(t.columns),p(6),T(t.columns)}}function Hn(e,o){if(e&1&&G(0,In,20,2,"form",3)(1,Vn,19,1,"form",3)(2,Un,31,1,"form",3),e&2){let t=_();E(t.file.file_category==="df"?0:t.file.file_category==="searched"?1:t.file.file_category==="copy_number"?2:-1)}}var yi=(()=>{class e{set file(t){this._file=t,t.extra_data&&(t.file_category==="df"?(this.formDFColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formDFColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formDFColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col),this.formDFColumn.controls.peptide_seq_col.setValue(t.extra_data.peptide_seq_col),this.formDFColumn.controls.modification_position_in_peptide_col.setValue(t.extra_data.modification_position_in_peptide_col),this.formDFColumn.controls.modification_position_in_protein_col.setValue(t.extra_data.modification_position_in_protein_col),this.formDFColumn.controls.localization_prob_col.setValue(t.extra_data.localization_prob_col)):t.file_category==="searched"?(this.formSearchedColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formSearchedColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formSearchedColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col)):t.file_category==="copy_number"&&(this.formCopyNumberColumn.controls.primary_id_col.setValue(t.extra_data.primary_id_col),this.formCopyNumberColumn.controls.gene_name_col.setValue(t.extra_data.gene_name_col),this.formCopyNumberColumn.controls.uniprot_id_col.setValue(t.extra_data.uniprot_id_col),this.formCopyNumberColumn.controls.rank_col.setValue(t.extra_data.rank_col),this.formCopyNumberColumn.controls.copy_number_col.setValue(t.extra_data.copy_number_col))),this.web.getProjectFileColumns(t.id).subscribe(i=>{this.columns=i})}get file(){return this._file}constructor(t,i,n){this.fb=t,this.matDialogRef=i,this.web=n,this._file=void 0,this.analysisGroupType=void 0,this.formDFColumn=this.fb.group({primary_id_col:new M("",N.required),gene_name_col:new M(""),uniprot_id_col:new M(""),peptide_seq_col:new M(""),modification_position_in_peptide_col:new M(""),modification_position_in_protein_col:new M(""),localization_prob_col:new M("")}),this.formSearchedColumn=this.fb.group({primary_id_col:new M("",N.required),gene_name_col:new M(""),uniprot_id_col:new M("")}),this.formCopyNumberColumn=this.fb.group({primary_id_col:new M("",N.required),gene_name_col:new M(""),uniprot_id_col:new M(""),rank_col:new M(""),copy_number_col:new M("")}),this.columns=[]}save(){let t={file_category:this.file.file_category,extra_data:{}};this.file.file_category==="df"?(this.formDFColumn.controls.uniprot_id_col.value&&(t.extra_data.uniprot_id_col=this.formDFColumn.controls.uniprot_id_col.value),this.formDFColumn.controls.primary_id_col.value&&(t.extra_data.primary_id_col=this.formDFColumn.controls.primary_id_col.value),this.formDFColumn.controls.gene_name_col.value&&(t.extra_data.gene_name_col=this.formDFColumn.controls.gene_name_col.value),this.formDFColumn.controls.modification_position_in_peptide_col.value&&(t.extra_data.modification_position_in_peptide_col=this.formDFColumn.controls.modification_position_in_peptide_col.value),this.formDFColumn.controls.modification_position_in_protein_col.value&&(t.extra_data.modification_position_in_protein_col=this.formDFColumn.controls.modification_position_in_protein_col.value),this.formDFColumn.controls.localization_prob_col.value&&(t.extra_data.localization_prob_col=this.formDFColumn.controls.localization_prob_col.value),this.formDFColumn.controls.peptide_seq_col.value&&(t.extra_data.peptide_seq_col=this.formDFColumn.controls.peptide_seq_col.value)):this.file.file_category==="searched"&&(this.formSearchedColumn.controls.uniprot_id_col.value&&(t.extra_data.uniprot_id_col=this.formSearchedColumn.controls.uniprot_id_col.value),this.formSearchedColumn.controls.primary_id_col.value&&(t.extra_data.primary_id_col=this.formSearchedColumn.controls.primary_id_col.value),this.formSearchedColumn.controls.gene_name_col.value&&(t.extra_data.gene_name_col=this.formSearchedColumn.controls.gene_name_col.value)),this.matDialogRef.close(t)}cancel(){this.matDialogRef.close()}static{this.\u0275fac=function(i){return new(i||e)(F(ot),F(st),F(Z))}}static{this.\u0275cmp=U({type:e,selectors:[["app-file-extra-data-modal"]],inputs:{analysisGroupType:"analysisGroupType",file:"file"},standalone:!0,features:[H],decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-button","",3,"click"],[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["formControlName","primary_id_col"],[3,"value"],["formControlName","gene_name_col"],["formControlName","uniprot_id_col"],["formControlName","modification_position_in_peptide_col"],["formControlName","modification_position_in_protein_col"],["formControlName","localization_prob_col"],["formControlName","peptide_seq_col"],["formControlName","rank_col"],["formControlName","copy_number_col"]],template:function(i,n){i&1&&(r(0,"h2",0),s(1,"File Extra Data"),l(),r(2,"div",1),G(3,Hn,3,1),l(),r(4,"mat-dialog-actions")(5,"button",2),w("click",function(){return n.save()}),s(6,"Submit"),l(),r(7,"button",2),w("click",function(){return n.cancel()}),s(8,"Close"),l()()),i&2&&(p(3),E(n.file?3:-1))},dependencies:[ct,mt,W,X,O,Y,it,nt,Q,lt,vt,J,pt,z]})}}return e})();var Kn=Mi(Di());me.plotlyjs=Kn;var gi=(()=>{class e{set curtainData(t){this._curtainData=t,this.drawVolcanoPlot()}get curtainData(){return this._curtainData}constructor(t,i){this.accounts=t,this.graph=i,this.selected=new rt,this._curtainData=void 0,this.graphData=[],this.graphLayout={height:700,width:700,margin:{r:null,l:null,b:null,t:null},xaxis:{title:"<b>Log2FC</b>",tickmode:"linear",ticklen:5,showgrid:!1,visible:!0,tickfont:{size:14,color:"black"}},yaxis:{title:"<b>-log10(p-value)</b>",tickmode:"linear",ticklen:5,showgrid:!1,visible:!0,showticklabels:!0,zeroline:!0,tickfont:{size:14,color:"black"}},annotations:[],showlegend:!0,legend:{orientation:"h"},title:{text:"",font:{size:24,family:"Arial, sans-serif",color:"black"}}},this.revision=0,this.config={toImageButtonOptions:{format:"svg",filename:this.graphLayout.title.text,height:this.graphLayout.height,width:this.graphLayout.width,scale:1}},this.colorMap={},this.graph.redrawTrigger.subscribe(()=>{this.drawVolcanoPlot()})}drawVolcanoPlot(){if(!this.curtainData&&!this.curtainData.settings)return;console.log(this.curtainData),this.graphLayout.title.text=this.curtainData.settings.title,this.colorMap=this.curtainData.settings.colorMap;let t=Object.keys(this.colorMap),i=this.curtainData.data.filter(x=>x["Fold Change"]!==null&&x["Fold Change"]!==void 0&&!isNaN(x["Fold Change"])),n=this.curtainData.data.filter(x=>x["P-value"]!==null&&x["P-value"]!==void 0&&!isNaN(x["P-value"])),a=Math.min(...i.map(x=>x["Fold Change"])),c=Math.max(...i.map(x=>x["Fold Change"])),f=0,u=Math.max(...n.map(x=>x["P-value"]));this.graphLayout.xaxis.range=[a-.5,c+.5],this.graphLayout.yaxis.range=[f,u-f*.5];let h=this.curtainData.settings.volcanoAxis;h.minX&&(this.graphLayout.xaxis.range[0]=h.minX),h.maxX&&(this.graphLayout.xaxis.range[1]=h.maxX),h.minY&&(this.graphLayout.yaxis.range[0]=h.minY),h.maxY&&(this.graphLayout.yaxis.range[1]=h.maxY),h.x&&(this.graphLayout.xaxis.title=`<b>${h.x}</b>`),h.y&&(this.graphLayout.yaxis.title=`<b>${h.y}</b>`);let C={};C.Background={x:[],y:[],mode:"markers",type:"scatter",name:"Background",text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:"#a4a2a2",opacity:.3}};for(let x of this.curtainData.selections)C[x]={x:[],y:[],mode:"markers",type:"scattergl",name:x,text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:this.curtainData.settings.colorMap[x]}};this.curtainData.data.forEach(x=>{if(x["Primary ID"]in this.curtainData.selection_map){let $=this.curtainData.selection_map[x["Primary ID"]];for(let j of this.curtainData.selections)$[j]&&(C[j].x.push(x["Fold Change"]),C[j].y.push(x["P-value"]),C[j].text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),C[j].data.push(x))}else if(this.curtainData.settings.backGroundColorGrey)C.Background.x.push(x["Fold Change"]),C.Background.y.push(x["P-value"]),C.Background.text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),C.Background.data.push(x);else{let $=this.significantGroup(x["Fold Change"],x["P-value"]),j=t.find(q=>q.startsWith(`${$[0]} (${x.Comparison})`));j&&(C[j]||(C[j]={x:[],y:[],mode:"markers",type:"scatter",name:j,text:[],data:[],marker:{size:this.curtainData.settings.scatterPlotMarkerSize,color:this.curtainData.settings.colorMap[j]}}),C[j].x.push(x["Fold Change"]),C[j].y.push(x["P-value"]),C[j].text.push(`${x["Gene Names"]}(${x["Primary ID"]})`),C[j].data.push(x))}}),this.graphData=[];for(let x in C)this.graphData.push(C[x]);this.graphData=this.graphData.reverse();let d=[];d.push({type:"line",x0:-this.curtainData.settings.log2FCCutoff,y0:0,x1:-this.curtainData.settings.log2FCCutoff,y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),d.push({type:"line",x0:this.curtainData.settings.log2FCCutoff,x1:this.curtainData.settings.log2FCCutoff,y0:0,y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1,dash:"dot"}});let y=this.graphLayout.xaxis.range[0]-1;this.curtainData.settings.volcanoAxis.minX&&(y=this.curtainData.settings.volcanoAxis.minX-1);let v=this.graphLayout.xaxis.range[1]+1;if(this.curtainData.settings.volcanoAxis.maxX&&(v=this.curtainData.settings.volcanoAxis.maxX+1),d.push({type:"line",x0:y,x1:v,y0:-Math.log10(this.curtainData.settings.pCutoff),y1:-Math.log10(this.curtainData.settings.pCutoff),line:{color:"rgb(21,4,4)",width:1,dash:"dot"}}),this.graphLayout.shapes=d,this.curtainData.settings.volcanoPlotGrid&&(this.graphLayout.yaxis.showgrid=this.curtainData.settings.volcanoPlotGrid.y,this.graphLayout.xaxis.showgrid=this.curtainData.settings.volcanoPlotGrid.x),this.curtainData.settings.volcanoPlotDimension&&(this.curtainData.settings.volcanoPlotDimension.height&&(this.graphLayout.height=this.curtainData.settings.volcanoPlotDimension.height),this.curtainData.settings.volcanoPlotDimension.width&&(this.graphLayout.width=this.curtainData.settings.volcanoPlotDimension.width),this.curtainData.settings.volcanoPlotDimension.margin))for(let x in this.curtainData.settings.volcanoPlotDimension.margin)this.curtainData.settings.volcanoPlotDimension.margin[x]&&(this.graphLayout.margin[x]=this.curtainData.settings.volcanoPlotDimension.margin[x]);if(this.curtainData.settings.volcanoPlotYaxisPosition&&(this.curtainData.settings.volcanoPlotYaxisPosition.includes("left")&&this.graphLayout.shapes.push({type:"line",x0:this.graphLayout.xaxis.range[0],x1:this.graphLayout.xaxis.range[0],y0:this.graphLayout.yaxis.range[0],y1:this.graphLayout.yaxis.range[1],line:{color:"rgb(21,4,4)",width:1}}),this.curtainData.settings.volcanoPlotYaxisPosition.includes("middle")?this.graphLayout.xaxis.zerolinecolor="#000000":this.graphLayout.xaxis.zerolinecolor="#ffffff"),this.graphLayout.annotations=[],this.curtainData.settings.textAnnotation)for(let x in this.curtainData.settings.textAnnotation)this.curtainData.settings.textAnnotation[x].data.showannotation===!0&&this.graphLayout.annotations.push(this.curtainData.settings.textAnnotation[x].data);this.config={toImageButtonOptions:{format:"svg",filename:this.graphLayout.title.text,height:this.graphLayout.height,width:this.graphLayout.width,scale:1,margin:this.graphLayout.margin}};let S=document.getElementsByTagName("body")[0],P=window.getComputedStyle(S).backgroundColor;if(this.accounts.userAccount.darkMode){this.graphLayout.plot_bgcolor=P,this.graphLayout.paper_bgcolor=P,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white";for(let x of this.graphLayout.shapes)x.line.color="white";this.graphLayout.yaxis.showgrid&&(this.graphLayout.yaxis.gridcolor="white"),this.graphLayout.xaxis.showgrid&&(this.graphLayout.xaxis.gridcolor="white");for(let x of this.graphLayout.annotations)x.font.color="white",x.arrowcolor="white"}else this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14};if(this.curtainData.settings.volcanoAdditionalShapes)for(let x of this.curtainData.settings.volcanoAdditionalShapes)this.graphLayout.shapes.push(x);this.revision+=1,console.log("cutoff",d),console.log(this.graphData)}significantGroup(t,i){let n=-Math.log10(this.curtainData.settings.pCutoff),a=[],c="";return n>i?(a.push("P-value > "+this.curtainData.settings.pCutoff),c="P-value > "):(a.push("P-value <= "+this.curtainData.settings.pCutoff),c="P-value <= "),Math.abs(t)>this.curtainData.settings.log2FCCutoff?(a.push("FC > "+this.curtainData.settings.log2FCCutoff),c+="FC > "):(a.push("FC <= "+this.curtainData.settings.log2FCCutoff),c+="FC <= "),[a.join(";"),c]}selectData(t){if("points"in t){let i=[];for(let n of t.points)i.push(n.data.data[n.pointIndex]);this.selected.emit(i)}}static{this.\u0275fac=function(i){return new(i||e)(F(ie),F(Ke))}}static{this.\u0275cmp=U({type:e,selectors:[["app-volcano-plot"]],inputs:{curtainData:"curtainData"},outputs:{selected:"selected"},standalone:!0,features:[H],decls:1,vars:5,consts:[[3,"selected","plotlyClick","data","config","layout","revision","updateOnlyWithRevision"]],template:function(i,n){i&1&&(r(0,"plotly-plot",0),w("selected",function(c){return n.selectData(c)})("plotlyClick",function(c){return n.selectData(c)}),l()),i&2&&g("data",n.graphData)("config",n.config)("layout",n.graphLayout)("revision",n.revision)("updateOnlyWithRevision",!0)},dependencies:[me,$e]})}}return e})();function qn(e,o){if(e&1&&(r(0,"mat-form-field"),R(1,"input",12),r(2,"mat-label"),s(3,"Metadata Value"),l()()),e&2){_(2);let t=dt(23);p(),g("matAutocomplete",t)}}function zn(e,o){e&1&&(r(0,"mat-form-field"),R(1,"textarea",13),r(2,"mat-label"),s(3,"Metadata Value"),l()())}function On(e,o){if(e&1&&G(0,qn,4,1,"mat-form-field")(1,zn,4,0,"mat-form-field"),e&2){let t=_();E(t.metadataNameAutocomplete.includes(t.form.value.metadataName)?0:1)}}function Yn(e,o){if(e&1&&(r(0,"mat-option",8),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),K(" ",t," ")}}function Xn(e,o){if(e&1&&(r(0,"mat-option",8),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),K(" ",t," ")}}function Wn(e,o){if(e&1&&I(0,Xn,2,2,"mat-option",8,V),e&2){let t=_();T(t.metadataCharacteristics)}}function Qn(e,o){if(e&1&&(r(0,"mat-option",8),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),K(" ",t," ")}}function Jn(e,o){if(e&1&&I(0,Qn,2,2,"mat-option",8,V),e&2){let t=_();T(t.metadataComment)}}function Zn(e,o){if(e&1&&(r(0,"mat-option",8),s(1),l()),e&2){let t=o.$implicit;g("value",t),p(),K(" ",t," ")}}function to(e,o){if(e&1&&I(0,Zn,2,2,"mat-option",8,V),e&2){let t=_();T(t.metadataNameAutocomplete)}}function eo(e,o){if(e&1&&(r(0,"mat-option",8),s(1),l()),e&2){let t=o.$implicit,i=_();g("value",i.displayData(t)),p(),K(" ",i.displayData(t)," ")}}var xi=(()=>{class e{set metadataType(t){this.form.controls.metadataType.setValue(t)}set metadataName(t){this.form.controls.metadataName.setValue(t)}constructor(t,i,n){this.dialog=t,this.fb=i,this.web=n,this.metadataTypeAutocomplete=["Characteristic","Comment","Factor value","Material type","Assay name","Technology type"],this.metadataNameAutocomplete=["Disease","Tissue","Subcellular location"],this.metadataCharacteristics=["Disease","Tissue","Subcellular location","Cell type","Cell line","Developmental stage","Ancestry category","Sex","Age","Biological replicate"],this.metadataComment=["Data file","File uri","Technical replicate","Fraction identifier","Label","Cleavage agent details","Instrument","Modification parameters","Dissociation method","Precursor mass tolerance","Fragment mass tolerance",""],this.form=this.fb.group({metadataType:"Characteristic",metadataName:"Tissue",metadataValue:""}),this.filteredResults=Dt([]),this.readonlyType=!1,this.readonlyName=!1}ngOnInit(){this.filteredResults=this.form.controls.metadataValue.valueChanges.pipe(fe(""),de(t=>t?t.length>=2:!1),he(t=>t?this.form.controls.metadataName.value?.toLowerCase()==="subcellular location"?this.web.getSubcellularLocations(void 0,5,0,t).pipe(xt(i=>i.results)):this.form.controls.metadataName.value?.toLowerCase()==="disease"?this.web.getHumandDiseases(void 0,5,0,t).pipe(xt(i=>i.results)):this.form.controls.metadataName.value?.toLowerCase()==="tissue"?this.web.getTissues(void 0,5,0,t).pipe(xt(i=>i.results)):Dt([]):Dt([])))}close(){this.dialog.close()}submit(){this.dialog.close(this.form.value)}displayData(t){return t?"identifier"in t?t.identifier:t.location_identifier:""}static{this.\u0275fac=function(i){return new(i||e)(F(st),F(ot),F(Z))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-metadata-creation-dialog"]],inputs:{readonlyType:"readonlyType",readonlyName:"readonlyName",metadataType:"metadataType",metadataName:"metadataName"},standalone:!0,features:[H],decls:32,vars:10,consts:[["autoMetadataType","matAutocomplete"],["autoMetadataName","matAutocomplete"],["autoMetadataValue","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","formControlName","metadataName",3,"matAutocomplete","readonly"],["matInput","","formControlName","metadataType",3,"matAutocomplete","readonly"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"],["matInput","","formControlName","metadataValue",3,"matAutocomplete"],["matInput","","formControlName","metadataValue"]],template:function(i,n){if(i&1){let a=B();r(0,"h1",3),s(1,"Adding New Metadata"),l(),r(2,"div",4)(3,"form",5)(4,"mat-form-field"),R(5,"input",6),r(6,"mat-label"),s(7,"Metadata Name"),l()(),G(8,On,2,1),r(9,"mat-form-field"),R(10,"input",7),r(11,"mat-label"),s(12,"Metadata Type"),l()(),r(13,"mat-autocomplete",null,0),I(15,Yn,2,2,"mat-option",8,V),l(),r(17,"mat-autocomplete",null,1),G(19,Wn,2,0)(20,Jn,2,0)(21,to,2,0),l(),r(22,"mat-autocomplete",null,2),I(24,eo,2,2,"mat-option",8,V),Ht(26,"async"),l()()(),r(27,"div",9)(28,"button",10),w("click",function(){return D(a),A(n.close())}),s(29,"Cancel"),l(),r(30,"button",11),w("click",function(){return D(a),A(n.submit())}),s(31,"Submit"),l()()}if(i&2){let a=dt(14),c=dt(18);p(3),g("formGroup",n.form),p(2),g("matAutocomplete",c)("readonly",n.readonlyName),p(3),E(n.form.value.metadataName?8:-1),p(2),g("matAutocomplete",a)("readonly",n.readonlyType),p(5),T(n.metadataTypeAutocomplete),p(4),E(n.form.value.metadataType==="Characteristic"?19:n.form.value.metadataType==="Comment"?20:21),p(5),T($t(26,8,n.filteredResults)),p(6),g("disabled",!n.form.valid)}},dependencies:[ct,mt,W,X,et,O,Y,it,nt,Kt,Zt,lt,J,at,te,z,pt,Q]})}}return e})();var bi=(()=>{class e{constructor(t,i){this.dialog=t,this.fb=i,this.form=this.fb.group({name:["",N.required],description:[""]})}close(){this.dialog.close()}submit(){this.form.invalid||this.dialog.close(this.form.value)}static{this.\u0275fac=function(i){return new(i||e)(F(st),F(ot))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-sample-file"]],standalone:!0,features:[H],decls:17,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],["matInput","","formControlName","name"],["matInput","","formControlName","description"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(i,n){i&1&&(r(0,"h1",0),s(1,"Adding Sample File"),l(),r(2,"div",1)(3,"form",2)(4,"mat-form-field"),R(5,"input",3),r(6,"mat-label"),s(7,"Sample Name"),l()(),r(8,"mat-form-field"),R(9,"textarea",4),r(10,"mat-label"),s(11,"Sample Description"),l()()()(),r(12,"div",5)(13,"button",6),w("click",function(){return n.close()}),s(14,"Cancel"),l(),r(15,"button",6),w("click",function(){return n.submit()}),s(16,"Submit"),l()()),i&2&&(p(3),g("formGroup",n.form))},dependencies:[ct,mt,pt,z,W,X,et,O,Y,it,nt,J,Q,at]})}}return e})();var wi=(e,o)=>o.id;function io(e,o){if(e&1&&(r(0,"mat-option",10),s(1),l()),e&2){let t=o.$implicit,i=_(2);g("value",i.displayData(t)),p(),K(" ",i.displayData(t)," ")}}function no(e,o){if(e&1){let t=B();r(0,"button",12),w("click",function(){D(t);let n=_().$implicit,a=_();return a.metadataDeleted.emit(n),A(a.markedForDeletion.push(n))}),r(1,"mat-icon"),s(2,"delete"),l()()}if(e&2){let t=_(2);g("disabled",!t.canEdit)("matTooltip","Mark for deletion")}}function oo(e,o){if(e&1){let t=B();r(0,"button",12),w("click",function(){D(t);let n=_().$implicit,a=_();return A(a.undoDeletion(n))}),r(1,"mat-icon"),s(2,"undo"),l()()}if(e&2){let t=_(2);g("disabled",!t.canEdit)("matTooltip","Undo deletion mark")}}function ao(e,o){if(e&1){let t=B();r(0,"div",3)(1,"mat-form-field",8)(2,"textarea",9),we("ngModelChange",function(n){let a=D(t).$implicit;return be(a.value,n)||(a.value=n),A(n)}),w("ngModelChange",function(n){let a=D(t).$implicit,c=_();return A(c.updateValueField(a,n))}),l(),r(3,"mat-label"),s(4),l()(),r(5,"mat-autocomplete",null,1),I(7,io,2,2,"mat-option",10,V),Ht(9,"async"),l(),G(10,no,3,2,"button",11)(11,oo,3,2,"button",11),l()}if(e&2){let t=o.$implicit,i=dt(6),n=_();p(2),g("readonly",!n.canEdit),xe("ngModel",t.value),g("disabled",n.markedForDeletion.includes(t))("matAutocomplete",i),p(2),L(t.name),p(3),T($t(9,6,n.autoCompleteMap[t.id])),p(3),E(n.markedForDeletion.includes(t)?11:10)}}function ro(e,o){if(e&1&&(r(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),s(3),l(),r(4,"mat-panel-description"),s(5),l()()()),e&2){let t=o.$implicit;p(3),K(" ",t.name," "),p(2),K(" ",t.description," ")}}function lo(e,o){if(e&1&&(r(0,"mat-accordion",7),I(1,ro,6,2,"mat-expansion-panel",null,wi),l()),e&2){let t=_();p(),T(t.sourceFiles)}}var vi=(()=>{class e{set metadata(t){this._metadata=t.filter(i=>!i.source_file)}get metadata(){return this._metadata}constructor(t,i){this.web=t,this.dialog=i,this.displayedColumns=["metadataType","metadataName","metadataValue"],this.analysis_group_id=0,this._metadata=[],this.sourceFiles=[],this.metadataChange=new rt,this.metadataDeleted=new rt,this.markedForDeletion=[],this.canEdit=!1,this.autoCompleteMap={}}updateValueField(t,i){if(i.length<2){this.autoCompleteMap[t.id]=Dt([]);return}t.name.toLowerCase()==="subcellular location"?this.autoCompleteMap[t.id]=this.web.getSubcellularLocations(void 0,5,0,i).pipe(xt(n=>n.results)):t.name.toLowerCase()==="disease"?this.autoCompleteMap[t.id]=this.web.getHumandDiseases(void 0,5,0,i).pipe(xt(n=>n.results)):t.name.toLowerCase()==="tissue"?this.autoCompleteMap[t.id]=this.web.getTissues(void 0,5,0,i).pipe(xt(n=>n.results)):this.autoCompleteMap[t.id]=Dt([])}ngOnInit(){}createMetadata(t=null){let i=this.dialog.open(xi);if(t)switch(i.componentInstance.readonlyType=!0,i.componentInstance.readonlyName=!0,t){case"subcellular location":i.componentInstance.metadataName="Subcellular Location",i.componentInstance.metadataType="Characteristic";break;case"disease":i.componentInstance.metadataType="Disease",i.componentInstance.metadataType="Characteristic";break;case"tissue":i.componentInstance.metadataType="Tissue",i.componentInstance.metadataType="Characteristic";break}i.afterClosed().subscribe(n=>{n&&this.web.createMetaDataColumn(this.analysis_group_id,n).subscribe(a=>{this.metadata.push(...a),this.metadataChange.emit(this.metadata)})})}undoDeletion(t){this.markedForDeletion=this.markedForDeletion.filter(i=>i!==t),this.metadataDeleted.emit(t)}displayData(t){return t?"identifier"in t?t.identifier:t.location_identifier:""}addSampleFile(){this.dialog.open(bi).afterClosed().subscribe(i=>{i&&i.name&&this.web.createSourceFile(this.analysis_group_id,i.name,i.description).subscribe(n=>{})})}static{this.\u0275fac=function(i){return new(i||e)(F(Z),F(qt))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-general-metadata"]],inputs:{analysis_group_id:"analysis_group_id",metadata:"metadata",sourceFiles:"sourceFiles",canEdit:"canEdit"},outputs:{metadataChange:"metadataChange",metadataDeleted:"metadataDeleted"},standalone:!0,features:[H],decls:22,vars:4,consts:[["metadataMenu","matMenu"],["autoMetadataValue","matAutocomplete"],[2,"display","flex","flex-direction","column","gap","20px"],[2,"display","flex","gap","20px"],["mat-flat-button","","type","button","color","primary",3,"disabled","matMenuTriggerFor"],["mat-flat-button","","type","button","color","primary",3,"click","disabled"],["mat-menu-item","",3,"click"],["multi",""],[2,"flex-grow","1"],["matInput","",3,"ngModelChange","readonly","ngModel","disabled","matAutocomplete"],[3,"value"],["mat-icon-button","","type","button",3,"disabled","matTooltip"],["mat-icon-button","","type","button",3,"click","disabled","matTooltip"]],template:function(i,n){if(i&1){let a=B();r(0,"div",2)(1,"h3"),s(2,"Metadata"),l(),r(3,"div",2),I(4,ao,12,8,"div",3,wi),l(),r(6,"div",3)(7,"button",4),s(8,"Add Metadata"),l(),r(9,"button",5),w("click",function(){return D(a),A(n.addSampleFile())}),s(10,"Add Sample File"),l()(),r(11,"mat-menu",null,0)(13,"button",6),w("click",function(){return D(a),A(n.createMetadata("disease"))}),s(14,"Disease"),l(),r(15,"button",6),w("click",function(){return D(a),A(n.createMetadata("tissue"))}),s(16,"Tissue"),l(),r(17,"button",6),w("click",function(){return D(a),A(n.createMetadata("subcellular location"))}),s(18,"Subcellular location"),l(),r(19,"button",6),w("click",function(){return D(a),A(n.createMetadata())}),s(20,"Create custom metadata field"),l()(),G(21,lo,3,0,"mat-accordion",7),l()}if(i&2){let a=dt(12);p(4),T(n.metadata),p(3),g("disabled",!n.canEdit)("matMenuTriggerFor",a),p(2),g("disabled",!n.canEdit),p(12),E(n.sourceFiles.length>0?21:-1)}},dependencies:[z,bt,wt,Et,et,O,Se,at,J,Q,Kt,Zt,lt,te,Ee,ze,qe,Oe,Jt,Yt,Qt,Wt,Xt]})}}return e})();function so(e,o){if(e&1){let t=B();r(0,"div",0)(1,"app-volcano-plot",3),w("selected",function(n){D(t);let a=_();return A(a.handleVolcanoSelection(n))}),l()()}if(e&2){let t=_();p(),g("curtainData",t.curtainData)}}function co(e,o){if(e&1&&(r(0,"p")(1,"b"),s(2,"Associated Project: "),l(),r(3,"a",18),s(4),l()()),e&2){let t=_(2);p(3),_e("href","/#/project/",t.analysisGroup.project,"",se),p(),L(t.associatedProject.name)}}function mo(e,o){if(e&1&&(r(0,"p")(1,"b"),s(2,"Curtain Link: "),l(),r(3,"a",18),s(4),l()()),e&2){let t=_(2);p(3),Ut("href",t.analysisGroup.curtain_link,se),p(),L(t.analysisGroup.curtain_link)}}function po(e,o){if(e&1){let t=B();R(0,"mat-divider"),r(1,"app-analysis-group-general-metadata",19),w("metadataDeleted",function(n){D(t);let a=_(2);return A(a.updateDeletionList(n))}),l()}if(e&2){let t=_(2);p(),g("sourceFiles",t.analysisGroup.source_files)("canEdit",t.canEdit)("analysis_group_id",t.analysisGroup.id)("metadata",t.analysisGroup.metadata_columns)}}function uo(e,o){if(e&1&&(r(0,"p"),s(1),l(),R(2,"mat-progress-bar",20)),e&2){let t=_(2);p(),L(t.composingCurtainProgress.message),p(),g("value",t.composingCurtainProgress.progress)("mode","determinate")("color","primary")}}function fo(e,o){if(e&1){let t=B();r(0,"button",21),w("click",function(){D(t);let n=_(2);return A(n.composeDataFromCurtain())}),s(1,"Use Curtain Link For Data"),l()}if(e&2){let t=_(2);g("disabled",!t.canEdit)}}function ho(e,o){if(e&1&&s(0),e&2){let t=_(2);K(": ",t.analysisGroupDF.name,"")}}function _o(e,o){if(e&1){let t=B();r(0,"app-upload-file",22),w("fileUploaded",function(n){D(t);let a=_(2);return A(a.handleFileUploaded(n,"df"))}),l()}if(e&2){let t=_(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","df")}}function Co(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(3);return A(n.deleteFile(n.analysisGroupDF))}),r(1,"mat-icon"),s(2,"delete"),l()(),r(3,"button",24),w("click",function(){D(t);let n=_(3);return A(n.openExtraDataModal(n.analysisGroupDF))}),s(4,"Extra Data"),l()}if(e&2){let t=_(3);p(3),g("disabled",!t.accounts.loggedIn)}}function yo(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(2);return A(n.downloadFile(n.analysisGroupDF))}),r(1,"mat-icon"),s(2,"download"),l()(),G(3,Co,5,1)}if(e&2){let t=_(2);p(3),E(t.canEdit?3:-1)}}function go(e,o){if(e&1&&s(0),e&2){let t=_(2);K(": ",t.analysisGroupSearched.name,"")}}function xo(e,o){if(e&1){let t=B();r(0,"app-upload-file",22),w("fileUploaded",function(n){D(t);let a=_(2);return A(a.handleFileUploaded(n,"searched"))}),l()}if(e&2){let t=_(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","searched")}}function bo(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(3);return A(n.deleteFile(n.analysisGroupSearched))}),r(1,"mat-icon"),s(2,"delete"),l()(),r(3,"button",24),w("click",function(){D(t);let n=_(3);return A(n.openExtraDataModal(n.analysisGroupSearched))}),s(4,"Extra Data"),l()}if(e&2){let t=_(3);p(3),g("disabled",!t.accounts.loggedIn)}}function wo(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(2);return A(n.downloadFile(n.analysisGroupSearched))}),r(1,"mat-icon"),s(2,"download"),l()(),G(3,bo,5,1)}if(e&2){let t=_(2);p(3),E(t.canEdit?3:-1)}}function vo(e,o){if(e&1&&s(0),e&2){let t=_(2);K(": ",t.analysisGroupCopyNumber.name,"")}}function So(e,o){if(e&1){let t=B();r(0,"app-upload-file",22),w("fileUploaded",function(n){D(t);let a=_(2);return A(a.handleFileUploaded(n,"copy_number"))}),l()}if(e&2){let t=_(2);g("analysisGroupId",t.analysisGroup.id)("fileCategory","copy_number")}}function Mo(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(3);return A(n.deleteFile(n.analysisGroupCopyNumber))}),r(1,"mat-icon"),s(2,"delete"),l()(),r(3,"button",24),w("click",function(){D(t);let n=_(3);return A(n.openExtraDataModal(n.analysisGroupCopyNumber))}),s(4,"Extra Data"),l()}if(e&2){let t=_(3);p(3),g("disabled",!t.canEdit)}}function Do(e,o){if(e&1){let t=B();r(0,"button",23),w("click",function(){D(t);let n=_(2);return A(n.downloadFile(n.analysisGroupCopyNumber))}),r(1,"mat-icon"),s(2,"download"),l()(),G(3,Mo,5,1)}if(e&2){let t=_(2);p(3),E(t.canEdit?3:-1)}}function Ao(e,o){if(e&1&&s(0),e&2){let t=_(3);K("(",t.sampleAnnotations.annotations.length,")")}}function Fo(e,o){if(e&1){let t=B();r(0,"button",24),w("click",function(){D(t);let n=_(2);return A(n.setAnnotationModal(n.analysisGroupSearched))}),s(1,"Plot Sample Annotation "),G(2,Ao,1,1),l()}if(e&2){let t=_(2);g("disabled",!t.canEdit),p(2),E(t.sampleAnnotations?2:-1)}}function Eo(e,o){if(e&1&&s(0),e&2){let t=_(3);K("(",t.comparisonMatrix.matrix.length,")")}}function Go(e,o){if(e&1){let t=B();r(0,"button",24),w("click",function(){D(t);let n=_(2);return A(n.setComparisonMatrixModal(n.sampleAnnotations,n.analysisGroupSearched,n.analysisGroupDF))}),s(1,"Comparison Matrix "),G(2,Eo,1,1),l()}if(e&2){let t=_(2);g("disabled",!t.canEdit),p(2),E(t.comparisonMatrix?2:-1)}}function Io(e,o){if(e&1){let t=B();G(0,co,5,3,"p")(1,mo,5,2,"p"),r(2,"form",4),w("ngSubmit",function(){D(t);let n=_();return A(n.updateAnalysisGroup())}),r(3,"mat-form-field",2),R(4,"input",5),r(5,"mat-label"),s(6,"Analysis Group Name"),l()(),r(7,"mat-form-field",2),R(8,"textarea",6),r(9,"mat-label"),s(10,"Analysis Group Description"),l()(),G(11,po,2,4),R(12,"mat-divider"),r(13,"div",7)(14,"mat-form-field",2),R(15,"input",8),r(16,"mat-label"),s(17,"Curtain Link"),l()(),r(18,"button",9),w("click",function(){D(t);let n=_();return A(n.refreshCurtainLink())}),r(19,"mat-icon"),s(20,"refresh"),l()()(),G(21,uo,3,4),r(22,"div",7)(23,"button",10),s(24,"Update Analysis Group"),l(),G(25,fo,2,1,"button",11),l()(),r(26,"div",12)(27,"div")(28,"p"),s(29,"Differential Analysis File "),G(30,ho,1,1),l()(),G(31,_o,1,2,"app-upload-file",13)(32,yo,4,1),l(),r(33,"div",12)(34,"div")(35,"p"),s(36,"Searched File "),G(37,go,1,1),l()(),G(38,xo,1,2,"app-upload-file",13)(39,wo,4,1),l(),r(40,"div",12)(41,"div")(42,"p"),s(43,"Copy Number File "),G(44,vo,1,1),l()(),G(45,So,1,2,"app-upload-file",13)(46,Do,4,1),l(),r(47,"div",14),G(48,Fo,3,2,"button",15)(49,Go,3,2,"button",15),r(50,"button",16),w("click",function(){D(t);let n=_();return A(n.openSearchModal())}),r(51,"mat-icon"),s(52,"search"),l()(),r(53,"button",17),w("click",function(){D(t);let n=_();return A(n.deleteAnalysisGroup())}),r(54,"mat-icon"),s(55,"delete"),l()()()}if(e&2){let t=_();E(t.associatedProject?0:-1),p(),E(t.analysisGroup.curtain_link?1:-1),p(),g("formGroup",t.form),p(9),E(t.analysisGroup?11:-1),p(7),g("disabled",!t.canEdit),p(3),E(t.composingCurtainProgress.started?21:-1),p(2),g("disabled",!t.canEdit),p(2),E(t.analysisGroup.curtain_link?25:-1),p(5),E(t.analysisGroupDF?30:-1),p(),E(t.canEdit?31:-1),p(),E(t.analysisGroupDF?32:-1),p(5),E(t.analysisGroupSearched?37:-1),p(),E(t.canEdit?38:-1),p(),E(t.analysisGroupSearched?39:-1),p(5),E(t.analysisGroupCopyNumber?44:-1),p(),E(t.canEdit?45:-1),p(),E(t.analysisGroupCopyNumber?46:-1),p(2),E(t.analysisGroupSearched?48:-1),p(),E(t.sampleAnnotations&&t.analysisGroupSearched&&t.analysisGroupDF?49:-1),p(4),g("disabled",!t.canEdit)}}var Hr=(()=>{class e{set analysisGroup(t){this._analysisGroup=t,t&&this.accounts.getAnalysisGroupPermissions(t.id).subscribe(i=>{this.canEdit=i.edit}),this.curtainData=void 0,t&&(t.curtain_link&&this.getCurtainData(),this.dataService.analysisGroupChoices.forEach(i=>{i.value===t.analysis_group_type&&(this.analysisType=i.label)}),this.titleService.setTitle(`AG - ${t.name}`),this.web.getProject(t.project).subscribe(i=>{this.associatedProject=i}),this.form.controls.name.setValue(t.name),this.form.controls.description.setValue(t.description),this.form.controls.curtain_link.setValue(t.curtain_link),this.getFiles(t))}getFiles(t){this.web.getAnalysisGroupFiles(t.id).subscribe(i=>{this.analysisGroupDF=i.find(n=>n.file_category==="df"),this.analysisGroupSearched=i.find(n=>n.file_category==="searched"),this.analysisGroupSearched&&this.web.getProjectFileSampleAnnotations(this.analysisGroupSearched.id).subscribe(n=>{this.sampleAnnotations=n}),this.analysisGroupDF&&this.web.getProjectFileComparisonMatrix(this.analysisGroupDF.id).subscribe(n=>{this.comparisonMatrix=n})})}get analysisGroup(){return this._analysisGroup}constructor(t,i,n,a,c,f,u,h){this.sb=t,this.dataService=i,this.titleService=n,this.fb=a,this.web=c,this.matDialog=f,this.accounts=u,this.ws=h,this.analysisType="proteomics",this.canEdit=!1,this.composingCurtainProgress={progress:0,message:"",completed:!1,error:!1,started:!1},this.deleted=new rt,this.updated=new rt,this.form=this.fb.group({name:new M({value:"",disabled:!this.accounts.loggedIn},{validators:[N.required]}),description:new M({value:"",disabled:!this.accounts.loggedIn},{validators:[N.required]}),curtain_link:new M({value:"",disabled:!this.accounts.loggedIn})}),this.metadataDeletionList=[],this.ws.curtainWSConnection?.subscribe(C=>{if(C.analysis_group_id===this.analysisGroup?.id){if(C.type==="curtain_status")switch(C.status){case"started":this.sb.open("Curtain link retrieval started","Dismiss",{duration:5e3});break;case"complete":this.sb.open("Curtain link retrieval complete","Dismiss",{duration:5e3}),this.getCurtainData();break}else if(C.type==="curtain_compose_status")switch(C.status){case"started":this.sb.open("Composing data from Curtain started","Dismiss",{duration:5e3}),this.composingCurtainProgress.progress=30,this.composingCurtainProgress.message="Removed analysis group associated data if exist";break;case"complete":this.sb.open("Composing data from Curtain completed. Please manually set Condition A and Condition B in Comparison Matrix.","Dismiss"),this.composingCurtainProgress.progress=100,this.composingCurtainProgress.message="Composing data from Curtain completed. Please manually set Condition A and Condition B in Comparison Matrix.",this.composingCurtainProgress.completed=!0,this.web.getAnalysisGroup(this.analysisGroup.id).subscribe(d=>{this.analysisGroup=d});break;case"error":this.sb.open("Error composing data from Curtain","Dismiss",{duration:5e3}),this.composingCurtainProgress.error=!0;break}}})}updateAnalysisGroup(){return kt(this,null,function*(){if(this.form.invalid)return;if(this.metadataDeletionList.length>0)for(let i of this.metadataDeletionList)yield this.web.deleteMetaDataColumn(i.id).toPromise();let t=yield this.web.updateAnalysisGroup(this.analysisGroup.id,this.form.value.name,this.form.value.description,this.form.value.curtain_link,this.web.searchSessionID).toPromise();this.metadataDeletionList=[],this.updated.emit(t)})}getCurtainData(){this.analysisGroup&&(this.sb.open("Retrieving curtain visualization","Dismiss",{duration:5e3}),this.web.getCurtainLinkData(this.analysisGroup.id).subscribe(t=>{this.curtainData=t,this.sb.open("Curtain visualization retrieved","Dismiss",{duration:5e3})},t=>{this.sb.open("Error retrieving curtain visualization","Dismiss",{duration:5e3}),this.curtainData=void 0}))}handleFileUploaded(t,i){i==="searched"?(this.analysisGroupSearched=t,this.web.getProjectFileSampleAnnotations(t.id).subscribe(n=>{this.sampleAnnotations=n}),this.sb.open("Searched File uploaded","Dismiss",{duration:5e3})):i==="df"?(this.analysisGroupDF=t,this.web.getProjectFileComparisonMatrix(this.analysisGroupDF.id).subscribe(n=>{this.comparisonMatrix=n}),this.sb.open("Differential Analysis File uploaded","Dismiss",{duration:5e3})):i==="copy_number"&&(this.analysisGroupCopyNumber=t,this.sb.open("Copy Number Analysis File uploaded","Dismiss",{duration:5e3}))}setAnnotationModal(t){let i=this.matDialog.open(hi);i.componentInstance.projectFile=t,this.sampleAnnotations&&(i.componentInstance.annotation=this.sampleAnnotations),i.afterClosed().subscribe(n=>{n&&(console.log(this.sampleAnnotations),this.sampleAnnotations?this.web.updateSampleAnnotation(this.sampleAnnotations.id,this.sampleAnnotations.name,n).subscribe(a=>{this.sampleAnnotations=a,this.sb.open("Sample annotation updated","Dismiss",{duration:5e3})}):this.web.createSampleAnnotation(this.analysisGroup.id,this.analysisGroup?.name+" sample annotation",n,this.analysisGroupSearched.id).subscribe(a=>{this.sampleAnnotations=a,this.sb.open("Sample annotation created","Dismiss",{duration:5e3})}))})}setComparisonMatrixModal(t,i,n){let a=this.matDialog.open(_i);a.componentInstance.sampleAnnotations=t,a.componentInstance.projectFile=n,this.comparisonMatrix&&(a.componentInstance.comparisonMatrix=this.comparisonMatrix),a.afterClosed().subscribe(c=>{c&&(this.comparisonMatrix?this.web.updateComparisonMatrix(this.comparisonMatrix.id,this.comparisonMatrix.name,c).subscribe(f=>{this.comparisonMatrix=f,this.sb.open("Comparison matrix updated","Dismiss",{duration:5e3})}):this.web.createComparisonMatrix(this.analysisGroup.id,this.analysisGroup?.name+" comparison matrix",c,n.id).subscribe(f=>{this.comparisonMatrix=f,this.sb.open("Comparison matrix created","Dismiss",{duration:5e3})}))})}deleteAnalysisGroup(){this.matDialog.open(ce).afterClosed().subscribe(t=>{t&&this.web.deleteAnalysisGroup(this.analysisGroup.id).subscribe(()=>{this.deleted.emit(!0),this.sb.open("Analysis Group deleted","Dismiss",{duration:5e3})})})}openSearchModal(){let t=this.matDialog.open(Ci);t.componentInstance.analysisGroupIDs=[this.analysisGroup.id],t.afterClosed().subscribe(i=>{i&&window.open(`/#/search-session/${i}`,"_blank")})}openExtraDataModal(t){let i=this.matDialog.open(yi);i.componentInstance.analysisGroupType=this.analysisGroup?.analysis_group_type,i.componentInstance.file=t,i.afterClosed().subscribe(n=>{n&&this.web.updateProjectFileExtraData(t.id,n.extra_data).subscribe(a=>{t.file_category==="df"?(this.analysisGroupDF=a,this.sb.open("Differential Analysis extra data updated","Dismiss",{duration:5e3})):t.file_category==="searched"?(this.analysisGroupSearched=a,this.sb.open("Searched extra data updated","Dismiss",{duration:5e3})):t.file_category==="copy_number"&&(this.analysisGroupCopyNumber=a,this.sb.open("Copy Number extra data updated","Dismiss",{duration:5e3}))})})}refreshCurtainLink(){this.analysisGroup&&this.web.searchSessionID&&this.web.refreshCurtainLink(this.analysisGroup.id,this.web.searchSessionID).subscribe(t=>{this.analysisGroup=t,this.sb.open("Curtain data content refreshed","Dismiss",{duration:5e3})})}handleVolcanoSelection(t){console.log(t)}composeDataFromCurtain(){this.composingCurtainProgress={progress:0,message:"",completed:!1,error:!1},this.analysisGroup&&this.web.searchSessionID&&(this.composingCurtainProgress.started=!0,this.web.composeAnalysisGroupFilesFromCurtainData(this.analysisGroup.id,this.web.searchSessionID).subscribe(t=>{this.composingCurtainProgress.progress=10,this.composingCurtainProgress.message="Data composition started",this.sb.open("Data composition started","Dismiss",{duration:5e3})}))}deleteFile(t){this.matDialog.open(ce).afterClosed().subscribe(i=>{i&&this.web.deleteProjectFile(t.id).subscribe(()=>{t.file_category==="df"?(this.analysisGroupDF=void 0,this.sb.open("Differential Analysis File deleted","Dismiss",{duration:5e3})):t.file_category==="searched"?(this.analysisGroupSearched=void 0,this.sb.open("Searched File deleted","Dismiss",{duration:5e3})):t.file_category==="copy_number"&&(this.analysisGroupCopyNumber=void 0,this.sb.open("Copy Number Analysis File deleted","Dismiss",{duration:5e3}))})})}downloadFile(t){this.web.getFileDownloadToken(t.id).subscribe(i=>{window.open(`${this.web.baseURL}/api/project_files/download/?token=${i.token}`)})}updateDeletionList(t){this.metadataDeletionList.includes(t)?this.metadataDeletionList=this.metadataDeletionList.filter(i=>i!==t):this.metadataDeletionList.push(t)}static{this.\u0275fac=function(i){return new(i||e)(F(ee),F(Ot),F(ve),F(ot),F(Z),F(qt),F(ie),F(ne))}}static{this.\u0275cmp=U({type:e,selectors:[["app-analysis-group-view"]],inputs:{analysisGroup:"analysisGroup"},outputs:{deleted:"deleted",updated:"updated"},standalone:!0,features:[H],decls:4,vars:2,consts:[[2,"display","flex","flex-direction","row","justify-content","center","flex-wrap","wrap"],[2,"display","flex","flex-direction","row","justify-content","center","padding","50px"],[2,"width","100%"],[3,"selected","curtainData"],[2,"display","flex","flex-direction","column","gap","20px","padding","20px",3,"ngSubmit","formGroup"],["matInput","","formControlName","name","type","text","placeholder","Analysis Group Name"],["matInput","","formControlName","description","placeholder","Analysis Group Description"],[2,"display","flex","flex-direction","row","gap","10px"],["matInput","","formControlName","curtain_link","type","text","placeholder","Curtain Link"],["mat-icon-button","","type","button",3,"click","disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["mat-flat-button","","color","primary","type","button",3,"disabled"],[2,"display","flex","flex-direction","row","gap","20px","align-items","center"],[3,"analysisGroupId","fileCategory"],[2,"display","flex","flex-direction","row","gap","20px","padding","20px"],["mat-flat-button","","color","primary",3,"disabled"],["mat-icon-button","","color","accent",3,"click"],["mat-icon-button","",3,"click","disabled"],["target","_blank",3,"href"],[3,"metadataDeleted","sourceFiles","canEdit","analysis_group_id","metadata"],[3,"value","mode","color"],["mat-flat-button","","color","primary","type","button",3,"click","disabled"],[3,"fileUploaded","analysisGroupId","fileCategory"],["mat-icon-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"]],template:function(i,n){i&1&&(G(0,so,2,1,"div",0),r(1,"div",1)(2,"div",2),G(3,Io,56,20),l()()),i&2&&(E(n.curtainData?0:-1),p(3),E(n.analysisGroup?3:-1))},dependencies:[Et,X,et,O,Y,z,J,bt,at,Q,W,it,nt,fi,wt,gi,oe,vi,zt]})}}return e})();export{Ro as a,Hr as b};
