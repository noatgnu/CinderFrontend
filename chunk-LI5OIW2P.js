import{a as Du}from"./chunk-5FZDEB73.js";import{a as Su}from"./chunk-LT5OS7KN.js";import{a as Eu,b as Sh,c as Mu,d as Ss,e as Sn,f as ro,g as nn,h as an,i as Xn}from"./chunk-4PVRXQAO.js";import{a as Zi,b as Ji,c as eo,d as to}from"./chunk-YE4PZOJH.js";import{a as Li}from"./chunk-I7KSBDRZ.js";import{a as Vi,b as Ni}from"./chunk-ON4LJNYO.js";import{a as rn}from"./chunk-4IALJWBY.js";import{a as Tu,b as Yi,c as Qi}from"./chunk-JZVXNH5J.js";import{a as zi,b as ji,c as Gi,d as $i,e as qi,f as Hi,g as Wi,h as Ki,i as Ui,j as Xi}from"./chunk-LE3F4ORG.js";import{a as Wn,b as su,c as Kn,d as lu,e as uu,f as cu,g as Oi,h as Fi}from"./chunk-YYO262FZ.js";import{a as Bi,b as Ii,c as wu,d as Ri,e as xu,f as _u}from"./chunk-GH6BASN2.js";import{a as br}from"./chunk-DZJ2KETN.js";import{a as Mi,c as gu,d as mu,e as yu,f as Di,g as Cu,h as ki}from"./chunk-25CFQFJY.js";import{a as At,c as Un,d as Bt,e as It,f as Rt,g as Ar}from"./chunk-NPOKFU2J.js";import{Aa as pu,Ba as Dr,Ca as kr,Da as Yt,Ea as tn,Fa as dr,Ha as Pr,Ma as Qt,Na as Zt,Oa as bu,Pa as Pi,Q as Hn,Qa as Ai,Sa as Jt,V as Ut,W as ut,X as Jr,oa as fu,pa as Xt,ra as yr,ta as xt,ua as ur,va as hu,wa as Cr,xa as en,ya as cr,za as vu}from"./chunk-G4XN575R.js";import{c as du,d as bs,g as qr,i as ws,j as xs,l as Ea,m as _s}from"./chunk-3CIC7QKD.js";import{h as iu,l as qn,p as ou}from"./chunk-OTVSX5VU.js";import{Aa as at,Cb as Ql,Cc as _i,D as Gl,Db as Zl,Ea as vs,Eb as pe,Fb as Zr,Gb as Ci,H as $l,Hb as Jl,Kb as Ie,Lb as $r,Mb as We,Nb as Ke,Ob as $,Pb as q,Qb as ke,Rb as bt,Sb as wt,Ub as Oe,Xb as ue,Yc as nu,Z as hi,Zb as re,Zc as Cs,_ as vi,_c as Si,ac as eu,ad as Ei,bb as Ul,bc as ms,cb as Xl,cd as Ti,d as _h,da as ql,db as ps,e as jl,ea as hs,eb as Z,ec as jn,f as Pt,fa as pi,fb as _e,fc as Gn,gc as $n,id as au,ja as gi,jb as Yl,jc as mr,kc as ie,lc as Ze,mc as $e,nc as tu,oc as Ht,pa as Hl,pc as Wt,qa as ge,qc as Kt,ra as me,rb as je,rc as ru,sa as mi,sb as yi,sc as bi,ta as Wl,tb as gs,tc as ys,va as Kl,vc as wi,wc as xi,x as fi,xb as Ee}from"./chunk-ZY3XLMOC.js";var Ou=_h((Ta,Ms)=>{"use strict";(function(r,e){typeof Ta=="object"&&typeof Ms=="object"?Ms.exports=e():typeof define=="function"&&define.amd?define([],e):typeof Ta=="object"?Ta.QRCodeStyling=e():r.QRCodeStyling=e()})(Ta,()=>(()=>{var r={873:(a,i)=>{var o,s,l=function(){var u=function(E,A){var S=E,w=m[A],C=null,x=0,D=null,T=[],V={},z=function(R,N){C=function(G){for(var W=new Array(G),X=0;X<G;X+=1){W[X]=new Array(G);for(var de=0;de<G;de+=1)W[X][de]=null}return W}(x=4*S+17),j(0,0),j(x-7,0),j(0,x-7),Y(),U(),J(R,N),S>=7&&te(R),D==null&&(D=ae(S,w,T)),ne(D,N)},j=function(R,N){for(var G=-1;G<=7;G+=1)if(!(R+G<=-1||x<=R+G))for(var W=-1;W<=7;W+=1)N+W<=-1||x<=N+W||(C[R+G][N+W]=0<=G&&G<=6&&(W==0||W==6)||0<=W&&W<=6&&(G==0||G==6)||2<=G&&G<=4&&2<=W&&W<=4)},U=function(){for(var R=8;R<x-8;R+=1)C[R][6]==null&&(C[R][6]=R%2==0);for(var N=8;N<x-8;N+=1)C[6][N]==null&&(C[6][N]=N%2==0)},Y=function(){for(var R=g.getPatternPosition(S),N=0;N<R.length;N+=1)for(var G=0;G<R.length;G+=1){var W=R[N],X=R[G];if(C[W][X]==null)for(var de=-2;de<=2;de+=1)for(var Te=-2;Te<=2;Te+=1)C[W+de][X+Te]=de==-2||de==2||Te==-2||Te==2||de==0&&Te==0}},te=function(R){for(var N=g.getBCHTypeNumber(S),G=0;G<18;G+=1){var W=!R&&(N>>G&1)==1;C[Math.floor(G/3)][G%3+x-8-3]=W}for(G=0;G<18;G+=1)W=!R&&(N>>G&1)==1,C[G%3+x-8-3][Math.floor(G/3)]=W},J=function(R,N){for(var G=w<<3|N,W=g.getBCHTypeInfo(G),X=0;X<15;X+=1){var de=!R&&(W>>X&1)==1;X<6?C[X][8]=de:X<8?C[X+1][8]=de:C[x-15+X][8]=de}for(X=0;X<15;X+=1)de=!R&&(W>>X&1)==1,X<8?C[8][x-X-1]=de:X<9?C[8][15-X-1+1]=de:C[8][15-X-1]=de;C[x-8][8]=!R},ne=function(R,N){for(var G=-1,W=x-1,X=7,de=0,Te=g.getMaskFunction(N),xe=x-1;xe>0;xe-=2)for(xe==6&&(xe-=1);;){for(var fe=0;fe<2;fe+=1)if(C[W][xe-fe]==null){var ce=!1;de<R.length&&(ce=(R[de]>>>X&1)==1),Te(W,xe-fe)&&(ce=!ce),C[W][xe-fe]=ce,(X-=1)==-1&&(de+=1,X=7)}if((W+=G)<0||x<=W){W-=G,G=-G;break}}},ae=function(R,N,G){for(var W=b.getRSBlocks(R,N),X=_(),de=0;de<G.length;de+=1){var Te=G[de];X.put(Te.getMode(),4),X.put(Te.getLength(),g.getLengthInBits(Te.getMode(),R)),Te.write(X)}var xe=0;for(de=0;de<W.length;de+=1)xe+=W[de].dataCount;if(X.getLengthInBits()>8*xe)throw"code length overflow. ("+X.getLengthInBits()+">"+8*xe+")";for(X.getLengthInBits()+4<=8*xe&&X.put(0,4);X.getLengthInBits()%8!=0;)X.putBit(!1);for(;!(X.getLengthInBits()>=8*xe||(X.put(236,8),X.getLengthInBits()>=8*xe));)X.put(17,8);return function(fe,ce){for(var be=0,De=0,Me=0,we=new Array(ce.length),Se=new Array(ce.length),ye=0;ye<ce.length;ye+=1){var se=ce[ye].dataCount,I=ce[ye].totalCount-se;De=Math.max(De,se),Me=Math.max(Me,I),we[ye]=new Array(se);for(var H=0;H<we[ye].length;H+=1)we[ye][H]=255&fe.getBuffer()[H+be];be+=se;var oe=g.getErrorCorrectPolynomial(I),Q=y(we[ye],oe.getLength()-1).mod(oe);for(Se[ye]=new Array(oe.getLength()-1),H=0;H<Se[ye].length;H+=1){var ee=H+Q.getLength()-Se[ye].length;Se[ye][H]=ee>=0?Q.getAt(ee):0}}var he=0;for(H=0;H<ce.length;H+=1)he+=ce[H].totalCount;var le=new Array(he),ve=0;for(H=0;H<De;H+=1)for(ye=0;ye<ce.length;ye+=1)H<we[ye].length&&(le[ve]=we[ye][H],ve+=1);for(H=0;H<Me;H+=1)for(ye=0;ye<ce.length;ye+=1)H<Se[ye].length&&(le[ve]=Se[ye][H],ve+=1);return le}(X,W)};V.addData=function(R,N){var G=null;switch(N=N||"Byte"){case"Numeric":G=B(R);break;case"Alphanumeric":G=k(R);break;case"Byte":G=M(R);break;case"Kanji":G=O(R);break;default:throw"mode:"+N}T.push(G),D=null},V.isDark=function(R,N){if(R<0||x<=R||N<0||x<=N)throw R+","+N;return C[R][N]},V.getModuleCount=function(){return x},V.make=function(){if(S<1){for(var R=1;R<40;R++){for(var N=b.getRSBlocks(R,w),G=_(),W=0;W<T.length;W++){var X=T[W];G.put(X.getMode(),4),G.put(X.getLength(),g.getLengthInBits(X.getMode(),R)),X.write(G)}var de=0;for(W=0;W<N.length;W++)de+=N[W].dataCount;if(G.getLengthInBits()<=8*de)break}S=R}z(!1,function(){for(var Te=0,xe=0,fe=0;fe<8;fe+=1){z(!0,fe);var ce=g.getLostPoint(V);(fe==0||Te>ce)&&(Te=ce,xe=fe)}return xe}())},V.createTableTag=function(R,N){R=R||2;var G="";G+='<table style="',G+=" border-width: 0px; border-style: none;",G+=" border-collapse: collapse;",G+=" padding: 0px; margin: "+(N=N===void 0?4*R:N)+"px;",G+='">',G+="<tbody>";for(var W=0;W<V.getModuleCount();W+=1){G+="<tr>";for(var X=0;X<V.getModuleCount();X+=1)G+='<td style="',G+=" border-width: 0px; border-style: none;",G+=" border-collapse: collapse;",G+=" padding: 0px; margin: 0px;",G+=" width: "+R+"px;",G+=" height: "+R+"px;",G+=" background-color: ",G+=V.isDark(W,X)?"#000000":"#ffffff",G+=";",G+='"/>';G+="</tr>"}return(G+="</tbody>")+"</table>"},V.createSvgTag=function(R,N,G,W){var X={};typeof arguments[0]=="object"&&(R=(X=arguments[0]).cellSize,N=X.margin,G=X.alt,W=X.title),R=R||2,N=N===void 0?4*R:N,(G=typeof G=="string"?{text:G}:G||{}).text=G.text||null,G.id=G.text?G.id||"qrcode-description":null,(W=typeof W=="string"?{text:W}:W||{}).text=W.text||null,W.id=W.text?W.id||"qrcode-title":null;var de,Te,xe,fe,ce=V.getModuleCount()*R+2*N,be="";for(fe="l"+R+",0 0,"+R+" -"+R+",0 0,-"+R+"z ",be+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',be+=X.scalable?"":' width="'+ce+'px" height="'+ce+'px"',be+=' viewBox="0 0 '+ce+" "+ce+'" ',be+=' preserveAspectRatio="xMinYMin meet"',be+=W.text||G.text?' role="img" aria-labelledby="'+K([W.id,G.id].join(" ").trim())+'"':"",be+=">",be+=W.text?'<title id="'+K(W.id)+'">'+K(W.text)+"</title>":"",be+=G.text?'<description id="'+K(G.id)+'">'+K(G.text)+"</description>":"",be+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',be+='<path d="',Te=0;Te<V.getModuleCount();Te+=1)for(xe=Te*R+N,de=0;de<V.getModuleCount();de+=1)V.isDark(Te,de)&&(be+="M"+(de*R+N)+","+xe+fe);return(be+='" stroke="transparent" fill="black"/>')+"</svg>"},V.createDataURL=function(R,N){R=R||2,N=N===void 0?4*R:N;var G=V.getModuleCount()*R+2*N,W=N,X=G-N;return F(G,G,function(de,Te){if(W<=de&&de<X&&W<=Te&&Te<X){var xe=Math.floor((de-W)/R),fe=Math.floor((Te-W)/R);return V.isDark(fe,xe)?0:1}return 1})},V.createImgTag=function(R,N,G){R=R||2,N=N===void 0?4*R:N;var W=V.getModuleCount()*R+2*N,X="";return X+="<img",X+=' src="',X+=V.createDataURL(R,N),X+='"',X+=' width="',X+=W,X+='"',X+=' height="',X+=W,X+='"',G&&(X+=' alt="',X+=K(G),X+='"'),X+"/>"};var K=function(R){for(var N="",G=0;G<R.length;G+=1){var W=R.charAt(G);switch(W){case"<":N+="&lt;";break;case">":N+="&gt;";break;case"&":N+="&amp;";break;case'"':N+="&quot;";break;default:N+=W}}return N};return V.createASCII=function(R,N){if((R=R||1)<2)return function(we){we=we===void 0?2:we;var Se,ye,se,I,H,oe=1*V.getModuleCount()+2*we,Q=we,ee=oe-we,he={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},le={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},ve="";for(Se=0;Se<oe;Se+=2){for(se=Math.floor((Se-Q)/1),I=Math.floor((Se+1-Q)/1),ye=0;ye<oe;ye+=1)H="\u2588",Q<=ye&&ye<ee&&Q<=Se&&Se<ee&&V.isDark(se,Math.floor((ye-Q)/1))&&(H=" "),Q<=ye&&ye<ee&&Q<=Se+1&&Se+1<ee&&V.isDark(I,Math.floor((ye-Q)/1))?H+=" ":H+="\u2588",ve+=we<1&&Se+1>=ee?le[H]:he[H];ve+=`
`}return oe%2&&we>0?ve.substring(0,ve.length-oe-1)+Array(oe+1).join("\u2580"):ve.substring(0,ve.length-1)}(N);R-=1,N=N===void 0?2*R:N;var G,W,X,de,Te=V.getModuleCount()*R+2*N,xe=N,fe=Te-N,ce=Array(R+1).join("\u2588\u2588"),be=Array(R+1).join("  "),De="",Me="";for(G=0;G<Te;G+=1){for(X=Math.floor((G-xe)/R),Me="",W=0;W<Te;W+=1)de=1,xe<=W&&W<fe&&xe<=G&&G<fe&&V.isDark(X,Math.floor((W-xe)/R))&&(de=0),Me+=de?ce:be;for(X=0;X<R;X+=1)De+=Me+`
`}return De.substring(0,De.length-1)},V.renderTo2dContext=function(R,N){N=N||2;for(var G=V.getModuleCount(),W=0;W<G;W++)for(var X=0;X<G;X++)R.fillStyle=V.isDark(W,X)?"black":"white",R.fillRect(W*N,X*N,N,N)},V};u.stringToBytes=(u.stringToBytesFuncs={default:function(E){for(var A=[],S=0;S<E.length;S+=1){var w=E.charCodeAt(S);A.push(255&w)}return A}}).default,u.createStringToBytes=function(E,A){var S=function(){for(var C=L(E),x=function(){var U=C.read();if(U==-1)throw"eof";return U},D=0,T={};;){var V=C.read();if(V==-1)break;var z=x(),j=x()<<8|x();T[String.fromCharCode(V<<8|z)]=j,D+=1}if(D!=A)throw D+" != "+A;return T}(),w=63;return function(C){for(var x=[],D=0;D<C.length;D+=1){var T=C.charCodeAt(D);if(T<128)x.push(T);else{var V=S[C.charAt(D)];typeof V=="number"?(255&V)==V?x.push(V):(x.push(V>>>8),x.push(255&V)):x.push(w)}}return x}};var c,d,f,v,h,m={L:1,M:0,Q:3,H:2},g=(c=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d=1335,f=7973,h=function(E){for(var A=0;E!=0;)A+=1,E>>>=1;return A},(v={}).getBCHTypeInfo=function(E){for(var A=E<<10;h(A)-h(d)>=0;)A^=d<<h(A)-h(d);return 21522^(E<<10|A)},v.getBCHTypeNumber=function(E){for(var A=E<<12;h(A)-h(f)>=0;)A^=f<<h(A)-h(f);return E<<12|A},v.getPatternPosition=function(E){return c[E-1]},v.getMaskFunction=function(E){switch(E){case 0:return function(A,S){return(A+S)%2==0};case 1:return function(A,S){return A%2==0};case 2:return function(A,S){return S%3==0};case 3:return function(A,S){return(A+S)%3==0};case 4:return function(A,S){return(Math.floor(A/2)+Math.floor(S/3))%2==0};case 5:return function(A,S){return A*S%2+A*S%3==0};case 6:return function(A,S){return(A*S%2+A*S%3)%2==0};case 7:return function(A,S){return(A*S%3+(A+S)%2)%2==0};default:throw"bad maskPattern:"+E}},v.getErrorCorrectPolynomial=function(E){for(var A=y([1],0),S=0;S<E;S+=1)A=A.multiply(y([1,p.gexp(S)],0));return A},v.getLengthInBits=function(E,A){if(1<=A&&A<10)switch(E){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+E}else if(A<27)switch(E){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+E}else{if(!(A<41))throw"type:"+A;switch(E){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+E}}},v.getLostPoint=function(E){for(var A=E.getModuleCount(),S=0,w=0;w<A;w+=1)for(var C=0;C<A;C+=1){for(var x=0,D=E.isDark(w,C),T=-1;T<=1;T+=1)if(!(w+T<0||A<=w+T))for(var V=-1;V<=1;V+=1)C+V<0||A<=C+V||T==0&&V==0||D==E.isDark(w+T,C+V)&&(x+=1);x>5&&(S+=3+x-5)}for(w=0;w<A-1;w+=1)for(C=0;C<A-1;C+=1){var z=0;E.isDark(w,C)&&(z+=1),E.isDark(w+1,C)&&(z+=1),E.isDark(w,C+1)&&(z+=1),E.isDark(w+1,C+1)&&(z+=1),z!=0&&z!=4||(S+=3)}for(w=0;w<A;w+=1)for(C=0;C<A-6;C+=1)E.isDark(w,C)&&!E.isDark(w,C+1)&&E.isDark(w,C+2)&&E.isDark(w,C+3)&&E.isDark(w,C+4)&&!E.isDark(w,C+5)&&E.isDark(w,C+6)&&(S+=40);for(C=0;C<A;C+=1)for(w=0;w<A-6;w+=1)E.isDark(w,C)&&!E.isDark(w+1,C)&&E.isDark(w+2,C)&&E.isDark(w+3,C)&&E.isDark(w+4,C)&&!E.isDark(w+5,C)&&E.isDark(w+6,C)&&(S+=40);var j=0;for(C=0;C<A;C+=1)for(w=0;w<A;w+=1)E.isDark(w,C)&&(j+=1);return S+Math.abs(100*j/A/A-50)/5*10},v),p=function(){for(var E=new Array(256),A=new Array(256),S=0;S<8;S+=1)E[S]=1<<S;for(S=8;S<256;S+=1)E[S]=E[S-4]^E[S-5]^E[S-6]^E[S-8];for(S=0;S<255;S+=1)A[E[S]]=S;return{glog:function(w){if(w<1)throw"glog("+w+")";return A[w]},gexp:function(w){for(;w<0;)w+=255;for(;w>=256;)w-=255;return E[w]}}}();function y(E,A){if(E.length===void 0)throw E.length+"/"+A;var S=function(){for(var C=0;C<E.length&&E[C]==0;)C+=1;for(var x=new Array(E.length-C+A),D=0;D<E.length-C;D+=1)x[D]=E[D+C];return x}(),w={getAt:function(C){return S[C]},getLength:function(){return S.length},multiply:function(C){for(var x=new Array(w.getLength()+C.getLength()-1),D=0;D<w.getLength();D+=1)for(var T=0;T<C.getLength();T+=1)x[D+T]^=p.gexp(p.glog(w.getAt(D))+p.glog(C.getAt(T)));return y(x,0)},mod:function(C){if(w.getLength()-C.getLength()<0)return w;for(var x=p.glog(w.getAt(0))-p.glog(C.getAt(0)),D=new Array(w.getLength()),T=0;T<w.getLength();T+=1)D[T]=w.getAt(T);for(T=0;T<C.getLength();T+=1)D[T]^=p.gexp(p.glog(C.getAt(T))+x);return y(D,0).mod(C)}};return w}var b=function(){var E=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],A=function(w,C){var x={};return x.totalCount=w,x.dataCount=C,x},S={getRSBlocks:function(w,C){var x=function(te,J){switch(J){case m.L:return E[4*(te-1)+0];case m.M:return E[4*(te-1)+1];case m.Q:return E[4*(te-1)+2];case m.H:return E[4*(te-1)+3];default:return}}(w,C);if(x===void 0)throw"bad rs block @ typeNumber:"+w+"/errorCorrectionLevel:"+C;for(var D=x.length/3,T=[],V=0;V<D;V+=1)for(var z=x[3*V+0],j=x[3*V+1],U=x[3*V+2],Y=0;Y<z;Y+=1)T.push(A(j,U));return T}};return S}(),_=function(){var E=[],A=0,S={getBuffer:function(){return E},getAt:function(w){var C=Math.floor(w/8);return(E[C]>>>7-w%8&1)==1},put:function(w,C){for(var x=0;x<C;x+=1)S.putBit((w>>>C-x-1&1)==1)},getLengthInBits:function(){return A},putBit:function(w){var C=Math.floor(A/8);E.length<=C&&E.push(0),w&&(E[C]|=128>>>A%8),A+=1}};return S},B=function(E){var A=E,S={getMode:function(){return 1},getLength:function(x){return A.length},write:function(x){for(var D=A,T=0;T+2<D.length;)x.put(w(D.substring(T,T+3)),10),T+=3;T<D.length&&(D.length-T==1?x.put(w(D.substring(T,T+1)),4):D.length-T==2&&x.put(w(D.substring(T,T+2)),7))}},w=function(x){for(var D=0,T=0;T<x.length;T+=1)D=10*D+C(x.charAt(T));return D},C=function(x){if("0"<=x&&x<="9")return x.charCodeAt(0)-48;throw"illegal char :"+x};return S},k=function(E){var A=E,S={getMode:function(){return 2},getLength:function(C){return A.length},write:function(C){for(var x=A,D=0;D+1<x.length;)C.put(45*w(x.charAt(D))+w(x.charAt(D+1)),11),D+=2;D<x.length&&C.put(w(x.charAt(D)),6)}},w=function(C){if("0"<=C&&C<="9")return C.charCodeAt(0)-48;if("A"<=C&&C<="Z")return C.charCodeAt(0)-65+10;switch(C){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+C}};return S},M=function(E){var A=u.stringToBytes(E);return{getMode:function(){return 4},getLength:function(S){return A.length},write:function(S){for(var w=0;w<A.length;w+=1)S.put(A[w],8)}}},O=function(E){var A=u.stringToBytesFuncs.SJIS;if(!A)throw"sjis not supported.";(function(){var C=A("\u53CB");if(C.length!=2||(C[0]<<8|C[1])!=38726)throw"sjis not supported."})();var S=A(E),w={getMode:function(){return 8},getLength:function(C){return~~(S.length/2)},write:function(C){for(var x=S,D=0;D+1<x.length;){var T=(255&x[D])<<8|255&x[D+1];if(33088<=T&&T<=40956)T-=33088;else{if(!(57408<=T&&T<=60351))throw"illegal char at "+(D+1)+"/"+T;T-=49472}T=192*(T>>>8&255)+(255&T),C.put(T,13),D+=2}if(D<x.length)throw"illegal char at "+(D+1)}};return w},P=function(){var E=[],A={writeByte:function(S){E.push(255&S)},writeShort:function(S){A.writeByte(S),A.writeByte(S>>>8)},writeBytes:function(S,w,C){w=w||0,C=C||S.length;for(var x=0;x<C;x+=1)A.writeByte(S[x+w])},writeString:function(S){for(var w=0;w<S.length;w+=1)A.writeByte(S.charCodeAt(w))},toByteArray:function(){return E},toString:function(){var S="";S+="[";for(var w=0;w<E.length;w+=1)w>0&&(S+=","),S+=E[w];return S+"]"}};return A},L=function(E){var A=E,S=0,w=0,C=0,x={read:function(){for(;C<8;){if(S>=A.length){if(C==0)return-1;throw"unexpected end of file./"+C}var T=A.charAt(S);if(S+=1,T=="=")return C=0,-1;T.match(/^\s$/)||(w=w<<6|D(T.charCodeAt(0)),C+=6)}var V=w>>>C-8&255;return C-=8,V}},D=function(T){if(65<=T&&T<=90)return T-65;if(97<=T&&T<=122)return T-97+26;if(48<=T&&T<=57)return T-48+52;if(T==43)return 62;if(T==47)return 63;throw"c:"+T};return x},F=function(E,A,S){for(var w=function(j,U){var Y=j,te=U,J=new Array(j*U),ne={setPixel:function(R,N,G){J[N*Y+R]=G},write:function(R){R.writeString("GIF87a"),R.writeShort(Y),R.writeShort(te),R.writeByte(128),R.writeByte(0),R.writeByte(0),R.writeByte(0),R.writeByte(0),R.writeByte(0),R.writeByte(255),R.writeByte(255),R.writeByte(255),R.writeString(","),R.writeShort(0),R.writeShort(0),R.writeShort(Y),R.writeShort(te),R.writeByte(0);var N=ae(2);R.writeByte(2);for(var G=0;N.length-G>255;)R.writeByte(255),R.writeBytes(N,G,255),G+=255;R.writeByte(N.length-G),R.writeBytes(N,G,N.length-G),R.writeByte(0),R.writeString(";")}},ae=function(R){for(var N=1<<R,G=1+(1<<R),W=R+1,X=K(),de=0;de<N;de+=1)X.add(String.fromCharCode(de));X.add(String.fromCharCode(N)),X.add(String.fromCharCode(G));var Te,xe,fe,ce=P(),be=(Te=ce,xe=0,fe=0,{write:function(Se,ye){if(Se>>>ye)throw"length over";for(;xe+ye>=8;)Te.writeByte(255&(Se<<xe|fe)),ye-=8-xe,Se>>>=8-xe,fe=0,xe=0;fe|=Se<<xe,xe+=ye},flush:function(){xe>0&&Te.writeByte(fe)}});be.write(N,W);var De=0,Me=String.fromCharCode(J[De]);for(De+=1;De<J.length;){var we=String.fromCharCode(J[De]);De+=1,X.contains(Me+we)?Me+=we:(be.write(X.indexOf(Me),W),X.size()<4095&&(X.size()==1<<W&&(W+=1),X.add(Me+we)),Me=we)}return be.write(X.indexOf(Me),W),be.write(G,W),be.flush(),ce.toByteArray()},K=function(){var R={},N=0,G={add:function(W){if(G.contains(W))throw"dup key:"+W;R[W]=N,N+=1},size:function(){return N},indexOf:function(W){return R[W]},contains:function(W){return R[W]!==void 0}};return G};return ne}(E,A),C=0;C<A;C+=1)for(var x=0;x<E;x+=1)w.setPixel(x,C,S(x,C));var D=P();w.write(D);for(var T=function(){var j=0,U=0,Y=0,te="",J={},ne=function(K){te+=String.fromCharCode(ae(63&K))},ae=function(K){if(!(K<0)){if(K<26)return 65+K;if(K<52)return K-26+97;if(K<62)return K-52+48;if(K==62)return 43;if(K==63)return 47}throw"n:"+K};return J.writeByte=function(K){for(j=j<<8|255&K,U+=8,Y+=1;U>=6;)ne(j>>>U-6),U-=6},J.flush=function(){if(U>0&&(ne(j<<6-U),j=0,U=0),Y%3!=0)for(var K=3-Y%3,R=0;R<K;R+=1)te+="="},J.toString=function(){return te},J}(),V=D.toByteArray(),z=0;z<V.length;z+=1)T.writeByte(V[z]);return T.flush(),"data:image/gif;base64,"+T};return u}();l.stringToBytesFuncs["UTF-8"]=function(u){return function(c){for(var d=[],f=0;f<c.length;f++){var v=c.charCodeAt(f);v<128?d.push(v):v<2048?d.push(192|v>>6,128|63&v):v<55296||v>=57344?d.push(224|v>>12,128|v>>6&63,128|63&v):(f++,v=65536+((1023&v)<<10|1023&c.charCodeAt(f)),d.push(240|v>>18,128|v>>12&63,128|v>>6&63,128|63&v))}return d}(u)},(s=typeof(o=function(){return l})=="function"?o.apply(i,[]):o)===void 0||(a.exports=s)}},e={};function t(a){var i=e[a];if(i!==void 0)return i.exports;var o=e[a]={exports:{}};return r[a](o,o.exports,t),o.exports}t.n=a=>{var i=a&&a.__esModule?()=>a.default:()=>a;return t.d(i,{a:i}),i},t.d=(a,i)=>{for(var o in i)t.o(i,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:i[o]})},t.o=(a,i)=>Object.prototype.hasOwnProperty.call(a,i);var n={};return(()=>{"use strict";t.d(n,{default:()=>A});let a=S=>!!S&&typeof S=="object"&&!Array.isArray(S);function i(S,...w){if(!w.length)return S;let C=w.shift();return C!==void 0&&a(S)&&a(C)?(S=Object.assign({},S),Object.keys(C).forEach(x=>{let D=S[x],T=C[x];Array.isArray(D)&&Array.isArray(T)?S[x]=T:a(D)&&a(T)?S[x]=i(Object.assign({},D),T):S[x]=T}),i(S,...w)):S}function o(S,w){let C=document.createElement("a");C.download=w,C.href=S,document.body.appendChild(C),C.click(),document.body.removeChild(C)}let s={L:.07,M:.15,Q:.25,H:.3};class l{constructor({svg:w,type:C,window:x}){this._svg=w,this._type=C,this._window=x}draw(w,C,x,D){let T;switch(this._type){case"dots":T=this._drawDot;break;case"classy":T=this._drawClassy;break;case"classy-rounded":T=this._drawClassyRounded;break;case"rounded":T=this._drawRounded;break;case"extra-rounded":T=this._drawExtraRounded;break;default:T=this._drawSquare}T.call(this,{x:w,y:C,size:x,getNeighbor:D})}_rotateFigure({x:w,y:C,size:x,rotation:D=0,draw:T}){var V;let z=w+x/2,j=C+x/2;T(),(V=this._element)===null||V===void 0||V.setAttribute("transform",`rotate(${180*D/Math.PI},${z},${j})`)}_basicDot(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(x+C/2)),this._element.setAttribute("cy",String(D+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(x)),this._element.setAttribute("y",String(D)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_basicSideRounded(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${x} ${D}v ${C}h `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, 0 ${-C}`)}}))}_basicCornerRounded(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${x} ${D}v ${C}h ${C}v `+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_basicCornerExtraRounded(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${x} ${D}v ${C}h ${C}a ${C} ${C}, 0, 0, 0, ${-C} ${-C}`)}}))}_basicCornersRounded(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${x} ${D}v `+C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${C/2} ${C/2}h `+C/2+"v "+-C/2+`a ${C/2} ${C/2}, 0, 0, 0, ${-C/2} ${-C/2}`)}}))}_drawDot({x:w,y:C,size:x}){this._basicDot({x:w,y:C,size:x,rotation:0})}_drawSquare({x:w,y:C,size:x}){this._basicSquare({x:w,y:C,size:x,rotation:0})}_drawRounded({x:w,y:C,size:x,getNeighbor:D}){let T=D?+D(-1,0):0,V=D?+D(1,0):0,z=D?+D(0,-1):0,j=D?+D(0,1):0,U=T+V+z+j;if(U!==0)if(U>2||T&&V||z&&j)this._basicSquare({x:w,y:C,size:x,rotation:0});else{if(U===2){let Y=0;return T&&z?Y=Math.PI/2:z&&V?Y=Math.PI:V&&j&&(Y=-Math.PI/2),void this._basicCornerRounded({x:w,y:C,size:x,rotation:Y})}if(U===1){let Y=0;return z?Y=Math.PI/2:V?Y=Math.PI:j&&(Y=-Math.PI/2),void this._basicSideRounded({x:w,y:C,size:x,rotation:Y})}}else this._basicDot({x:w,y:C,size:x,rotation:0})}_drawExtraRounded({x:w,y:C,size:x,getNeighbor:D}){let T=D?+D(-1,0):0,V=D?+D(1,0):0,z=D?+D(0,-1):0,j=D?+D(0,1):0,U=T+V+z+j;if(U!==0)if(U>2||T&&V||z&&j)this._basicSquare({x:w,y:C,size:x,rotation:0});else{if(U===2){let Y=0;return T&&z?Y=Math.PI/2:z&&V?Y=Math.PI:V&&j&&(Y=-Math.PI/2),void this._basicCornerExtraRounded({x:w,y:C,size:x,rotation:Y})}if(U===1){let Y=0;return z?Y=Math.PI/2:V?Y=Math.PI:j&&(Y=-Math.PI/2),void this._basicSideRounded({x:w,y:C,size:x,rotation:Y})}}else this._basicDot({x:w,y:C,size:x,rotation:0})}_drawClassy({x:w,y:C,size:x,getNeighbor:D}){let T=D?+D(-1,0):0,V=D?+D(1,0):0,z=D?+D(0,-1):0,j=D?+D(0,1):0;T+V+z+j!==0?T||z?V||j?this._basicSquare({x:w,y:C,size:x,rotation:0}):this._basicCornerRounded({x:w,y:C,size:x,rotation:Math.PI/2}):this._basicCornerRounded({x:w,y:C,size:x,rotation:-Math.PI/2}):this._basicCornersRounded({x:w,y:C,size:x,rotation:Math.PI/2})}_drawClassyRounded({x:w,y:C,size:x,getNeighbor:D}){let T=D?+D(-1,0):0,V=D?+D(1,0):0,z=D?+D(0,-1):0,j=D?+D(0,1):0;T+V+z+j!==0?T||z?V||j?this._basicSquare({x:w,y:C,size:x,rotation:0}):this._basicCornerExtraRounded({x:w,y:C,size:x,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:w,y:C,size:x,rotation:-Math.PI/2}):this._basicCornersRounded({x:w,y:C,size:x,rotation:Math.PI/2})}}let u={dot:"dot",square:"square",extraRounded:"extra-rounded"},c=Object.values(u);class d{constructor({svg:w,type:C,window:x}){this._svg=w,this._type=C,this._window=x}draw(w,C,x,D){let T;switch(this._type){case u.square:T=this._drawSquare;break;case u.extraRounded:T=this._drawExtraRounded;break;default:T=this._drawDot}T.call(this,{x:w,y:C,size:x,rotation:D})}_rotateFigure({x:w,y:C,size:x,rotation:D=0,draw:T}){var V;let z=w+x/2,j=C+x/2;T(),(V=this._element)===null||V===void 0||V.setAttribute("transform",`rotate(${180*D/Math.PI},${z},${j})`)}_basicDot(w){let{size:C,x,y:D}=w,T=C/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${x+C/2} ${D}a ${C/2} ${C/2} 0 1 0 0.1 0zm 0 ${T}a ${C/2-T} ${C/2-T} 0 1 1 -0.1 0Z`)}}))}_basicSquare(w){let{size:C,x,y:D}=w,T=C/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${x} ${D}v ${C}h ${C}v `+-C+`zM ${x+T} ${D+T}h `+(C-2*T)+"v "+(C-2*T)+"h "+(2*T-C)+"z")}}))}_basicExtraRounded(w){let{size:C,x,y:D}=w,T=C/7;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${x} ${D+2.5*T}v `+2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*T} ${2.5*T}h `+2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*T} ${2.5*-T}v `+-2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*-T} ${2.5*-T}h `+-2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*-T} ${2.5*T}M ${x+2.5*T} ${D+T}h `+2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*T} ${1.5*T}v `+2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*-T} ${1.5*T}h `+-2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*-T} ${1.5*-T}v `+-2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*T} ${1.5*-T}`)}}))}_drawDot({x:w,y:C,size:x,rotation:D}){this._basicDot({x:w,y:C,size:x,rotation:D})}_drawSquare({x:w,y:C,size:x,rotation:D}){this._basicSquare({x:w,y:C,size:x,rotation:D})}_drawExtraRounded({x:w,y:C,size:x,rotation:D}){this._basicExtraRounded({x:w,y:C,size:x,rotation:D})}}let f={dot:"dot",square:"square"},v=Object.values(f);class h{constructor({svg:w,type:C,window:x}){this._svg=w,this._type=C,this._window=x}draw(w,C,x,D){let T;T=this._type===f.square?this._drawSquare:this._drawDot,T.call(this,{x:w,y:C,size:x,rotation:D})}_rotateFigure({x:w,y:C,size:x,rotation:D=0,draw:T}){var V;let z=w+x/2,j=C+x/2;T(),(V=this._element)===null||V===void 0||V.setAttribute("transform",`rotate(${180*D/Math.PI},${z},${j})`)}_basicDot(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(x+C/2)),this._element.setAttribute("cy",String(D+C/2)),this._element.setAttribute("r",String(C/2))}}))}_basicSquare(w){let{size:C,x,y:D}=w;this._rotateFigure(Object.assign(Object.assign({},w),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(x)),this._element.setAttribute("y",String(D)),this._element.setAttribute("width",String(C)),this._element.setAttribute("height",String(C))}}))}_drawDot({x:w,y:C,size:x,rotation:D}){this._basicDot({x:w,y:C,size:x,rotation:D})}_drawSquare({x:w,y:C,size:x,rotation:D}){this._basicSquare({x:w,y:C,size:x,rotation:D})}}let m="circle",g=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],p=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],b=(()=>{class S{constructor(C,x){this._roundSize=D=>this._options.dotsOptions.roundSize?Math.floor(D):D,this._window=x,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(C.width)),this._element.setAttribute("height",String(C.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),C.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${C.width} ${C.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=C.image,this._instanceId=S.instanceCount++,this._options=C}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}drawQR(C){return Pt(this,null,function*(){let x=C.getModuleCount(),D=Math.min(this._options.width,this._options.height)-2*this._options.margin,T=this._options.shape===m?D/Math.sqrt(2):D,V=this._roundSize(T/x),z={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=C,this._options.image){if(yield this.loadImage(),!this._image)return;let{imageOptions:j,qrOptions:U}=this._options,Y=j.imageSize*s[U.errorCorrectionLevel],te=Math.floor(Y*x*x);z=function({originalHeight:J,originalWidth:ne,maxHiddenDots:ae,maxHiddenAxisDots:K,dotSize:R}){let N={x:0,y:0},G={x:0,y:0};if(J<=0||ne<=0||ae<=0||R<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};let W=J/ne;return N.x=Math.floor(Math.sqrt(ae/W)),N.x<=0&&(N.x=1),K&&K<N.x&&(N.x=K),N.x%2==0&&N.x--,G.x=N.x*R,N.y=1+2*Math.ceil((N.x*W-1)/2),G.y=Math.round(G.x*W),(N.y*N.x>ae||K&&K<N.y)&&(K&&K<N.y?(N.y=K,N.y%2==0&&N.x--):N.y-=2,G.y=N.y*R,N.x=1+2*Math.ceil((N.y/W-1)/2),G.x=Math.round(G.y/W)),{height:G.y,width:G.x,hideYDots:N.y,hideXDots:N.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:te,maxHiddenAxisDots:x-14,dotSize:V})}this.drawBackground(),this.drawDots((j,U)=>{var Y,te,J,ne,ae,K;return!(this._options.imageOptions.hideBackgroundDots&&j>=(x-z.hideYDots)/2&&j<(x+z.hideYDots)/2&&U>=(x-z.hideXDots)/2&&U<(x+z.hideXDots)/2||!((Y=g[j])===null||Y===void 0)&&Y[U]||!((te=g[j-x+7])===null||te===void 0)&&te[U]||!((J=g[j])===null||J===void 0)&&J[U-x+7]||!((ne=p[j])===null||ne===void 0)&&ne[U]||!((ae=p[j-x+7])===null||ae===void 0)&&ae[U]||!((K=p[j])===null||K===void 0)&&K[U-x+7])}),this.drawCorners(),this._options.image&&(yield this.drawImage({width:z.width,height:z.height,count:x,dotSize:V}))})}drawBackground(){var C,x,D;let T=this._element,V=this._options;if(T){let z=(C=V.backgroundOptions)===null||C===void 0?void 0:C.gradient,j=(x=V.backgroundOptions)===null||x===void 0?void 0:x.color,U=V.height,Y=V.width;if(z||j){let te=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((D=V.backgroundOptions)===null||D===void 0)&&D.round&&(U=Y=Math.min(V.width,V.height),te.setAttribute("rx",String(U/2*V.backgroundOptions.round))),te.setAttribute("x",String(this._roundSize((V.width-Y)/2))),te.setAttribute("y",String(this._roundSize((V.height-U)/2))),te.setAttribute("width",String(Y)),te.setAttribute("height",String(U)),this._backgroundClipPath.appendChild(te),this._createColor({options:z,color:j,additionalRotation:0,x:0,y:0,height:V.height,width:V.width,name:`background-color-${this._instanceId}`})}}}drawDots(C){var x,D;if(!this._qr)throw"QR code is not defined";let T=this._options,V=this._qr.getModuleCount();if(V>T.width||V>T.height)throw"The canvas is too small.";let z=Math.min(T.width,T.height)-2*T.margin,j=T.shape===m?z/Math.sqrt(2):z,U=this._roundSize(j/V),Y=this._roundSize((T.width-V*U)/2),te=this._roundSize((T.height-V*U)/2),J=new l({svg:this._element,type:T.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(x=T.dotsOptions)===null||x===void 0?void 0:x.gradient,color:T.dotsOptions.color,additionalRotation:0,x:0,y:0,height:T.height,width:T.width,name:`dot-color-${this._instanceId}`});for(let ne=0;ne<V;ne++)for(let ae=0;ae<V;ae++)C&&!C(ne,ae)||!((D=this._qr)===null||D===void 0)&&D.isDark(ne,ae)&&(J.draw(Y+ae*U,te+ne*U,U,(K,R)=>!(ae+K<0||ne+R<0||ae+K>=V||ne+R>=V)&&!(C&&!C(ne+R,ae+K))&&!!this._qr&&this._qr.isDark(ne+R,ae+K)),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element));if(T.shape===m){let ne=this._roundSize((z/U-V)/2),ae=V+2*ne,K=Y-ne*U,R=te-ne*U,N=[],G=this._roundSize(ae/2);for(let W=0;W<ae;W++){N[W]=[];for(let X=0;X<ae;X++)W>=ne-1&&W<=ae-ne&&X>=ne-1&&X<=ae-ne||Math.sqrt((W-G)*(W-G)+(X-G)*(X-G))>G?N[W][X]=0:N[W][X]=this._qr.isDark(X-2*ne<0?X:X>=V?X-2*ne:X-ne,W-2*ne<0?W:W>=V?W-2*ne:W-ne)?1:0}for(let W=0;W<ae;W++)for(let X=0;X<ae;X++)N[W][X]&&(J.draw(K+X*U,R+W*U,U,(de,Te)=>{var xe;return!!(!((xe=N[W+Te])===null||xe===void 0)&&xe[X+de])}),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";let C=this._element,x=this._options;if(!C)throw"Element code is not defined";let D=this._qr.getModuleCount(),T=Math.min(x.width,x.height)-2*x.margin,V=x.shape===m?T/Math.sqrt(2):T,z=this._roundSize(V/D),j=7*z,U=3*z,Y=this._roundSize((x.width-D*z)/2),te=this._roundSize((x.height-D*z)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([J,ne,ae])=>{var K,R,N,G,W,X,de,Te,xe,fe,ce,be,De,Me;let we=Y+J*z*(D-7),Se=te+ne*z*(D-7),ye=this._dotsClipPath,se=this._dotsClipPath;if((!((K=x.cornersSquareOptions)===null||K===void 0)&&K.gradient||!((R=x.cornersSquareOptions)===null||R===void 0)&&R.color)&&(ye=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),ye.setAttribute("id",`clip-path-corners-square-color-${J}-${ne}-${this._instanceId}`),this._defs.appendChild(ye),this._cornersSquareClipPath=this._cornersDotClipPath=se=ye,this._createColor({options:(N=x.cornersSquareOptions)===null||N===void 0?void 0:N.gradient,color:(G=x.cornersSquareOptions)===null||G===void 0?void 0:G.color,additionalRotation:ae,x:we,y:Se,height:j,width:j,name:`corners-square-color-${J}-${ne}-${this._instanceId}`})),((W=x.cornersSquareOptions)===null||W===void 0?void 0:W.type)&&c.includes(x.cornersSquareOptions.type)){let I=new d({svg:this._element,type:x.cornersSquareOptions.type,window:this._window});I.draw(we,Se,j,ae),I._element&&ye&&ye.appendChild(I._element)}else{let I=new l({svg:this._element,type:((X=x.cornersSquareOptions)===null||X===void 0?void 0:X.type)||x.dotsOptions.type,window:this._window});for(let H=0;H<g.length;H++)for(let oe=0;oe<g[H].length;oe++)!((de=g[H])===null||de===void 0)&&de[oe]&&(I.draw(we+oe*z,Se+H*z,z,(Q,ee)=>{var he;return!!(!((he=g[H+ee])===null||he===void 0)&&he[oe+Q])}),I._element&&ye&&ye.appendChild(I._element))}if((!((Te=x.cornersDotOptions)===null||Te===void 0)&&Te.gradient||!((xe=x.cornersDotOptions)===null||xe===void 0)&&xe.color)&&(se=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),se.setAttribute("id",`clip-path-corners-dot-color-${J}-${ne}-${this._instanceId}`),this._defs.appendChild(se),this._cornersDotClipPath=se,this._createColor({options:(fe=x.cornersDotOptions)===null||fe===void 0?void 0:fe.gradient,color:(ce=x.cornersDotOptions)===null||ce===void 0?void 0:ce.color,additionalRotation:ae,x:we+2*z,y:Se+2*z,height:U,width:U,name:`corners-dot-color-${J}-${ne}-${this._instanceId}`})),((be=x.cornersDotOptions)===null||be===void 0?void 0:be.type)&&v.includes(x.cornersDotOptions.type)){let I=new h({svg:this._element,type:x.cornersDotOptions.type,window:this._window});I.draw(we+2*z,Se+2*z,U,ae),I._element&&se&&se.appendChild(I._element)}else{let I=new l({svg:this._element,type:((De=x.cornersDotOptions)===null||De===void 0?void 0:De.type)||x.dotsOptions.type,window:this._window});for(let H=0;H<p.length;H++)for(let oe=0;oe<p[H].length;oe++)!((Me=p[H])===null||Me===void 0)&&Me[oe]&&(I.draw(we+oe*z,Se+H*z,z,(Q,ee)=>{var he;return!!(!((he=p[H+ee])===null||he===void 0)&&he[oe+Q])}),I._element&&se&&se.appendChild(I._element))}})}loadImage(){return new Promise((C,x)=>{var D;let T=this._options;if(!T.image)return x("Image is not defined");if(!((D=T.nodeCanvas)===null||D===void 0)&&D.loadImage)T.nodeCanvas.loadImage(T.image).then(V=>{var z,j;if(this._image=V,this._options.imageOptions.saveAsBlob){let U=(z=T.nodeCanvas)===null||z===void 0?void 0:z.createCanvas(this._image.width,this._image.height);(j=U?.getContext("2d"))===null||j===void 0||j.drawImage(V,0,0),this._imageUri=U?.toDataURL()}C()}).catch(x);else{let V=new this._window.Image;typeof T.imageOptions.crossOrigin=="string"&&(V.crossOrigin=T.imageOptions.crossOrigin),this._image=V,V.onload=()=>Pt(this,null,function*(){this._options.imageOptions.saveAsBlob&&(this._imageUri=yield function(z,j){return Pt(this,null,function*(){return new Promise(U=>{let Y=new j.XMLHttpRequest;Y.onload=function(){let te=new j.FileReader;te.onloadend=function(){U(te.result)},te.readAsDataURL(Y.response)},Y.open("GET",z),Y.responseType="blob",Y.send()})})}(T.image||"",this._window)),C()}),V.src=T.image}})}drawImage(V){return Pt(this,arguments,function*({width:C,height:x,count:D,dotSize:T}){let z=this._options,j=this._roundSize((z.width-D*T)/2),U=this._roundSize((z.height-D*T)/2),Y=j+this._roundSize(z.imageOptions.margin+(D*T-C)/2),te=U+this._roundSize(z.imageOptions.margin+(D*T-x)/2),J=C-2*z.imageOptions.margin,ne=x-2*z.imageOptions.margin,ae=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");ae.setAttribute("href",this._imageUri||""),ae.setAttribute("x",String(Y)),ae.setAttribute("y",String(te)),ae.setAttribute("width",`${J}px`),ae.setAttribute("height",`${ne}px`),this._element.appendChild(ae)})}_createColor({options:C,color:x,additionalRotation:D,x:T,y:V,height:z,width:j,name:U}){let Y=j>z?j:z,te=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(te.setAttribute("x",String(T)),te.setAttribute("y",String(V)),te.setAttribute("height",String(z)),te.setAttribute("width",String(j)),te.setAttribute("clip-path",`url('#clip-path-${U}')`),C){let J;if(C.type==="radial")J=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),J.setAttribute("id",U),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("fx",String(T+j/2)),J.setAttribute("fy",String(V+z/2)),J.setAttribute("cx",String(T+j/2)),J.setAttribute("cy",String(V+z/2)),J.setAttribute("r",String(Y/2));else{let ne=((C.rotation||0)+D)%(2*Math.PI),ae=(ne+2*Math.PI)%(2*Math.PI),K=T+j/2,R=V+z/2,N=T+j/2,G=V+z/2;ae>=0&&ae<=.25*Math.PI||ae>1.75*Math.PI&&ae<=2*Math.PI?(K-=j/2,R-=z/2*Math.tan(ne),N+=j/2,G+=z/2*Math.tan(ne)):ae>.25*Math.PI&&ae<=.75*Math.PI?(R-=z/2,K-=j/2/Math.tan(ne),G+=z/2,N+=j/2/Math.tan(ne)):ae>.75*Math.PI&&ae<=1.25*Math.PI?(K+=j/2,R+=z/2*Math.tan(ne),N-=j/2,G-=z/2*Math.tan(ne)):ae>1.25*Math.PI&&ae<=1.75*Math.PI&&(R+=z/2,K+=j/2/Math.tan(ne),G-=z/2,N-=j/2/Math.tan(ne)),J=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),J.setAttribute("id",U),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("x1",String(Math.round(K))),J.setAttribute("y1",String(Math.round(R))),J.setAttribute("x2",String(Math.round(N))),J.setAttribute("y2",String(Math.round(G)))}C.colorStops.forEach(({offset:ne,color:ae})=>{let K=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");K.setAttribute("offset",100*ne+"%"),K.setAttribute("stop-color",ae),J.appendChild(K)}),te.setAttribute("fill",`url('#${U}')`),this._defs.appendChild(J)}else x&&te.setAttribute("fill",x);this._element.appendChild(te)}}return S.instanceCount=0,S})(),_="canvas",B={};for(let S=0;S<=40;S++)B[S]=S;let k={type:_,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:B[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function M(S){let w=Object.assign({},S);if(!w.colorStops||!w.colorStops.length)throw"Field 'colorStops' is required in gradient";return w.rotation?w.rotation=Number(w.rotation):w.rotation=0,w.colorStops=w.colorStops.map(C=>Object.assign(Object.assign({},C),{offset:Number(C.offset)})),w}function O(S){let w=Object.assign({},S);return w.width=Number(w.width),w.height=Number(w.height),w.margin=Number(w.margin),w.imageOptions=Object.assign(Object.assign({},w.imageOptions),{hideBackgroundDots:!!w.imageOptions.hideBackgroundDots,imageSize:Number(w.imageOptions.imageSize),margin:Number(w.imageOptions.margin)}),w.margin>Math.min(w.width,w.height)&&(w.margin=Math.min(w.width,w.height)),w.dotsOptions=Object.assign({},w.dotsOptions),w.dotsOptions.gradient&&(w.dotsOptions.gradient=M(w.dotsOptions.gradient)),w.cornersSquareOptions&&(w.cornersSquareOptions=Object.assign({},w.cornersSquareOptions),w.cornersSquareOptions.gradient&&(w.cornersSquareOptions.gradient=M(w.cornersSquareOptions.gradient))),w.cornersDotOptions&&(w.cornersDotOptions=Object.assign({},w.cornersDotOptions),w.cornersDotOptions.gradient&&(w.cornersDotOptions.gradient=M(w.cornersDotOptions.gradient))),w.backgroundOptions&&(w.backgroundOptions=Object.assign({},w.backgroundOptions),w.backgroundOptions.gradient&&(w.backgroundOptions.gradient=M(w.backgroundOptions.gradient))),w}var P=t(873),L=t.n(P);function F(S){if(!S)throw new Error("Extension must be defined");S[0]==="."&&(S=S.substring(1));let w={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[S.toLowerCase()];if(!w)throw new Error(`Extension "${S}" is not supported`);return w}class E{constructor(w){w?.jsdom?this._window=new w.jsdom("",{resources:"usable"}).window:this._window=window,this._options=w?O(i(k,w)):k,this.update()}static _clearContainer(w){w&&(w.innerHTML="")}_setupSvg(){if(!this._qr)return;let w=new b(this._options,this._window);this._svg=w.getElement(),this._svgDrawingPromise=w.drawQR(this._qr).then(()=>{var C;this._svg&&((C=this._extension)===null||C===void 0||C.call(this,w.getElement(),this._options))})}_setupCanvas(){var w,C;this._qr&&(!((w=this._options.nodeCanvas)===null||w===void 0)&&w.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(C=this._svgDrawingPromise)===null||C===void 0?void 0:C.then(()=>{var x;if(!this._svg)return;let D=this._svg,T=new this._window.XMLSerializer().serializeToString(D),V=btoa(T),z=`data:${F("svg")};base64,${V}`;if(!((x=this._options.nodeCanvas)===null||x===void 0)&&x.loadImage)return this._options.nodeCanvas.loadImage(z).then(j=>{var U,Y;j.width=this._options.width,j.height=this._options.height,(Y=(U=this._nodeCanvas)===null||U===void 0?void 0:U.getContext("2d"))===null||Y===void 0||Y.drawImage(j,0,0)});{let j=new this._window.Image;return new Promise(U=>{j.onload=()=>{var Y,te;(te=(Y=this._domCanvas)===null||Y===void 0?void 0:Y.getContext("2d"))===null||te===void 0||te.drawImage(j,0,0),U()},j.src=z})}}))}_getElement(w="png"){return Pt(this,null,function*(){if(!this._qr)throw"QR code is empty";return w.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),yield this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),yield this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)})}update(w){E._clearContainer(this._container),this._options=w?O(i(this._options,w)):this._options,this._options.data&&(this._qr=L()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(C){switch(!0){case/^[0-9]*$/.test(C):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(C):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===_?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(w){if(w){if(typeof w.appendChild!="function")throw"Container should be a single DOM node";this._options.type===_?this._domCanvas&&w.appendChild(this._domCanvas):this._svg&&w.appendChild(this._svg),this._container=w}}applyExtension(w){if(!w)throw"Extension function should be defined.";this._extension=w,this.update()}deleteExtension(){this._extension=void 0,this.update()}getRawData(w="png"){return Pt(this,null,function*(){if(!this._qr)throw"QR code is empty";let C=yield this._getElement(w),x=F(w);if(!C)return null;if(w.toLowerCase()==="svg"){let D=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(C)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(D):new Blob([D],{type:x})}return new Promise(D=>{let T=C;if("toBuffer"in T)if(x==="image/png")D(T.toBuffer(x));else if(x==="image/jpeg")D(T.toBuffer(x));else{if(x!=="application/pdf")throw Error("Unsupported extension");D(T.toBuffer(x))}else"toBlob"in T&&T.toBlob(D,x,1)})})}download(w){return Pt(this,null,function*(){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let C="png",x="qr";typeof w=="string"?(C=w,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof w=="object"&&w!==null&&(w.name&&(x=w.name),w.extension&&(C=w.extension));let D=yield this._getElement(C);if(D)if(C.toLowerCase()==="svg"){let T=new XMLSerializer().serializeToString(D);T=`<?xml version="1.0" standalone="no"?>\r
`+T,o(`data:${F(C)};charset=utf-8,${encodeURIComponent(T)}`,`${x}.svg`)}else o(D.toDataURL(F(C)),`${x}.${C}`)})}}let A=E})(),n.default})())});var Es=(r,e)=>e.id;function Eh(r,e){if(r&1){let t=Oe();$(0,"mat-chip-row",15),ue("removed",function(){let a=ge(t).$implicit,i=re();return me(i.removeTag(a))}),ie(1),$(2,"button",16)(3,"mat-icon"),ie(4,"cancel"),q()()()}if(r&2){let t=e.$implicit;pe("removable",!0),Z(),$e(" ",t.name," "),Z(),Zl("aria-label","remove "+t.name)}}function Th(r,e){if(r&1&&($(0,"mat-option",13),ie(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),$e(" ",t.name," ")}}function Mh(r,e){if(r&1&&($(0,"mat-list-option",13),ie(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),$e(" ",t.title," ")}}function Dh(r,e){if(r&1){let t=Oe();$(0,"mat-selection-list",17),Kt("ngModelChange",function(a){ge(t);let i=re();return Wt(i.selectedCollate,a)||(i.selectedCollate=a),me(a)}),ue("selectionChange",function(a){ge(t);let i=re();return me(i.onCollateSelect(a))}),We(1,Mh,2,2,"mat-list-option",13,Es),q(),$(3,"mat-paginator",18),ue("page",function(a){ge(t);let i=re();return me(i.handlePageEvent(a))}),q()}if(r&2){let t=re();Ht("ngModel",t.selectedCollate),pe("multiple",!1),Z(),Ke(t.collates),Z(2),pe("length",t.totalCount)("pageSize",t.limit)}}function kh(r,e){r&1&&($(0,"p"),ie(1,"No collates could be found."),q())}var Pu=(()=>{class r{constructor(t,n,a,i,o){this.snackBar=t,this.fb=n,this.router=a,this.collateService=i,this.dialog=o,this.collates=[],this.searchTags=[],this.selectedCollate=null,this.searchTerm="",this.limit=5,this.offset=0,this.totalCount=0,this.separatorKeysCodes=[13,188],this.form=this.fb.group({tag:[""]}),this.loading=!1}ngOnInit(){this.searchCollates(),this.filteredTags=this.form.controls.tag.valueChanges.pipe(hi(""),$l(t=>t?t.length>=2:!1),vi(t=>this.collateService.getCollateTags(t).pipe(fi(n=>n.results))))}searchCollates(){this.loading=!0,this.collateService.getCollates(this.limit,this.offset,this.searchTerm,this.searchTags.map(t=>t.id)).subscribe({next:t=>{this.collates=t.results,this.totalCount=t.count,this.loading=!1},error:()=>{this.loading=!1,this.snackBar.open("Error loading collates","Dismiss")}})}onCollateSelect(t){this.selectedCollate=t.options[0].value,this.router.navigate([`/collate/view/${t.options[0].value.id}`]).then(n=>console.log(n))}openCreateCollateDialog(){this.dialog.open(Su).afterClosed().subscribe(n=>{n&&this.collateService.createCollate(n.title,n.greeting).subscribe(a=>{this.router.navigate([`/collate/edit/${a.id}`]).then(i=>console.log(i))})})}handlePageEvent(t){this.limit=t.pageSize,this.offset=t.pageIndex*this.limit,this.searchCollates()}addTag(t){let n=t.option.value;n&&!this.searchTags.find(a=>a.id===n.id)&&this.searchTags.push(n),this.form.controls.tag.setValue(""),this.searchCollates()}removeTag(t){let n=this.searchTags.indexOf(t);n>=0&&this.searchTags.splice(n,1),this.searchCollates()}static{this.\u0275fac=function(n){return new(n||r)(_e(br),_e(Yt),_e(qn),_e(rn),_e(Un))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate"]],decls:33,vars:8,consts:[["chipGrid",""],["auto","matAutocomplete"],[1,"collate-container"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[1,"search-box"],["mat-button","",2,"width","100%",3,"click"],["appearance","outlined",2,"width","500px"],[2,"width","100%"],["matInput","","placeholder","Search Collates",3,"ngModelChange","ngModel"],[3,"removable"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-raised-button","","color","primary",3,"click"],[3,"removed","removable"],["matChipRemove",""],[3,"ngModelChange","selectionChange","ngModel","multiple"],[3,"page","length","pageSize"]],template:function(n,a){if(n&1){let i=Oe();$(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),ie(4,"C|nder Collates"),q(),ke(5,"br"),q()(),$(6,"div",5)(7,"div")(8,"button",6),ue("click",function(){return ge(i),me(a.openCreateCollateDialog())}),$(9,"h3"),ie(10,"+ Create Collate From Projects"),q()()(),ke(11,"hr"),$(12,"mat-card",7)(13,"mat-card-content")(14,"mat-form-field",8)(15,"input",9),Kt("ngModelChange",function(s){return ge(i),Wt(a.searchTerm,s)||(a.searchTerm=s),me(s)}),ue("ngModelChange",function(){return ge(i),me(a.searchCollates())}),q()(),$(16,"mat-form-field",8)(17,"mat-label"),ie(18,"Search Tags"),q(),$(19,"mat-chip-grid",null,0),We(21,Eh,5,3,"mat-chip-row",10,Es),ke(23,"input",11),q(),$(24,"mat-autocomplete",12,1),ue("optionSelected",function(s){return ge(i),me(a.addTag(s))}),We(26,Th,2,2,"mat-option",13,Es),wi(28,"async"),q()(),$(29,"button",14),ue("click",function(){return ge(i),me(a.searchCollates())}),ie(30,"Search"),q(),Ee(31,Dh,4,4)(32,kh,2,0,"p"),q()()()()}if(n&2){let i=mr(20),o=mr(25);Z(15),Ht("ngModel",a.searchTerm),Z(6),Ke(a.searchTags),Z(2),pe("matChipInputFor",i)("matChipInputSeparatorKeyCodes",a.separatorKeysCodes)("formControl",a.form.controls.tag)("matAutocomplete",o),Z(3),Ke(xi(28,6,a.filteredTags)),Z(5),Ie(a.collates.length>0?31:32)}},dependencies:[Qt,tn,Xt,xt,en,Zt,ki,Di,Pr,Kn,Wn,ut,Ai,Ut,Bi,_u,xu,wu,Hn,Oi,Ei,dr,pu,Fi],styles:[".collate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:80vh}.search-box[_ngcontent-%COMP%]{width:500px}"]})}}return r})();var Au=(()=>{class r{constructor(){this.collate=null}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-header"]],inputs:{collate:"collate"},decls:7,vars:2,consts:[[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"]],template:function(n,a){n&1&&($(0,"div",0)(1,"div",1)(2,"h1"),ie(3),q(),ke(4,"br"),$(5,"div",2),ie(6),q()()()),n&2&&(Z(3),Ze(a.collate==null?null:a.collate.title),Z(3),Ze(a.collate==null?null:a.collate.greeting))},styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();function Ah(r,e){if(r&1&&($(0,"p"),ie(1),ke(2,"br"),ie(3),q(),ke(4,"mat-progress-bar",8)),r&2){let t=re();Z(),$e("Elapsed Time: ",t.elapsedTime," seconds"),Z(2),$e(" ",t.progress," ")}}var ao=(()=>{class r{constructor(t,n,a,i,o){this.snackBar=t,this.ws=n,this.fb=a,this.web=i,this.sb=o,this.projects=[],this.loading=!1,this.searchStartTime=null,this.elapsedTime="0.00",this.progress="",this.form=this.fb.group({searchQuery:new Cr("",yr.required),searchMode:new Cr("gene",yr.required)}),this.searchResultID=new at,this.ws.searchWSConnection?.subscribe(s=>{if(s&&s.type==="search_status")switch(s.status){case"complete":this.loading=!1,clearInterval(this.timerInterval);let l=this.calculateElapsedTime();this.progress="",this.showSnackBar(`Search complete in ${l} seconds`),this.searchResultID.emit(parseInt(s.id));break;case"in_progress":this.progress=`Current progress: ${s.current_progress}/${s.found_files}`;break;case"error":this.loading=!1,this.progress="Search error",this.showSnackBar("Search error");break}})}runSearch(){return Pt(this,null,function*(){if(this.form.invalid)return;this.loading=!0,this.progress="Current progress: search initiated",this.searchStartTime=new Date,this.elapsedTime="0.00",this.timerInterval=setInterval(()=>{this.elapsedTime=this.calculateElapsedTime().toFixed(2)},200);let t=[];if(this.projects.length>0){let n=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();if(n)for(let a of n)t.push(a.id)}if(this.form.value.searchQuery&&this.form.value.searchMode){let a=this.form.value.searchQuery.toUpperCase().split("OR").map(i=>`"${i.trim().replace(/'/g,"").replace(/"/g,"")}"`);this.web.createSearch(t,a.join(" OR "),this.web.searchSessionID,1e-9,1e-9,this.form.value.searchMode).subscribe({next:()=>{this.sb.open("Search queued","Dismiss",{duration:2e3})},error:()=>{this.loading=!1,clearInterval(this.timerInterval),this.showSnackBar("Search error")}})}})}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}calculateElapsedTime(){return this.searchStartTime?(new Date().getTime()-this.searchStartTime.getTime())/1e3:0}static{this.\u0275fac=function(n){return new(n||r)(_e(br),_e(Li),_e(Yt),_e(Jt),_e(br))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-search"]],inputs:{projects:"projects"},outputs:{searchResultID:"searchResultID"},decls:22,vars:2,consts:[["appearance","outlined"],[2,"display","flex","gap","20px","align-items","center",3,"ngSubmit","formGroup"],[2,"width","500px"],["matInput","","placeholder","Search Query","formControlName","searchQuery"],["formControlName","searchMode"],["value","pi"],["value","gene"],["mat-icon-button","","color","primary","type","submit"],["mode","indeterminate"]],template:function(n,a){n&1&&($(0,"mat-card",0)(1,"mat-card-content")(2,"form",1),ue("ngSubmit",function(){return a.runSearch()}),$(3,"mat-form-field",2),ke(4,"input",3),q(),$(5,"mat-form-field")(6,"mat-label"),ie(7,"Search Mode"),q(),$(8,"mat-select",4)(9,"mat-option",5),ie(10,"Primary Ids"),q(),$(11,"mat-option",6),ie(12,"Gene Names"),q()()(),$(13,"button",7)(14,"mat-icon"),ie(15,"search"),q()()(),$(16,"p"),ie(17," For multiple search terms separate them with "),$(18,"b"),ie(19,"OR"),q(),ie(20,". "),q(),Ee(21,Ah,5,2),q()()),n&2&&(Z(2),pe("formGroup",a.form),Z(19),Ie(a.loading?21:-1))},dependencies:[Zt,dr,cr,Xt,xt,ur,Dr,kr,Qt,Jr,Ut,Kn,Wn,Hn,bu,Pr,Eu],encapsulation:2})}}return r})();var Ih=jl(Sh());Ss.plotlyjs=Ih;var Bu=(()=>{class r{set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set renameCondition(t){t?this._renameCondition=t:this._renameCondition={}}get renameCondition(){return this._renameCondition}set data(t){this._data=t,this.graphLayout.title.text=t?.analysis_group?.name||"",this.graphLayout.yaxis.title=this.searchTerm||"",this.conditionA=t?.condition_A||"",this.conditionB=t?.condition_B||"",this.drawGraph()}get data(){return this._data}set expanded(t){this._expanded=t,this.data&&this.drawGraph()}get expanded(){return this._expanded}set colorMap(t){t&&(this._colorMap=t,this.data&&t&&this.drawGraph())}get colorMap(){return this._colorMap}constructor(t,n){this.graph=t,this.accounts=n,this._data=null,this._renameCondition={},this._searchTerm="",this._expanded=!1,this.graphData=[],this.graphLayout={title:{text:"",font:{size:16}},height:400,margin:{l:150,r:100,b:100,t:100},yaxis:{title:this.searchTerm,tickfont:{size:14}}},this.conditionA="",this.conditionB="",this.valueA=[],this.valueB=[],this.barSize=50,this.revision=0,this._colorMap={},this.currentColor=0,this.graph.redrawTrigger.subscribe(()=>{this.drawGraph()})}drawGraph(){this.loadPlotSettings(),this.graph.plotSettings.showTitle||(this.graphLayout.title.text="");let t=this.renameCondition[this.conditionA];t||(t=this.conditionA);let n=this.renameCondition[this.conditionB];n||(n=this.conditionB);let a=document.getElementsByTagName("body")[0],o=window.getComputedStyle(a).backgroundColor;this.accounts.userAccount.darkMode?(this.graphLayout.plot_bgcolor=o,this.graphLayout.paper_bgcolor=o,this.graphLayout.font={color:"white",size:14},this.graphLayout.xaxis.tickfont.color="white",this.graphLayout.yaxis.tickfont.color="white"):(this.graphLayout.plot_bgcolor="#FFFFFF",this.graphLayout.paper_bgcolor="#FFFFFF",this.graphLayout.font={color:"black",size:14});let s=0;if(this.data&&this.data.condition_A&&this.data.condition_B&&this.data.searched_data&&!this.expanded){this.conditionA=this.data.condition_A||"",this.conditionB=this.data.condition_B||"",this.valueA=this.data.searched_data.filter(h=>h.Condition===this.conditionA).map(h=>h.Value),this.valueB=this.data.searched_data.filter(h=>h.Condition===this.conditionB).map(h=>h.Value);let l=this.calculateMean(this.valueA),u=this.calculateMean(this.valueB);this.colorMap[this.conditionA]||(this.colorMap[this.conditionA]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let c={x:[t],y:[l],type:"bar",mode:"markers",name:t,error_y:{type:"data",array:[this.calculateWhisker(this.valueA)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionA]},showlegend:!1},d=this.drawTransparentBoxPlot(this.valueA,t);this.colorMap[this.conditionB]||(this.colorMap[this.conditionB]=this.graph.defaultColorList[this.currentColor],this.currentColor++);let f={x:[n],y:[u],type:"bar",mode:"markers",name:n,error_y:{type:"data",array:[this.calculateWhisker(this.valueB)],visible:!0},line:{color:"black"},marker:{color:this.colorMap[this.conditionB]},showlegend:!1},v=this.drawTransparentBoxPlot(this.valueB,n);s=2,this.graphData=[c,d,f,v]}else if(this.data&&(this.expanded||this.data.condition_A==""||this.data.condition_B=="")){let l=Array.from(new Set(this.data.searched_data.map(v=>v.Condition))),u=l.map(v=>{let h=this.data.searched_data.filter(m=>m.Condition===v).map(m=>m.Value);return this.calculateMean(h)}),c=l.map(v=>{let h=this.data.searched_data.filter(m=>m.Condition===v).map(m=>m.Value);return this.calculateWhisker(h)}),d=l.map((v,h)=>{this.colorMap[v]||(this.colorMap[v]=this.graph.defaultColorList[this.currentColor],this.currentColor++,this.currentColor>=this.graph.defaultColorList.length&&(this.currentColor=0));let m=this.renameCondition[v];return m||(m=v),{x:[m],y:[u[h]],type:"bar",mode:"markers",name:m,error_y:{type:"data",array:[c[h]],visible:!0},line:{color:"black"},marker:{color:this.colorMap[v]},showlegend:!1}}),f=l.map((v,h)=>{let m=this.renameCondition[v];m||(m=v);let g=this.data.searched_data.filter(p=>p.Condition===v).map(p=>p.Value);return this.drawTransparentBoxPlot(g,m)});s=l.length,this.graphData=[...d,...f]}console.log(this.colorMap),this.graphLayout.width=this.graphLayout.margin.l+this.graphLayout.margin.r+this.barSize*s,this.revision++,console.log(this.graphData)}calculateMean(t){return t.reduce((a,i)=>a+i,0)/t.length}calculateWhisker(t){let n=this.calculateMean(t),a=t.reduce((i,o)=>i+Math.pow(o-n,2),0)/t.length;return Math.sqrt(a)}drawTransparentBoxPlot(t,n){return{x:n,y:t.filter(a=>!isNaN(a)),type:"box",boxpoints:"all",pointpos:0,jitter:.3,fillcolor:"rgba(255,255,255,0)",line:{color:"rgba(255,255,255,0)"},hoveron:"points",marker:{color:"#654949",opacity:.8},name:n,showlegend:!1}}loadPlotSettings(){this.graphLayout.height=this.graph.plotSettings.height,this.graphLayout.margin.l=this.graph.plotSettings.marginLeft,this.graphLayout.margin.r=this.graph.plotSettings.marginRight,this.graphLayout.margin.b=this.graph.plotSettings.marginBottom,this.graphLayout.margin.t=this.graph.plotSettings.marginTop,this.graphLayout.title.font.size=this.graph.plotSettings.titleTextSize,this.barSize=this.graph.plotSettings.barSize}static{this.\u0275fac=function(n){return new(n||r)(_e(Zi),_e(Ar))}}static{this.\u0275cmp=je({type:r,selectors:[["app-bar-chart"]],inputs:{searchTerm:"searchTerm",renameCondition:"renameCondition",data:"data",expanded:"expanded",colorMap:"colorMap"},decls:1,vars:4,consts:[[3,"data","layout","revision","updateOnLayoutChange"]],template:function(n,a){n&1&&ke(0,"plotly-plot",0),n&2&&pe("data",a.graphData)("layout",a.graphLayout)("revision",a.revision)("updateOnLayoutChange",!0)},dependencies:[Ss,Mu],encapsulation:2})}}return r})();var Rh=(r,e)=>e.id;function Oh(r,e){if(r&1){let t=Oe();$(0,"div",3)(1,"mat-slide-toggle",8),ue("change",function(){ge(t);let a=re(2);return me(a.expanded=!a.expanded)}),ie(2," Expand Bar Chart "),q(),$(3,"mat-slide-toggle",8),ue("change",function(){ge(t);let a=re(2);return me(a.viewDifferentialAnalysis=!a.viewDifferentialAnalysis)}),ie(4," View Differential Analysis Stats "),q()()}r&2&&(Z(),pe("color","primary"),Z(2),pe("color","primary"))}function Fh(r,e){if(r&1&&($(0,"div"),ke(1,"app-bar-chart",11),q()),r&2){let t=re().$implicit,n=re(3);Z(),pe("searchTerm",t.gene_name)("expanded",n.expanded)("renameCondition",n.renameCondition)("colorMap",n.colorMap)("data",t)}}function Lh(r,e){r&1&&($(0,"div")(1,"p"),ie(2,"No data found for this search"),q()())}function Vh(r,e){if(r&1&&($(0,"div",9),Ee(1,Fh,2,5,"div")(2,Lh,3,0,"div"),$(3,"div")(4,"button",10)(5,"mat-icon"),ie(6,"drag_handle"),q()(),$(7,"p"),ie(8),q()()()),r&2){let t=e.$implicit;Z(),Ie(t.searched_data.length>0?1:2),Z(3),pe("matTooltip",t.analysis_group.name),Z(4),$e(" ",t.analysis_group.name," ")}}function Nh(r,e){if(r&1&&We(0,Vh,9,3,"div",9,Rh),r&2){let t=re(2);Ke(t.searchResults)}}function zh(r,e){r&1&&($(0,"p"),ie(1,"No search results found in this project"),q())}function jh(r,e){r&1&&($(0,"th",24),ie(1," Primary ID "),q())}function Gh(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.primary_id," ")}}function $h(r,e){r&1&&($(0,"th",24),ie(1," UniProt ID "),q())}function qh(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.uniprot_id," ")}}function Hh(r,e){r&1&&($(0,"th",24),ie(1," Gene Names "),q())}function Wh(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.gene_name," ")}}function Kh(r,e){r&1&&($(0,"th",24),ie(1," log2FC "),q())}function Uh(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.log2_fc," ")}}function Xh(r,e){r&1&&($(0,"th",24),ie(1," -log10(p) "),q())}function Yh(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.log10_p," ")}}function Qh(r,e){r&1&&($(0,"th",24),ie(1," Condition A "),q())}function Zh(r,e){if(r&1&&ie(0),r&2){let t=re().$implicit,n=re(3);$e(" ",n.renameCondition[t.condition_A]," ")}}function Jh(r,e){if(r&1&&ie(0),r&2){let t=re().$implicit;$e(" ",t.condition_A," ")}}function ev(r,e){if(r&1&&($(0,"td",25),Ee(1,Zh,1,1)(2,Jh,1,1),q()),r&2){let t=re(3);Z(),Ie(t.renameCondition?1:2)}}function tv(r,e){r&1&&($(0,"th",24),ie(1," Condition B "),q())}function rv(r,e){if(r&1&&ie(0),r&2){let t=re().$implicit,n=re(3);$e(" ",n.renameCondition[t.condition_B]," ")}}function nv(r,e){if(r&1&&ie(0),r&2){let t=re().$implicit;$e(" ",t.condition_B," ")}}function av(r,e){if(r&1&&($(0,"td",25),Ee(1,rv,1,1)(2,nv,1,1),q()),r&2){let t=re(3);Z(),Ie(t.renameCondition?1:2)}}function iv(r,e){r&1&&($(0,"th",24),ie(1," Comparison "),q())}function ov(r,e){if(r&1&&($(0,"td",25),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.comparison_label," ")}}function sv(r,e){r&1&&ke(0,"tr",26)}function lv(r,e){r&1&&ke(0,"tr",27)}function uv(r,e){if(r&1&&($(0,"table",5),bt(1,12),Ee(2,jh,2,0,"th",13)(3,Gh,2,1,"td",14),wt(),bt(4,15),Ee(5,$h,2,0,"th",13)(6,qh,2,1,"td",14),wt(),bt(7,16),Ee(8,Hh,2,0,"th",13)(9,Wh,2,1,"td",14),wt(),bt(10,17),Ee(11,Kh,2,0,"th",13)(12,Uh,2,1,"td",14),wt(),bt(13,18),Ee(14,Xh,2,0,"th",13)(15,Yh,2,1,"td",14),wt(),bt(16,19),Ee(17,Qh,2,0,"th",13)(18,ev,3,1,"td",14),wt(),bt(19,20),Ee(20,tv,2,0,"th",13)(21,av,3,1,"td",14),wt(),bt(22,21),Ee(23,iv,2,0,"th",13)(24,ov,2,1,"td",14),wt(),Ee(25,sv,1,0,"tr",22)(26,lv,1,0,"tr",23),q()),r&2){let t=re(2);pe("dataSource",t.searchResults),Z(25),pe("matHeaderRowDef",t.searchResultDisplayColumns),Z(),pe("matRowDefColumns",t.searchResultDisplayColumns)}}function cv(r,e){if(r&1){let t=Oe();$(0,"button",28),ue("click",function(){ge(t);let a=re(2);return me(a.deleteProject.emit(a.project))}),$(1,"mat-icon"),ie(2,"delete"),q()()}if(r&2){let t=re(2);ms("matTooltip","Delete Project ",t.project.name," from collate")}}function dv(r,e){if(r&1&&($(0,"a",7)(1,"mat-icon"),ie(2,"link"),q()()),r&2){let t=re(2);ms("href","/#/project/",t.project.id,"",Ul)}}function fv(r,e){if(r&1){let t=Oe();$(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"span",2),ie(4),q()(),$(5,"mat-card-subtitle"),ie(6),q()(),$(7,"mat-card-content"),Ee(8,Oh,5,2,"div",3),$(9,"div",4),ue("cdkDropListDropped",function(a){ge(t);let i=re();return me(i.drop(a))}),Ee(10,Nh,2,0)(11,zh,2,0,"p"),q(),Ee(12,uv,27,3,"table",5),q(),$(13,"mat-card-actions"),Ee(14,cv,3,2,"button",6)(15,dv,3,2,"a",7),q()()}if(r&2){let t=re();Z(4),Ze(t.project.name),Z(2),Ze(t.project.description),Z(2),Ie(t.searchResults.length>0?8:-1),Z(2),Ie(t.searchResults.length>0?10:11),Z(2),Ie(t.searchResults.length>0&&t.viewDifferentialAnalysis?12:-1),Z(2),Ie(t.accounts.loggedIn?14:-1),Z(),Ie(t.project?15:-1)}}var Iu=(()=>{class r{set project(t){this._project=t}get project(){return this._project}set searchResults(t){this._searchResults=t,console.log(t)}get searchResults(){return this._searchResults}constructor(t){this.accounts=t,this._project=null,this.searchTerm="",this._searchResults=[],this.colorMap={},this.renameCondition={},this.deleteProject=new at,this.searchResultsChange=new at,this.searchResultDisplayColumns=["primary_id","uniprot_id","gene_name","condition_A","condition_B","log2_fc","log10_p","comparison_label"],this.expanded=!1,this.viewDifferentialAnalysis=!1}drop(t){let a=this._searchResults[t.previousIndex].analysis_group.id,i=this._searchResults.filter(o=>o.analysis_group.id===a);this._searchResults=this._searchResults.filter(o=>o.analysis_group.id!==a),this._searchResults.splice(t.currentIndex,0,...i),this.searchResultsChange.emit(this._searchResults)}static{this.\u0275fac=function(n){return new(n||r)(_e(Ar))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-card-viewer"]],inputs:{searchTerm:"searchTerm",project:"project",searchResults:"searchResults",colorMap:"colorMap",renameCondition:"renameCondition"},outputs:{deleteProject:"deleteProject",searchResultsChange:"searchResultsChange"},decls:1,vars:1,consts:[["appearance","outlined"],["cdkDragHandle",""],[2,"color","#ba0000"],[2,"display","flex","flex-direction","column","gap","20px"],["cdkDropList","",2,"display","flex","gap","20px","flex-wrap","wrap","justify-content","center",3,"cdkDropListDropped"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["mat-icon-button","","color","primary",3,"matTooltip"],["target","_blank",3,"href"],[3,"change","color"],["cdkDrag",""],["mat-icon-button","","cdkDragHandle","",3,"matTooltip"],[3,"searchTerm","expanded","renameCondition","colorMap","data"],["matColumnDef","primary_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","uniprot_id"],["matColumnDef","gene_name"],["matColumnDef","log2_fc"],["matColumnDef","log10_p"],["matColumnDef","condition_A"],["matColumnDef","condition_B"],["matColumnDef","comparison_label"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click","matTooltip"]],template:function(n,a){n&1&&Ee(0,fv,16,7,"mat-card",0),n&2&&Ie(a.project?0:-1)},dependencies:[lu,su,cu,Wn,Kn,ro,Bu,uu,Ut,Jr,nn,an,Hi,ji,$i,qi,Ui,Wi,Xi,Ki,zi,Gi,Du,Pi],encapsulation:2})}}return r})();var hv=(r,e)=>e.id,vv=()=>[];function pv(r,e){if(r&1){let t=Oe();$(0,"app-project-card-viewer",3),ue("deleteProject",function(a){ge(t);let i=re(2);return me(i.deleteProject.emit(a))}),q()}if(r&2){let t=re().$implicit,n=re();pe("searchTerm",n.searchTerm)("colorMap",n.projectConditionColorMap==null?null:n.projectConditionColorMap[t.id])("project",t)("searchResults",n.filteredResults[t.id]||bi(5,vv))("renameCondition",n.renameCondition==null?null:n.renameCondition[t.id])}}function gv(r,e){if(r&1&&($(0,"div",1),Ee(1,pv,1,6,"app-project-card-viewer",2),q()),r&2){let t=e.$implicit;Z(),Ie(t&&t.id?1:-1)}}var oo=(()=>{class r{constructor(){this._searchTerm="",this.projects=[],this._filteredResults={},this.projectConditionColorMap={},this.renameCondition={},this.projectOrderChanged=new at,this.deleteProject=new at}set searchTerm(t){t?this._searchTerm=t:this._searchTerm=""}get searchTerm(){return this._searchTerm}set filteredResults(t){console.log(t),t?this._filteredResults=t:this._filteredResults={}}get filteredResults(){return this._filteredResults}drop(t){Sn(this.projects,t.previousIndex,t.currentIndex),this.projectOrderChanged.emit(this.projects)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-list"]],inputs:{searchTerm:"searchTerm",projects:"projects",filteredResults:"filteredResults",projectConditionColorMap:"projectConditionColorMap",renameCondition:"renameCondition"},outputs:{projectOrderChanged:"projectOrderChanged",deleteProject:"deleteProject"},decls:3,vars:0,consts:[["cdkDropList","",1,"project-list",3,"cdkDropListDropped"],[2,"margin","20px"],["cdkDrag","",3,"searchTerm","colorMap","project","searchResults","renameCondition"],["cdkDrag","",3,"deleteProject","searchTerm","colorMap","project","searchResults","renameCondition"]],template:function(n,a){n&1&&($(0,"div",0),ue("cdkDropListDropped",function(o){return a.drop(o)}),We(1,gv,2,1,"div",1,hv),q()),n&2&&(Z(),Ke(a.projects))},dependencies:[an,Iu,nn],encapsulation:2})}}return r})();var Ru=(r,e)=>e.id;function mv(r,e){if(r&1){let t=Oe();$(0,"mat-chip",4),ue("removed",function(){let a=ge(t).$implicit,i=re(2);return me(i.removeTag(a))}),ie(1),$(2,"mat-icon",5),ie(3,"cancel"),q()()}if(r&2){let t=e.$implicit;Z(),$e(" ",t.name," ")}}function yv(r,e){if(r&1){let t=Oe();$(0,"mat-chip-set",2),ue("cdkDropListDropped",function(a){ge(t);let i=re();return me(i.drop(a))}),We(1,mv,4,1,"mat-chip",3,Ru),q()}if(r&2){let t=re();Z(),Ke(t.collageTags)}}function Cv(r,e){if(r&1&&($(0,"mat-chip"),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t.name," ")}}function bv(r,e){if(r&1&&($(0,"mat-chip-set"),We(1,Cv,2,1,"mat-chip",null,Ru),q()),r&2){let t=re();Z(),Ke(t.collageTags)}}var so=(()=>{class r{constructor(t){this.accounts=t,this.collageTags=[],this.collageTagsChange=new at}removeTag(t){this.collageTags=this.collageTags.filter(n=>n!==t),this.collageTagsChange.emit(this.collageTags)}drop(t){Sn(this.collageTags,t.previousIndex,t.currentIndex),this.collageTagsChange.emit(this.collageTags)}static{this.\u0275fac=function(n){return new(n||r)(_e(Ar))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-tags"]],inputs:{collageTags:"collageTags"},outputs:{collageTagsChange:"collageTagsChange"},decls:4,vars:1,consts:[[2,"display","flex","justify-content","center"],["cdkDropList",""],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["cdkDrag","",3,"removed"],["matChipRemove",""]],template:function(n,a){n&1&&($(0,"div",0),Ee(1,yv,3,0,"mat-chip-set",1)(2,bv,3,0,"mat-chip-set"),q(),ke(3,"div",0)),n&2&&(Z(),Ie(a.accounts.loggedIn?1:2))},dependencies:[an,Ri,Bi,Ut,Ii,nn],encapsulation:2})}}return r})();var Fu=jl(Ou());function wv(r,e){r&1&&($(0,"div",2),ke(1,"div",5),q())}var Lu=(()=>{class r{set url(t){this.config.data=t,this._url=t}constructor(t){this.dialogRef=t,this._url="",this.config={width:250,height:250,data:this.url,margin:5,dotsOptions:{color:"#780101",type:"dots"},backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0}}}ngAfterViewInit(){let t=new Fu.default(this.config),n=document.getElementById("canvas");n&&t.append(n),this.qrCode=t}close(){this.dialogRef.close()}download(){this.qrCode&&this.qrCode.download({name:"qrcode",extension:"svg"}).then(()=>{})}static{this.\u0275fac=function(n){return new(n||r)(_e(At))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-qr-code-dialog"]],inputs:{url:"url"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","justify-content","center","align-items","center"],["mat-dialog-actions",""],["mat-button","",3,"click"],["id","canvas"]],template:function(n,a){n&1&&($(0,"h1",0),ie(1,"Collate QR Code"),q(),$(2,"div",1),Ee(3,wv,2,0,"div",2),q(),$(4,"div",3)(5,"button",4),ue("click",function(){return a.close()}),ie(6,"Close"),q(),$(7,"button",4),ue("click",function(){return a.download()}),ie(8,"Download"),q()()),n&2&&(Z(3),Ie(a.config.data&&a.config.data!==""?3:-1))},dependencies:[Bt,It,Rt,ut],encapsulation:2})}}return r})();var Vu=(r,e)=>e.id,xv=()=>({standalone:!0});function _v(r,e){if(r&1){let t=Oe();$(0,"mat-checkbox",6),Kt("ngModelChange",function(a){let i=ge(t).$implicit,o=re(2).$implicit,s=re();return Wt(s.projectAnalysisGroupVisibilityMap[o.id][i.id],a)||(s.projectAnalysisGroupVisibilityMap[o.id][i.id]=a),me(a)}),ie(1),q()}if(r&2){let t=e.$implicit,n=re(2).$implicit,a=re();Ht("ngModel",a.projectAnalysisGroupVisibilityMap[n.id][t.id]),pe("ngModelOptions",bi(3,xv)),Z(),$e(" ",t.name," ")}}function Sv(r,e){if(r&1&&We(0,_v,2,4,"mat-checkbox",5,Vu),r&2){let t=re().$implicit,n=re();Ke(n.projectAnalysisGroupMap[t.id])}}function Ev(r,e){if(r&1&&($(0,"h2"),ie(1),q(),Ee(2,Sv,2,0)),r&2){let t=e.$implicit,n=re();Z(),Ze(t.name),Z(),Ie(n.projectAnalysisGroupMap[t.id]?2:-1)}}var lo=(()=>{class r{set projects(t){this._projects=t}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}set projectAnalysisGroupVisibilityMap(t){this._projectAnalysisGroupVisibilityMap={};for(let n in t){this._projectAnalysisGroupVisibilityMap[n]={};for(let a in t[n])this._projectAnalysisGroupVisibilityMap[n][a]=t[n][a]}}get projectAnalysisGroupVisibilityMap(){return this._projectAnalysisGroupVisibilityMap}constructor(t){this.dialog=t,this._projects=[],this._projectAnalysisGroupMap={},this._projectAnalysisGroupVisibilityMap={}}close(){this.dialog.close()}save(){this.dialog.close(this.projectAnalysisGroupVisibilityMap)}static{this.\u0275fac=function(n){return new(n||r)(_e(At))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-analysis-group-visibility-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap",projectAnalysisGroupVisibilityMap:"projectAnalysisGroupVisibilityMap"},decls:11,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px"],["mat-dialog-actions",""],["mat-button","",3,"click"],[3,"ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"]],template:function(n,a){n&1&&($(0,"h1",0),ie(1,"Analysis Group Visibility"),q(),$(2,"div",1)(3,"form",2),We(4,Ev,3,2,null,null,Vu),q()(),$(6,"div",3)(7,"button",4),ue("click",function(){return a.close()}),ie(8,"Cancel"),q(),$(9,"button",4),ue("click",function(){return a.save()}),ie(10,"Submit"),q()()),n&2&&(Z(4),Ke(a.projects))},dependencies:[Bt,It,tn,cr,xt,ur,en,hu,Xn,Rt,ut],encapsulation:2})}}return r})();function pt(r){"@babel/helpers - typeof";return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(r)}function Cn(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Nu(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function bn(r,e,t){return e&&Nu(r.prototype,e),t&&Nu(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function ad(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dt(r,e){return Mv(r)||kv(r,e)||sl(r,e)||Av()}function id(r){return Tv(r)||Dv(r)||sl(r)||Pv()}function Tv(r){if(Array.isArray(r))return qs(r)}function Mv(r){if(Array.isArray(r))return r}function Dv(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function kv(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,o,s;try{for(t=t.call(r);!(a=(o=t.next()).done)&&(n.push(o.value),!(e&&n.length===e));a=!0);}catch(l){i=!0,s=l}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw s}}return n}}function sl(r,e){if(r){if(typeof r=="string")return qs(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qs(r,e)}}function qs(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Pv(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Av(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function or(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=sl(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,s;return{s:function(){t=t.call(r)},n:function(){var l=t.next();return i=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw s}}}}var ht=typeof window>"u"?null:window,zu=ht?ht.navigator:null;ht&&ht.document;var Bv=pt(""),od=pt({}),Iv=pt(function(){}),Rv=typeof HTMLElement>"u"?"undefined":pt(HTMLElement),ei=function(e){return e&&e.instanceString&&st(e.instanceString)?e.instanceString():null},Be=function(e){return e!=null&&pt(e)==Bv},st=function(e){return e!=null&&pt(e)===Iv},Je=function(e){return!sr(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},He=function(e){return e!=null&&pt(e)===od&&!Je(e)&&e.constructor===Object},Ov=function(e){return e!=null&&pt(e)===od},Ce=function(e){return e!=null&&pt(e)===pt(1)&&!isNaN(e)},Fv=function(e){return Ce(e)&&Math.floor(e)===e},Io=function(e){if(Rv!=="undefined")return e!=null&&e instanceof HTMLElement},sr=function(e){return ti(e)||sd(e)},ti=function(e){return ei(e)==="collection"&&e._private.single},sd=function(e){return ei(e)==="collection"&&!e._private.single},ll=function(e){return ei(e)==="core"},ld=function(e){return ei(e)==="stylesheet"},Lv=function(e){return ei(e)==="event"},fn=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},Vv=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},Nv=function(e){return He(e)&&Ce(e.x1)&&Ce(e.x2)&&Ce(e.y1)&&Ce(e.y2)},zv=function(e){return Ov(e)&&st(e.then)},jv=function(){return zu&&zu.userAgent.match(/msie|trident|edge/i)},$a=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);return i.join("$")});var n=function a(){var i=this,o=arguments,s,l=t.apply(i,o),u=a.cache;return(s=u[l])||(s=u[l]=e.apply(i,o)),s};return n.cache={},n},ul=$a(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Ho=$a(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),ud=$a(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),ju=function(e){return fn(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},vt="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",Gv="rgb[a]?\\(("+vt+"[%]?)\\s*,\\s*("+vt+"[%]?)\\s*,\\s*("+vt+"[%]?)(?:\\s*,\\s*("+vt+"))?\\)",$v="rgb[a]?\\((?:"+vt+"[%]?)\\s*,\\s*(?:"+vt+"[%]?)\\s*,\\s*(?:"+vt+"[%]?)(?:\\s*,\\s*(?:"+vt+"))?\\)",qv="hsl[a]?\\(("+vt+")\\s*,\\s*("+vt+"[%])\\s*,\\s*("+vt+"[%])(?:\\s*,\\s*("+vt+"))?\\)",Hv="hsl[a]?\\((?:"+vt+")\\s*,\\s*(?:"+vt+"[%])\\s*,\\s*(?:"+vt+"[%])(?:\\s*,\\s*(?:"+vt+"))?\\)",Wv="\\#[0-9a-fA-F]{3}",Kv="\\#[0-9a-fA-F]{6}",cd=function(e,t){return e<t?-1:e>t?1:0},Uv=function(e,t){return-1*cd(e,t)},Fe=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var n=e[t];if(n!=null)for(var a=Object.keys(n),i=0;i<a.length;i++){var o=a[i];r[o]=n[o]}}return r},Xv=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,n,a,i,o=16;return t?(n=parseInt(e[1]+e[1],o),a=parseInt(e[2]+e[2],o),i=parseInt(e[3]+e[3],o)):(n=parseInt(e[1]+e[2],o),a=parseInt(e[3]+e[4],o),i=parseInt(e[5]+e[6],o)),[n,a,i]}},Yv=function(e){var t,n,a,i,o,s,l,u;function c(h,m,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?h+(m-h)*6*g:g<1/2?m:g<2/3?h+(m-h)*(2/3-g)*6:h}var d=new RegExp("^"+qv+"$").exec(e);if(d){if(n=parseInt(d[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,a=parseFloat(d[2]),a<0||a>100||(a=a/100,i=parseFloat(d[3]),i<0||i>100)||(i=i/100,o=d[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(a===0)s=l=u=Math.round(i*255);else{var f=i<.5?i*(1+a):i+a-i*a,v=2*i-f;s=Math.round(255*c(v,f,n+1/3)),l=Math.round(255*c(v,f,n)),u=Math.round(255*c(v,f,n-1/3))}t=[s,l,u,o]}return t},Qv=function(e){var t,n=new RegExp("^"+Gv+"$").exec(e);if(n){t=[];for(var a=[],i=1;i<=3;i++){var o=n[i];if(o[o.length-1]==="%"&&(a[i]=!0),o=parseFloat(o),a[i]&&(o=o/100*255),o<0||o>255)return;t.push(Math.floor(o))}var s=a[1]||a[2]||a[3],l=a[1]&&a[2]&&a[3];if(s&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;t.push(u)}}return t},Zv=function(e){return Jv[e.toLowerCase()]},dd=function(e){return(Je(e)?e:null)||Zv(e)||Xv(e)||Qv(e)||Yv(e)},Jv={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},fd=function(e){for(var t=e.map,n=e.keys,a=n.length,i=0;i<a;i++){var o=n[i];if(He(o))throw Error("Tried to set map with object key");i<n.length-1?(t[o]==null&&(t[o]={}),t=t[o]):t[o]=e.value}},hd=function(e){for(var t=e.map,n=e.keys,a=n.length,i=0;i<a;i++){var o=n[i];if(He(o))throw Error("Tried to get map with object key");if(t=t[o],t==null)return t}return t};function ep(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Bn=ep,Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tp(r,e){return e={exports:{}},r(e,e.exports),e.exports}var rp=typeof Ra=="object"&&Ra&&Ra.Object===Object&&Ra,np=rp,ap=typeof self=="object"&&self&&self.Object===Object&&self,ip=np||ap||Function("return this")(),Wo=ip,op=function(){return Wo.Date.now()},Ds=op,sp=/\s/;function lp(r){for(var e=r.length;e--&&sp.test(r.charAt(e)););return e}var up=lp,cp=/^\s+/;function dp(r){return r&&r.slice(0,up(r)+1).replace(cp,"")}var fp=dp,hp=Wo.Symbol,ua=hp,vd=Object.prototype,vp=vd.hasOwnProperty,pp=vd.toString,Ma=ua?ua.toStringTag:void 0;function gp(r){var e=vp.call(r,Ma),t=r[Ma];try{r[Ma]=void 0;var n=!0}catch{}var a=pp.call(r);return n&&(e?r[Ma]=t:delete r[Ma]),a}var mp=gp,yp=Object.prototype,Cp=yp.toString;function bp(r){return Cp.call(r)}var wp=bp,xp="[object Null]",_p="[object Undefined]",Gu=ua?ua.toStringTag:void 0;function Sp(r){return r==null?r===void 0?_p:xp:Gu&&Gu in Object(r)?mp(r):wp(r)}var pd=Sp;function Ep(r){return r!=null&&typeof r=="object"}var Tp=Ep,Mp="[object Symbol]";function Dp(r){return typeof r=="symbol"||Tp(r)&&pd(r)==Mp}var ri=Dp,$u=NaN,kp=/^[-+]0x[0-9a-f]+$/i,Pp=/^0b[01]+$/i,Ap=/^0o[0-7]+$/i,Bp=parseInt;function Ip(r){if(typeof r=="number")return r;if(ri(r))return $u;if(Bn(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Bn(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=fp(r);var t=Pp.test(r);return t||Ap.test(r)?Bp(r.slice(2),t?2:8):kp.test(r)?$u:+r}var qu=Ip,Rp="Expected a function",Op=Math.max,Fp=Math.min;function Lp(r,e,t){var n,a,i,o,s,l,u=0,c=!1,d=!1,f=!0;if(typeof r!="function")throw new TypeError(Rp);e=qu(e)||0,Bn(t)&&(c=!!t.leading,d="maxWait"in t,i=d?Op(qu(t.maxWait)||0,e):i,f="trailing"in t?!!t.trailing:f);function v(k){var M=n,O=a;return n=a=void 0,u=k,o=r.apply(O,M),o}function h(k){return u=k,s=setTimeout(p,e),c?v(k):o}function m(k){var M=k-l,O=k-u,P=e-M;return d?Fp(P,i-O):P}function g(k){var M=k-l,O=k-u;return l===void 0||M>=e||M<0||d&&O>=i}function p(){var k=Ds();if(g(k))return y(k);s=setTimeout(p,m(k))}function y(k){return s=void 0,f&&n?v(k):(n=a=void 0,o)}function b(){s!==void 0&&clearTimeout(s),u=0,n=l=a=s=void 0}function _(){return s===void 0?o:y(Ds())}function B(){var k=Ds(),M=g(k);if(n=arguments,a=this,l=k,M){if(s===void 0)return h(l);if(d)return clearTimeout(s),s=setTimeout(p,e),v(l)}return s===void 0&&(s=setTimeout(p,e)),o}return B.cancel=b,B.flush=_,B}var ni=Lp,ks=ht?ht.performance:null,gd=ks&&ks.now?function(){return ks.now()}:function(){return Date.now()},Vp=function(){if(ht){if(ht.requestAnimationFrame)return function(r){ht.requestAnimationFrame(r)};if(ht.mozRequestAnimationFrame)return function(r){ht.mozRequestAnimationFrame(r)};if(ht.webkitRequestAnimationFrame)return function(r){ht.webkitRequestAnimationFrame(r)};if(ht.msRequestAnimationFrame)return function(r){ht.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(gd())},1e3/60)}}(),Ro=function(e){return Vp(e)},Kr=gd,ra=9261,md=65599,Oa=5381,yd=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ra,n=t,a;a=e.next(),!a.done;)n=n*md+a.value|0;return n},qa=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ra;return t*md+e|0},Ha=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oa;return(t<<5)+t+e|0},Np=function(e,t){return e*2097152+t},on=function(e){return e[0]*2097152+e[1]},uo=function(e,t){return[qa(e[0],t[0]),Ha(e[1],t[1])]},zp=function(e,t){var n={value:0,done:!1},a=0,i=e.length,o={next:function(){return a<i?n.value=e[a++]:n.done=!0,n}};return yd(o,t)},hn=function(e,t){var n={value:0,done:!1},a=0,i=e.length,o={next:function(){return a<i?n.value=e.charCodeAt(a++):n.done=!0,n}};return yd(o,t)},Cd=function(){return jp(arguments)},jp=function(e){for(var t,n=0;n<e.length;n++){var a=e[n];n===0?t=hn(a):t=hn(a,t)}return t},Hu=!0,Gp=console.warn!=null,$p=console.trace!=null,cl=Number.MAX_SAFE_INTEGER||9007199254740991,bd=function(){return!0},Oo=function(){return!1},Wu=function(){return 0},dl=function(){},ot=function(e){throw new Error(e)},wd=function(e){if(e!==void 0)Hu=!!e;else return Hu},Ye=function(e){wd()&&(Gp?console.warn(e):(console.log(e),$p&&console.trace()))},qp=function(e){return Fe({},e)},Or=function(e){return e==null?e:Je(e)?e.slice():He(e)?qp(e):e},Hp=function(e){return e.slice()},xd=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},Wp={},_d=function(){return Wp},St=function(e){var t=Object.keys(e);return function(n){for(var a={},i=0;i<t.length;i++){var o=t[i],s=n?.[o];a[o]=s===void 0?e[o]:s}return a}},vn=function(e,t,n){for(var a=e.length-1;a>=0&&!(e[a]===t&&(e.splice(a,1),n));a--);},fl=function(e){e.splice(0,e.length)},Kp=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];e.push(a)}},xr=function(e,t,n){return n&&(t=ud(n,t)),e[t]},ln=function(e,t,n,a){n&&(t=ud(n,t)),e[t]=a},Up=function(){function r(){Cn(this,r),this._obj={}}return bn(r,[{key:"set",value:function(t,n){return this._obj[t]=n,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}]),r}(),Fr=typeof Map<"u"?Map:Up,Xp="undefined",Yp=function(){function r(e){if(Cn(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var n=0;n<t.length;n++)this.add(t[n])}}return bn(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var n=this._obj;n[t]!==1&&(n[t]=1,this.size++)}},{key:"delete",value:function(t){var n=this._obj;n[t]===1&&(n[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(n){return t.has(n)})}},{key:"forEach",value:function(t,n){return this.toArray().forEach(t,n)}}]),r}(),ha=(typeof Set>"u"?"undefined":pt(Set))!==Xp?Set:Yp,Ko=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!ll(e)){ot("An element must have a core reference and parameters set");return}var a=t.group;if(a==null&&(t.data&&t.data.source!=null&&t.data.target!=null?a="edges":a="nodes"),a!=="nodes"&&a!=="edges"){ot("An element must be of type `nodes` or `edges`; you specified `"+a+"`");return}this.length=1,this[0]=this;var i=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:a,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?a==="edges":!!t.pannable,active:!1,classes:new ha,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(i.position.x==null&&(i.position.x=0),i.position.y==null&&(i.position.y=0),t.renderedPosition){var o=t.renderedPosition,s=e.pan(),l=e.zoom();i.position={x:(o.x-s.x)/l,y:(o.y-s.y)/l}}var u=[];Je(t.classes)?u=t.classes:Be(t.classes)&&(u=t.classes.split(/\s+/));for(var c=0,d=u.length;c<d;c++){var f=u[c];!f||f===""||i.classes.add(f)}this.createEmitter();var v=t.style||t.css;v&&(Ye("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(v)),(n===void 0||n)&&this.restore()},Ku=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,a,i){var o;He(n)&&!sr(n)&&(o=n,n=o.roots||o.root,a=o.visit,i=o.directed),i=arguments.length===2&&!st(a)?a:i,a=st(a)?a:function(){};for(var s=this._private.cy,l=n=Be(n)?this.filter(n):n,u=[],c=[],d={},f={},v={},h=0,m,g=this.byGroup(),p=g.nodes,y=g.edges,b=0;b<l.length;b++){var _=l[b],B=_.id();_.isNode()&&(u.unshift(_),e.bfs&&(v[B]=!0,c.push(_)),f[B]=0)}for(var k=function(){var A=e.bfs?u.shift():u.pop(),S=A.id();if(e.dfs){if(v[S])return"continue";v[S]=!0,c.push(A)}var w=f[S],C=d[S],x=C!=null?C.source():null,D=C!=null?C.target():null,T=C==null?void 0:A.same(x)?D[0]:x[0],V=void 0;if(V=a(A,C,T,h++,w),V===!0)return m=A,"break";if(V===!1)return"break";for(var z=A.connectedEdges().filter(function(J){return(!i||J.source().same(A))&&y.has(J)}),j=0;j<z.length;j++){var U=z[j],Y=U.connectedNodes().filter(function(J){return!J.same(A)&&p.has(J)}),te=Y.id();Y.length!==0&&!v[te]&&(Y=Y[0],u.push(Y),e.bfs&&(v[te]=!0,c.push(Y)),d[te]=U,f[te]=f[S]+1)}};u.length!==0;){var M=k();if(M!=="continue"&&M==="break")break}for(var O=s.collection(),P=0;P<c.length;P++){var L=c[P],F=d[L.id()];F!=null&&O.push(F),O.push(L)}return{path:s.collection(O),found:s.collection(m)}}},Wa={breadthFirstSearch:Ku({bfs:!0}),depthFirstSearch:Ku({dfs:!0})};Wa.bfs=Wa.breadthFirstSearch;Wa.dfs=Wa.depthFirstSearch;var Qp=tp(function(r,e){(function(){var t,n,a,i,o,s,l,u,c,d,f,v,h,m,g;a=Math.floor,d=Math.min,n=function(p,y){return p<y?-1:p>y?1:0},c=function(p,y,b,_,B){var k;if(b==null&&(b=0),B==null&&(B=n),b<0)throw new Error("lo must be non-negative");for(_==null&&(_=p.length);b<_;)k=a((b+_)/2),B(y,p[k])<0?_=k:b=k+1;return[].splice.apply(p,[b,b-b].concat(y)),y},s=function(p,y,b){return b==null&&(b=n),p.push(y),m(p,0,p.length-1,b)},o=function(p,y){var b,_;return y==null&&(y=n),b=p.pop(),p.length?(_=p[0],p[0]=b,g(p,0,y)):_=b,_},u=function(p,y,b){var _;return b==null&&(b=n),_=p[0],p[0]=y,g(p,0,b),_},l=function(p,y,b){var _;return b==null&&(b=n),p.length&&b(p[0],y)<0&&(_=[p[0],y],y=_[0],p[0]=_[1],g(p,0,b)),y},i=function(p,y){var b,_,B,k,M,O;for(y==null&&(y=n),k=function(){O=[];for(var P=0,L=a(p.length/2);0<=L?P<L:P>L;0<=L?P++:P--)O.push(P);return O}.apply(this).reverse(),M=[],_=0,B=k.length;_<B;_++)b=k[_],M.push(g(p,b,y));return M},h=function(p,y,b){var _;if(b==null&&(b=n),_=p.indexOf(y),_!==-1)return m(p,0,_,b),g(p,_,b)},f=function(p,y,b){var _,B,k,M,O;if(b==null&&(b=n),B=p.slice(0,y),!B.length)return B;for(i(B,b),O=p.slice(y),k=0,M=O.length;k<M;k++)_=O[k],l(B,_,b);return B.sort(b).reverse()},v=function(p,y,b){var _,B,k,M,O,P,L,F,E;if(b==null&&(b=n),y*10<=p.length){if(k=p.slice(0,y).sort(b),!k.length)return k;for(B=k[k.length-1],L=p.slice(y),M=0,P=L.length;M<P;M++)_=L[M],b(_,B)<0&&(c(k,_,0,null,b),k.pop(),B=k[k.length-1]);return k}for(i(p,b),E=[],O=0,F=d(y,p.length);0<=F?O<F:O>F;0<=F?++O:--O)E.push(o(p,b));return E},m=function(p,y,b,_){var B,k,M;for(_==null&&(_=n),B=p[b];b>y;){if(M=b-1>>1,k=p[M],_(B,k)<0){p[b]=k,b=M;continue}break}return p[b]=B},g=function(p,y,b){var _,B,k,M,O;for(b==null&&(b=n),B=p.length,O=y,k=p[y],_=2*y+1;_<B;)M=_+1,M<B&&!(b(p[_],p[M])<0)&&(_=M),p[y]=p[_],y=_,_=2*y+1;return p[y]=k,m(p,O,y,b)},t=function(){p.push=s,p.pop=o,p.replace=u,p.pushpop=l,p.heapify=i,p.updateItem=h,p.nlargest=f,p.nsmallest=v;function p(y){this.cmp=y??n,this.nodes=[]}return p.prototype.push=function(y){return s(this.nodes,y,this.cmp)},p.prototype.pop=function(){return o(this.nodes,this.cmp)},p.prototype.peek=function(){return this.nodes[0]},p.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},p.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},p.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},p.prototype.heapify=function(){return i(this.nodes,this.cmp)},p.prototype.updateItem=function(y){return h(this.nodes,y,this.cmp)},p.prototype.clear=function(){return this.nodes=[]},p.prototype.empty=function(){return this.nodes.length===0},p.prototype.size=function(){return this.nodes.length},p.prototype.clone=function(){var y;return y=new p,y.nodes=this.nodes.slice(0),y},p.prototype.toArray=function(){return this.nodes.slice(0)},p.prototype.insert=p.prototype.push,p.prototype.top=p.prototype.peek,p.prototype.front=p.prototype.peek,p.prototype.has=p.prototype.contains,p.prototype.copy=p.prototype.clone,p}(),function(p,y){return r.exports=y()}(this,function(){return t})}).call(Ra)}),ai=Qp,Zp=St({root:null,weight:function(e){return 1},directed:!1}),Jp={dijkstra:function(e){if(!He(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=Zp(e),a=n.root,i=n.weight,o=n.directed,s=this,l=i,u=Be(a)?this.filter(a)[0]:a[0],c={},d={},f={},v=this.byGroup(),h=v.nodes,m=v.edges;m.unmergeBy(function(w){return w.isLoop()});for(var g=function(C){return c[C.id()]},p=function(C,x){c[C.id()]=x,y.updateItem(C)},y=new ai(function(w,C){return g(w)-g(C)}),b=0;b<h.length;b++){var _=h[b];c[_.id()]=_.same(u)?0:1/0,y.push(_)}for(var B=function(C,x){for(var D=(o?C.edgesTo(x):C.edgesWith(x)).intersect(m),T=1/0,V,z=0;z<D.length;z++){var j=D[z],U=l(j);(U<T||!V)&&(T=U,V=j)}return{edge:V,dist:T}};y.size()>0;){var k=y.pop(),M=g(k),O=k.id();if(f[O]=M,M!==1/0)for(var P=k.neighborhood().intersect(h),L=0;L<P.length;L++){var F=P[L],E=F.id(),A=B(k,F),S=M+A.dist;S<g(F)&&(p(F,S),d[E]={node:k,edge:A.edge})}}return{distanceTo:function(C){var x=Be(C)?h.filter(C)[0]:C[0];return f[x.id()]},pathTo:function(C){var x=Be(C)?h.filter(C)[0]:C[0],D=[],T=x,V=T.id();if(x.length>0)for(D.unshift(x);d[V];){var z=d[V];D.unshift(z.edge),D.unshift(z.node),T=z.node,V=T.id()}return s.spawn(D)}}}},eg={kruskal:function(e){e=e||function(b){return 1};for(var t=this.byGroup(),n=t.nodes,a=t.edges,i=n.length,o=new Array(i),s=n,l=function(_){for(var B=0;B<o.length;B++){var k=o[B];if(k.has(_))return B}},u=0;u<i;u++)o[u]=this.spawn(n[u]);for(var c=a.sort(function(b,_){return e(b)-e(_)}),d=0;d<c.length;d++){var f=c[d],v=f.source()[0],h=f.target()[0],m=l(v),g=l(h),p=o[m],y=o[g];m!==g&&(s.merge(f),p.merge(y),o.splice(g,1))}return s}},tg=St({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),rg={aStar:function(e){var t=this.cy(),n=tg(e),a=n.root,i=n.goal,o=n.heuristic,s=n.directed,l=n.weight;a=t.collection(a)[0],i=t.collection(i)[0];var u=a.id(),c=i.id(),d={},f={},v={},h=new ai(function(V,z){return f[V.id()]-f[z.id()]}),m=new ha,g={},p={},y=function(z,j){h.push(z),m.add(j)},b,_,B=function(){b=h.pop(),_=b.id(),m.delete(_)},k=function(z){return m.has(z)};y(a,u),d[u]=0,f[u]=o(a);for(var M=0;h.size()>0;){if(B(),M++,_===c){for(var O=[],P=i,L=c,F=p[L];O.unshift(P),F!=null&&O.unshift(F),P=g[L],P!=null;)L=P.id(),F=p[L];return{found:!0,distance:d[_],path:this.spawn(O),steps:M}}v[_]=!0;for(var E=b._private.edges,A=0;A<E.length;A++){var S=E[A];if(this.hasElementWithId(S.id())&&!(s&&S.data("source")!==_)){var w=S.source(),C=S.target(),x=w.id()!==_?w:C,D=x.id();if(this.hasElementWithId(D)&&!v[D]){var T=d[_]+l(S);if(!k(D)){d[D]=T,f[D]=T+o(x),y(x,D),g[D]=b,p[D]=S;continue}T<d[D]&&(d[D]=T,f[D]=T+o(x),g[D]=b,p[D]=S)}}}}return{found:!1,distance:void 0,path:void 0,steps:M}}},ng=St({weight:function(e){return 1},directed:!1}),ag={floydWarshall:function(e){for(var t=this.cy(),n=ng(e),a=n.weight,i=n.directed,o=a,s=this.byGroup(),l=s.nodes,u=s.edges,c=l.length,d=c*c,f=function(U){return l.indexOf(U)},v=function(U){return l[U]},h=new Array(d),m=0;m<d;m++){var g=m%c,p=(m-g)/c;p===g?h[m]=0:h[m]=1/0}for(var y=new Array(d),b=new Array(d),_=0;_<u.length;_++){var B=u[_],k=B.source()[0],M=B.target()[0];if(k!==M){var O=f(k),P=f(M),L=O*c+P,F=o(B);if(h[L]>F&&(h[L]=F,y[L]=P,b[L]=B),!i){var E=P*c+O;!i&&h[E]>F&&(h[E]=F,y[E]=O,b[E]=B)}}}for(var A=0;A<c;A++)for(var S=0;S<c;S++)for(var w=S*c+A,C=0;C<c;C++){var x=S*c+C,D=A*c+C;h[w]+h[D]<h[x]&&(h[x]=h[w]+h[D],y[x]=y[w])}var T=function(U){return(Be(U)?t.filter(U):U)[0]},V=function(U){return f(T(U))},z={distance:function(U,Y){var te=V(U),J=V(Y);return h[te*c+J]},path:function(U,Y){var te=V(U),J=V(Y),ne=v(te);if(te===J)return ne.collection();if(y[te*c+J]==null)return t.collection();var ae=t.collection(),K=te,R;for(ae.merge(ne);te!==J;)K=te,te=y[te*c+J],R=b[K*c+te],ae.merge(R),ae.merge(v(te));return ae}};return z}},ig=St({weight:function(e){return 1},directed:!1,root:null}),og={bellmanFord:function(e){var t=this,n=ig(e),a=n.weight,i=n.directed,o=n.root,s=a,l=this,u=this.cy(),c=this.byGroup(),d=c.edges,f=c.nodes,v=f.length,h=new Fr,m=!1,g=[];o=u.collection(o)[0],d.unmergeBy(function(xe){return xe.isLoop()});for(var p=d.length,y=function(fe){var ce=h.get(fe.id());return ce||(ce={},h.set(fe.id(),ce)),ce},b=function(fe){return(Be(fe)?u.$(fe):fe)[0]},_=function(fe){return y(b(fe)).dist},B=function(fe){for(var ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,be=b(fe),De=[],Me=be;;){if(Me==null)return t.spawn();var we=y(Me),Se=we.edge,ye=we.pred;if(De.unshift(Me[0]),Me.same(ce)&&De.length>0)break;Se!=null&&De.unshift(Se),Me=ye}return l.spawn(De)},k=0;k<v;k++){var M=f[k],O=y(M);M.same(o)?O.dist=0:O.dist=1/0,O.pred=null,O.edge=null}for(var P=!1,L=function(fe,ce,be,De,Me,we){var Se=De.dist+we;Se<Me.dist&&!be.same(De.edge)&&(Me.dist=Se,Me.pred=fe,Me.edge=be,P=!0)},F=1;F<v;F++){P=!1;for(var E=0;E<p;E++){var A=d[E],S=A.source(),w=A.target(),C=s(A),x=y(S),D=y(w);L(S,w,A,x,D,C),i||L(w,S,A,D,x,C)}if(!P)break}if(P)for(var T=[],V=0;V<p;V++){var z=d[V],j=z.source(),U=z.target(),Y=s(z),te=y(j).dist,J=y(U).dist;if(te+Y<J||!i&&J+Y<te)if(m||(Ye("Graph contains a negative weight cycle for Bellman-Ford"),m=!0),e.findNegativeWeightCycles!==!1){var ne=[];te+Y<J&&ne.push(j),!i&&J+Y<te&&ne.push(U);for(var ae=ne.length,K=0;K<ae;K++){var R=ne[K],N=[R];N.push(y(R).edge);for(var G=y(R).pred;N.indexOf(G)===-1;)N.push(G),N.push(y(G).edge),G=y(G).pred;N=N.slice(N.indexOf(G));for(var W=N[0].id(),X=0,de=2;de<N.length;de+=2)N[de].id()<W&&(W=N[de].id(),X=de);N=N.slice(X).concat(N.slice(0,X)),N.push(N[0]);var Te=N.map(function(xe){return xe.id()}).join(",");T.indexOf(Te)===-1&&(g.push(l.spawn(N)),T.push(Te))}}else break}return{distanceTo:_,pathTo:B,hasNegativeWeightCycle:m,negativeWeightCycles:g}}},sg=Math.sqrt(2),lg=function(e,t,n){n.length===0&&ot("Karger-Stein must be run on a connected (sub)graph");for(var a=n[e],i=a[1],o=a[2],s=t[i],l=t[o],u=n,c=u.length-1;c>=0;c--){var d=u[c],f=d[1],v=d[2];(t[f]===s&&t[v]===l||t[f]===l&&t[v]===s)&&u.splice(c,1)}for(var h=0;h<u.length;h++){var m=u[h];m[1]===l?(u[h]=m.slice(),u[h][1]=s):m[2]===l&&(u[h]=m.slice(),u[h][2]=s)}for(var g=0;g<t.length;g++)t[g]===l&&(t[g]=s);return u},Ps=function(e,t,n,a){for(;n>a;){var i=Math.floor(Math.random()*t.length);t=lg(i,e,t),n--}return t},ug={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,a=t.edges;a.unmergeBy(function(D){return D.isLoop()});var i=n.length,o=a.length,s=Math.ceil(Math.pow(Math.log(i)/Math.LN2,2)),l=Math.floor(i/sg);if(i<2){ot("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<o;c++){var d=a[c];u.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var f=1/0,v=[],h=new Array(i),m=new Array(i),g=new Array(i),p=function(T,V){for(var z=0;z<i;z++)V[z]=T[z]},y=0;y<=s;y++){for(var b=0;b<i;b++)m[b]=b;var _=Ps(m,u.slice(),i,l),B=_.slice();p(m,g);var k=Ps(m,_,l,2),M=Ps(g,B,l,2);k.length<=M.length&&k.length<f?(f=k.length,v=k,p(m,h)):M.length<=k.length&&M.length<f&&(f=M.length,v=M,p(g,h))}for(var O=this.spawn(v.map(function(D){return a[D[0]]})),P=this.spawn(),L=this.spawn(),F=h[0],E=0;E<h.length;E++){var A=h[E],S=n[E];A===F?P.merge(S):L.merge(S)}var w=function(T){var V=e.spawn();return T.forEach(function(z){V.merge(z),z.connectedEdges().forEach(function(j){e.contains(j)&&!O.contains(j)&&V.merge(j)})}),V},C=[w(P),w(L)],x={cut:O,components:C,partition1:P,partition2:L};return x}},cg=function(e){return{x:e.x,y:e.y}},Uo=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},Sd=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},na=function(e){return{x:e[0],y:e[1]}},dg=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=1/0,i=t;i<n;i++){var o=e[i];isFinite(o)&&(a=Math.min(o,a))}return a},fg=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=-1/0,i=t;i<n;i++){var o=e[i];isFinite(o)&&(a=Math.max(o,a))}return a},hg=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=0,i=0,o=t;o<n;o++){var s=e[o];isFinite(s)&&(a+=s,i++)}return a/i},vg=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;a?e=e.slice(t,n):(n<e.length&&e.splice(n,e.length-n),t>0&&e.splice(0,t));for(var s=0,l=e.length-1;l>=0;l--){var u=e[l];o?isFinite(u)||(e[l]=-1/0,s++):e.splice(l,1)}i&&e.sort(function(f,v){return f-v});var c=e.length,d=Math.floor(c/2);return c%2!==0?e[d+1+s]:(e[d-1+s]+e[d+s])/2},pg=function(e){return Math.PI*e/180},co=function(e,t){return Math.atan2(t,e)-Math.PI/2},hl=Math.log2||function(r){return Math.log(r)/Math.log(2)},Ed=function(e){return e>0?1:e<0?-1:0},In=function(e,t){return Math.sqrt(Mn(e,t))},Mn=function(e,t){var n=t.x-e.x,a=t.y-e.y;return n*n+a*a},gg=function(e){for(var t=e.length,n=0,a=0;a<t;a++)n+=e[a];for(var i=0;i<t;i++)e[i]=e[i]/n;return e},_t=function(e,t,n,a){return(1-a)*(1-a)*e+2*(1-a)*a*t+a*a*n},ia=function(e,t,n,a){return{x:_t(e.x,t.x,n.x,a),y:_t(e.y,t.y,n.y,a)}},mg=function(e,t,n,a){var i={x:t.x-e.x,y:t.y-e.y},o=In(e,t),s={x:i.x/o,y:i.y/o};return n=n??0,a=a??n*o,{x:e.x+s.x*a,y:e.y+s.y*a}},Ka=function(e,t,n){return Math.max(e,Math.min(n,t))},tr=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},yg=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},Cg=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},bg=function(e,t,n){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},Td=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},wg=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},So=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Eo=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,a,i,o;if(t.length===1)n=a=i=o=t[0];else if(t.length===2)n=i=t[0],o=a=t[1];else if(t.length===4){var s=dt(t,4);n=s[0],a=s[1],i=s[2],o=s[3]}return e.x1-=o,e.x2+=a,e.y1-=n,e.y2+=i,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Uu=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},vl=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},ca=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},xg=function(e,t){return ca(e,t.x,t.y)},Md=function(e,t){return ca(e,t.x1,t.y1)&&ca(e,t.x2,t.y2)},Dd=function(e,t,n,a,i,o,s){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?Rn(i,o):l,c=i/2,d=o/2;u=Math.min(u,c,d);var f=u!==c,v=u!==d,h;if(f){var m=n-c+u-s,g=a-d-s,p=n+c-u+s,y=g;if(h=un(e,t,n,a,m,g,p,y,!1),h.length>0)return h}if(v){var b=n+c+s,_=a-d+u-s,B=b,k=a+d-u+s;if(h=un(e,t,n,a,b,_,B,k,!1),h.length>0)return h}if(f){var M=n-c+u-s,O=a+d+s,P=n+c-u+s,L=O;if(h=un(e,t,n,a,M,O,P,L,!1),h.length>0)return h}if(v){var F=n-c-s,E=a-d+u-s,A=F,S=a+d-u+s;if(h=un(e,t,n,a,F,E,A,S,!1),h.length>0)return h}var w;{var C=n-c+u,x=a-d+u;if(w=Fa(e,t,n,a,C,x,u+s),w.length>0&&w[0]<=C&&w[1]<=x)return[w[0],w[1]]}{var D=n+c-u,T=a-d+u;if(w=Fa(e,t,n,a,D,T,u+s),w.length>0&&w[0]>=D&&w[1]<=T)return[w[0],w[1]]}{var V=n+c-u,z=a+d-u;if(w=Fa(e,t,n,a,V,z,u+s),w.length>0&&w[0]>=V&&w[1]>=z)return[w[0],w[1]]}{var j=n-c+u,U=a+d-u;if(w=Fa(e,t,n,a,j,U,u+s),w.length>0&&w[0]<=j&&w[1]>=U)return[w[0],w[1]]}return[]},_g=function(e,t,n,a,i,o,s){var l=s,u=Math.min(n,i),c=Math.max(n,i),d=Math.min(a,o),f=Math.max(a,o);return u-l<=e&&e<=c+l&&d-l<=t&&t<=f+l},Sg=function(e,t,n,a,i,o,s,l,u){var c={x1:Math.min(n,s,i)-u,x2:Math.max(n,s,i)+u,y1:Math.min(a,l,o)-u,y2:Math.max(a,l,o)+u};return!(e<c.x1||e>c.x2||t<c.y1||t>c.y2)},Eg=function(e,t,n,a){n-=a;var i=t*t-4*e*n;if(i<0)return[];var o=Math.sqrt(i),s=2*e,l=(-t+o)/s,u=(-t-o)/s;return[l,u]},Tg=function(e,t,n,a,i){var o=1e-5;e===0&&(e=o),t/=e,n/=e,a/=e;var s,l,u,c,d,f,v,h;if(l=(3*n-t*t)/9,u=-(27*a)+t*(9*n-2*(t*t)),u/=54,s=l*l*l+u*u,i[1]=0,v=t/3,s>0){d=u+Math.sqrt(s),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),f=u-Math.sqrt(s),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),i[0]=-v+d+f,v+=(d+f)/2,i[4]=i[2]=-v,v=Math.sqrt(3)*(-f+d)/2,i[3]=v,i[5]=-v;return}if(i[5]=i[3]=0,s===0){h=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),i[0]=-v+2*h,i[4]=i[2]=-(h+v);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),h=2*Math.sqrt(l),i[0]=-v+h*Math.cos(c/3),i[2]=-v+h*Math.cos((c+2*Math.PI)/3),i[4]=-v+h*Math.cos((c+4*Math.PI)/3)},Mg=function(e,t,n,a,i,o,s,l){var u=1*n*n-4*n*i+2*n*s+4*i*i-4*i*s+s*s+a*a-4*a*o+2*a*l+4*o*o-4*o*l+l*l,c=1*9*n*i-3*n*n-3*n*s-6*i*i+3*i*s+9*a*o-3*a*a-3*a*l-6*o*o+3*o*l,d=1*3*n*n-6*n*i+n*s-n*e+2*i*i+2*i*e-s*e+3*a*a-6*a*o+a*l-a*t+2*o*o+2*o*t-l*t,f=1*n*i-n*n+n*e-i*e+a*o-a*a+a*t-o*t,v=[];Tg(u,c,d,f,v);for(var h=1e-7,m=[],g=0;g<6;g+=2)Math.abs(v[g+1])<h&&v[g]>=0&&v[g]<=1&&m.push(v[g]);m.push(1),m.push(0);for(var p=-1,y,b,_,B=0;B<m.length;B++)y=Math.pow(1-m[B],2)*n+2*(1-m[B])*m[B]*i+m[B]*m[B]*s,b=Math.pow(1-m[B],2)*a+2*(1-m[B])*m[B]*o+m[B]*m[B]*l,_=Math.pow(y-e,2)+Math.pow(b-t,2),p>=0?_<p&&(p=_):p=_;return p},Dg=function(e,t,n,a,i,o){var s=[e-n,t-a],l=[i-n,o-a],u=l[0]*l[0]+l[1]*l[1],c=s[0]*s[0]+s[1]*s[1],d=s[0]*l[0]+s[1]*l[1],f=d*d/u;return d<0?c:f>u?(e-i)*(e-i)+(t-o)*(t-o):c-f},er=function(e,t,n){for(var a,i,o,s,l,u=0,c=0;c<n.length/2;c++)if(a=n[c*2],i=n[c*2+1],c+1<n.length/2?(o=n[(c+1)*2],s=n[(c+1)*2+1]):(o=n[(c+1-n.length/2)*2],s=n[(c+1-n.length/2)*2+1]),!(a==e&&o==e))if(a>=e&&e>=o||a<=e&&e<=o)l=(e-a)/(o-a)*(s-i)+i,l>t&&u++;else continue;return u%2!==0},Ur=function(e,t,n,a,i,o,s,l,u){var c=new Array(n.length),d;l[0]!=null?(d=Math.atan(l[1]/l[0]),l[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=l;for(var f=Math.cos(-d),v=Math.sin(-d),h=0;h<c.length/2;h++)c[h*2]=o/2*(n[h*2]*f-n[h*2+1]*v),c[h*2+1]=s/2*(n[h*2+1]*f+n[h*2]*v),c[h*2]+=a,c[h*2+1]+=i;var m;if(u>0){var g=Lo(c,-u);m=Fo(g)}else m=c;return er(e,t,m)},kg=function(e,t,n,a,i,o,s,l){for(var u=new Array(n.length*2),c=0;c<l.length;c++){var d=l[c];u[c*4+0]=d.startX,u[c*4+1]=d.startY,u[c*4+2]=d.stopX,u[c*4+3]=d.stopY;var f=Math.pow(d.cx-e,2)+Math.pow(d.cy-t,2);if(f<=Math.pow(d.radius,2))return!0}return er(e,t,u)},Fo=function(e){for(var t=new Array(e.length/2),n,a,i,o,s,l,u,c,d=0;d<e.length/4;d++){n=e[d*4],a=e[d*4+1],i=e[d*4+2],o=e[d*4+3],d<e.length/4-1?(s=e[(d+1)*4],l=e[(d+1)*4+1],u=e[(d+1)*4+2],c=e[(d+1)*4+3]):(s=e[0],l=e[1],u=e[2],c=e[3]);var f=un(n,a,i,o,s,l,u,c,!0);t[d*2]=f[0],t[d*2+1]=f[1]}return t},Lo=function(e,t){for(var n=new Array(e.length*2),a,i,o,s,l=0;l<e.length/2;l++){a=e[l*2],i=e[l*2+1],l<e.length/2-1?(o=e[(l+1)*2],s=e[(l+1)*2+1]):(o=e[0],s=e[1]);var u=s-i,c=-(o-a),d=Math.sqrt(u*u+c*c),f=u/d,v=c/d;n[l*4]=a+f*t,n[l*4+1]=i+v*t,n[l*4+2]=o+f*t,n[l*4+3]=s+v*t}return n},Pg=function(e,t,n,a,i,o){var s=n-e,l=a-t;s/=i,l/=o;var u=Math.sqrt(s*s+l*l),c=u-1;if(c<0)return[];var d=c/u;return[(n-e)*d+e,(a-t)*d+t]},An=function(e,t,n,a,i,o,s){return e-=i,t-=o,e/=n/2+s,t/=a/2+s,e*e+t*t<=1},Fa=function(e,t,n,a,i,o,s){var l=[n-e,a-t],u=[e-i,t-o],c=l[0]*l[0]+l[1]*l[1],d=2*(u[0]*l[0]+u[1]*l[1]),f=u[0]*u[0]+u[1]*u[1]-s*s,v=d*d-4*c*f;if(v<0)return[];var h=(-d+Math.sqrt(v))/(2*c),m=(-d-Math.sqrt(v))/(2*c),g=Math.min(h,m),p=Math.max(h,m),y=[];if(g>=0&&g<=1&&y.push(g),p>=0&&p<=1&&y.push(p),y.length===0)return[];var b=y[0]*l[0]+e,_=y[0]*l[1]+t;if(y.length>1){if(y[0]==y[1])return[b,_];var B=y[1]*l[0]+e,k=y[1]*l[1]+t;return[b,_,B,k]}else return[b,_]},As=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},un=function(e,t,n,a,i,o,s,l,u){var c=e-i,d=n-e,f=s-i,v=t-o,h=a-t,m=l-o,g=f*v-m*c,p=d*v-h*c,y=m*d-f*h;if(y!==0){var b=g/y,_=p/y,B=.001,k=0-B,M=1+B;return k<=b&&b<=M&&k<=_&&_<=M?[e+b*d,t+b*h]:u?[e+b*d,t+b*h]:[]}else return g===0||p===0?As(e,n,s)===s?[s,l]:As(e,n,i)===i?[i,o]:As(i,s,n)===n?[n,a]:[]:[]},Ua=function(e,t,n,a,i,o,s,l){var u=[],c,d=new Array(n.length),f=!0;o==null&&(f=!1);var v;if(f){for(var h=0;h<d.length/2;h++)d[h*2]=n[h*2]*o+a,d[h*2+1]=n[h*2+1]*s+i;if(l>0){var m=Lo(d,-l);v=Fo(m)}else v=d}else v=n;for(var g,p,y,b,_=0;_<v.length/2;_++)g=v[_*2],p=v[_*2+1],_<v.length/2-1?(y=v[(_+1)*2],b=v[(_+1)*2+1]):(y=v[0],b=v[1]),c=un(e,t,a,i,g,p,y,b),c.length!==0&&u.push(c[0],c[1]);return u},Ag=function(e,t,n,a,i,o,s,l,u){var c=[],d,f=new Array(n.length*2);u.forEach(function(y,b){b===0?(f[f.length-2]=y.startX,f[f.length-1]=y.startY):(f[b*4-2]=y.startX,f[b*4-1]=y.startY),f[b*4]=y.stopX,f[b*4+1]=y.stopY,d=Fa(e,t,a,i,y.cx,y.cy,y.radius),d.length!==0&&c.push(d[0],d[1])});for(var v=0;v<f.length/4;v++)d=un(e,t,a,i,f[v*4],f[v*4+1],f[v*4+2],f[v*4+3],!1),d.length!==0&&c.push(d[0],d[1]);if(c.length>2){for(var h=[c[0],c[1]],m=Math.pow(h[0]-e,2)+Math.pow(h[1]-t,2),g=1;g<c.length/2;g++){var p=Math.pow(c[g*2]-e,2)+Math.pow(c[g*2+1]-t,2);p<=m&&(h[0]=c[g*2],h[1]=c[g*2+1],m=p)}return h}return c},fo=function(e,t,n){var a=[e[0]-t[0],e[1]-t[1]],i=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=(i-n)/i;return o<0&&(o=1e-5),[t[0]+o*a[0],t[1]+o*a[1]]},Gt=function(e,t){var n=Hs(e,t);return n=kd(n),n},kd=function(e){for(var t,n,a=e.length/2,i=1/0,o=1/0,s=-1/0,l=-1/0,u=0;u<a;u++)t=e[2*u],n=e[2*u+1],i=Math.min(i,t),s=Math.max(s,t),o=Math.min(o,n),l=Math.max(l,n);for(var c=2/(s-i),d=2/(l-o),f=0;f<a;f++)t=e[2*f]=e[2*f]*c,n=e[2*f+1]=e[2*f+1]*d,i=Math.min(i,t),s=Math.max(s,t),o=Math.min(o,n),l=Math.max(l,n);if(o<-1)for(var v=0;v<a;v++)n=e[2*v+1]=e[2*v+1]+(-1-o);return e},Hs=function(e,t){var n=1/e*2*Math.PI,a=e%2===0?Math.PI/2+n/2:Math.PI/2;a+=t;for(var i=new Array(e*2),o,s=0;s<e;s++)o=s*n+a,i[2*s]=Math.cos(o),i[2*s+1]=Math.sin(-o);return i},Rn=function(e,t){return Math.min(e/4,t/4,8)},Pd=function(e,t){return Math.min(e/10,t/10,8)},pl=function(){return 8},Bg=function(e,t,n){return[e-2*t+n,2*(t-e),e]},Ws=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},Ig=St({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),Rg={pageRank:function(e){for(var t=Ig(e),n=t.dampingFactor,a=t.precision,i=t.iterations,o=t.weight,s=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,d=u.length,f=d*d,v=c.length,h=new Array(f),m=new Array(d),g=(1-n)/d,p=0;p<d;p++){for(var y=0;y<d;y++){var b=p*d+y;h[b]=0}m[p]=0}for(var _=0;_<v;_++){var B=c[_],k=B.data("source"),M=B.data("target");if(k!==M){var O=u.indexOfId(k),P=u.indexOfId(M),L=o(B),F=P*d+O;h[F]+=L,m[O]+=L}}for(var E=1/d+g,A=0;A<d;A++)if(m[A]===0)for(var S=0;S<d;S++){var w=S*d+A;h[w]=E}else for(var C=0;C<d;C++){var x=C*d+A;h[x]=h[x]/m[A]+g}for(var D=new Array(d),T=new Array(d),V,z=0;z<d;z++)D[z]=1;for(var j=0;j<i;j++){for(var U=0;U<d;U++)T[U]=0;for(var Y=0;Y<d;Y++)for(var te=0;te<d;te++){var J=Y*d+te;T[Y]+=h[J]*D[te]}gg(T),V=D,D=T,T=V;for(var ne=0,ae=0;ae<d;ae++){var K=V[ae]-D[ae];ne+=K*K}if(ne<a)break}var R={rank:function(G){return G=s.collection(G)[0],D[u.indexOf(G)]}};return R}},Xu=St({root:null,weight:function(e){return 1},directed:!1,alpha:0}),oa={degreeCentralityNormalized:function(e){e=Xu(e);var t=this.cy(),n=this.nodes(),a=n.length;if(e.directed){for(var c={},d={},f=0,v=0,h=0;h<a;h++){var m=n[h],g=m.id();e.root=m;var p=this.degreeCentrality(e);f<p.indegree&&(f=p.indegree),v<p.outdegree&&(v=p.outdegree),c[g]=p.indegree,d[g]=p.outdegree}return{indegree:function(b){return f==0?0:(Be(b)&&(b=t.filter(b)),c[b.id()]/f)},outdegree:function(b){return v===0?0:(Be(b)&&(b=t.filter(b)),d[b.id()]/v)}}}else{for(var i={},o=0,s=0;s<a;s++){var l=n[s];e.root=l;var u=this.degreeCentrality(e);o<u.degree&&(o=u.degree),i[l.id()]=u.degree}return{degree:function(b){return o===0?0:(Be(b)&&(b=t.filter(b)),i[b.id()]/o)}}}},degreeCentrality:function(e){e=Xu(e);var t=this.cy(),n=this,a=e,i=a.root,o=a.weight,s=a.directed,l=a.alpha;if(i=t.collection(i)[0],s){for(var v=i.connectedEdges(),h=v.filter(function(k){return k.target().same(i)&&n.has(k)}),m=v.filter(function(k){return k.source().same(i)&&n.has(k)}),g=h.length,p=m.length,y=0,b=0,_=0;_<h.length;_++)y+=o(h[_]);for(var B=0;B<m.length;B++)b+=o(m[B]);return{indegree:Math.pow(g,1-l)*Math.pow(y,l),outdegree:Math.pow(p,1-l)*Math.pow(b,l)}}else{for(var u=i.connectedEdges().intersection(n),c=u.length,d=0,f=0;f<u.length;f++)d+=o(u[f]);return{degree:Math.pow(c,1-l)*Math.pow(d,l)}}}};oa.dc=oa.degreeCentrality;oa.dcn=oa.degreeCentralityNormalised=oa.degreeCentralityNormalized;var Yu=St({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),sa={closenessCentralityNormalized:function(e){for(var t=Yu(e),n=t.harmonic,a=t.weight,i=t.directed,o=this.cy(),s={},l=0,u=this.nodes(),c=this.floydWarshall({weight:a,directed:i}),d=0;d<u.length;d++){for(var f=0,v=u[d],h=0;h<u.length;h++)if(d!==h){var m=c.distance(v,u[h]);n?f+=1/m:f+=m}n||(f=1/f),l<f&&(l=f),s[v.id()]=f}return{closeness:function(p){return l==0?0:(Be(p)?p=o.filter(p)[0].id():p=p.id(),s[p]/l)}}},closenessCentrality:function(e){var t=Yu(e),n=t.root,a=t.weight,i=t.directed,o=t.harmonic;n=this.filter(n)[0];for(var s=this.dijkstra({root:n,weight:a,directed:i}),l=0,u=this.nodes(),c=0;c<u.length;c++){var d=u[c];if(!d.same(n)){var f=s.distanceTo(d);o?l+=1/f:l+=f}}return o?l:1/l}};sa.cc=sa.closenessCentrality;sa.ccn=sa.closenessCentralityNormalised=sa.closenessCentralityNormalized;var Og=St({weight:null,directed:!1}),Ks={betweennessCentrality:function(e){for(var t=Og(e),n=t.directed,a=t.weight,i=a!=null,o=this.cy(),s=this.nodes(),l={},u={},c=0,d={set:function(b,_){u[b]=_,_>c&&(c=_)},get:function(b){return u[b]}},f=0;f<s.length;f++){var v=s[f],h=v.id();n?l[h]=v.outgoers().nodes():l[h]=v.openNeighborhood().nodes(),d.set(h,0)}for(var m=function(b){for(var _=s[b].id(),B=[],k={},M={},O={},P=new ai(function(te,J){return O[te]-O[J]}),L=0;L<s.length;L++){var F=s[L].id();k[F]=[],M[F]=0,O[F]=1/0}for(M[_]=1,O[_]=0,P.push(_);!P.empty();){var E=P.pop();if(B.push(E),i)for(var A=0;A<l[E].length;A++){var S=l[E][A],w=o.getElementById(E),C=void 0;w.edgesTo(S).length>0?C=w.edgesTo(S)[0]:C=S.edgesTo(w)[0];var x=a(C);S=S.id(),O[S]>O[E]+x&&(O[S]=O[E]+x,P.nodes.indexOf(S)<0?P.push(S):P.updateItem(S),M[S]=0,k[S]=[]),O[S]==O[E]+x&&(M[S]=M[S]+M[E],k[S].push(E))}else for(var D=0;D<l[E].length;D++){var T=l[E][D].id();O[T]==1/0&&(P.push(T),O[T]=O[E]+1),O[T]==O[E]+1&&(M[T]=M[T]+M[E],k[T].push(E))}}for(var V={},z=0;z<s.length;z++)V[s[z].id()]=0;for(;B.length>0;){for(var j=B.pop(),U=0;U<k[j].length;U++){var Y=k[j][U];V[Y]=V[Y]+M[Y]/M[j]*(1+V[j])}j!=s[b].id()&&d.set(j,d.get(j)+V[j])}},g=0;g<s.length;g++)m(g);var p={betweenness:function(b){var _=o.collection(b).id();return d.get(_)},betweennessNormalized:function(b){if(c==0)return 0;var _=o.collection(b).id();return d.get(_)/c}};return p.betweennessNormalised=p.betweennessNormalized,p}};Ks.bc=Ks.betweennessCentrality;var Fg=St({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),Lg=function(e){return Fg(e)},Vg=function(e,t){for(var n=0,a=0;a<t.length;a++)n+=t[a](e);return n},Ng=function(e,t,n){for(var a=0;a<t;a++)e[a*t+a]=n},Ad=function(e,t){for(var n,a=0;a<t;a++){n=0;for(var i=0;i<t;i++)n+=e[i*t+a];for(var o=0;o<t;o++)e[o*t+a]=e[o*t+a]/n}},zg=function(e,t,n){for(var a=new Array(n*n),i=0;i<n;i++){for(var o=0;o<n;o++)a[i*n+o]=0;for(var s=0;s<n;s++)for(var l=0;l<n;l++)a[i*n+l]+=e[i*n+s]*t[s*n+l]}return a},jg=function(e,t,n){for(var a=e.slice(0),i=1;i<n;i++)e=zg(e,a,t);return e},Gg=function(e,t,n){for(var a=new Array(t*t),i=0;i<t*t;i++)a[i]=Math.pow(e[i],n);return Ad(a,t),a},$g=function(e,t,n,a){for(var i=0;i<n;i++){var o=Math.round(e[i]*Math.pow(10,a))/Math.pow(10,a),s=Math.round(t[i]*Math.pow(10,a))/Math.pow(10,a);if(o!==s)return!1}return!0},qg=function(e,t,n,a){for(var i=[],o=0;o<t;o++){for(var s=[],l=0;l<t;l++)Math.round(e[o*t+l]*1e3)/1e3>0&&s.push(n[l]);s.length!==0&&i.push(a.collection(s))}return i},Hg=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},Wg=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&Hg(e[t],e[n])&&e.splice(n,1);return e},Qu=function(e){for(var t=this.nodes(),n=this.edges(),a=this.cy(),i=Lg(e),o={},s=0;s<t.length;s++)o[t[s].id()]=s;for(var l=t.length,u=l*l,c=new Array(u),d,f=0;f<u;f++)c[f]=0;for(var v=0;v<n.length;v++){var h=n[v],m=o[h.source().id()],g=o[h.target().id()],p=Vg(h,i.attributes);c[m*l+g]+=p,c[g*l+m]+=p}Ng(c,l,i.multFactor),Ad(c,l);for(var y=!0,b=0;y&&b<i.maxIterations;)y=!1,d=jg(c,l,i.expandFactor),c=Gg(d,l,i.inflateFactor),$g(c,d,u,4)||(y=!0),b++;var _=qg(c,l,t,a);return _=Wg(_),_},Kg={markovClustering:Qu,mcl:Qu},Ug=function(e){return e},Bd=function(e,t){return Math.abs(t-e)},Zu=function(e,t,n){return e+Bd(t,n)},Ju=function(e,t,n){return e+Math.pow(n-t,2)},Xg=function(e){return Math.sqrt(e)},Yg=function(e,t,n){return Math.max(e,Bd(t,n))},Da=function(e,t,n,a,i){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:Ug,s=a,l,u,c=0;c<e;c++)l=t(c),u=n(c),s=i(s,l,u);return o(s)},da={euclidean:function(e,t,n){return e>=2?Da(e,t,n,0,Ju,Xg):Da(e,t,n,0,Zu)},squaredEuclidean:function(e,t,n){return Da(e,t,n,0,Ju)},manhattan:function(e,t,n){return Da(e,t,n,0,Zu)},max:function(e,t,n){return Da(e,t,n,-1/0,Yg)}};da["squared-euclidean"]=da.squaredEuclidean;da.squaredeuclidean=da.squaredEuclidean;function Xo(r,e,t,n,a,i){var o;return st(r)?o=r:o=da[r]||da.euclidean,e===0&&st(r)?o(a,i):o(e,t,n,a,i)}var Qg=St({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),gl=function(e){return Qg(e)},Vo=function(e,t,n,a,i){var o=i!=="kMedoids",s=o?function(d){return n[d]}:function(d){return a[d](n)},l=function(f){return a[f](t)},u=n,c=t;return Xo(e,a.length,s,l,u,c)},Bs=function(e,t,n){for(var a=n.length,i=new Array(a),o=new Array(a),s=new Array(t),l=null,u=0;u<a;u++)i[u]=e.min(n[u]).value,o[u]=e.max(n[u]).value;for(var c=0;c<t;c++){l=[];for(var d=0;d<a;d++)l[d]=Math.random()*(o[d]-i[d])+i[d];s[c]=l}return s},Id=function(e,t,n,a,i){for(var o=1/0,s=0,l=0;l<t.length;l++){var u=Vo(n,e,t[l],a,i);u<o&&(o=u,s=l)}return s},Rd=function(e,t,n){for(var a=[],i=null,o=0;o<t.length;o++)i=t[o],n[i.id()]===e&&a.push(i);return a},Zg=function(e,t,n){return Math.abs(t-e)<=n},Jg=function(e,t,n){for(var a=0;a<e.length;a++)for(var i=0;i<e[a].length;i++){var o=Math.abs(e[a][i]-t[a][i]);if(o>n)return!1}return!0},em=function(e,t,n){for(var a=0;a<n;a++)if(e===t[a])return!0;return!1},ec=function(e,t){var n=new Array(t);if(e.length<50)for(var a=0;a<t;a++){for(var i=e[Math.floor(Math.random()*e.length)];em(i,n,a);)i=e[Math.floor(Math.random()*e.length)];n[a]=i}else for(var o=0;o<t;o++)n[o]=e[Math.floor(Math.random()*e.length)];return n},tc=function(e,t,n){for(var a=0,i=0;i<t.length;i++)a+=Vo("manhattan",t[i],e,n,"kMedoids");return a},tm=function(e){var t=this.cy(),n=this.nodes(),a=null,i=gl(e),o=new Array(i.k),s={},l;i.testMode?typeof i.testCentroids=="number"?(i.testCentroids,l=Bs(n,i.k,i.attributes)):pt(i.testCentroids)==="object"?l=i.testCentroids:l=Bs(n,i.k,i.attributes):l=Bs(n,i.k,i.attributes);for(var u=!0,c=0;u&&c<i.maxIterations;){for(var d=0;d<n.length;d++)a=n[d],s[a.id()]=Id(a,l,i.distance,i.attributes,"kMeans");u=!1;for(var f=0;f<i.k;f++){var v=Rd(f,n,s);if(v.length!==0){for(var h=i.attributes.length,m=l[f],g=new Array(h),p=new Array(h),y=0;y<h;y++){p[y]=0;for(var b=0;b<v.length;b++)a=v[b],p[y]+=i.attributes[y](a);g[y]=p[y]/v.length,Zg(g[y],m[y],i.sensitivityThreshold)||(u=!0)}l[f]=g,o[f]=t.collection(v)}}c++}return o},rm=function(e){var t=this.cy(),n=this.nodes(),a=null,i=gl(e),o=new Array(i.k),s,l={},u,c=new Array(i.k);i.testMode?typeof i.testCentroids=="number"||(pt(i.testCentroids)==="object"?s=i.testCentroids:s=ec(n,i.k)):s=ec(n,i.k);for(var d=!0,f=0;d&&f<i.maxIterations;){for(var v=0;v<n.length;v++)a=n[v],l[a.id()]=Id(a,s,i.distance,i.attributes,"kMedoids");d=!1;for(var h=0;h<s.length;h++){var m=Rd(h,n,l);if(m.length!==0){c[h]=tc(s[h],m,i.attributes);for(var g=0;g<m.length;g++)u=tc(m[g],m,i.attributes),u<c[h]&&(c[h]=u,s[h]=m[g],d=!0);o[h]=t.collection(m)}}f++}return o},nm=function(e,t,n,a,i){for(var o,s,l=0;l<t.length;l++)for(var u=0;u<e.length;u++)a[l][u]=Math.pow(n[l][u],i.m);for(var c=0;c<e.length;c++)for(var d=0;d<i.attributes.length;d++){o=0,s=0;for(var f=0;f<t.length;f++)o+=a[f][c]*i.attributes[d](t[f]),s+=a[f][c];e[c][d]=o/s}},am=function(e,t,n,a,i){for(var o=0;o<e.length;o++)t[o]=e[o].slice();for(var s,l,u,c=2/(i.m-1),d=0;d<n.length;d++)for(var f=0;f<a.length;f++){s=0;for(var v=0;v<n.length;v++)l=Vo(i.distance,a[f],n[d],i.attributes,"cmeans"),u=Vo(i.distance,a[f],n[v],i.attributes,"cmeans"),s+=Math.pow(l/u,c);e[f][d]=1/s}},im=function(e,t,n,a){for(var i=new Array(n.k),o=0;o<i.length;o++)i[o]=[];for(var s,l,u=0;u<t.length;u++){s=-1/0,l=-1;for(var c=0;c<t[0].length;c++)t[u][c]>s&&(s=t[u][c],l=c);i[l].push(e[u])}for(var d=0;d<i.length;d++)i[d]=a.collection(i[d]);return i},rc=function(e){var t=this.cy(),n=this.nodes(),a=gl(e),i,o,s,l,u;l=new Array(n.length);for(var c=0;c<n.length;c++)l[c]=new Array(a.k);s=new Array(n.length);for(var d=0;d<n.length;d++)s[d]=new Array(a.k);for(var f=0;f<n.length;f++){for(var v=0,h=0;h<a.k;h++)s[f][h]=Math.random(),v+=s[f][h];for(var m=0;m<a.k;m++)s[f][m]=s[f][m]/v}o=new Array(a.k);for(var g=0;g<a.k;g++)o[g]=new Array(a.attributes.length);u=new Array(n.length);for(var p=0;p<n.length;p++)u[p]=new Array(a.k);for(var y=!0,b=0;y&&b<a.maxIterations;)y=!1,nm(o,n,s,u,a),am(s,l,o,n,a),Jg(s,l,a.sensitivityThreshold)||(y=!0),b++;return i=im(n,s,a,t),{clusters:i,degreeOfMembership:s}},om={kMeans:tm,kMedoids:rm,fuzzyCMeans:rc,fcm:rc},sm=St({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),lm={single:"min",complete:"max"},um=function(e){var t=sm(e),n=lm[t.linkage];return n!=null&&(t.linkage=n),t},nc=function(e,t,n,a,i){for(var o=0,s=1/0,l,u=i.attributes,c=function(P,L){return Xo(i.distance,u.length,function(F){return u[F](P)},function(F){return u[F](L)},P,L)},d=0;d<e.length;d++){var f=e[d].key,v=n[f][a[f]];v<s&&(o=f,s=v)}if(i.mode==="threshold"&&s>=i.threshold||i.mode==="dendrogram"&&e.length===1)return!1;var h=t[o],m=t[a[o]],g;i.mode==="dendrogram"?g={left:h,right:m,key:h.key}:g={value:h.value.concat(m.value),key:h.key},e[h.index]=g,e.splice(m.index,1),t[h.key]=g;for(var p=0;p<e.length;p++){var y=e[p];h.key===y.key?l=1/0:i.linkage==="min"?(l=n[h.key][y.key],n[h.key][y.key]>n[m.key][y.key]&&(l=n[m.key][y.key])):i.linkage==="max"?(l=n[h.key][y.key],n[h.key][y.key]<n[m.key][y.key]&&(l=n[m.key][y.key])):i.linkage==="mean"?l=(n[h.key][y.key]*h.size+n[m.key][y.key]*m.size)/(h.size+m.size):i.mode==="dendrogram"?l=c(y.value,h.value):l=c(y.value[0],h.value[0]),n[h.key][y.key]=n[y.key][h.key]=l}for(var b=0;b<e.length;b++){var _=e[b].key;if(a[_]===h.key||a[_]===m.key){for(var B=_,k=0;k<e.length;k++){var M=e[k].key;n[_][M]<n[_][B]&&(B=M)}a[_]=B}e[b].index=b}return h.key=m.key=h.index=m.index=null,!0},ho=function r(e,t,n){e&&(e.value?t.push(e.value):(e.left&&r(e.left,t),e.right&&r(e.right,t)))},cm=function r(e,t){if(!e)return"";if(e.left&&e.right){var n=r(e.left,t),a=r(e.right,t),i=t.add({group:"nodes",data:{id:n+","+a}});return t.add({group:"edges",data:{source:n,target:i.id()}}),t.add({group:"edges",data:{source:a,target:i.id()}}),i.id()}else if(e.value)return e.value.id()},dm=function r(e,t,n){if(!e)return[];var a=[],i=[],o=[];return t===0?(e.left&&ho(e.left,a),e.right&&ho(e.right,i),o=a.concat(i),[n.collection(o)]):t===1?e.value?[n.collection(e.value)]:(e.left&&ho(e.left,a),e.right&&ho(e.right,i),[n.collection(a),n.collection(i)]):e.value?[n.collection(e.value)]:(e.left&&(a=r(e.left,t-1,n)),e.right&&(i=r(e.right,t-1,n)),a.concat(i))},ac=function(e){for(var t=this.cy(),n=this.nodes(),a=um(e),i=a.attributes,o=function(b,_){return Xo(a.distance,i.length,function(B){return i[B](b)},function(B){return i[B](_)},b,_)},s=[],l=[],u=[],c=[],d=0;d<n.length;d++){var f={value:a.mode==="dendrogram"?n[d]:[n[d]],key:d,index:d};s[d]=f,c[d]=f,l[d]=[],u[d]=0}for(var v=0;v<s.length;v++)for(var h=0;h<=v;h++){var m=void 0;a.mode==="dendrogram"?m=v===h?1/0:o(s[v].value,s[h].value):m=v===h?1/0:o(s[v].value[0],s[h].value[0]),l[v][h]=m,l[h][v]=m,m<l[v][u[v]]&&(u[v]=h)}for(var g=nc(s,c,l,u,a);g;)g=nc(s,c,l,u,a);var p;return a.mode==="dendrogram"?(p=dm(s[0],a.dendrogramDepth,t),a.addDendrogram&&cm(s[0],t)):(p=new Array(s.length),s.forEach(function(y,b){y.key=y.index=null,p[b]=t.collection(y.value)})),p},fm={hierarchicalClustering:ac,hca:ac},hm=St({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),vm=function(e){var t=e.damping,n=e.preference;.5<=t&&t<1||ot("Damping must range on [0.5, 1).  Got: ".concat(t));var a=["median","mean","min","max"];return a.some(function(i){return i===n})||Ce(n)||ot("Preference must be one of [".concat(a.map(function(i){return"'".concat(i,"'")}).join(", "),"] or a number.  Got: ").concat(n)),hm(e)},pm=function(e,t,n,a){var i=function(s,l){return a[l](s)};return-Xo(e,a.length,function(o){return i(t,o)},function(o){return i(n,o)},t,n)},gm=function(e,t){var n=null;return t==="median"?n=vg(e):t==="mean"?n=hg(e):t==="min"?n=dg(e):t==="max"?n=fg(e):n=t,n},mm=function(e,t,n){for(var a=[],i=0;i<e;i++)t[i*e+i]+n[i*e+i]>0&&a.push(i);return a},ic=function(e,t,n){for(var a=[],i=0;i<e;i++){for(var o=-1,s=-1/0,l=0;l<n.length;l++){var u=n[l];t[i*e+u]>s&&(o=u,s=t[i*e+u])}o>0&&a.push(o)}for(var c=0;c<n.length;c++)a[n[c]]=n[c];return a},ym=function(e,t,n){for(var a=ic(e,t,n),i=0;i<n.length;i++){for(var o=[],s=0;s<a.length;s++)a[s]===n[i]&&o.push(s);for(var l=-1,u=-1/0,c=0;c<o.length;c++){for(var d=0,f=0;f<o.length;f++)d+=t[o[f]*e+o[c]];d>u&&(l=c,u=d)}n[i]=o[l]}return a=ic(e,t,n),a},oc=function(e){for(var t=this.cy(),n=this.nodes(),a=vm(e),i={},o=0;o<n.length;o++)i[n[o].id()]=o;var s,l,u,c,d,f;s=n.length,l=s*s,u=new Array(l);for(var v=0;v<l;v++)u[v]=-1/0;for(var h=0;h<s;h++)for(var m=0;m<s;m++)h!==m&&(u[h*s+m]=pm(a.distance,n[h],n[m],a.attributes));c=gm(u,a.preference);for(var g=0;g<s;g++)u[g*s+g]=c;d=new Array(l);for(var p=0;p<l;p++)d[p]=0;f=new Array(l);for(var y=0;y<l;y++)f[y]=0;for(var b=new Array(s),_=new Array(s),B=new Array(s),k=0;k<s;k++)b[k]=0,_[k]=0,B[k]=0;for(var M=new Array(s*a.minIterations),O=0;O<M.length;O++)M[O]=0;var P;for(P=0;P<a.maxIterations;P++){for(var L=0;L<s;L++){for(var F=-1/0,E=-1/0,A=-1,S=0,w=0;w<s;w++)b[w]=d[L*s+w],S=f[L*s+w]+u[L*s+w],S>=F?(E=F,F=S,A=w):S>E&&(E=S);for(var C=0;C<s;C++)d[L*s+C]=(1-a.damping)*(u[L*s+C]-F)+a.damping*b[C];d[L*s+A]=(1-a.damping)*(u[L*s+A]-E)+a.damping*b[A]}for(var x=0;x<s;x++){for(var D=0,T=0;T<s;T++)b[T]=f[T*s+x],_[T]=Math.max(0,d[T*s+x]),D+=_[T];D-=_[x],_[x]=d[x*s+x],D+=_[x];for(var V=0;V<s;V++)f[V*s+x]=(1-a.damping)*Math.min(0,D-_[V])+a.damping*b[V];f[x*s+x]=(1-a.damping)*(D-_[x])+a.damping*b[x]}for(var z=0,j=0;j<s;j++){var U=f[j*s+j]+d[j*s+j]>0?1:0;M[P%a.minIterations*s+j]=U,z+=U}if(z>0&&(P>=a.minIterations-1||P==a.maxIterations-1)){for(var Y=0,te=0;te<s;te++){B[te]=0;for(var J=0;J<a.minIterations;J++)B[te]+=M[J*s+te];(B[te]===0||B[te]===a.minIterations)&&Y++}if(Y===s)break}}for(var ne=mm(s,d,f),ae=ym(s,u,ne),K={},R=0;R<ne.length;R++)K[ne[R]]=[];for(var N=0;N<n.length;N++){var G=i[n[N].id()],W=ae[G];W!=null&&K[W].push(n[N])}for(var X=new Array(ne.length),de=0;de<ne.length;de++)X[de]=t.collection(K[ne[de]]);return X},Cm={affinityPropagation:oc,ap:oc},bm=St({root:void 0,directed:!1}),wm={hierholzer:function(e){if(!He(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n=bm(e),a=n.root,i=n.directed,o=this,s=!1,l,u,c;a&&(c=Be(a)?this.filter(a)[0].id():a[0].id());var d={},f={};i?o.forEach(function(y){var b=y.id();if(y.isNode()){var _=y.indegree(!0),B=y.outdegree(!0),k=_-B,M=B-_;k==1?l?s=!0:l=b:M==1?u?s=!0:u=b:(M>1||k>1)&&(s=!0),d[b]=[],y.outgoers().forEach(function(O){O.isEdge()&&d[b].push(O.id())})}else f[b]=[void 0,y.target().id()]}):o.forEach(function(y){var b=y.id();if(y.isNode()){var _=y.degree(!0);_%2&&(l?u?s=!0:u=b:l=b),d[b]=[],y.connectedEdges().forEach(function(B){return d[b].push(B.id())})}else f[b]=[y.source().id(),y.target().id()]});var v={found:!1,trail:void 0};if(s)return v;if(u&&l)if(i){if(c&&u!=c)return v;c=u}else{if(c&&u!=c&&l!=c)return v;c||(c=u)}else c||(c=o[0].id());var h=function(b){for(var _=b,B=[b],k,M,O;d[_].length;)k=d[_].shift(),M=f[k][0],O=f[k][1],_!=O?(d[O]=d[O].filter(function(P){return P!=k}),_=O):!i&&_!=M&&(d[M]=d[M].filter(function(P){return P!=k}),_=M),B.unshift(k),B.unshift(_);return B},m=[],g=[];for(g=h(c);g.length!=1;)d[g[0]].length==0?(m.unshift(o.getElementById(g.shift())),m.unshift(o.getElementById(g.shift()))):g=h(g.shift()).concat(g);m.unshift(o.getElementById(g.shift()));for(var p in d)if(d[p].length)return v;return v.found=!0,v.trail=this.spawn(m,!0),v}},vo=function(){var e=this,t={},n=0,a=0,i=[],o=[],s={},l=function(f,v){for(var h=o.length-1,m=[],g=e.spawn();o[h].x!=f||o[h].y!=v;)m.push(o.pop().edge),h--;m.push(o.pop().edge),m.forEach(function(p){var y=p.connectedNodes().intersection(e);g.merge(p),y.forEach(function(b){var _=b.id(),B=b.connectedEdges().intersection(e);g.merge(b),t[_].cutVertex?g.merge(B.filter(function(k){return k.isLoop()})):g.merge(B)})}),i.push(g)},u=function d(f,v,h){f===h&&(a+=1),t[v]={id:n,low:n++,cutVertex:!1};var m=e.getElementById(v).connectedEdges().intersection(e);if(m.size()===0)i.push(e.spawn(e.getElementById(v)));else{var g,p,y,b;m.forEach(function(_){g=_.source().id(),p=_.target().id(),y=g===v?p:g,y!==h&&(b=_.id(),s[b]||(s[b]=!0,o.push({x:v,y,edge:_})),y in t?t[v].low=Math.min(t[v].low,t[y].id):(d(f,y,v),t[v].low=Math.min(t[v].low,t[y].low),t[v].id<=t[y].low&&(t[v].cutVertex=!0,l(v,y))))})}};e.forEach(function(d){if(d.isNode()){var f=d.id();f in t||(a=0,u(f,f),t[f].cutVertex=a>1)}});var c=Object.keys(t).filter(function(d){return t[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(c),components:i}},xm={hopcroftTarjanBiconnected:vo,htbc:vo,htb:vo,hopcroftTarjanBiconnectedComponents:vo},po=function(){var e=this,t={},n=0,a=[],i=[],o=e.spawn(e),s=function l(u){i.push(u),t[u]={index:n,low:n++,explored:!1};var c=e.getElementById(u).connectedEdges().intersection(e);if(c.forEach(function(m){var g=m.target().id();g!==u&&(g in t||l(g),t[g].explored||(t[u].low=Math.min(t[u].low,t[g].low)))}),t[u].index===t[u].low){for(var d=e.spawn();;){var f=i.pop();if(d.merge(e.getElementById(f)),t[f].low=t[u].index,t[f].explored=!0,f===u)break}var v=d.edgesWith(d),h=d.merge(v);a.push(h),o=o.difference(h)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in t||s(u)}}),{cut:o,components:a}},_m={tarjanStronglyConnected:po,tsc:po,tscc:po,tarjanStronglyConnectedComponents:po},Od={};[Wa,Jp,eg,rg,ag,og,ug,Rg,oa,sa,Ks,Kg,om,fm,Cm,wm,xm,_m].forEach(function(r){Fe(Od,r)});var Fd=0,Ld=1,Vd=2,Xr=function r(e){if(!(this instanceof r))return new r(e);this.id="Thenable/1.0.7",this.state=Fd,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};Xr.prototype={fulfill:function(e){return sc(this,Ld,"fulfillValue",e)},reject:function(e){return sc(this,Vd,"rejectReason",e)},then:function(e,t){var n=this,a=new Xr;return n.onFulfilled.push(uc(e,a,"fulfill")),n.onRejected.push(uc(t,a,"reject")),Nd(n),a.proxy}};var sc=function(e,t,n,a){return e.state===Fd&&(e.state=t,e[n]=a,Nd(e)),e},Nd=function(e){e.state===Ld?lc(e,"onFulfilled",e.fulfillValue):e.state===Vd&&lc(e,"onRejected",e.rejectReason)},lc=function(e,t,n){if(e[t].length!==0){var a=e[t];e[t]=[];var i=function(){for(var s=0;s<a.length;s++)a[s](n)};typeof setImmediate=="function"?setImmediate(i):setTimeout(i,0)}},uc=function(e,t,n){return function(a){if(typeof e!="function")t[n].call(t,a);else{var i;try{i=e(a)}catch(o){t.reject(o);return}Sm(t,i)}}},Sm=function r(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(pt(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(i){e.reject(i);return}if(typeof n=="function"){var a=!1;try{n.call(t,function(i){a||(a=!0,i===t?e.reject(new TypeError("circular thenable chain")):r(e,i))},function(i){a||(a=!0,e.reject(i))})}catch(i){a||e.reject(i)}return}e.fulfill(t)};Xr.all=function(r){return new Xr(function(e,t){for(var n=new Array(r.length),a=0,i=function(l,u){n[l]=u,a++,a===r.length&&e(n)},o=0;o<r.length;o++)(function(s){var l=r[s],u=l!=null&&l.then!=null;if(u)l.then(function(d){i(s,d)},function(d){t(d)});else{var c=l;i(s,c)}})(o)})};Xr.resolve=function(r){return new Xr(function(e,t){e(r)})};Xr.reject=function(r){return new Xr(function(e,t){t(r)})};var va=typeof Promise<"u"?Promise:Xr,Us=function(e,t,n){var a=ll(e),i=!a,o=this._private=Fe({duration:1e3},t,n);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&st(o.complete)&&o.completes.push(o.complete),i){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(a){var l=e.pan();o.startPan={x:l.x,y:l.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},On=Us.prototype;Fe(On,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,n=e.target._private.animation;e.queue?t=n.queue:t=n.current,t.push(this),sr(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,c){var d=e[u];d!=null&&(e[u]=e[c],e[c]=d)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var a=0;a<e.style.length;a++){var i=e.style[a],o=i.name,s=e.startStyle[o];e.startStyle[o]=i,e.style[a]=s}return t&&this.play(),this},promise:function(e){var t=this._private,n;switch(e){case"frame":n=t.frames;break;default:case"complete":case"completed":n=t.completes}return new va(function(a,i){n.push(function(){a()})})}});On.complete=On.completed;On.run=On.play;On.running=On.playing;var Em={animated:function(){return function(){var t=this,n=t.length!==void 0,a=n?t:[t],i=this._private.cy||this;if(!i.styleEnabled())return!1;var o=a[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,n=t.length!==void 0,a=n?t:[t],i=this._private.cy||this;if(!i.styleEnabled())return this;for(var o=0;o<a.length;o++){var s=a[o];s._private.animation.queue=[]}return this}},delay:function(){return function(t,n){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:t,duration:t,complete:n}):this}},delayAnimation:function(){return function(t,n){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:t,duration:t,complete:n}):this}},animation:function(){return function(t,n){var a=this,i=a.length!==void 0,o=i?a:[a],s=this._private.cy||this,l=!i,u=!l;if(!s.styleEnabled())return this;var c=s.style();t=Fe({},t,n);var d=Object.keys(t).length===0;if(d)return new Us(o[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(u&&(t.style=c.getPropsList(t.style||t.css),t.css=void 0),u&&t.renderedPosition!=null){var f=t.renderedPosition,v=s.pan(),h=s.zoom();t.position=Sd(f,h,v)}if(l&&t.panBy!=null){var m=t.panBy,g=s.pan();t.pan={x:g.x+m.x,y:g.y+m.y}}var p=t.center||t.centre;if(l&&p!=null){var y=s.getCenterPan(p.eles,t.zoom);y!=null&&(t.pan=y)}if(l&&t.fit!=null){var b=t.fit,_=s.getFitViewport(b.eles||b.boundingBox,b.padding);_!=null&&(t.pan=_.pan,t.zoom=_.zoom)}if(l&&He(t.zoom)){var B=s.getZoomedViewport(t.zoom);B!=null?(B.zoomed&&(t.zoom=B.zoom),B.panned&&(t.pan=B.pan)):t.zoom=null}return new Us(o[0],t)}},animate:function(){return function(t,n){var a=this,i=a.length!==void 0,o=i?a:[a],s=this._private.cy||this;if(!s.styleEnabled())return this;n&&(t=Fe({},t,n));for(var l=0;l<o.length;l++){var u=o[l],c=u.animated()&&(t.queue===void 0||t.queue),d=u.animation(t,c?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(t,n){var a=this,i=a.length!==void 0,o=i?a:[a],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var l=0;l<o.length;l++){for(var u=o[l],c=u._private,d=c.animation.current,f=0;f<d.length;f++){var v=d[f],h=v._private;n&&(h.duration=0)}t&&(c.animation.queue=[]),n||(c.animation.current=[])}return s.notify("draw"),this}}},Tm=Array.isArray,Yo=Tm,Mm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dm=/^\w*$/;function km(r,e){if(Yo(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||ri(r)?!0:Dm.test(r)||!Mm.test(r)||e!=null&&r in Object(e)}var Pm=km,Am="[object AsyncFunction]",Bm="[object Function]",Im="[object GeneratorFunction]",Rm="[object Proxy]";function Om(r){if(!Bn(r))return!1;var e=pd(r);return e==Bm||e==Im||e==Am||e==Rm}var Fm=Om,Lm=Wo["__core-js_shared__"],Is=Lm,cc=function(){var r=/[^.]+$/.exec(Is&&Is.keys&&Is.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function Vm(r){return!!cc&&cc in r}var Nm=Vm,zm=Function.prototype,jm=zm.toString;function Gm(r){if(r!=null){try{return jm.call(r)}catch{}try{return r+""}catch{}}return""}var $m=Gm,qm=/[\\^$.*+?()[\]{}|]/g,Hm=/^\[object .+?Constructor\]$/,Wm=Function.prototype,Km=Object.prototype,Um=Wm.toString,Xm=Km.hasOwnProperty,Ym=RegExp("^"+Um.call(Xm).replace(qm,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qm(r){if(!Bn(r)||Nm(r))return!1;var e=Fm(r)?Ym:Hm;return e.test($m(r))}var Zm=Qm;function Jm(r,e){return r?.[e]}var e0=Jm;function t0(r,e){var t=e0(r,e);return Zm(t)?t:void 0}var ml=t0,r0=ml(Object,"create"),Xa=r0;function n0(){this.__data__=Xa?Xa(null):{},this.size=0}var a0=n0;function i0(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var o0=i0,s0="__lodash_hash_undefined__",l0=Object.prototype,u0=l0.hasOwnProperty;function c0(r){var e=this.__data__;if(Xa){var t=e[r];return t===s0?void 0:t}return u0.call(e,r)?e[r]:void 0}var d0=c0,f0=Object.prototype,h0=f0.hasOwnProperty;function v0(r){var e=this.__data__;return Xa?e[r]!==void 0:h0.call(e,r)}var p0=v0,g0="__lodash_hash_undefined__";function m0(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Xa&&e===void 0?g0:e,this}var y0=m0;function pa(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}pa.prototype.clear=a0;pa.prototype.delete=o0;pa.prototype.get=d0;pa.prototype.has=p0;pa.prototype.set=y0;var dc=pa;function C0(){this.__data__=[],this.size=0}var b0=C0;function w0(r,e){return r===e||r!==r&&e!==e}var zd=w0;function x0(r,e){for(var t=r.length;t--;)if(zd(r[t][0],e))return t;return-1}var Qo=x0,_0=Array.prototype,S0=_0.splice;function E0(r){var e=this.__data__,t=Qo(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():S0.call(e,t,1),--this.size,!0}var T0=E0;function M0(r){var e=this.__data__,t=Qo(e,r);return t<0?void 0:e[t][1]}var D0=M0;function k0(r){return Qo(this.__data__,r)>-1}var P0=k0;function A0(r,e){var t=this.__data__,n=Qo(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var B0=A0;function ga(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}ga.prototype.clear=b0;ga.prototype.delete=T0;ga.prototype.get=D0;ga.prototype.has=P0;ga.prototype.set=B0;var I0=ga,R0=ml(Wo,"Map"),O0=R0;function F0(){this.size=0,this.__data__={hash:new dc,map:new(O0||I0),string:new dc}}var L0=F0;function V0(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var N0=V0;function z0(r,e){var t=r.__data__;return N0(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Zo=z0;function j0(r){var e=Zo(this,r).delete(r);return this.size-=e?1:0,e}var G0=j0;function $0(r){return Zo(this,r).get(r)}var q0=$0;function H0(r){return Zo(this,r).has(r)}var W0=H0;function K0(r,e){var t=Zo(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var U0=K0;function ma(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}ma.prototype.clear=L0;ma.prototype.delete=G0;ma.prototype.get=q0;ma.prototype.has=W0;ma.prototype.set=U0;var jd=ma,X0="Expected a function";function yl(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(X0);var t=function(){var n=arguments,a=e?e.apply(this,n):n[0],i=t.cache;if(i.has(a))return i.get(a);var o=r.apply(this,n);return t.cache=i.set(a,o)||i,o};return t.cache=new(yl.Cache||jd),t}yl.Cache=jd;var Y0=yl,Q0=500;function Z0(r){var e=Y0(r,function(n){return t.size===Q0&&t.clear(),n}),t=e.cache;return e}var J0=Z0,ey=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ty=/\\(\\)?/g,ry=J0(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(ey,function(t,n,a,i){e.push(a?i.replace(ty,"$1"):n||t)}),e}),Gd=ry;function ny(r,e){for(var t=-1,n=r==null?0:r.length,a=Array(n);++t<n;)a[t]=e(r[t],t,r);return a}var $d=ny,ay=1/0,fc=ua?ua.prototype:void 0,hc=fc?fc.toString:void 0;function qd(r){if(typeof r=="string")return r;if(Yo(r))return $d(r,qd)+"";if(ri(r))return hc?hc.call(r):"";var e=r+"";return e=="0"&&1/r==-ay?"-0":e}var iy=qd;function oy(r){return r==null?"":iy(r)}var Hd=oy;function sy(r,e){return Yo(r)?r:Pm(r,e)?[r]:Gd(Hd(r))}var Wd=sy,ly=1/0;function uy(r){if(typeof r=="string"||ri(r))return r;var e=r+"";return e=="0"&&1/r==-ly?"-0":e}var Cl=uy;function cy(r,e){e=Wd(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Cl(e[t++])];return t&&t==n?r:void 0}var dy=cy;function fy(r,e,t){var n=r==null?void 0:dy(r,e);return n===void 0?t:n}var hy=fy,vy=function(){try{var r=ml(Object,"defineProperty");return r({},"",{}),r}catch{}}(),vc=vy;function py(r,e,t){e=="__proto__"&&vc?vc(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var gy=py,my=Object.prototype,yy=my.hasOwnProperty;function Cy(r,e,t){var n=r[e];(!(yy.call(r,e)&&zd(n,t))||t===void 0&&!(e in r))&&gy(r,e,t)}var by=Cy,wy=9007199254740991,xy=/^(?:0|[1-9]\d*)$/;function _y(r,e){var t=typeof r;return e=e??wy,!!e&&(t=="number"||t!="symbol"&&xy.test(r))&&r>-1&&r%1==0&&r<e}var Sy=_y;function Ey(r,e,t,n){if(!Bn(r))return r;e=Wd(e,r);for(var a=-1,i=e.length,o=i-1,s=r;s!=null&&++a<i;){var l=Cl(e[a]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return r;if(a!=o){var c=s[l];u=n?n(c,l,s):void 0,u===void 0&&(u=Bn(c)?c:Sy(e[a+1])?[]:{})}by(s,l,u),s=s[l]}return r}var Ty=Ey;function My(r,e,t){return r==null?r:Ty(r,e,t)}var Dy=My;function ky(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var Py=ky;function Ay(r){return Yo(r)?$d(r,Cl):ri(r)?[r]:Py(Gd(Hd(r)))}var By=Ay,Iy={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(a){},beforeSet:function(a,i){},onSet:function(a){},canSet:function(a){return!0}};return e=Fe({},t,e),function(a,i){var o=e,s=this,l=s.length!==void 0,u=l?s:[s],c=l?s[0]:s;if(Be(a)){var d=a.indexOf(".")!==-1,f=d&&By(a);if(o.allowGetting&&i===void 0){var v;return c&&(o.beforeGet(c),f&&c._private[o.field][a]===void 0?v=hy(c._private[o.field],f):v=c._private[o.field][a]),v}else if(o.allowSetting&&i!==void 0){var h=!o.immutableKeys[a];if(h){var m=ad({},a,i);o.beforeSet(s,m);for(var g=0,p=u.length;g<p;g++){var y=u[g];o.canSet(y)&&(f&&c._private[o.field][a]===void 0?Dy(y._private[o.field],f,i):y._private[o.field][a]=i)}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&He(a)){var b=a,_,B,k=Object.keys(b);o.beforeSet(s,b);for(var M=0;M<k.length;M++){_=k[M],B=b[_];var O=!o.immutableKeys[_];if(O)for(var P=0;P<u.length;P++){var L=u[P];o.canSet(L)&&(L._private[o.field][_]=B)}}o.updateStyle&&s.updateStyle(),o.onSet(s),o.settingTriggersEvent&&s[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&st(a)){var F=a;s.on(o.bindingEvent,F)}else if(o.allowGetting&&a===void 0){var E;return c&&(o.beforeGet(c),E=c._private[o.field]),E}return s}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Fe({},t,e),function(a){var i=e,o=this,s=o.length!==void 0,l=s?o:[o];if(Be(a)){for(var u=a.split(/\s+/),c=u.length,d=0;d<c;d++){var f=u[d];if(!fn(f)){var v=!i.immutableKeys[f];if(v)for(var h=0,m=l.length;h<m;h++)l[h]._private[i.field][f]=void 0}}i.triggerEvent&&o[i.triggerFnName](i.event)}else if(a===void 0){for(var g=0,p=l.length;g<p;g++)for(var y=l[g]._private[i.field],b=Object.keys(y),_=0;_<b.length;_++){var B=b[_],k=!i.immutableKeys[B];k&&(y[B]=void 0)}i.triggerEvent&&o[i.triggerFnName](i.event)}return o}}},Ry={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,a){var i=this,o=Array.prototype.slice.call(arguments,0);return new va(function(s,l){var u=function(v){i.off.apply(i,d),s(v)},c=o.concat([u]),d=c.concat([]);i.on.apply(i,c)})}}},Xe={};[Em,Iy,Ry].forEach(function(r){Fe(Xe,r)});var Oy={animate:Xe.animate(),animation:Xe.animation(),animated:Xe.animated(),clearQueue:Xe.clearQueue(),delay:Xe.delay(),delayAnimation:Xe.delayAnimation(),stop:Xe.stop()},To={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(h){return n.push(h)}),n}else Je(e)||(e=(e||"").match(/\S+/g)||[]);for(var a=[],i=new ha(e),o=0;o<t.length;o++){for(var s=t[o],l=s._private,u=l.classes,c=!1,d=0;d<e.length;d++){var f=e[d],v=u.has(f);if(!v){c=!0;break}}c||(c=u.size!==e.length),c&&(l.classes=i,a.push(s))}return a.length>0&&this.spawn(a).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){Je(e)||(e=e.match(/\S+/g)||[]);for(var n=this,a=t===void 0,i=[],o=0,s=n.length;o<s;o++)for(var l=n[o],u=l._private.classes,c=!1,d=0;d<e.length;d++){var f=e[d],v=u.has(f),h=!1;t||a&&!v?(u.add(f),h=!0):(!t||a&&v)&&(u.delete(f),h=!0),!c&&h&&(i.push(l),c=!0)}return i.length>0&&this.spawn(i).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};To.className=To.classNames=To.classes;var qe={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:vt,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};qe.variable="(?:[\\w-.]|(?:\\\\"+qe.metaChar+"))+";qe.className="(?:[\\w-]|(?:\\\\"+qe.metaChar+"))+";qe.value=qe.string+"|"+qe.number;qe.id=qe.variable;(function(){var r,e,t;for(r=qe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],qe.comparatorOp+="|@"+e;for(r=qe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(qe.comparatorOp+="|\\!"+e)})();var Qe=function(){return{checks:[]}},Pe={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},Xs=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return Uv(r.selector,e.selector)}),Fy=function(){for(var r={},e,t=0;t<Xs.length;t++)e=Xs[t],r[e.selector]=e.matches;return r}(),Ly=function(e,t){return Fy[e](t)},Vy="("+Xs.map(function(r){return r.selector}).join("|")+")",Qn=function(e){return e.replace(new RegExp("\\\\("+qe.metaChar+")","g"),function(t,n){return n})},sn=function(e,t,n){e[e.length-1]=n},Ys=[{name:"group",query:!0,regex:"("+qe.group+")",populate:function(e,t,n){var a=dt(n,1),i=a[0];t.checks.push({type:Pe.GROUP,value:i==="*"?i:i+"s"})}},{name:"state",query:!0,regex:Vy,populate:function(e,t,n){var a=dt(n,1),i=a[0];t.checks.push({type:Pe.STATE,value:i})}},{name:"id",query:!0,regex:"\\#("+qe.id+")",populate:function(e,t,n){var a=dt(n,1),i=a[0];t.checks.push({type:Pe.ID,value:Qn(i)})}},{name:"className",query:!0,regex:"\\.("+qe.className+")",populate:function(e,t,n){var a=dt(n,1),i=a[0];t.checks.push({type:Pe.CLASS,value:Qn(i)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+qe.variable+")\\s*\\]",populate:function(e,t,n){var a=dt(n,1),i=a[0];t.checks.push({type:Pe.DATA_EXIST,field:Qn(i)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+qe.variable+")\\s*("+qe.comparatorOp+")\\s*("+qe.value+")\\s*\\]",populate:function(e,t,n){var a=dt(n,3),i=a[0],o=a[1],s=a[2],l=new RegExp("^"+qe.string+"$").exec(s)!=null;l?s=s.substring(1,s.length-1):s=parseFloat(s),t.checks.push({type:Pe.DATA_COMPARE,field:Qn(i),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+qe.boolOp+")\\s*("+qe.variable+")\\s*\\]",populate:function(e,t,n){var a=dt(n,2),i=a[0],o=a[1];t.checks.push({type:Pe.DATA_BOOL,field:Qn(o),operator:i})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+qe.meta+")\\s*("+qe.comparatorOp+")\\s*("+qe.number+")\\s*\\]\\]",populate:function(e,t,n){var a=dt(n,3),i=a[0],o=a[1],s=a[2];t.checks.push({type:Pe.META_COMPARE,field:Qn(i),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:qe.separator,populate:function(e,t){var n=e.currentSubject,a=e.edgeCount,i=e.compoundCount,o=e[e.length-1];n!=null&&(o.subject=n,e.currentSubject=null),o.edgeCount=a,o.compoundCount=i,e.edgeCount=0,e.compoundCount=0;var s=e[e.length++]=Qe();return s}},{name:"directedEdge",separator:!0,regex:qe.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),a=t,i=Qe();return n.checks.push({type:Pe.DIRECTED_EDGE,source:a,target:i}),sn(e,t,n),e.edgeCount++,i}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Pe.NODE_SOURCE,source:s,target:l}),sn(e,t,o),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:qe.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),a=t,i=Qe();return n.checks.push({type:Pe.UNDIRECTED_EDGE,nodes:[a,i]}),sn(e,t,n),e.edgeCount++,i}else{var o=Qe(),s=t,l=Qe();return o.checks.push({type:Pe.NODE_NEIGHBOR,node:s,neighbor:l}),sn(e,t,o),l}}},{name:"child",separator:!0,regex:qe.child,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),a=Qe(),i=e[e.length-1];return n.checks.push({type:Pe.CHILD,parent:i,child:a}),sn(e,t,n),e.compoundCount++,a}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),c=Qe(),d=Qe();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Pe.TRUE}],d.checks.push({type:Pe.TRUE}),l.checks.push({type:Pe.PARENT,parent:d,child:c}),sn(e,s,o),e.currentSubject=u,e.compoundCount++,c}else{var f=Qe(),v=Qe(),h=[{type:Pe.PARENT,parent:f,child:v}];return f.checks=t.checks,t.checks=h,e.compoundCount++,v}}},{name:"descendant",separator:!0,regex:qe.descendant,populate:function(e,t){if(e.currentSubject==null){var n=Qe(),a=Qe(),i=e[e.length-1];return n.checks.push({type:Pe.DESCENDANT,ancestor:i,descendant:a}),sn(e,t,n),e.compoundCount++,a}else if(e.currentSubject===t){var o=Qe(),s=e[e.length-1],l=Qe(),u=Qe(),c=Qe(),d=Qe();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:s,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:Pe.TRUE}],d.checks.push({type:Pe.TRUE}),l.checks.push({type:Pe.ANCESTOR,ancestor:d,descendant:c}),sn(e,s,o),e.currentSubject=u,e.compoundCount++,c}else{var f=Qe(),v=Qe(),h=[{type:Pe.ANCESTOR,ancestor:f,descendant:v}];return f.checks=t.checks,t.checks=h,e.compoundCount++,v}}},{name:"subject",modifier:!0,regex:qe.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return Ye("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1],a=n.checks[0],i=a==null?null:a.type;i===Pe.DIRECTED_EDGE?a.type=Pe.NODE_TARGET:i===Pe.UNDIRECTED_EDGE&&(a.type=Pe.NODE_NEIGHBOR,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];Ys.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var Ny=function(e){for(var t,n,a,i=0;i<Ys.length;i++){var o=Ys[i],s=o.name,l=e.match(o.regexObj);if(l!=null){n=l,t=o,a=s;var u=l[0];e=e.substring(u.length);break}}return{expr:t,match:n,name:a,remaining:e}},zy=function(e){var t=e.match(/^\s+/);if(t){var n=t[0];e=e.substring(n.length)}return e},jy=function(e){var t=this,n=t.inputText=e,a=t[0]=Qe();for(t.length=1,n=zy(n);;){var i=Ny(n);if(i.expr==null)return Ye("The selector `"+e+"`is invalid"),!1;var o=i.match.slice(1),s=i.expr.populate(t,a,o);if(s===!1)return!1;if(s!=null&&(a=s),n=i.remaining,n.match(/^\s*$/))break}var l=t[t.length-1];t.currentSubject!=null&&(l.subject=t.currentSubject),l.edgeCount=t.edgeCount,l.compoundCount=t.compoundCount;for(var u=0;u<t.length;u++){var c=t[u];if(c.compoundCount>0&&c.edgeCount>0)return Ye("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Ye("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Ye("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},Gy=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},t=function(c){return Be(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},a=function(c,d){var f=c.type,v=c.value;switch(f){case Pe.GROUP:{var h=e(v);return h.substring(0,h.length-1)}case Pe.DATA_COMPARE:{var m=c.field,g=c.operator;return"["+m+n(e(g))+t(v)+"]"}case Pe.DATA_BOOL:{var p=c.operator,y=c.field;return"["+e(p)+y+"]"}case Pe.DATA_EXIST:{var b=c.field;return"["+b+"]"}case Pe.META_COMPARE:{var _=c.operator,B=c.field;return"[["+B+n(e(_))+t(v)+"]]"}case Pe.STATE:return v;case Pe.ID:return"#"+v;case Pe.CLASS:return"."+v;case Pe.PARENT:case Pe.CHILD:return i(c.parent,d)+n(">")+i(c.child,d);case Pe.ANCESTOR:case Pe.DESCENDANT:return i(c.ancestor,d)+" "+i(c.descendant,d);case Pe.COMPOUND_SPLIT:{var k=i(c.left,d),M=i(c.subject,d),O=i(c.right,d);return k+(k.length>0?" ":"")+M+O}case Pe.TRUE:return""}},i=function(c,d){return c.checks.reduce(function(f,v,h){return f+(d===c&&h===0?"$":"")+a(v,d)},"")},o="",s=0;s<this.length;s++){var l=this[s];o+=i(l,l.subject),this.length>1&&s<this.length-1&&(o+=", ")}return this.toStringCache=o,o},$y={parse:jy,toString:Gy},Kd=function(e,t,n){var a,i=Be(e),o=Ce(e),s=Be(n),l,u,c=!1,d=!1,f=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(i||s||c)&&(l=!i&&!o?"":""+e,u=""+n),c&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),t){case"*=":a=l.indexOf(u)>=0;break;case"$=":a=l.indexOf(u,l.length-u.length)>=0;break;case"^=":a=l.indexOf(u)===0;break;case"=":a=e===n;break;case">":f=!0,a=e>n;break;case">=":f=!0,a=e>=n;break;case"<":f=!0,a=e<n;break;case"<=":f=!0,a=e<=n;break;default:a=!1;break}return d&&(e!=null||!f)&&(a=!a),a},qy=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},Hy=function(e){return e!==void 0},bl=function(e,t){return e.data(t)},Wy=function(e,t){return e[t]()},lt=[],nt=function(e,t){return e.checks.every(function(n){return lt[n.type](n,t)})};lt[Pe.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};lt[Pe.STATE]=function(r,e){var t=r.value;return Ly(t,e)};lt[Pe.ID]=function(r,e){var t=r.value;return e.id()===t};lt[Pe.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};lt[Pe.META_COMPARE]=function(r,e){var t=r.field,n=r.operator,a=r.value;return Kd(Wy(e,t),n,a)};lt[Pe.DATA_COMPARE]=function(r,e){var t=r.field,n=r.operator,a=r.value;return Kd(bl(e,t),n,a)};lt[Pe.DATA_BOOL]=function(r,e){var t=r.field,n=r.operator;return qy(bl(e,t),n)};lt[Pe.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,Hy(bl(e,t))};lt[Pe.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],n=r.nodes[1],a=e.source(),i=e.target();return nt(t,a)&&nt(n,i)||nt(n,a)&&nt(t,i)};lt[Pe.NODE_NEIGHBOR]=function(r,e){return nt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&nt(r.neighbor,t)})};lt[Pe.DIRECTED_EDGE]=function(r,e){return nt(r.source,e.source())&&nt(r.target,e.target())};lt[Pe.NODE_SOURCE]=function(r,e){return nt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&nt(r.target,t)})};lt[Pe.NODE_TARGET]=function(r,e){return nt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&nt(r.source,t)})};lt[Pe.CHILD]=function(r,e){return nt(r.child,e)&&nt(r.parent,e.parent())};lt[Pe.PARENT]=function(r,e){return nt(r.parent,e)&&e.children().some(function(t){return nt(r.child,t)})};lt[Pe.DESCENDANT]=function(r,e){return nt(r.descendant,e)&&e.ancestors().some(function(t){return nt(r.ancestor,t)})};lt[Pe.ANCESTOR]=function(r,e){return nt(r.ancestor,e)&&e.descendants().some(function(t){return nt(r.descendant,t)})};lt[Pe.COMPOUND_SPLIT]=function(r,e){return nt(r.subject,e)&&nt(r.left,e)&&nt(r.right,e)};lt[Pe.TRUE]=function(){return!0};lt[Pe.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};lt[Pe.FILTER]=function(r,e){var t=r.value;return t(e)};var Ky=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===Pe.ID)return e.getElementById(t[0].checks[0].value).collection();var n=function(i){for(var o=0;o<t.length;o++){var s=t[o];if(nt(s,i))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)},Uy=function(e){for(var t=this,n=0;n<t.length;n++){var a=t[n];if(nt(a,e))return!0}return!1},Xy={matches:Uy,filter:Ky},pn=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Be(e)&&e.match(/^\s*$/)||(sr(e)?this.addQuery({checks:[{type:Pe.COLLECTION,value:e.collection()}]}):st(e)?this.addQuery({checks:[{type:Pe.FILTER,value:e}]}):Be(e)?this.parse(e)||(this.invalid=!0):ot("A selector must be created from a string; found "))},gn=pn.prototype;[$y,Xy].forEach(function(r){return Fe(gn,r)});gn.text=function(){return this.inputText};gn.size=function(){return this.length};gn.eq=function(r){return this[r]};gn.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};gn.addQuery=function(r){this[this.length++]=r};gn.selector=gn.toString;var cn={allAre:function(e){var t=new pn(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new pn(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++){var a=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(a)return!0}return!1},every:function(e,t){for(var n=0;n<this.length;n++){var a=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(!a)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,n=e.length;return t!==n?!1:t===1?this[0]===e[0]:this.every(function(a){return e.hasElementWithId(a.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};cn.allAreNeighbours=cn.allAreNeighbors;cn.has=cn.contains;cn.equal=cn.equals=cn.same;var vr=function(e,t){return function(a,i,o,s){var l=a,u=this,c;if(l==null?c="":sr(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var d=u[0]._private,f=d.traversalCache=d.traversalCache||{},v=f[t]=f[t]||[],h=hn(c),m=v[h];return m||(v[h]=e.call(u,a,i,o,s))}else return e.call(u,a,i,o,s)}},fa={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var a=0;a<this.length;a++){var i=this[a],o=i._private.parent;o&&t.push(o)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var a=0;a<n.length;a++){var i=n[a];t.push(i)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var a=this[n],i=a.parents();t=t||i,t=t.intersect(i)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:vr(function(r){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],a=n._private.children,i=0;i<a.length;i++)e.push(a[i]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function n(a){for(var i=0;i<a.length;i++){var o=a[i];t.push(o),o.children().nonempty()&&n(o.children())}}return n(this.children()),this.spawn(t,!0).filter(e)}};function wl(r,e,t,n){for(var a=[],i=new ha,o=r.cy(),s=o.hasCompoundNodes(),l=0;l<r.length;l++){var u=r[l];t?a.push(u):s&&n(a,i,u)}for(;a.length>0;){var c=a.shift();e(c),i.add(c.id()),s&&n(a,i,c)}return r}function Ud(r,e,t){if(t.isParent())for(var n=t._private.children,a=0;a<n.length;a++){var i=n[a];e.has(i.id())||r.push(i)}}fa.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return wl(this,r,e,Ud)};function Xd(r,e,t){if(t.isChild()){var n=t._private.parent;e.has(n.id())||r.push(n)}}fa.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return wl(this,r,e,Xd)};function Yy(r,e,t){Xd(r,e,t),Ud(r,e,t)}fa.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return wl(this,r,e,Yy)};fa.ancestors=fa.parents;var Ya,Yd;Ya=Yd={data:Xe.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Xe.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Xe.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Xe.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Xe.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Xe.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Ya.attr=Ya.data;Ya.removeAttr=Ya.removeData;var Qy=Yd,Jo={};function Rs(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var n=0,a=t[0],i=a._private.edges,o=0;o<i.length;o++){var s=i[o];!e&&s.isLoop()||(n+=r(a,s))}return n}else return}}Fe(Jo,{degree:Rs(function(r,e){return e.source().same(e.target())?2:1}),indegree:Rs(function(r,e){return e.target().same(r)?1:0}),outdegree:Rs(function(r,e){return e.source().same(r)?1:0})});function Zn(r,e){return function(t){for(var n,a=this.nodes(),i=0;i<a.length;i++){var o=a[i],s=o[r](t);s!==void 0&&(n===void 0||e(s,n))&&(n=s)}return n}}Fe(Jo,{minDegree:Zn("degree",function(r,e){return r<e}),maxDegree:Zn("degree",function(r,e){return r>e}),minIndegree:Zn("indegree",function(r,e){return r<e}),maxIndegree:Zn("indegree",function(r,e){return r>e}),minOutdegree:Zn("outdegree",function(r,e){return r<e}),maxOutdegree:Zn("outdegree",function(r,e){return r>e})});Fe(Jo,{totalDegree:function(e){for(var t=0,n=this.nodes(),a=0;a<n.length;a++)t+=n[a].degree(e);return t}});var _r,Qd,Zd=function(e,t,n){for(var a=0;a<e.length;a++){var i=e[a];if(!i.locked()){var o=i._private.position,s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};i.isParent()&&!(s.x===0&&s.y===0)&&i.children().shift(s,n),i.dirtyBoundingBoxCache()}}},pc={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){Zd(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};_r=Qd={position:Xe.data(pc),silentPosition:Xe.data(Fe({},pc,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){Zd(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if(He(e))t?this.silentPosition(e):this.position(e);else if(st(e)){var n=e,a=this.cy();a.startBatch();for(var i=0;i<this.length;i++){var o=this[i],s=void 0;(s=n(o,i))&&(t?o.silentPosition(s):o.position(s))}a.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var a;if(He(e)?(a={x:Ce(e.x)?e.x:0,y:Ce(e.y)?e.y:0},n=t):Be(e)&&Ce(t)&&(a={x:0,y:0},a[e]=t),a!=null){var i=this.cy();i.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(i.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var l=s.position(),u={x:l.x+a.x,y:l.y+a.y};n?s.silentPosition(u):s.position(u)}}i.endBatch()}return this},silentShift:function(e,t){return He(e)?this.shift(e,!0):Be(e)&&Ce(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],a=this.cy(),i=a.zoom(),o=a.pan(),s=He(e)?e:void 0,l=s!==void 0||t!==void 0&&Be(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];t!==void 0?c.position(e,(t-o[e])/i):s!==void 0&&c.position(Sd(s,i,o))}else{var d=n.position();return s=Uo(d,i,o),e===void 0?s:s[e]}else if(!l)return;return this},relativePosition:function(e,t){var n=this[0],a=this.cy(),i=He(e)?e:void 0,o=i!==void 0||t!==void 0&&Be(e),s=a.hasCompoundNodes();if(n&&n.isNode())if(o)for(var l=0;l<this.length;l++){var u=this[l],c=s?u.parent():null,d=c&&c.length>0,f=d;d&&(c=c[0]);var v=f?c.position():{x:0,y:0};t!==void 0?u.position(e,t+v[e]):i!==void 0&&u.position({x:i.x+v.x,y:i.y+v.y})}else{var h=n.position(),m=s?n.parent():null,g=m&&m.length>0,p=g;g&&(m=m[0]);var y=p?m.position():{x:0,y:0};return i={x:h.x-y.x,y:h.y-y.y},e===void 0?i:i[e]}else if(!o)return;return this}};_r.modelPosition=_r.point=_r.position;_r.modelPositions=_r.points=_r.positions;_r.renderedPoint=_r.renderedPosition;_r.relativePoint=_r.relativePosition;var Zy=Qd,la,wn;la=wn={};wn.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),n=t.zoom(),a=t.pan(),i=e.x1*n+a.x,o=e.x2*n+a.x,s=e.y1*n+a.y,l=e.y2*n+a.y;return{x1:i,x2:o,y1:s,y2:l,w:o-i,h:l-s}};wn.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var n=t._private;n.compoundBoundsClean=!1,n.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};wn.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(o){if(!o.isParent())return;var s=o._private,l=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),f=s.position;(d.w===0||d.h===0)&&(d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},d.x1=f.x-d.w/2,d.x2=f.x+d.w/2,d.y1=f.y-d.h/2,d.y2=f.y+d.h/2);function v(P,L,F){var E=0,A=0,S=L+F;return P>0&&S>0&&(E=L/S*P,A=F/S*P),{biasDiff:E,biasComplementDiff:A}}function h(P,L,F,E){if(F.units==="%")switch(E){case"width":return P>0?F.pfValue*P:0;case"height":return L>0?F.pfValue*L:0;case"average":return P>0&&L>0?F.pfValue*(P+L)/2:0;case"min":return P>0&&L>0?P>L?F.pfValue*L:F.pfValue*P:0;case"max":return P>0&&L>0?P>L?F.pfValue*P:F.pfValue*L:0;default:return 0}else return F.units==="px"?F.pfValue:0}var m=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(m=m*100/c.width.val);var g=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(g=g*100/c.width.val);var p=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(p=p*100/c.height.val);var y=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(y=y*100/c.height.val);var b=v(c.width.val-d.w,m,g),_=b.biasDiff,B=b.biasComplementDiff,k=v(c.height.val-d.h,p,y),M=k.biasDiff,O=k.biasComplementDiff;s.autoPadding=h(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),s.autoWidth=Math.max(d.w,c.width.val),f.x=(-_+d.x1+d.x2+B)/2,s.autoHeight=Math.max(d.h,c.height.val),f.y=(-M+d.y1+d.y2+O)/2}for(var n=0;n<this.length;n++){var a=this[n],i=a._private;(!i.compoundBoundsClean||r)&&(t(a),e.batching()||(i.compoundBoundsClean=!0))}return this};var hr=function(e){return e===1/0||e===-1/0?0:e},wr=function(e,t,n,a,i){a-t===0||i-n===0||t==null||n==null||a==null||i==null||(e.x1=t<e.x1?t:e.x1,e.x2=a>e.x2?a:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=i>e.y2?i:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Dn=function(e,t){return t==null?e:wr(e,t.x1,t.y1,t.x2,t.y2)},ka=function(e,t,n){return xr(e,t,n)},go=function(e,t,n){if(!t.cy().headless()){var a=t._private,i=a.rstyle,o=i.arrowWidth/2,s=t.pstyle(n+"-arrow-shape").value,l,u;if(s!=="none"){n==="source"?(l=i.srcX,u=i.srcY):n==="target"?(l=i.tgtX,u=i.tgtY):(l=i.midX,u=i.midY);var c=a.arrowBounds=a.arrowBounds||{},d=c[n]=c[n]||{};d.x1=l-o,d.y1=u-o,d.x2=l+o,d.y2=u+o,d.w=d.x2-d.x1,d.h=d.y2-d.y1,So(d,1),wr(e,d.x1,d.y1,d.x2,d.y2)}}},Os=function(e,t,n){if(!t.cy().headless()){var a;n?a=n+"-":a="";var i=t._private,o=i.rstyle,s=t.pstyle(a+"label").strValue;if(s){var l=t.pstyle("text-halign"),u=t.pstyle("text-valign"),c=ka(o,"labelWidth",n),d=ka(o,"labelHeight",n),f=ka(o,"labelX",n),v=ka(o,"labelY",n),h=t.pstyle(a+"text-margin-x").pfValue,m=t.pstyle(a+"text-margin-y").pfValue,g=t.isEdge(),p=t.pstyle(a+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,b=t.pstyle("text-border-width").pfValue,_=b/2,B=t.pstyle("text-background-padding").pfValue,k=2,M=d,O=c,P=O/2,L=M/2,F,E,A,S;if(g)F=f-P,E=f+P,A=v-L,S=v+L;else{switch(l.value){case"left":F=f-O,E=f;break;case"center":F=f-P,E=f+P;break;case"right":F=f,E=f+O;break}switch(u.value){case"top":A=v-M,S=v;break;case"center":A=v-L,S=v+L;break;case"bottom":A=v,S=v+M;break}}var w=h-Math.max(y,_)-B-k,C=h+Math.max(y,_)+B+k,x=m-Math.max(y,_)-B-k,D=m+Math.max(y,_)+B+k;F+=w,E+=C,A+=x,S+=D;var T=n||"main",V=i.labelBounds,z=V[T]=V[T]||{};z.x1=F,z.y1=A,z.x2=E,z.y2=S,z.w=E-F,z.h=S-A,z.leftPad=w,z.rightPad=C,z.topPad=x,z.botPad=D;var j=g&&p.strValue==="autorotate",U=p.pfValue!=null&&p.pfValue!==0;if(j||U){var Y=j?ka(i.rstyle,"labelAngle",n):p.pfValue,te=Math.cos(Y),J=Math.sin(Y),ne=(F+E)/2,ae=(A+S)/2;if(!g){switch(l.value){case"left":ne=E;break;case"right":ne=F;break}switch(u.value){case"top":ae=S;break;case"bottom":ae=A;break}}var K=function(xe,fe){return xe=xe-ne,fe=fe-ae,{x:xe*te-fe*J+ne,y:xe*J+fe*te+ae}},R=K(F,A),N=K(F,S),G=K(E,A),W=K(E,S);F=Math.min(R.x,N.x,G.x,W.x),E=Math.max(R.x,N.x,G.x,W.x),A=Math.min(R.y,N.y,G.y,W.y),S=Math.max(R.y,N.y,G.y,W.y)}var X=T+"Rot",de=V[X]=V[X]||{};de.x1=F,de.y1=A,de.x2=E,de.y2=S,de.w=E-F,de.h=S-A,wr(e,F,A,E,S),wr(i.labelBounds.all,F,A,E,S)}return e}},Jy=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,a=t.pstyle("outline-width").value;if(n>0&&a>0){var i=t.pstyle("outline-offset").value,o=t.pstyle("shape").value,s=a+i,l=(e.w+s*2)/e.w,u=(e.h+s*2)/e.h,c=0,d=0;["diamond","pentagon","round-triangle"].includes(o)?(l=(e.w+s*2.4)/e.w,d=-s/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(o)?l=(e.w+s*2.4)/e.w:o==="star"?(l=(e.w+s*2.8)/e.w,u=(e.h+s*2.6)/e.h,d=-s/3.8):o==="triangle"?(l=(e.w+s*2.8)/e.w,u=(e.h+s*2.4)/e.h,d=-s/1.4):o==="vee"&&(l=(e.w+s*4.4)/e.w,u=(e.h+s*3.8)/e.h,d=-s*.5);var f=e.h*u-e.h,v=e.w*l-e.w;if(Eo(e,[Math.ceil(f/2),Math.ceil(v/2)]),c!=0||d!==0){var h=bg(e,c,d);Td(e,h)}}}},e1=function(e,t){var n=e._private.cy,a=n.styleEnabled(),i=n.headless(),o=tr(),s=e._private,l=e.isNode(),u=e.isEdge(),c,d,f,v,h,m,g=s.rstyle,p=l&&a?e.pstyle("bounds-expansion").pfValue:[0],y=function(Te){return Te.pstyle("display").value!=="none"},b=!a||y(e)&&(!u||y(e.source())&&y(e.target()));if(b){var _=0,B=0;a&&t.includeOverlays&&(_=e.pstyle("overlay-opacity").value,_!==0&&(B=e.pstyle("overlay-padding").value));var k=0,M=0;a&&t.includeUnderlays&&(k=e.pstyle("underlay-opacity").value,k!==0&&(M=e.pstyle("underlay-padding").value));var O=Math.max(B,M),P=0,L=0;if(a&&(P=e.pstyle("width").pfValue,L=P/2),l&&t.includeNodes){var F=e.position();h=F.x,m=F.y;var E=e.outerWidth(),A=E/2,S=e.outerHeight(),w=S/2;c=h-A,d=h+A,f=m-w,v=m+w,wr(o,c,f,d,v),a&&t.includeOutlines&&Jy(o,e)}else if(u&&t.includeEdges)if(a&&!i){var C=e.pstyle("curve-style").strValue;if(c=Math.min(g.srcX,g.midX,g.tgtX),d=Math.max(g.srcX,g.midX,g.tgtX),f=Math.min(g.srcY,g.midY,g.tgtY),v=Math.max(g.srcY,g.midY,g.tgtY),c-=L,d+=L,f-=L,v+=L,wr(o,c,f,d,v),C==="haystack"){var x=g.haystackPts;if(x&&x.length===2){if(c=x[0].x,f=x[0].y,d=x[1].x,v=x[1].y,c>d){var D=c;c=d,d=D}if(f>v){var T=f;f=v,v=T}wr(o,c-L,f-L,d+L,v+L)}}else if(C==="bezier"||C==="unbundled-bezier"||C.endsWith("segments")||C.endsWith("taxi")){var V;switch(C){case"bezier":case"unbundled-bezier":V=g.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":V=g.linePts;break}if(V!=null)for(var z=0;z<V.length;z++){var j=V[z];c=j.x-L,d=j.x+L,f=j.y-L,v=j.y+L,wr(o,c,f,d,v)}}}else{var U=e.source(),Y=U.position(),te=e.target(),J=te.position();if(c=Y.x,d=J.x,f=Y.y,v=J.y,c>d){var ne=c;c=d,d=ne}if(f>v){var ae=f;f=v,v=ae}c-=L,d+=L,f-=L,v+=L,wr(o,c,f,d,v)}if(a&&t.includeEdges&&u&&(go(o,e,"mid-source"),go(o,e,"mid-target"),go(o,e,"source"),go(o,e,"target")),a){var K=e.pstyle("ghost").value==="yes";if(K){var R=e.pstyle("ghost-offset-x").pfValue,N=e.pstyle("ghost-offset-y").pfValue;wr(o,o.x1+R,o.y1+N,o.x2+R,o.y2+N)}}var G=s.bodyBounds=s.bodyBounds||{};Uu(G,o),Eo(G,p),So(G,1),a&&(c=o.x1,d=o.x2,f=o.y1,v=o.y2,wr(o,c-O,f-O,d+O,v+O));var W=s.overlayBounds=s.overlayBounds||{};Uu(W,o),Eo(W,p),So(W,1);var X=s.labelBounds=s.labelBounds||{};X.all!=null?Cg(X.all):X.all=tr(),a&&t.includeLabels&&(t.includeMainLabels&&Os(o,e,null),u&&(t.includeSourceLabels&&Os(o,e,"source"),t.includeTargetLabels&&Os(o,e,"target")))}return o.x1=hr(o.x1),o.y1=hr(o.y1),o.x2=hr(o.x2),o.y2=hr(o.y2),o.w=hr(o.x2-o.x1),o.h=hr(o.y2-o.y1),o.w>0&&o.h>0&&b&&(Eo(o,p),So(o,1)),o},Jd=function(e){var t=0,n=function(o){return(o?1:0)<<t++},a=0;return a+=n(e.incudeNodes),a+=n(e.includeEdges),a+=n(e.includeLabels),a+=n(e.includeMainLabels),a+=n(e.includeSourceLabels),a+=n(e.includeTargetLabels),a+=n(e.includeOverlays),a+=n(e.includeOutlines),a},ef=function(e){if(e.isEdge()){var t=e.source().position(),n=e.target().position(),a=function(o){return Math.round(o)};return zp([a(t.x),a(t.y),a(n.x),a(n.y)])}else return 0},gc=function(e,t){var n=e._private,a,i=e.isEdge(),o=t==null?mc:Jd(t),s=o===mc,l=ef(e),u=n.bbCachePosKey===l,c=t.useCache&&u,d=function(m){return m._private.bbCache==null||m._private.styleDirty},f=!c||d(e)||i&&(d(e.source())||d(e.target()));if(f?(u||e.recalculateRenderedStyle(c),a=e1(e,Qa),n.bbCache=a,n.bbCachePosKey=l):a=n.bbCache,!s){var v=e.isNode();a=tr(),(t.includeNodes&&v||t.includeEdges&&!v)&&(t.includeOverlays?Dn(a,n.overlayBounds):Dn(a,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!i||t.includeSourceLabels&&t.includeTargetLabels)?Dn(a,n.labelBounds.all):(t.includeMainLabels&&Dn(a,n.labelBounds.mainRot),t.includeSourceLabels&&Dn(a,n.labelBounds.sourceRot),t.includeTargetLabels&&Dn(a,n.labelBounds.targetRot))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},Qa={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},mc=Jd(Qa),yc=St(Qa);wn.boundingBox=function(r){var e;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(r===void 0||r.useCache===void 0||r.useCache===!0))r===void 0?r=Qa:r=yc(r),e=gc(this[0],r);else{e=tr(),r=r||Qa;var t=yc(r),n=this,a=n.cy(),i=a.styleEnabled();if(i)for(var o=0;o<n.length;o++){var s=n[o],l=s._private,u=ef(s),c=l.bbCachePosKey===u,d=t.useCache&&c&&!l.styleDirty;s.recalculateRenderedStyle(d)}this.updateCompoundBounds(!r.useCache);for(var f=0;f<n.length;f++){var v=n[f];Dn(e,gc(v,t))}}return e.x1=hr(e.x1),e.y1=hr(e.y1),e.x2=hr(e.x2),e.y2=hr(e.y2),e.w=hr(e.x2-e.x1),e.h=hr(e.y2-e.y1),e};wn.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};wn.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),n=t.hasCompoundNodes(),a=t.collection();if(n&&(a=e.filter(function(u){return u.isParent()}),e=e.not(a)),He(r)){var i=r;r=function(){return i}}var o=function(c,d){return c._private.bbAtOldPos=r(c,d)},s=function(c){return c._private.bbAtOldPos};t.startBatch(),e.forEach(o).silentPositions(r),n&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var l=yg(this.boundingBox({useCache:!1}));return e.silentPositions(s),n&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),t.endBatch(),l};la.boundingbox=la.bb=la.boundingBox;la.renderedBoundingbox=la.renderedBoundingBox;var t1=wn,La,ii;La=ii={};var tf=function(e){e.uppercaseName=ju(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=ju(e.outerName),La[e.name]=function(){var n=this[0],a=n._private,i=a.cy,o=i._private.styleEnabled;if(n)if(o){if(n.isParent())return n.updateCompoundBounds(),a[e.autoName]||0;var s=n.pstyle(e.name);switch(s.strValue){case"label":return n.recalculateRenderedStyle(),a.rstyle[e.labelName]||0;default:return s.pfValue}}else return 1},La["outer"+e.uppercaseName]=function(){var n=this[0],a=n._private,i=a.cy,o=i._private.styleEnabled;if(n)if(o){var s=n[e.name](),l=n.pstyle("border-width").pfValue,u=2*n.padding();return s+l+u}else return 1},La["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var a=n[e.name]();return a*this.cy().zoom()}},La["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var a=n[e.outerName]();return a*this.cy().zoom()}}};tf({name:"width"});tf({name:"height"});ii.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};ii.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};ii.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var r1=ii,n1=function(e,t){if(e.isEdge())return t(e)},a1=function(e,t){if(e.isEdge()){var n=e.cy();return Uo(t(e),n.zoom(),n.pan())}},i1=function(e,t){if(e.isEdge()){var n=e.cy(),a=n.pan(),i=n.zoom();return t(e).map(function(o){return Uo(o,i,a)})}},o1=function(e){return e.renderer().getControlPoints(e)},s1=function(e){return e.renderer().getSegmentPoints(e)},l1=function(e){return e.renderer().getSourceEndpoint(e)},u1=function(e){return e.renderer().getTargetEndpoint(e)},c1=function(e){return e.renderer().getEdgeMidpoint(e)},Cc={controlPoints:{get:o1,mult:!0},segmentPoints:{get:s1,mult:!0},sourceEndpoint:{get:l1},targetEndpoint:{get:u1},midpoint:{get:c1}},d1=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},f1=Object.keys(Cc).reduce(function(r,e){var t=Cc[e],n=d1(e);return r[e]=function(){return n1(this,t.get)},t.mult?r[n]=function(){return i1(this,t.get)}:r[n]=function(){return a1(this,t.get)},r},{}),h1=Fe({},Zy,t1,r1,f1);var rf=function(e,t){this.recycle(e,t)};function Pa(){return!1}function mo(){return!0}rf.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Pa,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?mo:Pa):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,a=this.cy.zoom(),i=this.cy.pan();this.renderedPosition={x:n.x*a+i.x,y:n.y*a+i.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=mo;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=mo;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=mo,this.stopPropagation()},isDefaultPrevented:Pa,isPropagationStopped:Pa,isImmediatePropagationStopped:Pa};var nf=/^([^.]+)(\.(?:[^.]+))?$/,v1=".*",af={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},bc=Object.keys(af),p1={};function es(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p1,e=arguments.length>1?arguments[1]:void 0,t=0;t<bc.length;t++){var n=bc[t];this[n]=r[n]||af[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var mn=es.prototype,of=function(e,t,n,a,i,o,s){st(a)&&(i=a,a=null),s&&(o==null?o=s:o=Fe({},o,s));for(var l=Je(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!fn(c)){var d=c.match(nf);if(d){var f=d[1],v=d[2]?d[2]:null,h=t(e,c,f,v,a,i,o);if(h===!1)break}}}},wc=function(e,t){return e.addEventFields(e.context,t),new rf(t.type,t)},g1=function(e,t,n){if(Lv(n)){t(e,n);return}else if(He(n)){t(e,wc(e,n));return}for(var a=Je(n)?n:n.split(/\s+/),i=0;i<a.length;i++){var o=a[i];if(!fn(o)){var s=o.match(nf);if(s){var l=s[1],u=s[2]?s[2]:null,c=wc(e,{type:l,namespace:u,target:e.context});t(e,c)}}}};mn.on=mn.addListener=function(r,e,t,n,a){return of(this,function(i,o,s,l,u,c,d){st(c)&&i.listeners.push({event:o,callback:c,type:s,namespace:l,qualifier:u,conf:d})},r,e,t,n,a),this};mn.one=function(r,e,t,n){return this.on(r,e,t,n,{one:!0})};mn.removeListener=mn.off=function(r,e,t,n){var a=this;this.emitting!==0&&(this.listeners=Hp(this.listeners));for(var i=this.listeners,o=function(u){var c=i[u];of(a,function(d,f,v,h,m,g){if((c.type===v||r==="*")&&(!h&&c.namespace!==".*"||c.namespace===h)&&(!m||d.qualifierCompare(c.qualifier,m))&&(!g||c.callback===g))return i.splice(u,1),!1},r,e,t,n)},s=i.length-1;s>=0;s--)o(s);return this};mn.removeAllListeners=function(){return this.removeListener("*")};mn.emit=mn.trigger=function(r,e,t){var n=this.listeners,a=n.length;return this.emitting++,Je(e)||(e=[e]),g1(this,function(i,o){t!=null&&(n=[{event:o.event,type:o.type,namespace:o.namespace,callback:t}],a=n.length);for(var s=function(c){var d=n[c];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===v1)&&i.eventMatches(i.context,d,o)){var f=[o];e!=null&&Kp(f,e),i.beforeEmit(i.context,d,o),d.conf&&d.conf.one&&(i.listeners=i.listeners.filter(function(m){return m!==d}));var v=i.callbackContext(i.context,d,o),h=d.callback.apply(v,f);i.afterEmit(i.context,d,o),h===!1&&(o.stopPropagation(),o.preventDefault())}},l=0;l<a;l++)s(l);i.bubble(i.context)&&!o.isPropagationStopped()&&i.parent(i.context).emit(o,e)},r),this.emitting--,this};var m1={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var a=t.qualifier;return a!=null?e!==n.target&&ti(n.target)&&a.matches(n.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},yo=function(e){return Be(e)?new pn(e):e},sf={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new es(m1,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var a=yo(t),i=0;i<this.length;i++){var o=this[i];o.emitter().on(e,a,n)}return this},removeListener:function(e,t,n){for(var a=yo(t),i=0;i<this.length;i++){var o=this[i];o.emitter().removeListener(e,a,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,n){for(var a=yo(t),i=0;i<this.length;i++){var o=this[i];o.emitter().one(e,a,n)}return this},once:function(e,t,n){for(var a=yo(t),i=0;i<this.length;i++){var o=this[i];o.emitter().on(e,a,n,{once:!0,onceCollection:this})}},emit:function(e,t){for(var n=0;n<this.length;n++){var a=this[n];a.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};Xe.eventAliasesOn(sf);var lf={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var a=this[n];a.isNode()?e.push(a):t.push(a)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(Be(e)||sr(e))return new pn(e).filter(this);if(st(e)){for(var n=this.spawn(),a=this,i=0;i<a.length;i++){var o=a[i],s=t?e.apply(t,[o,i,a]):e(o,i,a);s&&n.push(o)}return n}return this.spawn()},not:function(e){if(e){Be(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var a=this[n],i=e.has(a);i||t.push(a)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Be(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),a=this,i=e,o=this.length<e.length,s=o?a:i,l=o?i:a,u=0;u<s.length;u++){var c=s[u];l.has(c)&&n.push(c)}return n},xor:function(e){var t=this._private.cy;Be(e)&&(e=t.$(e));var n=this.spawn(),a=this,i=e,o=function(l,u){for(var c=0;c<l.length;c++){var d=l[c],f=d._private.data.id,v=u.hasElementWithId(f);v||n.push(d)}};return o(a,i),o(i,a),n},diff:function(e){var t=this._private.cy;Be(e)&&(e=t.$(e));var n=this.spawn(),a=this.spawn(),i=this.spawn(),o=this,s=e,l=function(c,d,f){for(var v=0;v<c.length;v++){var h=c[v],m=h._private.data.id,g=d.hasElementWithId(m);g?i.merge(h):f.push(h)}};return l(o,s,n),l(s,o,a),{left:n,right:a,both:i}},add:function(e){var t=this._private.cy;if(!e)return this;if(Be(e)){var n=e;e=t.mutableElements().filter(n)}for(var a=this.spawnSelf(),i=0;i<e.length;i++){var o=e[i],s=!this.has(o);s&&a.push(o)}return a},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&Be(e)){var a=e;e=n.mutableElements().filter(a)}for(var i=t.map,o=0;o<e.length;o++){var s=e[o],l=s._private.data.id,u=!i.has(l);if(u){var c=this.length++;this[c]=s,i.set(l,{ele:s,index:c})}}return this},unmergeAt:function(e){var t=this[e],n=t.id(),a=this._private,i=a.map;this[e]=void 0,i.delete(n);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1,l=this[s],u=l._private.data.id;this[s]=void 0,this[e]=l,i.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,a=t.map,i=a.get(n);if(!i)return this;var o=i.index;return this.unmergeAt(o),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&Be(e)){var n=e;e=t.mutableElements().filter(n)}for(var a=0;a<e.length;a++)this.unmergeOne(e[a]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var n=this[t];e(n)&&this.unmergeAt(t)}return this},map:function(e,t){for(var n=[],a=this,i=0;i<a.length;i++){var o=a[i],s=t?e.apply(t,[o,i,a]):e(o,i,a);n.push(s)}return n},reduce:function(e,t){for(var n=t,a=this,i=0;i<a.length;i++)n=e(n,a[i],i,a);return n},max:function(e,t){for(var n=-1/0,a,i=this,o=0;o<i.length;o++){var s=i[o],l=t?e.apply(t,[s,o,i]):e(s,o,i);l>n&&(n=l,a=s)}return{value:n,ele:a}},min:function(e,t){for(var n=1/0,a,i=this,o=0;o<i.length;o++){var s=i[o],l=t?e.apply(t,[s,o,i]):e(s,o,i);l<n&&(n=l,a=s)}return{value:n,ele:a}}},Ue=lf;Ue.u=Ue["|"]=Ue["+"]=Ue.union=Ue.or=Ue.add;Ue["\\"]=Ue["!"]=Ue["-"]=Ue.difference=Ue.relativeComplement=Ue.subtract=Ue.not;Ue.n=Ue["&"]=Ue["."]=Ue.and=Ue.intersection=Ue.intersect;Ue["^"]=Ue["(+)"]=Ue["(-)"]=Ue.symmetricDifference=Ue.symdiff=Ue.xor;Ue.fnFilter=Ue.filterFn=Ue.stdFilter=Ue.filter;Ue.complement=Ue.abscomp=Ue.absoluteComplement;var y1={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},uf=function(e,t){var n=e.cy(),a=n.hasCompoundNodes();function i(c){var d=c.pstyle("z-compound-depth");return d.value==="auto"?a?c.zDepth():0:d.value==="bottom"?-1:d.value==="top"?cl:0}var o=i(e)-i(t);if(o!==0)return o;function s(c){var d=c.pstyle("z-index-compare");return d.value==="auto"&&c.isNode()?1:0}var l=s(e)-s(t);if(l!==0)return l;var u=e.pstyle("z-index").value-t.pstyle("z-index").value;return u!==0?u:e.poolIndex()-t.poolIndex()},No={forEach:function(e,t){if(st(e))for(var n=this.length,a=0;a<n;a++){var i=this[a],o=t?e.apply(t,[i,a,this]):e(i,a,this);if(o===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],a=this.length;t==null&&(t=a),e==null&&(e=0),e<0&&(e=a+e),t<0&&(t=a+t);for(var i=e;i>=0&&i<t&&i<a;i++)n.push(this[i]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!st(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(uf)},zDepth:function(){var e=this[0];if(e){var t=e._private,n=t.group;if(n==="nodes"){var a=t.data.parent?e.parents().size():0;return e.isParent()?a:cl-1}else{var i=t.source,o=t.target,s=i.zDepth(),l=o.zDepth();return Math.max(s,l,0)}}}};No.each=No.forEach;var C1=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":pt(Symbol))!=e&&pt(Symbol.iterator)!=e;t&&(No[Symbol.iterator]=function(){var n=this,a={value:void 0,done:!1},i=0,o=this.length;return ad({next:function(){return i<o?a.value=n[i++]:(a.value=void 0,a.done=!0),a}},Symbol.iterator,function(){return this})})};C1();var b1=St({nodeDimensionsIncludeLabels:!1}),Mo={layoutDimensions:function(e){e=b1(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,n){var a=this.nodes().filter(function(B){return!B.isParent()}),i=this.cy(),o=t.eles,s=function(k){return k.id()},l=$a(n,s);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(k,M,O){var P={x:M.x1+M.w/2,y:M.y1+M.h/2},L={x:(O.x-P.x)*k,y:(O.y-P.y)*k};return{x:P.x+L.x,y:P.y+L.y}},c=t.spacingFactor&&t.spacingFactor!==1,d=function(){if(!c)return null;for(var k=tr(),M=0;M<a.length;M++){var O=a[M],P=l(O,M);wg(k,P.x,P.y)}return k},f=d(),v=$a(function(B,k){var M=l(B,k);if(c){var O=Math.abs(t.spacingFactor);M=u(O,f,M)}return t.transform!=null&&(M=t.transform(B,M)),M},s);if(t.animate){for(var h=0;h<a.length;h++){var m=a[h],g=v(m,h),p=t.animateFilter==null||t.animateFilter(m,h);if(p){var y=m.animation({position:g,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else m.position(g)}if(t.fit){var b=i.animation({fit:{boundingBox:o.boundingBoxAt(v),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else if(t.zoom!==void 0&&t.pan!==void 0){var _=i.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(_)}e.animations.forEach(function(B){return B.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),va.all(e.animations.map(function(B){return B.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else a.positions(v),t.fit&&i.fit(t.eles,t.padding),t.zoom!=null&&i.zoom(t.zoom),t.pan&&i.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(Fe({},e,{eles:this}))}};Mo.createLayout=Mo.makeLayout=Mo.layout;function cf(r,e,t){var n=t._private,a=n.styleCache=n.styleCache||[],i;return(i=a[r])!=null||(i=a[r]=e(t)),i}function ts(r,e){return r=hn(r),function(n){return cf(r,e,n)}}function rs(r,e){r=hn(r);var t=function(a){return e.call(a)};return function(){var a=this[0];if(a)return cf(r,t,a)}}var Tt={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),a=t.styleEnabled();return n&&a&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(i){return i._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(t)}else this.forEach(function(a){t(a),a.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var n=t._private.batchStyleEles;return n.merge(this),this}var a=t.hasCompoundNodes(),i=this;e=!!(e||e===void 0),a&&(i=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=i;return e?o.emitAndNotify("style"):o.emit("style"),i.forEach(function(s){return s._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],a=n.cy();if(a.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,a.style().apply(n));var i=n._private.style[e];return i??(t?a.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];if(n)return t.style().getRenderedStyle(n,e)},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var a=!1,i=n.style();if(He(e)){var o=e;i.applyBypass(this,o,a),this.emitAndNotify("style")}else if(Be(e))if(t===void 0){var s=this[0];return s?i.getStylePropertyValue(s,e):void 0}else i.applyBypass(this,e,t,a),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?i.getRawStyle(l):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,a=t.style(),i=this;if(e===void 0)for(var o=0;o<i.length;o++){var s=i[o];a.removeAllBypasses(s,n)}else{e=e.split(/\s+/);for(var l=0;l<i.length;l++){var u=i[l];a.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var a=n._private,i=n.pstyle("opacity").value;if(!t)return i;var o=a.data.parent?n.parents():null;if(o)for(var s=0;s<o.length;s++){var l=o[s],u=l.pstyle("opacity").value;i=u*i}return i}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],n=t.cy().hasCompoundNodes();if(t)return n?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function Fs(r,e){var t=r._private,n=t.data.parent?r.parents():null;if(n)for(var a=0;a<n.length;a++){var i=n[a];if(!e(i))return!1}return!0}function xl(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,n=r.parentOk||r.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var i=this[0],o=a.hasCompoundNodes();if(i){var s=i._private;if(!e(i))return!1;if(i.isNode())return!o||Fs(i,n);var l=s.source,u=s.target;return t(l)&&(!o||Fs(l,t))&&(l===u||t(u)&&(!o||Fs(u,t)))}}}var ya=ts("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});Tt.takesUpSpace=rs("takesUpSpace",xl({ok:ya}));var w1=ts("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&ya(r)}),x1=ts("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&ya(r)});Tt.interactive=rs("interactive",xl({ok:w1,parentOk:x1,edgeOkViaNode:ya}));Tt.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var _1=ts("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&ya(r)}),S1=ya;Tt.visible=rs("visible",xl({ok:_1,edgeOkViaNode:S1}));Tt.hidden=function(){var r=this[0];if(r)return!r.visible()};Tt.isBundledBezier=rs("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});Tt.bypass=Tt.css=Tt.style;Tt.renderedCss=Tt.renderedStyle;Tt.removeBypass=Tt.removeCss=Tt.removeStyle;Tt.pstyle=Tt.parsedStyle;var dn={};function xc(r){return function(){var e=arguments,t=[];if(e.length===2){var n=e[0],a=e[1];this.on(r.event,n,a)}else if(e.length===1&&st(e[0])){var i=e[0];this.on(r.event,i)}else if(e.length===0||e.length===1&&Je(e[0])){for(var o=e.length===1?e[0]:null,s=0;s<this.length;s++){var l=this[s],u=!r.ableField||l._private[r.ableField],c=l._private[r.field]!=r.value;if(r.overrideAble){var d=r.overrideAble(l);if(d!==void 0&&(u=d,!d))return this}u&&(l._private[r.field]=r.value,c&&t.push(l))}var f=this.spawn(t);f.updateStyle(),f.emit(r.event),o&&f.emit(o)}return this}}function Ca(r){dn[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},dn[r.on]=xc({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),dn[r.off]=xc({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Ca({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Ca({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Ca({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Ca({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});dn.deselect=dn.unselect;dn.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Ca({field:"active",on:"activate",off:"unactivate"});Ca({field:"pannable",on:"panify",off:"unpanify"});dn.inactive=function(){var r=this[0];if(r)return!r._private.active};var Ft={},_c=function(e){return function(n){for(var a=this,i=[],o=0;o<a.length;o++){var s=a[o];if(s.isNode()){for(var l=!1,u=s.connectedEdges(),c=0;c<u.length;c++){var d=u[c],f=d.source(),v=d.target();if(e.noIncomingEdges&&v===s&&f!==s||e.noOutgoingEdges&&f===s&&v!==s){l=!0;break}}l||i.push(s)}}return this.spawn(i,!0).filter(n)}},Sc=function(e){return function(t){for(var n=this,a=[],i=0;i<n.length;i++){var o=n[i];if(o.isNode())for(var s=o.connectedEdges(),l=0;l<s.length;l++){var u=s[l],c=u.source(),d=u.target();e.outgoing&&c===o?(a.push(u),a.push(d)):e.incoming&&d===o&&(a.push(u),a.push(c))}}return this.spawn(a,!0).filter(t)}},Ec=function(e){return function(t){for(var n=this,a=[],i={};;){var o=e.outgoing?n.outgoers():n.incomers();if(o.length===0)break;for(var s=!1,l=0;l<o.length;l++){var u=o[l],c=u.id();i[c]||(i[c]=!0,a.push(u),s=!0)}if(!s)break;n=o}return this.spawn(a,!0).filter(t)}};Ft.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Fe(Ft,{roots:_c({noIncomingEdges:!0}),leaves:_c({noOutgoingEdges:!0}),outgoers:vr(Sc({outgoing:!0}),"outgoers"),successors:Ec({outgoing:!0}),incomers:vr(Sc({incoming:!0}),"incomers"),predecessors:Ec({incoming:!0})});Fe(Ft,{neighborhood:vr(function(r){for(var e=[],t=this.nodes(),n=0;n<t.length;n++)for(var a=t[n],i=a.connectedEdges(),o=0;o<i.length;o++){var s=i[o],l=s.source(),u=s.target(),c=a===l?u:l;c.length>0&&e.push(c[0]),e.push(s[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Ft.neighbourhood=Ft.neighborhood;Ft.closedNeighbourhood=Ft.closedNeighborhood;Ft.openNeighbourhood=Ft.openNeighborhood;Fe(Ft,{source:vr(function(e){var t=this[0],n;return t&&(n=t._private.source||t.cy().collection()),n&&e?n.filter(e):n},"source"),target:vr(function(e){var t=this[0],n;return t&&(n=t._private.target||t.cy().collection()),n&&e?n.filter(e):n},"target"),sources:Tc({attr:"source"}),targets:Tc({attr:"target"})});function Tc(r){return function(t){for(var n=[],a=0;a<this.length;a++){var i=this[a],o=i._private[r.attr];o&&n.push(o)}return this.spawn(n,!0).filter(t)}}Fe(Ft,{edgesWith:vr(Mc(),"edgesWith"),edgesTo:vr(Mc({thisIsSrc:!0}),"edgesTo")});function Mc(r){return function(t){var n=[],a=this._private.cy,i=r||{};Be(t)&&(t=a.$(t));for(var o=0;o<t.length;o++)for(var s=t[o]._private.edges,l=0;l<s.length;l++){var u=s[l],c=u._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),f=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target),v=d||f;v&&((i.thisIsSrc||i.thisIsTgt)&&(i.thisIsSrc&&!d||i.thisIsTgt&&!f)||n.push(u))}return this.spawn(n,!0)}}Fe(Ft,{connectedEdges:vr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var a=t[n];if(a.isNode())for(var i=a._private.edges,o=0;o<i.length;o++){var s=i[o];e.push(s)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:vr(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var a=t[n];a.isEdge()&&(e.push(a.source()[0]),e.push(a.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:vr(Dc(),"parallelEdges"),codirectedEdges:vr(Dc({codirected:!0}),"codirectedEdges")});function Dc(r){var e={codirected:!1};return r=Fe({},e,r),function(n){for(var a=[],i=this.edges(),o=r,s=0;s<i.length;s++)for(var l=i[s],u=l._private,c=u.source,d=c._private.data.id,f=u.data.target,v=c._private.edges,h=0;h<v.length;h++){var m=v[h],g=m._private.data,p=g.target,y=g.source,b=p===f&&y===d,_=d===p&&f===y;(o.codirected&&b||!o.codirected&&(b||_))&&a.push(m)}return this.spawn(a,!0).filter(n)}}Fe(Ft,{components:function(e){var t=this,n=t.cy(),a=n.collection(),i=e==null?t.nodes():e.nodes(),o=[];e!=null&&i.empty()&&(i=e.sources());var s=function(c,d){a.merge(c),i.unmerge(c),d.merge(c)};if(i.empty())return t.spawn();var l=function(){var c=n.collection();o.push(c);var d=i[0];s(d,c),t.bfs({directed:!1,roots:d,visit:function(v){return s(v,c)}}),c.forEach(function(f){f.connectedEdges().forEach(function(v){t.has(v)&&c.has(v.source())&&c.has(v.target())&&c.merge(v)})})};do l();while(i.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Ft.componentsOf=Ft.components;var Mt=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){ot("A collection must have a reference to the core");return}var i=new Fr,o=!1;if(!t)t=[];else if(t.length>0&&He(t[0])&&!ti(t[0])){o=!0;for(var s=[],l=new ha,u=0,c=t.length;u<c;u++){var d=t[u];d.data==null&&(d.data={});var f=d.data;if(f.id==null)f.id=xd();else if(e.hasElementWithId(f.id)||l.has(f.id))continue;var v=new Ko(e,d,!1);s.push(v),l.add(f.id)}t=s}this.length=0;for(var h=0,m=t.length;h<m;h++){var g=t[h][0];if(g!=null){var p=g._private.data.id;(!n||!i.has(p))&&(n&&i.set(p,{index:this.length,ele:g}),this[this.length]=g,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var b=this.lazyMap=new Fr,_=this.eles,B=0;B<_.length;B++){var k=_[B];b.set(k.id(),{index:B,ele:k})}}},n&&(this._private.map=i),o&&!a&&this.restore()},rt=Ko.prototype=Mt.prototype=Object.create(Array.prototype);rt.instanceString=function(){return"collection"};rt.spawn=function(r,e){return new Mt(this.cy(),r,e)};rt.spawnSelf=function(){return this.spawn(this)};rt.cy=function(){return this._private.cy};rt.renderer=function(){return this._private.cy.renderer()};rt.element=function(){return this[0]};rt.collection=function(){return sd(this)?this:new Mt(this._private.cy,[this])};rt.unique=function(){return new Mt(this._private.cy,this,!0)};rt.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};rt.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new Mt(e)};rt.$id=rt.getElementById;rt.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};rt.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};rt.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};rt.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var n=e._private;if(He(r)){if(t.startBatch(),r.data){e.data(r.data);var a=n.data;if(e.isEdge()){var i=!1,o={},s=r.data.source,l=r.data.target;s!=null&&s!=a.source&&(o.source=""+s,i=!0),l!=null&&l!=a.target&&(o.target=""+l,i=!0),i&&(e=e.move(o))}else{var u="parent"in r.data,c=r.data.parent;u&&(c!=null||a.parent!=null)&&c!=a.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}r.position&&e.position(r.position);var d=function(m,g,p){var y=r[m];y!=null&&y!==n[m]&&(y?e[g]():e[p]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var f={data:Or(n.data),position:Or(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};f.classes="";var v=0;return n.classes.forEach(function(h){return f.classes+=v++===0?h:" "+h}),f}}};rt.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],n=t.json();r.push(n)}return r};rt.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var n=this[t],a=n.json(),i=new Ko(r,a,!1);e.push(i)}return new Mt(r,e)};rt.copy=rt.clone;rt.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=t.cy(),a=n._private,i=[],o=[],s,l=0,u=t.length;l<u;l++){var c=t[l];e&&!c.removed()||(c.isNode()?i.push(c):o.push(c))}s=i.concat(o);var d,f=function(){s.splice(d,1),d--};for(d=0;d<s.length;d++){var v=s[d],h=v._private,m=h.data;if(v.clearTraversalCache(),!(!e&&!h.removed)){if(m.id===void 0)m.id=xd();else if(Ce(m.id))m.id=""+m.id;else if(fn(m.id)||!Be(m.id)){ot("Can not create element with invalid string ID `"+m.id+"`"),f();continue}else if(n.hasElementWithId(m.id)){ot("Can not create second element with ID `"+m.id+"`"),f();continue}}var g=m.id;if(v.isNode()){var p=h.position;p.x==null&&(p.x=0),p.y==null&&(p.y=0)}if(v.isEdge()){for(var y=v,b=["source","target"],_=b.length,B=!1,k=0;k<_;k++){var M=b[k],O=m[M];Ce(O)&&(O=m[M]=""+m[M]),O==null||O===""?(ot("Can not create edge `"+g+"` with unspecified "+M),B=!0):n.hasElementWithId(O)||(ot("Can not create edge `"+g+"` with nonexistant "+M+" `"+O+"`"),B=!0)}if(B){f();continue}var P=n.getElementById(m.source),L=n.getElementById(m.target);P.same(L)?P._private.edges.push(y):(P._private.edges.push(y),L._private.edges.push(y)),y._private.source=P,y._private.target=L}h.map=new Fr,h.map.set(g,{ele:v,index:0}),h.removed=!1,e&&n.addToPool(v)}for(var F=0;F<i.length;F++){var E=i[F],A=E._private.data;Ce(A.parent)&&(A.parent=""+A.parent);var S=A.parent,w=S!=null;if(w||E._private.parent){var C=E._private.parent?n.collection().merge(E._private.parent):n.getElementById(S);if(C.empty())A.parent=void 0;else if(C[0].removed())Ye("Node added with missing parent, reference to parent removed"),A.parent=void 0,E._private.parent=null;else{for(var x=!1,D=C;!D.empty();){if(E.same(D)){x=!0,A.parent=void 0;break}D=D.parent()}x||(C[0]._private.children.push(E),E._private.parent=C[0],a.hasCompoundNodes=!0)}}}if(s.length>0){for(var T=s.length===t.length?t:new Mt(n,s),V=0;V<T.length;V++){var z=T[V];z.isNode()||(z.parallelEdges().clearTraversalCache(),z.source().clearTraversalCache(),z.target().clearTraversalCache())}var j;a.hasCompoundNodes?j=n.collection().merge(T).merge(T.connectedNodes()).merge(T.parent()):j=T,j.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?T.emitAndNotify("add"):e&&T.emit("add")}return t};rt.removed=function(){var r=this[0];return r&&r._private.removed};rt.inside=function(){var r=this[0];return r&&!r._private.removed};rt.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=[],a={},i=t._private.cy;function o(S){for(var w=S._private.edges,C=0;C<w.length;C++)l(w[C])}function s(S){for(var w=S._private.children,C=0;C<w.length;C++)l(w[C])}function l(S){var w=a[S.id()];e&&S.removed()||w||(a[S.id()]=!0,S.isNode()?(n.push(S),o(S),s(S)):n.unshift(S))}for(var u=0,c=t.length;u<c;u++){var d=t[u];l(d)}function f(S,w){var C=S._private.edges;vn(C,w),S.clearTraversalCache()}function v(S){S.clearTraversalCache()}var h=[];h.ids={};function m(S,w){w=w[0],S=S[0];var C=S._private.children,x=S.id();vn(C,w),w._private.parent=null,h.ids[x]||(h.ids[x]=!0,h.push(S))}t.dirtyCompoundBoundsCache(),e&&i.removeFromPool(n);for(var g=0;g<n.length;g++){var p=n[g];if(p.isEdge()){var y=p.source()[0],b=p.target()[0];f(y,p),f(b,p);for(var _=p.parallelEdges(),B=0;B<_.length;B++){var k=_[B];v(k),k.isBundledBezier()&&k.dirtyBoundingBoxCache()}}else{var M=p.parent();M.length!==0&&m(M,p)}e&&(p._private.removed=!0)}var O=i._private.elements;i._private.hasCompoundNodes=!1;for(var P=0;P<O.length;P++){var L=O[P];if(L.isParent()){i._private.hasCompoundNodes=!0;break}}var F=new Mt(this.cy(),n);F.size()>0&&(r?F.emitAndNotify("remove"):e&&F.emit("remove"));for(var E=0;E<h.length;E++){var A=h[E];(!e||!A.removed())&&A.updateStyle()}return F};rt.move=function(r){var e=this._private.cy,t=this,n=!1,a=!1,i=function(h){return h==null?h:""+h};if(r.source!==void 0||r.target!==void 0){var o=i(r.source),s=i(r.target),l=o!=null&&e.hasElementWithId(o),u=s!=null&&e.hasElementWithId(s);(l||u)&&(e.batch(function(){t.remove(n,a),t.emitAndNotify("moveout");for(var v=0;v<t.length;v++){var h=t[v],m=h._private.data;h.isEdge()&&(l&&(m.source=o),u&&(m.target=s))}t.restore(n,a)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var c=i(r.parent),d=c===null||e.hasElementWithId(c);if(d){var f=c===null?void 0:c;e.batch(function(){var v=t.remove(n,a);v.emitAndNotify("moveout");for(var h=0;h<t.length;h++){var m=t[h],g=m._private.data;m.isNode()&&(g.parent=f)}v.restore(n,a)}),t.emitAndNotify("move")}}return this};[Od,Oy,To,cn,fa,Qy,Jo,h1,sf,lf,y1,No,Mo,Tt,dn,Ft].forEach(function(r){Fe(rt,r)});var E1={add:function(e){var t,n=this;if(sr(e)){var a=e;if(a._private.cy===n)t=a.restore();else{for(var i=[],o=0;o<a.length;o++){var s=a[o];i.push(s.json())}t=new Mt(n,i)}}else if(Je(e)){var l=e;t=new Mt(n,l)}else if(He(e)&&(Je(e.nodes)||Je(e.edges))){for(var u=e,c=[],d=["nodes","edges"],f=0,v=d.length;f<v;f++){var h=d[f],m=u[h];if(Je(m))for(var g=0,p=m.length;g<p;g++){var y=Fe({group:h},m[g]);c.push(y)}}t=new Mt(n,c)}else{var b=e;t=new Ko(n,b).collection()}return t},remove:function(e){if(!sr(e)){if(Be(e)){var t=e;e=this.$(t)}}return e.remove()}};function T1(r,e,t,n){var a=4,i=.001,o=1e-7,s=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var f=c?new Float32Array(l):new Array(l);function v(L,F){return 1-3*F+3*L}function h(L,F){return 3*F-6*L}function m(L){return 3*L}function g(L,F,E){return((v(F,E)*L+h(F,E))*L+m(F))*L}function p(L,F,E){return 3*v(F,E)*L*L+2*h(F,E)*L+m(F)}function y(L,F){for(var E=0;E<a;++E){var A=p(F,r,t);if(A===0)return F;var S=g(F,r,t)-L;F-=S/A}return F}function b(){for(var L=0;L<l;++L)f[L]=g(L*u,r,t)}function _(L,F,E){var A,S,w=0;do S=F+(E-F)/2,A=g(S,r,t)-L,A>0?E=S:F=S;while(Math.abs(A)>o&&++w<s);return S}function B(L){for(var F=0,E=1,A=l-1;E!==A&&f[E]<=L;++E)F+=u;--E;var S=(L-f[E])/(f[E+1]-f[E]),w=F+S*u,C=p(w,r,t);return C>=i?y(L,w):C===0?w:_(L,F,F+u)}var k=!1;function M(){k=!0,(r!==e||t!==n)&&b()}var O=function(F){return k||M(),r===e&&t===n?F:F===0?0:F===1?1:g(B(F),e,n)};O.getControlPoints=function(){return[{x:r,y:e},{x:t,y:n}]};var P="generateBezier("+[r,e,t,n]+")";return O.toString=function(){return P},O}var M1=function(){function r(n){return-n.tension*n.x-n.friction*n.v}function e(n,a,i){var o={x:n.x+i.dx*a,v:n.v+i.dv*a,tension:n.tension,friction:n.friction};return{dx:o.v,dv:r(o)}}function t(n,a){var i={dx:n.v,dv:r(n)},o=e(n,a*.5,i),s=e(n,a*.5,o),l=e(n,a,s),u=1/6*(i.dx+2*(o.dx+s.dx)+l.dx),c=1/6*(i.dv+2*(o.dv+s.dv)+l.dv);return n.x=n.x+u*a,n.v=n.v+c*a,n}return function n(a,i,o){var s={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,d=16/1e3,f,v,h;for(a=parseFloat(a)||500,i=parseFloat(i)||20,o=o||null,s.tension=a,s.friction=i,f=o!==null,f?(u=n(a,i),v=u/o*d):v=d;h=t(h||s,v),l.push(1+h.x),u+=16,Math.abs(h.x)>c&&Math.abs(h.v)>c;);return f?function(m){return l[m*(l.length-1)|0]}:u}}(),tt=function(e,t,n,a){var i=T1(e,t,n,a);return function(o,s,l){return o+(s-o)*i(l)}},Do={linear:function(e,t,n){return e+(t-e)*n},ease:tt(.25,.1,.25,1),"ease-in":tt(.42,0,1,1),"ease-out":tt(0,0,.58,1),"ease-in-out":tt(.42,0,.58,1),"ease-in-sine":tt(.47,0,.745,.715),"ease-out-sine":tt(.39,.575,.565,1),"ease-in-out-sine":tt(.445,.05,.55,.95),"ease-in-quad":tt(.55,.085,.68,.53),"ease-out-quad":tt(.25,.46,.45,.94),"ease-in-out-quad":tt(.455,.03,.515,.955),"ease-in-cubic":tt(.55,.055,.675,.19),"ease-out-cubic":tt(.215,.61,.355,1),"ease-in-out-cubic":tt(.645,.045,.355,1),"ease-in-quart":tt(.895,.03,.685,.22),"ease-out-quart":tt(.165,.84,.44,1),"ease-in-out-quart":tt(.77,0,.175,1),"ease-in-quint":tt(.755,.05,.855,.06),"ease-out-quint":tt(.23,1,.32,1),"ease-in-out-quint":tt(.86,0,.07,1),"ease-in-expo":tt(.95,.05,.795,.035),"ease-out-expo":tt(.19,1,.22,1),"ease-in-out-expo":tt(1,0,0,1),"ease-in-circ":tt(.6,.04,.98,.335),"ease-out-circ":tt(.075,.82,.165,1),"ease-in-out-circ":tt(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return Do.linear;var a=M1(e,t,n);return function(i,o,s){return i+(o-i)*a(s)}},"cubic-bezier":tt};function kc(r,e,t,n,a){if(n===1||e===t)return t;var i=a(e,t,n);return r==null||((r.roundValue||r.color)&&(i=Math.round(i)),r.min!==void 0&&(i=Math.max(i,r.min)),r.max!==void 0&&(i=Math.min(i,r.max))),i}function Pc(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function Jn(r,e,t,n,a){var i=a!=null?a.type:null;t<0?t=0:t>1&&(t=1);var o=Pc(r,a),s=Pc(e,a);if(Ce(o)&&Ce(s))return kc(i,o,s,t,n);if(Je(o)&&Je(s)){for(var l=[],u=0;u<s.length;u++){var c=o[u],d=s[u];if(c!=null&&d!=null){var f=kc(i,c,d,t,n);l.push(f)}else l.push(d)}return l}}function D1(r,e,t,n){var a=!n,i=r._private,o=e._private,s=o.easing,l=o.startTime,u=n?r:r.cy(),c=u.style();if(!o.easingImpl)if(s==null)o.easingImpl=Do.linear;else{var d;if(Be(s)){var f=c.parse("transition-timing-function",s);d=f.value}else d=s;var v,h;Be(d)?(v=d,h=[]):(v=d[1],h=d.slice(2).map(function(T){return+T})),h.length>0?(v==="spring"&&h.push(o.duration),o.easingImpl=Do[v].apply(null,h)):o.easingImpl=Do[v]}var m=o.easingImpl,g;if(o.duration===0?g=1:g=(t-l)/o.duration,o.applying&&(g=o.progress),g<0?g=0:g>1&&(g=1),o.delay==null){var p=o.startPosition,y=o.position;if(y&&a&&!r.locked()){var b={};Aa(p.x,y.x)&&(b.x=Jn(p.x,y.x,g,m)),Aa(p.y,y.y)&&(b.y=Jn(p.y,y.y,g,m)),r.position(b)}var _=o.startPan,B=o.pan,k=i.pan,M=B!=null&&n;M&&(Aa(_.x,B.x)&&(k.x=Jn(_.x,B.x,g,m)),Aa(_.y,B.y)&&(k.y=Jn(_.y,B.y,g,m)),r.emit("pan"));var O=o.startZoom,P=o.zoom,L=P!=null&&n;L&&(Aa(O,P)&&(i.zoom=Ka(i.minZoom,Jn(O,P,g,m),i.maxZoom)),r.emit("zoom")),(M||L)&&r.emit("viewport");var F=o.style;if(F&&F.length>0&&a){for(var E=0;E<F.length;E++){var A=F[E],S=A.name,w=A,C=o.startStyle[S],x=c.properties[C.name],D=Jn(C,w,g,m,x);c.overrideBypass(r,S,D)}r.emit("style")}}return o.progress=g,g}function Aa(r,e){return r==null||e==null?!1:Ce(r)&&Ce(e)?!0:!!(r&&e)}function k1(r,e,t,n){var a=e._private;a.started=!0,a.startTime=t-a.progress*a.duration}function Ac(r,e){var t=e._private.aniEles,n=[];function a(c,d){var f=c._private,v=f.animation.current,h=f.animation.queue,m=!1;if(v.length===0){var g=h.shift();g&&v.push(g)}for(var p=function(k){for(var M=k.length-1;M>=0;M--){var O=k[M];O()}k.splice(0,k.length)},y=v.length-1;y>=0;y--){var b=v[y],_=b._private;if(_.stopped){v.splice(y,1),_.hooked=!1,_.playing=!1,_.started=!1,p(_.frames);continue}!_.playing&&!_.applying||(_.playing&&_.applying&&(_.applying=!1),_.started||k1(c,b,r),D1(c,b,r,d),_.applying&&(_.applying=!1),p(_.frames),_.step!=null&&_.step(r),b.completed()&&(v.splice(y,1),_.hooked=!1,_.playing=!1,_.started=!1,p(_.completes)),m=!0)}return!d&&v.length===0&&h.length===0&&n.push(c),m}for(var i=!1,o=0;o<t.length;o++){var s=t[o],l=a(s);i=i||l}var u=a(e,!0);(i||u)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(n),e.emit("step")}var P1={animate:Xe.animate(),animation:Xe.animation(),animated:Xe.animated(),clearQueue:Xe.clearQueue(),delay:Xe.delay(),delayAnimation:Xe.delayAnimation(),stop:Xe.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){e._private.animationsRunning&&Ro(function(i){Ac(i,e),t()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(i,o){Ac(o,e)},n.beforeRenderPriorities.animations):t()}},A1={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var a=t.qualifier;return a!=null?e!==n.target&&ti(n.target)&&a.matches(n.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},Co=function(e){return Be(e)?new pn(e):e},df={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new es(A1,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,Co(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,Co(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,Co(t),n),this},once:function(e,t,n){return this.emitter().one(e,Co(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Xe.eventAliasesOn(df);var Qs={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};Qs.jpeg=Qs.jpg;var ko={layout:function(e){var t=this;if(e==null){ot("Layout options must be specified to make a layout");return}if(e.name==null){ot("A `name` must be specified to make a layout");return}var n=e.name,a=t.extension("layout",n);if(a==null){ot("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var i;Be(e.eles)?i=t.$(e.eles):i=e.eles!=null?e.eles:t.$();var o=new a(Fe({},e,{cy:t,eles:i}));return o}};ko.createLayout=ko.makeLayout=ko.layout;var B1={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var a=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&a.merge(t);return}if(n.notificationsEnabled){var i=this.renderer();this.destroyed()||!i||i.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var a=e.batchNotifications[n];a.empty()?t.notify(n):t.notify(n,a)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),a=0;a<n.length;a++){var i=n[a],o=e[i],s=t.getElementById(i);s.data(o)}})}},I1=St({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:12,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),Zs={renderTo:function(e,t,n,a){var i=this._private.renderer;return i.renderTo(e,t,n,a),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n==null){ot("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Ye("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var a=I1(e);a.cy=t,t._private.renderer=new n(a),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var a=n._private;a.rscratch={},a.rstyle={},a.animation.current=[],a.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Zs.invalidateDimensions=Zs.resize;var Po={collection:function(e,t){return Be(e)?this.$(e):sr(e)?e.collection():Je(e)?(t||(t={}),new Mt(this,e,t.unique,t.removed)):new Mt(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};Po.elements=Po.filter=Po.$;var Vt={},Na="t",R1="f";Vt.apply=function(r){for(var e=this,t=e._private,n=t.cy,a=n.collection(),i=0;i<r.length;i++){var o=r[i],s=e.getContextMeta(o);if(!s.empty){var l=e.getContextStyle(s),u=e.applyContextStyle(s,l,o);o._private.appliedInitStyle?e.updateTransitions(o,u.diffProps):o._private.appliedInitStyle=!0;var c=e.updateStyleHints(o);c&&a.push(o)}}return a};Vt.getPropertiesDiff=function(r,e){var t=this,n=t._private.propDiffs=t._private.propDiffs||{},a=r+"-"+e,i=n[a];if(i)return i;for(var o=[],s={},l=0;l<t.length;l++){var u=t[l],c=r[l]===Na,d=e[l]===Na,f=c!==d,v=u.mappedProperties.length>0;if(f||d&&v){var h=void 0;f&&v||f?h=u.properties:v&&(h=u.mappedProperties);for(var m=0;m<h.length;m++){for(var g=h[m],p=g.name,y=!1,b=l+1;b<t.length;b++){var _=t[b],B=e[b]===Na;if(B&&(y=_.properties[g.name]!=null,y))break}!s[p]&&!y&&(s[p]=!0,o.push(p))}}}return n[a]=o,o};Vt.getContextMeta=function(r){for(var e=this,t="",n,a=r._private.styleCxtKey||"",i=0;i<e.length;i++){var o=e[i],s=o.selector&&o.selector.matches(r);s?t+=Na:t+=R1}return n=e.getPropertiesDiff(a,t),r._private.styleCxtKey=t,{key:t,diffPropNames:n,empty:n.length===0}};Vt.getContextStyle=function(r){var e=r.key,t=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var a={_private:{key:e}},i=0;i<t.length;i++){var o=t[i],s=e[i]===Na;if(s)for(var l=0;l<o.properties.length;l++){var u=o.properties[l];a[u.name]=u}}return n[e]=a,a};Vt.applyContextStyle=function(r,e,t){for(var n=this,a=r.diffPropNames,i={},o=n.types,s=0;s<a.length;s++){var l=a[s],u=e[l],c=t.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===o.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var d=c.mapping,f=d.fnValue=u.value(t);if(f===d.prevFnValue)continue}var v=i[l]={prev:c};n.applyParsedProperty(t,u),v.next=t.pstyle(l),v.next&&v.next.bypass&&(v.next=v.next.bypassed)}}return{diffProps:i}};Vt.updateStyleHints=function(r){var e=r._private,t=this,n=t.propertyGroupNames,a=t.propertyGroupKeys,i=function(N,G,W){return t.getPropertiesHash(N,G,W)},o=e.styleKey;if(r.removed())return!1;var s=e.group==="nodes",l=r._private.style;n=Object.keys(l);for(var u=0;u<a.length;u++){var c=a[u];e.styleKeys[c]=[ra,Oa]}for(var d=function(N,G){return e.styleKeys[G][0]=qa(N,e.styleKeys[G][0])},f=function(N,G){return e.styleKeys[G][1]=Ha(N,e.styleKeys[G][1])},v=function(N,G){d(N,G),f(N,G)},h=function(N,G){for(var W=0;W<N.length;W++){var X=N.charCodeAt(W);d(X,G),f(X,G)}},m=2e9,g=function(N){return-128<N&&N<128&&Math.floor(N)!==N?m-(N*1024|0):N},p=0;p<n.length;p++){var y=n[p],b=l[y];if(b!=null){var _=this.properties[y],B=_.type,k=_.groupKey,M=void 0;_.hashOverride!=null?M=_.hashOverride(r,b):b.pfValue!=null&&(M=b.pfValue);var O=_.enums==null?b.value:null,P=M!=null,L=O!=null,F=P||L,E=b.units;if(B.number&&F&&!B.multiple){var A=P?M:O;v(g(A),k),!P&&E!=null&&h(E,k)}else h(b.strValue,k)}}for(var S=[ra,Oa],w=0;w<a.length;w++){var C=a[w],x=e.styleKeys[C];S[0]=qa(x[0],S[0]),S[1]=Ha(x[1],S[1])}e.styleKey=Np(S[0],S[1]);var D=e.styleKeys;e.labelDimsKey=on(D.labelDimensions);var T=i(r,["label"],D.labelDimensions);if(e.labelKey=on(T),e.labelStyleKey=on(uo(D.commonLabel,T)),!s){var V=i(r,["source-label"],D.labelDimensions);e.sourceLabelKey=on(V),e.sourceLabelStyleKey=on(uo(D.commonLabel,V));var z=i(r,["target-label"],D.labelDimensions);e.targetLabelKey=on(z),e.targetLabelStyleKey=on(uo(D.commonLabel,z))}if(s){var j=e.styleKeys,U=j.nodeBody,Y=j.nodeBorder,te=j.nodeOutline,J=j.backgroundImage,ne=j.compound,ae=j.pie,K=[U,Y,te,J,ne,ae].filter(function(R){return R!=null}).reduce(uo,[ra,Oa]);e.nodeKey=on(K),e.hasPie=ae!=null&&ae[0]!==ra&&ae[1]!==Oa}return o!==e.styleKey};Vt.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null};Vt.applyParsedProperty=function(r,e){var t=this,n=e,a=r._private.style,i,o=t.types,s=t.properties[n.name].type,l=n.bypass,u=a[n.name],c=u&&u.bypass,d=r._private,f="mapping",v=function(U){return U==null?null:U.pfValue!=null?U.pfValue:U.value},h=function(){var U=v(u),Y=v(n);t.checkTriggers(r,n.name,U,Y)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return a[n.name]=void 0,h(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,h(),!0):!1:(h(),!0);if(n.deleteBypass)return u?u.bypass?(a[n.name]=u.bypassed,h(),!0):!1:(h(),!0);var m=function(){Ye("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case o.mapData:{for(var g=n.field.split("."),p=d.data,y=0;y<g.length&&p;y++){var b=g[y];p=p[b]}if(p==null)return m(),!1;var _;if(Ce(p)){var B=n.fieldMax-n.fieldMin;B===0?_=0:_=(p-n.fieldMin)/B}else return Ye("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+p+"` for `"+r.id()+"` is non-numeric)"),!1;if(_<0?_=0:_>1&&(_=1),s.color){var k=n.valueMin[0],M=n.valueMax[0],O=n.valueMin[1],P=n.valueMax[1],L=n.valueMin[2],F=n.valueMax[2],E=n.valueMin[3]==null?1:n.valueMin[3],A=n.valueMax[3]==null?1:n.valueMax[3],S=[Math.round(k+(M-k)*_),Math.round(O+(P-O)*_),Math.round(L+(F-L)*_),Math.round(E+(A-E)*_)];i={bypass:n.bypass,name:n.name,value:S,strValue:"rgb("+S[0]+", "+S[1]+", "+S[2]+")"}}else if(s.number){var w=n.valueMin+(n.valueMax-n.valueMin)*_;i=this.parse(n.name,w,n.bypass,f)}else return!1;if(!i)return m(),!1;i.mapping=n,n=i;break}case o.data:{for(var C=n.field.split("."),x=d.data,D=0;D<C.length&&x;D++){var T=C[D];x=x[T]}if(x!=null&&(i=this.parse(n.name,x,n.bypass,f)),!i)return m(),!1;i.mapping=n,n=i;break}case o.fn:{var V=n.value,z=n.fnValue!=null?n.fnValue:V(r);if(n.prevFnValue=z,z==null)return Ye("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+r.id()+"` is null)"),!1;if(i=this.parse(n.name,z,n.bypass,f),!i)return Ye("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+r.id()+"` is invalid)"),!1;i.mapping=Or(n),n=i;break}case void 0:break;default:return!1}return l?(c?n.bypassed=u.bypassed:n.bypassed=u,a[n.name]=n):c?u.bypassed=n:a[n.name]=n,h(),!0};Vt.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var a=n._private.style,i=Object.keys(a),o=0;o<i.length;o++){var s=i[o],l=a[s];l!=null&&(l.bypass?l.bypassed=null:a[s]=null)}}};Vt.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};Vt.updateTransitions=function(r,e){var t=this,n=r._private,a=r.pstyle("transition-property").value,i=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(a.length>0&&i>0){for(var s={},l=!1,u=0;u<a.length;u++){var c=a[u],d=r.pstyle(c),f=e[c];if(f){var v=f.prev,h=v,m=f.next!=null?f.next:d,g=!1,p=void 0,y=1e-6;h&&(Ce(h.pfValue)&&Ce(m.pfValue)?(g=m.pfValue-h.pfValue,p=h.pfValue+y*g):Ce(h.value)&&Ce(m.value)?(g=m.value-h.value,p=h.value+y*g):Je(h.value)&&Je(m.value)&&(g=h.value[0]!==m.value[0]||h.value[1]!==m.value[1]||h.value[2]!==m.value[2],p=h.strValue),g&&(s[c]=m.strValue,this.applyBypass(r,c,p),l=!0))}}if(!l)return;n.transitioning=!0,new va(function(b){o>0?r.delayAnimation(o).play().promise().then(b):b()}).then(function(){return r.animation({style:s,duration:i,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,a),r.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(r,a),r.emitAndNotify("style"),n.transitioning=!1)};Vt.checkTrigger=function(r,e,t,n,a,i){var o=this.properties[e],s=a(o);s!=null&&s(t,n)&&i(o)};Vt.checkZOrderTrigger=function(r,e,t,n){var a=this;this.checkTrigger(r,e,t,n,function(i){return i.triggersZOrder},function(){a._private.cy.notify("zorder",r)})};Vt.checkBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(a){return a.triggersBounds},function(a){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),a.triggersBoundsOfParallelBeziers&&e==="curve-style"&&(t==="bezier"||n==="bezier")&&r.parallelEdges().forEach(function(i){i.dirtyBoundingBoxCache()}),a.triggersBoundsOfConnectedEdges&&e==="display"&&(t==="none"||n==="none")&&r.connectedEdges().forEach(function(i){i.dirtyBoundingBoxCache()})})};Vt.checkTriggers=function(r,e,t,n){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,n),this.checkBoundsTrigger(r,e,t,n)};var oi={};oi.applyBypass=function(r,e,t,n){var a=this,i=[],o=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var s=0;s<a.properties.length;s++){var l=a.properties[s],u=l.name,c=this.parse(u,t,!0);c&&i.push(c)}}else if(Be(e)){var d=this.parse(e,t,!0);d&&i.push(d)}else if(He(e)){var f=e;n=t;for(var v=Object.keys(f),h=0;h<v.length;h++){var m=v[h],g=f[m];if(g===void 0&&(g=f[Ho(m)]),g!==void 0){var p=this.parse(m,g,!0);p&&i.push(p)}}}else return!1;if(i.length===0)return!1;for(var y=!1,b=0;b<r.length;b++){for(var _=r[b],B={},k=void 0,M=0;M<i.length;M++){var O=i[M];if(n){var P=_.pstyle(O.name);k=B[O.name]={prev:P}}y=this.applyParsedProperty(_,Or(O))||y,n&&(k.next=_.pstyle(O.name))}y&&this.updateStyleHints(_),n&&this.updateTransitions(_,B,o)}return y};oi.overrideBypass=function(r,e,t){e=ul(e);for(var n=0;n<r.length;n++){var a=r[n],i=a._private.style[e],o=this.properties[e].type,s=o.color,l=o.mutiple,u=i?i.pfValue!=null?i.pfValue:i.value:null;!i||!i.bypass?this.applyBypass(a,e,t):(i.value=t,i.pfValue!=null&&(i.pfValue=t),s?i.strValue="rgb("+t.join(",")+")":l?i.strValue=t.join(" "):i.strValue=""+t,this.updateStyleHints(a)),this.checkTriggers(a,e,u,t)}};oi.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};oi.removeBypasses=function(r,e,t){for(var n=!0,a=0;a<r.length;a++){for(var i=r[a],o={},s=0;s<e.length;s++){var l=e[s],u=this.properties[l],c=i.pstyle(u.name);if(!(!c||!c.bypass)){var d="",f=this.parse(l,d,!0),v=o[u.name]={prev:c};this.applyParsedProperty(i,f),v.next=i.pstyle(u.name)}}this.updateStyleHints(i),t&&this.updateTransitions(i,o,n)}};var _l={};_l.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};_l.containerCss=function(r){var e=this._private.cy,t=e.container(),n=e.window();if(n&&t&&n.getComputedStyle)return n.getComputedStyle(t).getPropertyValue(r)};var Lr={};Lr.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};Lr.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var n={},a=0;a<t.properties.length;a++){var i=t.properties[a],o=t.getStylePropertyValue(r,i.name,e);o!=null&&(n[i.name]=o,n[Ho(i.name)]=o)}return n}};Lr.getIndexedStyle=function(r,e,t,n){var a=r.pstyle(e)[t][n];return a??r.cy().style().getDefaultProperty(e)[t][0]};Lr.getStylePropertyValue=function(r,e,t){var n=this;if(r=r[0],r){var a=n.properties[e];a.alias&&(a=a.pointsTo);var i=a.type,o=r.pstyle(a.name);if(o){var s=o.value,l=o.units,u=o.strValue;if(t&&i.number&&s!=null&&Ce(s)){var c=r.cy().zoom(),d=function(g){return g*c},f=function(g,p){return d(g)+p},v=Je(s),h=v?l.every(function(m){return m!=null}):l!=null;return h?v?s.map(function(m,g){return f(m,l[g])}).join(" "):f(s,l):v?s.map(function(m){return Be(m)?m:""+d(m)}).join(" "):""+d(s)}else if(u!=null)return u}return null}};Lr.getAnimationStartStyle=function(r,e){for(var t={},n=0;n<e.length;n++){var a=e[n],i=a.name,o=r.pstyle(i);o!==void 0&&(He(o)?o=this.parse(i,o.strValue):o=this.parse(i,o)),o&&(t[i]=o)}return t};Lr.getPropsList=function(r){var e=this,t=[],n=r,a=e.properties;if(n)for(var i=Object.keys(n),o=0;o<i.length;o++){var s=i[o],l=n[s],u=a[s]||a[ul(s)],c=this.parse(u.name,l);c&&t.push(c)}return t};Lr.getNonDefaultPropertiesHash=function(r,e,t){var n=t.slice(),a,i,o,s,l,u;for(l=0;l<e.length;l++)if(a=e[l],i=r.pstyle(a,!1),i!=null)if(i.pfValue!=null)n[0]=qa(s,n[0]),n[1]=Ha(s,n[1]);else for(o=i.strValue,u=0;u<o.length;u++)s=o.charCodeAt(u),n[0]=qa(s,n[0]),n[1]=Ha(s,n[1]);return n};Lr.getPropertiesHash=Lr.getNonDefaultPropertiesHash;var ns={};ns.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var n=r[t],a=n.selector,i=n.style||n.css,o=Object.keys(i);e.selector(a);for(var s=0;s<o.length;s++){var l=o[s],u=i[l];e.css(l,u)}}return e};ns.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};ns.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],n=t.selector,a=t.properties,i={},o=0;o<a.length;o++){var s=a[o];i[s.name]=s.strValue}r.push({selector:n?n.toString():"core",style:i})}return r};var Sl={};Sl.appendFromString=function(r){var e=this,t=this,n=""+r,a,i,o;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){n.length>a.length?n=n.substr(a.length):n=""}function l(){i.length>o.length?i=i.substr(o.length):i=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Ye("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}a=c[0];var d=c[1];if(d!=="core"){var f=new pn(d);if(f.invalid){Ye("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),s();continue}}var v=c[2],h=!1;i=v;for(var m=[];;){var g=i.match(/^\s*$/);if(g)break;var p=i.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!p){Ye("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+v),h=!0;break}o=p[0];var y=p[1],b=p[2],_=e.properties[y];if(!_){Ye("Skipping property: Invalid property name in: "+o),l();continue}var B=t.parse(y,b);if(!B){Ye("Skipping property: Invalid property definition in: "+o),l();continue}m.push({name:y,val:b}),l()}if(h){s();break}t.selector(d);for(var k=0;k<m.length;k++){var M=m[k];t.css(M.name,M.val)}s()}return t};Sl.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var Et={};(function(){var r=vt,e=$v,t=Hv,n=Wv,a=Kv,i=function(K){return"^"+K+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(K){var R=r+"|\\w+|"+e+"|"+t+"|"+n+"|"+a;return"^"+K+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+R+")\\s*\\,\\s*("+R+")\\)$"},s=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Et.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:i("data")},layoutData:{mapping:!0,regex:i("layoutData")},scratch:{mapping:!0,regex:i("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:s,singleRegexMatchValue:!0},urls:{regexes:s,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(K,R){switch(K.length){case 2:return R[0]!=="deg"&&R[0]!=="rad"&&R[1]!=="deg"&&R[1]!=="rad";case 1:return Be(K[0])||R[0]==="deg"||R[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(K){var R=K.length;return R===1||R===2||R===4}}};var l={zeroNonZero:function(K,R){return(K==null||R==null)&&K!==R||K==0&&R!=0?!0:K!=0&&R==0},any:function(K,R){return K!=R},emptyNonEmpty:function(K,R){var N=fn(K),G=fn(R);return N&&!G||!N&&G}},u=Et.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],d=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],f=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],v=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],h=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification}],m=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any}],g=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:!0},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],p=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],b=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],_=function(K,R){return R.value==="label"?-K.poolIndex():R.pfValue},B=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:_},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:_},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],k=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],M=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],O=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],P=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],L=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],F=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],E=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],A=[];Et.pieBackgroundN=16,A.push({name:"pie-size",type:u.sizeMaybePercent});for(var S=1;S<=Et.pieBackgroundN;S++)A.push({name:"pie-"+S+"-background-color",type:u.color}),A.push({name:"pie-"+S+"-background-size",type:u.percent}),A.push({name:"pie-"+S+"-background-opacity",type:u.zeroOneNumber});var w=[],C=Et.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(ae){C.forEach(function(K){var R=K+"-"+ae.name,N=ae.type,G=ae.triggersBounds;w.push({name:R,type:N,triggersBounds:G})})},{});var x=Et.properties=[].concat(m,b,g,p,y,F,h,v,c,d,f,B,k,M,O,A,P,L,w,E),D=Et.propertyGroups={behavior:m,transition:b,visibility:g,overlay:p,underlay:y,ghost:F,commonLabel:h,labelDimensions:v,mainLabel:c,sourceLabel:d,targetLabel:f,nodeBody:B,nodeBorder:k,nodeOutline:M,backgroundImage:O,pie:A,compound:P,edgeLine:L,edgeArrow:w,core:E},T=Et.propertyGroupNames={},V=Et.propertyGroupKeys=Object.keys(D);V.forEach(function(ae){T[ae]=D[ae].map(function(K){return K.name}),D[ae].forEach(function(K){return K.groupKey=ae})});var z=Et.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Et.propertyNames=x.map(function(ae){return ae.name});for(var j=0;j<x.length;j++){var U=x[j];x[U.name]=U}for(var Y=0;Y<z.length;Y++){var te=z[Y],J=x[te.pointsTo],ne={name:te.name,alias:!0,pointsTo:J};x.push(ne),x[te.name]=ne}})();Et.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};Et.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Fe({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=Et.pieBackgroundN;c++){var d=u.name.replace("{{i}}",c),f=u.value;l[d]=f}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return Et.arrowPrefixes.forEach(function(c){var d=c+"-"+u.name,f=u.value;l[d]=f}),l},{})),t={},n=0;n<this.properties.length;n++){var a=this.properties[n];if(!a.pointsTo){var i=a.name,o=e[i],s=this.parse(i,o);t[i]=s}}return r.defaultProperties=t,r.defaultProperties};Et.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var as={};as.parse=function(r,e,t,n){var a=this;if(st(e))return a.parseImplWarn(r,e,t,n);var i=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,o=t?"t":"f",s=""+e,l=Cd(r,s,o,i),u=a.propCache=a.propCache||[],c;return(c=u[l])||(c=u[l]=a.parseImplWarn(r,e,t,n)),(t||n==="mapping")&&(c=Or(c),c&&(c.value=Or(c.value))),c};as.parseImplWarn=function(r,e,t,n){var a=this.parseImpl(r,e,t,n);return!a&&e!=null&&Ye("The style property `".concat(r,": ").concat(e,"` is invalid")),a&&(a.name==="width"||a.name==="height")&&e==="label"&&Ye("The style value of `label` is deprecated for `"+a.name+"`"),a};as.parseImpl=function(r,e,t,n){var a=this;r=ul(r);var i=a.properties[r],o=e,s=a.types;if(!i||e===void 0)return null;i.alias&&(i=i.pointsTo,r=i.name);var l=Be(e);l&&(e=e.trim());var u=i.type;if(!u)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(st(e))return{name:r,value:e,strValue:"fn",mapped:s.fn,bypass:t};var c,d;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(s.data.regex).exec(e))){if(t)return!1;var f=s.data;return{name:r,value:c,strValue:""+e,mapped:f,field:c[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(s.mapData.regex).exec(e))){if(t||u.multiple)return!1;var v=s.mapData;if(!(u.color||u.number))return!1;var h=this.parse(r,d[4]);if(!h||h.mapped)return!1;var m=this.parse(r,d[5]);if(!m||m.mapped)return!1;if(h.pfValue===m.pfValue||h.strValue===m.strValue)return Ye("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+h.strValue+"`"),this.parse(r,h.strValue);if(u.color){var g=h.value,p=m.value,y=g[0]===p[0]&&g[1]===p[1]&&g[2]===p[2]&&(g[3]===p[3]||(g[3]==null||g[3]===1)&&(p[3]==null||p[3]===1));if(y)return!1}return{name:r,value:d,strValue:""+e,mapped:v,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:h.value,valueMax:m.value,bypass:t}}}if(u.multiple&&n!=="multiple"){var b;if(l?b=e.split(/\s+/):Je(e)?b=e:b=[e],u.evenMultiple&&b.length%2!==0)return null;for(var _=[],B=[],k=[],M="",O=!1,P=0;P<b.length;P++){var L=a.parse(r,b[P],t,"multiple");O=O||Be(L.value),_.push(L.value),k.push(L.pfValue!=null?L.pfValue:L.value),B.push(L.units),M+=(P>0?" ":"")+L.strValue}return u.validate&&!u.validate(_,B)?null:u.singleEnum&&O?_.length===1&&Be(_[0])?{name:r,value:_[0],strValue:_[0],bypass:t}:null:{name:r,value:_,pfValue:k,strValue:M,bypass:t,units:B}}var F=function(){for(var K=0;K<u.enums.length;K++){var R=u.enums[K];if(R===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(u.number){var E,A="px";if(u.units&&(E=u.units),u.implicitUnits&&(A=u.implicitUnits),!u.unitless)if(l){var S="px|em"+(u.allowPercent?"|\\%":"");E&&(S=E);var w=e.match("^("+vt+")("+S+")?$");w&&(e=w[1],E=w[2]||A)}else(!E||u.implicitUnits)&&(E=A);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=o,F();if(u.integer&&!Fv(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var C={name:r,value:e,strValue:""+e+(E||""),units:E,bypass:t};return u.unitless||E!=="px"&&E!=="em"?C.pfValue=e:C.pfValue=E==="px"||!E?e:this.getEmSizeInPixels()*e,(E==="ms"||E==="s")&&(C.pfValue=E==="ms"?e:1e3*e),(E==="deg"||E==="rad")&&(C.pfValue=E==="rad"?e:pg(e)),E==="%"&&(C.pfValue=e/100),C}else if(u.propList){var x=[],D=""+e;if(D!=="none"){for(var T=D.split(/\s*,\s*|\s+/),V=0;V<T.length;V++){var z=T[V].trim();a.properties[z]?x.push(z):Ye("`"+z+"` is not a valid property name")}if(x.length===0)return null}return{name:r,value:x,strValue:x.length===0?"none":x.join(" "),bypass:t}}else if(u.color){var j=dd(e);return j?{name:r,value:j,pfValue:j,strValue:"rgb("+j[0]+","+j[1]+","+j[2]+")",bypass:t}:null}else if(u.regex||u.regexes){if(u.enums){var U=F();if(U)return U}for(var Y=u.regexes?u.regexes:[u.regex],te=0;te<Y.length;te++){var J=new RegExp(Y[te]),ne=J.exec(e);if(ne)return{name:r,value:u.singleRegexMatchValue?ne[1]:ne,strValue:""+e,bypass:t}}return null}else return u.string?{name:r,value:""+e,strValue:""+e,bypass:t}:u.enums?F():null};var Ot=function r(e){if(!(this instanceof r))return new r(e);if(!ll(e)){ot("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Lt=Ot.prototype;Lt.instanceString=function(){return"style"};Lt.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(a){var i=a[0]._private;i.styleDirty=!0,i.appliedInitStyle=!1}),this};Lt.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Lt.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};Lt.selector=function(r){var e=r==="core"?null:new pn(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};Lt.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],n=0;n<r.properties.length;n++){var a=r.properties[n],i=t[a.name];i===void 0&&(i=t[Ho(a.name)]),i!==void 0&&this.cssRule(a.name,i)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Lt.style=Lt.css;Lt.cssRule=function(r,e){var t=this.parse(r,e);if(t){var n=this.length-1;this[n].properties.push(t),this[n].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.mapped&&this[n].mappedProperties.push(t);var a=!this[n].selector;a&&(this._private.coreStyle[t.name]=t)}return this};Lt.append=function(r){return ld(r)?r.appendToStyle(this):Je(r)?this.appendFromJson(r):Be(r)&&this.appendFromString(r),this};Ot.fromJson=function(r,e){var t=new Ot(r);return t.fromJson(e),t};Ot.fromString=function(r,e){return new Ot(r).fromString(e)};[Vt,oi,_l,Lr,ns,Sl,Et,as].forEach(function(r){Fe(Lt,r)});Ot.types=Lt.types;Ot.properties=Lt.properties;Ot.propertyGroups=Lt.propertyGroups;Ot.propertyGroupNames=Lt.propertyGroupNames;Ot.propertyGroupKeys=Lt.propertyGroupKeys;var O1={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return ld(e)?t.style=e.generateStyle(this):Je(e)?t.style=Ot.fromJson(this,e):Be(e)?t.style=Ot.fromString(this,e):t.style=Ot(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},F1="single",Fn={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=F1),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,n,a,i,o,s;switch(e.length){case 0:return t;case 1:if(Be(e[0]))return n=e[0],t[n];if(He(e[0])){if(!this._private.panningEnabled)return this;i=e[0],o=i.x,s=i.y,Ce(o)&&(t.x=o),Ce(s)&&(t.y=s),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],a=e[1],(n==="x"||n==="y")&&Ce(a)&&(t[n]=a),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var n=arguments,a=this._private.pan,i,o,s,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:He(e)&&(s=n[0],l=s.x,u=s.y,Ce(l)&&(a.x+=l),Ce(u)&&(a.y+=u),this.emit("pan viewport"));break;case 2:i=e,o=t,(i==="x"||i==="y")&&Ce(o)&&(a[i]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var a=this._private;a.zoom=n.zoom,a.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(Ce(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Be(e)){var a=e;e=this.$(a)}else if(Nv(e)){var i=e;n={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else sr(e)||(e=this.mutableElements());if(!(sr(e)&&e.empty())){n=n||e.boundingBox();var o=this.width(),s=this.height(),l;if(t=Ce(t)?t:0,!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((o-2*t)/n.w,(s-2*t)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(o-l*(n.x1+n.x2))/2,y:(s-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var a=e;e=a.min,t=a.max}return Ce(e)&&Ce(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):Ce(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:Ce(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,n=t.pan,a=t.zoom,i,o,s=!1;if(t.zoomingEnabled||(s=!0),Ce(e)?o=e:He(e)&&(o=e.level,e.position!=null?i=Uo(e.position,a,n):e.renderedPosition!=null&&(i=e.renderedPosition),i!=null&&!t.panningEnabled&&(s=!0)),o=o>t.maxZoom?t.maxZoom:o,o=o<t.minZoom?t.minZoom:o,s||!Ce(o)||o===a||i!=null&&(!Ce(i.x)||!Ce(i.y)))return null;if(i!=null){var l=n,u=a,c=o,d={x:-c/u*(i.x-l.x)+i.x,y:-c/u*(i.y-l.y)+i.y};return{zoomed:!0,panned:!0,zoom:c,pan:d}}else return{zoomed:!0,panned:!1,zoom:o,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t==null||!t.zoomed?this:(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,n=!0,a=!0,i=[],o=!1,s=!1;if(!e)return this;if(Ce(e.zoom)||(n=!1),He(e.pan)||(a=!1),!n&&!a)return this;if(n){var l=e.zoom;l<t.minZoom||l>t.maxZoom||!t.zoomingEnabled?o=!0:(t.zoom=l,i.push("zoom"))}if(a&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var u=e.pan;Ce(u.x)&&(t.pan.x=u.x,s=!1),Ce(u.y)&&(t.pan.y=u.y,s=!1),s||i.push("pan")}return i.length>0&&(i.push("viewport"),this.emit(i.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(Be(e)){var n=e;e=this.mutableElements().filter(n)}else sr(e)||(e=this.mutableElements());if(e.length!==0){var a=e.boundingBox(),i=this.width(),o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(i-t*(a.x1+a.x2))/2,y:(o-t*(a.y1+a.y2))/2};return s}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container,n=this;return e.sizeCache=e.sizeCache||(t?function(){var a=n.window().getComputedStyle(t),i=function(s){return parseFloat(a.getPropertyValue(s))};return{width:t.clientWidth-i("padding-left")-i("padding-right"),height:t.clientHeight-i("padding-top")-i("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),a={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Fn.centre=Fn.center;Fn.autolockNodes=Fn.autolock;Fn.autoungrabifyNodes=Fn.autoungrabify;var Za={data:Xe.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Xe.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Xe.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Xe.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Za.attr=Za.data;Za.removeAttr=Za.removeData;var Ja=function(e){var t=this;e=Fe({},e);var n=e.container;n&&!Io(n)&&Io(n[0])&&(n=n[0]);var a=n?n._cyreg:null;a=a||{},a&&a.cy&&(a.cy.destroy(),a={});var i=a.readies=a.readies||[];n&&(n._cyreg=a),a.cy=t;var o=ht!==void 0&&n!==void 0&&!e.headless,s=e;s.layout=Fe({name:o?"grid":"null"},s.layout),s.renderer=Fe({name:o?"canvas":"null"},s.renderer);var l=function(h,m,g){return m!==void 0?m:g!==void 0?g:h},u=this._private={container:n,ready:!1,options:s,elements:new Mt(this),listeners:[],aniEles:new Mt(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,s.zoomingEnabled),userZoomingEnabled:l(!0,s.userZoomingEnabled),panningEnabled:l(!0,s.panningEnabled),userPanningEnabled:l(!0,s.userPanningEnabled),boxSelectionEnabled:l(!0,s.boxSelectionEnabled),autolock:l(!1,s.autolock,s.autolockNodes),autoungrabify:l(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:l(!1,s.autounselectify),styleEnabled:s.styleEnabled===void 0?o:s.styleEnabled,zoom:Ce(s.zoom)?s.zoom:1,pan:{x:He(s.pan)&&Ce(s.pan.x)?s.pan.x:0,y:He(s.pan)&&Ce(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,s.multiClickDebounceTime)};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});var c=function(h,m){var g=h.some(zv);if(g)return va.all(h).then(m);m(h)};u.styleEnabled&&t.setStyle([]);var d=Fe({},s,s.renderer);t.initRenderer(d);var f=function(h,m,g){t.notifications(!1);var p=t.mutableElements();p.length>0&&p.remove(),h!=null&&(He(h)||Je(h))&&t.add(h),t.one("layoutready",function(b){t.notifications(!0),t.emit(b),t.one("load",m),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",g),t.emit("done")});var y=Fe({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};c([s.style,s.elements],function(v){var h=v[0],m=v[1];u.styleEnabled&&t.style().append(h),f(m,function(){t.startAnimationLoop(),u.ready=!0,st(s.ready)&&t.on("ready",s.ready);for(var g=0;g<i.length;g++){var p=i[g];t.on("ready",p)}a&&(a.readies=[]),t.emit("ready")},s.done)})},zo=Ja.prototype;Fe(zo,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return ht;var t=this._private.container.ownerDocument;return t===void 0||t==null?ht:t.defaultView||ht},mount:function(e){if(e!=null){var t=this,n=t._private,a=n.options;return!Io(e)&&Io(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(Fe({},a,a.renderer,{name:a.renderer.name==="null"?"canvas":a.renderer.name})),t.startAnimationLoop(),t.style(a.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Or(this._private.options)},json:function(e){var t=this,n=t._private,a=t.mutableElements(),i=function(_){return t.getElementById(_.id())};if(He(e)){if(t.startBatch(),e.elements){var o={},s=function(_,B){for(var k=[],M=[],O=0;O<_.length;O++){var P=_[O];if(!P.data.id){Ye("cy.json() cannot handle elements without an ID attribute");continue}var L=""+P.data.id,F=t.getElementById(L);o[L]=!0,F.length!==0?M.push({ele:F,json:P}):(B&&(P.group=B),k.push(P))}t.add(k);for(var E=0;E<M.length;E++){var A=M[E],S=A.ele,w=A.json;S.json(w)}};if(Je(e.elements))s(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],d=e.elements[c];Je(d)&&s(d,c)}var f=t.collection();a.filter(function(b){return!o[b.id()]}).forEach(function(b){b.isParent()?f.merge(b):b.remove()}),f.forEach(function(b){return b.children().move({parent:null})}),f.forEach(function(b){return i(b).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var v=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],h=0;h<v.length;h++){var m=v[h];e[m]!=null&&t[m](e[m])}return t.endBatch(),this}else{var g=!!e,p={};g?p.elements=this.elements().map(function(b){return b.json()}):(p.elements={},a.forEach(function(b){var _=b.group();p.elements[_]||(p.elements[_]=[]),p.elements[_].push(b.json())})),this._private.styleEnabled&&(p.style=t.style().json()),p.data=Or(t.data());var y=n.options;return p.zoomingEnabled=n.zoomingEnabled,p.userZoomingEnabled=n.userZoomingEnabled,p.zoom=n.zoom,p.minZoom=n.minZoom,p.maxZoom=n.maxZoom,p.panningEnabled=n.panningEnabled,p.userPanningEnabled=n.userPanningEnabled,p.pan=Or(n.pan),p.boxSelectionEnabled=n.boxSelectionEnabled,p.renderer=Or(y.renderer),p.hideEdgesOnViewport=y.hideEdgesOnViewport,p.textureOnViewport=y.textureOnViewport,p.wheelSensitivity=y.wheelSensitivity,p.motionBlur=y.motionBlur,p.multiClickDebounceTime=y.multiClickDebounceTime,p}}});zo.$id=zo.getElementById;[E1,P1,df,Qs,ko,B1,Zs,Po,O1,Fn,Za].forEach(function(r){Fe(zo,r)});var L1={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},V1={maximal:!1,acyclic:!1},ea=function(e){return e.scratch("breadthfirst")},Bc=function(e,t){return e.scratch("breadthfirst",t)};function ff(r){this.options=Fe({},L1,V1,r)}ff.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=t.nodes().filter(function(fe){return fe.isChildless()}),a=t,i=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,s=!!r.boundingBox,l=e.extent(),u=tr(s?r.boundingBox:{x1:l.x1,y1:l.y1,w:l.w,h:l.h}),c;if(sr(r.roots))c=r.roots;else if(Je(r.roots)){for(var d=[],f=0;f<r.roots.length;f++){var v=r.roots[f],h=e.getElementById(v);d.push(h)}c=e.collection(d)}else if(Be(r.roots))c=e.$(r.roots);else if(i)c=n.roots();else{var m=t.components();c=e.collection();for(var g=function(ce){var be=m[ce],De=be.maxDegree(!1),Me=be.filter(function(we){return we.degree(!1)===De});c=c.add(Me)},p=0;p<m.length;p++)g(p)}var y=[],b={},_=function(ce,be){y[be]==null&&(y[be]=[]);var De=y[be].length;y[be].push(ce),Bc(ce,{index:De,depth:be})},B=function(ce,be){var De=ea(ce),Me=De.depth,we=De.index;y[Me][we]=null,ce.isChildless()&&_(ce,be)};a.bfs({roots:c,directed:r.directed,visit:function(ce,be,De,Me,we){var Se=ce[0],ye=Se.id();Se.isChildless()&&_(Se,we),b[ye]=!0}});for(var k=[],M=0;M<n.length;M++){var O=n[M];b[O.id()]||k.push(O)}var P=function(ce){for(var be=y[ce],De=0;De<be.length;De++){var Me=be[De];if(Me==null){be.splice(De,1),De--;continue}Bc(Me,{depth:ce,index:De})}},L=function(ce,be){for(var De=ea(ce),Me=ce.incomers().filter(function(oe){return oe.isNode()&&t.has(oe)}),we=-1,Se=ce.id(),ye=0;ye<Me.length;ye++){var se=Me[ye],I=ea(se);we=Math.max(we,I.depth)}if(De.depth<=we){if(!r.acyclic&&be[Se])return null;var H=we+1;return B(ce,H),be[Se]=H,!0}return!1};if(i&&o){var F=[],E={},A=function(ce){return F.push(ce)},S=function(){return F.shift()};for(n.forEach(function(fe){return F.push(fe)});F.length>0;){var w=S(),C=L(w,E);if(C)w.outgoers().filter(function(fe){return fe.isNode()&&t.has(fe)}).forEach(A);else if(C===null){Ye("Detected double maximal shift for node `"+w.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var x=0;if(r.avoidOverlap)for(var D=0;D<n.length;D++){var T=n[D],V=T.layoutDimensions(r),z=V.w,j=V.h;x=Math.max(x,z,j)}var U={},Y=function(ce){if(U[ce.id()])return U[ce.id()];for(var be=ea(ce).depth,De=ce.neighborhood(),Me=0,we=0,Se=0;Se<De.length;Se++){var ye=De[Se];if(!(ye.isEdge()||ye.isParent()||!n.has(ye))){var se=ea(ye);if(se!=null){var I=se.index,H=se.depth;if(!(I==null||H==null)){var oe=y[H].length;H<be&&(Me+=I/oe,we++)}}}}return we=Math.max(1,we),Me=Me/we,we===0&&(Me=0),U[ce.id()]=Me,Me},te=function(ce,be){var De=Y(ce),Me=Y(be),we=De-Me;return we===0?cd(ce.id(),be.id()):we};r.depthSort!==void 0&&(te=r.depthSort);for(var J=y.length,ne=0;ne<J;ne++)y[ne].sort(te),P(ne);for(var ae=[],K=0;K<k.length;K++)ae.push(k[K]);var R=function(){for(var ce=0;ce<J;ce++)P(ce)};ae.length&&(y.unshift(ae),J=y.length,R());for(var N=0,G=0;G<J;G++)N=Math.max(y[G].length,N);var W={x:u.x1+u.w/2,y:u.y1+u.h/2},X=n.reduce(function(fe,ce){return function(be){return{w:fe.w===-1?be.w:(fe.w+be.w)/2,h:fe.h===-1?be.h:(fe.h+be.h)/2}}(ce.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),de=Math.max(J===1?0:s?(u.h-r.padding*2-X.h)/(J-1):(u.h-r.padding*2-X.h)/(J+1),x),Te=y.reduce(function(fe,ce){return Math.max(fe,ce.length)},0),xe=function(ce){var be=ea(ce),De=be.depth,Me=be.index;if(r.circle){var we=Math.min(u.w/2/J,u.h/2/J);we=Math.max(we,x);var Se=we*De+we-(J>0&&y[0].length<=3?we/2:0),ye=2*Math.PI/y[De].length*Me;return De===0&&y[0].length===1&&(Se=1),{x:W.x+Se*Math.cos(ye),y:W.y+Se*Math.sin(ye)}}else{var se=y[De].length,I=Math.max(se===1?0:s?(u.w-r.padding*2-X.w)/((r.grid?Te:se)-1):(u.w-r.padding*2-X.w)/((r.grid?Te:se)+1),x),H={x:W.x+(Me+1-(se+1)/2)*I,y:W.y+(De+1-(J+1)/2)*de};return H}};return t.nodes().layoutPositions(this,r,xe),this};var N1={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function hf(r){this.options=Fe({},N1,r)}hf.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,a=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));for(var o=tr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/i.length:e.sweep,u=l/Math.max(1,i.length-1),c,d=0,f=0;f<i.length;f++){var v=i[f],h=v.layoutDimensions(e),m=h.w,g=h.h;d=Math.max(d,m,g)}if(Ce(e.radius)?c=e.radius:i.length<=1?c=0:c=Math.min(o.h,o.w)/2-d,i.length>1&&e.avoidOverlap){d*=1.75;var p=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),b=Math.sqrt(d*d/(p*p+y*y));c=Math.max(b,c)}var _=function(k,M){var O=e.startAngle+M*u*(a?1:-1),P=c*Math.cos(O),L=c*Math.sin(O),F={x:s.x+P,y:s.y+L};return F};return n.nodes().layoutPositions(this,e,_),this};var z1={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function vf(r){this.options=Fe({},z1,r)}vf.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=r.cy,a=e.eles,i=a.nodes().not(":parent"),o=tr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),s={x:o.x1+o.w/2,y:o.y1+o.h/2},l=[],u=0,c=0;c<i.length;c++){var d=i[c],f=void 0;f=e.concentric(d),l.push({value:f,node:d}),d._private.scratch.concentric=f}i.updateStyle();for(var v=0;v<i.length;v++){var h=i[v],m=h.layoutDimensions(e);u=Math.max(u,m.w,m.h)}l.sort(function(X,de){return de.value-X.value});for(var g=e.levelWidth(i),p=[[]],y=p[0],b=0;b<l.length;b++){var _=l[b];if(y.length>0){var B=Math.abs(y[0].value-_.value);B>=g&&(y=[],p.push(y))}y.push(_)}var k=u+e.minNodeSpacing;if(!e.avoidOverlap){var M=p.length>0&&p[0].length>1,O=Math.min(o.w,o.h)/2-k,P=O/(p.length+M?1:0);k=Math.min(k,P)}for(var L=0,F=0;F<p.length;F++){var E=p[F],A=e.sweep===void 0?2*Math.PI-2*Math.PI/E.length:e.sweep,S=E.dTheta=A/Math.max(1,E.length-1);if(E.length>1&&e.avoidOverlap){var w=Math.cos(S)-Math.cos(0),C=Math.sin(S)-Math.sin(0),x=Math.sqrt(k*k/(w*w+C*C));L=Math.max(x,L)}E.r=L,L+=k}if(e.equidistant){for(var D=0,T=0,V=0;V<p.length;V++){var z=p[V],j=z.r-T;D=Math.max(D,j)}T=0;for(var U=0;U<p.length;U++){var Y=p[U];U===0&&(T=Y.r),Y.r=T,T+=D}}for(var te={},J=0;J<p.length;J++)for(var ne=p[J],ae=ne.dTheta,K=ne.r,R=0;R<ne.length;R++){var N=ne[R],G=e.startAngle+(t?1:-1)*ae*R,W={x:s.x+K*Math.cos(G),y:s.y+K*Math.sin(G)};te[N.node.id()]=W}return a.nodes().layoutPositions(this,e,function(X){var de=X.id();return te[de]}),this};var Ls,j1={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function is(r){this.options=Fe({},j1,r),this.options.layout=this;var e=this.options.eles.nodes(),t=this.options.eles.edges(),n=t.filter(function(a){var i=a.source().data("id"),o=a.target().data("id"),s=e.some(function(u){return u.data("id")===i}),l=e.some(function(u){return u.data("id")===o});return!s||!l});this.options.eles=this.options.eles.not(n)}is.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Ls=!0:Ls=!1;var n=G1(e,t,r);Ls&&H1(n),r.randomize&&W1(n);var a=Kr(),i=function(){K1(n,e,r),r.fit===!0&&e.fit(r.padding)},o=function(f){return!(t.stopped||f>=r.numIter||(U1(n,r),n.temperature=n.temperature*r.coolingFactor,n.temperature<r.minTemp))},s=function(){if(r.animate===!0||r.animate===!1)i(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var f=r.eles.nodes(),v=pf(n,r,f);f.layoutPositions(t,r,v)}},l=0,u=!0;if(r.animate===!0){var c=function d(){for(var f=0;u&&f<r.refresh;)u=o(l),l++,f++;if(!u)Rc(n,r),s();else{var v=Kr();v-a>=r.animationThreshold&&i(),Ro(d)}};c()}else{for(;u;)u=o(l),l++;Rc(n,r),s()}return this};is.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};is.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var G1=function(e,t,n){for(var a=n.eles.edges(),i=n.eles.nodes(),o=tr(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:i.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:a.size(),temperature:n.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},l=n.eles.components(),u={},c=0;c<l.length;c++)for(var d=l[c],f=0;f<d.length;f++){var v=d[f];u[v.id()]=c}for(var c=0;c<s.nodeSize;c++){var h=i[c],m=h.layoutDimensions(n),g={};g.isLocked=h.locked(),g.id=h.data("id"),g.parentId=h.data("parent"),g.cmptId=u[h.id()],g.children=[],g.positionX=h.position("x"),g.positionY=h.position("y"),g.offsetX=0,g.offsetY=0,g.height=m.w,g.width=m.h,g.maxX=g.positionX+g.width/2,g.minX=g.positionX-g.width/2,g.maxY=g.positionY+g.height/2,g.minY=g.positionY-g.height/2,g.padLeft=parseFloat(h.style("padding")),g.padRight=parseFloat(h.style("padding")),g.padTop=parseFloat(h.style("padding")),g.padBottom=parseFloat(h.style("padding")),g.nodeRepulsion=st(n.nodeRepulsion)?n.nodeRepulsion(h):n.nodeRepulsion,s.layoutNodes.push(g),s.idToIndex[g.id]=c}for(var p=[],y=0,b=-1,_=[],c=0;c<s.nodeSize;c++){var h=s.layoutNodes[c],B=h.parentId;B!=null?s.layoutNodes[s.idToIndex[B]].children.push(h.id):(p[++b]=h.id,_.push(h.id))}for(s.graphSet.push(_);y<=b;){var k=p[y++],M=s.idToIndex[k],v=s.layoutNodes[M],O=v.children;if(O.length>0){s.graphSet.push(O);for(var c=0;c<O.length;c++)p[++b]=O[c]}}for(var c=0;c<s.graphSet.length;c++)for(var P=s.graphSet[c],f=0;f<P.length;f++){var L=s.idToIndex[P[f]];s.indexToGraph[L]=c}for(var c=0;c<s.edgeSize;c++){var F=a[c],E={};E.id=F.data("id"),E.sourceId=F.data("source"),E.targetId=F.data("target");var A=st(n.idealEdgeLength)?n.idealEdgeLength(F):n.idealEdgeLength,S=st(n.edgeElasticity)?n.edgeElasticity(F):n.edgeElasticity,w=s.idToIndex[E.sourceId],C=s.idToIndex[E.targetId],x=s.indexToGraph[w],D=s.indexToGraph[C];if(x!=D){for(var T=$1(E.sourceId,E.targetId,s),V=s.graphSet[T],z=0,g=s.layoutNodes[w];V.indexOf(g.id)===-1;)g=s.layoutNodes[s.idToIndex[g.parentId]],z++;for(g=s.layoutNodes[C];V.indexOf(g.id)===-1;)g=s.layoutNodes[s.idToIndex[g.parentId]],z++;A*=z*n.nestingFactor}E.idealLength=A,E.elasticity=S,s.layoutEdges.push(E)}return s},$1=function(e,t,n){var a=q1(e,t,0,n);return 2>a.count?0:a.graph},q1=function r(e,t,n,a){var i=a.graphSet[n];if(-1<i.indexOf(e)&&-1<i.indexOf(t))return{count:2,graph:n};for(var o=0,s=0;s<i.length;s++){var l=i[s],u=a.idToIndex[l],c=a.layoutNodes[u].children;if(c.length!==0){var d=a.indexToGraph[a.idToIndex[c[0]]],f=r(e,t,d,a);if(f.count!==0)if(f.count===1){if(o++,o===2)break}else return f}}return{count:o,graph:n}},H1,W1=function(e,t){for(var n=e.clientWidth,a=e.clientHeight,i=0;i<e.nodeSize;i++){var o=e.layoutNodes[i];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*n,o.positionY=Math.random()*a)}},pf=function(e,t,n){var a=e.boundingBox,i={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(o){var s=e.layoutNodes[e.idToIndex[o.data("id")]];i.x1=Math.min(i.x1,s.positionX),i.x2=Math.max(i.x2,s.positionX),i.y1=Math.min(i.y1,s.positionY),i.y2=Math.max(i.y2,s.positionY)}),i.w=i.x2-i.x1,i.h=i.y2-i.y1),function(o,s){var l=e.layoutNodes[e.idToIndex[o.data("id")]];if(t.boundingBox){var u=(l.positionX-i.x1)/i.w,c=(l.positionY-i.y1)/i.h;return{x:a.x1+u*a.w,y:a.y1+c*a.h}}else return{x:l.positionX,y:l.positionY}}},K1=function(e,t,n){var a=n.layout,i=n.eles.nodes(),o=pf(e,n,i);i.positions(o),e.ready!==!0&&(e.ready=!0,a.one("layoutready",n.ready),a.emit({type:"layoutready",layout:this}))},U1=function(e,t,n){X1(e,t),Z1(e),J1(e,t),eC(e),tC(e)},X1=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var a=e.graphSet[n],i=a.length,o=0;o<i;o++)for(var s=e.layoutNodes[e.idToIndex[a[o]]],l=o+1;l<i;l++){var u=e.layoutNodes[e.idToIndex[a[l]]];Y1(s,u,e,t)}},Ic=function(e){return-e+2*e*Math.random()},Y1=function(e,t,n,a){var i=e.cmptId,o=t.cmptId;if(!(i!==o&&!n.isCompound)){var s=t.positionX-e.positionX,l=t.positionY-e.positionY,u=1;s===0&&l===0&&(s=Ic(u),l=Ic(u));var c=Q1(e,t,s,l);if(c>0)var d=a.nodeOverlap*c,f=Math.sqrt(s*s+l*l),v=d*s/f,h=d*l/f;else var m=jo(e,s,l),g=jo(t,-1*s,-1*l),p=g.x-m.x,y=g.y-m.y,b=p*p+y*y,f=Math.sqrt(b),d=(e.nodeRepulsion+t.nodeRepulsion)/b,v=d*p/f,h=d*y/f;e.isLocked||(e.offsetX-=v,e.offsetY-=h),t.isLocked||(t.offsetX+=v,t.offsetY+=h)}},Q1=function(e,t,n,a){if(n>0)var i=e.maxX-t.minX;else var i=t.maxX-e.minX;if(a>0)var o=e.maxY-t.minY;else var o=t.maxY-e.minY;return i>=0&&o>=0?Math.sqrt(i*i+o*o):0},jo=function(e,t,n){var a=e.positionX,i=e.positionY,o=e.height||1,s=e.width||1,l=n/t,u=o/s,c={};return t===0&&0<n||t===0&&0>n?(c.x=a,c.y=i+o/2,c):0<t&&-1*u<=l&&l<=u?(c.x=a+s/2,c.y=i+s*n/2/t,c):0>t&&-1*u<=l&&l<=u?(c.x=a-s/2,c.y=i-s*n/2/t,c):0<n&&(l<=-1*u||l>=u)?(c.x=a+o*t/2/n,c.y=i+o/2,c):(0>n&&(l<=-1*u||l>=u)&&(c.x=a-o*t/2/n,c.y=i-o/2),c)},Z1=function(e,t){for(var n=0;n<e.edgeSize;n++){var a=e.layoutEdges[n],i=e.idToIndex[a.sourceId],o=e.layoutNodes[i],s=e.idToIndex[a.targetId],l=e.layoutNodes[s],u=l.positionX-o.positionX,c=l.positionY-o.positionY;if(!(u===0&&c===0)){var d=jo(o,u,c),f=jo(l,-1*u,-1*c),v=f.x-d.x,h=f.y-d.y,m=Math.sqrt(v*v+h*h),g=Math.pow(a.idealLength-m,2)/a.elasticity;if(m!==0)var p=g*v/m,y=g*h/m;else var p=0,y=0;o.isLocked||(o.offsetX+=p,o.offsetY+=y),l.isLocked||(l.offsetX-=p,l.offsetY-=y)}}},J1=function(e,t){if(t.gravity!==0)for(var n=1,a=0;a<e.graphSet.length;a++){var i=e.graphSet[a],o=i.length;if(a===0)var s=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[i[0]]],c=e.layoutNodes[e.idToIndex[u.parentId]],s=c.positionX,l=c.positionY;for(var d=0;d<o;d++){var f=e.layoutNodes[e.idToIndex[i[d]]];if(!f.isLocked){var v=s-f.positionX,h=l-f.positionY,m=Math.sqrt(v*v+h*h);if(m>n){var g=t.gravity*v/m,p=t.gravity*h/m;f.offsetX+=g,f.offsetY+=p}}}}},eC=function(e,t){var n=[],a=0,i=-1;for(n.push.apply(n,e.graphSet[0]),i+=e.graphSet[0].length;a<=i;){var o=n[a++],s=e.idToIndex[o],l=e.layoutNodes[s],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,d=l.offsetY,f=0;f<u.length;f++){var v=e.layoutNodes[e.idToIndex[u[f]]];v.offsetX+=c,v.offsetY+=d,n[++i]=u[f]}l.offsetX=0,l.offsetY=0}}},tC=function(e,t){for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];0<a.children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];if(!(0<a.children.length||a.isLocked)){var i=rC(a.offsetX,a.offsetY,e.temperature);a.positionX+=i.x,a.positionY+=i.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,nC(a,e)}}for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];0<a.children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},rC=function(e,t,n){var a=Math.sqrt(e*e+t*t);if(a>n)var i={x:n*e/a,y:n*t/a};else var i={x:e,y:t};return i},nC=function r(e,t){var n=e.parentId;if(n!=null){var a=t.layoutNodes[t.idToIndex[n]],i=!1;if((a.maxX==null||e.maxX+a.padRight>a.maxX)&&(a.maxX=e.maxX+a.padRight,i=!0),(a.minX==null||e.minX-a.padLeft<a.minX)&&(a.minX=e.minX-a.padLeft,i=!0),(a.maxY==null||e.maxY+a.padBottom>a.maxY)&&(a.maxY=e.maxY+a.padBottom,i=!0),(a.minY==null||e.minY-a.padTop<a.minY)&&(a.minY=e.minY-a.padTop,i=!0),i)return r(a,t)}},Rc=function(e,t){for(var n=e.layoutNodes,a=[],i=0;i<n.length;i++){var o=n[i],s=o.cmptId,l=a[s]=a[s]||[];l.push(o)}for(var u=0,i=0;i<a.length;i++){var c=a[i];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var d=0;d<c.length;d++){var f=c[d];c.x1=Math.min(c.x1,f.positionX-f.width/2),c.x2=Math.max(c.x2,f.positionX+f.width/2),c.y1=Math.min(c.y1,f.positionY-f.height/2),c.y2=Math.max(c.y2,f.positionY+f.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}a.sort(function(y,b){return b.w*b.h-y.w*y.h});for(var v=0,h=0,m=0,g=0,p=Math.sqrt(u)*e.clientWidth/e.clientHeight,i=0;i<a.length;i++){var c=a[i];if(c){for(var d=0;d<c.length;d++){var f=c[d];f.isLocked||(f.positionX+=v-c.x1,f.positionY+=h-c.y1)}v+=c.w+t.componentSpacing,m+=c.w+t.componentSpacing,g=Math.max(g,c.h),m>p&&(h+=g+t.componentSpacing,v=0,m=0,g=0)}}},aC={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function gf(r){this.options=Fe({},aC,r)}gf.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));var i=tr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(i.h===0||i.w===0)n.nodes().layoutPositions(this,e,function(U){return{x:i.x1,y:i.y1}});else{var o=a.size(),s=Math.sqrt(o*i.h/i.w),l=Math.round(s),u=Math.round(i.w/i.h*s),c=function(Y){if(Y==null)return Math.min(l,u);var te=Math.min(l,u);te==l?l=Y:u=Y},d=function(Y){if(Y==null)return Math.max(l,u);var te=Math.max(l,u);te==l?l=Y:u=Y},f=e.rows,v=e.cols!=null?e.cols:e.columns;if(f!=null&&v!=null)l=f,u=v;else if(f!=null&&v==null)l=f,u=Math.ceil(o/l);else if(f==null&&v!=null)u=v,l=Math.ceil(o/u);else if(u*l>o){var h=c(),m=d();(h-1)*m>=o?c(h-1):(m-1)*h>=o&&d(m-1)}else for(;u*l<o;){var g=c(),p=d();(p+1)*g>=o?d(p+1):c(g+1)}var y=i.w/u,b=i.h/l;if(e.condense&&(y=0,b=0),e.avoidOverlap)for(var _=0;_<a.length;_++){var B=a[_],k=B._private.position;(k.x==null||k.y==null)&&(k.x=0,k.y=0);var M=B.layoutDimensions(e),O=e.avoidOverlapPadding,P=M.w+O,L=M.h+O;y=Math.max(y,P),b=Math.max(b,L)}for(var F={},E=function(Y,te){return!!F["c-"+Y+"-"+te]},A=function(Y,te){F["c-"+Y+"-"+te]=!0},S=0,w=0,C=function(){w++,w>=u&&(w=0,S++)},x={},D=0;D<a.length;D++){var T=a[D],V=e.position(T);if(V&&(V.row!==void 0||V.col!==void 0)){var z={row:V.row,col:V.col};if(z.col===void 0)for(z.col=0;E(z.row,z.col);)z.col++;else if(z.row===void 0)for(z.row=0;E(z.row,z.col);)z.row++;x[T.id()]=z,A(z.row,z.col)}}var j=function(Y,te){var J,ne;if(Y.locked()||Y.isParent())return!1;var ae=x[Y.id()];if(ae)J=ae.col*y+y/2+i.x1,ne=ae.row*b+b/2+i.y1;else{for(;E(S,w);)C();J=w*y+y/2+i.x1,ne=S*b+b/2+i.y1,A(S,w),C()}return{x:J,y:ne}};a.layoutPositions(this,e,j)}return this};var iC={ready:function(){},stop:function(){}};function El(r){this.options=Fe({},iC,r)}El.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};El.prototype.stop=function(){return this};var oC={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function mf(r){this.options=Fe({},oC,r)}mf.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),n=st(r.positions);function a(i){if(r.positions==null)return cg(i.position());if(n)return r.positions(i);var o=r.positions[i._private.data.id];return o??null}return t.layoutPositions(this,r,function(i,o){var s=a(i);return i.locked()||s==null?!1:s}),this};var sC={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function yf(r){this.options=Fe({},sC,r)}yf.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=tr(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),a=function(o,s){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return t.nodes().layoutPositions(this,r,a),this};var lC=[{name:"breadthfirst",impl:ff},{name:"circle",impl:hf},{name:"concentric",impl:vf},{name:"cose",impl:is},{name:"grid",impl:gf},{name:"null",impl:El},{name:"preset",impl:mf},{name:"random",impl:yf}];function Cf(r){this.options=r,this.notifications=0}var Oc=function(){},Fc=function(){throw new Error("A headless instance can not render images")};Cf.prototype={recalculateRenderedStyle:Oc,notify:function(){this.notifications++},init:Oc,isHeadless:function(){return!0},png:Fc,jpg:Fc};var Tl={};Tl.arrowShapeWidth=.3;Tl.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(u,c,d,f,v,h,m){var g=v.x-d/2-m,p=v.x+d/2+m,y=v.y-d/2-m,b=v.y+d/2+m,_=g<=u&&u<=p&&y<=c&&c<=b;return _},n=function(u,c,d,f,v){var h=u*Math.cos(f)-c*Math.sin(f),m=u*Math.sin(f)+c*Math.cos(f),g=h*d,p=m*d,y=g+v.x,b=p+v.y;return{x:y,y:b}},a=function(u,c,d,f){for(var v=[],h=0;h<u.length;h+=2){var m=u[h],g=u[h+1];v.push(n(m,g,c,d,f))}return v},i=function(u){for(var c=[],d=0;d<u.length;d++){var f=u[d];c.push(f.x,f.y)}return c},o=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},s=function(u,c){Be(c)&&(c=r[c]),r[u]=Fe({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(f,v,h,m,g,p){var y=i(a(this.points,h+2*p,m,g)),b=er(f,v,y);return b},roughCollide:t,draw:function(f,v,h,m){var g=a(this.points,v,h,m);e.arrowShapeImpl("polygon")(f,g)},spacing:function(f){return 0},gap:o},c)};s("none",{collide:Oo,roughCollide:Oo,draw:dl,spacing:Wu,gap:Wu}),s("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),s("arrow","triangle"),s("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(u,c,d,f,v){var h=a(this.points,c,d,f),m=this.controlPoint,g=n(m[0],m[1],c,d,f);e.arrowShapeImpl(this.name)(u,h,g)},gap:function(u){return o(u)*.8}}),s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,d,f,v,h,m){var g=i(a(this.points,d+2*m,f,v)),p=i(a(this.pointsTee,d+2*m,f,v)),y=er(u,c,g)||er(u,c,p);return y},draw:function(u,c,d,f,v){var h=a(this.points,c,d,f),m=a(this.pointsTee,c,d,f);e.arrowShapeImpl(this.name)(u,h,m)}}),s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,d,f,v,h,m){var g=v,p=Math.pow(g.x-u,2)+Math.pow(g.y-c,2)<=Math.pow((d+2*m)*this.radius,2),y=i(a(this.points,d+2*m,f,v));return er(u,c,y)||p},draw:function(u,c,d,f,v){var h=a(this.pointsTr,c,d,f);e.arrowShapeImpl(this.name)(u,h,f.x,f.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var d=this.baseCrossLinePts.slice(),f=c/u,v=3,h=5;return d[v]=d[v]-f,d[h]=d[h]-f,d},collide:function(u,c,d,f,v,h,m){var g=i(a(this.points,d+2*m,f,v)),p=i(a(this.crossLinePts(d,h),d+2*m,f,v)),y=er(u,c,g)||er(u,c,p);return y},draw:function(u,c,d,f,v){var h=a(this.points,c,d,f),m=a(this.crossLinePts(c,v),c,d,f);e.arrowShapeImpl(this.name)(u,h,m)}}),s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return o(u)*.525}}),s("circle",{radius:.15,collide:function(u,c,d,f,v,h,m){var g=v,p=Math.pow(g.x-u,2)+Math.pow(g.y-c,2)<=Math.pow((d+2*m)*this.radius,2);return p},draw:function(u,c,d,f,v){e.arrowShapeImpl(this.name)(u,f.x,f.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Vn={};Vn.projectIntoViewport=function(r,e){var t=this.cy,n=this.findContainerClientCoords(),a=n[0],i=n[1],o=n[4],s=t.pan(),l=t.zoom(),u=((r-a)/o-s.x)/l,c=((e-i)/o-s.y)/l;return[u,c]};Vn.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=this.cy.window().getComputedStyle(r),n=function(p){return parseFloat(t.getPropertyValue(p))},a={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},i={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},o=r.clientWidth,s=r.clientHeight,l=a.left+a.right,u=a.top+a.bottom,c=i.left+i.right,d=e.width/(o+c),f=o-l,v=s-u,h=e.left+a.left+i.left,m=e.top+a.top+i.top;return this.containerBB=[h,m,f,v,d]};Vn.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Vn.findNearestElement=function(r,e,t,n){return this.findNearestElements(r,e,t,n)[0]};Vn.findNearestElements=function(r,e,t,n){var a=this,i=this,o=i.getCachedZSortedEles(),s=[],l=i.cy.zoom(),u=i.cy.hasCompoundNodes(),c=(n?24:8)/l,d=(n?8:2)/l,f=(n?8:2)/l,v=1/0,h,m;t&&(o=o.interactive);function g(M,O){if(M.isNode()){if(m)return;m=M,s.push(M)}if(M.isEdge()&&(O==null||O<v))if(h){if(h.pstyle("z-compound-depth").value===M.pstyle("z-compound-depth").value&&h.pstyle("z-compound-depth").value===M.pstyle("z-compound-depth").value){for(var P=0;P<s.length;P++)if(s[P].isEdge()){s[P]=M,h=M,v=O??v;break}}}else s.push(M),h=M,v=O??v}function p(M){var O=M.outerWidth()+2*d,P=M.outerHeight()+2*d,L=O/2,F=P/2,E=M.position(),A=M.pstyle("corner-radius").value==="auto"?"auto":M.pstyle("corner-radius").pfValue,S=M._private.rscratch;if(E.x-L<=r&&r<=E.x+L&&E.y-F<=e&&e<=E.y+F){var w=i.nodeShapes[a.getNodeShape(M)];if(w.checkPoint(r,e,0,O,P,E.x,E.y,A,S))return g(M,0),!0}}function y(M){var O=M._private,P=O.rscratch,L=M.pstyle("width").pfValue,F=M.pstyle("arrow-scale").value,E=L/2+c,A=E*E,S=E*2,D=O.source,T=O.target,w;if(P.edgeType==="segments"||P.edgeType==="straight"||P.edgeType==="haystack"){for(var C=P.allpts,x=0;x+3<C.length;x+=2)if(_g(r,e,C[x],C[x+1],C[x+2],C[x+3],S)&&A>(w=Dg(r,e,C[x],C[x+1],C[x+2],C[x+3])))return g(M,w),!0}else if(P.edgeType==="bezier"||P.edgeType==="multibezier"||P.edgeType==="self"||P.edgeType==="compound"){for(var C=P.allpts,x=0;x+5<P.allpts.length;x+=4)if(Sg(r,e,C[x],C[x+1],C[x+2],C[x+3],C[x+4],C[x+5],S)&&A>(w=Mg(r,e,C[x],C[x+1],C[x+2],C[x+3],C[x+4],C[x+5])))return g(M,w),!0}for(var D=D||O.source,T=T||O.target,V=a.getArrowWidth(L,F),z=[{name:"source",x:P.arrowStartX,y:P.arrowStartY,angle:P.srcArrowAngle},{name:"target",x:P.arrowEndX,y:P.arrowEndY,angle:P.tgtArrowAngle},{name:"mid-source",x:P.midX,y:P.midY,angle:P.midsrcArrowAngle},{name:"mid-target",x:P.midX,y:P.midY,angle:P.midtgtArrowAngle}],x=0;x<z.length;x++){var j=z[x],U=i.arrowShapes[M.pstyle(j.name+"-arrow-shape").value],Y=M.pstyle("width").pfValue;if(U.roughCollide(r,e,V,j.angle,{x:j.x,y:j.y},Y,c)&&U.collide(r,e,V,j.angle,{x:j.x,y:j.y},Y,c))return g(M),!0}u&&s.length>0&&(p(D),p(T))}function b(M,O,P){return xr(M,O,P)}function _(M,O){var P=M._private,L=f,F;O?F=O+"-":F="",M.boundingBox();var E=P.labelBounds[O||"main"],A=M.pstyle(F+"label").value,S=M.pstyle("text-events").strValue==="yes";if(!(!S||!A)){var w=b(P.rscratch,"labelX",O),C=b(P.rscratch,"labelY",O),x=b(P.rscratch,"labelAngle",O),D=M.pstyle(F+"text-margin-x").pfValue,T=M.pstyle(F+"text-margin-y").pfValue,V=E.x1-L-D,z=E.x2+L-D,j=E.y1-L-T,U=E.y2+L-T;if(x){var Y=Math.cos(x),te=Math.sin(x),J=function(W,X){return W=W-w,X=X-C,{x:W*Y-X*te+w,y:W*te+X*Y+C}},ne=J(V,j),ae=J(V,U),K=J(z,j),R=J(z,U),N=[ne.x+D,ne.y+T,K.x+D,K.y+T,R.x+D,R.y+T,ae.x+D,ae.y+T];if(er(r,e,N))return g(M),!0}else if(ca(E,r,e))return g(M),!0}}for(var B=o.length-1;B>=0;B--){var k=o[B];k.isNode()?p(k)||_(k):y(k)||_(k)||_(k,"source")||_(k,"target")}return s};Vn.getAllInBox=function(r,e,t,n){var a=this.getCachedZSortedEles().interactive,i=[],o=Math.min(r,t),s=Math.max(r,t),l=Math.min(e,n),u=Math.max(e,n);r=o,t=s,e=l,n=u;for(var c=tr({x1:r,y1:e,x2:t,y2:n}),d=0;d<a.length;d++){var f=a[d];if(f.isNode()){var v=f,h=v.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});vl(c,h)&&!Md(h,c)&&i.push(v)}else{var m=f,g=m._private,p=g.rscratch;if(p.startX!=null&&p.startY!=null&&!ca(c,p.startX,p.startY)||p.endX!=null&&p.endY!=null&&!ca(c,p.endX,p.endY))continue;if(p.edgeType==="bezier"||p.edgeType==="multibezier"||p.edgeType==="self"||p.edgeType==="compound"||p.edgeType==="segments"||p.edgeType==="haystack"){for(var y=g.rstyle.bezierPts||g.rstyle.linePts||g.rstyle.haystackPts,b=!0,_=0;_<y.length;_++)if(!xg(c,y[_])){b=!1;break}b&&i.push(m)}else(p.edgeType==="haystack"||p.edgeType==="straight")&&i.push(m)}}return i};var Go={};Go.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",n=e.edgeType==="bezier",a=e.edgeType==="multibezier",i=e.edgeType==="segments",o=e.edgeType==="compound",s=e.edgeType==="self",l,u,c,d,f,v,p,y;if(t?(c=e.haystackPts[0],d=e.haystackPts[1],f=e.haystackPts[2],v=e.haystackPts[3]):(c=e.arrowStartX,d=e.arrowStartY,f=e.arrowEndX,v=e.arrowEndY),p=e.midX,y=e.midY,i)l=c-e.segpts[0],u=d-e.segpts[1];else if(a||o||s||n){var h=e.allpts,m=_t(h[0],h[2],h[4],.1),g=_t(h[1],h[3],h[5],.1);l=c-m,u=d-g}else l=c-p,u=d-y;e.srcArrowAngle=co(l,u);var p=e.midX,y=e.midY;if(t&&(p=(c+f)/2,y=(d+v)/2),l=f-c,u=v-d,i){var h=e.allpts;if(h.length/2%2===0){var b=h.length/2,_=b-2;l=h[b]-h[_],u=h[b+1]-h[_+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var b=h.length/2-1,_=b-2;l=h[b]-h[_],u=h[b+1]-h[_+1]}}else if(a||o||s){var h=e.allpts,B=e.ctrlpts,k,M,O,P;if(B.length/2%2===0){var L=h.length/2-1,F=L+2,E=F+2;k=_t(h[L],h[F],h[E],0),M=_t(h[L+1],h[F+1],h[E+1],0),O=_t(h[L],h[F],h[E],1e-4),P=_t(h[L+1],h[F+1],h[E+1],1e-4)}else{var F=h.length/2-1,L=F-2,E=F+2;k=_t(h[L],h[F],h[E],.4999),M=_t(h[L+1],h[F+1],h[E+1],.4999),O=_t(h[L],h[F],h[E],.5),P=_t(h[L+1],h[F+1],h[E+1],.5)}l=O-k,u=P-M}if(e.midtgtArrowAngle=co(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,i){var h=e.allpts;if(h.length/2%2!==0){if(!e.isRound){var b=h.length/2-1,A=b+2;l=-(h[A]-h[b]),u=-(h[A+1]-h[b+1])}}}if(e.midsrcArrowAngle=co(l,u),i)l=f-e.segpts[e.segpts.length-2],u=v-e.segpts[e.segpts.length-1];else if(a||o||s||n){var h=e.allpts,S=h.length,m=_t(h[S-6],h[S-4],h[S-2],.9),g=_t(h[S-5],h[S-3],h[S-1],.9);l=f-m,u=v-g}else l=f-p,u=v-y;e.tgtArrowAngle=co(l,u)};Go.getArrowWidth=Go.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[r+", "+e];return n||(n=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=n,n)};var Js,el,Rr={},fr={},Lc,Vc,Pn,Ao,Wr,En,kn,Ir,ta,bo,bf,wf,tl,rl,Nc,zc=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},uC=function(e,t){t.x=e.x*-1,t.y=e.y*-1,t.nx=e.nx*-1,t.ny=e.ny*-1,t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},cC=function(e,t,n,a,i){if(e!==Nc?zc(t,e,Rr):uC(fr,Rr),zc(t,n,fr),Lc=Rr.nx*fr.ny-Rr.ny*fr.nx,Vc=Rr.nx*fr.nx-Rr.ny*-fr.ny,Wr=Math.asin(Math.max(-1,Math.min(1,Lc))),Math.abs(Wr)<1e-6){Js=t.x,el=t.y,kn=ta=0;return}Pn=1,Ao=!1,Vc<0?Wr<0?Wr=Math.PI+Wr:(Wr=Math.PI-Wr,Pn=-1,Ao=!0):Wr>0&&(Pn=-1,Ao=!0),t.radius!==void 0?ta=t.radius:ta=a,En=Wr/2,bo=Math.min(Rr.len/2,fr.len/2),i?(Ir=Math.abs(Math.cos(En)*ta/Math.sin(En)),Ir>bo?(Ir=bo,kn=Math.abs(Ir*Math.sin(En)/Math.cos(En))):kn=ta):(Ir=Math.min(bo,ta),kn=Math.abs(Ir*Math.sin(En)/Math.cos(En))),tl=t.x+fr.nx*Ir,rl=t.y+fr.ny*Ir,Js=tl-fr.ny*kn*Pn,el=rl+fr.nx*kn*Pn,bf=t.x+Rr.nx*Ir,wf=t.y+Rr.ny*Ir,Nc=t};function xf(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function Ml(r,e,t,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(cC(r,e,t,n,a),{cx:Js,cy:el,radius:kn,startX:bf,startY:wf,stopX:tl,stopY:rl,startAngle:Rr.ang+Math.PI/2*Pn,endAngle:fr.ang-Math.PI/2*Pn,counterClockwise:Ao})}var Nt={};Nt.findMidptPtsEtc=function(r,e){var t=e.posPts,n=e.intersectionPts,a=e.vectorNormInverse,i,o=r.pstyle("source-endpoint"),s=r.pstyle("target-endpoint"),l=o.units!=null&&s.units!=null,u=function(B,k,M,O){var P=O-k,L=M-B,F=Math.sqrt(L*L+P*P);return{x:-P/F,y:L/F}},c=r.pstyle("edge-distances").value;switch(c){case"node-position":i=t;break;case"intersection":i=n;break;case"endpoints":{if(l){var d=this.manualEndptToPx(r.source()[0],o),f=dt(d,2),v=f[0],h=f[1],m=this.manualEndptToPx(r.target()[0],s),g=dt(m,2),p=g[0],y=g[1],b={x1:v,y1:h,x2:p,y2:y};a=u(v,h,p,y),i=b}else Ye("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),i=n;break}}return{midptPts:i,vectorNormInverse:a}};Nt.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],n=t._private,a=n.rscratch;if(!a.haystack){var i=Math.random()*2*Math.PI;a.source={x:Math.cos(i),y:Math.sin(i)},i=Math.random()*2*Math.PI,a.target={x:Math.cos(i),y:Math.sin(i)}}var o=n.source,s=n.target,l=o.position(),u=s.position(),c=o.width(),d=s.width(),f=o.height(),v=s.height(),h=t.pstyle("haystack-radius").value,m=h/2;a.haystackPts=a.allpts=[a.source.x*c*m+l.x,a.source.y*f*m+l.y,a.target.x*d*m+u.x,a.target.y*v*m+u.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};Nt.findSegmentsPoints=function(r,e){var t=r._private.rscratch,n=r.pstyle("segment-weights"),a=r.pstyle("segment-distances"),i=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),s=Math.min(n.pfValue.length,a.pfValue.length),l=i.pfValue[i.pfValue.length-1],u=o.pfValue[o.pfValue.length-1];t.edgeType="segments",t.segpts=[],t.radii=[],t.isArcRadius=[];for(var c=0;c<s;c++){var d=n.pfValue[c],f=a.pfValue[c],v=1-d,h=d,m=this.findMidptPtsEtc(r,e),g=m.midptPts,p=m.vectorNormInverse,y={x:g.x1*v+g.x2*h,y:g.y1*v+g.y2*h};t.segpts.push(y.x+p.x*f,y.y+p.y*f),t.radii.push(i.pfValue[c]!==void 0?i.pfValue[c]:l),t.isArcRadius.push((o.pfValue[c]!==void 0?o.pfValue[c]:u)==="arc-radius")}};Nt.findLoopPoints=function(r,e,t,n){var a=r._private.rscratch,i=e.dirCounts,o=e.srcPos,s=r.pstyle("control-point-distances"),l=s?s.pfValue[0]:void 0,u=r.pstyle("loop-direction").pfValue,c=r.pstyle("loop-sweep").pfValue,d=r.pstyle("control-point-step-size").pfValue;a.edgeType="self";var f=t,v=d;n&&(f=0,v=l);var h=u-Math.PI/2,m=h-c/2,g=h+c/2,p=u+"_"+c;f=i[p]===void 0?i[p]=0:++i[p],a.ctrlpts=[o.x+Math.cos(m)*1.4*v*(f/3+1),o.y+Math.sin(m)*1.4*v*(f/3+1),o.x+Math.cos(g)*1.4*v*(f/3+1),o.y+Math.sin(g)*1.4*v*(f/3+1)]};Nt.findCompoundLoopPoints=function(r,e,t,n){var a=r._private.rscratch;a.edgeType="compound";var i=e.srcPos,o=e.tgtPos,s=e.srcW,l=e.srcH,u=e.tgtW,c=e.tgtH,d=r.pstyle("control-point-step-size").pfValue,f=r.pstyle("control-point-distances"),v=f?f.pfValue[0]:void 0,h=t,m=d;n&&(h=0,m=v);var g=50,p={x:i.x-s/2,y:i.y-l/2},y={x:o.x-u/2,y:o.y-c/2},b={x:Math.min(p.x,y.x),y:Math.min(p.y,y.y)},_=.5,B=Math.max(_,Math.log(s*.01)),k=Math.max(_,Math.log(u*.01));a.ctrlpts=[b.x,b.y-(1+Math.pow(g,1.12)/100)*m*(h/3+1)*B,b.x-(1+Math.pow(g,1.12)/100)*m*(h/3+1)*k,b.y]};Nt.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};Nt.findBezierPoints=function(r,e,t,n,a){var i=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,s=r.pstyle("control-point-distances"),l=r.pstyle("control-point-weights"),u=s&&l?Math.min(s.value.length,l.value.length):1,c=s?s.pfValue[0]:void 0,d=l.value[0],f=n;i.edgeType=f?"multibezier":"bezier",i.ctrlpts=[];for(var v=0;v<u;v++){var h=(.5-e.eles.length/2+t)*o*(a?-1:1),m=void 0,g=Ed(h);f&&(c=s?s.pfValue[v]:o,d=l.value[v]),n?m=c:m=c!==void 0?g*c:void 0;var p=m!==void 0?m:h,y=1-d,b=d,_=this.findMidptPtsEtc(r,e),B=_.midptPts,k=_.vectorNormInverse,M={x:B.x1*y+B.x2*b,y:B.y1*y+B.y2*b};i.ctrlpts.push(M.x+k.x*p,M.y+k.y*p)}};Nt.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var n="vertical",a="horizontal",i="leftward",o="rightward",s="downward",l="upward",u="auto",c=e.posPts,d=e.srcW,f=e.srcH,v=e.tgtW,h=e.tgtH,m=r.pstyle("edge-distances").value,g=m!=="node-position",p=r.pstyle("taxi-direction").value,y=p,b=r.pstyle("taxi-turn"),_=b.units==="%",B=b.pfValue,k=B<0,M=r.pstyle("taxi-turn-min-distance").pfValue,O=g?(d+v)/2:0,P=g?(f+h)/2:0,L=c.x2-c.x1,F=c.y2-c.y1,E=function(le,ve){return le>0?Math.max(le-ve,0):Math.min(le+ve,0)},A=E(L,O),S=E(F,P),w=!1;y===u?p=Math.abs(A)>Math.abs(S)?a:n:y===l||y===s?(p=n,w=!0):(y===i||y===o)&&(p=a,w=!0);var C=p===n,x=C?S:A,D=C?F:L,T=Ed(D),V=!1;!(w&&(_||k))&&(y===s&&D<0||y===l&&D>0||y===i&&D>0||y===o&&D<0)&&(T*=-1,x=T*Math.abs(x),V=!0);var z;if(_){var j=B<0?1+B:B;z=j*x}else{var U=B<0?x:0;z=U+B*T}var Y=function(le){return Math.abs(le)<M||Math.abs(le)>=Math.abs(x)},te=Y(z),J=Y(Math.abs(x)-Math.abs(z)),ne=te||J;if(ne&&!V)if(C){var ae=Math.abs(D)<=f/2,K=Math.abs(L)<=v/2;if(ae){var R=(c.x1+c.x2)/2,N=c.y1,G=c.y2;t.segpts=[R,N,R,G]}else if(K){var W=(c.y1+c.y2)/2,X=c.x1,de=c.x2;t.segpts=[X,W,de,W]}else t.segpts=[c.x1,c.y2]}else{var Te=Math.abs(D)<=d/2,xe=Math.abs(F)<=h/2;if(Te){var fe=(c.y1+c.y2)/2,ce=c.x1,be=c.x2;t.segpts=[ce,fe,be,fe]}else if(xe){var De=(c.x1+c.x2)/2,Me=c.y1,we=c.y2;t.segpts=[De,Me,De,we]}else t.segpts=[c.x2,c.y1]}else if(C){var Se=c.y1+z+(g?f/2*T:0),ye=c.x1,se=c.x2;t.segpts=[ye,Se,se,Se]}else{var I=c.x1+z+(g?d/2*T:0),H=c.y1,oe=c.y2;t.segpts=[I,H,I,oe]}if(t.isRound){var Q=r.pstyle("taxi-radius").value,ee=r.pstyle("radius-type").value[0]==="arc-radius";t.radii=new Array(t.segpts.length/2).fill(Q),t.isArcRadius=new Array(t.segpts.length/2).fill(ee)}};Nt.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var n=e.srcPos,a=e.tgtPos,i=e.srcW,o=e.srcH,s=e.tgtW,l=e.tgtH,u=e.srcShape,c=e.tgtShape,d=e.srcCornerRadius,f=e.tgtCornerRadius,v=e.srcRs,h=e.tgtRs,m=!Ce(t.startX)||!Ce(t.startY),g=!Ce(t.arrowStartX)||!Ce(t.arrowStartY),p=!Ce(t.endX)||!Ce(t.endY),y=!Ce(t.arrowEndX)||!Ce(t.arrowEndY),b=3,_=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,B=b*_,k=In({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),M=k<B,O=In({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),P=O<B,L=!1;if(m||g||M){L=!0;var F={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},E=Math.sqrt(F.x*F.x+F.y*F.y),A={x:F.x/E,y:F.y/E},S=Math.max(i,o),w={x:t.ctrlpts[0]+A.x*2*S,y:t.ctrlpts[1]+A.y*2*S},C=u.intersectLine(n.x,n.y,i,o,w.x,w.y,0,d,v);M?(t.ctrlpts[0]=t.ctrlpts[0]+A.x*(B-k),t.ctrlpts[1]=t.ctrlpts[1]+A.y*(B-k)):(t.ctrlpts[0]=C[0]+A.x*B,t.ctrlpts[1]=C[1]+A.y*B)}if(p||y||P){L=!0;var x={x:t.ctrlpts[0]-a.x,y:t.ctrlpts[1]-a.y},D=Math.sqrt(x.x*x.x+x.y*x.y),T={x:x.x/D,y:x.y/D},V=Math.max(i,o),z={x:t.ctrlpts[0]+T.x*2*V,y:t.ctrlpts[1]+T.y*2*V},j=c.intersectLine(a.x,a.y,s,l,z.x,z.y,0,f,h);P?(t.ctrlpts[0]=t.ctrlpts[0]+T.x*(B-O),t.ctrlpts[1]=t.ctrlpts[1]+T.y*(B-O)):(t.ctrlpts[0]=j[0]+T.x*B,t.ctrlpts[1]=j[1]+T.y*B)}L&&this.findEndpoints(r)}};Nt.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var n,a;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,a=.5,e.midX=_t(e.allpts[n],e.allpts[n+2],e.allpts[n+4],a),e.midY=_t(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],a))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var i=2;i+3<e.allpts.length;i+=2){var o=e.radii[i/2-1],s=e.isArcRadius[i/2-1];e.roundCorners.push(Ml({x:e.allpts[i-2],y:e.allpts[i-1]},{x:e.allpts[i],y:e.allpts[i+1],radius:o},{x:e.allpts[i+2],y:e.allpts[i+3]},o,s))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var d={x:e.segpts[c],y:e.segpts[c+1]},f=e.roundCorners[c/2],v=[d.x-f.cx,d.y-f.cy],h=f.radius/Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2));v=v.map(function(m){return m*h}),e.midX=f.cx+v[0],e.midY=f.cy+v[1],e.midVector=v}}}};Nt.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Ce(e.startX)&&Ce(e.startY)&&Ce(e.endX)&&Ce(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Ye("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};Nt.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,n=t.cy,a=n.hasCompoundNodes(),i={map:new Fr,get:function(M){var O=this.map.get(M[0]);return O!=null?O.get(M[1]):null},set:function(M,O){var P=this.map.get(M[0]);P==null&&(P=new Fr,this.map.set(M[0],P)),P.set(M[1],O)}},o=[],s=[],l=0;l<r.length;l++){var u=r[l],c=u._private,d=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(d==="haystack"){s.push(u);continue}var f=d==="unbundled-bezier"||d.endsWith("segments")||d==="straight"||d==="straight-triangle"||d.endsWith("taxi"),v=d==="unbundled-bezier"||d==="bezier",h=c.source,m=c.target,g=h.poolIndex(),p=m.poolIndex(),y=[g,p].sort(),b=i.get(y);b==null&&(b={eles:[]},i.set(y,b),o.push(y)),b.eles.push(u),f&&(b.hasUnbundled=!0),v&&(b.hasBezier=!0)}}for(var _=function(M){var O=o[M],P=i.get(O),L=void 0;if(!P.hasUnbundled){var F=P.eles[0].parallelEdges().filter(function(I){return I.isBundledBezier()});fl(P.eles),F.forEach(function(I){return P.eles.push(I)}),P.eles.sort(function(I,H){return I.poolIndex()-H.poolIndex()})}var E=P.eles[0],A=E.source(),S=E.target();if(A.poolIndex()>S.poolIndex()){var w=A;A=S,S=w}var C=P.srcPos=A.position(),x=P.tgtPos=S.position(),D=P.srcW=A.outerWidth(),T=P.srcH=A.outerHeight(),V=P.tgtW=S.outerWidth(),z=P.tgtH=S.outerHeight(),j=P.srcShape=t.nodeShapes[e.getNodeShape(A)],U=P.tgtShape=t.nodeShapes[e.getNodeShape(S)],Y=P.srcCornerRadius=A.pstyle("corner-radius").value==="auto"?"auto":A.pstyle("corner-radius").pfValue,te=P.tgtCornerRadius=S.pstyle("corner-radius").value==="auto"?"auto":S.pstyle("corner-radius").pfValue,J=P.tgtRs=S._private.rscratch,ne=P.srcRs=A._private.rscratch;P.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var ae=0;ae<P.eles.length;ae++){var K=P.eles[ae],R=K[0]._private.rscratch,N=K.pstyle("curve-style").value,G=N==="unbundled-bezier"||N.endsWith("segments")||N.endsWith("taxi"),W=!A.same(K.source());if(!P.calculatedIntersection&&A!==S&&(P.hasBezier||P.hasUnbundled)){P.calculatedIntersection=!0;var X=j.intersectLine(C.x,C.y,D,T,x.x,x.y,0,Y,ne),de=P.srcIntn=X,Te=U.intersectLine(x.x,x.y,V,z,C.x,C.y,0,te,J),xe=P.tgtIntn=Te,fe=P.intersectionPts={x1:X[0],x2:Te[0],y1:X[1],y2:Te[1]},ce=P.posPts={x1:C.x,x2:x.x,y1:C.y,y2:x.y},be=Te[1]-X[1],De=Te[0]-X[0],Me=Math.sqrt(De*De+be*be),we=P.vector={x:De,y:be},Se=P.vectorNorm={x:we.x/Me,y:we.y/Me},ye={x:-Se.y,y:Se.x};P.nodesOverlap=!Ce(Me)||U.checkPoint(X[0],X[1],0,V,z,x.x,x.y,te,J)||j.checkPoint(Te[0],Te[1],0,D,T,C.x,C.y,Y,ne),P.vectorNormInverse=ye,L={nodesOverlap:P.nodesOverlap,dirCounts:P.dirCounts,calculatedIntersection:!0,hasBezier:P.hasBezier,hasUnbundled:P.hasUnbundled,eles:P.eles,srcPos:x,srcRs:J,tgtPos:C,tgtRs:ne,srcW:V,srcH:z,tgtW:D,tgtH:T,srcIntn:xe,tgtIntn:de,srcShape:U,tgtShape:j,posPts:{x1:ce.x2,y1:ce.y2,x2:ce.x1,y2:ce.y1},intersectionPts:{x1:fe.x2,y1:fe.y2,x2:fe.x1,y2:fe.y1},vector:{x:-we.x,y:-we.y},vectorNorm:{x:-Se.x,y:-Se.y},vectorNormInverse:{x:-ye.x,y:-ye.y}}}var se=W?L:P;R.nodesOverlap=se.nodesOverlap,R.srcIntn=se.srcIntn,R.tgtIntn=se.tgtIntn,R.isRound=N.startsWith("round"),a&&(A.isParent()||A.isChild()||S.isParent()||S.isChild())&&(A.parents().anySame(S)||S.parents().anySame(A)||A.same(S)&&A.isParent())?e.findCompoundLoopPoints(K,se,ae,G):A===S?e.findLoopPoints(K,se,ae,G):N.endsWith("segments")?e.findSegmentsPoints(K,se):N.endsWith("taxi")?e.findTaxiPoints(K,se):N==="straight"||!G&&P.eles.length%2===1&&ae===Math.floor(P.eles.length/2)?e.findStraightEdgePoints(K):e.findBezierPoints(K,se,ae,G,W),e.findEndpoints(K),e.tryToCorrectInvalidPoints(K,se),e.checkForInvalidEdgeWarning(K),e.storeAllpts(K),e.storeEdgeProjections(K),e.calculateArrowAngles(K),e.recalculateEdgeLabelProjections(K),e.calculateLabelAngles(K)}},B=0;B<o.length;B++)_(B);this.findHaystackPoints(s)}};function _f(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var n=r[t],a=r[t+1];e.push({x:n,y:a})}return e}}Nt.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="segments")return _f(e.segpts)};Nt.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return _f(e.ctrlpts)};Nt.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var si={};si.manualEndptToPx=function(r,e){var t=this,n=r.position(),a=r.outerWidth(),i=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var s=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(s[0]=s[0]*a),e.units[1]==="%"&&(s[1]=s[1]*i),s[0]+=n.x,s[1]+=n.y,s}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(a,i),c=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return t.nodeShapes[this.getNodeShape(r)].intersectLine(n.x,n.y,a,i,c[0],c[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};si.findEndpoints=function(r){var e=this,t,n=r.source()[0],a=r.target()[0],i=n.position(),o=a.position(),s=r.pstyle("target-arrow-shape").value,l=r.pstyle("source-arrow-shape").value,u=r.pstyle("target-distance-from-node").pfValue,c=r.pstyle("source-distance-from-node").pfValue,d=n._private.rscratch,f=a._private.rscratch,v=r.pstyle("curve-style").value,h=r._private.rscratch,m=h.edgeType,g=v==="taxi",p=m==="self"||m==="compound",y=m==="bezier"||m==="multibezier"||p,b=m!=="bezier",_=m==="straight"||m==="segments",B=m==="segments",k=y||b||_,M=p||g,O=r.pstyle("source-endpoint"),P=M?"outside-to-node":O.value,L=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,F=r.pstyle("target-endpoint"),E=M?"outside-to-node":F.value,A=a.pstyle("corner-radius").value==="auto"?"auto":a.pstyle("corner-radius").pfValue;h.srcManEndpt=O,h.tgtManEndpt=F;var S,w,C,x;if(y){var D=[h.ctrlpts[0],h.ctrlpts[1]],T=b?[h.ctrlpts[h.ctrlpts.length-2],h.ctrlpts[h.ctrlpts.length-1]]:D;S=T,w=D}else if(_){var V=B?h.segpts.slice(0,2):[o.x,o.y],z=B?h.segpts.slice(h.segpts.length-2):[i.x,i.y];S=z,w=V}if(E==="inside-to-node")t=[o.x,o.y];else if(F.units)t=this.manualEndptToPx(a,F);else if(E==="outside-to-line")t=h.tgtIntn;else if(E==="outside-to-node"||E==="outside-to-node-or-label"?C=S:(E==="outside-to-line"||E==="outside-to-line-or-label")&&(C=[i.x,i.y]),t=e.nodeShapes[this.getNodeShape(a)].intersectLine(o.x,o.y,a.outerWidth(),a.outerHeight(),C[0],C[1],0,A,f),E==="outside-to-node-or-label"||E==="outside-to-line-or-label"){var j=a._private.rscratch,U=j.labelWidth,Y=j.labelHeight,te=j.labelX,J=j.labelY,ne=U/2,ae=Y/2,K=a.pstyle("text-valign").value;K==="top"?J-=ae:K==="bottom"&&(J+=ae);var R=a.pstyle("text-halign").value;R==="left"?te-=ne:R==="right"&&(te+=ne);var N=Ua(C[0],C[1],[te-ne,J-ae,te+ne,J-ae,te+ne,J+ae,te-ne,J+ae],o.x,o.y);if(N.length>0){var G=i,W=Mn(G,na(t)),X=Mn(G,na(N)),de=W;if(X<W&&(t=N,de=X),N.length>2){var Te=Mn(G,{x:N[2],y:N[3]});Te<de&&(t=[N[2],N[3]])}}}var xe=fo(t,S,e.arrowShapes[s].spacing(r)+u),fe=fo(t,S,e.arrowShapes[s].gap(r)+u);if(h.endX=fe[0],h.endY=fe[1],h.arrowEndX=xe[0],h.arrowEndY=xe[1],P==="inside-to-node")t=[i.x,i.y];else if(O.units)t=this.manualEndptToPx(n,O);else if(P==="outside-to-line")t=h.srcIntn;else if(P==="outside-to-node"||P==="outside-to-node-or-label"?x=w:(P==="outside-to-line"||P==="outside-to-line-or-label")&&(x=[o.x,o.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(i.x,i.y,n.outerWidth(),n.outerHeight(),x[0],x[1],0,L,d),P==="outside-to-node-or-label"||P==="outside-to-line-or-label"){var ce=n._private.rscratch,be=ce.labelWidth,De=ce.labelHeight,Me=ce.labelX,we=ce.labelY,Se=be/2,ye=De/2,se=n.pstyle("text-valign").value;se==="top"?we-=ye:se==="bottom"&&(we+=ye);var I=n.pstyle("text-halign").value;I==="left"?Me-=Se:I==="right"&&(Me+=Se);var H=Ua(x[0],x[1],[Me-Se,we-ye,Me+Se,we-ye,Me+Se,we+ye,Me-Se,we+ye],i.x,i.y);if(H.length>0){var oe=o,Q=Mn(oe,na(t)),ee=Mn(oe,na(H)),he=Q;if(ee<Q&&(t=[H[0],H[1]],he=ee),H.length>2){var le=Mn(oe,{x:H[2],y:H[3]});le<he&&(t=[H[2],H[3]])}}}var ve=fo(t,w,e.arrowShapes[l].spacing(r)+c),Re=fo(t,w,e.arrowShapes[l].gap(r)+c);h.startX=Re[0],h.startY=Re[1],h.arrowStartX=ve[0],h.arrowStartY=ve[1],k&&(!Ce(h.startX)||!Ce(h.startY)||!Ce(h.endX)||!Ce(h.endY)?h.badLine=!0:h.badLine=!1)};si.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};si.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var Dl={};function dC(r,e,t){for(var n=function(u,c,d,f){return _t(u,c,d,f)},a=e._private,i=a.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var s=r.bezierProjPcts[o];i.push({x:n(t[0],t[2],t[4],s),y:n(t[1],t[3],t[5],s)})}}Dl.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,n=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var a=0;a+5<t.allpts.length;a+=4)dC(this,r,t.allpts.slice(a,a+6))}else if(n==="segments")for(var i=e.rstyle.linePts=[],a=0;a+1<t.allpts.length;a+=2)i.push({x:t.allpts[a],y:t.allpts[a+1]});else if(n==="haystack"){var o=t.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};Dl.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var Vr={};Vr.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!fn(e)){var t,n,a=r._private,i=r.width(),o=r.height(),s=r.padding(),l=r.position(),u=r.pstyle("text-halign").strValue,c=r.pstyle("text-valign").strValue,d=a.rscratch,f=a.rstyle;switch(u){case"left":t=l.x-i/2-s;break;case"right":t=l.x+i/2+s;break;default:t=l.x}switch(c){case"top":n=l.y-o/2-s;break;case"bottom":n=l.y+o/2+s;break;default:n=l.y}d.labelX=t,d.labelY=n,f.labelX=t,f.labelY=n,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var Sf=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n=n*-1),n},Ef=function(e,t){var n=t.x-e.x,a=t.y-e.y;return Sf(n,a)},fC=function(e,t,n,a){var i=Ka(0,a-.001,1),o=Ka(0,a+.001,1),s=ia(e,t,n,i),l=ia(e,t,n,o);return Ef(s,l)};Vr.recalculateEdgeLabelProjections=function(r){var e,t=r._private,n=t.rscratch,a=this,i={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(i.mid||i.source||i.target){e={x:n.midX,y:n.midY};var o=function(d,f,v){ln(t.rscratch,d,f,v),ln(t.rstyle,d,f,v)};o("labelX",null,e.x),o("labelY",null,e.y);var s=Sf(n.midDispX,n.midDispY);o("labelAutoAngle",null,s);var l=function c(){if(c.cache)return c.cache;for(var d=[],f=0;f+5<n.allpts.length;f+=4){var v={x:n.allpts[f],y:n.allpts[f+1]},h={x:n.allpts[f+2],y:n.allpts[f+3]},m={x:n.allpts[f+4],y:n.allpts[f+5]};d.push({p0:v,p1:h,p2:m,startDist:0,length:0,segments:[]})}var g=t.rstyle.bezierPts,p=a.bezierProjPcts.length;function y(M,O,P,L,F){var E=In(O,P),A=M.segments[M.segments.length-1],S={p0:O,p1:P,t0:L,t1:F,startDist:A?A.startDist+A.length:0,length:E};M.segments.push(S),M.length+=E}for(var b=0;b<d.length;b++){var _=d[b],B=d[b-1];B&&(_.startDist=B.startDist+B.length),y(_,_.p0,g[b*p],0,a.bezierProjPcts[0]);for(var k=0;k<p-1;k++)y(_,g[b*p+k],g[b*p+k+1],a.bezierProjPcts[k],a.bezierProjPcts[k+1]);y(_,g[b*p+p-1],_.p2,a.bezierProjPcts[p-1],1)}return c.cache=d},u=function(d){var f,v=d==="source";if(i[d]){var h=r.pstyle(d+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var m=l(),g,p=0,y=0,b=0;b<m.length;b++){for(var _=m[v?b:m.length-1-b],B=0;B<_.segments.length;B++){var k=_.segments[v?B:_.segments.length-1-B],M=b===m.length-1&&B===_.segments.length-1;if(p=y,y+=k.length,y>=h||M){g={cp:_,segment:k};break}}if(g)break}var O=g.cp,P=g.segment,L=(h-p)/P.length,F=P.t1-P.t0,E=v?P.t0+F*L:P.t1-F*L;E=Ka(0,E,1),e=ia(O.p0,O.p1,O.p2,E),f=fC(O.p0,O.p1,O.p2,E);break}case"straight":case"segments":case"haystack":{for(var A=0,S,w,C,x,D=n.allpts.length,T=0;T+3<D&&(v?(C={x:n.allpts[T],y:n.allpts[T+1]},x={x:n.allpts[T+2],y:n.allpts[T+3]}):(C={x:n.allpts[D-2-T],y:n.allpts[D-1-T]},x={x:n.allpts[D-4-T],y:n.allpts[D-3-T]}),S=In(C,x),w=A,A+=S,!(A>=h));T+=2);var V=h-w,z=V/S;z=Ka(0,z,1),e=mg(C,x,z),f=Ef(C,x);break}}o("labelX",d,e.x),o("labelY",d,e.y),o("labelAutoAngle",d,f)}};u("source"),u("target"),this.applyLabelDimensions(r)}};Vr.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};Vr.applyPrefixedLabelDimensions=function(r,e){var t=r._private,n=this.getLabelText(r,e),a=this.calculateLabelDimensions(r,n),i=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,s=xr(t.rscratch,"labelWrapCachedLines",e)||[],l=o!=="wrap"?1:Math.max(s.length,1),u=a.height/l,c=u*i,d=a.width,f=a.height+(l-1)*(i-1)*u;ln(t.rstyle,"labelWidth",e,d),ln(t.rscratch,"labelWidth",e,d),ln(t.rstyle,"labelHeight",e,f),ln(t.rscratch,"labelHeight",e,f),ln(t.rscratch,"labelLineHeight",e,c)};Vr.getLabelText=function(r,e){var t=r._private,n=e?e+"-":"",a=r.pstyle(n+"label").strValue,i=r.pstyle("text-transform").value,o=function(U,Y){return Y?(ln(t.rscratch,U,e,Y),Y):xr(t.rscratch,U,e)};if(!a)return"";i=="none"||(i=="uppercase"?a=a.toUpperCase():i=="lowercase"&&(a=a.toLowerCase()));var s=r.pstyle("text-wrap").value;if(s==="wrap"){var l=o("labelKey");if(l!=null&&o("labelWrapKey")===l)return o("labelWrapCachedText");for(var u="\u200B",c=a.split(`
`),d=r.pstyle("text-max-width").pfValue,f=r.pstyle("text-overflow-wrap").value,v=f==="anywhere",h=[],m=/[\s\u200b]+|$/g,g=0;g<c.length;g++){var p=c[g],y=this.calculateLabelDimensions(r,p),b=y.width;if(v){var _=p.split("").join(u);p=_}if(b>d){var B=p.matchAll(m),k="",M=0,O=or(B),P;try{for(O.s();!(P=O.n()).done;){var L=P.value,F=L[0],E=p.substring(M,L.index);M=L.index+F.length;var A=k.length===0?E:k+E+F,S=this.calculateLabelDimensions(r,A),w=S.width;w<=d?k+=E+F:(k&&h.push(k),k=E+F)}}catch(j){O.e(j)}finally{O.f()}k.match(/^[\s\u200b]+$/)||h.push(k)}else h.push(p)}o("labelWrapCachedLines",h),a=o("labelWrapCachedText",h.join(`
`)),o("labelWrapKey",l)}else if(s==="ellipsis"){var C=r.pstyle("text-max-width").pfValue,x="",D="\u2026",T=!1;if(this.calculateLabelDimensions(r,a).width<C)return a;for(var V=0;V<a.length;V++){var z=this.calculateLabelDimensions(r,x+a[V]+D).width;if(z>C)break;x+=a[V],V===a.length-1&&(T=!0)}return T||(x+=D),x}return a};Vr.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Vr.calculateLabelDimensions=function(r,e){var t=this,n=t.cy.window(),a=n.document,i=hn(e,r._private.labelDimsKey),o=t.labelDimCache||(t.labelDimCache=[]),s=o[i];if(s!=null)return s;var l=0,u=r.pstyle("font-style").strValue,c=r.pstyle("font-size").pfValue,d=r.pstyle("font-family").strValue,f=r.pstyle("font-weight").strValue,v=this.labelCalcCanvas,h=this.labelCalcCanvasContext;if(!v){v=this.labelCalcCanvas=a.createElement("canvas"),h=this.labelCalcCanvasContext=v.getContext("2d");var m=v.style;m.position="absolute",m.left="-9999px",m.top="-9999px",m.zIndex="-1",m.visibility="hidden",m.pointerEvents="none"}h.font="".concat(u," ").concat(f," ").concat(c,"px ").concat(d);for(var g=0,p=0,y=e.split(`
`),b=0;b<y.length;b++){var _=y[b],B=h.measureText(_),k=Math.ceil(B.width),M=c;g=Math.max(k,g),p+=M}return g+=l,p+=l,o[i]={width:g,height:p}};Vr.calculateLabelAngle=function(r,e){var t=r._private,n=t.rscratch,a=r.isEdge(),i=e?e+"-":"",o=r.pstyle(i+"text-rotation"),s=o.strValue;return s==="none"?0:a&&s==="autorotate"?n.labelAutoAngle:s==="autorotate"?0:o.pfValue};Vr.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),n=r._private,a=n.rscratch;a.labelAngle=e.calculateLabelAngle(r),t&&(a.sourceLabelAngle=e.calculateLabelAngle(r,"source"),a.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var Tf={},jc=28,Gc=!1;Tf.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<jc||r.height()<jc))return Gc||(Ye("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Gc=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return t};var os={};os.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,n=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),s)for(var l=0;l<o.length;l++){var u=o[l],c=u._private,d=c.rstyle;d.clean=!1,d.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(o){var s=o.target;n(s)}).on("style.* background.*",function(o){var s=o.target;n(s,!1)});var a=function(o){if(o){var s=t.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(n(u.connectedEdges()),c.cleanConnected=!0)}if(s)for(var d=0;d<s.length;d++){var f=s[d];f(o,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){a(!0)},t.beforeRender(a,t.beforeRenderPriorities.eleCalcs)};os.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};os.recalculateRenderedStyle=function(r,e){var t=function(_){return _._private.rstyle.cleanConnected},n=[],a=[];if(!this.destroyed){e===void 0&&(e=!0);for(var i=0;i<r.length;i++){var o=r[i],s=o._private,l=s.rstyle;o.isEdge()&&(!t(o.source())||!t(o.target()))&&(l.clean=!1),!(e&&l.clean||o.removed())&&o.pstyle("display").value!=="none"&&(s.group==="nodes"?a.push(o):n.push(o),l.clean=!0)}for(var u=0;u<a.length;u++){var c=a[u],d=c._private,f=d.rstyle,v=c.position();this.recalculateNodeLabelProjection(c),f.nodeX=v.x,f.nodeY=v.y,f.nodeW=c.pstyle("width").pfValue,f.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var h=0;h<n.length;h++){var m=n[h],g=m._private,p=g.rstyle,y=g.rscratch;p.srcX=y.arrowStartX,p.srcY=y.arrowStartY,p.tgtX=y.arrowEndX,p.tgtY=y.arrowEndY,p.midX=y.midX,p.midY=y.midY,p.labelAngle=y.labelAngle,p.sourceLabelAngle=y.sourceLabelAngle,p.targetLabelAngle=y.targetLabelAngle}}};var ss={};ss.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var n=r[t],a=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):a.inDragLayer?r.drag.push(n):r.nondrag.push(n)}for(var t=0;t<e.length;t++){var n=e[t];r.drag.push(n)}}};ss.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};ss.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(uf),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var Mf={};[Vn,Go,Nt,si,Dl,Vr,Tf,os,ss].forEach(function(r){Fe(Mf,r)});var Df={};Df.getCachedImage=function(r,e,t){var n=this,a=n.imageCache=n.imageCache||{},i=a[r];if(i)return i.image.complete||i.image.addEventListener("load",t),i.image;i=a[r]=a[r]||{};var o=i.image=new Image;o.addEventListener("load",t),o.addEventListener("error",function(){o.error=!0});var s="data:",l=r.substring(0,s.length).toLowerCase()===s;return l||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var ba={};ba.registerBinding=function(r,e,t,n){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var i=[],o=0;o<r.length;o++){var s=r[o];if(s!==void 0){var l=this.binder(s);i.push(l.on.apply(l,a))}}return i}var l=this.binder(r);return l.on.apply(l,a)};ba.binder=function(r){var e=this,t=e.cy.window(),n=r===t||r===t.document||r===t.document.body||Vv(r);if(e.supportsPassiveEvents==null){var a=!1;try{var i=Object.defineProperty({},"passive",{get:function(){return a=!0,!0}});t.addEventListener("test",null,i)}catch{}e.supportsPassiveEvents=a}var o=function(l,u,c){var d=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(d[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:d}),(r.addEventListener||r.on).apply(r,d),this};return{on:o,addEventListener:o,addListener:o,bind:o}};ba.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};ba.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};ba.load=function(){var r=this,e=r.cy.window(),t=function(I){return I.selected()},n=function(I){var H=I.getRootNode();if(H&&H.nodeType===11&&H.host!==void 0)return H},a=function(I,H,oe,Q){I==null&&(I=r.cy);for(var ee=0;ee<H.length;ee++){var he=H[ee];I.emit({originalEvent:oe,type:he,position:Q})}},i=function(I){return I.shiftKey||I.metaKey||I.ctrlKey},o=function(I,H){var oe=!0;if(r.cy.hasCompoundNodes()&&I&&I.pannable())for(var Q=0;H&&Q<H.length;Q++){var I=H[Q];if(I.isNode()&&I.isParent()&&!I.pannable()){oe=!1;break}}else oe=!0;return oe},s=function(I){I[0]._private.grabbed=!0},l=function(I){I[0]._private.grabbed=!1},u=function(I){I[0]._private.rscratch.inDragLayer=!0},c=function(I){I[0]._private.rscratch.inDragLayer=!1},d=function(I){I[0]._private.rscratch.isGrabTarget=!0},f=function(I){I[0]._private.rscratch.isGrabTarget=!1},v=function(I,H){var oe=H.addToList,Q=oe.has(I);!Q&&I.grabbable()&&!I.locked()&&(oe.merge(I),s(I))},h=function(I,H){if(I.cy().hasCompoundNodes()&&!(H.inDragLayer==null&&H.addToList==null)){var oe=I.descendants();H.inDragLayer&&(oe.forEach(u),oe.connectedEdges().forEach(u)),H.addToList&&v(oe,H)}},m=function(I,H){H=H||{};var oe=I.cy().hasCompoundNodes();H.inDragLayer&&(I.forEach(u),I.neighborhood().stdFilter(function(Q){return!oe||Q.isEdge()}).forEach(u)),H.addToList&&I.forEach(function(Q){v(Q,H)}),h(I,H),y(I,{inDragLayer:H.inDragLayer}),r.updateCachedGrabbedEles()},g=m,p=function(I){I&&(r.getCachedZSortedEles().forEach(function(H){l(H),c(H),f(H)}),r.updateCachedGrabbedEles())},y=function(I,H){if(!(H.inDragLayer==null&&H.addToList==null)&&I.cy().hasCompoundNodes()){var oe=I.ancestors().orphans();if(!oe.same(I)){var Q=oe.descendants().spawnSelf().merge(oe).unmerge(I).unmerge(I.descendants()),ee=Q.connectedEdges();H.inDragLayer&&(ee.forEach(u),Q.forEach(u)),H.addToList&&Q.forEach(function(he){v(he,H)})}}},b=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},_=typeof MutationObserver<"u",B=typeof ResizeObserver<"u";_?(r.removeObserver=new MutationObserver(function(se){for(var I=0;I<se.length;I++){var H=se[I],oe=H.removedNodes;if(oe)for(var Q=0;Q<oe.length;Q++){var ee=oe[Q];if(ee===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(se){r.destroy()});var k=ni(function(){r.cy.resize()},100);_&&(r.styleObserver=new MutationObserver(k),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",k),B&&(r.resizeObserver=new ResizeObserver(k),r.resizeObserver.observe(r.container));var M=function(I,H){for(;I!=null;)H(I),I=I.parentNode},O=function(){r.invalidateContainerClientCoordsCache()};M(r.container,function(se){r.registerBinding(se,"transitionend",O),r.registerBinding(se,"animationend",O),r.registerBinding(se,"scroll",O)}),r.registerBinding(r.container,"contextmenu",function(se){se.preventDefault()});var P=function(){return r.selection[4]!==0},L=function(I){for(var H=r.findContainerClientCoords(),oe=H[0],Q=H[1],ee=H[2],he=H[3],le=I.touches?I.touches:[I],ve=!1,Re=0;Re<le.length;Re++){var ze=le[Re];if(oe<=ze.clientX&&ze.clientX<=oe+ee&&Q<=ze.clientY&&ze.clientY<=Q+he){ve=!0;break}}if(!ve)return!1;for(var Ae=r.container,Ve=I.target,Ne=Ve.parentNode,Le=!1;Ne;){if(Ne===Ae){Le=!0;break}Ne=Ne.parentNode}return!!Le};r.registerBinding(r.container,"mousedown",function(I){if(L(I)&&!(r.hoverData.which===1&&I.which!==1)){I.preventDefault(),b(),r.hoverData.capture=!0,r.hoverData.which=I.which;var H=r.cy,oe=[I.clientX,I.clientY],Q=r.projectIntoViewport(oe[0],oe[1]),ee=r.selection,he=r.findNearestElements(Q[0],Q[1],!0,!1),le=he[0],ve=r.dragData.possibleDragElements;r.hoverData.mdownPos=Q,r.hoverData.mdownGPos=oe;var Re=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var et=r.hoverData.down;et?et.emit({originalEvent:I,type:"taphold",position:{x:Q[0],y:Q[1]}}):H.emit({originalEvent:I,type:"taphold",position:{x:Q[0],y:Q[1]}})}},r.tapholdDuration)};if(I.which==3){r.hoverData.cxtStarted=!0;var ze={originalEvent:I,type:"cxttapstart",position:{x:Q[0],y:Q[1]}};le?(le.activate(),le.emit(ze),r.hoverData.down=le):H.emit(ze),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(I.which==1){le&&le.activate();{if(le!=null&&r.nodeIsGrabbable(le)){var Ae=function(et){return{originalEvent:I,type:et,position:{x:Q[0],y:Q[1]}}},Ve=function(et){et.emit(Ae("grab"))};if(d(le),!le.selected())ve=r.dragData.possibleDragElements=H.collection(),g(le,{addToList:ve}),le.emit(Ae("grabon")).emit(Ae("grab"));else{ve=r.dragData.possibleDragElements=H.collection();var Ne=H.$(function(Le){return Le.isNode()&&Le.selected()&&r.nodeIsGrabbable(Le)});m(Ne,{addToList:ve}),le.emit(Ae("grabon")),Ne.forEach(Ve)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=le,r.hoverData.downs=he,r.hoverData.downTime=new Date().getTime()}a(le,["mousedown","tapstart","vmousedown"],I,{x:Q[0],y:Q[1]}),le==null?(ee[4]=1,r.data.bgActivePosistion={x:Q[0],y:Q[1]},r.redrawHint("select",!0),r.redraw()):le.pannable()&&(ee[4]=1),Re()}ee[0]=ee[2]=Q[0],ee[1]=ee[3]=Q[1]}},!1);var F=n(r.container);r.registerBinding([e,F],"mousemove",function(I){var H=r.hoverData.capture;if(!(!H&&!L(I))){var oe=!1,Q=r.cy,ee=Q.zoom(),he=[I.clientX,I.clientY],le=r.projectIntoViewport(he[0],he[1]),ve=r.hoverData.mdownPos,Re=r.hoverData.mdownGPos,ze=r.selection,Ae=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(Ae=r.findNearestElement(le[0],le[1],!0,!1));var Ve=r.hoverData.last,Ne=r.hoverData.down,Le=[le[0]-ze[2],le[1]-ze[3]],et=r.dragData.possibleDragElements,it;if(Re){var nr=he[0]-Re[0],ar=nr*nr,ft=he[1]-Re[1],mt=ft*ft,yt=ar+mt;r.hoverData.isOverThresholdDrag=it=yt>=r.desktopTapThreshold2}var zt=i(I);it&&(r.hoverData.tapholdCancelled=!0);var jt=function(){var Mr=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Mr.length===0?(Mr.push(Le[0]),Mr.push(Le[1])):(Mr[0]+=Le[0],Mr[1]+=Le[1])};oe=!0,a(Ae,["mousemove","vmousemove","tapdrag"],I,{x:le[0],y:le[1]});var Er=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||Q.emit({originalEvent:I,type:"boxstart",position:{x:le[0],y:le[1]}}),ze[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(it){var lr={originalEvent:I,type:"cxtdrag",position:{x:le[0],y:le[1]}};Ne?Ne.emit(lr):Q.emit(lr),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||Ae!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:I,type:"cxtdragout",position:{x:le[0],y:le[1]}}),r.hoverData.cxtOver=Ae,Ae&&Ae.emit({originalEvent:I,type:"cxtdragover",position:{x:le[0],y:le[1]}}))}}else if(r.hoverData.dragging){if(oe=!0,Q.panningEnabled()&&Q.userPanningEnabled()){var Tr;if(r.hoverData.justStartedPan){var jr=r.hoverData.mdownPos;Tr={x:(le[0]-jr[0])*ee,y:(le[1]-jr[1])*ee},r.hoverData.justStartedPan=!1}else Tr={x:Le[0]*ee,y:Le[1]*ee};Q.panBy(Tr),Q.emit("dragpan"),r.hoverData.dragged=!0}le=r.projectIntoViewport(I.clientX,I.clientY)}else if(ze[4]==1&&(Ne==null||Ne.pannable())){if(it){if(!r.hoverData.dragging&&Q.boxSelectionEnabled()&&(zt||!Q.panningEnabled()||!Q.userPanningEnabled()))Er();else if(!r.hoverData.selecting&&Q.panningEnabled()&&Q.userPanningEnabled()){var Gr=o(Ne,r.hoverData.downs);Gr&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,ze[4]=0,r.data.bgActivePosistion=na(ve),r.redrawHint("select",!0),r.redraw())}Ne&&Ne.pannable()&&Ne.active()&&Ne.unactivate()}}else{if(Ne&&Ne.pannable()&&Ne.active()&&Ne.unactivate(),(!Ne||!Ne.grabbed())&&Ae!=Ve&&(Ve&&a(Ve,["mouseout","tapdragout"],I,{x:le[0],y:le[1]}),Ae&&a(Ae,["mouseover","tapdragover"],I,{x:le[0],y:le[1]}),r.hoverData.last=Ae),Ne)if(it){if(Q.boxSelectionEnabled()&&zt)Ne&&Ne.grabbed()&&(p(et),Ne.emit("freeon"),et.emit("free"),r.dragData.didDrag&&(Ne.emit("dragfreeon"),et.emit("dragfree"))),Er();else if(Ne&&Ne.grabbed()&&r.nodeIsDraggable(Ne)){var kt=!r.dragData.didDrag;kt&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||m(et,{inDragLayer:!0});var Ct={x:0,y:0};if(Ce(Le[0])&&Ce(Le[1])&&(Ct.x+=Le[0],Ct.y+=Le[1],kt)){var qt=r.hoverData.dragDelta;qt&&Ce(qt[0])&&Ce(qt[1])&&(Ct.x+=qt[0],Ct.y+=qt[1])}r.hoverData.draggingEles=!0,et.silentShift(Ct).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else jt();oe=!0}if(ze[2]=le[0],ze[3]=le[1],oe)return I.stopPropagation&&I.stopPropagation(),I.preventDefault&&I.preventDefault(),!1}},!1);var E,A,S;r.registerBinding(e,"mouseup",function(I){if(!(r.hoverData.which===1&&I.which!==1&&r.hoverData.capture)){var H=r.hoverData.capture;if(H){r.hoverData.capture=!1;var oe=r.cy,Q=r.projectIntoViewport(I.clientX,I.clientY),ee=r.selection,he=r.findNearestElement(Q[0],Q[1],!0,!1),le=r.dragData.possibleDragElements,ve=r.hoverData.down,Re=i(I);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,ve&&ve.unactivate(),r.hoverData.which===3){var ze={originalEvent:I,type:"cxttapend",position:{x:Q[0],y:Q[1]}};if(ve?ve.emit(ze):oe.emit(ze),!r.hoverData.cxtDragged){var Ae={originalEvent:I,type:"cxttap",position:{x:Q[0],y:Q[1]}};ve?ve.emit(Ae):oe.emit(Ae)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(a(he,["mouseup","tapend","vmouseup"],I,{x:Q[0],y:Q[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(a(ve,["click","tap","vclick"],I,{x:Q[0],y:Q[1]}),A=!1,I.timeStamp-S<=oe.multiClickDebounceTime()?(E&&clearTimeout(E),A=!0,S=null,a(ve,["dblclick","dbltap","vdblclick"],I,{x:Q[0],y:Q[1]})):(E=setTimeout(function(){A||a(ve,["oneclick","onetap","voneclick"],I,{x:Q[0],y:Q[1]})},oe.multiClickDebounceTime()),S=I.timeStamp)),ve==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!i(I)&&(oe.$(t).unselect(["tapunselect"]),le.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=le=oe.collection()),he==ve&&!r.dragData.didDrag&&!r.hoverData.selecting&&he!=null&&he._private.selectable&&(r.hoverData.dragging||(oe.selectionType()==="additive"||Re?he.selected()?he.unselect(["tapunselect"]):he.select(["tapselect"]):Re||(oe.$(t).unmerge(he).unselect(["tapunselect"]),he.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var Ve=oe.collection(r.getAllInBox(ee[0],ee[1],ee[2],ee[3]));r.redrawHint("select",!0),Ve.length>0&&r.redrawHint("eles",!0),oe.emit({type:"boxend",originalEvent:I,position:{x:Q[0],y:Q[1]}});var Ne=function(it){return it.selectable()&&!it.selected()};oe.selectionType()==="additive"||Re||oe.$(t).unmerge(Ve).unselect(),Ve.emit("box").stdFilter(Ne).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!ee[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Le=ve&&ve.grabbed();p(le),Le&&(ve.emit("freeon"),le.emit("free"),r.dragData.didDrag&&(ve.emit("dragfreeon"),le.emit("dragfree")))}}ee[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var w=function(I){if(!r.scrollingPage){var H=r.cy,oe=H.zoom(),Q=H.pan(),ee=r.projectIntoViewport(I.clientX,I.clientY),he=[ee[0]*oe+Q.x,ee[1]*oe+Q.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||P()){I.preventDefault();return}if(H.panningEnabled()&&H.userPanningEnabled()&&H.zoomingEnabled()&&H.userZoomingEnabled()){I.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var le;I.deltaY!=null?le=I.deltaY/-250:I.wheelDeltaY!=null?le=I.wheelDeltaY/1e3:le=I.wheelDelta/1e3,le=le*r.wheelSensitivity;var ve=I.deltaMode===1;ve&&(le*=33);var Re=H.zoom()*Math.pow(10,le);I.type==="gesturechange"&&(Re=r.gestureStartZoom*I.scale),H.zoom({level:Re,renderedPosition:{x:he[0],y:he[1]}}),H.emit(I.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",w,!0),r.registerBinding(e,"scroll",function(I){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(I){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||I.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(se){r.hasTouchStarted||w(se)},!0),r.registerBinding(r.container,"mouseout",function(I){var H=r.projectIntoViewport(I.clientX,I.clientY);r.cy.emit({originalEvent:I,type:"mouseout",position:{x:H[0],y:H[1]}})},!1),r.registerBinding(r.container,"mouseover",function(I){var H=r.projectIntoViewport(I.clientX,I.clientY);r.cy.emit({originalEvent:I,type:"mouseover",position:{x:H[0],y:H[1]}})},!1);var C,x,D,T,V,z,j,U,Y,te,J,ne,ae,K=function(I,H,oe,Q){return Math.sqrt((oe-I)*(oe-I)+(Q-H)*(Q-H))},R=function(I,H,oe,Q){return(oe-I)*(oe-I)+(Q-H)*(Q-H)},N;r.registerBinding(r.container,"touchstart",N=function(I){if(r.hasTouchStarted=!0,!!L(I)){b(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var H=r.cy,oe=r.touchData.now,Q=r.touchData.earlier;if(I.touches[0]){var ee=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);oe[0]=ee[0],oe[1]=ee[1]}if(I.touches[1]){var ee=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);oe[2]=ee[0],oe[3]=ee[1]}if(I.touches[2]){var ee=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);oe[4]=ee[0],oe[5]=ee[1]}if(I.touches[1]){r.touchData.singleTouchMoved=!0,p(r.dragData.touchDragEles);var he=r.findContainerClientCoords();Y=he[0],te=he[1],J=he[2],ne=he[3],C=I.touches[0].clientX-Y,x=I.touches[0].clientY-te,D=I.touches[1].clientX-Y,T=I.touches[1].clientY-te,ae=0<=C&&C<=J&&0<=D&&D<=J&&0<=x&&x<=ne&&0<=T&&T<=ne;var le=H.pan(),ve=H.zoom();V=K(C,x,D,T),z=R(C,x,D,T),j=[(C+D)/2,(x+T)/2],U=[(j[0]-le.x)/ve,(j[1]-le.y)/ve];var Re=200,ze=Re*Re;if(z<ze&&!I.touches[2]){var Ae=r.findNearestElement(oe[0],oe[1],!0,!0),Ve=r.findNearestElement(oe[2],oe[3],!0,!0);Ae&&Ae.isNode()?(Ae.activate().emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start=Ae):Ve&&Ve.isNode()?(Ve.activate().emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start=Ve):H.emit({originalEvent:I,type:"cxttapstart",position:{x:oe[0],y:oe[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(I.touches[2])H.boxSelectionEnabled()&&I.preventDefault();else if(!I.touches[1]){if(I.touches[0]){var Ne=r.findNearestElements(oe[0],oe[1],!0,!0),Le=Ne[0];if(Le!=null&&(Le.activate(),r.touchData.start=Le,r.touchData.starts=Ne,r.nodeIsGrabbable(Le))){var et=r.dragData.touchDragEles=H.collection(),it=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Le.selected()?(it=H.$(function(yt){return yt.selected()&&r.nodeIsGrabbable(yt)}),m(it,{addToList:et})):g(Le,{addToList:et}),d(Le);var nr=function(zt){return{originalEvent:I,type:zt,position:{x:oe[0],y:oe[1]}}};Le.emit(nr("grabon")),it?it.forEach(function(yt){yt.emit(nr("grab"))}):Le.emit(nr("grab"))}a(Le,["touchstart","tapstart","vmousedown"],I,{x:oe[0],y:oe[1]}),Le==null&&(r.data.bgActivePosistion={x:ee[0],y:ee[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&a(r.touchData.start,["taphold"],I,{x:oe[0],y:oe[1]})},r.tapholdDuration)}}if(I.touches.length>=1){for(var ar=r.touchData.startPosition=[null,null,null,null,null,null],ft=0;ft<oe.length;ft++)ar[ft]=Q[ft]=oe[ft];var mt=I.touches[0];r.touchData.startGPosition=[mt.clientX,mt.clientY]}}},!1);var G;r.registerBinding(e,"touchmove",G=function(I){var H=r.touchData.capture;if(!(!H&&!L(I))){var oe=r.selection,Q=r.cy,ee=r.touchData.now,he=r.touchData.earlier,le=Q.zoom();if(I.touches[0]){var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);ee[0]=ve[0],ee[1]=ve[1]}if(I.touches[1]){var ve=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);ee[2]=ve[0],ee[3]=ve[1]}if(I.touches[2]){var ve=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);ee[4]=ve[0],ee[5]=ve[1]}var Re=r.touchData.startGPosition,ze;if(H&&I.touches[0]&&Re){for(var Ae=[],Ve=0;Ve<ee.length;Ve++)Ae[Ve]=ee[Ve]-he[Ve];var Ne=I.touches[0].clientX-Re[0],Le=Ne*Ne,et=I.touches[0].clientY-Re[1],it=et*et,nr=Le+it;ze=nr>=r.touchTapThreshold2}if(H&&r.touchData.cxt){I.preventDefault();var ar=I.touches[0].clientX-Y,ft=I.touches[0].clientY-te,mt=I.touches[1].clientX-Y,yt=I.touches[1].clientY-te,zt=R(ar,ft,mt,yt),jt=zt/z,Er=150,lr=Er*Er,Tr=1.5,jr=Tr*Tr;if(jt>=jr||zt>=lr){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Gr={originalEvent:I,type:"cxttapend",position:{x:ee[0],y:ee[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(Gr),r.touchData.start=null):Q.emit(Gr)}}if(H&&r.touchData.cxt){var Gr={originalEvent:I,type:"cxtdrag",position:{x:ee[0],y:ee[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(Gr):Q.emit(Gr),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var kt=r.findNearestElement(ee[0],ee[1],!0,!0);(!r.touchData.cxtOver||kt!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:I,type:"cxtdragout",position:{x:ee[0],y:ee[1]}}),r.touchData.cxtOver=kt,kt&&kt.emit({originalEvent:I,type:"cxtdragover",position:{x:ee[0],y:ee[1]}}))}else if(H&&I.touches[2]&&Q.boxSelectionEnabled())I.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||Q.emit({originalEvent:I,type:"boxstart",position:{x:ee[0],y:ee[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,oe[4]=1,!oe||oe.length===0||oe[0]===void 0?(oe[0]=(ee[0]+ee[2]+ee[4])/3,oe[1]=(ee[1]+ee[3]+ee[5])/3,oe[2]=(ee[0]+ee[2]+ee[4])/3+1,oe[3]=(ee[1]+ee[3]+ee[5])/3+1):(oe[2]=(ee[0]+ee[2]+ee[4])/3,oe[3]=(ee[1]+ee[3]+ee[5])/3),r.redrawHint("select",!0),r.redraw();else if(H&&I.touches[1]&&!r.touchData.didSelect&&Q.zoomingEnabled()&&Q.panningEnabled()&&Q.userZoomingEnabled()&&Q.userPanningEnabled()){I.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Ct=r.dragData.touchDragEles;if(Ct){r.redrawHint("drag",!0);for(var qt=0;qt<Ct.length;qt++){var ci=Ct[qt]._private;ci.grabbed=!1,ci.rscratch.inDragLayer=!1}}var Mr=r.touchData.start,ar=I.touches[0].clientX-Y,ft=I.touches[0].clientY-te,mt=I.touches[1].clientX-Y,yt=I.touches[1].clientY-te,Ll=K(ar,ft,mt,yt),vh=Ll/V;if(ae){var ph=ar-C,gh=ft-x,mh=mt-D,yh=yt-T,Ch=(ph+mh)/2,bh=(gh+yh)/2,_a=Q.zoom(),ds=_a*vh,di=Q.pan(),Vl=U[0]*_a+di.x,Nl=U[1]*_a+di.y,wh={x:-ds/_a*(Vl-di.x-Ch)+Vl,y:-ds/_a*(Nl-di.y-bh)+Nl};if(Mr&&Mr.active()){var Ct=r.dragData.touchDragEles;p(Ct),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Mr.unactivate().emit("freeon"),Ct.emit("free"),r.dragData.didDrag&&(Mr.emit("dragfreeon"),Ct.emit("dragfree"))}Q.viewport({zoom:ds,pan:wh,cancelOnFailedZoom:!0}),Q.emit("pinchzoom"),V=Ll,C=ar,x=ft,D=mt,T=yt,r.pinching=!0}if(I.touches[0]){var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);ee[0]=ve[0],ee[1]=ve[1]}if(I.touches[1]){var ve=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);ee[2]=ve[0],ee[3]=ve[1]}if(I.touches[2]){var ve=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);ee[4]=ve[0],ee[5]=ve[1]}}else if(I.touches[0]&&!r.touchData.didSelect){var pr=r.touchData.start,fs=r.touchData.last,kt;if(!r.hoverData.draggingEles&&!r.swipePanning&&(kt=r.findNearestElement(ee[0],ee[1],!0,!0)),H&&pr!=null&&I.preventDefault(),H&&pr!=null&&r.nodeIsDraggable(pr))if(ze){var Ct=r.dragData.touchDragEles,zl=!r.dragData.didDrag;zl&&m(Ct,{inDragLayer:!0}),r.dragData.didDrag=!0;var Sa={x:0,y:0};if(Ce(Ae[0])&&Ce(Ae[1])&&(Sa.x+=Ae[0],Sa.y+=Ae[1],zl)){r.redrawHint("eles",!0);var gr=r.touchData.dragDelta;gr&&Ce(gr[0])&&Ce(gr[1])&&(Sa.x+=gr[0],Sa.y+=gr[1])}r.hoverData.draggingEles=!0,Ct.silentShift(Sa).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==he[0]&&r.touchData.startPosition[1]==he[1]&&r.redrawHint("eles",!0),r.redraw()}else{var gr=r.touchData.dragDelta=r.touchData.dragDelta||[];gr.length===0?(gr.push(Ae[0]),gr.push(Ae[1])):(gr[0]+=Ae[0],gr[1]+=Ae[1])}if(a(pr||kt,["touchmove","tapdrag","vmousemove"],I,{x:ee[0],y:ee[1]}),(!pr||!pr.grabbed())&&kt!=fs&&(fs&&fs.emit({originalEvent:I,type:"tapdragout",position:{x:ee[0],y:ee[1]}}),kt&&kt.emit({originalEvent:I,type:"tapdragover",position:{x:ee[0],y:ee[1]}})),r.touchData.last=kt,H)for(var qt=0;qt<ee.length;qt++)ee[qt]&&r.touchData.startPosition[qt]&&ze&&(r.touchData.singleTouchMoved=!0);if(H&&(pr==null||pr.pannable())&&Q.panningEnabled()&&Q.userPanningEnabled()){var xh=o(pr,r.touchData.starts);xh&&(I.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=na(r.touchData.startPosition)),r.swipePanning?(Q.panBy({x:Ae[0]*le,y:Ae[1]*le}),Q.emit("dragpan")):ze&&(r.swipePanning=!0,Q.panBy({x:Ne*le,y:et*le}),Q.emit("dragpan"),pr&&(pr.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var ve=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);ee[0]=ve[0],ee[1]=ve[1]}}for(var Ve=0;Ve<ee.length;Ve++)he[Ve]=ee[Ve];H&&I.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var W;r.registerBinding(e,"touchcancel",W=function(I){var H=r.touchData.start;r.touchData.capture=!1,H&&H.unactivate()});var X,de,Te,xe;if(r.registerBinding(e,"touchend",X=function(I){var H=r.touchData.start,oe=r.touchData.capture;if(oe)I.touches.length===0&&(r.touchData.capture=!1),I.preventDefault();else return;var Q=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var ee=r.cy,he=ee.zoom(),le=r.touchData.now,ve=r.touchData.earlier;if(I.touches[0]){var Re=r.projectIntoViewport(I.touches[0].clientX,I.touches[0].clientY);le[0]=Re[0],le[1]=Re[1]}if(I.touches[1]){var Re=r.projectIntoViewport(I.touches[1].clientX,I.touches[1].clientY);le[2]=Re[0],le[3]=Re[1]}if(I.touches[2]){var Re=r.projectIntoViewport(I.touches[2].clientX,I.touches[2].clientY);le[4]=Re[0],le[5]=Re[1]}H&&H.unactivate();var ze;if(r.touchData.cxt){if(ze={originalEvent:I,type:"cxttapend",position:{x:le[0],y:le[1]}},H?H.emit(ze):ee.emit(ze),!r.touchData.cxtDragged){var Ae={originalEvent:I,type:"cxttap",position:{x:le[0],y:le[1]}};H?H.emit(Ae):ee.emit(Ae)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!I.touches[2]&&ee.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var Ve=ee.collection(r.getAllInBox(Q[0],Q[1],Q[2],Q[3]));Q[0]=void 0,Q[1]=void 0,Q[2]=void 0,Q[3]=void 0,Q[4]=0,r.redrawHint("select",!0),ee.emit({type:"boxend",originalEvent:I,position:{x:le[0],y:le[1]}});var Ne=function(lr){return lr.selectable()&&!lr.selected()};Ve.emit("box").stdFilter(Ne).select().emit("boxselect"),Ve.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(H?.unactivate(),I.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!I.touches[1]){if(!I.touches[0]){if(!I.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Le=r.dragData.touchDragEles;if(H!=null){var et=H._private.grabbed;p(Le),r.redrawHint("drag",!0),r.redrawHint("eles",!0),et&&(H.emit("freeon"),Le.emit("free"),r.dragData.didDrag&&(H.emit("dragfreeon"),Le.emit("dragfree"))),a(H,["touchend","tapend","vmouseup","tapdragout"],I,{x:le[0],y:le[1]}),H.unactivate(),r.touchData.start=null}else{var it=r.findNearestElement(le[0],le[1],!0,!0);a(it,["touchend","tapend","vmouseup","tapdragout"],I,{x:le[0],y:le[1]})}var nr=r.touchData.startPosition[0]-le[0],ar=nr*nr,ft=r.touchData.startPosition[1]-le[1],mt=ft*ft,yt=ar+mt,zt=yt*he*he;r.touchData.singleTouchMoved||(H||ee.$(":selected").unselect(["tapunselect"]),a(H,["tap","vclick"],I,{x:le[0],y:le[1]}),de=!1,I.timeStamp-xe<=ee.multiClickDebounceTime()?(Te&&clearTimeout(Te),de=!0,xe=null,a(H,["dbltap","vdblclick"],I,{x:le[0],y:le[1]})):(Te=setTimeout(function(){de||a(H,["onetap","voneclick"],I,{x:le[0],y:le[1]})},ee.multiClickDebounceTime()),xe=I.timeStamp)),H!=null&&!r.dragData.didDrag&&H._private.selectable&&zt<r.touchTapThreshold2&&!r.pinching&&(ee.selectionType()==="single"?(ee.$(t).unmerge(H).unselect(["tapunselect"]),H.select(["tapselect"])):H.selected()?H.unselect(["tapunselect"]):H.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var jt=0;jt<le.length;jt++)ve[jt]=le[jt];r.dragData.didDrag=!1,I.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),I.touches.length<2&&(I.touches.length===1&&(r.touchData.startGPosition=[I.touches[0].clientX,I.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var fe=[],ce=function(I){return{clientX:I.clientX,clientY:I.clientY,force:1,identifier:I.pointerId,pageX:I.pageX,pageY:I.pageY,radiusX:I.width/2,radiusY:I.height/2,screenX:I.screenX,screenY:I.screenY,target:I.target}},be=function(I){return{event:I,touch:ce(I)}},De=function(I){fe.push(be(I))},Me=function(I){for(var H=0;H<fe.length;H++){var oe=fe[H];if(oe.event.pointerId===I.pointerId){fe.splice(H,1);return}}},we=function(I){var H=fe.filter(function(oe){return oe.event.pointerId===I.pointerId})[0];H.event=I,H.touch=ce(I)},Se=function(I){I.touches=fe.map(function(H){return H.touch})},ye=function(I){return I.pointerType==="mouse"||I.pointerType===4};r.registerBinding(r.container,"pointerdown",function(se){ye(se)||(se.preventDefault(),De(se),Se(se),N(se))}),r.registerBinding(r.container,"pointerup",function(se){ye(se)||(Me(se),Se(se),X(se))}),r.registerBinding(r.container,"pointercancel",function(se){ye(se)||(Me(se),Se(se),W(se))}),r.registerBinding(r.container,"pointermove",function(se){ye(se)||(se.preventDefault(),we(se),Se(se),G(se))})}};var Yr={};Yr.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(n,a,i,o,s,l){this.renderer.nodeShapeImpl("polygon",n,a,i,o,s,this.points)},intersectLine:function(n,a,i,o,s,l,u,c){return Ua(s,l,this.points,n,a,i/2,o/2,u)},checkPoint:function(n,a,i,o,s,l,u,c){return Ur(n,a,this.points,l,u,o,s,[0,-1],i)}}};Yr.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,a,i,o){this.renderer.nodeShapeImpl(this.name,e,t,n,a,i)},intersectLine:function(e,t,n,a,i,o,s,l){return Pg(i,o,e,t,n/2+s,a/2+s)},checkPoint:function(e,t,n,a,i,o,s,l){return An(e,t,a,i,o,s,n)}}};Yr.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(n,a,i,o,s,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===a)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=a;var c=i/2,d=o/2;s=s==="auto"?Pd(i,o):s;for(var f=new Array(e.length/2),v=0;v<e.length/2;v++)f[v]={x:n+c*e[v*2],y:a+d*e[v*2+1]};var h,m,g,p,y=f.length;for(m=f[y-1],h=0;h<y;h++)g=f[h%y],p=f[(h+1)%y],l[u][h]=Ml(m,g,p,s),m=g,g=p;return l[u]},draw:function(n,a,i,o,s,l,u){this.renderer.nodeShapeImpl("round-polygon",n,a,i,o,s,this.points,this.getOrCreateCorners(a,i,o,s,l,u,"drawCorners"))},intersectLine:function(n,a,i,o,s,l,u,c,d){return Ag(s,l,this.points,n,a,i,o,u,this.getOrCreateCorners(n,a,i,o,c,d,"corners"))},checkPoint:function(n,a,i,o,s,l,u,c,d){return kg(n,a,this.points,l,u,o,s,this.getOrCreateCorners(l,u,o,s,c,d,"corners"))}}};Yr.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Gt(4,0),draw:function(e,t,n,a,i,o){this.renderer.nodeShapeImpl(this.name,e,t,n,a,i,this.points,o)},intersectLine:function(e,t,n,a,i,o,s,l){return Dd(i,o,e,t,n,a,s,l)},checkPoint:function(e,t,n,a,i,o,s,l){var u=a/2,c=i/2;l=l==="auto"?Rn(a,i):l,l=Math.min(u,c,l);var d=l*2;return!!(Ur(e,t,this.points,o,s,a,i-d,[0,-1],n)||Ur(e,t,this.points,o,s,a-d,i,[0,-1],n)||An(e,t,d,d,o-u+l,s-c+l,n)||An(e,t,d,d,o+u-l,s-c+l,n)||An(e,t,d,d,o+u-l,s+c-l,n)||An(e,t,d,d,o-u+l,s+c-l,n))}}};Yr.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:pl(),points:Gt(4,0),draw:function(e,t,n,a,i,o){this.renderer.nodeShapeImpl(this.name,e,t,n,a,i,null,o)},generateCutTrianglePts:function(e,t,n,a,i){var o=i==="auto"?this.cornerLength:i,s=t/2,l=e/2,u=n-l,c=n+l,d=a-s,f=a+s;return{topLeft:[u,d+o,u+o,d,u+o,d+o],topRight:[c-o,d,c,d+o,c-o,d+o],bottomRight:[c,f-o,c-o,f,c-o,f-o],bottomLeft:[u+o,f,u,f-o,u+o,f-o]}},intersectLine:function(e,t,n,a,i,o,s,l){var u=this.generateCutTrianglePts(n+2*s,a+2*s,e,t,l),c=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return Ua(i,o,c,e,t)},checkPoint:function(e,t,n,a,i,o,s,l){var u=l==="auto"?this.cornerLength:l;if(Ur(e,t,this.points,o,s,a,i-2*u,[0,-1],n)||Ur(e,t,this.points,o,s,a-2*u,i,[0,-1],n))return!0;var c=this.generateCutTrianglePts(a,i,o,s);return er(e,t,c.topLeft)||er(e,t,c.topRight)||er(e,t,c.bottomRight)||er(e,t,c.bottomLeft)}}};Yr.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Gt(4,0),draw:function(e,t,n,a,i,o){this.renderer.nodeShapeImpl(this.name,e,t,n,a,i)},intersectLine:function(e,t,n,a,i,o,s,l){var u=.15,c=.5,d=.85,f=this.generateBarrelBezierPts(n+2*s,a+2*s,e,t),v=function(g){var p=ia({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},u),y=ia({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},c),b=ia({x:g[0],y:g[1]},{x:g[2],y:g[3]},{x:g[4],y:g[5]},d);return[g[0],g[1],p.x,p.y,y.x,y.y,b.x,b.y,g[4],g[5]]},h=[].concat(v(f.topLeft),v(f.topRight),v(f.bottomRight),v(f.bottomLeft));return Ua(i,o,h,e,t)},generateBarrelBezierPts:function(e,t,n,a){var i=t/2,o=e/2,s=n-o,l=n+o,u=a-i,c=a+i,d=Ws(e,t),f=d.heightOffset,v=d.widthOffset,h=d.ctrlPtOffsetPct*e,m={topLeft:[s,u+f,s+h,u,s+v,u],topRight:[l-v,u,l-h,u,l,u+f],bottomRight:[l,c-f,l-h,c,l-v,c],bottomLeft:[s+v,c,s+h,c,s,c-f]};return m.topLeft.isTop=!0,m.topRight.isTop=!0,m.bottomLeft.isBottom=!0,m.bottomRight.isBottom=!0,m},checkPoint:function(e,t,n,a,i,o,s,l){var u=Ws(a,i),c=u.heightOffset,d=u.widthOffset;if(Ur(e,t,this.points,o,s,a,i-2*c,[0,-1],n)||Ur(e,t,this.points,o,s,a-2*d,i,[0,-1],n))return!0;for(var f=this.generateBarrelBezierPts(a,i,o,s),v=function(O,P,L){var F=L[4],E=L[2],A=L[0],S=L[5],w=L[1],C=Math.min(F,A),x=Math.max(F,A),D=Math.min(S,w),T=Math.max(S,w);if(C<=O&&O<=x&&D<=P&&P<=T){var V=Bg(F,E,A),z=Eg(V[0],V[1],V[2],O),j=z.filter(function(U){return 0<=U&&U<=1});if(j.length>0)return j[0]}return null},h=Object.keys(f),m=0;m<h.length;m++){var g=h[m],p=f[g],y=v(e,t,p);if(y!=null){var b=p[5],_=p[3],B=p[1],k=_t(b,_,B,y);if(p.isTop&&k<=t||p.isBottom&&t<=k)return!0}}return!1}}};Yr.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Gt(4,0),draw:function(e,t,n,a,i,o){this.renderer.nodeShapeImpl(this.name,e,t,n,a,i,this.points,o)},intersectLine:function(e,t,n,a,i,o,s,l){var u=e-(n/2+s),c=t-(a/2+s),d=c,f=e+(n/2+s),v=un(i,o,e,t,u,c,f,d,!1);return v.length>0?v:Dd(i,o,e,t,n,a,s,l)},checkPoint:function(e,t,n,a,i,o,s,l){l=l==="auto"?Rn(a,i):l;var u=2*l;if(Ur(e,t,this.points,o,s,a,i-u,[0,-1],n)||Ur(e,t,this.points,o,s,a-u,i,[0,-1],n))return!0;var c=a/2+2*n,d=i/2+2*n,f=[o-c,s-d,o-c,s,o+c,s,o+c,s-d];return!!(er(e,t,f)||An(e,t,u,u,o+a/2-l,s+i/2-l,n)||An(e,t,u,u,o-a/2+l,s+i/2-l,n))}}};Yr.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Gt(3,0)),this.generateRoundPolygon("round-triangle",Gt(3,0)),this.generatePolygon("rectangle",Gt(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",Gt(5,0)),this.generateRoundPolygon("round-pentagon",Gt(5,0)),this.generatePolygon("hexagon",Gt(6,0)),this.generateRoundPolygon("round-hexagon",Gt(6,0)),this.generatePolygon("heptagon",Gt(7,0)),this.generateRoundPolygon("round-heptagon",Gt(7,0)),this.generatePolygon("octagon",Gt(8,0)),this.generateRoundPolygon("round-octagon",Gt(8,0));var n=new Array(20);{var a=Hs(5,0),i=Hs(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<i.length/2;s++)i[s*2]*=o,i[s*2+1]*=o;for(var s=0;s<20/4;s++)n[s*4]=a[s*2],n[s*4+1]=a[s*2+1],n[s*4+2]=i[s*2],n[s*4+3]=i[s*2+1]}n=kd(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}r.makePolygon=function(u){var c=u.join("$"),d="polygon-"+c,f;return(f=this[d])?f:e.generatePolygon(d,u)}};var li={};li.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};li.redraw=function(r){r=r||_d();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};li.beforeRender=function(r,e){if(!this.destroyed){e==null&&ot("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(n,a){return a.priority-n.priority})}};var $c=function(e,t,n){for(var a=e.beforeRenderCallbacks,i=0;i<a.length;i++)a[i].fn(t,n)};li.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function n(a){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){$c(r,!0,a);var i=Kr();r.render(r.renderOptions);var o=r.lastDrawTime=Kr();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-i),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var s=o-i;r.redrawTotalTime+=s,r.lastRedrawTime=s,r.averageRedrawTime=r.averageRedrawTime/2+s/2,r.requestedFrame=!1}else $c(r,!1,a);r.skipFrame=!1,Ro(n)}};Ro(t)}};var hC=function(e){this.init(e)},kf=hC,wa=kf.prototype;wa.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];wa.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container(),n=e.cy.window();if(n){var a=n.document,i=a.head,o="__________cytoscape_stylesheet",s="__________cytoscape_container",l=a.getElementById(o)!=null;if(t.className.indexOf(s)<0&&(t.className=(t.className||"")+" "+s),!l){var u=a.createElement("style");u.id=o,u.textContent="."+s+" { position: relative; }",i.insertBefore(u,i.children[0])}var c=n.getComputedStyle(t),d=c.getPropertyValue("position");d==="static"&&Ye("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Ce(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};wa.notify=function(r,e){var t=this,n=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&n.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),r==="gc"&&t.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};wa.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],n=t,a=n.target;(a.off||a.removeEventListener).apply(a,n.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};wa.isHeadless=function(){return!1};[Tl,Mf,Df,ba,Yr,li].forEach(function(r){Fe(wa,r)});var Vs=1e3/60,Pf={setupDequeueing:function(e){return function(){var n=this,a=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var i=ni(function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},e.deqRedrawThreshold),o=function(u,c){var d=Kr(),f=a.averageRedrawTime,v=a.lastRedrawTime,h=[],m=a.cy.extent(),g=a.getPixelRatio();for(u||a.flushRenderedStyleQueue();;){var p=Kr(),y=p-d,b=p-c;if(v<Vs){var _=Vs-(u?f:0);if(b>=e.deqFastCost*_)break}else if(u){if(y>=e.deqCost*v||y>=e.deqAvgCost*f)break}else if(b>=e.deqNoDrawCost*Vs)break;var B=e.deq(n,g,m);if(B.length>0)for(var k=0;k<B.length;k++)h.push(B[k]);else break}h.length>0&&(e.onDeqd(n,h),!u&&e.shouldRedraw(n,h,g,m)&&i())},s=e.priority||dl;a.beforeRender(o,s(n))}}}},vC=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oo;Cn(this,r),this.idsByKey=new Fr,this.keyForId=new Fr,this.cachesByLvl=new Fr,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return bn(r,[{key:"getIdsFor",value:function(t){t==null&&ot("Can not get id list for null key");var n=this.idsByKey,a=this.idsByKey.get(t);return a||(a=new ha,n.set(t,a)),a}},{key:"addIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).add(n)}},{key:"deleteIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).delete(n)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var n=t.id(),a=this.keyForId.get(n),i=this.getKey(t);this.deleteIdForKey(a,n),this.addIdForKey(i,n),this.keyForId.set(n,i)}},{key:"deleteKeyMappingFor",value:function(t){var n=t.id(),a=this.keyForId.get(n);this.deleteIdForKey(a,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(t){var n=t.id(),a=this.keyForId.get(n),i=this.getKey(t);return a!==i}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var n=this.cachesByLvl,a=this.lvls,i=n.get(t);return i||(i=new Fr,n.set(t,i),a.push(t)),i}},{key:"getCache",value:function(t,n){return this.getCachesAt(n).get(t)}},{key:"get",value:function(t,n){var a=this.getKey(t),i=this.getCache(a,n);return i!=null&&this.updateKeyMappingFor(t),i}},{key:"getForCachedKey",value:function(t,n){var a=this.keyForId.get(t.id()),i=this.getCache(a,n);return i}},{key:"hasCache",value:function(t,n){return this.getCachesAt(n).has(t)}},{key:"has",value:function(t,n){var a=this.getKey(t);return this.hasCache(a,n)}},{key:"setCache",value:function(t,n,a){a.key=t,this.getCachesAt(n).set(t,a)}},{key:"set",value:function(t,n,a){var i=this.getKey(t);this.setCache(i,n,a),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,n){this.getCachesAt(n).delete(t)}},{key:"delete",value:function(t,n){var a=this.getKey(t);this.deleteCache(a,n)}},{key:"invalidateKey",value:function(t){var n=this;this.lvls.forEach(function(a){return n.deleteCache(t,a)})}},{key:"invalidate",value:function(t){var n=t.id(),a=this.keyForId.get(n);this.deleteKeyMappingFor(t);var i=this.doesEleInvalidateKey(t);return i&&this.invalidateKey(a),i||this.getNumberOfIdsForKey(a)===0}}]),r}(),qc=25,wo=50,Bo=-4,nl=3,Af=7.99,pC=8,gC=1024,mC=1024,yC=1024,CC=.2,bC=.8,wC=10,xC=.15,_C=.1,SC=.9,EC=.9,TC=100,MC=1,aa={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},DC=St({getKey:null,doesEleInvalidateKey:Oo,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:bd,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Va=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var a=DC(t);Fe(n,a),n.lookup=new vC(a.getKey,a.doesEleInvalidateKey),n.setupDequeueing()},gt=Va.prototype;gt.reasons=aa;gt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};gt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=t[r]=t[r]||[];return n};gt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new ai(function(t,n){return n.reqs-t.reqs});return e};gt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};gt.getElement=function(r,e,t,n,a){var i=this,o=this.renderer,s=o.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!i.allowEdgeTxrCaching&&r.isEdge()||!i.allowParentTxrCaching&&r.isParent())return null;if(n==null&&(n=Math.ceil(hl(s*t))),n<Bo)n=Bo;else if(s>=Af||n>nl)return null;var u=Math.pow(2,n),c=e.h*u,d=e.w*u,f=o.eleTextBiggerThanMin(r,u);if(!this.isVisible(r,f))return null;var v=l.get(r,n);if(v&&v.invalidated&&(v.invalidated=!1,v.texture.invalidatedWidth-=v.width),v)return v;var h;if(c<=qc?h=qc:c<=wo?h=wo:h=Math.ceil(c/wo)*wo,c>yC||d>mC)return null;var m=i.getTextureQueue(h),g=m[m.length-2],p=function(){return i.recycleTexture(h,d)||i.addTexture(h,d)};g||(g=m[m.length-1]),g||(g=p()),g.width-g.usedWidth<d&&(g=p());for(var y=function(C){return C&&C.scaledLabelShown===f},b=a&&a===aa.dequeue,_=a&&a===aa.highQuality,B=a&&a===aa.downscale,k,M=n+1;M<=nl;M++){var O=l.get(r,M);if(O){k=O;break}}var P=k&&k.level===n+1?k:null,L=function(){g.context.drawImage(P.texture.canvas,P.x,0,P.width,P.height,g.usedWidth,0,d,c)};if(g.context.setTransform(1,0,0,1,0,0),g.context.clearRect(g.usedWidth,0,d,h),y(P))L();else if(y(k))if(_){for(var F=k.level;F>n;F--)P=i.getElement(r,e,t,F,aa.downscale);L()}else return i.queueElement(r,k.level-1),k;else{var E;if(!b&&!_&&!B)for(var A=n-1;A>=Bo;A--){var S=l.get(r,A);if(S){E=S;break}}if(y(E))return i.queueElement(r,n),E;g.context.translate(g.usedWidth,0),g.context.scale(u,u),this.drawElement(g.context,r,e,f,!1),g.context.scale(1/u,1/u),g.context.translate(-g.usedWidth,0)}return v={x:g.usedWidth,texture:g,level:n,scale:u,width:d,height:c,scaledLabelShown:f},g.usedWidth+=Math.ceil(d+pC),g.eleCaches.push(v),l.set(r,n,v),i.checkTextureFullness(g),v};gt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};gt.invalidateElement=function(r){var e=this,t=e.lookup,n=[],a=t.isInvalid(r);if(a){for(var i=Bo;i<=nl;i++){var o=t.getForCachedKey(r,i);o&&n.push(o)}var s=t.invalidate(r);if(s)for(var l=0;l<n.length;l++){var u=n[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(r)}};gt.checkTextureUtility=function(r){r.invalidatedWidth>=CC*r.width&&this.retireTexture(r)};gt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>bC&&r.fullnessChecks>=wC?vn(t,r):r.fullnessChecks++};gt.retireTexture=function(r){var e=this,t=r.height,n=e.getTextureQueue(t),a=this.lookup;vn(n,r),r.retired=!0;for(var i=r.eleCaches,o=0;o<i.length;o++){var s=i[o];a.deleteCache(s.key,s.level)}fl(i);var l=e.getRetiredTextureQueue(t);l.push(r)};gt.addTexture=function(r,e){var t=this,n=t.getTextureQueue(r),a={};return n.push(a),a.eleCaches=[],a.height=r,a.width=Math.max(gC,e),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=t.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a};gt.recycleTexture=function(r,e){for(var t=this,n=t.getTextureQueue(r),a=t.getRetiredTextureQueue(r),i=0;i<a.length;i++){var o=a[i];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,fl(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),vn(a,o),n.push(o),o}};gt.queueElement=function(r,e){var t=this,n=t.getElementQueue(),a=t.getElementKeyToQueue(),i=this.getKey(r),o=a[i];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,n.updateItem(o);else{var s={eles:r.spawn().merge(r),level:e,reqs:1,key:i};n.push(s),a[i]=s}};gt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),a=[],i=e.lookup,o=0;o<MC&&t.size()>0;o++){var s=t.pop(),l=s.key,u=s.eles[0],c=i.hasCache(u,s.level);if(n[l]=null,c)continue;a.push(s);var d=e.getBoundingBox(u);e.getElement(u,d,r,s.level,aa.dequeue)}return a};gt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),a=this.getKey(r),i=n[a];i!=null&&(i.eles.length===1?(i.reqs=cl,t.updateItem(i),t.pop(),n[a]=null):i.eles.unmerge(r))};gt.onDequeue=function(r){this.onDequeues.push(r)};gt.offDequeue=function(r){vn(this.onDequeues,r)};gt.setupDequeueing=Pf.setupDequeueing({deqRedrawThreshold:TC,deqCost:xC,deqAvgCost:_C,deqNoDrawCost:SC,deqFastCost:EC,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++){var a=e.onDequeues[n];a(t)}},shouldRedraw:function(e,t,n,a){for(var i=0;i<t.length;i++)for(var o=t[i].eles,s=0;s<o.length;s++){var l=o[s].boundingBox();if(vl(l,a))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var kC=1,za=-4,$o=2,PC=3.99,AC=50,BC=50,IC=.15,RC=.1,OC=.9,FC=.9,LC=1,Hc=250,VC=4e3*4e3,Wc=32767,NC=!0,Bf=function(e){var t=this,n=t.renderer=e,a=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=Kr()-2*Hc,t.skipping=!1,t.eleTxrDeqs=a.collection(),t.scheduleElementRefinement=ni(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},BC),n.beforeRender(function(o,s){s-t.lastInvalidationTime<=Hc?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var i=function(s,l){return l.reqs-s.reqs};t.layersQueue=new ai(i),t.setupDequeueing()},Dt=Bf.prototype,Kc=0,zC=Math.pow(2,53)-1;Dt.makeLayer=function(r,e){var t=Math.pow(2,e),n=Math.ceil(r.w*t),a=Math.ceil(r.h*t),i=this.renderer.makeOffscreenCanvas(n,a),o={id:Kc=++Kc%zC,bb:r,level:e,width:n,height:a,canvas:i,context:i.getContext("2d"),eles:[],elesQueue:[],reqs:0},s=o.context,l=-o.bb.x1,u=-o.bb.y1;return s.scale(t,t),s.translate(l,u),o};Dt.getLayers=function(r,e,t){var n=this,a=n.renderer,i=a.cy,o=i.zoom(),s=n.firstGet;if(n.firstGet=!1,t==null){if(t=Math.ceil(hl(o*e)),t<za)t=za;else if(o>=PC||t>$o)return null}n.validateLayersElesOrdering(t,r);var l=n.layersByLevel,u=Math.pow(2,t),c=l[t]=l[t]||[],d,f=n.levelIsComplete(t,r),v,h=function(){var L=function(w){if(n.validateLayersElesOrdering(w,r),n.levelIsComplete(w,r))return v=l[w],!0},F=function(w){if(!v)for(var C=t+w;za<=C&&C<=$o&&!L(C);C+=w);};F(1),F(-1);for(var E=c.length-1;E>=0;E--){var A=c[E];A.invalid&&vn(c,A)}};if(!f)h();else return c;var m=function(){if(!d){d=tr();for(var L=0;L<r.length;L++)Td(d,r[L].boundingBox())}return d},g=function(L){L=L||{};var F=L.after;m();var E=Math.ceil(d.w*u),A=Math.ceil(d.h*u);if(E>Wc||A>Wc)return null;var S=E*A;if(S>VC)return null;var w=n.makeLayer(d,t);if(F!=null){var C=c.indexOf(F)+1;c.splice(C,0,w)}else(L.insert===void 0||L.insert)&&c.unshift(w);return w};if(n.skipping&&!s)return null;for(var p=null,y=r.length/kC,b=!s,_=0;_<r.length;_++){var B=r[_],k=B._private.rscratch,M=k.imgLayerCaches=k.imgLayerCaches||{},O=M[t];if(O){p=O;continue}if((!p||p.eles.length>=y||!Md(p.bb,B.boundingBox()))&&(p=g({insert:!0,after:p}),!p))return null;v||b?n.queueLayer(p,B):n.drawEleInLayer(p,B,t,e),p.eles.push(B),M[t]=p}return v||(b?null:c)};Dt.getEleLevelForLayerLevel=function(r,e){return r};Dt.drawEleInLayer=function(r,e,t,n){var a=this,i=this.renderer,o=r.context,s=e.boundingBox();s.w===0||s.h===0||!e.visible()||(t=a.getEleLevelForLayerLevel(t,n),i.setImgSmoothing(o,!1),i.drawCachedElement(o,e,null,null,t,NC),i.setImgSmoothing(o,!0))};Dt.levelIsComplete=function(r,e){var t=this,n=t.layersByLevel[r];if(!n||n.length===0)return!1;for(var a=0,i=0;i<n.length;i++){var o=n[i];if(o.reqs>0||o.invalid)return!1;a+=o.eles.length}return a===e.length};Dt.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(t)for(var n=0;n<t.length;n++){for(var a=t[n],i=-1,o=0;o<e.length;o++)if(a.eles[0]===e[o]){i=o;break}if(i<0){this.invalidateLayer(a);continue}for(var s=i,o=0;o<a.eles.length;o++)if(a.eles[o]!==e[s+o]){this.invalidateLayer(a);break}}};Dt.updateElementsInLayers=function(r,e){for(var t=this,n=ti(r[0]),a=0;a<r.length;a++)for(var i=n?null:r[a],o=n?r[a]:r[a].ele,s=o._private.rscratch,l=s.imgLayerCaches=s.imgLayerCaches||{},u=za;u<=$o;u++){var c=l[u];c&&(i&&t.getEleLevelForLayerLevel(c.level)!==i.level||e(c,o,i))}};Dt.haveLayers=function(){for(var r=this,e=!1,t=za;t<=$o;t++){var n=r.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e};Dt.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=Kr(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(n,a,i){e.invalidateLayer(n)}))};Dt.invalidateLayer=function(r){if(this.lastInvalidationTime=Kr(),!r.invalid){var e=r.level,t=r.eles,n=this.layersByLevel[e];vn(n,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var a=0;a<t.length;a++){var i=t[a]._private.rscratch.imgLayerCaches;i&&(i[e]=null)}}};Dt.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(n,a,i){var o=n.replacement;if(o||(o=n.replacement=e.makeLayer(n.bb,n.level),o.replaces=n,o.eles=n.eles),!o.reqs)for(var s=0;s<o.eles.length;s++)e.queueLayer(o,o.eles[s])})};Dt.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};Dt.queueLayer=function(r,e){var t=this,n=t.layersQueue,a=r.elesQueue,i=a.hasId=a.hasId||{};if(!r.replacement){if(e){if(i[e.id()])return;a.push(e),i[e.id()]=!0}r.reqs?(r.reqs++,n.updateItem(r)):(r.reqs=1,n.push(r))}};Dt.dequeue=function(r){for(var e=this,t=e.layersQueue,n=[],a=0;a<LC&&t.size()!==0;){var i=t.peek();if(i.replacement){t.pop();continue}if(i.replaces&&i!==i.replaces.replacement){t.pop();continue}if(i.invalid){t.pop();continue}var o=i.elesQueue.shift();o&&(e.drawEleInLayer(i,o,i.level,r),a++),n.length===0&&n.push(!0),i.elesQueue.length===0&&(t.pop(),i.reqs=0,i.replaces&&e.applyLayerReplacement(i),e.requestRedraw())}return n};Dt.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],n=r.replaces,a=t.indexOf(n);if(!(a<0||n.invalid)){t[a]=r;for(var i=0;i<r.eles.length;i++){var o=r.eles[i]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[r.level]=r)}e.requestRedraw()}};Dt.requestRedraw=ni(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);Dt.setupDequeueing=Pf.setupDequeueing({deqRedrawThreshold:AC,deqCost:IC,deqAvgCost:RC,deqNoDrawCost:OC,deqFastCost:FC,deq:function(e,t){return e.dequeue(t)},onDeqd:dl,shouldRedraw:bd,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var If={},Uc;function jC(r,e){for(var t=0;t<e.length;t++){var n=e[t];r.lineTo(n.x,n.y)}}function GC(r,e,t){for(var n,a=0;a<e.length;a++){var i=e[a];a===0&&(n=i),r.lineTo(i.x,i.y)}r.quadraticCurveTo(t.x,t.y,n.x,n.y)}function Xc(r,e,t){r.beginPath&&r.beginPath();for(var n=e,a=0;a<n.length;a++){var i=n[a];r.lineTo(i.x,i.y)}var o=t,s=t[0];r.moveTo(s.x,s.y);for(var a=1;a<o.length;a++){var i=o[a];r.lineTo(i.x,i.y)}r.closePath&&r.closePath()}function $C(r,e,t,n,a){r.beginPath&&r.beginPath(),r.arc(t,n,a,0,Math.PI*2,!1);var i=e,o=i[0];r.moveTo(o.x,o.y);for(var s=0;s<i.length;s++){var l=i[s];r.lineTo(l.x,l.y)}r.closePath&&r.closePath()}function qC(r,e,t,n){r.arc(e,t,n,0,Math.PI*2,!1)}If.arrowShapeImpl=function(r){return(Uc||(Uc={polygon:jC,"triangle-backcurve":GC,"triangle-tee":Xc,"circle-triangle":$C,"triangle-cross":Xc,circle:qC}))[r]};var Nr={};Nr.drawElement=function(r,e,t,n,a,i){var o=this;e.isNode()?o.drawNode(r,e,t,n,a,i):o.drawEdge(r,e,t,n,a,i)};Nr.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};Nr.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};Nr.drawCachedElementPortion=function(r,e,t,n,a,i,o,s){var l=this,u=t.getBoundingBox(e);if(!(u.w===0||u.h===0)){var c=t.getElement(e,u,n,a,i);if(c!=null){var d=s(l,e);if(d===0)return;var f=o(l,e),v=u.x1,h=u.y1,m=u.w,g=u.h,p,y,b,_,B;if(f!==0){var k=t.getRotationPoint(e);b=k.x,_=k.y,r.translate(b,_),r.rotate(f),B=l.getImgSmoothing(r),B||l.setImgSmoothing(r,!0);var M=t.getRotationOffset(e);p=M.x,y=M.y}else p=v,y=h;var O;d!==1&&(O=r.globalAlpha,r.globalAlpha=O*d),r.drawImage(c.texture.canvas,c.x,0,c.width,c.height,p,y,m,g),d!==1&&(r.globalAlpha=O),f!==0&&(r.rotate(-f),r.translate(-b,-_),B||l.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var HC=function(){return 0},WC=function(e,t){return e.getTextAngle(t,null)},KC=function(e,t){return e.getTextAngle(t,"source")},UC=function(e,t){return e.getTextAngle(t,"target")},XC=function(e,t){return t.effectiveOpacity()},Ns=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};Nr.drawCachedElement=function(r,e,t,n,a,i){var o=this,s=o.data,l=s.eleTxrCache,u=s.lblTxrCache,c=s.slbTxrCache,d=s.tlbTxrCache,f=e.boundingBox(),v=i===!0?l.reasons.highQuality:null;if(!(f.w===0||f.h===0||!e.visible())&&(!n||vl(f,n))){var h=e.isEdge(),m=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,l,t,a,v,HC,XC),(!h||!m)&&o.drawCachedElementPortion(r,e,u,t,a,v,WC,Ns),h&&!m&&(o.drawCachedElementPortion(r,e,c,t,a,v,KC,Ns),o.drawCachedElementPortion(r,e,d,t,a,v,UC,Ns)),o.drawElementOverlay(r,e)}};Nr.drawElements=function(r,e){for(var t=this,n=0;n<e.length;n++){var a=e[n];t.drawElement(r,a)}};Nr.drawCachedElements=function(r,e,t,n){for(var a=this,i=0;i<e.length;i++){var o=e[i];a.drawCachedElement(r,o,t,n)}};Nr.drawCachedNodes=function(r,e,t,n){for(var a=this,i=0;i<e.length;i++){var o=e[i];o.isNode()&&a.drawCachedElement(r,o,t,n)}};Nr.drawLayeredElements=function(r,e,t,n){var a=this,i=a.data.lyrTxrCache.getLayers(e,t);if(i)for(var o=0;o<i.length;o++){var s=i[o],l=s.bb;l.w===0||l.h===0||r.drawImage(s.canvas,l.x1,l.y1,l.w,l.h)}else a.drawCachedElements(r,e,t,n)};var Qr={};Qr.drawEdge=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s=e._private.rscratch;if(!(i&&!e.visible())&&!(s.badLine||s.allpts==null||isNaN(s.allpts[0]))){var l;t&&(l=t,r.translate(-l.x1,-l.y1));var u=i?e.pstyle("opacity").value:1,c=i?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,f=e.pstyle("line-style").value,v=e.pstyle("width").pfValue,h=e.pstyle("line-cap").value,m=e.pstyle("line-outline-width").value,g=e.pstyle("line-outline-color").value,p=u*c,y=u*c,b=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p;d==="straight-triangle"?(o.eleStrokeStyle(r,e,w),o.drawEdgeTrianglePath(e,r,s.allpts)):(r.lineWidth=v,r.lineCap=h,o.eleStrokeStyle(r,e,w),o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},_=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p;if(r.lineWidth=v+m,r.lineCap=h,m>0)o.colorStrokeStyle(r,g[0],g[1],g[2],w);else{r.lineCap="butt";return}d==="straight-triangle"?o.drawEdgeTrianglePath(e,r,s.allpts):(o.drawEdgePath(e,r,s.allpts,f),r.lineCap="butt")},B=function(){a&&o.drawEdgeOverlay(r,e)},k=function(){a&&o.drawEdgeUnderlay(r,e)},M=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;o.drawArrowheads(r,e,w)},O=function(){o.drawElementText(r,e,null,n)};r.lineJoin="round";var P=e.pstyle("ghost").value==="yes";if(P){var L=e.pstyle("ghost-offset-x").pfValue,F=e.pstyle("ghost-offset-y").pfValue,E=e.pstyle("ghost-opacity").value,A=p*E;r.translate(L,F),b(A),M(A),r.translate(-L,-F)}else _();k(),b(),M(),B(),O(),t&&r.translate(l.x1,l.y1)}};var Rf=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var a=n.pstyle("".concat(e,"-opacity")).value;if(a!==0){var i=this,o=i.usePaths(),s=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,c=n.pstyle("".concat(e,"-color")).value;t.lineWidth=u,s.edgeType==="self"&&!o?t.lineCap="butt":t.lineCap="round",i.colorStrokeStyle(t,c[0],c[1],c[2],a),i.drawEdgePath(n,t,s.allpts,"solid")}}}};Qr.drawEdgeOverlay=Rf("overlay");Qr.drawEdgeUnderlay=Rf("underlay");Qr.drawEdgePath=function(r,e,t,n){var a=r._private.rscratch,i=e,o,s=!1,l=this.usePaths(),u=r.pstyle("line-dash-pattern").pfValue,c=r.pstyle("line-dash-offset").pfValue;if(l){var d=t.join("$"),f=a.pathCacheKey&&a.pathCacheKey===d;f?(o=e=a.pathCache,s=!0):(o=e=new Path2D,a.pathCacheKey=d,a.pathCache=o)}if(i.setLineDash)switch(n){case"dotted":i.setLineDash([1,1]);break;case"dashed":i.setLineDash(u),i.lineDashOffset=c;break;case"solid":i.setLineDash([]);break}if(!s&&!a.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),a.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var v=2;v+3<t.length;v+=4)e.quadraticCurveTo(t[v],t[v+1],t[v+2],t[v+3]);break;case"straight":case"haystack":for(var h=2;h+1<t.length;h+=2)e.lineTo(t[h],t[h+1]);break;case"segments":if(a.isRound){var m=or(a.roundCorners),g;try{for(m.s();!(g=m.n()).done;){var p=g.value;xf(e,p)}}catch(b){m.e(b)}finally{m.f()}e.lineTo(t[t.length-2],t[t.length-1])}else for(var y=2;y+1<t.length;y+=2)e.lineTo(t[y],t[y+1]);break}e=i,l?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};Qr.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var n=r.pstyle("width").pfValue,a=0;a+1<t.length;a+=2){var i=[t[a+2]-t[a],t[a+3]-t[a+1]],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=[i[1]/o,-i[0]/o],l=[s[0]*n/2,s[1]*n/2];e.beginPath(),e.moveTo(t[a]-l[0],t[a+1]-l[1]),e.lineTo(t[a]+l[0],t[a+1]+l[1]),e.lineTo(t[a+2],t[a+3]),e.closePath(),e.fill()}};Qr.drawArrowheads=function(r,e,t){var n=e._private.rscratch,a=n.edgeType==="haystack";a||this.drawArrowhead(r,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,t),a||this.drawArrowhead(r,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,t)};Qr.drawArrowhead=function(r,e,t,n,a,i,o){if(!(isNaN(n)||n==null||isNaN(a)||a==null||isNaN(i)||i==null)){var s=this,l=e.pstyle(t+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(t+"-arrow-fill").value,d=e.pstyle("width").pfValue,f=e.pstyle(t+"-arrow-width"),v=f.value==="match-line"?d:f.pfValue;f.units==="%"&&(v*=d);var h=e.pstyle("opacity").value;o===void 0&&(o=h);var m=r.globalCompositeOperation;(o!==1||c==="hollow")&&(r.globalCompositeOperation="destination-out",s.colorFillStyle(r,255,255,255,1),s.colorStrokeStyle(r,255,255,255,1),s.drawArrowShape(e,r,u,d,l,v,n,a,i),r.globalCompositeOperation=m);var g=e.pstyle(t+"-arrow-color").value;s.colorFillStyle(r,g[0],g[1],g[2],o),s.colorStrokeStyle(r,g[0],g[1],g[2],o),s.drawArrowShape(e,r,c,d,l,v,n,a,i)}}};Qr.drawArrowShape=function(r,e,t,n,a,i,o,s,l){var u=this,c=this.usePaths()&&a!=="triangle-cross",d=!1,f,v=e,h={x:o,y:s},m=r.pstyle("arrow-scale").value,g=this.getArrowWidth(n,m),p=u.arrowShapes[a];if(c){var y=u.arrowPathCache=u.arrowPathCache||[],b=hn(a),_=y[b];_!=null?(f=e=_,d=!0):(f=e=new Path2D,y[b]=f)}d||(e.beginPath&&e.beginPath(),c?p.draw(e,1,0,{x:0,y:0},1):p.draw(e,g,l,h,n),e.closePath&&e.closePath()),e=v,c&&(e.translate(o,s),e.rotate(l),e.scale(g,g)),(t==="filled"||t==="both")&&(c?e.fill(f):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=i/(c?g:1),e.lineJoin="miter",c?e.stroke(f):e.stroke()),c&&(e.scale(1/g,1/g),e.rotate(-l),e.translate(-o,-s))};var kl={};kl.safeDrawImage=function(r,e,t,n,a,i,o,s,l,u){if(!(a<=0||i<=0||l<=0||u<=0))try{r.drawImage(e,t,n,a,i,o,s,l,u)}catch(c){Ye(c)}};kl.drawInscribedImage=function(r,e,t,n,a){var i=this,o=t.position(),s=o.x,l=o.y,u=t.cy().style(),c=u.getIndexedStyle.bind(u),d=c(t,"background-fit","value",n),f=c(t,"background-repeat","value",n),v=t.width(),h=t.height(),m=t.padding()*2,g=v+(c(t,"background-width-relative-to","value",n)==="inner"?0:m),p=h+(c(t,"background-height-relative-to","value",n)==="inner"?0:m),y=t._private.rscratch,b=c(t,"background-clip","value",n),_=b==="node",B=c(t,"background-image-opacity","value",n)*a,k=c(t,"background-image-smoothing","value",n),M=t.pstyle("corner-radius").value;M!=="auto"&&(M=t.pstyle("corner-radius").pfValue);var O=e.width||e.cachedW,P=e.height||e.cachedH;(O==null||P==null)&&(document.body.appendChild(e),O=e.cachedW=e.width||e.offsetWidth,P=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var L=O,F=P;if(c(t,"background-width","value",n)!=="auto"&&(c(t,"background-width","units",n)==="%"?L=c(t,"background-width","pfValue",n)*g:L=c(t,"background-width","pfValue",n)),c(t,"background-height","value",n)!=="auto"&&(c(t,"background-height","units",n)==="%"?F=c(t,"background-height","pfValue",n)*p:F=c(t,"background-height","pfValue",n)),!(L===0||F===0)){if(d==="contain"){var E=Math.min(g/L,p/F);L*=E,F*=E}else if(d==="cover"){var E=Math.max(g/L,p/F);L*=E,F*=E}var A=s-g/2,S=c(t,"background-position-x","units",n),w=c(t,"background-position-x","pfValue",n);S==="%"?A+=(g-L)*w:A+=w;var C=c(t,"background-offset-x","units",n),x=c(t,"background-offset-x","pfValue",n);C==="%"?A+=(g-L)*x:A+=x;var D=l-p/2,T=c(t,"background-position-y","units",n),V=c(t,"background-position-y","pfValue",n);T==="%"?D+=(p-F)*V:D+=V;var z=c(t,"background-offset-y","units",n),j=c(t,"background-offset-y","pfValue",n);z==="%"?D+=(p-F)*j:D+=j,y.pathCache&&(A-=s,D-=l,s=0,l=0);var U=r.globalAlpha;r.globalAlpha=B;var Y=i.getImgSmoothing(r),te=!1;if(k==="no"&&Y?(i.setImgSmoothing(r,!1),te=!0):k==="yes"&&!Y&&(i.setImgSmoothing(r,!0),te=!0),f==="no-repeat")_&&(r.save(),y.pathCache?r.clip(y.pathCache):(i.nodeShapes[i.getNodeShape(t)].draw(r,s,l,g,p,M,y),r.clip())),i.safeDrawImage(r,e,0,0,O,P,A,D,L,F),_&&r.restore();else{var J=r.createPattern(e,f);r.fillStyle=J,i.nodeShapes[i.getNodeShape(t)].draw(r,s,l,g,p,M,y),r.translate(A,D),r.fill(),r.translate(-A,-D)}r.globalAlpha=U,te&&i.setImgSmoothing(r,Y)}};var Nn={};Nn.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),n=this.getPixelRatio(),a=Math.ceil(hl(t*n));e=Math.pow(2,a)}var i=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(i<o)};Nn.drawElementText=function(r,e,t,n,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(n==null){if(i&&!o.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var s=e.pstyle("label");if(!s||!s.value)return;var l=o.getLabelJustification(e);r.textAlign=l,r.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,c=e.pstyle("label"),d=e.pstyle("source-label"),f=e.pstyle("target-label");if(u||(!c||!c.value)&&(!d||!d.value)&&(!f||!f.value))return;r.textAlign="center",r.textBaseline="bottom"}var v=!t,h;t&&(h=t,r.translate(-h.x1,-h.y1)),a==null?(o.drawText(r,e,null,v,i),e.isEdge()&&(o.drawText(r,e,"source",v,i),o.drawText(r,e,"target",v,i))):o.drawText(r,e,a,v,i),t&&r.translate(h.x1,h.y1)};Nn.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};Nn.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue+"px",i=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,s=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*s,u=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;r.font=n+" "+o+" "+a+" "+i,r.lineJoin="round",this.colorFillStyle(r,u[0],u[1],u[2],s),this.colorStrokeStyle(r,c[0],c[1],c[2],l)};function zs(r,e,t,n,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0;r.beginPath(),r.moveTo(e+i,t),r.lineTo(e+n-i,t),r.quadraticCurveTo(e+n,t,e+n,t+i),r.lineTo(e+n,t+a-i),r.quadraticCurveTo(e+n,t+a,e+n-i,t+a),r.lineTo(e+i,t+a),r.quadraticCurveTo(e,t+a,e,t+a-i),r.lineTo(e,t+i),r.quadraticCurveTo(e,t,e+i,t),r.closePath(),o?r.stroke():r.fill()}Nn.getTextAngle=function(r,e){var t,n=r._private,a=n.rscratch,i=e?e+"-":"",o=r.pstyle(i+"text-rotation");if(o.strValue==="autorotate"){var s=xr(a,"labelAngle",e);t=r.isEdge()?s:0}else o.strValue==="none"?t=0:t=o.pfValue;return t};Nn.drawText=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=e._private,o=i.rscratch,s=a?e.effectiveOpacity():1;if(!(a&&(s===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var l=xr(o,"labelX",t),u=xr(o,"labelY",t),c,d,f=this.getLabelText(e,t);if(f!=null&&f!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(r,e,a);var v=t?t+"-":"",h=xr(o,"labelWidth",t),m=xr(o,"labelHeight",t),g=e.pstyle(v+"text-margin-x").pfValue,p=e.pstyle(v+"text-margin-y").pfValue,y=e.isEdge(),b=e.pstyle("text-halign").value,_=e.pstyle("text-valign").value;y&&(b="center",_="center"),l+=g,u+=p;var B;switch(n?B=this.getTextAngle(e,t):B=0,B!==0&&(c=l,d=u,r.translate(c,d),r.rotate(B),l=0,u=0),_){case"top":break;case"center":u+=m/2;break;case"bottom":u+=m;break}var k=e.pstyle("text-background-opacity").value,M=e.pstyle("text-border-opacity").value,O=e.pstyle("text-border-width").pfValue,P=e.pstyle("text-background-padding").pfValue,L=e.pstyle("text-background-shape").strValue,F=L.indexOf("round")===0,E=2;if(k>0||O>0&&M>0){var A=l-P;switch(b){case"left":A-=h;break;case"center":A-=h/2;break}var S=u-m-P,w=h+2*P,C=m+2*P;if(k>0){var x=r.fillStyle,D=e.pstyle("text-background-color").value;r.fillStyle="rgba("+D[0]+","+D[1]+","+D[2]+","+k*s+")",F?zs(r,A,S,w,C,E):r.fillRect(A,S,w,C),r.fillStyle=x}if(O>0&&M>0){var T=r.strokeStyle,V=r.lineWidth,z=e.pstyle("text-border-color").value,j=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+z[0]+","+z[1]+","+z[2]+","+M*s+")",r.lineWidth=O,r.setLineDash)switch(j){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=O/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(F?zs(r,A,S,w,C,E,"stroke"):r.strokeRect(A,S,w,C),j==="double"){var U=O/2;F?zs(r,A+U,S+U,w-U*2,C-U*2,E,"stroke"):r.strokeRect(A+U,S+U,w-U*2,C-U*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=V,r.strokeStyle=T}}var Y=2*e.pstyle("text-outline-width").pfValue;if(Y>0&&(r.lineWidth=Y),e.pstyle("text-wrap").value==="wrap"){var te=xr(o,"labelWrapCachedLines",t),J=xr(o,"labelLineHeight",t),ne=h/2,ae=this.getLabelJustification(e);switch(ae==="auto"||(b==="left"?ae==="left"?l+=-h:ae==="center"&&(l+=-ne):b==="center"?ae==="left"?l+=-ne:ae==="right"&&(l+=ne):b==="right"&&(ae==="center"?l+=ne:ae==="right"&&(l+=h))),_){case"top":u-=(te.length-1)*J;break;case"center":case"bottom":u-=(te.length-1)*J;break}for(var K=0;K<te.length;K++)Y>0&&r.strokeText(te[K],l,u),r.fillText(te[K],l,u),u+=J}else Y>0&&r.strokeText(f,l,u),r.fillText(f,l,u);B!==0&&(r.rotate(-B),r.translate(-c,-d))}}};var xa={};xa.drawNode=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,s,l,u=e._private,c=u.rscratch,d=e.position();if(!(!Ce(d.x)||!Ce(d.y))&&!(i&&!e.visible())){var f=i?e.effectiveOpacity():1,v=o.usePaths(),h,m=!1,g=e.padding();s=e.width()+2*g,l=e.height()+2*g;var p;t&&(p=t,r.translate(-p.x1,-p.y1));for(var y=e.pstyle("background-image"),b=y.value,_=new Array(b.length),B=new Array(b.length),k=0,M=0;M<b.length;M++){var O=b[M],P=_[M]=O!=null&&O!=="none";if(P){var L=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",M);k++,B[M]=o.getCachedImage(O,L,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var F=e.pstyle("background-blacken").value,E=e.pstyle("border-width").pfValue,A=e.pstyle("background-opacity").value*f,S=e.pstyle("border-color").value,w=e.pstyle("border-style").value,C=e.pstyle("border-join").value,x=e.pstyle("border-cap").value,D=e.pstyle("border-position").value,T=e.pstyle("border-dash-pattern").pfValue,V=e.pstyle("border-dash-offset").pfValue,z=e.pstyle("border-opacity").value*f,j=e.pstyle("outline-width").pfValue,U=e.pstyle("outline-color").value,Y=e.pstyle("outline-style").value,te=e.pstyle("outline-opacity").value*f,J=e.pstyle("outline-offset").value,ne=e.pstyle("corner-radius").value;ne!=="auto"&&(ne=e.pstyle("corner-radius").pfValue);var ae=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;o.eleFillStyle(r,e,Q)},K=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z;o.colorStrokeStyle(r,S[0],S[1],S[2],Q)},R=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:te;o.colorStrokeStyle(r,U[0],U[1],U[2],Q)},N=function(Q,ee,he,le){var ve=o.nodePathCache=o.nodePathCache||[],Re=Cd(he==="polygon"?he+","+le.join(","):he,""+ee,""+Q,""+ne),ze=ve[Re],Ae,Ve=!1;return ze!=null?(Ae=ze,Ve=!0,c.pathCache=Ae):(Ae=new Path2D,ve[Re]=c.pathCache=Ae),{path:Ae,cacheHit:Ve}},G=e.pstyle("shape").strValue,W=e.pstyle("shape-polygon-points").pfValue;if(v){r.translate(d.x,d.y);var X=N(s,l,G,W);h=X.path,m=X.cacheHit}var de=function(){if(!m){var Q=d;v&&(Q={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(h||r,Q.x,Q.y,s,l,ne,c)}v?r.fill(h):r.fill()},Te=function(){for(var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,he=u.backgrounding,le=0,ve=0;ve<B.length;ve++){var Re=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ve);if(ee&&Re==="over"||!ee&&Re==="inside"){le++;continue}_[ve]&&B[ve].complete&&!B[ve].error&&(le++,o.drawInscribedImage(r,B[ve],e,ve,Q))}u.backgrounding=le!==k,he!==u.backgrounding&&e.updateStyle(!1)},xe=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;o.hasPie(e)&&(o.drawPie(r,e,ee),Q&&(v||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,s,l,ne,c)))},fe=function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,ee=(F>0?F:-F)*Q,he=F>0?0:255;F!==0&&(o.colorFillStyle(r,he,he,he,ee),v?r.fill(h):r.fill())},ce=function(){if(E>0){if(r.lineWidth=E,r.lineCap=x,r.lineJoin=C,r.setLineDash)switch(w){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(T),r.lineDashOffset=V;break;case"solid":case"double":r.setLineDash([]);break}if(D!=="center"){if(r.save(),r.lineWidth*=2,D==="inside")v?r.clip(h):r.clip();else{var Q=new Path2D;Q.rect(-s/2-E,-l/2-E,s+2*E,l+2*E),Q.addPath(h),r.clip(Q,"evenodd")}v?r.stroke(h):r.stroke(),r.restore()}else v?r.stroke(h):r.stroke();if(w==="double"){r.lineWidth=E/3;var ee=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",v?r.stroke(h):r.stroke(),r.globalCompositeOperation=ee}r.setLineDash&&r.setLineDash([])}},be=function(){if(j>0){if(r.lineWidth=j,r.lineCap="butt",r.setLineDash)switch(Y){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var Q=d;v&&(Q={x:0,y:0});var ee=o.getNodeShape(e),he=E;D==="inside"&&(he=0),D==="outside"&&(he*=2);var le=(s+he+(j+J))/s,ve=(l+he+(j+J))/l,Re=s*le,ze=l*ve,Ae=o.nodeShapes[ee].points,Ve;if(v){var Ne=N(Re,ze,ee,Ae);Ve=Ne.path}if(ee==="ellipse")o.drawEllipsePath(Ve||r,Q.x,Q.y,Re,ze);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(ee)){var Le=0,et=0,it=0;ee==="round-diamond"?Le=(he+J+j)*1.4:ee==="round-heptagon"?(Le=(he+J+j)*1.075,it=-(he/2+J+j)/35):ee==="round-hexagon"?Le=(he+J+j)*1.12:ee==="round-pentagon"?(Le=(he+J+j)*1.13,it=-(he/2+J+j)/15):ee==="round-tag"?(Le=(he+J+j)*1.12,et=(he/2+j+J)*.07):ee==="round-triangle"&&(Le=(he+J+j)*(Math.PI/2),it=-(he+J/2+j)/Math.PI),Le!==0&&(le=(s+Le)/s,Re=s*le,["round-hexagon","round-tag"].includes(ee)||(ve=(l+Le)/l,ze=l*ve)),ne=ne==="auto"?Pd(Re,ze):ne;for(var nr=Re/2,ar=ze/2,ft=ne+(he+j+J)/2,mt=new Array(Ae.length/2),yt=new Array(Ae.length/2),zt=0;zt<Ae.length/2;zt++)mt[zt]={x:Q.x+et+nr*Ae[zt*2],y:Q.y+it+ar*Ae[zt*2+1]};var jt,Er,lr,Tr,jr=mt.length;for(Er=mt[jr-1],jt=0;jt<jr;jt++)lr=mt[jt%jr],Tr=mt[(jt+1)%jr],yt[jt]=Ml(Er,lr,Tr,ft),Er=lr,lr=Tr;o.drawRoundPolygonPath(Ve||r,Q.x+et,Q.y+it,s*le,l*ve,Ae,yt)}else if(["roundrectangle","round-rectangle"].includes(ee))ne=ne==="auto"?Rn(Re,ze):ne,o.drawRoundRectanglePath(Ve||r,Q.x,Q.y,Re,ze,ne+(he+j+J)/2);else if(["cutrectangle","cut-rectangle"].includes(ee))ne=ne==="auto"?pl():ne,o.drawCutRectanglePath(Ve||r,Q.x,Q.y,Re,ze,null,ne+(he+j+J)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(ee))ne=ne==="auto"?Rn(Re,ze):ne,o.drawBottomRoundRectanglePath(Ve||r,Q.x,Q.y,Re,ze,ne+(he+j+J)/2);else if(ee==="barrel")o.drawBarrelPath(Ve||r,Q.x,Q.y,Re,ze);else if(ee.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(ee)){var Gr=(he+j+J)/s;Ae=Fo(Lo(Ae,Gr)),o.drawPolygonPath(Ve||r,Q.x,Q.y,s,l,Ae)}else{var kt=(he+j+J)/s;Ae=Fo(Lo(Ae,-kt)),o.drawPolygonPath(Ve||r,Q.x,Q.y,s,l,Ae)}if(v?r.stroke(Ve):r.stroke(),Y==="double"){r.lineWidth=he/3;var Ct=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",v?r.stroke(Ve):r.stroke(),r.globalCompositeOperation=Ct}r.setLineDash&&r.setLineDash([])}},De=function(){a&&o.drawNodeOverlay(r,e,d,s,l)},Me=function(){a&&o.drawNodeUnderlay(r,e,d,s,l)},we=function(){o.drawElementText(r,e,null,n)},Se=e.pstyle("ghost").value==="yes";if(Se){var ye=e.pstyle("ghost-offset-x").pfValue,se=e.pstyle("ghost-offset-y").pfValue,I=e.pstyle("ghost-opacity").value,H=I*f;r.translate(ye,se),R(),be(),ae(I*A),de(),Te(H,!0),K(I*z),ce(),xe(F!==0||E!==0),Te(H,!1),fe(H),r.translate(-ye,-se)}v&&r.translate(-d.x,-d.y),Me(),v&&r.translate(d.x,d.y),R(),be(),ae(),de(),Te(f,!0),K(),ce(),xe(F!==0||E!==0),Te(f,!1),fe(),v&&r.translate(-d.x,-d.y),we(),De(),t&&r.translate(p.x1,p.y1)}};var Of=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,a,i,o){var s=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,d=n.pstyle("".concat(e,"-shape")).value,f=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(a=a||n.position(),i==null||o==null){var v=n.padding();i=n.width()+2*v,o=n.height()+2*v}s.colorFillStyle(t,c[0],c[1],c[2],u),s.nodeShapes[d].draw(t,a.x,a.y,i+l*2,o+l*2,f),t.fill()}}}};xa.drawNodeOverlay=Of("overlay");xa.drawNodeUnderlay=Of("underlay");xa.hasPie=function(r){return r=r[0],r._private.hasPie};xa.drawPie=function(r,e,t,n){e=e[0],n=n||e.position();var a=e.cy().style(),i=e.pstyle("pie-size"),o=n.x,s=n.y,l=e.width(),u=e.height(),c=Math.min(l,u)/2,d=0,f=this.usePaths();f&&(o=0,s=0),i.units==="%"?c=c*i.pfValue:i.pfValue!==void 0&&(c=i.pfValue/2);for(var v=1;v<=a.pieBackgroundN;v++){var h=e.pstyle("pie-"+v+"-background-size").value,m=e.pstyle("pie-"+v+"-background-color").value,g=e.pstyle("pie-"+v+"-background-opacity").value*t,p=h/100;p+d>1&&(p=1-d);var y=1.5*Math.PI+2*Math.PI*d,b=2*Math.PI*p,_=y+b;h===0||d>=1||d+p>1||(r.beginPath(),r.moveTo(o,s),r.arc(o,s,c,y,_),r.closePath(),this.colorFillStyle(r,m[0],m[1],m[2],g),r.fill(),d+=p)}};var $t={},YC=100;$t.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),t=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/t};$t.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,n,a=0;a<e.length;a++)if(n=e[a],n.context===r){t=!1;break}return t&&(n={context:r},e.push(n)),n};$t.createGradientStyleFor=function(r,e,t,n,a){var i,o=this.usePaths(),s=t.pstyle(e+"-gradient-stop-colors").value,l=t.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(t.isEdge()){var u=t.sourceEndpoint(),c=t.targetEndpoint(),d=t.midpoint(),f=In(u,d),v=In(c,d);i=r.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(f,v))}else{var h=o?{x:0,y:0}:t.position(),m=t.paddedWidth(),g=t.paddedHeight();i=r.createRadialGradient(h.x,h.y,0,h.x,h.y,Math.max(m,g))}else if(t.isEdge()){var p=t.sourceEndpoint(),y=t.targetEndpoint();i=r.createLinearGradient(p.x,p.y,y.x,y.y)}else{var b=o?{x:0,y:0}:t.position(),_=t.paddedWidth(),B=t.paddedHeight(),k=_/2,M=B/2,O=t.pstyle("background-gradient-direction").value;switch(O){case"to-bottom":i=r.createLinearGradient(b.x,b.y-M,b.x,b.y+M);break;case"to-top":i=r.createLinearGradient(b.x,b.y+M,b.x,b.y-M);break;case"to-left":i=r.createLinearGradient(b.x+k,b.y,b.x-k,b.y);break;case"to-right":i=r.createLinearGradient(b.x-k,b.y,b.x+k,b.y);break;case"to-bottom-right":case"to-right-bottom":i=r.createLinearGradient(b.x-k,b.y-M,b.x+k,b.y+M);break;case"to-top-right":case"to-right-top":i=r.createLinearGradient(b.x-k,b.y+M,b.x+k,b.y-M);break;case"to-bottom-left":case"to-left-bottom":i=r.createLinearGradient(b.x+k,b.y-M,b.x-k,b.y+M);break;case"to-top-left":case"to-left-top":i=r.createLinearGradient(b.x+k,b.y+M,b.x-k,b.y-M);break}}if(!i)return null;for(var P=l.length===s.length,L=s.length,F=0;F<L;F++)i.addColorStop(P?l[F]:F/(L-1),"rgba("+s[F][0]+","+s[F][1]+","+s[F][2]+","+a+")");return i};$t.gradientFillStyle=function(r,e,t,n){var a=this.createGradientStyleFor(r,"background",e,t,n);if(!a)return null;r.fillStyle=a};$t.colorFillStyle=function(r,e,t,n,a){r.fillStyle="rgba("+e+","+t+","+n+","+a+")"};$t.eleFillStyle=function(r,e,t){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(r,e,n,t);else{var a=e.pstyle("background-color").value;this.colorFillStyle(r,a[0],a[1],a[2],t)}};$t.gradientStrokeStyle=function(r,e,t,n){var a=this.createGradientStyleFor(r,"line",e,t,n);if(!a)return null;r.strokeStyle=a};$t.colorStrokeStyle=function(r,e,t,n,a){r.strokeStyle="rgba("+e+","+t+","+n+","+a+")"};$t.eleStrokeStyle=function(r,e,t){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(r,e,n,t);else{var a=e.pstyle("line-color").value;this.colorStrokeStyle(r,a[0],a[1],a[2],t)}};$t.matchCanvasSize=function(r){var e=this,t=e.data,n=e.findContainerClientCoords(),a=n[2],i=n[3],o=e.getPixelRatio(),s=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var l=a*o,u=i*o,c;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var d=t.canvasContainer;d.style.width=a+"px",d.style.height=i+"px";for(var f=0;f<e.CANVAS_LAYERS;f++)c=t.canvases[f],c.width=l,c.height=u,c.style.width=a+"px",c.style.height=i+"px";for(var f=0;f<e.BUFFER_COUNT;f++)c=t.bufferCanvases[f],c.width=l,c.height=u,c.style.width=a+"px",c.style.height=i+"px";e.textureMult=1,o<=1&&(c=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=l*e.textureMult,c.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=o}};$t.renderTo=function(r,e,t,n){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:n})};$t.clearCanvas=function(){var r=this,e=r.data;function t(n){n.clearRect(0,0,r.canvasWidth,r.canvasHeight)}t(e.contexts[r.NODE]),t(e.contexts[r.DRAG])};$t.render=function(r){var e=this;r=r||_d();var t=e.cy,n=r.forcedContext,a=r.drawAllLayers,i=r.drawOnlyNodeLayer,o=r.forcedZoom,s=r.forcedPan,l=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,u=e.data,c=u.canvasNeedsRedraw,d=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),f=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,v=e.motionBlurPxRatio,h=t.hasCompoundNodes(),m=e.hoverData.draggingEles,g=!!(e.hoverData.selecting||e.touchData.selecting);f=f&&!n&&e.motionBlurEnabled&&!g;var p=f;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),f&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(p=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var y=t.style(),b=t.zoom(),_=o!==void 0?o:b,B=t.pan(),k={x:B.x,y:B.y},M={zoom:b,pan:{x:B.x,y:B.y}},O=e.prevViewport,P=O===void 0||M.zoom!==O.zoom||M.pan.x!==O.pan.x||M.pan.y!==O.pan.y;!P&&!(m&&!h)&&(e.motionBlurPxRatio=1),s&&(k=s),_*=l,k.x*=l,k.y*=l;var L=e.getCachedZSortedEles();function F(K,R,N,G,W){var X=K.globalCompositeOperation;K.globalCompositeOperation="destination-out",e.colorFillStyle(K,255,255,255,e.motionBlurTransparency),K.fillRect(R,N,G,W),K.globalCompositeOperation=X}function E(K,R){var N,G,W,X;!e.clearingMotionBlur&&(K===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||K===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(N={x:B.x*v,y:B.y*v},G=b*v,W=e.canvasWidth*v,X=e.canvasHeight*v):(N=k,G=_,W=e.canvasWidth,X=e.canvasHeight),K.setTransform(1,0,0,1,0,0),R==="motionBlur"?F(K,0,0,W,X):!n&&(R===void 0||R)&&K.clearRect(0,0,W,X),a||(K.translate(N.x,N.y),K.scale(G,G)),s&&K.translate(s.x,s.y),o&&K.scale(o,o)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=t.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var A=e.data.bufferContexts[e.TEXTURE_BUFFER];A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:A,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var M=e.textureCache.viewport={zoom:t.zoom(),pan:t.pan(),width:e.canvasWidth,height:e.canvasHeight};M.mpan={x:(0-M.pan.x)/M.zoom,y:(0-M.pan.y)/M.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var S=u.contexts[e.NODE],w=e.textureCache.texture,M=e.textureCache.viewport;S.setTransform(1,0,0,1,0,0),f?F(S,0,0,M.width,M.height):S.clearRect(0,0,M.width,M.height);var C=y.core("outside-texture-bg-color").value,x=y.core("outside-texture-bg-opacity").value;e.colorFillStyle(S,C[0],C[1],C[2],x),S.fillRect(0,0,M.width,M.height);var b=t.zoom();E(S,!1),S.clearRect(M.mpan.x,M.mpan.y,M.width/M.zoom/l,M.height/M.zoom/l),S.drawImage(w,M.mpan.x,M.mpan.y,M.width/M.zoom/l,M.height/M.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var D=t.extent(),T=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),V=e.hideEdgesOnViewport&&T,z=[];if(z[e.NODE]=!c[e.NODE]&&f&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,z[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),z[e.DRAG]=!c[e.DRAG]&&f&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,z[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||a||i||z[e.NODE]){var j=f&&!z[e.NODE]&&v!==1,S=n||(j?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),U=f&&!j?"motionBlur":void 0;E(S,U),V?e.drawCachedNodes(S,L.nondrag,l,D):e.drawLayeredElements(S,L.nondrag,l,D),e.debug&&e.drawDebugPoints(S,L.nondrag),!a&&!f&&(c[e.NODE]=!1)}if(!i&&(c[e.DRAG]||a||z[e.DRAG])){var j=f&&!z[e.DRAG]&&v!==1,S=n||(j?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);E(S,f&&!j?"motionBlur":void 0),V?e.drawCachedNodes(S,L.drag,l,D):e.drawCachedElements(S,L.drag,l,D),e.debug&&e.drawDebugPoints(S,L.drag),!a&&!f&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,E),f&&v!==1){var Y=u.contexts[e.NODE],te=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],J=u.contexts[e.DRAG],ne=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ae=function(R,N,G){R.setTransform(1,0,0,1,0,0),G||!p?R.clearRect(0,0,e.canvasWidth,e.canvasHeight):F(R,0,0,e.canvasWidth,e.canvasHeight);var W=v;R.drawImage(N,0,0,e.canvasWidth*W,e.canvasHeight*W,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||z[e.NODE])&&(ae(Y,te,z[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||z[e.DRAG])&&(ae(J,ne,z[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=M,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),f&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},YC)),n||t.emit("render")};var Ba;$t.drawSelectionRectangle=function(r,e){var t=this,n=t.cy,a=t.data,i=n.style(),o=r.drawOnlyNodeLayer,s=r.drawAllLayers,l=a.canvasNeedsRedraw,u=r.forcedContext;if(t.showFps||!o&&l[t.SELECT_BOX]&&!s){var c=u||a.contexts[t.SELECT_BOX];if(e(c),t.selection[4]==1&&(t.hoverData.selecting||t.touchData.selecting)){var d=t.cy.zoom(),f=i.core("selection-box-border-width").value/d;c.lineWidth=f,c.fillStyle="rgba("+i.core("selection-box-color").value[0]+","+i.core("selection-box-color").value[1]+","+i.core("selection-box-color").value[2]+","+i.core("selection-box-opacity").value+")",c.fillRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]),f>0&&(c.strokeStyle="rgba("+i.core("selection-box-border-color").value[0]+","+i.core("selection-box-border-color").value[1]+","+i.core("selection-box-border-color").value[2]+","+i.core("selection-box-opacity").value+")",c.strokeRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]))}if(a.bgActivePosistion&&!t.hoverData.selecting){var d=t.cy.zoom(),v=a.bgActivePosistion;c.fillStyle="rgba("+i.core("active-bg-color").value[0]+","+i.core("active-bg-color").value[1]+","+i.core("active-bg-color").value[2]+","+i.core("active-bg-opacity").value+")",c.beginPath(),c.arc(v.x,v.y,i.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var h=t.lastRedrawTime;if(t.showFps&&h){h=Math.round(h);var m=Math.round(1e3/h),g="1 frame = "+h+" ms = "+m+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!Ba){var p=c.measureText(g);Ba=p.actualBoundingBoxAscent}c.fillText(g,0,Ba);var y=60;c.strokeRect(0,Ba+10,250,20),c.fillRect(0,Ba+10,250*Math.min(m/y,1),20)}s||(l[t.SELECT_BOX]=!1)}};function Yc(r,e,t){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(n));return n}function QC(r,e,t){var n=Yc(r,r.VERTEX_SHADER,e),a=Yc(r,r.FRAGMENT_SHADER,t),i=r.createProgram();if(r.attachShader(i,n),r.attachShader(i,a),r.linkProgram(i),!r.getProgramParameter(i,r.LINK_STATUS))throw new Error("Could not initialize shaders");return i}function ZC(r,e,t){t===void 0&&(t=e);var n=r.makeOffscreenCanvas(e,t),a=n.context=n.getContext("2d");return n.clear=function(){return a.clearRect(0,0,n.width,n.height)},n.clear(),n}function Pl(r){var e=r.pixelRatio,t=r.cy.zoom(),n=r.cy.pan();return{zoom:t*e,pan:{x:n.x*e,y:n.y*e}}}function js(r,e,t,n,a){var i=n*t+e.x,o=a*t+e.y;return o=Math.round(r.canvasHeight-o),[i,o]}function xo(r,e,t){var n=r[0]/255,a=r[1]/255,i=r[2]/255,o=e,s=t||new Array(4);return s[0]=n*o,s[1]=a*o,s[2]=i*o,s[3]=o,s}function _o(r,e){var t=e||new Array(4);return t[0]=(r>>0&255)/255,t[1]=(r>>8&255)/255,t[2]=(r>>16&255)/255,t[3]=(r>>24&255)/255,t}function JC(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function eb(r,e){var t=r.createTexture();return t.buffer=function(n){r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},t.deleteTexture=function(){r.deleteTexture(t)},t}function Ff(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function Lf(r,e,t){switch(e){case r.FLOAT:return new Float32Array(t);case r.INT:return new Int32Array(t)}}function tb(r,e,t,n,a,i){switch(e){case r.FLOAT:return new Float32Array(t.buffer,i*n,a);case r.INT:return new Int32Array(t.buffer,i*n,a)}}function rb(r,e,t,n){var a=Ff(r,e),i=dt(a,2),o=i[0],s=i[1],l=Lf(r,s,n),u=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,l,r.STATIC_DRAW),s===r.FLOAT?r.vertexAttribPointer(t,o,s,!1,0,0):s===r.INT&&r.vertexAttribIPointer(t,o,s,0,0),r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,null),u}function ir(r,e,t,n){var a=Ff(r,t),i=dt(a,3),o=i[0],s=i[1],l=i[2],u=Lf(r,s,e*o),c=o*l,d=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,d),r.bufferData(r.ARRAY_BUFFER,e*c,r.DYNAMIC_DRAW),r.enableVertexAttribArray(n),s===r.FLOAT?r.vertexAttribPointer(n,o,s,!1,c,0):s===r.INT&&r.vertexAttribIPointer(n,o,s,c,0),r.vertexAttribDivisor(n,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var f=new Array(e),v=0;v<e;v++)f[v]=tb(r,s,u,c,o,v);return d.dataArray=u,d.stride=c,d.size=o,d.getView=function(h){return f[h]},d.setPoint=function(h,m,g){var p=f[h];p[0]=m,p[1]=g},d.bufferSubData=function(h){r.bindBuffer(r.ARRAY_BUFFER,d),h?r.bufferSubData(r.ARRAY_BUFFER,0,u,0,h*o):r.bufferSubData(r.ARRAY_BUFFER,0,u)},d}function nb(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,a){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,a,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var Qc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function ja(){var r=new Qc(9);return Qc!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Vf(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function ab(r,e,t){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=t[0],v=t[1],h=t[2],m=t[3],g=t[4],p=t[5],y=t[6],b=t[7],_=t[8];return r[0]=f*n+v*o+h*u,r[1]=f*a+v*s+h*c,r[2]=f*i+v*l+h*d,r[3]=m*n+g*o+p*u,r[4]=m*a+g*s+p*c,r[5]=m*i+g*l+p*d,r[6]=y*n+b*o+_*u,r[7]=y*a+b*s+_*c,r[8]=y*i+b*l+_*d,r}function qo(r,e,t){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=t[0],v=t[1];return r[0]=n,r[1]=a,r[2]=i,r[3]=o,r[4]=s,r[5]=l,r[6]=f*n+v*o+u,r[7]=f*a+v*s+c,r[8]=f*i+v*l+d,r}function Nf(r,e,t){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],d=e[8],f=Math.sin(t),v=Math.cos(t);return r[0]=v*n+f*o,r[1]=v*a+f*s,r[2]=v*i+f*l,r[3]=v*o-f*n,r[4]=v*s-f*a,r[5]=v*l-f*i,r[6]=u,r[7]=c,r[8]=d,r}function Al(r,e,t){var n=t[0],a=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function ib(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var Ga={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},Ia=St({getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:null,getPadding:null}),ob=function(){function r(e,t){Cn(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.atlasSize=t.webglTexSize,this.rows=t.webglTexRows,this.enableWrapping=t.enableWrapping,this.texHeight=Math.floor(this.atlasSize/this.rows),this.maxTexWidth=this.atlasSize,this.texture=null,this.canvas=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=t.createTextureCanvas(e,this.atlasSize,this.atlasSize),this.scratch=t.createTextureCanvas(e,this.atlasSize,this.texHeight,"scratch")}return bn(r,[{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(t){var n=t.w,a=t.h,i=this.texHeight,o=this.maxTexWidth,s=i/a,l=n*s,u=a*s;return l>o&&(s=o/n,l=n*s,u=a*s),{scale:s,texW:l,texH:u}}},{key:"draw",value:function(t,n,a){var i=this,o=this.atlasSize,s=this.rows,l=this.texHeight,u=this.getScale(n),c=u.scale,d=u.texW,f=u.texH,v=[null,null],h=function(b,_){if(a&&_){var B=_.context,k=b.x,M=b.row,O=k,P=l*M;B.save(),B.translate(O,P),B.scale(c,c),a(B,n),B.restore()}},m=function(){h(i.freePointer,i.canvas),v[0]={x:i.freePointer.x,y:i.freePointer.row*l,w:d,h:f},v[1]={x:i.freePointer.x+d,y:i.freePointer.row*l,w:0,h:f},i.freePointer.x+=d,i.freePointer.x==o&&(i.freePointer.x=0,i.freePointer.row++)},g=function(){var b=i.scratch,_=i.canvas;b.clear(),h({x:0,row:0},b);var B=o-i.freePointer.x,k=d-B,M=l;{var O=i.freePointer.x,P=i.freePointer.row*l,L=B;_.context.drawImage(b,0,0,L,M,O,P,L,M),v[0]={x:O,y:P,w:L,h:f}}{var F=B,E=(i.freePointer.row+1)*l,A=k;_&&_.context.drawImage(b,F,0,A,M,0,E,A,M),v[1]={x:0,y:E,w:A,h:f}}i.freePointer.x=k,i.freePointer.row++},p=function(){i.freePointer.x=0,i.freePointer.row++};if(this.freePointer.x+d<=o)m();else{if(this.freePointer.row>=s-1)return!1;this.freePointer.x===o?(p(),m()):this.enableWrapping?g():(p(),m())}return this.keyToLocation.set(t,v),this.needsBuffer=!0,v}},{key:"getOffsets",value:function(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(t){var n=this.atlasSize,a=this.rows,i=this.getScale(t),o=i.texW;return this.freePointer.x+o>n?this.freePointer.row<a-1:!0}},{key:"bufferIfNeeded",value:function(t){this.texture||(this.texture=eb(t,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1)}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null,this.needsBuffer=!0)}}]),r}(),sb=function(){function r(e,t){Cn(this,r),this.r=e,this.opts=t,this.keyToIds=new Map,this.idToKey=new Map,this.atlases=[],this.styleKeyToAtlas=new Map,this.styleKeyNeedsRedraw=new Set,this.forceGC=!1}return bn(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"getIdsFor",value:function(t){var n=this.keyToIds.get(t);return n||(n=new Set,this.keyToIds.set(t,n)),n}},{key:"_createAtlas",value:function(){var t=this.r,n=this.opts;return new ob(t,n)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var t=this.r,n=this.opts,a=n.webglTexSize,i=Math.floor(a/n.webglTexRows);this.scratch=n.createTextureCanvas(t,a,i,"scratch")}return this.scratch}},{key:"draw",value:function(t,n,a,i){if(this.styleKeyNeedsRedraw.has(n)){this.styleKeyNeedsRedraw.delete(n),this.deleteKey(t,n);var o=this.styleKeyToAtlas.get(n);o&&(o.forceGC=!0),this.styleKeyToAtlas.delete(n)}var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(a))&&(s=this._createAtlas(),this.atlases.push(s)),s.draw(n,a,i),this.styleKeyToAtlas.set(n,s),this.getIdsFor(n).add(t),this.idToKey.set(t,n)),s}},{key:"getAtlas",value:function(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function(t){return this.styleKeyToAtlas.has(t)}},{key:"deleteKey",value:function(t,n){this.idToKey.delete(t),this.getIdsFor(n).delete(t)}},{key:"checkKeyIsInvalid",value:function(t,n){if(!this.idToKey.has(t))return!1;var a=this.idToKey.get(t);return a!=n?(this.deleteKey(t,a),!0):!1}},{key:"_getKeysToCollect",value:function(){var t=new Set,n=or(this.styleKeyToAtlas.keys()),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;this.getIdsFor(i).size==0&&t.add(i)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"gc",value:function(){var t=this,n=this.atlases.some(function(f){return f.forceGC}),a=this._getKeysToCollect();if(a.size===0&&!n){console.log("nothing to garbage collect");return}var i=[],o=new Map,s=null,l=or(this.atlases),u;try{var c=function(){var v=u.value,h=v.getKeys(),m=lb(a,h);if(m.size===0&&!v.forceGC)return i.push(v),h.forEach(function(M){return o.set(M,v)}),"continue";s||(s=t._createAtlas(),i.push(s));var g=or(h),p;try{for(g.s();!(p=g.n()).done;){var y=p.value;if(!m.has(y)){var b=v.getOffsets(y),_=dt(b,2),B=_[0],k=_[1];s.canFit({w:B.w+k.w,h:B.h})||(s=t._createAtlas(),i.push(s)),t._copyTextureToNewAtlas(y,v,s),o.set(y,s)}}}catch(M){g.e(M)}finally{g.f()}};for(l.s();!(u=l.n()).done;)var d=c()}catch(f){l.e(f)}finally{l.f()}this.atlases=i,this.styleKeyToAtlas=o}},{key:"_copyTextureToNewAtlas",value:function(t,n,a){var i=n.getOffsets(t),o=dt(i,2),s=o[0],l=o[1];if(l.w===0)a.draw(t,s,function(f){f.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,s.x,s.y,s.w,s.h,0,0,s.w,s.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,s.w,0,l.w,l.h);var c=s.w+l.w,d=s.h;a.draw(t,{w:c,h:d},function(f){f.drawImage(u,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}]),r}();function lb(r,e){return r.intersection?r.intersection(e):new Set(id(r).filter(function(t){return e.has(t)}))}var ub=function(){function r(e,t){Cn(this,r),this.r=e;var n=t;this.globalOptions=n,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.renderTypes=new Map,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[],this._cacheScratchCanvas(n)}return bn(r,[{key:"_cacheScratchCanvas",value:function(t){var n=-1,a=-1,i=null,o=t.createTextureCanvas;t.createTextureCanvas=function(s,l,u,c){return c?((!i||l!=n||u!=a)&&(n=l,a=u,i=o(s,l,u)),i):o(s,l,u)}}},{key:"addRenderType",value:function(t,n){var a=new sb(this.r,this.globalOptions),i=n;this.renderTypes.set(t,Fe({type:t,atlasCollection:a},i))}},{key:"getRenderTypes",value:function(){return id(this.renderTypes.values())}},{key:"getRenderTypeOpts",value:function(t){return this.renderTypes.get(t)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.forceRedraw,i=a===void 0?!1:a,o=n.filterEle,s=o===void 0?function(){return!0}:o,l=n.filterType,u=l===void 0?function(){return!0}:l,c=!1,d=or(t),f;try{for(d.s();!(f=d.n()).done;){var v=f.value;if(s(v)){var h=v.id(),m=or(this.getRenderTypes()),g;try{for(m.s();!(g=m.n()).done;){var p=g.value;if(u(p.type)){var y=p.getKey(v);i?(p.atlasCollection.deleteKey(h,y),p.atlasCollection.styleKeyNeedsRedraw.add(y),c=!0):c|=p.atlasCollection.checkKeyIsInvalid(h,y)}}}catch(b){m.e(b)}finally{m.f()}}}}catch(b){d.e(b)}finally{d.f()}return c}},{key:"gc",value:function(){var t=or(this.getRenderTypes()),n;try{for(t.s();!(n=t.n()).done;){var a=n.value;a.atlasCollection.gc()}}catch(i){t.e(i)}finally{t.f()}}},{key:"isRenderable",value:function(t,n){var a=this.getRenderTypeOpts(n);return a&&a.isVisible(t)}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"getOrCreateAtlas",value:function(t,n,a){var i=this.renderTypes.get(a),o=i.getKey(t),s=t.id();return i.atlasCollection.draw(s,o,n,function(l){i.drawElement(l,t,n,!0,!0)})}},{key:"getAtlasIndexForBatch",value:function(t){var n=this.batchAtlases.indexOf(t);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(t),n=this.batchAtlases.length-1}return n}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlases},function(t,n){return n})}},{key:"getAtlasInfo",value:function(t,n){var a=this.renderTypes.get(n),i=a.getBoundingBox(t),o=this.getOrCreateAtlas(t,i,n),s=this.getAtlasIndexForBatch(o);if(s!==void 0){var l=a.getKey(t),u=o.getOffsets(l),c=dt(u,2),d=c[0],f=c[1];return{atlasID:s,tex:d,tex1:d,tex2:f,bb:i,type:n,styleKey:l}}}},{key:"canAddToCurrentBatch",value:function(t,n){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var a=this.renderTypes.get(n),i=a.getKey(t),o=a.atlasCollection.getAtlas(i);return o&&this.batchAtlases.includes(o)}return!0}},{key:"setTransformMatrix",value:function(t,n,a){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=n.bb,s=n.type,l=n.tex1,u=n.tex2,c=this.getRenderTypeOpts(s),d=c.getPadding?c.getPadding(a):0,f=l.w/(l.w+u.w);i||(f=1-f);var v=this.getAdjustedBB(o,d,i,f),h,m;Vf(t);var g=c.getRotation?c.getRotation(a):0;if(g!==0){var p=c.getRotationPoint(a),y=p.x,b=p.y;qo(t,t,[y,b]),Nf(t,t,g);var _=c.getRotationOffset(a);h=_.x+v.xOffset,m=_.y}else h=v.x1,m=v.y1;qo(t,t,[h,m]),Al(t,t,[v.w,v.h])}},{key:"getTransformMatrix",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=ja();return this.setTransformMatrix(i,t,n,a),i}},{key:"getAdjustedBB",value:function(t,n,a,i){var o=t.x1,s=t.y1,l=t.w,u=t.h;n&&(o-=n,s-=n,l+=2*n,u+=2*n);var c=0,d=l*i;return a&&i<1?l=d:!a&&i<1&&(c=l-d,o+=c,l=d),{x1:o,y1:s,w:l,h:u,xOffset:c}}},{key:"getDebugInfo",value:function(){var t=[],n=or(this.renderTypes),a;try{for(n.s();!(a=n.n()).done;){var i=dt(a.value,2),o=i[0],s=i[1],l=s.atlasCollection.getCounts(),u=l.keyCount,c=l.atlasCount;t.push({type:o,keyCount:u,atlasCount:c})}}catch(d){n.e(d)}finally{n.f()}return t}}]),r}(),Gs=0,Zc=1,Jc=2,$s=3,cb=function(){function r(e,t,n){Cn(this,r),this.r=e,this.gl=t,this.maxInstances=n.webglBatchSize,this.maxAtlases=n.webglTexPerBatch,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,n.enableWrapping=!0,n.createTextureCanvas=ZC,this.atlasManager=new ub(e,n),this.program=this.createShaderProgram(Ga.SCREEN),this.pickingProgram=this.createShaderProgram(Ga.PICKING),this.vao=this.createVAO(),this.debugInfo=[]}return bn(r,[{key:"addTextureRenderType",value:function(t,n){this.atlasManager.addRenderType(t,n)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.type,i=this.atlasManager;return a?i.invalidate(t,{filterType:function(s){return s===a},forceRedraw:!0}):i.invalidate(t)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function(t){var n=this.gl,a=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; 

      // what are we rendering?
      in int aVertType;

      // for picking
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex1; // x/y/w/h of texture in atlas
      in vec4 aTex2; 

      // for any transforms that are needed
      in vec4 aScaleRotate1;  // vectors use fewer attributes than matrices
      in vec2 aTranslate1;
      in vec4 aScaleRotate2;
      in vec2 aTranslate2;

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in float aLineWidth;
      in vec4 aEdgeColor;

      out vec2 vTexCoord;
      out vec4 vEdgeColor;
      flat out int vAtlasId;
      flat out vec4 vIndex;
      flat out int vVertType;

      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition;

        if(aVertType == `.concat(Gs,`) {
          float texX;
          float texY;
          float texW;
          float texH;
          mat3  texMatrix;

          int vid = gl_VertexID;
          if(vid <= 5) {
            texX = aTex1.x;
            texY = aTex1.y;
            texW = aTex1.z;
            texH = aTex1.w;
            texMatrix = mat3(
              vec3(aScaleRotate1.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate1,      1.0)
            );
          } else {
            texX = aTex2.x;
            texY = aTex2.y;
            texW = aTex2.z;
            texH = aTex2.w;
            texMatrix = mat3(
              vec3(aScaleRotate2.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate2,      1.0)
            );
          }

          if(vid == 1 || vid == 2 || vid == 4 || vid == 7 || vid == 8 || vid == 10) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5 || vid == 8 || vid == 10 || vid == 11) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * texMatrix * vec3(position, 1.0), 1.0);
        } 
        else if(aVertType == `).concat(Zc,` && vid < 6) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(Jc,` && vid < 6) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0 = pointA;
          vec2 p1 = pointB;
          vec2 p2 = pointC;
          vec2 pos = position;
          if(position.x == 1.0) {
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth;

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat($s,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2( 0.0,   0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          mat3 transform = mat3(
            vec3(aScaleRotate1.xy, 0.0),
            vec3(aScaleRotate1.zw, 0.0),
            vec3(aTranslate1,      1.0)
          );
          gl_Position = vec4(uPanZoomMatrix * transform * vec3(position, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vIndex = aIndex;
        vVertType = aVertType;
      }
    `),i=this.atlasManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // define texture unit for each node in the batch
      `.concat(i.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;

      in vec2 vTexCoord;
      in vec4 vEdgeColor;
      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;

      out vec4 outColor;

      void main(void) {
        if(vVertType == `).concat(Gs,`) {
          `).concat(i.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } else if(vVertType == `).concat($s,`) {
          // blend arrow color with background (using premultiplied alpha)
          outColor.rgb = vEdgeColor.rgb + (uBGColor.rgb * (1.0 - vEdgeColor.a)); 
          outColor.a = 1.0; // make opaque, masks out line under arrow
        } else {
          outColor = vEdgeColor;
        }

        `).concat(t.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),s=QC(n,a,o);s.aPosition=n.getAttribLocation(s,"aPosition"),s.aIndex=n.getAttribLocation(s,"aIndex"),s.aVertType=n.getAttribLocation(s,"aVertType"),s.aAtlasId=n.getAttribLocation(s,"aAtlasId"),s.aTex1=n.getAttribLocation(s,"aTex1"),s.aTex2=n.getAttribLocation(s,"aTex2"),s.aScaleRotate1=n.getAttribLocation(s,"aScaleRotate1"),s.aTranslate1=n.getAttribLocation(s,"aTranslate1"),s.aScaleRotate2=n.getAttribLocation(s,"aScaleRotate2"),s.aTranslate2=n.getAttribLocation(s,"aTranslate2"),s.aPointAPointB=n.getAttribLocation(s,"aPointAPointB"),s.aPointCPointD=n.getAttribLocation(s,"aPointCPointD"),s.aLineWidth=n.getAttribLocation(s,"aLineWidth"),s.aEdgeColor=n.getAttribLocation(s,"aEdgeColor"),s.uPanZoomMatrix=n.getUniformLocation(s,"uPanZoomMatrix"),s.uAtlasSize=n.getUniformLocation(s,"uAtlasSize"),s.uBGColor=n.getUniformLocation(s,"uBGColor"),s.uTextures=[];for(var l=0;l<this.atlasManager.maxAtlases;l++)s.uTextures.push(n.getUniformLocation(s,"uTexture".concat(l)));return s}},{key:"createVAO",value:function(){var t=[0,0,1,0,1,1,0,0,1,1,0,1],n=[].concat(t,t);this.vertexCount=n.length/2;var a=this.maxInstances,i=this.gl,o=this.program,s=i.createVertexArray();return i.bindVertexArray(s),rb(i,"vec2",o.aPosition,n),this.indexBuffer=ir(i,a,"vec4",o.aIndex),this.vertTypeBuffer=ir(i,a,"int",o.aVertType),this.atlasIdBuffer=ir(i,a,"int",o.aAtlasId),this.tex1Buffer=ir(i,a,"vec4",o.aTex1),this.tex2Buffer=ir(i,a,"vec4",o.aTex2),this.scaleRotate1Buffer=ir(i,a,"vec4",o.aScaleRotate1),this.translate1Buffer=ir(i,a,"vec2",o.aTranslate1),this.scaleRotate2Buffer=ir(i,a,"vec4",o.aScaleRotate2),this.translate2Buffer=ir(i,a,"vec2",o.aTranslate2),this.pointAPointBBuffer=ir(i,a,"vec4",o.aPointAPointB),this.pointCPointDBuffer=ir(i,a,"vec4",o.aPointCPointD),this.lineWidthBuffer=ir(i,a,"float",o.aLineWidth),this.edgeColorBuffer=ir(i,a,"vec4",o.aEdgeColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var t=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return t[n]})),this._buffers}},{key:"startFrame",value:function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ga.SCREEN;this.panZoomMatrix=t,this.debugInfo=n,this.renderTarget=a,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.atlasManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"getTempMatrix",value:function(){return this.tempMatrix=this.tempMatrix||ja()}},{key:"drawTexture",value:function(t,n,a){var i=this.atlasManager;if(i.isRenderable(t,a)){i.canAddToCurrentBatch(t,a)||this.endBatch();var o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=Gs;var s=this.indexBuffer.getView(o);_o(n,s);var l=i.getAtlasInfo(t,a,l),u=l.atlasID,c=l.tex1,d=l.tex2,f=this.atlasIdBuffer.getView(o);f[0]=u;var v=this.tex1Buffer.getView(o);v[0]=c.x,v[1]=c.y,v[2]=c.w,v[3]=c.h;var h=this.tex2Buffer.getView(o);h[0]=d.x,h[1]=d.y,h[2]=d.w,h[3]=d.h;for(var m=this.getTempMatrix(),g=0,p=[1,2];g<p.length;g++){var y=p[g];i.setTransformMatrix(m,l,t,y===1);var b=this["scaleRotate".concat(y,"Buffer")].getView(o);b[0]=m[0],b[1]=m[1],b[2]=m[3],b[3]=m[4];var _=this["translate".concat(y,"Buffer")].getView(o);_[0]=m[6],_[1]=m[7]}this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function(t,n,a){var i=t._private.rscratch,o,s,l;if(a==="source"?(o=i.arrowStartX,s=i.arrowStartY,l=i.srcArrowAngle):(o=i.arrowEndX,s=i.arrowEndY,l=i.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(s)||s==null||isNaN(l)||l==null)){var u=t.pstyle(a+"-arrow-shape").value;if(u!=="none"){var c=t.pstyle(a+"-arrow-color").value,d=t.pstyle("opacity").value,f=t.pstyle("line-opacity").value,v=d*f,h=t.pstyle("width").pfValue,m=t.pstyle("arrow-scale").value,g=this.r.getArrowWidth(h,m),p=this.getTempMatrix();Vf(p),qo(p,p,[o,s]),Al(p,p,[g,g]),Nf(p,p,l);var y=this.instanceCount;this.vertTypeBuffer.getView(y)[0]=$s;var b=this.indexBuffer.getView(y);_o(n,b);var _=this.edgeColorBuffer.getView(y);xo(c,v,_);var B=this.scaleRotate1Buffer.getView(y);B[0]=p[0],B[1]=p[1],B[2]=p[3],B[3]=p[4];var k=this.translate1Buffer.getView(y);k[0]=p[6],k[1]=p[7],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(t,n){var a=t.pstyle("opacity").value,i=t.pstyle("line-opacity").value,o=t.pstyle("width").pfValue,s=t.pstyle("line-color").value,l=a*i,u=this.getEdgePoints(t);if(u.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),u.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=Zc;var d=this.indexBuffer.getView(c);_o(n,d);var f=this.edgeColorBuffer.getView(c);xo(s,l,f);var v=this.lineWidthBuffer.getView(c);v[0]=o;var h=this.pointAPointBBuffer.getView(c);h[0]=u[0],h[1]=u[1],h[2]=u[2],h[3]=u[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var m=0;m<u.length-2;m+=2){var g=this.instanceCount;this.vertTypeBuffer.getView(g)[0]=Jc;var p=this.indexBuffer.getView(g);_o(n,p);var y=this.edgeColorBuffer.getView(g);xo(s,l,y);var b=this.lineWidthBuffer.getView(g);b[0]=o;var _=u[m-2],B=u[m-1],k=u[m],M=u[m+1],O=u[m+2],P=u[m+3],L=u[m+4],F=u[m+5];m==0&&(_=2*k-O+.001,B=2*M-P+.001),m==u.length-4&&(L=2*O-k+.001,F=2*P-M+.001);var E=this.pointAPointBBuffer.getView(g);E[0]=_,E[1]=B,E[2]=k,E[3]=M;var A=this.pointCPointDBuffer.getView(g);A[0]=O,A[1]=P,A[2]=L,A[3]=F,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"getEdgePoints",value:function(t){var n=t._private.rscratch,a=n.allpts;if(a.length==4)return a;var i=this.getNumSegments(t);return this.getCurveSegmentPoints(a,i)}},{key:"getNumSegments",value:function(t){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function(t,n){if(t.length==4)return t;for(var a=Array((n+1)*2),i=0;i<=n;i++)if(i==0)a[0]=t[0],a[1]=t[1];else if(i==n)a[i*2]=t[t.length-2],a[i*2+1]=t[t.length-1];else{var o=i/n;this.setCurvePoint(t,o,a,i*2)}return a}},{key:"setCurvePoint",value:function(t,n,a,i){if(t.length<=2)a[i]=t[0],a[i+1]=t[1];else{for(var o=Array(t.length-2),s=0;s<o.length;s+=2){var l=(1-n)*t[s]+n*t[s+2],u=(1-n)*t[s+1]+n*t[s+3];o[s]=l,o[s+1]=u}return this.setCurvePoint(o,n,a,i)}}},{key:"endBatch",value:function(){var t=this.gl,n=this.vao,a=this.vertexCount,i=this.instanceCount;if(i!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(o),t.bindVertexArray(n);var s=or(this.buffers),l;try{for(s.s();!(l=s.n()).done;){var u=l.value;u.bufferSubData(i)}}catch(h){s.e(h)}finally{s.f()}for(var c=this.atlasManager.getAtlases(),d=0;d<c.length;d++)c[d].bufferIfNeeded(t);for(var f=0;f<c.length;f++)t.activeTexture(t.TEXTURE0+f),t.bindTexture(t.TEXTURE_2D,c[f].texture),t.uniform1i(o.uTextures[f],f);t.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),t.uniform1i(o.uAtlasSize,this.atlasManager.atlasSize);var v=xo(this.bgColor,1);t.uniform4fv(o.uBGColor,v),t.drawArraysInstanced(t.TRIANGLES,0,a,i),t.bindVertexArray(null),t.bindTexture(t.TEXTURE_2D,null),this.debugInfo&&this.debugInfo.push({count:i,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){return this.debugInfo}},{key:"getAtlasDebugInfo",value:function(){return this.atlasManager.getDebugInfo()}}]),r}();function ed(r,e){return"rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(e,")")}var db=function(){function r(e){Cn(this,r),this.r=e}return bn(r,[{key:"getStyleKey",value:function(t,n){var a=this.getStyle(t,n),i=a.shape,o=a.opacity,s=a.color;if(!i)return null;var l=n.width(),u=n.height(),c=ed(s,o);return hn("".concat(i,"-").concat(l,"-").concat(u,"-").concat(c))}},{key:"isVisible",value:function(t,n){var a=n.pstyle("".concat(t,"-opacity")).value;return a>0}},{key:"getStyle",value:function(t,n){var a=n.pstyle("".concat(t,"-opacity")).value,i=n.pstyle("".concat(t,"-color")).value,o=n.pstyle("".concat(t,"-shape")).value;return{opacity:a,color:i,shape:o}}},{key:"getPadding",value:function(t,n){return n.pstyle("".concat(t,"-padding")).pfValue}},{key:"draw",value:function(t,n,a,i){if(this.isVisible(t,a)){var o=this.r,s=i.w,l=i.h,u=s/2,c=l/2,d=this.getStyle(t,a),f=d.shape,v=d.color,h=d.opacity;n.save(),n.fillStyle=ed(v,h),f==="round-rectangle"||f==="roundrectangle"?o.drawRoundRectanglePath(n,u,c,s,l,"auto"):f==="ellipse"&&o.drawEllipsePath(n,u,c,s,l),n.fill(),n.restore()}}}]),r}();function fb(r){var e=r&&r.style&&r.style.backgroundColor||"white";return dd(e)}var zf={};zf.initWebgl=function(r,e){var t=this,n=t.data.contexts[t.WEBGL],a=r.cy.container();r.bgColor=fb(a),r.webglTexSize=Math.min(r.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),t.webglDebug=r.webglDebug,t.webglDebugShowAtlases=r.webglDebugShowAtlases,console.log("max texture units",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),console.log("max texture size",n.getParameter(n.MAX_TEXTURE_SIZE)),console.log("webgl options",r),t.pickingFrameBuffer=nb(n),t.pickingFrameBuffer.needsDraw=!0;var i=function(c){return t.getTextAngle(c,null)},o=function(c){var d=c.pstyle("label");return d&&d.value};t.eleDrawing=new cb(t,n,r);var s=new db(t);t.eleDrawing.addTextureRenderType("node-body",Ia({getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement,isVisible:function(c){return c.visible()}})),t.eleDrawing.addTextureRenderType("node-label",Ia({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:i,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o})),t.eleDrawing.addTextureRenderType("node-overlay",Ia({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("overlay",c)},drawElement:function(c,d,f){return s.draw("overlay",c,d,f)},isVisible:function(c){return s.isVisible("overlay",c)},getPadding:function(c){return s.getPadding("overlay",c)}})),t.eleDrawing.addTextureRenderType("node-underlay",Ia({getBoundingBox:e.getElementBox,getKey:function(c){return s.getStyleKey("underlay",c)},drawElement:function(c,d,f){return s.draw("underlay",c,d,f)},isVisible:function(c){return s.isVisible("underlay",c)},getPadding:function(c){return s.getPadding("underlay",c)}})),t.eleDrawing.addTextureRenderType("edge-label",Ia({getKey:e.getLabelKey,getBoundingBox:e.getLabelBox,drawElement:e.drawLabel,getRotation:i,getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:o}));var l=ni(function(){console.log("garbage collect flag set"),t.data.gc=!0},1e4);t.onUpdateEleCalcs(function(u,c){var d=!1;c&&c.length>0&&(d|=t.eleDrawing.invalidate(c)),d&&l()}),hb(t)};function hb(r){{var e=r.render;r.render=function(i){i=i||{};var o=r.cy;r.webgl&&(o.zoom()>Af?(vb(r),e.call(r,i)):(pb(r),Gf(r,i,Ga.SCREEN)))}}{var t=r.matchCanvasSize;r.matchCanvasSize=function(i){t.call(r,i),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(i,o,s,l){return wb(r,i,o)};{var n=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){n.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var a=r.notify;r.notify=function(i,o){a.call(r,i,o),i==="viewport"||i==="bounds"?r.pickingFrameBuffer.needsDraw=!0:i==="background"&&r.eleDrawing.invalidate(o,{type:"node-body"})}}}function vb(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function pb(r){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.canvasWidth,r.canvasHeight),n.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function gb(r){var e=r.canvasWidth,t=r.canvasHeight,n=Pl(r),a=n.pan,i=n.zoom,o=ja();qo(o,o,[a.x,a.y]),Al(o,o,[i,i]);var s=ja();ib(s,e,t);var l=ja();return ab(l,s,o),l}function jf(r,e){var t=r.canvasWidth,n=r.canvasHeight,a=Pl(r),i=a.pan,o=a.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.translate(i.x,i.y),e.scale(o,o)}function mb(r,e){r.drawSelectionRectangle(e,function(t){return jf(r,t)})}function yb(r){var e=r.data.contexts[r.NODE];e.save(),jf(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function Cb(r){var e=function(a,i,o){for(var s=a.atlasManager.getRenderTypeOpts(i),l=r.data.contexts[r.NODE],u=.125,c=s.atlasCollection.atlases,d=0;d<c.length;d++){var f=c[d],v=f.canvas,h=v.width,m=v.height,g=h*d,p=v.height*o;l.save(),l.scale(u,u),l.drawImage(v,g,p),l.strokeStyle="black",l.rect(g,p,h,m),l.stroke(),l.restore()}},t=0;e(r.eleDrawing,"node-body",t++),e(r.eleDrawing,"node-label",t++)}function bb(r,e,t,n,a){var i,o,s,l,u=Pl(r),c=u.pan,d=u.zoom;if(n===void 0||a===void 0){var f=js(r,c,d,e,t),v=dt(f,2),h=v[0],m=v[1],g=6;i=h-g/2,o=m-g/2,s=g,l=g}else{var p=js(r,c,d,e,t),y=dt(p,2),b=y[0],_=y[1],B=js(r,c,d,n,a),k=dt(B,2),M=k[0],O=k[1];i=b,o=O,s=Math.abs(M-b),l=Math.abs(O-_)}if(s===0||l===0)return[];var P=r.data.contexts[r.WEBGL];P.bindFramebuffer(P.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(P.viewport(0,0,P.canvas.width,P.canvas.height),Gf(r,null,Ga.PICKING),r.pickingFrameBuffer.needsDraw=!1);var L=s*l,F=new Uint8Array(L*4);P.readPixels(i,o,s,l,P.RGBA,P.UNSIGNED_BYTE,F),P.bindFramebuffer(P.FRAMEBUFFER,null);for(var E=new Set,A=0;A<L;A++){var S=F.slice(A*4,A*4+4),w=JC(S)-1;w>=0&&E.add(w)}return E}function wb(r,e,t){var n=bb(r,e,t),a=r.getCachedZSortedEles(),i,o,s=or(n),l;try{for(s.s();!(l=s.n()).done;){var u=l.value,c=a[u];if(!i&&c.isNode()&&(i=c),!o&&c.isEdge()&&(o=c),i&&o)break}}catch(d){s.e(d)}finally{s.f()}return[i,o].filter(Boolean)}function Gf(r,e,t){var n,a;r.webglDebug&&(a=[],n=performance.now());var i=r.eleDrawing,o=0;if(t.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&mb(r,e),r.data.canvasNeedsRedraw[r.NODE]||t.picking){var s=function(E,A){A+=1,E.isNode()?(i.drawTexture(E,A,"node-underlay"),i.drawTexture(E,A,"node-body"),i.drawTexture(E,A,"node-label"),i.drawTexture(E,A,"node-overlay")):(i.drawEdgeLine(E,A),i.drawEdgeArrow(E,A,"source"),i.drawEdgeArrow(E,A,"target"),i.drawTexture(E,A,"edge-label"))},l=r.data.contexts[r.WEBGL];t.screen?(l.clearColor(0,0,0,0),l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA)):l.disable(l.BLEND),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.viewport(0,0,l.canvas.width,l.canvas.height);var u=gb(r),c=r.getCachedZSortedEles();if(o=c.length,i.startFrame(u,a,t),t.screen){for(var d=0;d<c.nondrag.length;d++)s(c.nondrag[d],d);for(var f=0;f<c.drag.length;f++)s(c.drag[f],-1)}else if(t.picking)for(var v=0;v<c.length;v++)s(c[v],v);i.endFrame(),r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,i.gc()),t.screen&&r.webglDebugShowAtlases&&(yb(r),Cb(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var h=performance.now(),m=!0,g=0,p=0,y=or(a),b;try{for(y.s();!(b=y.n()).done;){var _=b.value;g++,p+=_.count}}catch(F){y.e(F)}finally{y.f()}var B=Math.ceil(h-n),k="".concat(o," elements, ").concat(p," rectangles, ").concat(g," batches");if(m)console.log("WebGL (".concat(t.name,") - ").concat(k));else{console.log("WebGL render (".concat(t.name,") - frame time ").concat(B,"ms")),console.log("  ".concat(k)),console.log("Texture Atlases Used:");var M=i.getAtlasDebugInfo(),O=or(M),P;try{for(O.s();!(P=O.n()).done;){var L=P.value;console.log("  ".concat(L.type,": ").concat(L.keyCount," keys, ").concat(L.atlasCount," atlases"))}}catch(F){O.e(F)}finally{O.f()}console.log("")}}}var xn={};xn.drawPolygonPath=function(r,e,t,n,a,i){var o=n/2,s=a/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*i[0],t+s*i[1]);for(var l=1;l<i.length/2;l++)r.lineTo(e+o*i[l*2],t+s*i[l*2+1]);r.closePath()};xn.drawRoundPolygonPath=function(r,e,t,n,a,i,o){o.forEach(function(s){return xf(r,s)}),r.closePath()};xn.drawRoundRectanglePath=function(r,e,t,n,a,i){var o=n/2,s=a/2,l=i==="auto"?Rn(n,a):Math.min(i,s,o);r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.arcTo(e+o,t-s,e+o,t,l),r.arcTo(e+o,t+s,e,t+s,l),r.arcTo(e-o,t+s,e-o,t,l),r.arcTo(e-o,t-s,e,t-s,l),r.lineTo(e,t-s),r.closePath()};xn.drawBottomRoundRectanglePath=function(r,e,t,n,a,i){var o=n/2,s=a/2,l=i==="auto"?Rn(n,a):i;r.beginPath&&r.beginPath(),r.moveTo(e,t-s),r.lineTo(e+o,t-s),r.lineTo(e+o,t),r.arcTo(e+o,t+s,e,t+s,l),r.arcTo(e-o,t+s,e-o,t,l),r.lineTo(e-o,t-s),r.lineTo(e,t-s),r.closePath()};xn.drawCutRectanglePath=function(r,e,t,n,a,i,o){var s=n/2,l=a/2,u=o==="auto"?pl():o;r.beginPath&&r.beginPath(),r.moveTo(e-s+u,t-l),r.lineTo(e+s-u,t-l),r.lineTo(e+s,t-l+u),r.lineTo(e+s,t+l-u),r.lineTo(e+s-u,t+l),r.lineTo(e-s+u,t+l),r.lineTo(e-s,t+l-u),r.lineTo(e-s,t-l+u),r.closePath()};xn.drawBarrelPath=function(r,e,t,n,a){var i=n/2,o=a/2,s=e-i,l=e+i,u=t-o,c=t+o,d=Ws(n,a),f=d.widthOffset,v=d.heightOffset,h=d.ctrlPtOffsetPct*f;r.beginPath&&r.beginPath(),r.moveTo(s,u+v),r.lineTo(s,c-v),r.quadraticCurveTo(s+h,c,s+f,c),r.lineTo(l-f,c),r.quadraticCurveTo(l-h,c,l,c-v),r.lineTo(l,u+v),r.quadraticCurveTo(l-h,u,l-f,u),r.lineTo(s+f,u),r.quadraticCurveTo(s+h,u,s,u+v),r.closePath()};var td=Math.sin(0),rd=Math.cos(0),al={},il={},$f=Math.PI/40;for(Tn=0*Math.PI;Tn<2*Math.PI;Tn+=$f)al[Tn]=Math.sin(Tn),il[Tn]=Math.cos(Tn);var Tn;xn.drawEllipsePath=function(r,e,t,n,a){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,n/2,a/2,0,0,2*Math.PI);else for(var i,o,s=n/2,l=a/2,u=0*Math.PI;u<2*Math.PI;u+=$f)i=e-s*al[u]*td+s*il[u]*rd,o=t+l*il[u]*td+l*al[u]*rd,u===0?r.moveTo(i,o):r.lineTo(i,o);r.closePath()};var ui={};ui.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};ui.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),n=t.boundingBox(),a=this.findContainerClientCoords(),i=r.full?Math.ceil(n.w):a[2],o=r.full?Math.ceil(n.h):a[3],s=Ce(r.maxWidth)||Ce(r.maxHeight),l=this.getPixelRatio(),u=1;if(r.scale!==void 0)i*=r.scale,o*=r.scale,u=r.scale;else if(s){var c=1/0,d=1/0;Ce(r.maxWidth)&&(c=u*r.maxWidth/i),Ce(r.maxHeight)&&(d=u*r.maxHeight/o),u=Math.min(c,d),i*=u,o*=u}s||(i*=l,o*=l,u*=l);var f=document.createElement("canvas");f.width=i,f.height=o,f.style.width=i+"px",f.style.height=o+"px";var v=f.getContext("2d");if(i>0&&o>0){v.clearRect(0,0,i,o),v.globalCompositeOperation="source-over";var h=this.getCachedZSortedEles();if(r.full)v.translate(-n.x1*u,-n.y1*u),v.scale(u,u),this.drawElements(v,h),v.scale(1/u,1/u),v.translate(n.x1*u,n.y1*u);else{var m=e.pan(),g={x:m.x*u,y:m.y*u};u*=e.zoom(),v.translate(g.x,g.y),v.scale(u,u),this.drawElements(v,h),v.scale(1/u,1/u),v.translate(-g.x,-g.y)}r.bg&&(v.globalCompositeOperation="destination-over",v.fillStyle=r.bg,v.rect(0,0,i,o),v.fill())}return f};function xb(r,e){for(var t=atob(r),n=new ArrayBuffer(t.length),a=new Uint8Array(n),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return new Blob([n],{type:e})}function nd(r){var e=r.indexOf(",");return r.substr(e+1)}function qf(r,e,t){var n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new va(function(a,i){try{e.toBlob(function(o){o!=null?a(o):i(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(o){i(o)}});case"blob":return xb(nd(n()),t);case"base64":return nd(n());case"base64uri":default:return n()}}ui.png=function(r){return qf(r,this.bufferCanvasImage(r),"image/png")};ui.jpg=function(r){return qf(r,this.bufferCanvasImage(r),"image/jpeg")};var Hf={};Hf.nodeShapeImpl=function(r,e,t,n,a,i,o,s){switch(r){case"ellipse":return this.drawEllipsePath(e,t,n,a,i);case"polygon":return this.drawPolygonPath(e,t,n,a,i,o);case"round-polygon":return this.drawRoundPolygonPath(e,t,n,a,i,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,n,a,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,n,a,i,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,n,a,i,s);case"barrel":return this.drawBarrelPath(e,t,n,a,i)}};var _b=Wf,Ge=Wf.prototype;Ge.CANVAS_LAYERS=3;Ge.SELECT_BOX=0;Ge.DRAG=1;Ge.NODE=2;Ge.WEBGL=3;Ge.CANVAS_TYPES=["2d","2d","2d","webgl2"];Ge.BUFFER_COUNT=3;Ge.TEXTURE_BUFFER=0;Ge.MOTIONBLUR_BUFFER_NODE=1;Ge.MOTIONBLUR_BUFFER_DRAG=2;function Wf(r){var e=this,t=e.cy.window(),n=t.document;r.webgl&&(Ge.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(Ge.CANVAS_LAYERS),contexts:new Array(Ge.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Ge.CANVAS_LAYERS),bufferCanvases:new Array(Ge.BUFFER_COUNT),bufferContexts:new Array(Ge.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",i="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[a]=i,o.position="relative",o.zIndex="0",o.overflow="hidden";var s=r.cy.container();s.appendChild(e.data.canvasContainer),s.style[a]=i;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};jv()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<Ge.CANVAS_LAYERS;u++){var c=e.data.canvases[u]=n.createElement("canvas"),d=Ge.CANVAS_TYPES[u];e.data.contexts[u]=c.getContext(d),e.data.contexts[u]||ot("Could not create canvas of type "+d),Object.keys(l).forEach(function(K){c.style[K]=l[K]}),c.style.position="absolute",c.setAttribute("data-id","layer"+u),c.style.zIndex=String(Ge.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[Ge.NODE].setAttribute("data-id","layer"+Ge.NODE+"-node"),e.data.canvases[Ge.SELECT_BOX].setAttribute("data-id","layer"+Ge.SELECT_BOX+"-selectbox"),e.data.canvases[Ge.DRAG].setAttribute("data-id","layer"+Ge.DRAG+"-drag"),e.data.canvases[Ge.WEBGL]&&e.data.canvases[Ge.WEBGL].setAttribute("data-id","layer"+Ge.WEBGL+"-webgl");for(var u=0;u<Ge.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var f=tr(),v=function(R){return{x:(R.x1+R.x2)/2,y:(R.y1+R.y2)/2}},h=function(R){return{x:-R.w/2,y:-R.h/2}},m=function(R){var N=R[0]._private,G=N.oldBackgroundTimestamp===N.backgroundTimestamp;return!G},g=function(R){return R[0]._private.nodeKey},p=function(R){return R[0]._private.labelStyleKey},y=function(R){return R[0]._private.sourceLabelStyleKey},b=function(R){return R[0]._private.targetLabelStyleKey},_=function(R,N,G,W,X){return e.drawElement(R,N,G,!1,!1,X)},B=function(R,N,G,W,X){return e.drawElementText(R,N,G,W,"main",X)},k=function(R,N,G,W,X){return e.drawElementText(R,N,G,W,"source",X)},M=function(R,N,G,W,X){return e.drawElementText(R,N,G,W,"target",X)},O=function(R){return R.boundingBox(),R[0]._private.bodyBounds},P=function(R){return R.boundingBox(),R[0]._private.labelBounds.main||f},L=function(R){return R.boundingBox(),R[0]._private.labelBounds.source||f},F=function(R){return R.boundingBox(),R[0]._private.labelBounds.target||f},E=function(R,N){return N},A=function(R){return v(O(R))},S=function(R,N,G){var W=R?R+"-":"";return{x:N.x+G.pstyle(W+"text-margin-x").pfValue,y:N.y+G.pstyle(W+"text-margin-y").pfValue}},w=function(R,N,G){var W=R[0]._private.rscratch;return{x:W[N],y:W[G]}},C=function(R){return S("",w(R,"labelX","labelY"),R)},x=function(R){return S("source",w(R,"sourceLabelX","sourceLabelY"),R)},D=function(R){return S("target",w(R,"targetLabelX","targetLabelY"),R)},T=function(R){return h(O(R))},V=function(R){return h(L(R))},z=function(R){return h(F(R))},j=function(R){var N=P(R),G=h(P(R));if(R.isNode()){switch(R.pstyle("text-halign").value){case"left":G.x=-N.w-(N.leftPad||0);break;case"right":G.x=-(N.rightPad||0);break}switch(R.pstyle("text-valign").value){case"top":G.y=-N.h-(N.topPad||0);break;case"bottom":G.y=-(N.botPad||0);break}}return G},U=e.data.eleTxrCache=new Va(e,{getKey:g,doesEleInvalidateKey:m,drawElement:_,getBoundingBox:O,getRotationPoint:A,getRotationOffset:T,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),Y=e.data.lblTxrCache=new Va(e,{getKey:p,drawElement:B,getBoundingBox:P,getRotationPoint:C,getRotationOffset:j,isVisible:E}),te=e.data.slbTxrCache=new Va(e,{getKey:y,drawElement:k,getBoundingBox:L,getRotationPoint:x,getRotationOffset:V,isVisible:E}),J=e.data.tlbTxrCache=new Va(e,{getKey:b,drawElement:M,getBoundingBox:F,getRotationPoint:D,getRotationOffset:z,isVisible:E}),ne=e.data.lyrTxrCache=new Bf(e);e.onUpdateEleCalcs(function(R,N){U.invalidateElements(N),Y.invalidateElements(N),te.invalidateElements(N),J.invalidateElements(N),ne.invalidateElements(N);for(var G=0;G<N.length;G++){var W=N[G]._private;W.oldBackgroundTimestamp=W.backgroundTimestamp}});var ae=function(R){for(var N=0;N<R.length;N++)ne.enqueueElementRefinement(R[N].ele)};U.onDequeue(ae),Y.onDequeue(ae),te.onDequeue(ae),J.onDequeue(ae),r.webgl&&e.initWebgl(r,{getStyleKey:g,getLabelKey:p,drawElement:_,drawLabel:B,getElementBox:O,getLabelBox:P,getElementRotationPoint:A,getElementRotationOffset:T,getLabelRotationPoint:C,getLabelRotationOffset:j})}Ge.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[Ge.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[Ge.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[Ge.SELECT_BOX]=e;break;case"gc":t.data.gc=!0;break}};var Sb=typeof Path2D<"u";Ge.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};Ge.usePaths=function(){return Sb&&this.pathsEnabled};Ge.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};Ge.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};Ge.makeOffscreenCanvas=function(r,e){var t;if((typeof OffscreenCanvas>"u"?"undefined":pt(OffscreenCanvas))!=="undefined")t=new OffscreenCanvas(r,e);else{var n=this.cy.window(),a=n.document;t=a.createElement("canvas"),t.width=r,t.height=e}return t};[If,Nr,Qr,kl,Nn,xa,$t,zf,xn,ui,Hf].forEach(function(r){Fe(Ge,r)});var Eb=[{name:"null",impl:Cf},{name:"base",impl:kf},{name:"canvas",impl:_b}],Tb=[{type:"layout",extensions:lC},{type:"renderer",extensions:Eb}],Kf={},Uf={};function Xf(r,e,t){var n=t,a=function(O){Ye("Can not register `"+e+"` for `"+r+"` since `"+O+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(Ja.prototype[e])return a(e);Ja.prototype[e]=t}else if(r==="collection"){if(Mt.prototype[e])return a(e);Mt.prototype[e]=t}else if(r==="layout"){for(var i=function(O){this.options=O,t.call(this,O),He(this._private)||(this._private={}),this._private.cy=O.cy,this._private.listeners=[],this.createEmitter()},o=i.prototype=Object.create(t.prototype),s=[],l=0;l<s.length;l++){var u=s[l];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var c=t.prototype.stop;o.stop=function(){var M=this.options;if(M&&M.animate){var O=this.animations;if(O)for(var P=0;P<O.length;P++)O[P].stop()}return c?c.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(O){return O._private.cy},f={addEventFields:function(O,P){P.layout=O,P.cy=d(O),P.target=O},bubble:function(){return!0},parent:function(O){return d(O)}};Fe(o,{createEmitter:function(){return this._private.emitter=new es(f,this),this},emitter:function(){return this._private.emitter},on:function(O,P){return this.emitter().on(O,P),this},one:function(O,P){return this.emitter().one(O,P),this},once:function(O,P){return this.emitter().one(O,P),this},removeListener:function(O,P){return this.emitter().removeListener(O,P),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(O,P){return this.emitter().emit(O,P),this}}),Xe.eventAliasesOn(o),n=i}else if(r==="renderer"&&e!=="null"&&e!=="base"){var v=Yf("renderer","base"),h=v.prototype,m=t,g=t.prototype,p=function(){v.apply(this,arguments),m.apply(this,arguments)},y=p.prototype;for(var b in h){var _=h[b],B=g[b]!=null;if(B)return a(b);y[b]=_}for(var k in g)y[k]=g[k];h.clientFunctions.forEach(function(M){y[M]=y[M]||function(){ot("Renderer does not implement `renderer."+M+"()` on its prototype")}}),n=p}else if(r==="__proto__"||r==="constructor"||r==="prototype")return ot(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return fd({map:Kf,keys:[r,e],value:n})}function Yf(r,e){return hd({map:Kf,keys:[r,e]})}function Mb(r,e,t,n,a){return fd({map:Uf,keys:[r,e,t,n],value:a})}function Db(r,e,t,n){return hd({map:Uf,keys:[r,e,t,n]})}var ol=function(){if(arguments.length===2)return Yf.apply(null,arguments);if(arguments.length===3)return Xf.apply(null,arguments);if(arguments.length===4)return Db.apply(null,arguments);if(arguments.length===5)return Mb.apply(null,arguments);ot("Invalid extension access syntax")};Ja.prototype.extension=ol;Tb.forEach(function(r){r.extensions.forEach(function(e){Xf(r.type,e.name,e.impl)})});var Qf=function r(){if(!(this instanceof r))return new r;this.length=0},Ln=Qf.prototype;Ln.instanceString=function(){return"stylesheet"};Ln.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};Ln.css=function(r,e){var t=this.length-1;if(Be(r))this[t].properties.push({name:r,value:e});else if(He(r))for(var n=r,a=Object.keys(n),i=0;i<a.length;i++){var o=a[i],s=n[o];if(s!=null){var l=Ot.properties[o]||Ot.properties[Ho(o)];if(l!=null){var u=l.name,c=s;this[t].properties.push({name:u,value:c})}}}return this};Ln.style=Ln.css;Ln.generateStyle=function(r){var e=new Ot(r);return this.appendToStyle(e)};Ln.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],n=t.selector,a=t.properties;r.selector(n);for(var i=0;i<a.length;i++){var o=a[i];r.css(o.name,o.value)}}return r};var kb="3.31.0",yn=function(e){if(e===void 0&&(e={}),He(e))return new Ja(e);if(Be(e))return ol.apply(ol,arguments)};yn.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(yn),r.apply(null,e),this};yn.warnings=function(r){return wd(r)};yn.version=kb;yn.stylesheet=yn.Stylesheet=Qf;var Pb=["cy"],Zf=(()=>{class r{constructor(){this.projects=[],this.searchResultsMap={},this.renameCondition={}}ngAfterViewInit(){this.initCytoscape()}initCytoscape(){if(this.cyElement){let t=this.buildGraphElements();this.cy=yn({container:this.cyElement.nativeElement,elements:t,style:[{selector:"node",style:{label:"data(label)","background-color":"#666",width:25,height:25}},{selector:".protein",style:{"background-color":"#FF5733"}},{selector:".project",style:{"background-color":"#33A8FF"}},{selector:".analysis",style:{"background-color":"#33FF57"}},{selector:".file",style:{"background-color":"#FFD700"}},{selector:".condition",style:{"background-color":"#FF33A1"}},{selector:"edge",style:{width:2,"line-color":"#ccc"}}],layout:{name:"cose",animate:!0}})}}buildGraphElements(){let t=[],n=new Set;return this.projects.forEach(a=>{n.has(a.id)||(t.push({data:{id:a.id,label:a.name},classes:"project"}),n.add(a.id)),(this.searchResultsMap[a.id]||[]).forEach(o=>{let s=o.primary_id||o.gene_name||o.uniprot_id,l=`AG_${o.analysis_group.id}`,u=`File_${o.file.id}`,c=`Cond_${o.condition_A}`,d=`Cond_${o.condition_B}`;this.renameCondition[a.id]||(this.renameCondition[a.id][o.condition_A]||(c=`Cond_${this.renameCondition[a.id][o.condition_A]||o.condition_A}`),this.renameCondition[a.id][o.condition_B]||(d=`Cond_${this.renameCondition[a.id][o.condition_B]||o.condition_B}`)),n.has(s)||(t.push({data:{id:s,label:s},classes:"protein"}),n.add(s)),n.has(l)||(t.push({data:{id:l,label:o.analysis_group.name},classes:"analysis"}),n.add(l)),n.has(u)||(t.push({data:{id:u,label:o.file.name},classes:"file"}),n.add(u)),n.has(c)||(t.push({data:{id:c,label:o.condition_A},classes:"condition"}),n.add(c)),n.has(d)||(t.push({data:{id:d,label:o.condition_B},classes:"condition"}),n.add(d)),t.push({data:{source:s,target:a.id}}),t.push({data:{source:s,target:l}}),t.push({data:{source:l,target:u}}),t.push({data:{source:u,target:c}}),t.push({data:{source:u,target:d}})})}),t}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=je({type:r,selectors:[["app-cytoscape-plot"]],viewQuery:function(n,a){if(n&1&&jn(Pb,5),n&2){let i;Gn(i=$n())&&(a.cyElement=i.first)}},inputs:{projects:"projects",searchResultsMap:"searchResultsMap",renameCondition:"renameCondition"},decls:2,vars:0,consts:[["cy",""],[1,"cy-container"]],template:function(n,a){n&1&&ke(0,"div",1,0)},styles:[".cy-container[_ngcontent-%COMP%]{width:100%;height:600px;border:1px solid #ccc}"]})}}return r})();function Ab(r,e){r&1&&($(0,"button",11),ie(1,"No previous searches"),q())}function Bb(r,e){if(r&1){let t=Oe();$(0,"button",13),ue("click",function(){ge(t);let a=re().$implicit,i=re(3);return me(i.restoreSearches(a.searchQuery,a.searchID))}),ie(1),q()}if(r&2){let t=re().$implicit;Z(),tu("",t.searchID,". ",t.termFounds.join(","),"")}}function Ib(r,e){if(r&1&&Ee(0,Bb,2,2,"button",12),r&2){let t=e.$implicit,n=re(3);Ie(t.collate===n.collate.id?0:-1)}}function Rb(r,e){if(r&1&&We(0,Ib,1,1,null,null,$r),r&2){let t=re(2);Ke(t.pastSearches)}}function Ob(r,e){if(r&1&&($(0,"button",10)(1,"mat-icon"),ie(2,"history"),q()(),$(3,"mat-menu",null,0),Ee(5,Ab,2,0,"button",11)(6,Rb,2,0),q()),r&2){let t=mr(4),n=re();pe("matMenuTriggerFor",t),Z(5),Ie(n.pastSearches.length===0?5:6)}}function Fb(r,e){if(r&1){let t=Oe();$(0,"button",14),ue("click",function(){ge(t);let a=re();return me(a.navigateToEdit())}),$(1,"mat-icon"),ie(2,"edit"),q()()}}function Lb(r,e){if(r&1&&ke(0,"app-collate-header",7),r&2){let t=re();pe("collate",t.collate)}}function Vb(r,e){if(r&1&&($(0,"div",15),ke(1,"app-collate-tags",16),q()),r&2){let t=re(2);Z(),pe("collageTags",t.collate.tags)}}function Nb(r,e){if(r&1&&Ee(0,Vb,2,1,"div",15),r&2){let t=re();Ie(t.collate.settings.showTags?0:-1)}}function zb(r,e){if(r&1&&ke(0,"app-cytoscape-plot",18),r&2){let t=re(2);pe("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("searchResultsMap",t.filteredResults)}}function jb(r,e){if(r&1){let t=Oe();ie(0),$(1,"button",23),ue("click",function(){ge(t);let a=re().$implicit,i=re(2);return me(i.exportData(a))}),$(2,"mat-icon"),ie(3,"download"),q()()}if(r&2){let t=re().$implicit,n=re(2);$e(" ",t," "),Z(),pe("disabled",n.waitingForDownload)}}function Gb(r,e){r&1&&($(0,"mat-tab"),Ee(1,jb,4,2,"ng-template",22),q())}function $b(r,e){if(r&1&&ke(0,"app-collate-project-list",21),r&2){let t=re(2);pe("searchTerm",t.selectedSearchTerm)("renameCondition",t.collate.settings.renameSampleCondition)("projects",t.projects)("filteredResults",t.filteredResults)}}function qb(r,e){if(r&1){let t=Oe();$(0,"button",17),ue("click",function(){ge(t);let a=re();return me(a.toggleCytoscapePlot())}),$(1,"mat-icon"),ie(2),q()(),Ee(3,zb,1,3,"app-cytoscape-plot",18),$(4,"div",19)(5,"mat-tab-group",20),ue("selectedTabChange",function(){ge(t);let a=re();return me(a.filterDataBySearchTerm())}),Kt("selectedIndexChange",function(a){ge(t);let i=re();return Wt(i.selectedIndex,a)||(i.selectedIndex=a),me(a)}),We(6,Gb,2,0,"mat-tab",null,$r),q()(),Ee(8,$b,1,4,"app-collate-project-list",21)}if(r&2){let t=re();Z(2),Ze(t.showCytoscapePlot?"visibility_off":"visibility"),Z(),Ie(t.collate&&t.showCytoscapePlot?3:-1),Z(2),Ht("selectedIndex",t.selectedIndex),pe("mat-stretch-tabs",!1),Z(),Ke(t.searchTerms),Z(2),Ie(t.collate?8:-1)}}var ls=(()=>{class r{set sessionId(t){t&&this.collate&&this.getSearchFromID(t),this._sessionId=t}get sessionId(){return this._sessionId}set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this.collate=n,this.title.setTitle(`${n.title} - C|nder`),this.projects=n.projects,n.settings||(n.settings={projectOrder:[],analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),n.settings.plotSettings||(n.settings.plotSettings={}),n.settings.projectOrder&&(this.projects=n.settings.projectOrder.map(a=>n.projects.find(i=>i.id===a))),!this.collate?.settings.projectAnalysisGroupVisibility){this.collate.settings.projectAnalysisGroupVisibility={};for(let a of this.projects)this.collate.settings.projectAnalysisGroupVisibility[a.id]={}}if(this.collate?.settings.renameSampleCondition)this.sessionId&&this.getSearchFromID(this.sessionId);else{this.collate.settings.renameSampleCondition={};for(let a of this.projects)this.collate.settings.renameSampleCondition[a.id]={},this.web.getProjectUniqueConditions(a.id).subscribe(i=>{for(let o of i)this.collate.settings.renameSampleCondition[a.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)});this.sessionId&&this.getSearchFromID(this.sessionId)}console.log(this.projects)})}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}toggleCytoscapePlot(){this.showCytoscapePlot=!this.showCytoscapePlot}constructor(t,n,a,i,o,s,l,u){this.title=t,this.ws=n,this.sb=a,this.dialog=i,this.collateService=o,this.web=s,this.accounts=l,this.router=u,this.showCytoscapePlot=!0,this._sessionId=null,this.collate=null,this.projects=[],this.filteredResults={},this.searchTerms=[],this.selectedIndex=0,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this._selectedSearchTerm="",this.pastSearches=[],this.waitingForDownload=!1;let c=localStorage.getItem("cinderPastSearches");c&&(this.pastSearches=JSON.parse(c)),this.ws.searchWSConnection?.subscribe(d=>{if(d&&d.type==="export_status"&&this.web.cinderInstanceID===d.instance_id&&this.waitingForDownload)switch(d.status){case"error":this.waitingForDownload=!1;break;case"started":this.sb.open("Export started","Dismiss",{duration:2e3});break;case"in_progress":break;case"complete":this.waitingForDownload=!1,this.sb.open("Export complete","Dismiss",{duration:2e3});let f=`${this.web.baseURL}/api/search/download_temp_file/?token=${d.file}`;window.open(f,"_blank");break}})}associateAnalysisGroupsWithProjects(){return Pt(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let a=n.project;this.projectAnalysisGroups[a]||(this.projectAnalysisGroups[a]=[]),this.projectAnalysisGroups[a].push(n),this.analysisGroupProjects[n.id]=this.projects.find(i=>i.id===a)})})}distributeSearchResults(t){return Pt(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let a=n.analysis_group.id,i=this.analysisGroupProjects[a];i&&(this.searchResults[i.id]||(this.searchResults[i.id]=[]),this.searchResults[i.id].push(n))}),console.log(this.searchResults),this.searchTerms.sort((n,a)=>n.localeCompare(a)),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(a=>a.search_term===this.selectedSearchTerm),this.collate?.settings?.analysisGroupOrderMap&&(console.log(this.collate.settings.analysisGroupOrderMap),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{let i=parseInt(a),o=this.collate?.settings.analysisGroupOrderMap[i];if(!t[i]||!o)return;console.log(o);let s=t[i].filter(l=>!o.includes(l.analysis_group.id));if(t[i]=t[i].filter(l=>o.includes(l.analysis_group.id)),t[i]=t[i].sort((l,u)=>o.indexOf(l.analysis_group.id)-o.indexOf(u.analysis_group.id)),t[i].concat(s),this.collate?.settings?.projectAnalysisGroupVisibility){let l=this.collate?.settings.projectAnalysisGroupVisibility[i];t[i]=t[i].filter(u=>!l||!(u.analysis_group.id in l)?!0:l[u.analysis_group.id])}}))}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults(),console.log(this.filteredResults)}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{this.searchSession=n}),this.web.getSearchResults(t,99999).subscribe(n=>{if(!this.collate)return;console.log(n.results);let a=Array.from(new Set(n.results.map(o=>o.search_term)));this.pastSearches.find(o=>o.searchID===t)||(this.pastSearches.push({searchQuery:null,termFounds:a,collate:this.collate.id,searchID:t}),this.pastSearches=this.pastSearches.slice(-20),localStorage.setItem("cinderPastSearches",JSON.stringify(this.pastSearches))),this.distributeSearchResults(n.results).then()})}restoreSearches(t,n){this.web.getSearchSession(n).subscribe(a=>{this.searchSession=a}),t?this.distributeSearchResults(t.results).then():this.web.getSearchResults(n,99999).subscribe(a=>{this.distributeSearchResults(a.results).then()})}navigateToEdit(){this.collate&&this.router.navigate([`/collate/edit/${this.collate.id}`])}openQRCodeDialog(){let t=window.location.href,n=this.dialog.open(Lu);n.componentInstance.url=t}navigateToHome(){this.router.navigate(["/"])}exportData(t){this.web.exportSearchData(this.searchSession.id,t,1e-8,1e-8,this.web.searchSessionID).subscribe(n=>{this.waitingForDownload=!0})}openVisibilityDialog(){let t=this.dialog.open(lo);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let a={};n.forEach(o=>{a[o.project]||(a[o.project]=[]),a[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),l=this.collate?.settings.analysisGroupOrderMap[s];if(!l||!a[s])return;let u=a[s].filter(c=>!l.includes(c.id));a[s]=a[s].filter(c=>l.includes(c.id)),a[s]=a[s].sort((c,d)=>l.indexOf(c.id)-l.indexOf(d.id)),a[s]=a[s].concat(u)}),t.componentInstance.projectAnalysisGroupMap=a,t.componentInstance.projects=this.projects;let i={};this.collate?.settings?.projectAnalysisGroupVisibility&&(i=this.collate.settings.projectAnalysisGroupVisibility);for(let o in a){i[o]||(i[o]={});for(let s of a[o])s.id in i[o]||(i[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},i)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}static{this.\u0275fac=function(n){return new(n||r)(_e(iu),_e(Li),_e(br),_e(Un),_e(rn),_e(Jt),_e(Ar),_e(qn))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-view"]],inputs:{sessionId:"sessionId",collateId:"collateId"},decls:18,vars:9,consts:[["previousSearch","matMenu"],["href","/#/home"],[3,"width","height","ngSrc"],[1,"spacer"],["mat-icon-button","","matTooltip","Open QR code dialog",3,"click"],["mat-icon-button","","matTooltip","Change analysis group visibility",3,"click"],["mat-icon-button","","matTooltip","Edit collate"],[3,"collate"],[2,"display","flex","justify-content","center"],[3,"searchResultID","projects"],["mat-icon-button","","matTooltip","View previous searches",3,"matMenuTriggerFor"],["mat-menu-item","","disabled",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-icon-button","","matTooltip","Edit collate",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTags"],["mat-icon-button","","matTooltip","Toggle Cytoscape Plot",3,"click"],[3,"renameCondition","projects","searchResultsMap"],[2,"padding","20px"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"searchTerm","renameCondition","projects","filteredResults"],["mat-tab-label",""],["mat-icon-button","","matTooltip","Export data",3,"click","disabled"]],template:function(n,a){n&1&&($(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"a",1),ke(3,"img",2),q(),ke(4,"span",3),Ee(5,Ob,7,2),$(6,"button",4),ue("click",function(){return a.openQRCodeDialog()}),$(7,"mat-icon"),ie(8,"qr_code"),q()(),$(9,"button",5),ue("click",function(){return a.openVisibilityDialog()}),$(10,"mat-icon"),ie(11,"visibility"),q()(),Ee(12,Fb,3,0,"button",6),q()(),Ee(13,Lb,1,1,"app-collate-header",7)(14,Nb,1,1),$(15,"div",8)(16,"app-collate-search",9),ue("searchResultID",function(o){return a._sessionId=o,a.getSearchFromID(o)}),q()(),Ee(17,qb,9,5)),n&2&&(Z(3),pe("width",25)("height",25)("ngSrc","/assets/logo.png"),Z(2),Ie(a.collate?5:-1),Z(7),Ie(a.accounts.loggedIn?12:-1),Z(),Ie(a.collate?13:-1),Z(),Ie(a.collate&&a.collate.settings?14:-1),Z(2),pe("projects",a.projects),Z(),Ie(a.searchTerms.length>0?17:-1))},dependencies:[Au,ao,Yi,Qi,oo,Ut,Jr,Vi,Ni,so,au,eo,Ji,to,Tu,Pi,Zf],encapsulation:2})}}return r})();var Jf=(r,e)=>e.id;function Hb(r,e){if(r&1){let t=Oe();$(0,"mat-chip",2),ue("click",function(){let a=ge(t).$implicit,i=re(2);return me(i.removeProject(a))}),ie(1),q()}if(r&2){let t=e.$implicit;Z(),$e(" ",t.name," ")}}function Wb(r,e){if(r&1&&($(0,"div"),ie(1),$(2,"mat-chip-set"),We(3,Hb,2,1,"mat-chip",null,Jf),q()()),r&2){let t=re();Z(),$e(" Selected Projects: ",t.selectedMultipleProjects.length," "),Z(2),Ke(t.selectedMultipleProjects)}}function Kb(r,e){if(r&1&&($(0,"mat-list-option",4),ie(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),Ze(t.name)}}function Ub(r,e){if(r&1){let t=Oe();$(0,"div")(1,"mat-selection-list",3),We(2,Kb,2,2,"mat-list-option",4,Jf),q(),$(4,"mat-paginator",5),ue("page",function(a){ge(t);let i=re(2);return me(i.handleProjectPageEvent(a))}),q()()}if(r&2){let t=re(2);Z(),pe("multiple",!1),Z(),Ke(t.projectQuery.results),Z(2),pe("pageSize",t.projectPageSize)("length",t.projectQuery.count)("pageIndex",t.projectPageIndex)}}function Xb(r,e){r&1&&($(0,"p"),ie(1,"No projects found."),q())}function Yb(r,e){if(r&1&&Ee(0,Ub,5,4,"div")(1,Xb,2,0,"p"),r&2){let t=re();Ie(t.projectQuery.count>0?0:1)}}var eh=(()=>{class r{constructor(t,n){this.fb=t,this.web=n,this.multipleSelection=!1,this.selectedProjects=new at,this.formProjectSearch=this.fb.group({searchTerm:new Cr("",yr.required),selectedProjects:new Cr([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(a=>{a&&this.fetchProjects(a,this.projectPageSize,0)}),this.formProjectSearch.controls.selectedProjects.valueChanges.subscribe(a=>{if(a){for(let i of a)this.selectedMultipleProjects.includes(i)||this.selectedMultipleProjects.push(i);this.selectedProjects.emit(this.selectedMultipleProjects)}})}fetchProjects(t,n,a){let i=a*n;this.web.getProjects(void 0,n,i,t,void 0).subscribe(o=>{this.projectQuery=o})}handleProjectPageEvent(t){this.projectPageIndex=t.pageIndex,this.fetchProjects(this.formProjectSearch.controls.searchTerm.value||"",t.pageSize,t.pageIndex)}removeProject(t){this.selectedMultipleProjects=this.selectedMultipleProjects.filter(n=>n!==t),this.selectedProjects.emit(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(_e(Yt),_e(Jt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-search"]],inputs:{multipleSelection:"multipleSelection"},outputs:{selectedProjects:"selectedProjects"},decls:7,vars:3,consts:[[2,"display","flex","flex-direction","column","gap","10px",3,"formGroup"],["matInput","","formControlName","searchTerm","placeholder","Search Project Name","type","search"],[3,"click"],["formControlName","selectedProjects",3,"multiple"],[3,"value"],[3,"page","pageSize","length","pageIndex"]],template:function(n,a){n&1&&($(0,"form",0)(1,"mat-form-field"),ke(2,"input",1),$(3,"mat-label"),ie(4,"Search For Specific Projects"),q()(),Ee(5,Wb,5,1,"div")(6,Yb,2,1),q()),n&2&&(pe("formGroup",a.formProjectSearch),Z(5),Ie(a.selectedMultipleProjects.length>0?5:-1),Z(),Ie(a.projectQuery?6:-1))},dependencies:[dr,cr,Xt,xt,ur,Dr,kr,Qt,Zt,Pr,Ri,Ii,ki,Di,Ai],encapsulation:2})}}return r})();var th=(()=>{class r{constructor(t,n,a){this.dialogRef=t,this.fb=n,this.web=a,this.formProjectSearch=this.fb.group({searchTerm:new Cr("",yr.required),selectedProjects:new Cr([])}),this.projectPageSize=5,this.projectPageIndex=0,this.projectQuery=void 0,this.selectedMultipleProjects=[],this.multipleSelection=!0,this.web.getProjects(void 0,this.projectPageSize,0,void 0).subscribe(i=>{this.projectQuery=i}),this.formProjectSearch.controls.searchTerm.valueChanges.subscribe(i=>{i&&this.web.getProjects(void 0,this.projectPageSize,0,i).subscribe(o=>{this.projectQuery=o})})}handleSelectedProjects(t){this.selectedMultipleProjects=t}close(){this.dialogRef.close()}save(){this.dialogRef.close(this.selectedMultipleProjects)}static{this.\u0275fac=function(n){return new(n||r)(_e(At),_e(Yt),_e(Jt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-project-add-dialog"]],decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"selectedProjects"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,a){n&1&&($(0,"h2",0),ie(1,"Project Add"),q(),$(2,"div",1)(3,"app-project-search",2),ue("selectedProjects",function(o){return a.handleSelectedProjects(o)}),q(),$(4,"small"),ie(5),q()(),$(6,"div",3)(7,"button",4),ue("click",function(){return a.save()}),ie(8,"Submit"),q(),$(9,"button",4),ue("click",function(){return a.close()}),ie(10,"Close"),q()()),n&2&&(Z(5),$e("Selected ",a.selectedMultipleProjects.length," Projects."))},dependencies:[eh,Bt,It,Rt,ut],encapsulation:2})}}return r})();var rh=(r,e)=>e.id;function Qb(r,e){if(r&1&&($(0,"mat-list-item",5)(1,"mat-icon",7),ie(2,"notes"),q(),$(3,"div",8),ie(4),q(),ke(5,"div",9),q()),r&2){let t=e.$implicit;Z(4),Ze(t.name)}}function Zb(r,e){if(r&1){let t=Oe();$(0,"div",5)(1,"div",6)(2,"b"),ie(3),q()(),$(4,"div",4),ue("cdkDropListDropped",function(a){let i=ge(t).$implicit,o=re(2);return me(o.drop(a,i.id))}),We(5,Qb,6,1,"mat-list-item",5,rh),q(),ke(7,"mat-divider"),q()}if(r&2){let t=e.$implicit,n=re(2);Z(3),Ze(t.name),Z(2),Ke(n.projectAnalysisGroupMap[t.id])}}function Jb(r,e){if(r&1){let t=Oe();$(0,"mat-list")(1,"div",4),ue("cdkDropListDropped",function(a){ge(t);let i=re();return me(i.dropProject(a))}),We(2,Zb,8,1,"div",5,rh),q()()}if(r&2){let t=re();Z(2),Ke(t.projects)}}var nh=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set projectAnalysisGroupMap(t){this._projectAnalysisGroupMap=t}get projectAnalysisGroupMap(){return this._projectAnalysisGroupMap}constructor(t){this.dialogRef=t,this._projectAnalysisGroupMap={},this._projects=[]}save(){this.dialogRef.close({projects:this.projects,projectAnalysisGroupMap:this.projectAnalysisGroupMap})}cancel(){this.dialogRef.close()}drop(t,n){Sn(this.projectAnalysisGroupMap[n],t.previousIndex,t.currentIndex)}dropProject(t){Sn(this.projects,t.previousIndex,t.currentIndex)}static{this.\u0275fac=function(n){return new(n||r)(_e(At))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-project-analysis-group-reorder-dialog"]],inputs:{projects:"projects",projectAnalysisGroupMap:"projectAnalysisGroupMap"},decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag",""],["mat-subheader","","cdkDragHandle",""],["cdkDragHandle","","matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""]],template:function(n,a){n&1&&($(0,"h1",0),ie(1,"Analysis Group Reorder"),q(),$(2,"div",1),Ee(3,Jb,4,0,"mat-list"),q(),$(4,"div",2)(5,"button",3),ue("click",function(){return a.cancel()}),ie(6,"Close"),q(),$(7,"button",3),ue("click",function(){return a.save()}),ie(8,"Save"),q()()),n&2&&(Z(3),Ie(a.projects.length>0?3:-1))},dependencies:[Bt,It,mu,Cu,yu,Mi,Ut,gu,ro,an,nn,Rt,ut],encapsulation:2})}}return r})();var ew=["hueSlider"],tw=["alphaSlider"];function rw(r,e){if(r&1){let t=Oe();$(0,"div",10),ue("newValue",function(a){ge(t);let i=re();return me(i.onSliderChange("saturation-lightness",a))}),$(1,"div",11),ke(2,"div"),q()()}if(r&2){let t=re();Zr("background-color",t.hueSliderColor),pe("rgX",1)("rgY",1),Z(),Zr("top",t.slider==null?null:t.slider.v,"px")("left",t.slider==null?null:t.slider.s,"px")}}function nw(r,e){if(r&1&&($(0,"div",12),ke(1,"div",13)(2,"div",14),q()),r&2){let t=re();Z(2),Zr("background-color",t.selectedColor)}}function aw(r,e){if(r&1){let t=Oe();$(0,"div",15,1),ue("newValue",function(a){ge(t);let i=re();return me(i.onSliderChange("hue",a))}),$(2,"div",16)(3,"div"),ke(4,"div"),q()()()}if(r&2){let t=re();pe("rgX",1),Z(2),Zr("left",t.slider==null?null:t.slider.h,"px")}}function iw(r,e){if(r&1){let t=Oe();$(0,"div",17,2),ue("newValue",function(a){ge(t);let i=re();return me(i.onSliderChange("alpha",a))}),ke(2,"div",18),$(3,"div",16)(4,"div"),ke(5,"div"),q()()()}if(r&2){let t=re();pe("rgX",1),Z(2),pe("ngStyle",t.getBackgroundColor(t.alphaSliderColor)),Z(),Zr("left",t.slider==null?null:t.slider.a,"px")}}var ow=["dialog"],oh=r=>({background:r});function sw(r,e){r&1&&ke(0,"div",12)}function lw(r,e){if(r&1){let t=Oe();bt(0),$(1,"div",9)(2,"div",10),ue("click",function(){let a=ge(t).$implicit,i=re(2);return me(i.onColorClick(a))}),Ee(3,sw,1,0,"div",11),q()(),wt()}if(r&2){let t=e.$implicit,n=e.index,a=re(2);Z(2),Ci("colornull",!t),pe("ngStyle",a.getBackgroundColor(t)),Z(),pe("ngIf",n==a.indexSeleccionado)}}function uw(r,e){if(r&1&&ke(0,"div",18),r&2){let t=re(3);pe("ngStyle",t.getBackgroundColor(t.color))}}function cw(r,e){if(r&1){let t=Oe();$(0,"div",13),ue("click",function(){ge(t);let a=re(2);return me(a.addColor())}),Ee(1,uw,1,1,"div",14),mi(),$(2,"svg",15),ke(3,"path",16)(4,"path",17),q()()}if(r&2){let t=re(2);Z(),pe("ngIf",t.indexSeleccionado===void 0)}}function dw(r,e){if(r&1){let t=Oe();$(0,"color-picker",19),ue("colorChange",function(a){ge(t);let i=re(2);return me(i.onChangeColorPicker(a))})("onAlphaChange",function(a){ge(t);let i=re(2);return me(i.onAlphaChange(a))}),q()}if(r&2){let t=re(2);pe("controls",t.colorPickerControls)("color",t.hsva)}}function fw(r,e){if(r&1&&(bt(0),$(1,"div",5),Ee(2,lw,4,4,"ng-container",6)(3,cw,5,1,"div",7)(4,dw,1,2,"color-picker",8),q(),wt()),r&2){let t=re();Z(),pe("@colorsAnimation",t.colorsAnimationEffect),Z(),pe("ngForOf",t.palette),Z(),pe("ngIf",!t.hideColorPicker&&t.colorPickerControls!="only-alpha"),Z(),pe("ngIf",!t.hideColorPicker&&t.colorPickerControls=="only-alpha")}}function hw(r,e){r&1&&ke(0,"div",12)}function vw(r,e){if(r&1){let t=Oe();bt(0),$(1,"div",9)(2,"div",25),ue("click",function(){let a=ge(t).$implicit,i=re(2);return me(i.changeColor(a))}),Ee(3,hw,1,0,"div",11),q()(),wt()}if(r&2){let t=e.$implicit,n=re(2);Z(2),Ci("colornull",!t),pe("ngStyle",ys(4,oh,t)),Z(),pe("ngIf",n.isSelected(t))}}function pw(r,e){if(r&1){let t=Oe();bt(0),$(1,"div",5)(2,"div",20)(3,"div",21),ue("click",function(){ge(t);let a=re();return me(a.onClickBack())}),mi(),$(4,"svg",22),ke(5,"path",23)(6,"path",24),q()()(),Ee(7,vw,4,6,"ng-container",6),q(),wt()}if(r&2){let t=re();Z(),pe("@colorsAnimation",t.colorsAnimationEffect),Z(6),pe("ngForOf",t.variants)}}function gw(r,e){if(r&1){let t=Oe();bt(0),$(1,"div",26)(2,"div",27),ue("click",function(){ge(t);let a=re();return me(a.onClickBack())}),mi(),$(3,"svg",22),ke(4,"path",23)(5,"path",24),q()(),Wl(),$(6,"button",28),ue("click",function(){ge(t);let a=re();return me(a.emitClose("cancel"))}),ie(7),q(),$(8,"button",28),ue("click",function(){ge(t);let a=re();return me(a.emitClose("accept"))}),ie(9),q()(),$(10,"div",29)(11,"color-picker",30),ue("sliderChange",function(a){ge(t);let i=re();return me(i.onChangeColorPicker(a))}),q()(),wt()}if(r&2){let t=re();Z(7),$e(" ",t.cancelLabel," "),Z(2),$e(" ",t.acceptLabel," "),Z(2),pe("controls",t.colorPickerControls)("color",t.hsva)}}function mw(r,e){if(r&1){let t=Oe();$(0,"div",31)(1,"p",32),ue("click",function(){ge(t);let a=re();return me(a.nextFormat())}),ie(2),q(),$(3,"div",33)(4,"input",34,1),ue("keyup",function(){ge(t);let a=mr(5),i=re();return me(i.changeColorManual(a.value))})("keydown.enter",function(){ge(t);let a=re();return me(a.emitClose("accept"))}),q()()()}if(r&2){let t=re();Z(2),Ze(t.colorFormats[t.format]),Z(2),Zr("font-size",t.color&&t.color.length>23?9:10,"px")("letter-spacing",t.color&&t.color.length>16?0:1.5,"px"),pe("placeholder",t.placeholder)("value",t.color)}}var Bl=["hex","rgba","hsla","cmyk"],rr=function(r){return r[r.HEX=0]="HEX",r[r.RGBA=1]="RGBA",r[r.HSLA=2]="HSLA",r[r.CMYK=3]="CMYK",r}(rr||{}),ah=[{color:"rojo",preview:"#E57373",variants:["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828"]},{color:"rosa",preview:"#F06292",variants:["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457"]},{color:"purpura",preview:"#BA68C8",variants:["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A"]},{color:"purpura oscuro",preview:"#9575CD",variants:["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0"]},{color:"indigo",preview:"#7986CB",variants:["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593"]},{color:"azul",preview:"#64B5F6",variants:["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0"]},{color:"celeste",preview:"#4FC3F7",variants:["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD"]},{color:"cyan",preview:"#4DD0E1",variants:["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F"]},{color:"color",preview:"#4DB6AC",variants:["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C"]},{color:"verde",preview:"#81C784",variants:["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32"]},{color:"verde claro",preview:"#AED581",variants:["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F"]},{color:"lima",preview:"#DCE775",variants:["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24"]},{color:"amarillo",preview:"#FFF176",variants:["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825"]},{color:"ambar",preview:"#FFD54F",variants:["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00"]},{color:"naranja",preview:"#FFB74D",variants:["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00"]},{color:"naranja oscuro",preview:"#FF8A65",variants:["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315"]},{color:"marron",preview:"#A1887F",variants:["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E"]},{color:"escala de grises",preview:"#E0E0E0",variants:["#FFFFFF","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#000000"]},{color:"azul gris",preview:"#90A4AE",variants:["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F"]}],zr=class{constructor(e,t,n,a){this.r=e,this.g=t,this.b=n,this.a=a}denormalize(){return this.r=Math.round(this.r*255),this.g=Math.round(this.g*255),this.b=Math.round(this.b*255),this}toString(){return this.denormalize(),"rgb"+(this.a!=1?"a(":"(")+this.r+", "+this.g+", "+this.b+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},Sr=class{constructor(e,t,n,a){this.h=e,this.s=t,this.v=n,this.a=a,this.onChange=new at(!0)}onColorChange(e){this.s=e.s/e.rgX,this.v=e.v/e.rgY}onHueChange(e){this.h=e.v/e.rgX}onValueChange(e){this.v=e.v/e.rgX}onAlphaChange(e){this.a=e.v/e.rgX}},zn=class{constructor(e,t,n,a){this.h=e,this.s=t,this.l=n,this.a=a}denormalize(){return this.h=Math.round(this.h*360),this.s=Math.round(this.s*100),this.l=Math.round(this.l*100),this}toString(){return"hsl"+(this.a!=1?"a(":"(")+this.h+", "+this.s+"%, "+this.l+"%"+(this.a!=1?", "+this.a.toPrecision(2)+")":")")}},_n=class{constructor(e,t,n,a,i=1){this.c=e,this.m=t,this.y=n,this.k=a,this.a=i}denormalize(){return this.c=Math.round(this.c*100),this.m=Math.round(this.m*100),this.y=Math.round(this.y*100),this.k=Math.round(this.k*100),this}toString(){return this.denormalize(),"cmyk("+this.c+", "+this.m+", "+this.y+", "+this.k+")"}},Il=class{constructor(e){e&&(this.preview=e.preview,this.variants=e.variants)}},cs=(()=>{class r{constructor(){}toFormat(t,n){var a="";if(t)switch(n){case rr.HEX:var o=this.hsvaToRgba(t);o.denormalize();var a=this.rgbaToHex(o,!0);break;case rr.HSLA:var i=this.hsva2hsla(t);i.denormalize();var a=i.toString();break;case rr.RGBA:var o=this.hsvaToRgba(t),a=o.toString();break;case rr.CMYK:var s=this.hsvaToCmyk(t),a=s.toString();break}return a}stringToFormat(t,n){var a=this.stringToHsva(t,!0);return this.toFormat(a,n)}hsva2hsla(t){let n=t.h,a=t.s,i=t.v,o=t.a;if(i===0)return new zn(n,0,0,o);if(a===0&&i===1)return new zn(n,1,1,o);{let s=i*(2-a)/2;return new zn(n,i*a/(1-Math.abs(2*s-1)),s,o)}}hsla2hsva(t){let n=Math.min(t.h,1),a=Math.min(t.s,1),i=Math.min(t.l,1),o=Math.min(t.a,1);if(i===0)return new Sr(n,0,0,o);{let s=i+a*(1-Math.abs(2*i-1))/2;return new Sr(n,2*(s-i)/s,s,o)}}hsvaToRgba(t){let n,a,i,o=t.h,s=t.s,l=t.v,u=t.a,c=Math.floor(o*6),d=o*6-c,f=l*(1-s),v=l*(1-d*s),h=l*(1-(1-d)*s);switch(c%6){case 0:n=l,a=h,i=f;break;case 1:n=v,a=l,i=f;break;case 2:n=f,a=l,i=h;break;case 3:n=f,a=v,i=l;break;case 4:n=h,a=f,i=l;break;case 5:n=l,a=f,i=v;break;default:n=0,a=0,i=0}return new zr(n,a,i,u)}cmykToRgb(t){let n=(1-t.c)*(1-t.k),a=(1-t.m)*(1-t.k),i=(1-t.y)*(1-t.k);return new zr(n,a,i,t.a)}rgbaToCmyk(t){let n=1-Math.max(t.r,t.g,t.b);if(n===1)return new _n(0,0,0,1,t.a);{let a=(1-t.r-n)/(1-n),i=(1-t.g-n)/(1-n),o=(1-t.b-n)/(1-n);return new _n(a,i,o,n,t.a)}}hsvaToCmyk(t){let n=this.hsvaToRgba(t);return this.rgbaToCmyk(n)}rgbaToHsva(t){let n,a,i=Math.min(t.r,1),o=Math.min(t.g,1),s=Math.min(t.b,1),l=Math.min(t.a,1),u=Math.max(i,o,s),c=Math.min(i,o,s),d=u,f=u-c;if(a=u===0?0:f/u,u===c)n=0;else{switch(u){case i:n=(o-s)/f+(o<s?6:0);break;case o:n=(s-i)/f+2;break;case s:n=(i-o)/f+4;break;default:n=0}n/=6}return new Sr(n,a,d,l)}rgbaToHex(t,n){let a="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return t.a!=1&&(a+=(256|Math.round(t.a*255)).toString(16).substr(1)),a}normalizeCMYK(t){return new _n(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new _n(Math.floor(t.c*100),Math.floor(t.m*100),Math.floor(t.y*100),Math.floor(t.k*100),t.a)}denormalizeRGBA(t){return new zr(Math.round(t.r*255),Math.round(t.g*255),Math.round(t.b*255),t.a)}stringToHsva(t="",n=!0){let a=null;t=(t||"").toLowerCase();let i=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new zr(parseInt(o[2],10)/255,parseInt(o[3],10)/255,parseInt(o[4],10)/255,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new zn(parseInt(o[2],10)/360,parseInt(o[3],10)/100,parseInt(o[4],10)/100,isNaN(parseFloat(o[5]))?1:parseFloat(o[5]))}},{re:/cmyk?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(o){return new _n(parseInt(o[1],10)/100,parseInt(o[2],10)/100,parseInt(o[3],10)/100,parseInt(o[4],10)/100)}}];n?i.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(o){return new zr(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,parseInt(o[4]||"FF",16)/255)}}):i.push({re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(o){return new zr(parseInt(o[1],16)/255,parseInt(o[2],16)/255,parseInt(o[3],16)/255,1)}}),i.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(o){return new zr(parseInt(o[1]+o[1],16)/255,parseInt(o[2]+o[2],16)/255,parseInt(o[3]+o[3],16)/255,1)}});for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],l=s.re.exec(t),u=l&&s.parse(l);if(u){if(u instanceof zr)a=this.rgbaToHsva(u);else if(u instanceof zn)a=this.hsla2hsva(u);else if(u instanceof _n){let c=this.cmykToRgb(u);a=this.rgbaToHsva(c)}return a}}return a}outputFormat(t){return this.hsvaToRgba(t).toString()}getFormatByString(t){if(t){t=t.toLowerCase();let n=/(#([\da-f]{3}(?:[\da-f]{3})?(?:[\da-f]{2})?))/,a=/(rgba\((\d{1,3},\s?){3}(1|0?\.\d+)\)|rgb\(\d{1,3}(,\s?\d{1,3}){2}\))/,i=/(hsla\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|hsl\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/,o=/(cmyk\(\d{1,3}(,\s?\d{1,3}){3}\))/;if(n.test(t))return"hex";if(a.test(t))return"rgba";if(i.test(t))return"hsla";if(o.test(t))return"cmyk"}return"hex"}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=hs({token:r,factory:r.\u0275fac}),r})(),us=class{constructor(e,t,n,a){this.h=e,this.s=t,this.v=n,this.a=a}},Rl=class{constructor(e,t,n,a){this.h=e,this.s=t,this.v=n,this.a=a}},yw=(()=>{class r{mouseDown(t){this.start(t)}touchStart(t){this.start(t)}constructor(t){this.elRef=t,this.dragEnd=new at,this.dragStart=new at,this.newValue=new at,this.listenerMove=n=>this.move(n),this.listenerStop=()=>this.stop()}move(t){t.preventDefault(),this.setCursor(t)}start(t){this.setCursor(t),t.stopPropagation(),document.addEventListener("mouseup",this.listenerStop),document.addEventListener("touchend",this.listenerStop),document.addEventListener("mousemove",this.listenerMove),document.addEventListener("touchmove",this.listenerMove),this.dragStart.emit()}stop(){document.removeEventListener("mouseup",this.listenerStop),document.removeEventListener("touchend",this.listenerStop),document.removeEventListener("mousemove",this.listenerMove),document.removeEventListener("touchmove",this.listenerMove),this.dragEnd.emit()}getX(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageX!==void 0?t.pageX:t.touches[0].pageX)-n.left-window.pageXOffset}getY(t){let n=this.elRef.nativeElement.getBoundingClientRect();return(t.pageY!==void 0?t.pageY:t.touches[0].pageY)-n.top-window.pageYOffset}setCursor(t){let n=this.elRef.nativeElement.offsetWidth,a=this.elRef.nativeElement.offsetHeight,i=Math.max(0,Math.min(this.getX(t),n)),o=Math.max(0,Math.min(this.getY(t),a));this.rgX!==void 0&&this.rgY!==void 0?this.newValue.emit({s:i/n,v:1-o/a,rgX:this.rgX,rgY:this.rgY}):this.rgX===void 0&&this.rgY!==void 0?this.newValue.emit({v:o/a,rgY:this.rgY}):this.rgX!==void 0&&this.rgY===void 0&&this.newValue.emit({v:i/n,rgX:this.rgX})}}return r.\u0275fac=function(t){return new(t||r)(_e(vs))},r.\u0275dir=gs({type:r,selectors:[["","slider",""]],hostBindings:function(t,n){t&1&&ue("mousedown",function(i){return n.mouseDown(i)})("touchstart",function(i){return n.touchStart(i)})},inputs:{rgX:"rgX",rgY:"rgY",slider:"slider"},outputs:{dragEnd:"dragEnd",dragStart:"dragStart",newValue:"newValue"},standalone:!1}),r})(),Cw=(()=>{class r{constructor(t,n){this.service=t,this.cdr=n,this.color=new Sr(0,1,1,1),this.controls="default",this.sliderChange=new at(!1),this.onAlphaChange=new at(!1),this.hsva=new Sr(0,1,1,1),this.selectedColor="#000000",this.fallbackColor="#000000"}ngOnInit(){this.color||(this.color=new Sr(0,1,1,1)),this.slider=new us(0,0,0,0),this.update()}ngOnDestroy(){}ngOnChanges(t){t.color&&this.color&&this.update()}ngAfterViewInit(){let t=this.hueSlider?.nativeElement.offsetWidth||140,n=this.alphaSlider?.nativeElement.offsetWidth||140;this.sliderDimMax=new Rl(t,220,130,n),this.update()}onSliderChange(t,n){switch(t){case"saturation-lightness":this.hsva.onColorChange(n);break;case"hue":this.hsva.onHueChange(n);break;case"alpha":this.hsva.onAlphaChange(n),this.onAlphaChange.emit(n);break;case"value":this.hsva.onValueChange(n);break}this.update(),this.setColor(this.outputColor)}setColor(t){this.color=t,this.sliderChange.emit(this.color)}getBackgroundColor(t){return{background:"linear-gradient(90deg, rgba(36,0,0,0) 0%, "+t+" 100%)"}}update(){if(this.hsva=this.color,this.sliderDimMax){let t=this.service.hsvaToRgba(this.hsva).denormalize(),n=this.service.hsvaToRgba(new Sr(this.hsva.h,1,1,1)).denormalize();this.hueSliderColor="rgb("+n.r+","+n.g+","+n.b+")",this.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",this.outputColor=this.hsva,this.selectedColor=this.service.hsvaToRgba(this.hsva).toString(),this.slider=new us(this.hsva.h*this.sliderDimMax.h-5,this.hsva.s*this.sliderDimMax.s-8,(1-this.hsva.v)*this.sliderDimMax.v-8,this.hsva.a*this.sliderDimMax.a-5),this.cdr.detectChanges()}}}return r.\u0275fac=function(t){return new(t||r)(_e(cs),_e(_i))},r.\u0275cmp=je({type:r,selectors:[["color-picker"]],viewQuery:function(t,n){if(t&1&&(jn(ew,5),jn(tw,5)),t&2){let a;Gn(a=$n())&&(n.hueSlider=a.first),Gn(a=$n())&&(n.alphaSlider=a.first)}},inputs:{color:"color",controls:"controls"},outputs:{sliderChange:"sliderChange",onAlphaChange:"onAlphaChange"},standalone:!1,features:[Hl],decls:8,vars:4,consts:[["dialogPopup",""],["hueSlider",""],["alphaSlider",""],[1,"color-picker",3,"click"],["class","saturation-lightness",3,"slider","rgX","rgY","background-color","newValue",4,"ngIf"],[1,"hue-alpha","box"],["class","left",4,"ngIf"],[1,"right"],["class","hue",3,"slider","rgX","newValue",4,"ngIf"],["class","alpha",3,"slider","rgX","newValue",4,"ngIf"],[1,"saturation-lightness",3,"newValue","slider","rgX","rgY"],[1,"cursor"],[1,"left"],[1,"selected-color-background"],[1,"selected-color"],[1,"hue",3,"newValue","slider","rgX"],[1,"sliderCursor"],[1,"alpha",3,"newValue","slider","rgX"],[1,"alpha-gradient",3,"ngStyle"]],template:function(t,n){if(t&1){let a=Oe();$(0,"div",3,0),ue("click",function(o){return ge(a),me(o.stopPropagation())}),Ee(2,rw,3,8,"div",4),$(3,"div",5),Ee(4,nw,3,2,"div",6),$(5,"div",7),Ee(6,aw,5,3,"div",8)(7,iw,6,4,"div",9),q()()()}t&2&&(Z(2),pe("ngIf",n.controls!="only-alpha"),Z(2),pe("ngIf",n.controls!="only-alpha"),Z(2),pe("ngIf",n.controls!="only-alpha"),Z(),pe("ngIf",n.controls!="no-alpha"))},dependencies:[Cs,Si,yw],styles:[`.color-picker{position:relative;z-index:1000;width:220px;height:auto;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}.color-picker *{box-sizing:border-box;margin:0;font-size:11px}.color-picker input{width:0;height:26px;min-width:0;font-size:13px;text-align:center;color:#000}.color-picker input:invalid,.color-picker input:-moz-ui-invalid,.color-picker input:-moz-submit-invalid{box-shadow:none}.color-picker input::-webkit-inner-spin-button,.color-picker input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none}.color-picker .sliderCursor{width:10px;border-radius:5px;position:absolute;margin-top:-3px;border:1px solid black}.color-picker .sliderCursor>div{border:2px solid white;border-radius:5px}.color-picker .sliderCursor>div>div{border-radius:5px;border:1px solid black;height:24px}.color-picker .cursor{position:absolute;width:21px;border:3px solid black;border-radius:100%;margin:-2px 0 0 -2px}.color-picker .cursor>div{height:15px;border:3px solid white;border-radius:100%}.color-picker .box{display:flex;padding:4px 8px}.color-picker .left{position:relative;padding:16px 8px}.color-picker .right{flex:1 1 auto;display:flex;flex-direction:column;gap:10px;padding:12px 8px}.color-picker .hue-alpha{display:flex;align-items:center;margin-bottom:3px}.color-picker .hue{direction:ltr;width:100%;height:24px;border:none;border-radius:5px;position:relative;cursor:pointer;background-size:100% 100%;background:linear-gradient(to right,red 0%,#ff0 17%,lime 33%,cyan 50%,blue 66%,#f0f 83%,red 100%)}.color-picker .alpha{direction:ltr;position:relative;width:100%;height:24px;border:none;border-radius:5px;cursor:pointer;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .alpha-gradient{width:100%;height:100%;border-radius:5px;position:absolute}.color-picker .selected-color{position:absolute;top:16px;left:8px;width:40px;height:40px;box-shadow:0 1px 1px 1px #00000026;border-radius:50%}.color-picker .selected-color-background{width:40px;height:40px;border-radius:50%;background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.color-picker .saturation-lightness{direction:ltr;cursor:crosshair;width:100%;position:relative;height:130px;border:none;touch-action:manipulation;background-image:linear-gradient(to top,#000 0%,transparent 100%),linear-gradient(to right,#fff 0%,transparent 100%)}
`],encapsulation:2}),r})(),bw=(()=>{class r{click(t){this.isOutside(t)&&this.emitClose("cancel")}onScroll(){this.onScreenMovement()}onResize(){this.onScreenMovement()}constructor(t,n){this.service=t,this.cdr=n,this.color="#000000",this.previewColor="#000000",this.hsva=new Sr(0,1,1,1),this.colorsAnimationEffect="slide-in",this.palette=ah,this.variants=[],this.userFormats=[],this.colorFormats=Bl,this.format=rr.HEX,this.formatMap={hex:rr.HEX,rgba:rr.RGBA,hsla:rr.HSLA,cmyk:rr.CMYK},this.canChangeFormat=!0,this.menu=1,this.hideColorPicker=!1,this.hideTextInput=!1,this.colorPickerControls="default",this.placeholder="#FFFFFF"}ngOnInit(){this.setPosition(),this.hsva=this.service.stringToHsva(this.color),this.indexSeleccionado=this.findIndexSelectedColor(this.palette)}ngAfterViewInit(){this.setPositionY()}onScreenMovement(){this.setPosition(),this.setPositionY(),this.panelRef.nativeElement.style.transition||(this.panelRef.nativeElement.style.transition="transform 0.5s ease-out")}findIndexSelectedColor(t){let n;if(this.color)for(let a=0;a<t.length;a++){let i=t[a];typeof i=="string"?this.service.stringToFormat(this.color,rr.HEX)==this.service.stringToFormat(i,rr.HEX)&&(n=a):i===void 0?this.color=void 0:this.findIndexSelectedColor(i.variants)!=null&&(n=a)}return n}iniciate(t,n,a,i,o,s,l,u,c,d,f,v,h=[]){if(this.colorPickerControls=f,this.triggerInstance=t,this.TriggerBBox=n,this.color=a,this.hideColorPicker=u,this.hideTextInput=l,this.acceptLabel=c,this.cancelLabel=d,h.length&&h.every(g=>Bl.includes(g))&&(this.colorFormats=h),s?this.colorFormats.includes(s)?(this.format=this.colorFormats.indexOf(s.toLowerCase()),this.canChangeFormat=!1,this.service.getFormatByString(this.color)!=s.toLowerCase()&&this.setColor(this.service.stringToHsva(this.color))):(console.error("Format provided is invalid, using HEX"),this.format=rr.HEX):(this.format=this.colorFormats.indexOf(this.service.getFormatByString(this.color)),this.format<0&&(this.format=0)),this.previewColor=this.color,this.palette=i??ah,this.colorsAnimationEffect=o,v=="top"){let m=this.TriggerBBox.nativeElement.getBoundingClientRect();this.positionString="transform: translateY(calc( -100% - "+m.height+"px ))"}}setPosition(){if(this.TriggerBBox){let n=this.TriggerBBox.nativeElement.getBoundingClientRect();this.top=n.top+n.height,n.left+250>window.innerWidth?this.left=n.right<250?window.innerWidth/2-250/2:n.right-250:this.left=n.left}}setPositionY(){let t=this.TriggerBBox.nativeElement.getBoundingClientRect(),n=this.panelRef.nativeElement.getBoundingClientRect(),a=n.height;t.bottom+a>window.innerHeight?this.positionString=t.top<n.height?"transform: translateY(-"+t.bottom+"px );":"transform: translateY(calc( -100% - "+t.height+"px ));":this.positionString="",this.cdr.detectChanges()}hasVariant(t){return this.previewColor?typeof t!="string"&&t.variants.some(n=>n.toUpperCase()==this.previewColor.toUpperCase()):!1}isSelected(t){return this.previewColor?typeof t=="string"&&t.toUpperCase()==this.previewColor.toUpperCase():!1}getBackgroundColor(t){return typeof t=="string"?{background:t}:{background:t?.preview}}onAlphaChange(t){this.palette=this.ChangeAlphaOnPalette(t,this.palette)}ChangeAlphaOnPalette(t,n){var a=[];for(let i=0;i<n.length;i++){let o=n[i];if(typeof o=="string"){let s=this.service.stringToHsva(o);s.onAlphaChange(t),a.push(this.service.toFormat(s,this.format))}else{let s=new Il,l=this.service.stringToHsva(o.preview);l.onAlphaChange(t),s.preview=this.service.toFormat(l,this.format),s.variants=this.ChangeAlphaOnPalette(t,o.variants),a.push(s)}}return a}changeColor(t){this.setColor(this.service.stringToHsva(t)),this.emitClose("accept")}onChangeColorPicker(t){this.temporalColor=t,this.color=this.service.toFormat(t,this.format),this.triggerInstance.sliderChange(this.service.toFormat(t,this.format))}changeColorManual(t){this.previewColor=t,this.color=t,this.hsva=this.service.stringToHsva(t),this.setPreviewColor(this.hsva),this.temporalColor=this.hsva,this.triggerInstance.setColor(this.color,this.previewColor)}setColor(t,n=-1){this.hsva=t;let a=this.colorFormats[this.format],i=n;i<0&&(i=this.formatMap[a]),this.color=this.service.toFormat(t,i),this.setPreviewColor(t),this.triggerInstance.setColor(this.color,this.previewColor)}setPreviewColor(t){this.previewColor=t?this.service.hsvaToRgba(t).toString():void 0}onChange(){}onColorClick(t){typeof t=="string"||t===void 0?this.changeColor(t):(this.variants=t.variants,this.menu=2)}addColor(){this.menu=3,this.backupColor=this.color,this.temporalColor=this.service.stringToHsva(this.color)}nextFormat(){if(this.canChangeFormat){this.format=(this.format+1)%this.colorFormats.length;let t=this.colorFormats[this.format],n=this.formatMap[t];this.setColor(this.hsva,n),this.placeholder=this.service.toFormat(new Sr(0,0,1,1),n)}}emitClose(t){this.menu==3&&(t=="cancel"||t=="accept"&&this.setColor(this.temporalColor)),this.triggerInstance.closePanel()}onClickBack(){this.menu==3&&(this.color=this.backupColor,this.hsva=this.service.stringToHsva(this.color)),this.indexSeleccionado=this.findIndexSelectedColor(this.palette),this.menu=1}isOutside(t){return t.target.classList.contains("ngx-colors-overlay")}}return r.\u0275fac=function(t){return new(t||r)(_e(cs),_e(_i))},r.\u0275cmp=je({type:r,selectors:[["ngx-colors-panel"]],viewQuery:function(t,n){if(t&1&&jn(ow,5),t&2){let a;Gn(a=$n())&&(n.panelRef=a.first)}},hostVars:4,hostBindings:function(t,n){t&1&&ue("mousedown",function(i){return n.click(i)},!1,ps)("scroll",function(){return n.onScroll()},!1,ps)("resize",function(){return n.onResize()},!1,Xl),t&2&&Zr("top",n.top,"px")("left",n.left,"px")},standalone:!1,decls:6,vars:6,consts:[["dialog",""],["paintInput",""],[1,"opened"],[4,"ngIf"],["class","manual-input-wrapper",4,"ngIf"],[1,"colors"],[4,"ngFor","ngForOf"],["style","background: rgb(245 245 245); position: relative","class","circle button",3,"click",4,"ngIf"],[3,"controls","color","colorChange","onAlphaChange",4,"ngIf"],[1,"circle","wrapper","color"],[1,"circle","color","circle-border",3,"click","ngStyle"],["class","selected",4,"ngIf"],[1,"selected"],[1,"circle","button",2,"background","rgb(245 245 245)","position","relative",3,"click"],["style",`
            position: absolute;
            height: 7px;
            width: 7px;
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 100%;
            top: 0;
            right: 0;
          `,3,"ngStyle",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 0 24 24","width","24px","fill","#222222"],["d","M24 24H0V0h24v24z","fill","none","opacity",".87"],["d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"],[2,"position","absolute","height","7px","width","7px","border","1px solid rgba(0, 0, 0, 0.03)","border-radius","100%","top","0","right","0",3,"ngStyle"],[3,"colorChange","onAlphaChange","controls","color"],[1,"circle","wrapper"],[1,"add",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M0 0h24v24H0z","fill","none"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"],[1,"circle","circle-border",3,"click","ngStyle"],[1,"nav-wrapper"],[1,"round-button","button",2,"float","left",3,"click"],[2,"float","right",3,"click"],[1,"color-picker-wrapper"],[3,"sliderChange","controls","color"],[1,"manual-input-wrapper"],[2,"cursor","pointer",3,"click"],[1,"g-input"],["type","text",3,"keyup","keydown.enter","placeholder","value"]],template:function(t,n){t&1&&($(0,"div",2,0),Ee(2,fw,5,4,"ng-container",3)(3,pw,8,2,"ng-container",3)(4,gw,12,4,"ng-container",3)(5,mw,6,7,"div",4),q()),t&2&&(Jl(n.positionString),Z(2),pe("ngIf",n.menu==1),Z(),pe("ngIf",n.menu==2),Z(),pe("ngIf",n.menu==3),Z(),pe("ngIf",!n.hideTextInput))},dependencies:[nu,Cs,Si,Cw],styles:["[_nghost-%COMP%]{position:fixed;z-index:2001}.hidden[_ngcontent-%COMP%]{display:none}.button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.top[_ngcontent-%COMP%]{transform:translateY(-100%)}.opened[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;background:#fff;width:250px;border-radius:5px;position:absolute}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-family:inherit;font-size:12px;background-color:unset;-webkit-user-select:none;user-select:none;padding:10px;letter-spacing:1px;color:#222;border-radius:3px;line-height:20px}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .opened[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-color:#0000000d;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1);transition-property:opacity,background-color;transition-duration:.2s,.2s;transition-timing-function:cubic-bezier(.35,0,.25,1),cubic-bezier(.35,0,.25,1);transition-delay:0s,0s}.opened[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin:15px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:34px;width:34px;box-sizing:border-box;border-radius:100%;cursor:pointer}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{font-size:20px;line-height:45px;text-align:center}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:2px solid white;border-radius:100%;height:28px;width:28px;box-sizing:border-box;margin:2px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper[_ngcontent-%COMP%]{margin:0 5px 5px;flex:34px 0 0}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.button[_ngcontent-%COMP%]{margin:0 5px 5px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle.wrapper.color[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}.opened[_ngcontent-%COMP%]   .colors[_ngcontent-%COMP%]   .circle-border[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.03)}.opened[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{margin:5px 15px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]{overflow:hidden;margin:5px}.opened[_ngcontent-%COMP%]   .nav-wrapper[_ngcontent-%COMP%]   .round-button[_ngcontent-%COMP%]{padding:5px 0;width:40px;height:40px;box-sizing:border-box;border-radius:100%;text-align:center;line-height:45px}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]{display:flex;margin:15px;font-family:sans-serif}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;line-height:48px;width:145px;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]{border:1px solid #e8ebed;height:45px;border-radius:5px;width:100%}.opened[_ngcontent-%COMP%]   .manual-input-wrapper[_ngcontent-%COMP%]   .g-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:9px;border:none;width:100%;text-transform:uppercase;outline:none;text-align:center;letter-spacing:1px;color:#595b65;height:100%;border-radius:5px;margin:0;padding:0}"],data:{animation:[du("colorsAnimation",[xs("void => slide-in",[Ea(":enter",qr({opacity:0}),{optional:!0}),Ea(":enter",_s("10ms",[bs(".3s ease-in",ws([qr({opacity:0,transform:"translatex(-50%)",offset:0}),qr({opacity:.5,transform:"translatex(-10px) scale(1.1)",offset:.3}),qr({opacity:1,transform:"translatex(0)",offset:1})]))]),{optional:!0})]),xs("void => popup",[Ea(":enter",qr({opacity:0,transform:"scale(0)"}),{optional:!0}),Ea(":enter",_s("10ms",[bs("500ms ease-out",ws([qr({opacity:.5,transform:"scale(.5)",offset:.3}),qr({opacity:1,transform:"scale(1.1)",offset:.8}),qr({opacity:1,transform:"scale(1)",offset:1})]))]),{optional:!0})])])]}}),r})(),ih={position:"fixed",height:"100%",width:"100%","z-index":2e3,top:0,left:0},sh=(()=>{class r{constructor(t,n,a){this.resolver=t,this.applicationRef=n,this.injector=a}createPanel(t,n){this.componentRef!=null&&this.removePanel();let a=this.resolver.resolveComponentFactory(bw);this.componentRef=a.create(this.injector),this.applicationRef.attachView(this.componentRef.hostView);let i=this.componentRef.hostView.rootNodes[0];return this.overlay=document.createElement("div"),this.overlay.id="ngx-colors-overlay",this.overlay.classList.add("ngx-colors-overlay"),this.overlay.classList.add(n),Object.keys(ih).forEach(o=>{this.overlay.style[o]=ih[o]}),t?document.getElementById(t).appendChild(this.overlay):document.body.appendChild(this.overlay),this.overlay.appendChild(i),this.componentRef}removePanel(){this.applicationRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.overlay.remove()}}return r.\u0275fac=function(t){return new(t||r)(gi(Yl),gi(Ql),gi(Kl))},r.\u0275prov=hs({token:r,factory:r.\u0275fac}),r})(),Ol=(()=>{class r{onClick(){this.openPanel()}constructor(t,n,a){this.triggerRef=t,this.panelFactory=n,this.service=a,this.color="",this.colorsAnimation="slide-in",this.position="bottom",this.attachTo=void 0,this.overlayClassName=void 0,this.colorPickerControls="default",this.acceptLabel="ACCEPT",this.cancelLabel="CANCEL",this.change=new at,this.input=new at,this.slider=new at,this.close=new at,this.open=new at,this.isDisabled=!1,this.onTouchedCallback=()=>{},this.onChangeCallback=()=>{}}ngOnDestroy(){this.panelRef&&this.panelFactory.removePanel()}openPanel(){this.isDisabled||(this.panelRef=this.panelFactory.createPanel(this.attachTo,this.overlayClassName),this.panelRef.instance.iniciate(this,this.triggerRef,this.color,this.palette,this.colorsAnimation,this.format,this.hideTextInput,this.hideColorPicker,this.acceptLabel,this.cancelLabel,this.colorPickerControls,this.position,this.formats)),this.open.emit(this.color)}closePanel(){this.panelFactory.removePanel(),this.onTouchedCallback(),this.close.emit(this.color)}setDisabledState(t){this.isDisabled=t,this.triggerRef.nativeElement.style.opacity=t?.5:1}setColor(t,n=""){this.writeValue(t,n),this.onChangeCallback(t),this.input.emit(t)}sliderChange(t){this.slider.emit(t)}get value(){return this.color}set value(t){this.setColor(t),this.onChangeCallback(t)}writeValue(t,n=""){if(t!==this.color){if(this.format){let i=Bl.indexOf(this.format.toLowerCase());t=this.service.stringToFormat(t,i)}this.color=t;let a=!1;t&&t.startsWith("cmyk")&&(a=!0,n||(n=this.service.stringToFormat(t,rr.RGBA))),this.change.emit(a?n:t)}}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}}return r.\u0275fac=function(t){return new(t||r)(_e(vs),_e(sh),_e(cs))},r.\u0275dir=gs({type:r,selectors:[["","ngx-colors-trigger",""]],hostBindings:function(t,n){t&1&&ue("click",function(){return n.onClick()})},inputs:{colorsAnimation:"colorsAnimation",palette:"palette",format:"format",formats:"formats",position:"position",hideTextInput:"hideTextInput",hideColorPicker:"hideColorPicker",attachTo:"attachTo",overlayClassName:"overlayClassName",colorPickerControls:"colorPickerControls",acceptLabel:"acceptLabel",cancelLabel:"cancelLabel"},outputs:{change:"change",input:"input",slider:"slider",close:"close",open:"open"},standalone:!1,features:[ru([{provide:fu,useExisting:ql(()=>r),multi:!0}])]}),r})(),lh=(()=>{class r{constructor(t,n){this.cdRef=t,this.triggerDirective=n,this.triggerDirectiveColorChangeSubscription=null,this.color=this.triggerDirective.color}ngOnInit(){this.triggerDirectiveColorChangeSubscription=this.triggerDirective.change.subscribe(t=>{this.color=t,this.cdRef.markForCheck()})}ngOnDestroy(){this.triggerDirectiveColorChangeSubscription&&this.triggerDirectiveColorChangeSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(_e(_i),_e(Ol,1))},r.\u0275cmp=je({type:r,selectors:[["ngx-colors"]],standalone:!1,decls:4,vars:5,consts:[[1,"app-color-picker"],[1,"preview"],[1,"preview-background"],[1,"circle",3,"ngStyle"]],template:function(t,n){t&1&&($(0,"div",0)(1,"div",1)(2,"div",2),ke(3,"div",3),q()()()),t&2&&(Z(3),Ci("colornull",!n.color),pe("ngStyle",ys(3,oh,n.color)))},dependencies:[Si],styles:["[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]{line-height:1px;font-family:sans-serif}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin:2px;display:inline-block;box-sizing:border-box;border-radius:100%;background:white;cursor:pointer;padding:3px;box-shadow:0 1px 1px #0003,0 1px 1px 1px #00000024,0 1px 1px 1px #0000001f}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-background[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px;border-radius:100%}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{height:20px;width:20px;box-sizing:border-box;border-radius:100%;cursor:pointer}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .circle.colornull[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(236,236,236,.7) 0%,rgba(236,236,236,.7) 45%,#de0f00 50%,rgba(236,236,236,.7) 55%,rgba(236,236,236,.7) 100%)}[_nghost-%COMP%]   .app-color-picker[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .noselected[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,#ccc 25%,transparent 25%),linear-gradient(-45deg,#ccc 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#ccc 75%),linear-gradient(-45deg,transparent 75%,#ccc 75%);background-size:16px 16px;background-position:0 0,0 8px,8px -8px,-8px 0px}"]}),r})(),uh=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=pi({providers:[cs,sh],imports:[Ti]}),r})();var xw=(r,e)=>e.id;function _w(r,e){if(r&1){let t=Oe();$(0,"div",4)(1,"ngx-colors",5),Kt("ngModelChange",function(a){let i=ge(t).$implicit,o=re(2).$implicit,s=re();return Wt(s.projectConditionColorMap[o.id][i],a)||(s.projectConditionColorMap[o.id][i]=a),me(a)}),q(),$(2,"div"),ie(3),q()()}if(r&2){let t=e.$implicit,n=re(2).$implicit,a=re();Z(),Ht("ngModel",a.projectConditionColorMap[n.id][t]),Z(2),Ze(t)}}function Sw(r,e){if(r&1&&We(0,_w,4,2,"div",4,$r),r&2){let t=re().$implicit,n=re();Ke(n.projectConditionMap[t.id])}}function Ew(r,e){if(r&1&&($(0,"div")(1,"div")(2,"b"),ie(3),q()(),Ee(4,Sw,2,0),q()),r&2){let t=e.$implicit,n=re();Z(3),Ze(t.name),Z(),Ie(n.projectConditionMap[t.id]?4:-1)}}var ch=(()=>{class r{set projects(t){this._projects=t;for(let n of t)this.web.getProjectUniqueConditions(n.id).subscribe(a=>{for(let i of a)this.projectConditionMap[i.AnalysisGroup.project]||(this.projectConditionMap[i.AnalysisGroup.project]=[]),this.projectConditionMap[i.AnalysisGroup.project].includes(i.Condition)||this.projectConditionMap[i.AnalysisGroup.project].push(i.Condition),this.projectConditionColorMap[i.AnalysisGroup.project]||(this.projectConditionColorMap[i.AnalysisGroup.project]={}),this.projectConditionColorMap[i.AnalysisGroup.project][i.Condition]||(this.projectConditionColorMap[i.AnalysisGroup.project][i.Condition]="")})}get projects(){return this._projects}set projectConditionColorMap(t){if(t==null){this._projectConditionColorMap={};return}this._projectConditionColorMap=Object.assign({},t)}get projectConditionColorMap(){return this._projectConditionColorMap}constructor(t,n){this.dialogRef=t,this.web=n,this._projects=[],this.projectConditionMap={},this._projectConditionColorMap={}}save(){this.dialogRef.close(this.projectConditionColorMap)}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(_e(At),_e(Jt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-condition-color-editor-dialog"]],inputs:{projects:"projects",projectConditionColorMap:"projectConditionColorMap"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],[2,"display","flex","gap","5px","align-items","center"],["ngx-colors-trigger","",3,"ngModelChange","ngModel"]],template:function(n,a){n&1&&($(0,"h1",0),ie(1,"Condition Color Editor"),q(),$(2,"div",1),We(3,Ew,5,2,"div",null,xw),q(),$(5,"div",2)(6,"button",3),ue("click",function(){return a.cancel()}),ie(7,"Close"),q(),$(8,"button",3),ue("click",function(){return a.save()}),ie(9,"Save"),q()()),n&2&&(Z(3),Ke(a.projects))},dependencies:[Bt,It,uh,lh,Ol,tn,xt,en,ut,Rt],encapsulation:2})}}return r})();function Tw(r,e){if(r&1&&($(0,"mat-option",6),ie(1),q()),r&2){let t=e.$implicit;pe("value",t),Z(),Ze(t)}}var dh=(()=>{class r{_filter(t){let n=t.toLowerCase();return this.tags.filter(a=>a.toLowerCase().includes(n))}constructor(t,n,a){this.fb=t,this.dialogRef=n,this.collateService=a,this.form=this.fb.group({name:["",yr.required],existing:[!1],id:[-1]}),this.tags=[]}ngOnInit(){this.filteredTags=this.form.controls.name.valueChanges.pipe(hi(""),vi(t=>this.collateService.getCollateTags(t).pipe(fi(n=>n.results.map(a=>a.name)))))}submit(){let t=this.form.controls.name.value;this.collateService.getCollateTags(t).subscribe(n=>{let a=n.results.find(o=>o.name.toLowerCase()===t.toLowerCase()),i=!!a;this.form.controls.existing.setValue(i),this.form.controls.id.setValue(i?a.id:null),this.dialogRef.close(this.form.value)})}cancel(){this.dialogRef.close()}onTagSelected(t){let n=t.option.value;this.form.controls.name.setValue(n),this.collateService.getCollateTags(n).subscribe(a=>{let i=a.results.find(o=>o.name.toLowerCase()===n.toLowerCase());this.form.controls.existing.setValue(!!i),this.form.controls.id.setValue(i?i.id:null)})}static{this.\u0275fac=function(n){return new(n||r)(_e(Yt),_e(At),_e(rn))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-tag-create-dialog"]],decls:18,vars:5,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["type","text","matInput","","formControlName","name",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","disabled"]],template:function(n,a){if(n&1){let i=Oe();$(0,"h1",1),ie(1,"Create/Add Tag"),q(),$(2,"div",2)(3,"form",3)(4,"mat-form-field")(5,"mat-label"),ie(6,"Tag Name"),q(),ke(7,"input",4),$(8,"mat-autocomplete",5,0),ue("optionSelected",function(s){return ge(i),me(a.onTagSelected(s))}),We(10,Tw,2,2,"mat-option",6,$r),wi(12,"async"),q()()()(),$(13,"div",7)(14,"button",8),ue("click",function(){return ge(i),me(a.cancel())}),ie(15,"Cancel"),q(),$(16,"button",9),ue("click",function(){return ge(i),me(a.submit())}),ie(17,"Submit"),q()()}if(n&2){let i=mr(9);Z(3),pe("formGroup",a.form),Z(4),pe("matAutocomplete",i),Z(3),Ke(xi(12,3,a.filteredTags)),Z(6),pe("disabled",a.form.invalid)}},dependencies:[Bt,It,dr,cr,Xt,xt,ur,Dr,kr,Pr,Zt,Qt,ut,Rt,Hn,Ei,Oi,Fi],encapsulation:2})}}return r})();var Mw=(r,e)=>e.id;function Dw(r,e){r&1&&($(0,"th",11),ie(1," Original Title "),q())}function kw(r,e){if(r&1&&($(0,"td",12),ie(1),q()),r&2){let t=e.$implicit;Z(),$e(" ",t," ")}}function Pw(r,e){r&1&&($(0,"th",11),ie(1," Display Title "),q())}function Aw(r,e){if(r&1&&($(0,"td",12)(1,"form",13)(2,"mat-form-field"),ke(3,"input",14),q()()()),r&2){let t=e.$implicit,n=re(2).$implicit,a=re();Z(),pe("formGroup",a.formMap[n.id][t]),Z(2),eu("formControlName",t)}}function Bw(r,e){r&1&&ke(0,"tr",15)}function Iw(r,e){r&1&&ke(0,"tr",16)}function Rw(r,e){if(r&1&&($(0,"h5"),ie(1),q(),$(2,"table",4),bt(3,5),Ee(4,Dw,2,0,"th",6)(5,kw,2,1,"td",7),wt(),bt(6,8),Ee(7,Pw,2,0,"th",6)(8,Aw,4,2,"td",7),wt(),Ee(9,Bw,1,0,"tr",9)(10,Iw,1,0,"tr",10),q()),r&2){let t=re().$implicit,n=re();Z(),Ze(t.name),Z(),pe("dataSource",n.projectConditionMap[t.id]),Z(7),pe("matHeaderRowDef",n.displayedColumns),Z(),pe("matRowDefColumns",n.displayedColumns)}}function Ow(r,e){if(r&1&&Ee(0,Rw,11,4),r&2){let t=e.$implicit,n=re();Ie(n.formMap[t.id]?0:-1)}}var fh=(()=>{class r{set projects(t){this._projects=t.slice()}get projects(){return this._projects}set renameSampleCondition(t){for(let n of this.projects)this.web.getProjectUniqueConditions(n.id).subscribe(a=>{for(let i of a){if(this.formMap[i.AnalysisGroup.project]||(this.formMap[i.AnalysisGroup.project]={}),!this.formMap[i.AnalysisGroup.project][i.Condition]){let o={};o[i.Condition]=new Cr(i.Condition,yr.required),this.formMap[i.AnalysisGroup.project][i.Condition]=this.fb.group(o)}this.projectConditionMap[i.AnalysisGroup.project]||(this.projectConditionMap[i.AnalysisGroup.project]=[]),this.projectConditionMap[i.AnalysisGroup.project].includes(i.Condition)||this.projectConditionMap[i.AnalysisGroup.project].push(i.Condition),this.renameSampleCondition[i.AnalysisGroup.project]||(this.renameSampleCondition[i.AnalysisGroup.project]={}),this.renameSampleCondition[i.AnalysisGroup.project][i.Condition]||(this.renameSampleCondition[i.AnalysisGroup.project][i.Condition]=i.Condition),t[i.AnalysisGroup.project]&&t[i.AnalysisGroup.project][i.Condition]&&(this.renameSampleCondition[i.AnalysisGroup.project][i.Condition]=t[i.AnalysisGroup.project][i.Condition],this.formMap[i.AnalysisGroup.project][i.Condition].controls[i.Condition].setValue(t[i.AnalysisGroup.project][i.Condition]))}})}get renameSampleCondition(){return this._renameSampleCondition}constructor(t,n,a,i){this.dialog=t,this.web=n,this.fb=a,this.sb=i,this.displayedColumns=["original","display"],this.projectConditionMap={},this._projects=[],this._renameSampleCondition={},this.formMap={}}close(){this.dialog.close()}submit(){let t={};for(let n in this.formMap){t[n]={};for(let a in this.formMap[n])if(t[n][a]=this.formMap[n][a].value[a],!this.formMap[n][a].valid){this.sb.open(`${a} is invalid`);return}}this.dialog.close(t)}static{this.\u0275fac=function(n){return new(n||r)(_e(At),_e(Jt),_e(Yt),_e(br))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-rename-sample-condition-dialog"]],inputs:{projects:"projects",renameSampleCondition:"renameSampleCondition"},decls:10,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","original"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","display"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"formGroup"],["matInput","",2,"border-radius","0",3,"formControlName"],["mat-header-row",""],["mat-row",""]],template:function(n,a){n&1&&($(0,"h1",0),ie(1,"Rename Conditions"),q(),$(2,"div",1),We(3,Ow,1,1,null,null,Mw),q(),$(5,"div",2)(6,"button",3),ue("click",function(){return a.submit()}),ie(7,"Submit"),q(),$(8,"button",3),ue("click",function(){return a.close()}),ie(9,"Close"),q()()),n&2&&(Z(3),Ke(a.projects))},dependencies:[Bt,It,dr,cr,Xt,xt,ur,Dr,kr,Hi,ji,$i,qi,Ui,Wi,Xi,Ki,zi,Gi,Rt,ut,Qt,Zt],encapsulation:2})}}return r})();var hh=(()=>{class r{set settings(t){for(let n in t)this._settings[n]=t[n];this._settings&&this.form.patchValue(this._settings)}get settings(){return this._settings}constructor(t,n){this.fb=t,this.dialog=n,this._settings={},this.form=this.fb.group({marginLeft:150,marginRight:100,marginTop:100,marginBottom:100,titleTextSize:14,showTitle:!0,height:500,barSize:50})}submit(){this.dialog.close(this.form.value)}close(){this.dialog.close()}static{this.\u0275fac=function(n){return new(n||r)(_e(Yt),_e(At))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-plot-settings"]],inputs:{settings:"settings"},decls:46,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"display","flex","flex-direction","column","gap","20px",3,"formGroup"],[2,"display","flex","flex-direction","column","gap","5px"],["matInput","","formControlName","height","type","number"],["matInput","","formControlName","barSize","type","number"],["matInput","","formControlName","marginLeft","type","number"],["matInput","","formControlName","marginRight","type","number"],["matInput","","formControlName","marginTop","type","number"],["matInput","","formControlName","marginBottom","type","number"],["formControlName","showTitle"],["matInput","","formControlName","titleTextSize","type","number"],["mat-dialog-actions",""],["mat-button","",3,"click"]],template:function(n,a){n&1&&($(0,"h5",0),ie(1,"Plot General Settings"),q(),$(2,"div",1)(3,"form",2)(4,"section",3)(5,"b"),ie(6,"Overall Size"),q(),$(7,"mat-form-field"),ke(8,"input",4),$(9,"mat-label"),ie(10,"Height"),q()(),$(11,"mat-form-field"),ke(12,"input",5),$(13,"mat-label"),ie(14,"Bar size"),q()(),$(15,"mat-form-field"),ke(16,"input",6),$(17,"mat-label"),ie(18,"Margin Left"),q()(),$(19,"mat-form-field"),ke(20,"input",7),$(21,"mat-label"),ie(22,"Margin Right"),q()(),$(23,"mat-form-field"),ke(24,"input",8),$(25,"mat-label"),ie(26,"Margin Top"),q()(),$(27,"mat-form-field"),ke(28,"input",9),$(29,"mat-label"),ie(30,"Margin Bottom"),q()()(),ke(31,"mat-divider"),$(32,"section",3)(33,"b"),ie(34,"Title"),q(),$(35,"mat-checkbox",10),ie(36,"Show Title"),q(),$(37,"mat-form-field"),ke(38,"input",11),$(39,"mat-label"),ie(40,"Title Text Size"),q()()()()(),$(41,"div",12)(42,"button",13),ue("click",function(){return a.close()}),ie(43,"Cancel"),q(),$(44,"button",13),ue("click",function(){return a.submit()}),ie(45,"Save"),q()()),n&2&&(Z(3),pe("formGroup",a.form))},dependencies:[Bt,It,dr,cr,Xt,vu,xt,ur,Dr,kr,Qt,Zt,Pr,Xn,Rt,ut,Mi],encapsulation:2})}}return r})();function Fw(r,e){if(r&1){let t=Oe();$(0,"mat-checkbox",12),Kt("ngModelChange",function(a){ge(t);let i=re(2);return Wt(i.collate.settings.showTags,a)||(i.collate.settings.showTags=a),me(a)}),ie(1,"Show Tags"),q()}if(r&2){let t=re(2);Ht("ngModel",t.collate.settings.showTags)}}function Lw(r,e){if(r&1){let t=Oe();$(0,"h1",15),ue("click",function(){ge(t);let a=re(3);return me(a.toggleEditTitle())}),ie(1),q(),ke(2,"br")}if(r&2){let t=re(3);Z(),Ze(t.collate.title)}}function Vw(r,e){if(r&1){let t=Oe();$(0,"div")(1,"mat-form-field",16)(2,"input",17),ue("keydown.enter",function(){ge(t);let a=re(3);return me(a.toggleEditTitle())}),Kt("ngModelChange",function(a){ge(t);let i=re(3);return Wt(i.collate.title,a)||(i.collate.title=a),me(a)}),q()(),$(3,"button",18),ue("click",function(){ge(t);let a=re(3);return me(a.toggleEditTitle())}),$(4,"mat-icon"),ie(5,"save"),q()()()}if(r&2){let t=re(3);Z(2),Ht("ngModel",t.collate.title)}}function Nw(r,e){if(r&1){let t=Oe();$(0,"div",19),ue("click",function(){ge(t);let a=re(3);return me(a.toggleEditGreeting())}),ie(1),q()}if(r&2){let t=re(3);Z(),Ze(t.collate.greeting)}}function zw(r,e){if(r&1){let t=Oe();$(0,"div")(1,"mat-form-field",20)(2,"input",17),ue("keydown.enter",function(){ge(t);let a=re(3);return me(a.toggleEditGreeting())}),Kt("ngModelChange",function(a){ge(t);let i=re(3);return Wt(i.collate.greeting,a)||(i.collate.greeting=a),me(a)}),q()(),$(3,"button",18),ue("click",function(){ge(t);let a=re(3);return me(a.toggleEditGreeting())}),$(4,"mat-icon"),ie(5,"save"),q()()()}if(r&2){let t=re(3);Z(2),Ht("ngModel",t.collate.greeting)}}function jw(r,e){if(r&1&&($(0,"div",9)(1,"div",13),Ee(2,Lw,3,1)(3,Vw,6,1,"div")(4,Nw,2,1,"div",14)(5,zw,6,1,"div"),q()()),r&2){let t=re(2);Z(2),Ie(t.editTitle?3:2),Z(2),Ie(t.editGreeting?5:4)}}function Gw(r,e){if(r&1){let t=Oe();$(0,"div",1)(1,"button",21),ue("click",function(){ge(t);let a=re(2);return me(a.openCollateTagCreateDialog())}),ie(2,"Add Tag +"),q()(),$(3,"div",22)(4,"app-collate-tags",23),ue("collageTagsChange",function(a){ge(t);let i=re(2);return me(i.handleCollageTagsChange(a))}),q()()}if(r&2){let t=re(2);Z(4),pe("collageTags",t.collate.tags)}}function $w(r,e){if(r&1&&ke(0,"mat-tab",25),r&2){let t=e.$implicit;pe("label",t)}}function qw(r,e){if(r&1){let t=Oe();$(0,"div",11)(1,"mat-tab-group",24),ue("selectedTabChange",function(){ge(t);let a=re(2);return me(a.filterDataBySearchTerm())}),Kt("selectedIndexChange",function(a){ge(t);let i=re(2);return Wt(i.selectedIndex,a)||(i.selectedIndex=a),me(a)}),We(2,$w,1,1,"mat-tab",25,$r),q()()}if(r&2){let t=re(2);Z(),Ht("selectedIndex",t.selectedIndex),pe("mat-stretch-tabs",!1),Z(),Ke(t.searchTerms)}}function Hw(r,e){if(r&1){let t=Oe();$(0,"app-collate-project-list",27),ue("deleteProject",function(a){ge(t);let i=re(4);return me(i.deleteProject(a))})("projectOrderChanged",function(a){ge(t);let i=re(4);return me(i.onProjectOrderChanged(a))}),q()}if(r&2){let t=re(4);pe("searchTerm",t.selectedSearchTerm)("projectConditionColorMap",t.collate.settings.projectConditionColorMap)("projects",t.projects)("filteredResults",t.filteredResults)("renameCondition",t.collate.settings.renameSampleCondition)}}function Ww(r,e){if(r&1&&Ee(0,Hw,1,5,"app-collate-project-list",26),r&2){let t=re(3);Ie(t.collate.settings.projectConditionColorMap&&t.collate.settings.renameSampleCondition?0:-1)}}function Kw(r,e){if(r&1&&Ee(0,Ww,1,1),r&2){let t=re(2);Ie(t.collate.settings?0:-1)}}function Uw(r,e){if(r&1){let t=Oe();$(0,"mat-toolbar")(1,"mat-toolbar-row"),ke(2,"span",2),Ee(3,Fw,2,1,"mat-checkbox",3),$(4,"button",4),ue("click",function(){ge(t);let a=re();return me(a.goToCollateView())}),$(5,"mat-icon"),ie(6,"visibility"),q()(),$(7,"button",5),ue("click",function(){ge(t);let a=re();return me(a.openProjectAddDialog())}),$(8,"mat-icon"),ie(9,"add"),q()(),$(10,"button",6),ue("click",function(){ge(t);let a=re();return me(a.updateCollate())}),$(11,"mat-icon"),ie(12,"save"),q()(),$(13,"button",7)(14,"mat-icon"),ie(15,"more_vert"),q()(),$(16,"mat-menu",null,0)(18,"button",8),ue("click",function(){ge(t);let a=re();return me(a.openReorderDialog())}),ie(19,"Reorder Analysis Groups"),q(),$(20,"button",8),ue("click",function(){ge(t);let a=re();return me(a.openVisibilityDialog())}),ie(21,"Change Analysis Group Visibility"),q(),$(22,"button",8),ue("click",function(){ge(t);let a=re();return me(a.openConditionColorEditorDialog())}),ie(23,"Set Condition Colors"),q(),$(24,"button",8),ue("click",function(){ge(t);let a=re();return me(a.openPlotSettings())}),ie(25,"Change Plot General Settings"),q(),$(26,"button",8),ue("click",function(){ge(t);let a=re();return me(a.openRenameConditionDialog())}),ie(27,"Rename Condition"),q()()()(),Ee(28,jw,6,2,"div",9)(29,Gw,5,1),$(30,"div",1)(31,"app-collate-search",10),ue("searchResultID",function(a){ge(t);let i=re();return me(i.getSearchFromID(a))}),q()(),Ee(32,qw,4,2,"div",11)(33,Kw,1,1)}if(r&2){let t=mr(17),n=re();Z(3),Ie(n.collate?3:-1),Z(10),pe("matMenuTriggerFor",t),Z(15),Ie(n.collate?28:-1),Z(),Ie(n.collate?29:-1),Z(2),pe("projects",n.projects),Z(),Ie(n.searchTerms.length>0?32:-1),Z(),Ie(n.collate?33:-1)}}function Xw(r,e){r&1&&($(0,"div",1)(1,"p"),ie(2," You do not have permission to edit this collate. "),q()())}var Fl=(()=>{class r{set collateId(t){t&&this.collateService.getCollate(t).subscribe(n=>{if(this._collate=n,this.accounts.getCollatePermissions(n.id).subscribe(a=>{this.canEdit=a.edit}),this.projects=n.projects,this._collate.settings||(this._collate.settings={projectOrder:this.projects.map(a=>a.id),analysisGroupOrderMap:{},projectConditionColorMap:{},renameSampleCondition:{},projectAnalysisGroupVisibility:{},plotSettings:{},showTags:!1}),this._collate.settings.plotSettings||(this._collate.settings.plotSettings={}),n.settings.projectOrder){let a=this.projects.filter(i=>!n.settings.projectOrder.includes(i.id));this.projects=this.projects.filter(i=>n.settings.projectOrder.includes(i.id)),this.projects=this.projects.concat(a)}if(this.collate&&"showTags"in this.collate.settings&&(this.collate.settings.showTags=!1),this.collate?.settings.projectConditionColorMap)this.graph.projectConditionColorMap=this.collate.settings.projectConditionColorMap;else{this.collate.settings.projectConditionColorMap={};for(let a of this.projects)this.collate.settings.projectConditionColorMap[a.id]={}}if(!this.collate?.settings.renameSampleCondition){this.collate.settings.renameSampleCondition={};for(let a of this.projects)this.collate.settings.renameSampleCondition[a.id]={},this.web.getProjectUniqueConditions(a.id).subscribe(i=>{for(let o of i)this.collate.settings.renameSampleCondition[a.id][o.Condition]=o.Condition;console.log(this.collate.settings.renameSampleCondition)})}})}get collate(){return this._collate}set collate(t){this._collate=t}get selectedSearchTerm(){return this._selectedSearchTerm}set selectedSearchTerm(t){this._selectedSearchTerm=t}constructor(t,n,a,i,o,s,l){this.accounts=t,this.graph=n,this.router=a,this.snackBar=i,this.dialog=o,this.collateService=s,this.web=l,this._collate=null,this.canEdit=!1,this.projects=[],this.selectedIndex=0,this.editTitle=!1,this.editGreeting=!1,this.searchResults={},this.projectAnalysisGroups={},this.analysisGroupProjects={},this.searchTerms=[],this._selectedSearchTerm="",this.filteredResults={},this.removedTags=[]}openProjectAddDialog(){this.dialog.open(th).afterClosed().subscribe(n=>{n&&(this.projects=this.projects.concat(n),this.collate&&(this.collate.projects=this.projects,this.updateProjectOrder()))})}updateProjectOrder(){this._collate&&(this._collate.settings.projectOrder=this.projects.map(t=>t.id)),console.log(this.collate)}updateCollate(){this._collate&&this.collateService.updateCollate(this._collate.id,this._collate).subscribe(()=>{if(this.removedTags.length>0){let t=this.removedTags.map(n=>this.collateService.removeTagFromCollate(this._collate?.id,n.id));Gl(t).subscribe(()=>{this.showSnackBar("Collate saved successfully"),this.removedTags=[]})}else this.showSnackBar("Collate saved successfully")})}toggleEditTitle(){this.editTitle=!this.editTitle}toggleEditGreeting(){this.editGreeting=!this.editGreeting}saveTitle(){this.toggleEditTitle(),this.updateCollate()}saveGreeting(){this.toggleEditGreeting(),this.updateCollate()}getSearchFromID(t){this.web.getSearchSession(t).subscribe(n=>{console.log(n)}),this.web.getSearchResults(t,99999).subscribe(n=>{console.log(n.results),this.distributeSearchResults(n.results).then()})}associateAnalysisGroupsWithProjects(){return Pt(this,null,function*(){let t=yield this.web.getAnalysisGroupsFromProjects(this.projects).toPromise();this.projectAnalysisGroups={},this.analysisGroupProjects={},t&&t.forEach(n=>{let a=n.project;this.projectAnalysisGroups[a]||(this.projectAnalysisGroups[a]=[]),this.projectAnalysisGroups[a].push(n),this.analysisGroupProjects[n.id]=this.projects.find(i=>i.id===a)})})}distributeSearchResults(t){return Pt(this,null,function*(){yield this.associateAnalysisGroupsWithProjects(),this.searchResults={},this.searchTerms=Array.from(new Set(t.map(n=>n.search_term))),t.forEach(n=>{let a=n.analysis_group.id,i=this.analysisGroupProjects[a];i&&(this.searchResults[i.id]||(this.searchResults[i.id]=[]),this.searchResults[i.id].push(n))}),this.selectedSearchTerm=this.searchTerms[0],this.filterDataBySearchTerm()})}getFilteredSearchResults(){let t={};return Object.keys(this.searchResults).forEach(n=>{t[n]=this.searchResults[n].filter(a=>a.search_term===this.selectedSearchTerm)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(n=>{let a=parseInt(n),i=this.collate?.settings.analysisGroupOrderMap[a];if(!t[a]||!i)return;let o=t[a].filter(s=>!i.includes(s.analysis_group.id));if(t[a]=t[a].filter(s=>i.includes(s.analysis_group.id)),t[a]=t[a].sort((s,l)=>i.indexOf(s.analysis_group.id)-i.indexOf(l.analysis_group.id)),t[a]=t[a].concat(o),this.collate?.settings?.projectAnalysisGroupVisibility){let s=this.collate?.settings.projectAnalysisGroupVisibility[a];t[a]=t[a].filter(l=>!s||!(l.analysis_group.id in s)?!0:s[l.analysis_group.id])}}),t}filterDataBySearchTerm(){this.selectedSearchTerm=this.searchTerms[this.selectedIndex],this.filteredResults=this.getFilteredSearchResults()}onProjectOrderChanged(t){this.projects=t,this.updateProjectOrder()}showSnackBar(t){this.snackBar.open(t,"Close",{duration:3e3})}deleteProject(t){this.projects=this.projects.filter(n=>n.id!==t.id),this.updateProjectOrder()}goToCollateView(){this._collate&&this.router.navigate(["/collate/view",this._collate.id])}onSearchResultsChange(t,n){this.filteredResults[n]=t,this.collate&&(this.collate.settings.analysisGroupOrderMap||(this.collate.settings.analysisGroupOrderMap={}),this.collate.settings.analysisGroupOrderMap[n]=t.map(a=>a.analysis_group.id),Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(a=>{this.collate.settings.analysisGroupOrderMap[a]=Array.from(new Set(this.collate.settings.analysisGroupOrderMap[a]))}))}openVisibilityDialog(){let t=this.dialog.open(lo);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let a={};n.forEach(o=>{a[o.project]||(a[o.project]=[]),a[o.project].push(o)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(o=>{let s=parseInt(o),l=this.collate?.settings.analysisGroupOrderMap[s];if(!l||!a[s])return;let u=a[s].filter(c=>!l.includes(c.id));a[s]=a[s].filter(c=>l.includes(c.id)),a[s]=a[s].sort((c,d)=>l.indexOf(c.id)-l.indexOf(d.id)),a[s]=a[s].concat(u)}),t.componentInstance.projectAnalysisGroupMap=a,t.componentInstance.projects=this.projects;let i={};this.collate?.settings?.projectAnalysisGroupVisibility&&(i=this.collate.settings.projectAnalysisGroupVisibility);for(let o in a){i[o]||(i[o]={});for(let s of a[o])s.id in i[o]||(i[o][s.id]=!0)}t.componentInstance.projectAnalysisGroupVisibilityMap=Object.assign({},i)}),t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.projectAnalysisGroupVisibility=n,this.filteredResults=this.getFilteredSearchResults())})}openReorderDialog(){let t=this.dialog.open(nh);this.web.getAnalysisGroupsFromProjects(this.projects).subscribe(n=>{let a={};n.forEach(i=>{a[i.project]||(a[i.project]=[]),a[i.project].push(i)}),this.collate?.settings?.analysisGroupOrderMap&&Object.keys(this.collate.settings.analysisGroupOrderMap).forEach(i=>{let o=parseInt(i),s=this.collate?.settings.analysisGroupOrderMap[o];if(!s||!a[o])return;let l=a[o].filter(u=>!s.includes(u.id));a[o]=a[o].filter(u=>s.includes(u.id)),a[o]=a[o].sort((u,c)=>s.indexOf(u.id)-s.indexOf(c.id)),a[o]=a[o].concat(l)}),t.componentInstance.projectAnalysisGroupMap=a,t.componentInstance.projects=this.projects}),t.afterClosed().subscribe(n=>{this.projects=n.projects,this.updateProjectOrder(),this.projectAnalysisGroups=n.projectAnalysisGroupMap;let a={};Object.keys(this.projectAnalysisGroups).forEach(i=>{a[i]=this.projectAnalysisGroups[i].map(o=>o.id)}),this.collate&&(this.collate.settings.analysisGroupOrderMap=a,this.filteredResults=this.getFilteredSearchResults())})}openConditionColorEditorDialog(){let t=this.dialog.open(ch);t.componentInstance.projectConditionColorMap=this.collate?.settings?.projectConditionColorMap,t.componentInstance.projects=this.projects,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.projectConditionColorMap=n),this.graph.projectConditionColorMap=Object.assign({},n),this.filteredResults=this.getFilteredSearchResults(),this.graph.redrawTrigger.next(!0)})}openCollateTagCreateDialog(){this.dialog.open(dh).afterClosed().subscribe(n=>{n&&n.name&&(n.existing&&n.id&&n.id!==-1?this.collateService.addTagToCollate(this.collate?.id,n.id).subscribe(a=>{this.collate&&this.collate.tags.push(a)}):this.collateService.createCollateTag(n.name).subscribe(a=>{this.collateService.addTagToCollate(this.collate?.id,a.id).subscribe(i=>{this.collate&&this.collate.tags.push(i)})}))})}handleCollageTagsChange(t){this.collate&&(this.removedTags=this.collate.tags.filter(n=>!t.includes(n)),this.collate.tags=t)}openRenameConditionDialog(){if(this.collate){let t=this.dialog.open(fh);t.componentInstance.projects=this.collate.projects,t.componentInstance.renameSampleCondition=this.collate.settings.renameSampleCondition,t.afterClosed().subscribe(n=>{this.collate&&(this.collate.settings.renameSampleCondition=Object.assign({},n),console.log(this.collate.settings.renameSampleCondition))})}}openPlotSettings(){if(this.collate){let t=this.dialog.open(hh);t.componentInstance.settings=this.collate.settings.plotSettings,t.afterClosed().subscribe(n=>{this.collate&&n&&(this.collate.settings.plotSettings=n,this.graph.plotSettings=n,this.graph.redrawTrigger.next(!0))})}}static{this.\u0275fac=function(n){return new(n||r)(_e(Ar),_e(Zi),_e(qn),_e(br),_e(Un),_e(rn),_e(Jt))}}static{this.\u0275cmp=je({type:r,selectors:[["app-collate-editor"]],inputs:{collateId:"collateId"},decls:2,vars:1,consts:[["extraActionsMenu","matMenu"],[2,"display","flex","justify-content","center"],[1,"spacer"],[3,"ngModel"],["type","button","aria-label","View Collate","mat-icon-button","",3,"click"],["type","button","aria-label","Add Projects","mat-icon-button","",3,"click"],["type","button","aria-label","Update Collate","mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"header-container",2,"display","flex","flex-direction","row","justify-content","center","align-items","center","height","200px"],[3,"searchResultID","projects"],[2,"padding","20px"],[3,"ngModelChange","ngModel"],[1,"header",2,"text-align","center","font-family","Roboto, Helvetica Neue, sans-serif"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif"],[3,"click"],[2,"font-size","2em","text-align","center","font-family","Roboto, Helvetica Neue, sans-serif","padding","5px"],["matInput","",3,"keydown.enter","ngModelChange","ngModel"],["mat-icon-button","",3,"click"],[2,"font-size","25px","font-family","'Roboto', 'Arial Narrow', sans-serif",3,"click"],[2,"font-size","25px","text-align","center","font-family","'Roboto', 'Arial Narrow', sans-serif","padding","5px"],["mat-button","",3,"click"],[2,"display","flex","justify-content","center","padding","20px"],[3,"collageTagsChange","collageTags"],[3,"selectedTabChange","selectedIndexChange","selectedIndex","mat-stretch-tabs"],[3,"label"],[3,"searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"],[3,"deleteProject","projectOrderChanged","searchTerm","projectConditionColorMap","projects","filteredResults","renameCondition"]],template:function(n,a){n&1&&Ee(0,Uw,34,7)(1,Xw,3,0,"div",1),n&2&&Ie(a.canEdit?0:1)},dependencies:[Ni,Jr,Ut,Vi,tn,Xt,xt,en,ao,Qi,Yi,Qt,Zt,oo,eo,Ji,to,ut,so,Xn],styles:["mat-card[_ngcontent-%COMP%]{margin:20px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_fadeIn 2s ease-in-out forwards}"]})}}return r})();var Yw=[{component:Pu,path:""},{component:ls,path:"view"},{component:ls,path:"view/:collateId"},{component:ls,path:"view/:collateId/:sessionId"},{component:Fl,path:"edit"},{component:Fl,path:"edit/:collateId"}],BS=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=yi({type:r})}static{this.\u0275inj=pi({imports:[Ti,ou.forChild(Yw)]})}}return r})();export{BS as CollateModule};
